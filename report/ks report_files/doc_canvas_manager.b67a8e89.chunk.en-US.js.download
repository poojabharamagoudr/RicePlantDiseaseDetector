(window.webpackJsonp=window.webpackJsonp||[]).push([[880,526],{10015:function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(2699);function l(e){return Object.isEmpty(e)}function d(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function h(e){return Math.abs(e)<=1e-12}var c=isFinite;function _(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")}var u=function(){function e(t,n){r()(this,e),this.setPoint(t,n)}return a()(e,[{key:"clone",value:function(){return new e(this._x,this._y)}},{key:"x",value:function(){return this._x}},{key:"y",value:function(){return this._y}},{key:"setX",value:function(e){this._x=e}},{key:"setY",value:function(e){this._y=e}},{key:"setPoint",value:function(e,t){return this._x=e||0,this._y=t||0,this}},{key:"assign",value:function(e){return this._x=e._x,this._y=e._y,this}},{key:"setFromPoint",value:function(t){t instanceof e?(this._x=t.x(),this._y=t.y()):console.error(t+" is no instanceof Point")}},{key:"toPoint",value:function(){return new e(Math.round(this._x),Math.round(this._y))}},{key:"isNull",value:function(){return l(this._y)&&l(this._y)}},{key:"isEquals",value:function(t){if(t instanceof e)return h(this.x()-t.x())&&h(this.y()-t.y());throw new Error(this+","+t+" is not Point")}},{key:"multiply",value:function(t){return e["*"](t,this)}},{key:"isQPoint",get:function(){return!0}}],[{key:"+",value:function(t,n){if(t instanceof e&&n instanceof e)return new e(t.x()+n.x(),t.y()+n.y());throw new Error(t+","+n+" is not Point")}},{key:"-",value:function(t,n){if(t instanceof e&&n instanceof e)return new e(t.x()-n.x(),t.y()-n.y());throw new Error(t+","+n+" is not Point")}},{key:"*",value:function(t,n){if(n instanceof e&&"number"==typeof t)return new e(n.x()*t,n.y()*t);if(t instanceof e&&"number"==typeof n)return new e(t.x()*n,t.y()*n);throw new Error(n+" is not Point")}},{key:"==",value:function(t,n){if(t instanceof e&&n instanceof e)return h(t.x()-n.x())&&h(t.y()-n.y());throw new Error(t+","+n+" is not Point")}},{key:"/",value:function(t,n){if(t instanceof e&&"number"==typeof n)return new e(t.x()/n,t.y()/n);throw new Error(t+" is not Point")}}]),e}();function p(e,t){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=e.x3,s=e.y3,l=1-t,d=n*l+r*t,h=r*l+a*t,c=i*l+o*t,_=o*l+s*t;return{x:(d=d*l+h*t)*l+(h=h*l+(a*l+e.x4*t)*t)*t,y:(c=c*l+_*t)*l+(_=_*l+(s*l+e.y4*t)*t)*t}}function f(e,t,n){var i=e.x1,r=e.y1,o=e.x2,a=e.y2,s=e.x3,l=e.y3,d=e.x4,h=e.y4,c=.5*(o+s);t.x2=.5*(i+o),n.x3=.5*(s+d),t.x1=i,n.x4=d,t.x3=.5*(t.x2+c),n.x2=.5*(n.x3+c),t.x4=n.x1=.5*(t.x3+n.x2),c=(a+l)/2,t.y2=.5*(r+a),n.y3=.5*(l+h),t.y1=r,n.y4=h,t.y3=.5*(t.y2+c),n.y2=.5*(n.y3+c),t.y4=n.y1=.5*(t.y3+n.y2)}function g(e){return e&&e.isQPoint?{x:e.x(),y:e.y()}:_(e)?e:void 0}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r()(this,e),this.setRect(t,n,i,o)}return a()(e,[{key:"clone",value:function(){return new e(this.xp,this.yp,this.w,this.h)}},{key:"setRect",value:function(e,t,n,i){this.xp=e,this.yp=t,this.w=n,this.h=i}},{key:"setCoords",value:function(e,t,n,i){this.assignCoords(e,t,n,i)}},{key:"topLeft",value:function(){return new u(this.xp,this.yp)}},{key:"bottomRight",value:function(){return new u(this.xp+this.w,this.yp+this.h)}},{key:"topRight",value:function(){return new u(this.xp+this.w,this.yp)}},{key:"bottomLeft",value:function(){return new u(this.xp,this.yp+this.h)}},{key:"width",value:function(){return this.w}},{key:"height",value:function(){return this.h}},{key:"left",value:function(){return this.xp}},{key:"right",value:function(){return this.xp+this.w}},{key:"x",value:function(){return this.xp}},{key:"y",value:function(){return this.yp}},{key:"top",value:function(){return this.yp}},{key:"bottom",value:function(){return this.yp+this.h}},{key:"size",value:function(){return this.width()*this.height()}},{key:"center",value:function(){return new u(this.xp+this.w/2,this.yp+this.h/2)}},{key:"setLeft",value:function(e){var t=e-this.xp;this.xp+=t,this.w-=t}},{key:"setRight",value:function(e){this.w=e-this.xp}},{key:"setBottom",value:function(e){this.h=e-this.yp}},{key:"setTop",value:function(e){var t=e-this.yp;this.yp+=t,this.h-=t}},{key:"adjust",value:function(e,t,n,i){var r=this.xp+e,o=this.yp+t,a=this.xp+this.w+n,s=this.yp+this.h+i;return this.setCoords(r,o,a,s),this}},{key:"adjusted",value:function(e,t,n,i){return this.clone().adjust(e,t,n,i)}},{key:"assign",value:function(e){return e&&(e.isQRect||e.isRect)?(this.xp=e.x(),this.yp=e.y(),this.w=e.width(),this.h=e.height()):console.error(e+" is not instacneof Rect check!"),this}},{key:"assignCoords",value:function(e,t,n,i){return this.xp=e,this.yp=t,this.w=n-e,this.h=i-t,this}},{key:"isNull",value:function(){return 0===this.w&&0===this.h}},{key:"isEmpty",value:function(){return this.w<=0||this.h<=0}},{key:"moveLeft",value:function(e){this.xp=e}},{key:"moveRight",value:function(e){this.xp=e-this.w}},{key:"moveTop",value:function(e){this.yp=e}},{key:"moveBottom",value:function(e){this.yp=e-this.h}},{key:"moveTo",value:function(e){var t=g(e);t&&(this.xp=t.x,this.yp=t.y)}},{key:"translate",value:function(e){var t=g(e);return t&&(this.xp+=t.x,this.yp+=t.y),this}},{key:"translated",value:function(e){return this.clone().translate(e)}},{key:"scale",value:function(e,t){return this.xp*=e,this.yp*=t,this.w*=e,this.h*=t,this}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=g(e),i=this.xp,r=this.yp,o=this.w,a=this.h,s=i,l=i;if(o<0?s+=o:l+=o,t){if(n.x<=s||n.x>=l)return!1}else if(n.x<s||n.x>l)return!1;var d=r,h=r;if(a<0?d+=a:h+=a,d===h)return!1;if(t){if(n.y<=d||n.y>=h)return!1}else if(n.y<d||n.y>h)return!1;return!0}},{key:"containsRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isNull()||e.isNull())return!1;var n=this.xp,i=this.yp,r=this.w,o=this.h,a=n,s=n;r<0?a+=r:s+=r;var l=e.xp,d=e.xp;if(e.w<0?l+=e.w:d+=e.w,t){if(l<=a||d>=s)return!1}else if(l<a||d>s)return!1;var h=i,c=i;o<0?h+=o:c+=o;var _=e.yp,u=e.yp;if(e.h<0?_+=e.h:u+=e.h,t){if(_<=h||u>=c)return!1}else if(_<h||u>c)return!1;return!0}},{key:"contains",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isQRect)return this.containsRect(t,n);if(t.isRect)return this.containsRect(new e(t.x(),t.y(),t.width(),t.height()),n);if(t.isQPoint||_(t))return this.containsPoint(t,n);if(t){if(t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height"))return this.containsRect(new e(t.x,t.y,t.width,t.height),n);if(t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom"))return this.containsRect(new e(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1),n);if(t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2"))return this.containsRect(new e(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),n)}return!1}},{key:"unite",value:function(e){if(this.isNull())return this.assign(e);if(e.isNull())return this;var t=this.xp,n=this.yp,i=this.w,r=this.h,o=t,a=t;i<0?o+=i:a+=i,e.w<0?(o=Math.min(o,e.xp+e.w),a=Math.max(a,e.xp)):(o=Math.min(o,e.xp),a=Math.max(a,e.xp+e.w));var s=n,l=n;return r<0?s+=r:l+=r,e.h<0?(s=Math.min(s,e.yp+e.h),l=Math.max(l,e.yp)):(s=Math.min(s,e.yp),l=Math.max(l,e.yp+e.h)),this.xp=o,this.yp=s,this.w=a-o,this.h=l-s,this}},{key:"intersect",value:function(e){var t=this.xp,n=this.yp,i=this.w,r=this.h,o=t,a=t;if(i<0?o+=i:a+=i,o===a)return this.assignCoords(0,0,0,0);var s=e.xp,l=e.xp;if(e.w<0?s+=e.w:l+=e.w,s===l)return this.assignCoords(0,0,0,0);if(o>=l||s>=a)return this.assignCoords(0,0,0,0);var d=n,h=n;if(r<0?d+=r:h+=r,d===h)return this.assignCoords(0,0,0,0);var c=e.yp,_=e.yp;return e.h<0?c+=e.h:_+=e.h,c===_||d>=_||c>=h?this.assignCoords(0,0,0,0):(this.xp=Math.max(o,s),this.yp=Math.max(d,c),this.w=Math.min(a,l),this.h=Math.min(h,_),this)}},{key:"isEquals",value:function(t){return e.isEquals(this,t)}},{key:"isQRect",get:function(){return!0}}],[{key:"create",value:function(t){var n=new e;return t&&(t.isQRect?n.assign(t):t.isRect?n.setRect(t.x(),t.y(),t.width(),t.height()):t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height")?n.setRect(t.x,t.y,t.width,t.height):t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom")?n.setRect(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1):t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2")&&n.setRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),n}},{key:"setFromPoint",value:function(t,n){var i=new e;return i.setCoords(t.x(),t.y(),n.x(),n.y()),i}},{key:"unite",value:function(e,t){return e.clone().unite(t)}},{key:"intersect",value:function(e,t){return e.clone().intersect(t)}},{key:"isEquals",value:function(e,t){return d(e.xp,t.xp)&&d(e.yp,t.yp)&&d(e.w,t.w)&&d(e.h,t.h)}}]),e}(),m=n(144),y=n.n(m),b=function(){function e(){r()(this,e),this.setBezier(0,0,0,0,0,0,0,0)}return a()(e,[{key:"clone",value:function(){var t=new e;return t.setBezier(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3,this.x4,this.y4),t}},{key:"setBezier",value:function(e,t,n,i,r,o,a,s){this.x1=e,this.y1=t,this.x2=n,this.y2=i,this.x3=r,this.y3=o,this.x4=a,this.y4=s}},{key:"assign",value:function(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this.x4=e.x4,this.y4=e.y4,this}},{key:"bezierOnInterval",value:function(t,n){if(0===t&&1===n)return this;var i=new e;this.parameterSplitLeft(t,i);var r=(n-t)/(1-t);return this.parameterSplitLeft(r,i),i}},{key:"parameterSplitLeft",value:function(e,t){t.x1=this.x1,t.y1=this.y1,t.x2=this.x1+e*(this.x2-this.x1),t.y2=this.y1+e*(this.y2-this.y1),t.x3=this.x2+e*(this.x3-this.x2),t.y3=this.y2+e*(this.y3-this.y2),this.x3=this.x3+e*(this.x4-this.x3),this.y3=this.y3+e*(this.y4-this.y3),this.x2=t.x3+e*(this.x3-t.x3),this.y2=t.y3+e*(this.y3-t.y3),t.x3=t.x2+e*(t.x3-t.x2),t.y3=t.y2+e*(t.y3-t.y2),t.x4=this.x1=t.x3+e*(this.x2-t.x3),t.y4=this.y1=t.y3+e*(this.y2-t.y3)}},{key:"pt1",value:function(){return new u(this.x1,this.y1)}},{key:"pt2",value:function(){return new u(this.x2,this.y2)}},{key:"pt3",value:function(){return new u(this.x3,this.y3)}},{key:"pt4",value:function(){return new u(this.x4,this.y4)}},{key:"pointAt",value:function(e){var t=p(this,e),n=t.x,i=t.y;return new u(n,i)}},{key:"addToPolygon",value:function(e,t){!function(e,t,n){for(var i=new Array(10),r=0;r<i.length;r++)i[r]={x1:0,y1:0,x2:0,y2:0,x3:0,y3:0,x4:0,y4:0};var o=new Array(10);i[0]=e,o[0]=9;for(var a=0,s=0;a>=0;){var l=i[a],d=l.y4-l.y1,h=l.x4-l.x1,c=Math.abs(h)+Math.abs(d),_=void 0;c>1?_=Math.abs(h*(l.y1-l.y2)-d*(l.x1-l.x2))+Math.abs(h*(l.y1-l.y3)-d*(l.x1-l.x3)):(_=Math.abs(l.x1-l.x2)+Math.abs(l.y1-l.y2)+Math.abs(l.x1-l.x3)+Math.abs(l.y1-l.y3),c=1),_<n*c||0===o[s]?(t.push(new u(l.x4,l.y4)),--a,--s):(f(l,i[a+1],l),o[s+1]=--o[s],++a,++s)}}(this,e,t)}},{key:"split",value:function(e,t){f(this,e,t)}},{key:"bounds",value:function(){var e=this.x1,t=this.x2,n=this.x3,i=this.x4,r=this.y1,o=this.y2,a=this.y3,s=this.y4,l=e,d=e;t<l?l=t:t>d&&(d=t),n<l?l=n:n>d&&(d=n),i<l?l=i:i>d&&(d=i);var h=r,c=r;return o<h?h=o:o>c&&(c=o),a<h?h=a:a>c&&(c=a),s<h?h=s:s>c&&(c=s),new v(l,h,d-l,c-h)}},{key:"isQBezier",get:function(){return!0}}],[{key:"fromPoints",value:function(t,n,i,r){var o=new e;return o.x1=t.x(),o.y1=t.y(),o.x2=n.x(),o.y2=n.y(),o.x3=i.x(),o.y3=i.y(),o.x4=r.x(),o.y4=r.y(),o}}]),e}(),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r()(this,e),this.setMatrix(t,n,i,o,a,s)}return a()(e,[{key:"m11",value:function(){return this._m11}},{key:"m12",value:function(){return this._m12}},{key:"m21",value:function(){return this._m21}},{key:"m22",value:function(){return this._m22}},{key:"dx",value:function(){return this._dx}},{key:"dy",value:function(){return this._dy}},{key:"toString",value:function(){return"matrix("+this._m11+", "+this._m12+", "+this._m21+", "+this._m22+", "+this._dx+", "+this._dy+")"}},{key:"setMatrix",value:function(e,t,n,i,r,o){this._m11=e,this._m12=t,this._m21=n,this._m22=i,this._dx=r,this._dy=o}},{key:"setTranslate",value:function(e,t){this._dx=e,this._dy=t}},{key:"clone",value:function(){return new e(this._m11,this._m12,this._m21,this._m22,this._dx,this._dy)}},{key:"assign",value:function(t){return t instanceof e?(this.setMatrix(t._m11,t._m12,t._m21,t._m22,t._dx,t._dy),this):(console.error("matrix is no instanceof QMartix"),null)}},{key:"Map",value:function(e){if(e){if(e.isQPoint)return this.map_point(e);if(_(e)){var t=this.MAPDOUBLE(e.x,e.y),n=y()(t,2);return{x:n[0],y:n[1]}}if(e.isQLine);else{if(e.isQRect||e.isRect)return this.mapRect(e);if(e.isQPainterPath)return this.mapPainterPath(e);e.isQPolygon||e.isQRegion}}return console.error("Invalid argument for QMatrix.Map():",e),null}},{key:"map",value:function(e,t,n,i){return this.MAPINT(e,t,n,i)}},{key:"mapDouble",value:function(e,t,n,i){return this.MAPDOUBLE(e,t,n,i)}},{key:"map_point",value:function(e){if(!e||!e.isQPoint)throw Error(e+" is not instanceof Point!");var t=e.x(),n=e.y(),i=e.clone();return i.setPoint(this._m11*t+this._m21*n+this._dx,this._m12*t+this._m22*n+this._dy),i}},{key:"mapRect",value:function(e){if(!e||!e.isQRect&&!e.isRect)throw Error(e+" is not instanceof Rect!");var t=e.clone();if(0===this._m12&&0===this._m21){var n=this._m11*e.x()+this._dx,i=this._m22*e.y()+this._dy,r=this._m11*e.width(),o=this._m22*e.height();r<0&&(n-=r=-r),o<0&&(i-=o=-o),t.setRect(n,i,r,o)}else{var a=void 0,s=void 0,l=void 0,d=void 0,h=this.MAPDOUBLE(e.x(),e.y(),a,s),c=y()(h,2),_=a=c[0],u=s=c[1],p=a,f=s,g=this.MAPDOUBLE(e.x()+e.width(),e.y(),l,d),v=y()(g,2);l=v[0],d=v[1],_=Math.min(_,l),u=Math.min(u,d),p=Math.max(p,l),f=Math.max(f,d);var m=this.MAPDOUBLE(e.x()+e.width(),e.y()+e.height(),l,d),b=y()(m,2);l=b[0],d=b[1],_=Math.min(_,l),u=Math.min(u,d),p=Math.max(p,l),f=Math.max(f,d);var w=this.MAPDOUBLE(e.x(),e.y()+e.height(),l,d),x=y()(w,2);l=x[0],d=x[1],_=Math.min(_,l),u=Math.min(u,d),p=Math.max(p,l),f=Math.max(f,d),t.setRect(_,u,p-_,f-u)}return t}},{key:"MAPINT",value:function(e,t,n,i){var r=e,o=t;return[Math.round(this._m11*r+this._m21*o+this._dx),Math.round(this._m12*r+this._m22*o+this._dy)]}},{key:"MAPDOUBLE",value:function(e,t,n,i){var r=e,o=t;return[this._m11*r+this._m21*o+this._dx,this._m12*r+this._m22*o+this._dy]}},{key:"scale",value:function(e,t){return this._m11*=e,this._m12*=e,this._m21*=t,this._m22*=t,this}},{key:"translate",value:function(e,t){return this._dx+=e*this._m11+t*this._m21,this._dy+=t*this._m22+e*this._m12,this}},{key:"rotate",value:function(e){var t=0,n=0;if(90===e||-270===e)t=1;else if(270===e||-90===e)t=-1;else if(180===e)n=-1;else{var i=e*Math.PI/180;t=Math.sin(i),n=Math.cos(i)}var r=n*this._m11+t*this._m21,o=n*this._m12+t*this._m22,a=-t*this._m11+n*this._m21,s=-t*this._m12+n*this._m22;return this._m11=r,this._m12=o,this._m21=a,this._m22=s,this}},{key:"shear",value:function(e,t){var n=t*this._m21,i=t*this._m22,r=e*this._m11,o=e*this._m12;return this._m11+=n,this._m12+=i,this._m21+=r,this._m22+=o,this}},{key:"determinant",value:function(){return this._m11*this._m22-this._m12*this._m21}},{key:"invertible",value:function(){return 0!==this.determinant()}},{key:"inverted",value:function(){var t=this.determinant();if(0===t)return new e(1,0,0,1,0,0);var n=1/t;return new e(this._m22*n,-this._m12*n,-this._m21*n,this._m11*n,(this._m21*this._dy-this._m22*this._dx)*n,(this._m12*this._dx-this._m11*this._dy)*n)}},{key:"isEqualsTo",value:function(t){return e.isEquals(this,t)}},{key:"multiply",value:function(t){return e.multiply(this,t)}},{key:"*",value:function(e){var t=this._m11*e._m11+this._m12*e._m21,n=this._m11*e._m12+this._m12*e._m22,i=this._m21*e._m11+this._m22*e._m21,r=this._m21*e._m12+this._m22*e._m22,o=this._dx*e._m11+this._dy*e._m21+e._dx,a=this._dx*e._m12+this._dy*e._m22+e._dy;return this._m11=t,this._m12=n,this._m21=i,this._m22=r,this._dx=o,this._dy=a,this}},{key:"multiply2",value:function(t){return e.multiply2(this,t)}},{key:"mapPainterPath",value:function(e){if(!e||!e.isQPainterPath||e.isEmpty())return e;var t=e.clone();t.setDirty(!0);for(var n=t.data,i=0,r=t.elementCount();i<r;++i){var o=n.elements[i],a=this.map_point(o.toPoint());o.x=a.x(),o.y=a.y()}return t}},{key:"isQMatrix",get:function(){return!0}}],[{key:"inverted",value:function(e){return e.inverted()}},{key:"isEquals",value:function(e,t){return e._m11===t._m11&&e._m12===t._m12&&e._m21===t._m21&&e._m22===t._m22&&e._dx===t._dx&&e._dy===t._dy}},{key:"multiply",value:function(t,n){return new e(t._m11*n._m11+t._m21*n._m12+0,t._m12*n._m11+t._m22*n._m12+0,t._m11*n._m21+t._m21*n._m22+0,t._m12*n._m21+t._m22*n._m22+0,t._m11*n._dx+t._m21*n._dy+t._dx,t._m12*n._dx+t._m22*n._dy+t._dy)}},{key:"multiply2",value:function(t,n){return e.multiply(n,t)}}]),e}();function x(e,t,n,i,r){r=0;var o=e.x(),a=e.y(),s=e.width(),l=e.width()/2,c=.5522847498*l,_=e.height(),p=e.height()/2,f=.5522847498*p,g=[new u(o+s,a+p),new u(o+s,a+p+f),new u(o+l+c,a+_),new u(o+l,a+_),new u(o+l-c,a+_),new u(o,a+p+f),new u(o,a+p),new u(o,a+p-f),new u(o+l-c,a),new u(o+l,a),new u(o+l+c,a),new u(o+s,a+p-f),new u(o+s,a+p)];if(n>360?n=360:n<-360&&(n=-360),0===t){if(360===n){for(var v=11;v>=0;--v)i[r++]=g[v];return[g[12],r]}if(-360===n){for(var m=1;m<=12;++m)i[r++]=g[m];return[g[0],r]}}var b=parseInt(Math.floor(t/90),10),w=parseInt(Math.floor((t+n)/90),10),x=(t-90*b)/90,P=(t+n-90*w)/90,S=n>0?1:-1;S<0&&(x=1-x,P=1-P),h(x-1)&&(x=0,b+=S),h(P)&&(P=1,w-=S),x=k(90*x),P=k(90*P);var M=!h(x),I=!h(P-1),T=w+S;if(b===T){var R=3*(3-(b%4+4)%4);return[S>0?g[R+3]:g[R],r]}var N=new u,E=new u;!function(e,t,n,i,r){if(e.isNull())return;for(var o=e.width()/2,a=e.height()/2,s=[t,t+n],l=[i,r],d=window.Point,h=0;h<2;++h)if(l[h]){var c=(s[h]-360*Math.floor(s[h]/360))/90,_=parseInt(Math.floor(c),10);c=k(90*(c-=_)),1&_&&(c=1-c);var u=void 0,p=void 0,f=void 0,g=void 0,v=C(c,u,p,f,g),m=y()(v,4);u=m[0],p=m[1],f=m[2],g=m[3];var b=new d(u+p+.5522847498*f,g+f+.5522847498*p);1!==_&&2!==_||b.setX(-b.x()),0!==_&&1!==_||b.setY(-b.y()),l[h].setFromPoint(d["+"](e.center(),new d(o*b.x(),a*b.y())))}}(e,t,n,N,E);for(var A=window.QBezier,O=b;O!==T;O+=S){var L=3*(3-(O%4+4)%4),F=void 0;if(F=S>0?A.fromPoints(g[L+3],g[L+2],g[L+1],g[L]):A.fromPoints(g[L],g[L+1],g[L+2],g[L+3]),b===w&&d(x,P))return[N,r];O===b?O===w&&I?F=F.bezierOnInterval(x,P):M&&(F=F.bezierOnInterval(x,1)):O===w&&I&&(F=F.bezierOnInterval(0,P)),i[r++]=F.pt2(),i[r++]=F.pt3(),i[r++]=F.pt4()}return i[r-1]=E,[N,r]}function k(e){if(h(e))return 0;if(d(e,90))return 1;var t=Math.PI*e/180,n=Math.cos(t),i=Math.sin(t),r=e/90;r-=(((2-3*.5522847498)*r+3*-.4477152502)*r*r+1-n)/(((6-4.9705627482)*r+6*-.4477152502)*r);var o=r-=(((2-3*.5522847498)*r+3*-.4477152502)*r*r+1-n)/(((6-4.9705627482)*r+6*-.4477152502)*r);return o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-i)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498),.5*(r+(o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-i)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498)))}function C(e,t,n,i,r){var o=1-e;return r=(i=e*e)*e,[(n=o*o)*o,n*=3*e,i*=3*o,r]}var P=0,S=1,M=2,I=3,T=0,R=1,N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r()(this,e),this.x=t,this.y=n,this.type=i,this.isClosed=o}return a()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.type)}},{key:"toPoint",value:function(){return new u(this.x,this.y)}},{key:"isEquals",value:function(e){return e&&e.isElement===this.isElement&&d(this.x,e.x())&&d(this.y,e.y())&&this.type===e.type}},{key:"isElement",get:function(){return!0}}]),e}();function E(e){return e.isQPoint?{x:e.x(),y:e.y()}:e}function A(e){return!e.isQPoint&&_(e)?new u(e.x,e.y):e}var O=function(){function e(){r()(this,e),this.cStart=0,this.fillRule=T,this.dirtyBounds=!1,this.dirtyControlBounds=!1,this.pathConverter=null,this.require_moveTo=!1,this.convex=!1,this.bounds=new v,this.controlBounds=new v,this.elements=[],this.elements.push(new N)}return a()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){var t,n;return this.cStart=e.cStart,this.fillRule=e.fillRule,this.dirtyBounds=e.dirtyBounds,this.dirtyControlBounds=e.dirtyControlBounds,this.pathConverter=null,this.require_moveTo=!1,this.convex=e.convex,this.bounds=e.bounds.clone(),this.controlBounds=e.controlBounds.clone(),this.elements=(t=e.elements,n=[],t.forEach((function(e){return n.push(e.clone())})),n),this}},{key:"isClosed",value:function(){var e=this.elements.length,t=this.elements[this.cStart],n=this.elements[e-1];return q(t.x-n.x)&&q(t.y-n.y)}},{key:"close",value:function(){this.require_moveTo=!0;var e=this.elements.length,t=this.elements[this.cStart],n=this.elements[e-1];t.x===n.x&&t.y===n.y||(d(t.x,n.x)&&d(t.y,n.y)?(n.x=t.x,n.y=t.y):this.elements.push(new N(t.x,t.y,S,!0)))}},{key:"maybeMoveTo",value:function(){if(this.require_moveTo){var e=this.elements.length,t=this.elements[e-1].clone();t.type=P,this.elements.push(t),this.require_moveTo=!1}}},{key:"getPathElementAt",value:function(e){return this.elements[e]}},{key:"length",get:function(){return this.elements.length}}]),e}(),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r()(this,e),this.data=null,t&&(this.data=new O,this.data.elements.push(new N(t.x,t.y,P)))}return a()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){return this.data=e.data?e.data.clone():null,this}},{key:"isEmpty",value:function(){return!this.data||1===this.data.elements.length&&this.data.elements[0].type===P}},{key:"elementCount",value:function(){return this.data?this.data.elements.length:0}},{key:"elementAt",value:function(e){if(this.data)return this.data.elements[e]}},{key:"fillRule",value:function(){return this.isEmpty()?T:this.data.fillRule}},{key:"moveTo",value:function(){var e=arguments,t=void 0,n=void 0;if(1===e.length){var i=E(e[0]);t=i.x,n=i.y}else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=e[0],n=e[1]}if(isFinite(t)&&isFinite(n)){this.ensureData(),this.setDirty(!0);var r=this.data;r.require_moveTo=!1;var o=this.data.elements.length,a=r.elements[o-1];a.type===P?(a.x=t,a.y=n):r.elements.push(new N(t,n,P)),r.cStart=r.elements.length-1}else console.error("Invalid argument for painterPath lineTo!")}},{key:"lineTo",value:function(){var e=arguments,t=void 0;if(1===e.length)t=A(e[0]);else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=new u(e[0],e[1])}if(t.isQPoint&&isFinite(t.x())&&isFinite(t.y())){this.ensureData(),this.setDirty(!0);var n=this.data,i=this.data.elements.length;if(i>0){if(n.maybeMoveTo(),t.isEquals(n.elements[i-1].toPoint()))return;var r=new N(t.x(),t.y(),S);n.elements.push(r),n.convex=3===n.elements.length||4===n.elements.length&&n.isClosed()}}else console.error("Invalid argument for painterPath lineTo!")}},{key:"cubicTo",value:function(){var e=void 0,t=void 0,n=void 0,i=arguments;if(3===i.length)e=i[0],t=i[1],n=i[2];else{if(6!==i.length)return;e=new u(i[0],i[1]),t=new u(i[2],i[3]),n=new u(i[4],i[5])}if(e.isQPoint&&t.isQPoint&&n.isQPoint){this.ensureData(),this.setDirty(!0);var r=this.data;r.elements.last().toPoint().isEquals(e)&&e.isEquals(t)&&t.isEquals(n)||(r.maybeMoveTo(),r.elements.push(new N(e.x(),e.y(),M)),r.elements.push(new N(t.x(),t.y(),I)),r.elements.push(new N(n.x(),n.y(),I)))}}},{key:"bezierCurveTo",value:function(){this.cubicTo.apply(this,arguments)}},{key:"arcTo",value:function(){}},{key:"ellipse",value:function(e,t,n,i){this.addEllipse(new v(e-n,t-i,2*n,2*i))}},{key:"addEllipse",value:function(e){if(e&&e.isQRect&&!e.isNull()&&c(e.x())&&!isNaN(e.x())&&c(e.y())&&!isNaN(e.y())&&c(e.height())&&!isNaN(e.height())&&c(e.width())&&!isNaN(e.width())){this.ensureData(),this.setDirty(!0);var t=this.data,n=t.elements.length<2,i=[],r=x(e,0,-360,i,void 0),o=y()(r,1)[0];this.moveTo(o),this.cubicTo(i[0],i[1],i[2]),this.cubicTo(i[3],i[4],i[5]),this.cubicTo(i[6],i[7],i[8]),this.cubicTo(i[9],i[10],i[11]),t.require_moveTo=!0,t.convex=n}else console.error("QPainterPath::addEllipse: Adding ellipse where a parameter is NaN or Inf, ignoring call")}},{key:"closeSubpath",value:function(){this.isEmpty()||(this.setDirty(!0),this.data.close())}},{key:"boundingRect",value:function(){return this.data?(this.data.dirtyBounds&&this.computeBoundingRect(),this.data.bounds):new v}},{key:"ensureData",value:function(){this.data||(this.data=new O)}},{key:"setDirty",value:function(e){this.data.dirtyBounds=e,this.data.dirtyControlBounds=e,this.data.pathConverter=null,this.data.convex=!1}},{key:"computeBoundingRect",value:function(){var e=this.data;e.dirtyBounds=!1;var t=void 0,n=void 0,i=void 0,r=void 0;t=n=e.elements[0].x,i=r=e.elements[0].y;for(var o=1;o<e.elements.length;++o){var a=e.elements[o];switch(a.type){case P:case S:a.x>n?n=a.x:a.x<t&&(t=a.x),a.y>r?r=a.y:a.y<i&&(i=a.y);break;case M:var s=e.elements[o-1],l=e.elements[o+1],d=e.elements[o+2],h=W({x1:s.x,y1:s.y,x2:a.x,y2:a.y,x3:l.x,y3:l.y,x4:d.x,y4:d.y}),c=h.right(),_=h.bottom();h.x()<t&&(t=h.x()),c>n&&(n=c),h.y()<i&&(i=h.y()),_>r&&(r=_),o+=2}}e.bounds=new v(t,i,n-t,r-i)}},{key:"contains",value:function(e){return e&&e.isQRect?this.containsRect(e):e&&e.isQPoint?this.containsPoint(e):void console.error("Invalid argument for painterPath contains!")}},{key:"containsPoint",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;for(var t=this.data,n=0,i=new u,r=new u,o=0;o<t.elements.length;++o){var a=t.elements[o].toPoint();switch(t.elements[o].type){case P:o>0&&(n=H(i,r,e,n)),r=i=a;break;case S:n=H(i,a,e,n),i=a;break;case M:var s=t.elements[++o].toPoint(),l=t.elements[++o].toPoint();n=V(b.fromPoints(i,a,s,l),e,n),i=l}}return i!==r&&(n=H(i,r,e,n)),t.fillRule===R?0!==n:n%2!=0}},{key:"containsRect",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;if(function(e,t){for(var n=new u,i=new u,r=0;r<e.elementCount();++r){var o=e.elementAt(r);switch(o.type){case P:if(r>0&&d(n.x(),i.x())&&d(n.y(),i.y())&&U(n.x(),n.y(),i.x(),i.y(),t))return!0;i=n=o.toPoint();break;case S:if(U(n.x(),n.y(),o.x,o.y,t))return!0;n=o.toPoint();break;case M:var a=e.elementAt(++r).toPoint(),s=e.elementAt(++r).toPoint(),l=b.fromPoints(n,o,a,s);if(z(l,t.top(),t.left(),t.right())||z(l,t.bottom(),t.left(),t.right())||G(l,t.left(),t.top(),t.bottom())||G(l,t.right(),t.top(),t.bottom()))return!0;n=s}}if(n!==i&&U(n.x(),n.y(),i.x(),i.y(),t))return!0;return!1}(this,e)){if(this.fillRule()===T)return!1;if(!(this.contains(e.topLeft())&&this.contains(e.topRight())&&this.contains(e.bottomRight())&&this.contains(e.bottomLeft())))return!1}if(!this.contains(e.center()))return!1;for(var t=this.data,n=0;n<t.elements.length;++n){var i=t.elements[n];if(i.type===P&&e.contains(i)){if(this.fillRule()===T)return!1;for(var r=!1;!r&&n<t.elements.length;++n){var o=t.elements[n];switch(o.type){case P:r=!0;break;case S:if(!this.contains(o))return!1;break;case M:if(!this.contains(t.elements[n+2]))return!1;n+=2}}--n}}return!0}},{key:"controlPointRect",value:function(){if(this.data){var e=this.data;return e.dirtyControlBounds&&this.computeControlPointRect(),e.controlBounds}this.controlBounds=new v}},{key:"computeControlPointRect",value:function(){if(this.data){var e=this.data;e.dirtyControlBounds=!1;var t=void 0,n=void 0,i=void 0,r=void 0;t=n=e.elements[0].x,i=r=e.elements[0].y;for(var o=1;o<e.elements.length;++o){var a=e.elements[o];a.x>n?n=a.x:a.x<t&&(t=a.x),a.y>r?r=a.y:a.y<i&&(i=a.y)}e.controlBounds=new v(t,i,n-t,r-i)}else this.controlBounds=new v}},{key:"addPolygon",value:function(e){if(Array.isArray(e)){if(0!==e.length){this.ensureData(),this.setDirty(!0),this.moveTo(e[0]);for(var t=0,n=e.length;t<n;t++){var i=e[t];this.lineTo(i)}e.isClosed&&this.closeSubpath()}}else console.error("QPainterPath addPolygon param is not array :",e)}},{key:"toSubpathPolygons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(this.isEmpty())return[];e||(e=new w);var n=[],i=[];i.isClosed=!1;for(var r=this.data,o=0,a=r.elements.length;o<a;o++){var s=r.elements[o];switch(s.type){case P:if(0!==i.length){var l=Array.from(i);l.isClosed=i.isClosed,Y(i)&&(l.isClosed=!0),n.push(l),i.length=0,i.isClosed=!1,i.push(e.map_point(s.toPoint()))}else i.push(e.map_point(s.toPoint()));break;case S:i.push(e.map_point(s.toPoint()));break;case M:if(!r.elements[o-1]||r.elements[o+1].type!==I||r.elements[o+2].type!==I){console.error("this element data error! check");break}var d=s.toPoint(),h=r.elements[o+1].toPoint(),c=r.elements[o+2].toPoint(),_=r.elements[o-1].toPoint(),u=b.fromPoints(e.map_point(_),e.map_point(d),e.map_point(h),e.map_point(c));u.addToPolygon(i,t),o+=2}}return Y(i)&&(i.isClosed=!0),n.push(i),n}},{key:"translate",value:function(e,t){var n=0,i=0;e.isQPoint?(n=e.x(),i=e.y()):"number"==typeof e&&"number"==typeof t&&(n=e,i=t);var r=this.data;if(r&&(0!==n||0!==i))for(var o=r.elements.length-1,a=r.elements;o>=0;)a[o].x+=n,a[o].y+=i,o--}},{key:"getPathElementAt",value:function(e){return this.data?this.data.getPathElementAt(e):null}},{key:"isQPainterPath",get:function(){return!0}},{key:"length",get:function(){return this.data?this.data.length:0}}]),e}();function F(e,t){return 3*(-e[t+"1"]+3*e[t+"2"]-3*e[t+"3"]+e[t+"4"])}function D(e,t){return 6*(e[t+"1"]-2*e[t+"2"]+e[t+"3"])}function B(e,t){return 3*(-e[t+"1"]+e[t+"2"])}function j(e,t,n){if(t>=0&&t<=1){var i=p(e,t);i.x<n.minx?n.minx=i.x:i.x>n.maxx&&(n.maxx=i.x),i.y<n.miny?n.miny=i.y:i.y>n.maxy&&(n.maxy=i.y)}}function W(e){var t=void 0,n=void 0,i=void 0,r=void 0;e.x1<e.x4?(t=e.x1,i=e.x4):(t=e.x4,i=e.x1),e.y1<e.y4?(n=e.y1,r=e.y4):(n=e.y4,r=e.y1);var o={minx:t,miny:n,maxx:i,maxy:r},a=F(e,"x"),s=D(e,"x"),l=B(e,"x");if(h(a)){if(!h(s))j(e,-l/s,o)}else{var d=s*s-4*a*l;if(d>=0){var c=Math.sqrt(d),_=1/(2*a);j(e,(-s+c)*_,o),j(e,(-s-c)*_,o)}}var u=F(e,"y"),p=D(e,"y"),f=B(e,"y");if(h(u)){if(!h(p))j(e,-f/p,o)}else{var g=p*p-4*u*f;if(g>0){var m=Math.sqrt(g),y=1/(2*u);j(e,(-p+m)*y,o),j(e,(-p-m)*y,o)}}return new v(o.minx,o.miny,o.maxx-o.minx,o.maxy-o.miny)}function U(e,t,n,i,r){var o=r.left(),a=r.right(),s=r.top(),l=r.bottom(),d=(e<o)<<0|(e>a)<<1|(t<s)<<2|(t>l)<<3,h=(n<o)<<0|(n>a)<<1|(i<s)<<2|(i>l)<<3;if(d&h)return!1;if(d|h){var c=n-e,_=i-t;return e<o?(t+=_/c*(o-e),e=o):e>a&&(t-=_/c*(e-a),e=a),n<o?(i+=_/c*(o-n),n=o):n>a&&(i-=_/c*(n-a),n=a),(d=(t<s)<<2|(t>l)<<3)&(h=(i<s)<<2|(i>l)<<3)?!1:(t<s?(e+=c/_*(s-t),t=s):t>l&&(e-=c/_*(t-l),t=l),i<s?(n+=c/_*(s-i),i=s):i>l&&(n-=c/_*(i-l),i=l),!((d=(e<o)<<0|(e>a)<<1)&(h=(n<o)<<0|(n>a)<<1)))}return!1}function z(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.bounds();if(t>=o.top()&&t<o.bottom()&&o.right()>=n&&o.left()<i){var a=.01;if(32===r||o.width()<a&&o.height()<a)return!0;var s=new b,l=new b;if(e.split(s,l),z(s,t,n,i,r+1)||z(l,t,n,i,r+1))return!0}return!1}function G(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.bounds();if(t>=o.left()&&t<o.right()&&o.bottom()>=n&&o.top()<i){var a=.01;if(32===r||o.width()<a&&o.height()<a)return!0;var s=new b,l=new b;if(e.split(s,l),G(s,t,n,i,r+1)||G(l,t,n,i,r+1))return!0}return!1}function H(e,t,n,i){var r=e.x(),o=e.y(),a=t.x(),s=t.y(),l=n.y(),h=1;if(d(o,s))return i;if(s<o){var c=a;a=r,r=c;var _=s;s=o,o=_,h=-1}l>=o&&l<s&&(r+(a-r)/(s-o)*(l-o)<=n.x()&&(i+=h));return i}function V(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.y(),o=t.x(),a=e.bounds();if(r>=a.y()&&r<a.y()+a.height()){var s=.001;if(32===i||a.width()<s&&a.height()<s)return e.pt1().x()<=o&&(n+=e.pt4().y()>e.pt1().y()?1:-1),n;var l=new b,d=new b;e.split(l,d),n=V(l,t,n,i+1),n=V(d,t,n,i+1)}return n}function q(e){return Math.abs(e)<1e-7}function Y(e){var t=e.length;return t>1&&q(e[0].x()-e[t-1].x())&&q(e[0].y()-e[t-1].y())}var X=n(3284),Q=n(260),Z=n(1699),K=function(){function e(t){r()(this,e),this.canvas=t,this.tempCtx=new X.a({ctx:Object(Z.getMeasureCTX)()})}return a()(e,[{key:"render",value:function(e){var t=e.inkId,n=e.point,i=e.createSvgTempNode,r=this.canvas;i&&(r.save("ink_temp_"+t),r.restore());var o=0,a=document.getElementById("ink_temp_"+t);if(a){for(var s=a.childNodes,l=n.length-1;l>=0;l--){var d=s[l],h=n[l]&&n[l].timestamp;if(d&&Number(d.id)===Number(h)){o=l+1;break}}for(var c=o;c<n.length;c++){var _=s[c];_&&_.remove(),this.tempCtx.save(n[c].timestamp),this.drawInk(e,this.changePointType(n[c].vecPoints),this.tempCtx),this.tempCtx.restore()}var u=this.tempCtx.getSvg().lastElementChild.lastElementChild||{};a.appendChild(u)}else console.log("inkNode is no exist")}},{key:"renderInkShape",value:function(e,t){var n=this;this.canvas=t;var i=window.APP.data.doc.textStream.getPureTextStream().getChpx(e.anchor.pos);if(!(i&&i.prop&&i.prop.revision&&i.prop.revision.delete)){e.inkData||e.initInkData();var r=e.inkData;this.canvas.save("ink_finish_"+r.inkId),(r.inkData.vecTrace||[]).forEach((function(e){var t=n.changePointType(e.vecPoints),i=r.getPencil(e);n.drawInk(i,t,n.canvas,!0)})),this.canvas.restore(),Q.default.dispatchEvent(Q.default.mobile.CLEAR_SINGLE_INK,{mimeDataId:e.anchor.shapeData.mimeDataId})}}},{key:"changePointType",value:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(new u(e[n].px,e[n].py));return t}},{key:"drawInk",value:function(e,t,n,i){var r=e.pencilType,o=e.pencilParams,a=void 0===o?{}:o,l=s.d.MARKER,d=s.d.FLUORESCENCE;t&&0!==t.length&&(r===l?this.drawEllipseInk(n,t,a,i):r===d?this.drawNiteInk(n,t,a,i):console.warn("Brush::drop类型目前不支持"))}},{key:"drawEllipseInk",value:function(e,t,n,i){var r=n.selectColor,o=n.strokeSize;e.lineWidth=o,e.strokeStyle=r,1===t.length?i&&this.drawPoint(e,t[0]):(e.beginPath({"stroke-linecap":"round","stroke-linejoin":"round"}),this.fitToCuve(t,e),e.stroke())}},{key:"drawPoint",value:function(e,t){e.beginPath({"stroke-linecap":"round","stroke-linejoin":"round"}),e.moveTo(t._x,t._y),e.lineTo(t._x+1e-4,t._y),e.stroke()}},{key:"drawNiteInk",value:function(e,t,n,i){var r=n.selectColor,o=n.strokeSize,a=o,s=2*o;e.fillStyle=r,e.beginPath(),this.generateFillPathFrom(e,t,a,s,i),e.fill()}},{key:"generateFillPathFrom",value:function(e,t,n,i,r){if(1===t.length){if(r)!function(e,t){e.moveTo(t.x(),t.y()),e.lineTo(t.x()+t.width(),t.y()),e.lineTo(t.x()+t.width(),t.y()+t.height()),e.lineTo(t.x(),t.y()+t.height()),e.lineTo(t.x(),t.y())}(e,new v(t[0]._x-.5*n,t[0]._y-.5*i,n,i))}else{var o=new L;this.fitToLine(t,o);var a=[];this.appendNiteInkPolygons(o,n,i,a);for(var s=0,l=a.length;s<l;s++)e.addPolygon?e.addPolygon(a[s]):$(e,a[s])}return e}},{key:"appendNiteInkPolygons",value:function(e,t,n,i){var r=e.toSubpathPolygons();if(Array.isArray(r))for(var o=0,a=r.length;o<a;o++)for(var s=r[o],l=0,d=s.length;l<d-1;l++)this.appendNiteInkPolygon(s[l],s[l+1],t,n,i)}},{key:"appendNiteInkPolygon",value:function(e,t,n,i,r){if(e&&t){var o=new v(e.x()-n/2,e.y()-i/2,n,i),a=new v(t.x()-n/2,t.y()-i/2,n,i);if(e.x()===a.x()&&e.y()===a.y())r.push(J(o));else if(e.x()===t.x()){var s=void 0,l=void 0;e.y()<t.y()?(s=a.bottomRight().x()-o.x(),l=a.bottomRight().y()-o.y(),r.push(J(new v(o.x(),o.y(),s,l)))):(s=o.bottomRight().x()-a.x(),l=o.bottomRight().y()-a.y(),r.push(J(new v(a.x(),a.y(),s,l))))}else if(e.y()===t.y()){var d=void 0,h=void 0;e.x()<t.x()?(d=a.bottomRight().x()-o.x(),h=a.bottomRight().y()-o.y(),r.push(J(new v(o.x(),o.y(),d,h)))):(d=o.bottomRight().x()-a.x(),h=o.bottomRight().y()-a.y(),r.push(J(new v(a.x(),a.y(),d,h))))}else{var c=void 0,_=void 0;e.y()<t.y()?(c=o,_=a):(c=a,_=o);var u=[c.topLeft(),c.topRight(),_.topRight(),_.topLeft(),c.topLeft()],p=[c.bottomLeft(),c.bottomRight(),_.bottomRight(),_.bottomLeft(),c.bottomLeft()],f=void 0,g=void 0;e.x()<t.x()?(f=o,g=a):(f=a,g=o);var m=[f.topLeft(),g.topLeft(),g.bottomLeft(),f.bottomLeft(),f.topLeft()],y=[f.topRight(),g.topRight(),g.bottomRight(),f.bottomRight(),f.topRight()];r.push(m),r.push(y),r.push(u),r.push(p)}}}},{key:"fitToCuve",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(e.length<=2&&e.length>0){t.moveTo(e[0]._x,e[0]._y);for(var n=0;n<e.length;n++){var i=e[n];t.lineTo(i._x,i._y)}return t}var r=function(e,t){if(!e||t<=2)return console.warn("convert2Beziers fail!! ",e,t),[];var n=[];if(2===t)return n[0]=e[0],n[1]=u["/"](u["+"](u["*"](2,e[0]),e[1]),3),n[2]=u["/"](u["+"](u["*"](2,e[1]),e[0]),3),n[3]=e[1],n;var i=t,r=3*i-2;n[0]=e[0];var o=u["/"](u["-"](u["-"](e[1],e[0]),u["*"](u["-"](e[2],e[1]),.1)),5);n[1]=u["+"](n[0],o);for(var a=1,s=0;a<i-1;)n[s=3*a]=e[a],o=u["/"](u["-"](e[a+1],e[a-1]),5),n[s-1]=u["-"](e[a],o),n[s+1]=u["+"](e[a],o),a++;return n[r-1]=e[i-1],o=u["/"](u["-"](u["-"](e[i-2],e[i-1]),u["*"](u["-"](e[i-3],e[i-2]),.1)),5),n[r-2]=u["+"](n[r-1],o),n}(e,e.length);if(!r||!r.length||r.length%3!=1)return console.warn("convert2Beziers curve is fail",r),null;if(t.moveTo(e[0]._x,e[0]._y),1===e.length)return t.lineTo(e[0]._x+1e-4,e[0]._y),t;for(var o=1,a=r.length;o<a-2;){var s=r[o++],l=r[o++],d=r[o++];u["=="](s,l)&&u["=="](d,l)&&d.x()===d.y()&&0===d.x()||t.bezierCurveTo(s.x(),s.y(),l.x(),l.y(),d.x(),d.y())}return t}},{key:"fitToLine",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(t.moveTo(e[0]._x,e[0]._y),1===e.length)return t.lineTo(e[0]._x+1e-4,e[0]._y),t;for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n]._x,e[n]._y);return t}}]),e}();function J(e){var t=[];return t.push(new u(e.x(),e.y())),t.push(new u(e.x()+e.width(),e.y())),t.push(new u(e.x()+e.width(),e.y()+e.height())),t.push(new u(e.x(),e.y()+e.height())),t.push(new u(e.x(),e.y())),t}function $(e,t){e.moveTo(t[0].x(),t[0].y());for(var n=0,i=t.length;n<i;n++){var r=t[n];e.lineTo(r.x(),r.y())}}},10086:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var i=function(e){return!!e&&("#000000"===e||"#000"===e||!(!e.startsWith("#")||7!==e.length)&&5*parseInt(e.substr(1,2),16)+10*parseInt(e.substr(3,2),16)+parseInt(e.substr(5,2),16)<=1033)};function r(e,t,n,r,o){if(r){if(i(r))return"#FFFFFF"}else if(n){if(i(n))return"#FFFFFF"}else{if(t)return t;if(e&&i(e))return"#FFFFFF"}return o}var o=[1,18,19,20],a=[0];function s(e){var t=e.shading_texture,n=e.shading_fill_color,i=e.shading_back_color;return"#ffffff"!=i||n?o.includes(t)?n:a.includes(t)?i:null:null}},10096:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var i=n(22),r=n.n(i),o=n(23),a=n.n(o),s=n(1),l=n.n(s),d=n(2),h=n.n(d),c=n(4973),_=n(2293),u=n(1734),p=function(){function e(t){var n=t.rg,i=t.doc,r=t.papxs;l()(this,e),this.rg=n,this.doc=i,this.papxs=r}return h()(e,[{key:"processPapxs",value:function(){var e=this.papxs;e||(e=this.doc.getDataLogic("final").collectPapxs(this.rg.pos,this.rg.len));if(0!=e.length)for(var t=0;t<e.length&&this.processPapx(e[t]);t++);}}]),e}(),f=function(e){function t(e){l()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.indexInfo={index:0,isBullet:!1},n.processPapxs(),n}return a()(t,e),h()(t,[{key:"_getIndexInfo",value:function(e,t){if(void 0!==e.image)return this.indexInfo={index:-1,isBullet:!1},!1;var n=!1,i=this.indexInfo.index,r=t.listGalleryIndex,o=t.listGalleryType;if(3===o)return this.indexInfo={index:r,type:o,isBullet:!1},!0;if(1===o)return this.indexInfo={index:r,type:o,isBullet:!0},!0;if(2===o)return this.indexInfo={index:r,type:o,isBullet:!1},!0;if(23===e.nfc)if(n=!0,""===e.xst)i=1;else if(""===e.xst)i=2;else if(""===e.xst)i=3;else if(""===e.xst)i=4;else if(""===e.xst)i=5;else if(""===e.xst)i=6;else if(""===e.xst)i=7;else if(e.xst===c.b)i=_.b;else{if(e.xst!==c.a)return this.indexInfo={index:-1,isBullet:!1},!1;i=_.a}else if(37===e.nfc&&"%1、"===e.xst)i=1;else if(37===e.nfc&&"（%1）"===e.xst)i=2;else if(0===e.nfc)"%1."===e.xst?i=3:"%1)"===e.xst?i=5:"(%1)"===e.xst&&(i=8);else if(28===e.nfc&&"%1　"===e.xst)i=6;else{if(4!==e.nfc||"%1."!==e.xst)return this.indexInfo={index:-1,isBullet:!1},!1;i=7}return 0===this.indexInfo.index?(this.indexInfo.index=i,this.indexInfo.isBullet=n,!0):this.indexInfo.index===i&&this.indexInfo.isBullet===n||(this.indexInfo={index:-1,isBullet:!1},!1)}},{key:"_checkMix",value:function(){return 0===this.indexInfo.index||(this.indexInfo={index:-1,isBullet:!1},!1)}},{key:"processPapx",value:function(e){if(void 0===e||void 0===e.prop)return this._checkMix();var t=e.prop;if(!t.hasAutoNum())return 1===e.len||this._checkMix();var n=t.list_id,i=this.doc.autoNumMgr.findAutoNum(n),r=this.doc.autoNumMgr.findListGalleryInfo(n);if(!i||i.levelCount<=0)return this._checkMix();if(i.levelCount>9)return this.indexInfo={index:-1,isBullet:!1},!1;var o=t.list_level;if(void 0===o||o<0||o>8||o>=i.levelCount)return this._checkMix();var a=i.levels[o];return void 0===a?this._checkMix():this._getIndexInfo(a,r)}}]),t}(p),g=function(e){function t(e,n){l()(this,t);var i=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{rg:e,doc:n}));return i.listType=u.b,i.listId=0,i.processPapxs(),i}return a()(t,e),h()(t,[{key:"processPapx",value:function(e){if(void 0===e||void 0===e.prop)return this.listType=u.b,!1;var t=e.prop;if(!t.hasAutoNum())return 1===e.len||(this.listType=u.b,!1);var n=t.list_id,i=this.doc.autoNumMgr.findAutoNum(n);if(!i||i.levelCount<=0)return this.listType=u.b,!1;var r=t.list_level;if(void 0===r||r<0||r>8||r>=i.levelCount)return this.listType=u.b,!1;var o=i.levels[r];if(void 0===o)return this.listType=u.b,!1;var a=u.b;if(a=void 0!==o.image||23===o.nfc?o.xst===c.b||o.xst===c.a?u.d:u.a:u.c,this.listType===u.b)this.listType=a,this.listId=n;else if(this.listType!==a&&this.listId!==n)return this.listType=u.b,!1;return!0}}]),t}(p)},10407:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePathForWave=void 0,t.generatePathForWave=function(e,t,n){var i=n-3;for(e.moveTo(Math.round(t.x)+1,Math.round(t.y)+1),e.__addPathCommand("q ".concat(1.5,",").concat(2,", ").concat(3,",0"));i>3;)e.__addPathCommand("t ".concat(3,",0")),i-=3}},10855:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultManager",(function(){return sr})),n.d(t,"commentManager",(function(){return lr}));var i=n(13),r=n.n(i),o=n(1),a=n.n(o),s=n(2),l=n.n(s),d=n(22),h=n.n(d),c=n(23),_=n.n(c),u=n(1032),p=function(){function e(t,n,i){a()(this,e),this._init(t,n,i)}return l()(e,[{key:"single_reset",value:function(e,t,n){this._init(e,t,n)}},{key:"_init",value:function(e,t,n){this.canvas=e,this.isNewCoorsystem=!0,this.node=n,this.ctx=t}},{key:"getTextpage",value:function(){return e.getTextpage(this.node)}},{key:"coorSystem",get:function(){return this.ctx.coordinateSystem}}],[{key:"getTextpage",value:function(e){for(var t=e;t&&!(t instanceof u.d);)t=t.parent;return t}}]),e}(),f=n(8),g=n.n(f),v=n(310),m=n(145),y=n.n(m),b=n(30),w=n.n(b),x=n(400),k=n(7375),C=new(function(){function e(){a()(this,e),this.svgInfo={circleBulletSvgContent:"circleBullet",rhombusBulletSvgContent:"rhombusBullet",head2RightBulletSvgContent:"head2RightBullet",checkbldBulletSvgContent:"checkbldBullet",squareBulletSvgContent:"squareBullet",xrhombusBulletSvgContent:"xrhombusBullet",cuspopenBulletSvgContent:"cuspopenBullet"},this.circleBulletSvgContent='<svg id="'+this.svgInfo.circleBulletSvgContent+'" viewBox="0 0 592 592" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M0 296Q0 418 86.50 505Q173 592 295 592Q418 592 505 505.50Q592 419 592 296Q592 173 505 86.50Q418 0 296 0Q173 0 86.50 86.50Q0 173 0 296Z"></path></g></svg>',this.rhombusBulletSvgContent='<svg id="'+this.svgInfo.rhombusBulletSvgContent+'" viewBox="0 0 837 838" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M0 418l419 419l418 -419l-418 -419z"/></g></svg>',this.head2RightBulletSvgContent='<svg id="'+this.svgInfo.head2RightBulletSvgContent+'" viewBox="0 0 1281 1480" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M0 0L1281 740L0 1480L428 740L0 0M135 134L485 740L1184 740L135 134Z"/></g></svg>',this.checkbldBulletSvgContent='<svg id="'+this.svgInfo.checkbldBulletSvgContent+'" viewBox="0 0 1432 1317" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M1352 0L1387 50Q1173 211 911 546Q649 941 511 1172L432 1229Q345 1286 312 1317Q299 1270 255 1163L227 1098Q167 958 115.50 891Q64 824 0 802Q108 688 198 688Q275 688 369 897L400 967Q569 682 834 393Q1099 144 1352 0Z"/></g></svg>',this.squareBulletSvgContent='<svg id="'+this.svgInfo.squareBulletSvgContent+'" viewBox="0 0 1036 1011" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M0 0v1011h1036v-1011h-1036z"/></g></svg>',this.xrhombusBulletSvgContent='<svg id="'+this.svgInfo.xrhombusBulletSvgContent+'" viewBox="0 0 1480 1480" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M300 440l-300 300l300 300l301 -300zM440 1180l300 300l301 -300l-301 -301zM1180 1040l300 -300l-300 -300l-300 300zM1040 300l-300 -300l-300 300l300 300z"/></g></svg>',this.cuspopenBulletSvgContent='<svg id="'+this.svgInfo.cuspopenBulletSvgContent+'" viewBox="0 0 1480 1480" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M0 790q267 12 448 166q226 192 243 524h99q21 -336 243 -524q179 -153 447 -166v-99q-268 -13 -448 -166q-226 -193 -243 -525h-98q-12 267 -167 448q-193 227 -524 243v99zM1209 740q-340 129 -469 469q-121 -339 -469 -469q165 -59 286.5 -181t182.5 -288q61 167 183 289t286 180z"/></g></svg>'}return l()(e,[{key:"getRatio",value:function(e){var t=this.svgInfo,n=t.circleBulletSvgContent,i=t.rhombusBulletSvgContent,r=t.head2RightBulletSvgContent,o=t.checkbldBulletSvgContent,a=t.squareBulletSvgContent,s=t.xrhombusBulletSvgContent,l=t.cuspopenBulletSvgContent,d=1;switch(e){case n:d=.4942;break;case i:d=.6997;break;case r:d=.6184;break;case o:d=.5483;break;case a:d=.4942;break;case s:case l:d=.6181}return d}}]),e}()),P=n(2293),S=n(2503),M=n(5739),I=n(6099),T=n(167),R=n(4576),N=n(3857),E=n(6098),A=n(4582),O=n(4746),L=new N.a;function F(e,t,n,i,r,o){var a=T.isMobile||window.APP.isWebMode()?r.papx:n.zone.parent.papx;D({canvasUnit:e,textLine:r,leaderType:function(e,t,n){var i=e.getProp("p_tab_leader"),r=void 0;r=i.def?t.getTabCapsInfo(n).leadType:i.val;return{leadingChar:Object(E.a)(r)||"\0",leaderType:r}}(n.chpx,a,n.tabPos).leaderType,ctx:t,glyphGroupInfo:n,rawInfo:i,baseFontStyle:o})}function D(e){var t=e.canvasUnit,n=e.textLine,i=e.leaderType,r=e.ctx,o=e.glyphGroupInfo,a=e.rawInfo,s=e.baseFontStyle,l=void 0===s?{}:s,d=window.APP.data,h=o.chpx,c=Object(E.a)(i)||"\0";if(i!==I.e&&i){var _=a.originX,u=a.originY,p=a.textBaseline,f={};(h.italic||"italic"===h.fontStyle)&&(f.fontStyle="italic"),h.bold||"bold"===h.fontWeight?f.fontWeight="bold":f.fontWeight="normal";var g=d.doc.getDCFontTable().getName(0),v=h.getProp?R.a.calcFontsize(h):h.fontSize;h.script_pos&&(v*=A.a);var m=void 0;m=null===o.character_scale||void 0===o.character_scale?1:o.character_scale/100,f.fontSize=""+v,f.fontFamily=g;var y=function(e){var t=e.char,n=e.fontSize,i=e.fontFamily,r=void 0===i?"Times New Roman":i;e.bold,e.italic;return L.getCharManorWithMeasure(t,{fontSize:n,fontFamily:r}).width}({char:c,fontSize:v,fontFamily:g,bold:h.bold,italic:h.italic});i===I.f?y>1&&(y-=.3):(y*=m,i===I.c&&(y+=.5));var b=[],w=o.widthSum,x=[],k=[];for(_-=y;w>y&&w>.1;)w-=y,b.push(c),_+=y,x.push(_),k.push(u);if(b.length>0){var C=o.revision||{},P=h.font_color||h.fontColor||"#000000",S=P,M=C.insert&&Object(O.isRevisionMarkVisible)(C.insert)&&d.doc.viewSettings.getRevisionsShowMarkup();M&&(S=d.selection.selCoop.getCooperatorColor(C.insert.userID)),r.save(),r.fontFace=f,r.fillStyle=S,r.textBaseline=p;var T=r.fillTextPos(b,x,k,l);if(M&&t){var N=n.renderInfo||n.parent.renderInfo;t.revisionSvgNodeManager.setRevisionText(n,o,P,S,T,N)}r.restore()}}}var B,j=n(1145),W=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments[4],o=window.APP.data.selection,a=o.selCoop,s=o.selRevision.activeRevisionInfo.activeRevision;for(var l in i){var d=i[l],h=d.strikeType,c=d.strikeLineWidth,_=d.yPos,u=d.strikeColor,p=d.revisionDeletion,f=d.revisionFormating,g=d.startX,v=d.endX,m=d.revisionUser;_+=t;var y=.5,b=Object(O.isRevisionMarkVisible)({user:m}),w=!1;if(s){var x=d.startPos,k=d.endPos,C=s.pos,P=s.len;w=x>=C&&C+P>=k}var S=!1;if(b&&(p||f)){var M=a.getCooperatorColor(d.revisionUserId);d.revisionColor=M,p?(h="single",e.strokeStyle=M,c=3,y=.5,e.saveAndSetAlpha(.7),S=!0):f&&(e.strokeStyle=w?u:M)}else e.strokeStyle=u;if(e.lineWidth=c,_=Math.round(_)-y,v>g){if("single"===h)e.beginPath(),e.moveTo(g,_),e.lineTo(v,_),e.stroke();else if("double"===h){var I=Math.max(c+2,3);e.beginPath(),e.moveTo(g,_),e.lineTo(v,_),e.moveTo(g,_-I),e.lineTo(v,_-I),e.stroke()}f&&b&&e.__currentElement&&n.revisionSvgNodeManager.setRevisionStrikethrough(d,e.__currentElement,r)}S&&e.restoreAlpha()}}},{key:"updateRevisionStrikethrough",value:function(e){var t=window.APP.data.selection.selRevision.activeRevisionInfo.activeRevision;e.forEach((function(e){var n=e.item,i=e.svgNode,r=n.strikeColor,o=n.revisionColor,a=n.revisionDeletion,s=!1;if(t){var l=n.startPos,d=n.endPos,h=t.pos,c=t.len;s=l>=h&&h+c>=d}i.setAttribute("stroke",s&&!a?r:o)}))}}]),e}(),U=n(324),z=(B={},w()(B,U.d,!0),w()(B,U.e,!0),w()(B,U.j,!0),w()(B,U.l,!0),w()(B,U.h,!0),w()(B,U.A,!0),w()(B,U.z,!0),B),G=function(e){function t(e,n,i,r){a()(this,t);var o=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.data=i,o.textNodeBuff=r,o}return _()(t,e),l()(t,[{key:"reset",value:function(e,n,i,r){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_init",this).call(this,e,n),this.data=i,this.textNodeBuff=r}},{key:"render",value:function(e,t,n,i,r,o,a){this.node=this.autonum=e,this.chpx=t,this.autoNumListInfo=n,this.baseFont=i,r.enter(e);var s=this._render(o,a);return r.exit(),s}},{key:"_isNonRenderChar",value:function(e){return z[e]}},{key:"_getRenderFontFamily",value:function(e){var t=window.APP.fontServer,n=e;return t.isFontNeedReplace2FallBackFont(e)?n=t.docFontFallBack.getSystemOnLoadFontName(e):t.isFontNeedReplace2EnglishFontName(e)?n=j.a.getPureFontName(e):t.isFontNeedReplace2SpecialSoveFontName(e)&&(n=t.docSystemFontFallBack.getSpecialSystemOnLoadFontName(e)),n}},{key:"_getRenderFontStyle",value:function(){var e=this.chpx,t=this._getRenderFontFamily(e.fontFamily),n=e.fontStyle,i=e.fontWeight,r=e.fontSize;return this.chpx.script_pos&&(r*=A.a),{fontStyle:n,fontWeight:i,fontSize:""+r,fontFamily:t}}},{key:"_renderStrikeLine",value:function(e,t){var n=this.chpx._chpx,i=this.line.parent.strikeInfos;if((n.strike||n.double_strike)&&i&&i.length>0){var r=i.length-1,o={startX:e.left,endX:e.right,yPos:i[r].yPos,strikeColor:n.font_color||i[r].strikeColor,strikeLineWidth:i[r].strikeLineWidth,strikeType:i[r].strikeType},a=this.line.parent,s=a.renderInfo||a.parent.renderInfo;W.render(this.ctx,t,this.canvas,[o],s)}}},{key:"_render",value:function(e,t){var n=this.autoNumListInfo,i=this.autonum.line.rect,r=x.a.initByOriginAndSize({x:e.x,y:e.y},i.size),o=this.ctx;o.markRestore();var a=n.isTaskList&&n.index==P.a;a&&o.saveAndSetAlpha(.4);var s=this.line.baseline,l=this.getTextpage(),d=l.textflow.corX,h=(this.line.parent.papx||this.line.parent.sublines&&this.line.parent.sublines[0].papx).vertical_align_mode||("T2B"===d||"B2T"===d?S.middle:S.alphabetic);if(n.isTaskList){var c=k.a.getImageSize();o.textAlign="start";var _=s-(c.height-2);if("top"==h?_=s-1:"middle"==h?_=s-c.height/2-1:"bottom"==h&&(_=s-c.height-1),!T.isIE&&o.use&&this.canvas.getTaskListUseId){var u=this.canvas.getTaskListUseId(n.index);u&&o.use(u,Math.round(r.left+(this.autonum.textPoss?this.autonum.textPoss[0]:0)),Math.round(r.top+_))}else{var p=void 0;switch(n.index){case P.b:p=k.a.todoImage;break;case P.a:p=k.a.doneImage}p&&o.drawImage(p,Math.round(r.left+(this.autonum.textPoss?this.autonum.textPoss[0]:0)),Math.round(r.top+_),c.width+1,c.height+1)}}else if(n.isBullet&&window.__CONFIG__.wps.enableBulletForSvg){if(o.use&&this.canvas.getBulletListId){var f=this.canvas.getBulletListId(n.index);if(f){var g=this.chpx,v=g.fontSize;g.script_pos&&(v*=A.a);var m=v*C.getRatio(f),y=(new M.a).calculateHeight(o,this.text,g);"top"==h?s+=y.ascent:"middle"==h?s+=y.ascent-y.height/2:"bottom"==h&&(s-=y.descent);var b=Object(A.b)(g._chpx.script_pos,h,y,r.top+s,r.left),w=b.scriptPosX,I=b.scriptPosY,R=.0845*v,N=this.autonum.textPoss?this.autonum.textPoss[0]:0,E={},O=l.footer_type&&!window.APP.data.selection.selContext.isInHeaderFooter;E.opacity=O?.6:o.globalAlpha||1,E.fill=g.fontColor;var L=Object.keys(E).reduce((function(e,t){return e+(t+": ")+E[t]+";"}),"");o.textAlign="start",o.use(f,w+R+N,I-m-1,{width:m,height:m,style:L})}}this._renderStrikeLine(r,s+t)}else{o.textAlign="start",o.fontFace=this._getRenderFontStyle(),o.fillStyle=this.chpx.fontColor;var F=this.chpx,D=(new M.a).calculateHeight(o,this.text,F);"top"==h?s+=D.ascent:"middle"==h?s+=D.ascent-D.height/2:"bottom"==h&&(s-=D.descent);var B=Object(A.b)(this.chpx._chpx.script_pos,h,D,r.top+s,r.left),j=B.scriptPosX,W=B.scriptPosY;if((!window.APP.data.doc.useCoreTypo||T.isMobile||window.APP.isWebMode())&&this.renderTabChars({top:W,left:j}),this.autonum.textPoss&&this.autonum.renderText&&o.fillTextPos){for(var U=this.autonum.textPoss,z=U.length,G=j,H=W.toFixed(2)+" ",V="",q="",Y="",X=0;X<z;++X){var Q=this.autonum.renderText[X];this._isNonRenderChar(Q.charCodeAt())||(V+=(G+U[X]).toFixed(2)+" ",q+=H,Y+=Q)}this.autonum.isBullet?o.fillTextPos(Y,V,q,this.baseFont):this.textNodeBuff.fillNormal(Y,V,q,1,1,this.baseFont)}else o.fillText(this.text,j,W);this._renderStrikeLine(r,s+t)}a&&o.restoreAlpha(),o.restoreStyle()}},{key:"renderTabChars",value:function(e){if(this.autonum.followTabInfo&&this.autonum.followTabInfo.leaderType!==I.e){var t=this.autonum.isBullet?0:this.chpx.fontSize/3,n={originX:e.left+this.autonum.followTabInfo.start+t,originY:e.top,textBaseline:""},i={character_scale:this.chpx._chpx.character_scale,chpx:this.chpx,widthSum:this.autonum.followTabInfo.end-this.autonum.followTabInfo.start-t};!function(e,t,n,i){D({leaderType:e,ctx:n,glyphGroupInfo:i,rawInfo:t})}(this.autonum.followTabInfo.leaderType,n,this.ctx,i)}}},{key:"line_origin",get:function(){return this.autonum.line_origin}},{key:"line",get:function(){return this.autonum.line}},{key:"text",get:function(){return this.autonum.text}},{key:"jcOffset",get:function(){return this.autonum.jcOffset}}]),t}(p),H=n(1142),V=function(){function e(){a()(this,e)}return l()(e,null,[{key:"renderStrike",value:function(e,t,n,i){var r=window.APP.data,o=r.doc.inlineAnchors.rangeClass.collectRanges(0,r.doc.getTextSize()).find((function(e){return e.shapeId===t}));if(o&&r.doc.viewSettings.getRevisionsShowMarkup()){var a=r.doc.textStream.getPureTextStream().getChpx(o.pos);if(a&&a.prop&&a.prop.revision&&a.prop.revision.delete){var s=a.prop.revision.delete.userID;e.save(),e.setLineWidth(2),e.strokeStyle=window.APP.data.selection.selCoop.getCooperatorColor(s),e.beginPath(),e.moveTo(n.left,n.top),e.lineTo(n.right,n.bottom),e.stroke();var l=r.selection.selRevision.activeRevisionInfo.activeRevision,d=l&&o.pos>=l.pos&&o.pos<=l.pos+l.len,h=e.save();h.setAttribute("visibility",d?"visible":"hidden"),i.revisionSvgNodeManager.setShapeRevision(o,h),e.beginPath(),e.moveTo(n.right,n.top),e.lineTo(n.left,n.bottom),e.stroke(),e.restore(),e.restoreStrokeStyle(),e.setLineWidth(1),e.restore()}}}},{key:"update",value:function(e,t){var n=t.selection.selRevision.activeRevisionInfo.activeRevision;e.forEach((function(e){var t=e.shapeInfo,i=e.svgNode,r=n&&t.pos>=n.pos&&t.pos<=n.pos+n.len;i.setAttribute("visibility",r?"visible":"hidden")}))}}]),e}(),q=function(e){function t(e,n,i,r,o,s,l){a()(this,t);var d=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,l));return d.data=i,d.glyphGroup=r,d.coor_pos2view=o.coor_pos2view,d.lineInfo=o,d.cell=s,d.viewPage=l.viewPage,d}return _()(t,e),l()(t,[{key:"isNeedClip",value:function(){var e=this.shape;return this.shapeRect.height>this.lineInfo.lineHeight&&e.isPicture}},{key:"render",value:function(){if(this.shape&&this.shape.renderInfo){if(!this.shape.renderInfo.needRerender)return;var e=this.shape.renderInfo.svgNode;try{e.parentNode.removeChild(e)}catch(e){}this.shape.cleanRenderInfo()}var t={shape:this.shape},n=this.shapeRect,i=this.ctx,r=this.getTextpage(),o=r.textflow,a=o.corX,s="T2B"==a||"B2T"==a,l=Math.round(n.left),d=Math.round(o.isReverseLine?r.rect.width-n.top-n.width:n.top);if(this.shape.renderInfo={x:l,y:d,svgNode:i.save(),line:this.node,renderRect:x.a.initByRawRect(n)},i.translate(l,d),s&&(i.save(),"T2B"==a?(i.translate(Math.round(0),Math.round(n.width)),i.rotate(Math.PI/180*270)):"B2T"==a&&(i.translate(Math.round(n.height),Math.round(0)),i.rotate(Math.PI/180*90))),this.isNeedClip()&&i.clipRect(0,this.lineInfo.line.rect.top-n.top,n.width,this.lineInfo.lineHeight),this.shape.renderScale){var h=this.shape.renderScale;i.scale(h,h)}t.svgNode=i.save("shape_"+this.shape.shape_tree_type+"_"+this.shape.id),i.restore(),s&&i.restore(),t.size=n.size,V.renderStrike(i,this.shape.id,{left:0,top:0,right:s?n.height:n.width,bottom:s?n.width:n.height},this.canvas),i.restore(),this.viewPage.renderEmbeds.push(t)}},{key:"shape",get:function(){return this.glyphGroup.shape}},{key:"shapeRect",get:function(){return this.glyphGroup.shape.rect}}],[{key:"calcShapePos",value:function(e,t){var n=p.getTextpage(t),i=n.textflow,r=e.rect;return{x:Math.round(r.left),y:Math.round(i.isReverseLine?n.rect.width-r.top-r.width:r.top)}}}]),t}(p),Y=n(7206),X=n(4577),Q=n(5738),Z=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _()(t,e),l()(t,[{key:"single_reset",value:function(e,n,i,r,o){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"single_reset",this).call(this,e,n),this.node=o,this.data=r,this.converse_info=i}},{key:"render",value:function(){var e=this.emphasisType;if(Y.c!==e){var t=this.converse_info,n=t.glyphGroupInfo,i=n.chpx.getPropVal("east_asia_language"),r=Object(Q.a)(i,e),o=r.renderAbove,a=r.renderText;if(a){var s=t.glyphBuff,l=this.ctx,d=t.originY+2*n.metrics.descent+2;"middle"===t.textBaseline&&(d=t.originY+n.metrics.height/2+2);var h=void 0,c=t.textPage;h=c.textflow.isReverseLine?c.rect.width-t.textline.rect.top:t.textline.rect.bottom,d=Math.min(d,h),d=t.originY-n.metrics.ascent+n.metrics.height-2,d=t.yPos?t.yPos+(o?-n.metrics.measureAscent:n.metrics.measureDescent+n.metrics.external):d;var _=t.originX,u=n.widths,p=0,f=this.converse_info.color;void 0===f&&this.converse_info.baseFont&&(f=this.converse_info.baseFont.fillStyle);var g=window.APP.fontServer,v=n.font,m=g.getFontName(v.fontFamily),y=v.fontSize,b=!1,w=0,x=0,k=g.getFontActualPaintBoxRelativeCenterPos(a,m),C=g.getFontActualPaintBoxSize(a,m);if(window.APP.isEnableEmphasisMeasurer()&&k&&C){var P=y/X.c;b=!0,w=k.x*P,x=o?C.height*P*.5:0}if(l.fillTextPos){for(var S=Array(u.length),M=Array(u.length),I=Array(u.length),T=n.beginOffset+t.textline.range.pos,R=T+u.length;T<R;++T,++p){var N=s.getMi(T),E=N&&N.realWidth?N.realWidth:u[p];M[p]=_+E/2-w,I[p]=d-x,S[p]=a,_+=u[p]}var A=l.fillTextPos(S,M,I,this.converse_info.baseFont);A&&A.setAttribute("text-anchor",b?"start":"middle")}else{l.textAlign="center",l.fillStyle=""+f;for(var O=n.beginOffset+t.textline.range.pos,L=O+u.length;O<L;++O){var F=s.getMi(O),D=F&&F.realWidth?F.realWidth:u[p];l.fillText(a,_+D/2-w,d),_+=u[p++]}l.textAlign="start"}}}}},{key:"emphasisType",get:function(){return this.converse_info.glyphGroupInfo.emphasis_type}}]),t}(p);H.a.buildInstance(Z);var K=n(723),J=n(8841),$=n(6743),ee=function(){function e(t,n,i,r,o,s,l){a()(this,e),this.ctx=t,this.textLine=o,this.glyphGroupInfo=n,this.charPos=i,this.charCode=r,this.docNormalCharMeasurer=new N.a,this.breakRenderWidth=l||0,this.yOffset=s}return l()(e,[{key:"render",value:function(){return this._render()}},{key:"_render",value:function(){if(window.APP.isReadOnly()||window.APP.isWebMode())return 0;if(window.APP.isMobileMode()){var e=this.glyphGroupInfo.revision||{};if(!window.APP.isCardMode&&!window.APP.isEditMode&&!(e.insert||e.format||e.delete))return 0}var t=this.textLine.rect,n=Object(O.getBaseCoordinate)(this.textLine,this.glyphGroupInfo),i=this.textLine.baseline,r=n.y,o=void 0,a=n.x;if(this.charCode===U.k&&this.textLine.isPageBrokenParaMark)o=192;else if(this.glyphGroupInfo.isLayoutRTL?(o=(a-=this.breakRenderWidth)-t.left,a=t.left):(a+=this.breakRenderWidth,o=t.right-a),o=Math.max(0,o),Math.round(a)>=Math.round(t.right)){var s=this.textLine.viewPage;o=(s.outer_rect.width-s.inner_rect.width)/2}if(window.localStorage&&!1===JSON.parse(window.localStorage.getItem("showParaMarks")))return o;var l=this._getNoticeText(),d=r+i+this.yOffset;this.ctx.save(),this.ctx.fontFace={fontSize:"12",fontFamily:"serif"};var h=this.docNormalCharMeasurer.getCharManorWithMeasure(l,{fontFamily:"serif",fontSize:12}).width;return this.ctx.beginPath(),this.ctx.lineWidth=1,this.ctx.setLineDash&&this.ctx.setLineDash([1,2]),this.ctx.moveTo(a,d),o>h+10&&(this.ctx.lineTo(a+o/2-h/2,d),this.ctx.moveTo(a+o/2+h/2,d)),this.ctx.lineTo(a+o,d),this.ctx.strokeStyle="#000000",this.ctx.stroke(),o>h+10&&(this.ctx.fillStyle="#000000",this.ctx.fillText(l,a+o/2-h/2,d)),this.ctx.restore(),o}},{key:"_getNoticeText",value:function(){var e="",t=this.charCode,n=this.charPos;switch(t){case U.m:var i=window.APP.data.doc.sections.getSection(n+1).data.private.props.markType;e=_i18n("applications.writer.components.core.render.breakRender.secBreak", "Section Break"),e+=i===J.a?"("+_i18n("applications.writer.components.core.render.breakRender.continue", "Continuous")+")":i===J.c?"("+_i18n("applications.writer.components.core.render.breakRender.nextColumn", "Next Column")+")":i===J.d||void 0===i?"("+_i18n("applications.writer.components.core.render.breakRender.nextPage", "Next Page")+")":i===J.b?"("+_i18n("applications.writer.components.core.render.breakRender.evenPage", "Even Page")+")":i===J.e?"("+_i18n("applications.writer.components.core.render.breakRender.oddPage", "Odd Page")+")":"";break;case U.i:e=_i18n("applications.writer.components.core.render.breakRender.columnBreak", "Column Break");break;case U.k:e=_i18n("applications.writer.components.core.render.breakRender.pageBreak", "Page Break")}return e}}],[{key:"renderLineBreak",value:function(e,t,n,i,r,o,a){if(window.APP.isWebMode())return 0;if(Object($.isEmpty)()||a.isHidden||!e.isVisible())return 0;var s=o===U.j,l=t.originX,d=t.originY+t.baseline+i;e.isLayoutRTL!==a.papx.bidi&&a.papx.bidi&&(l=a.endPos);var h=[6,-6,6,-2,6,-2,1,-2,2,-4,2,0,0,-2],c=[0,-6,0,-2,0,-2,5,-2,6,-2,4,0,4,-4];if(s){c=h=[5,-7,5,-2,3,-2,7,-2,5,0];for(var _=0;_<h.length/2;_++)c[2*_]-=2}a.papx.bidi?(l-=r+8,h=c):l+=r;for(var u=0;u<h.length/2;u++)h[2*u]+=l,h[2*u+1]+=d;return n.save(),n.translate(.5,.5),n.beginPath(),n.lineWidth=1,n.strokeStyle="#808080",s?(n.moveTo(h[0],h[1]),n.lineTo(h[2],h[3]),n.stroke(),n.moveTo(h[4],h[5]),n.lineTo(h[6],h[7]),n.lineTo(h[8],h[9])):(n.moveTo(h[0],h[1]),n.lineTo(h[2],h[3]),n.moveTo(h[4],h[5]),n.lineTo(h[6],h[7]),n.stroke(),n.moveTo(h[8],h[9]),n.lineTo(h[10],h[11]),n.lineTo(h[12],h[13])),n.closePath(),n.fillStyle="#808080",n.fill(),n.restore(),8}}]),e}(),te=n(411),ne=n(3081),ie=n(1731),re=n(2657),oe={"仿宋_GB2312":"仿宋"},ae="仿宋_GB2312",se=function(e){if(e&&e.fontFamily&&window.APP&&window.APP.fontServer&&window.APP.fontServer.docFontDraw&&window.APP.fontServer.docFontDraw.isFontAlreadyInSystem&&oe[e.fontFamily]&&window.APP.fontServer.docFontDraw.isFontAlreadyInSystem(oe[e.fontFamily])){if(e.fontFamily===ae&&!window.__CONFIG__.wps.forceReplaceSimSunGB2312)return e;e.fontFamily=oe[e.fontFamily]}return e},le=n(10086),de=n(12957),he=n(336),ce=void 0;function _e(e,t){var n=e;return(t.small_caps||t.caps)&&K.a.isLowerAlpha(n.codePointAt(0))&&(n=K.a.toUpperAlpha(n)),K.a.dealReplaceSpecChar(n)}function ue(e,t){return K.a.dealReplaceSpecChar(e)}var pe=void 0,fe=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _()(t,e),l()(t,[{key:"single_reset",value:function(e,n,i,r,o,a,s,l,d,h,c){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"single_reset",this).call(this,e,n),this.isMobile=window.APP.isMobileMode()||window.APP.isWebMode(),this.iGetCtx=d,this.textCtx=d.getCtx("main-content"),this.node=a,this.data=i,this.lineInfo=r,this.textflow=o,this.glyphBuff=i.glyphpool.glyphBuff,this.textline=a,this.typoContext=l,this.yOffset=c;var _=o?o.corX:"L2R";this.vertAlignMode=a.papx.vertical_align_mode||("T2B"===_||"B2T"===_?S.middle:S.alphabetic),d.getCtx("main-content").textAlign="left",this.baseFont=s,this.breakRenderWidth=0,ce||((ce=[])[U.d]=!0,ce[U.e]=!0,ce[U.j]=!0,ce[U.l]=!0,ce[U.h]=!0,ce[U.A]=!0,ce[U.z]=!0),pe=window.APP.data.doc.useCoreMeasure?_e:ue,this.textNodeBuff=h,this.textLineRangePos=a.range.pos}},{key:"getOrigin",value:function(e){return{x:e.x,y:this.isReverseLine?this.getTextpage().rect.width-e.y-this.textline.rect.height:e.y,baseline:this.lineInfo.baseline}}},{key:"isNonRenderChar",value:function(e,t){var n=window.localStorage&&JSON.parse(window.localStorage.getItem("showParaMarks"));return!(!T.isMobile&&K.a.isLineBreak(t))&&(!(n||!K.a.isSpace(t))||(!e.isVisible()&&!e.oMath||ce[t]&&!e.oMath||e.isDocumentFieldHidden))}},{key:"render",value:function(e,t,n,i){var o=this,a=this._getGlyphBuff(e),s=this._getGroupInfoPos(e),l=a.getCharCode(s);if(!this.isNonRenderChar(e,l)){var d=this.textCtx,h=this.getOrigin(e),c=e.script_pos,_=e.advance_pos;if(e.oMath){d.save("oMath");var u=e.oMath;d.translate(h.x,h.y+h.baseline-u.baseline+this.yOffset),u.render(d),d.restore();var p=u.getEmbeds();p&&p.forEach((function(e){new q(o.canvas,o.iGetCtx.getCtx("embed"),o.data,{shape:e.data.shape},o.lineInfo,o.cell,o.textline).render()}))}else{if(e.isTab()){var f=this.scriptPosHandler(c,h.x,h.y+h.baseline+this.yOffset,h,e.metrics,!1);return F(this.canvas,d,e,f,this.textline,this.baseFont)}if(K.a.isPageBreak(l)){var g=new ee(d,e,s,l,this.textline,this.yOffset,this.breakRenderWidth);this.breakRenderWidth+=g.render()}else if(K.a.isLineBreak(l)){if(window.localStorage&&!1===JSON.parse(window.localStorage.getItem("showParaMarks")))return;var v=window.APP.data,m=4===v.doc.getSubDocType(s)?v.doc.commentBodys.getCommentByPos(s):null;if(m&&"\n"===m.content)return;var y=this.scriptPosHandler(c,h.x,h.y,h,e.metrics,!1),b=ee.renderLineBreak(e,y,d,this.yOffset,this.breakRenderWidth,l,this.textline);this.breakRenderWidth+=b}else{d.fontFace=se(e.font);var w=e.zone.parent;if(w.inEqZone&&w.phoneticFont){var x=e.font;w.phoneticFont.fontFamily&&(x.fontFamily=w.phoneticFont.fontFamily),x.fontSize=w.phoneticFont.fontSize,d.fontFace=se(x)}if(e.isEmbedDrawing()){new q(this.canvas,this.iGetCtx.getCtx("embed"),this.data,e,this.lineInfo,this.cell,this.textline).render()}else{var k=void 0;if(e.isRealAsia&&"TRANSPOSE"===this.chardirect){d.textBaseline=S.alphabetic;var C=e.metrics.measureAscent+e.metrics.measureDescent,P=void 0;P="top"===this.vertAlignMode?-(h.y+h.baseline+C):"middle"===this.vertAlignMode?-(h.y+h.baseline+C/2):"bottom"===this.vertAlignMode?-(h.y+h.baseline):-(h.y+h.baseline+e.metrics.measureDescent);var M=h.x+e.metrics.measureAscent,I=this.scriptPosHandler(c,P,M,h,e.metrics,!0);I.textBaseline=S.alphabetic;var T=I;this.renderCharacter(T,e,c,!0,t,n,s,i)}else{var R=h.x,N=h.y+h.baseline,E=this.scriptPosHandler(c,R,N,h,e.metrics,!1);this.advancePosHandler(_,E);var A=E;this.renderCharacter(A,e,c,!1,t,n,s,i),k=A}if(e.emphasis_type){var O=e.character_scale,L=O?O/100:1;if(!k){var D=h.x,B=h.y+h.baseline;k=this.scriptPosHandler(c,D,B,h,e.metrics,!1)}this.renderEmphasis(r()({},k,{glyphBuff:a,glyphGroupInfo:e,horzScale:L,textline:this.textline,baseFont:this.baseFont,textPage:this.getTextpage()}))}}}}}}},{key:"scriptPosHandler",value:function(e,t,n,i,r,o){var a=this.vertAlignMode,s=Object(A.b)(e,a,r,n,t,o);return{originX:s.scriptPosX,originY:s.scriptPosY,baseline:i.baseline,textBaseline:a}}},{key:"advancePosHandler",value:function(e,t){var n=0;e&&0!==e&&(n=-Object(he.Ti2Px)(e)),t.originY+=n}},{key:"renderCharacter",value:function(e,t,n,i,r,o,a,s){var l=1,d=t.character_scale,h=d?d/100:1,c=r/h,_=o/h,u=e.originX,p=e.originY,f=e.textBaseline,g=this.textCtx;if(g.markRestore(),g.textBaseline=f,i){var v=h;h=l,l=v}var m=1!=h||1!=l,y=t.revision&&t.revision.insert,b=Object(O.isRevisionMarkVisible)(y)&&window.APP.data.doc.viewSettings.getRevisionsShowMarkup(),w=t.revision&&t.revision.insert&&!window.APP.data.doc.useCoreMeasure&&!window.APP.isPaginationMode(),x="#000000",k=!1;if(w){var C=window.APP.data.doc.viewSettings,P=C.getRevisionsShowMarkup();if(k=C.isRevisionsFinalView()&&!C.getRevisionsShowMarkup(),P){var S=(t.revision.insert||t.revision.format).userID;x=window.APP.data.selection.selCoop.getRevisionColor(S)}}var M=s&&a>=s.pos&&a<s.pos+s.len,I=void 0;if(!b||window.APP.isCooperationMode||!w||M||k){if(I=""+(t.font_color||Object(le.a)(this.typoContext.outShd,this.typoContext.outFontColor,this.lineInfo.papShd,Object(le.b)(t),this.typoContext.defaultColor)),t.isInTOCField()){var T=this.data.doc.stylesheet.findStyle(ie.b);T&&t.font_color===T.properties.chpx.font_color&&(I=""+this.typoContext.defaultColor)}t.isKWProtocolHyperlink&&(I=ne.o.color)}else I=x;"undefined"===I&&(I="#000000"),g.fillStyle=I;var R=t.widths,N=u/h,E=a-this.textLineRangePos,A=t.charDispOffsetX;A+=this.getCharCompressOffset(E),N+=A;var L=p/l,F=this._getGlyphBuff(t),D=this._getGroupInfoPos(t),B=F.getBuffs();if(g.fillTextPos){var j=this.textNodeBuff,W="",U="",z="",G=!1,H=0;i?(1!=l&&(L*=l,L+=t.metrics.measureAscent*(l-1),L/=l),N-=this.yOffset,B.forEach(D,D+R.length,(function(e,t,n){W+=t[n].char,U+=N.toFixed(2)+" ",z+=L.toFixed(2)+" ",L+=R[H]/l,++H}))):("top"===f?L+=t.metrics.measureAscent:"middle"===f?L+=t.metrics.measureAscent-(t.metrics.measureAscent+t.metrics.measureDescent)/2:"bottom"===f&&(L-=t.metrics.measureDescent),L+=this.yOffset,t.isCombine?(B.forEach(D,D+R.length,(function(e,n,i){W+=pe(n[i].char,t)})),U=N.toFixed(2),z=L.toFixed(2),G=!0):t.isLayoutRTL?(H=R.length-1,B.reverseForEach(D,D+R.length,(function(e,n,i){var r=N+R[H]/h;N>=_||r<=c||(W+=pe(n[i].char,t),U+=N.toFixed(2)+" ",z+=L.toFixed(2)+" "),--H,N=r}))):B.forEach(D,D+R.length,(function(e,n,i){var r=N+R[H]/h;N>=_||r<=c||(W+=pe(n[i].char,t),U+=N.toFixed(2)+" ",z+=L.toFixed(2)+" "),++H,N=r})));var V=t.isKWProtocolHyperlink;if(w&&!k&&b){var q=Object(de.supportReplaceEmoji)(W);if(G&&V&&q)this._drawCloudFieldImage(t,a,U,z,h,l);else{(m||i)&&(g.save(),i&&g.rotate(Math.PI/180*270),m&&g.scale(h,l));var Y=g.fillTextPos(W,U,z,this.baseFont);(m||i)&&g.restore();var X=t.zone.renderWithOutLine()?this.textline:t.zone.parent,Q=X.renderInfo||X.parent.renderInfo;this.canvas.revisionSvgNodeManager.setRevisionText(X,t,t.font_color||"#000000",x,Y,Q)}}else if(G){var Z=Object(de.supportReplaceEmoji)(W);V&&Z?this._drawCloudFieldImage(t,a,U,z,h,l):j.fillCombin(W,U,z,h,l,N+t.widthSum,this.baseFont)}else i?(j.setFontFace(t.font),j.setFillStyle(I),j.fillTranspose(W,U,z,h,l,this.baseFont)):t.isRTLChar?j.fillRTL(W,U,z,h,l,this.baseFont):j.fillNormal(W,U,z,h,l,this.baseFont)}else{if((m||i)&&(g.save(),i&&g.rotate(Math.PI/180*270),m&&g.scale(h,l)),i)for(var K=0,J=R.length;K<J;++K)g.fillText(F.getChar(D++),N,L),L+=R[K]/h;else for(var $=0,ee=R.length;$<ee;++$){var te=N+R[$]/h;N>=_||te<=c||g.fillText(F.getChar(D),N,L),++D,N=te}(m||i)&&g.restore()}e.yPos=L,e.xPos=N,g.restoreTextBaseline(),g.restoreFillStyle()}},{key:"getCharCompressOffset",value:function(e){var t=this.textline.lineMdInfo;if(!t)return 0;var n=t.dOffsetList.find((function(t){if(t.idx==e)return t})),i=0;return n&&(i=n.dOffset),i}},{key:"renderEmphasis",value:function(e){var t=e.glyphGroupInfo,n=t.beginOffset+this.textLineRangePos;"\r"===this.glyphBuff.getChar(n)||t.isSpace()||Z.getInstance(this.canvas,this.textCtx,e,this.data,this.textline).render()}},{key:"_getGlyphBuff",value:function(e){return e.zone&&e.zone.getGlyphBuff()||this.glyphBuff}},{key:"_getGroupInfoPos",value:function(e){var t=e.beginOffset+this.textLineRangePos;if(e.zone&&e.zone.isTextPartZone)if(e.zone.isNoteZone)t=e.beginPartOffset;else if(e.zone.isTextPartZone){t-=e.zone.getDataRange().pos}return t}},{key:"_drawCloudFieldImage",value:function(e,t,n,i,r,o){var a=this.data.doc.fields.getField(t),s=new re.a(this.data,a,t).getKWProtocolParams(),l=this.textNodeBuff.ctx;if(l&&l.use&&this.canvas.getCloudFileId){var d=this.canvas.getCloudFileId(s.fType);if(d){var h=e.font.fontSize,c=(e.chpx.spacing||0)/15,_=(e.widthSum/r-h-c)/2+parseFloat(n),u=parseFloat(i)+(e.metrics.descent-e.metrics.ascent-h)/2;l.use(d,_,u,{width:h,height:h,xScale:r,yScale:o})}}}},{key:"height",get:function(){return this.lineInfo.lineHeight}},{key:"chardirect",get:function(){return this.textflow.chardirect}},{key:"isReverseLine",get:function(){return this.textflow.isReverseLine}},{key:"host",get:function(){return this.lineInfo.host}},{key:"viewPage",get:function(){for(var e=this.lineInfo.host;e.layoutType!=te.DOCLayoutType.MobilePage&&e.parent;)e=e.parent;return e}},{key:"cell",get:function(){return this.lineInfo.cell}}]),t}(p),ge=fe;H.a.buildInstance(fe);var ve=n(908),me=n(1915),ye=n(1590),be=n(10407),we=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this,r=arguments[3],o=arguments[4],a=window.APP.data.selection,s=a.selCoop;n.forEach((function(n){var l=n.underlineType,d=n.yPos,h=n.underlineWidth,c=n.revisionFormating,_=n.startPos,u=n.endPos,p=n.startX,f=n.endX,g=n.revisionUser;if(l!==ye.wpsUnderlineNone||c){var v=Math.floor(Math.max(h+2,3));d+=t;var m=a.selRevision.activeRevisionInfo.activeRevision,y="#fc0d1b",b=!1;m&&_>=m.pos&&u<=m.pos+m.len&&(b=!0);var w=window.APP.data.doc.viewSettings.getRevisionsShowMarkup()&&Object(O.isRevisionMarkVisible)({user:g}),x=!window.APP.isPaginationMode()&&c&&w;x&&(y=s.getCooperatorColor(n.revisionUserId));var k=void 0,C=!b&&x&&!window.APP.isCooperationMode;if(x){var P=e.save();P.setAttribute("visibility",C?"hidden":"visible"),k=n.underlineColor,i.renderSingleUnderline(e,{underlineWidth:n.underlineWidth,item:n,startX:p,endX:f,yPos:d,lineSpacing:v,underlineType:l,underlineColor:k}),e.restore();var S=e.save();S.setAttribute("visibility",C?"visible":"hidden"),l=ye.wpsUnderlineDash,k=y,i.renderSingleUnderline(e,{underlineWidth:n.underlineWidth,item:n,startX:p,endX:f,yPos:d,lineSpacing:v,underlineType:l,underlineColor:k}),e.restore(),r.revisionSvgNodeManager.setRevisionUnderline(n,P,S,o)}else C?(l=ye.wpsUnderlineDash,k=y):k=n.underlineColor,i.renderSingleUnderline(e,{underlineWidth:n.underlineWidth,item:n,startX:p,endX:f,yPos:d,lineSpacing:v,underlineType:l,underlineColor:k})}}))}},{key:"updateRevision",value:function(e){var t=window.APP.data.selection.selRevision.activeRevisionInfo.activeRevision;e.forEach((function(e){var n=e.item,i=e.normalSvg,r=e.revisionSvg,o=n.startPos,a=n.endPos,s=!1;t&&o>=t.pos&&a<=t.pos+t.len&&(s=!0);var l=!window.APP.isCooperationMode&&(!s||s&&!window.APP.isEditMode&&!window.APP.isCardMode);i.setAttribute("visibility",l?"hidden":"visible"),r.setAttribute("visibility",l?"visible":"hidden")}))}},{key:"renderSingleUnderline",value:function(e,t){var n=t.underlineType,i=t.underlineWidth,r=t.underlineColor,o=t.startX,a=t.endX,s=t.yPos,l=t.lineSpacing;if(!(a<=o)){var d=s;switch(e.beginPath(),e.lineWidth=i,i<=1&&(d+=.5),e.strokeStyle=r,n){case ye.wpsUnderlineSingle:e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDouble:e.moveTo(o,d+l),e.lineTo(a,d+l),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineWords:e.setLineDash([1,1]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDash:e.setLineDash([8,4]),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDashHeavy:e.setLineDash([8,4]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDotDash:e.setLineDash([8,2,2,2]),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDotted:e.setLineDash([1,2]),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineThick:e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDotDotDashHeavy:e.setLineDash([8,3,2,3,2,3]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDotDashHeavy:e.setLineDash([8,3,2,3]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDottedHeavy:e.setLineDash([2,2]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDotDotDash:e.setLineDash([8,3,2,3,2,3]),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDashLongHeavy:e.setLineDash([12,3]),e.lineWidth=3*e.lineWidth,e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineDashLong:e.setLineDash([12,4]),e.moveTo(o,d),e.lineTo(a,d),e.stroke();break;case ye.wpsUnderlineWavy:Object(be.generatePathForWave)(e,{x:o,y:d},a-o),e.lineWidth=1,e.stroke();break;case ye.wpsUnderlineWavyHeavy:Object(be.generatePathForWave)(e,{x:o,y:d},a-o),e.lineWidth=2,e.stroke();break;case ye.wpsUnderlineWavyDouble:Object(be.generatePathForWave)(e,{x:o,y:d},a-o),Object(be.generatePathForWave)(e,{x:o,y:d+l},a-o),e.lineWidth=1,e.stroke()}e.restoreLineDash(),e.restoreStrokeStyle(),e.lineWidth=1}}}]),e}(),xe=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _()(t,e),l()(t,[{key:"reset",value:function(e,t,n,i,r,o){this._init(e,t,null),this.iGetCtx=r,this.textflow=n,this.data=i,this._isMobile=window.APP.isMobileMode()||window.APP.isWebMode(),this.textNodeBuff=o,this.textCtx=r.getCtx("main-content")}},{key:"render",value:function(e,t,n,i,r){this.node=this.linebase=e,this.isTaskListDone=n,this.typoContext=t,this.baseFont=i,this.yOffset=r,t.enter(this.linebase);var o=this._render();return t.exit(),o}},{key:"_render",value:function(){if(!(this.linebase.isSnippetLine||this.linebase.range.len<=0)){var e=this.typoContext.getCurrentCoor().node,t=ve.a.transvertPositionFromNode2Target(e,this.linebase.viewPage);if(!this.linebase.isMoc){var n=this.textCtx;n.restoreStyle();var i=this.range,r=this.getGlyphGroupsForRender();this.renderMainContent(i,r,t),n.markRestore()}this.linebase.inEqZone||this.renderEnclosure()}}},{key:"getGlyphGroupsForRender",value:function(){var e=this.linebase;return e.glyphGroupInfos.filter((function(t){return t.zone.renderWithOutLine(e)}))}},{key:"renderMainContent",value:function(e,t,n){var i=this.textCtx,r=this.isTaskListDone;r&&(i.saveAndSetAlpha(.4),this.textNodeBuff&&this.textNodeBuff.saveAndSetAlpha(.4)),this.renderChars(e,t,n);var o=this.baseline,a=this.getTextpage();if(a.textflow.isReverseLine){var s=this.rect;o+=a.rect.width-s.top-s.height-s.top}if(o+=this.yOffset,this.underlineInfos.length||this.strikeInfos.length){this.textNodeBuff&&this.textNodeBuff.commit();var l=this.linebase,d=l.renderInfo||l.parent.renderInfo;we.render(i,o,this.underlineInfos,this.canvas,d),W.render(i,o,this.canvas,this.strikeInfos,d)}r&&(i.restoreAlpha(),this.textNodeBuff&&this.textNodeBuff.restoreAlpha())}},{key:"renderChars",value:function(e,t,n){var i={line:this.linebase,baseline:this.baseline,lineHeight:this.rect.size.height,coor_pos2view:n,host:me.a.findHost(this.linebase),cell:me.a.findCell(this.linebase),papShd:this.linebase.papx&&this.linebase.papx.shading_back_color},r=Number.MAX_VALUE,o=-Number.MAX_VALUE;r>o&&(r=-Number.MAX_VALUE,o=Number.MAX_VALUE);var a=ge.getInstance(this.canvas,this.ctx,this.data,i,this.textflow,this.linebase,this.baseFont,this.typoContext,this.iGetCtx,this.textNodeBuff,this.yOffset),s=this.data.selection.selRevision.activeRevisionInfo.activeRevision;t.forEach((function(e){var t=e.x;t>=o||(t+e.widthSum<=r||e.zone&&e.zone.isEqZone||a.render(e,r,o,s))}))}},{key:"renderEnclosure",value:function(){var e=this.enclosures,t=this.textCtx,n=this.yOffset;e&&e.forEach((function(e){if(0!==e.border.borderType){var i=e.rect,r=e.border;t.markRestore(),t.strokeStyle=r.borderColor;var o=Math.max(Math.round(r.borderSize),1);t.setLineWidth(o);var a=o%2==0?0:.5;t.strokeRect(Math.round(i.left)+a,Math.round(i.top+n)+a,Math.round(i.size.width)-1,Math.round(i.size.height)-1),t.restoreStyle()}}))}},{key:"isSnippetLine",get:function(){return this.linebase.is_frame_line}},{key:"range",get:function(){return this.linebase.range}},{key:"rect",get:function(){return this.linebase.rect}},{key:"baseline",get:function(){return this.linebase.baseline}},{key:"width",get:function(){return this.rect.right-this.rect.left}},{key:"height",get:function(){return this.rect.bottom-this.rect.top}},{key:"autonum",get:function(){return this.linebase.auto_num}},{key:"glyphGroupInfos",get:function(){return this.linebase.glyphGroupInfos}},{key:"enclosures",get:function(){return this.linebase.enclosures}},{key:"underlineInfos",get:function(){return this.linebase.underlineInfos}},{key:"strikeInfos",get:function(){return this.linebase.strikeInfos}},{key:"shadingBackColorInfos",get:function(){return this.linebase.shadingBackColorInfos}},{key:"highlightColorInfos",get:function(){return this.linebase.highlightColorInfos}},{key:"blink",get:function(){return this.linebase.blink}},{key:"coopSelColorInfos",get:function(){return this.linebase.coopSelColorInfos}}]),t}(p),ke=function(e,t,n){e.forEach((function(e){t(e,n)}))},Ce=function(e,t,n){var i=e.lines;!i||i.length<=0||ke(i,t,n)},Pe=function(e,t,n){var i=e.lines;!i||i.length<=0||i.forEach((function(e){e.arr&&e.arr.length>0&&e.arr.forEach((function(e){e&&t(e,n)}))}))},Se=function(e,t,n){var i=e.lines;if(i&&!(i.length<=0)){var r=i[0],o=e.symbolInfo;if(o){var a=r.glyphGroupInfos[0],s=a.x,l=a.y,d=r.glyphGroupInfos[0].isDocumentFieldHidden,h=n.sublineRender.iGetCtx.getCtx("main-content");if(h.save(),h.translate(0,n.yOffset),o.font){var c=l+r.baseline/2+e.symbolInfo.charHeight/2;h.fontFace=e.symbolInfo.font,h.fillStyle=e.symbolInfo.color,(e.subSwitchs.lc||e.subSwitchs.bc)&&h.fillText(o.symbolChar,s-e.symbolInfo.charWidth,c),(e.subSwitchs.rc||e.subSwitchs.bc)&&h.fillText(o.symbolChar,s+r.rect.width,c)}else{if(e.subSwitchs.lc||e.subSwitchs.bc||o.symbolChar==e.switch.defSymbol){var _=o.leftSymbol;!d&&_&&_.render(h,!0)}if(e.subSwitchs.rc||e.subSwitchs.bc||o.symbolChar==e.switch.defSymbol){var u=o.rightSymbol;!d&&u&&u.render(h,!0)}}h.restore(),ke(i,t,n)}}},Me=function(e,t,n){var i=e.lines,r=n.sublineRender.iGetCtx.getCtx("main-content");r.save();var o=void 0;if(i&&i.length<=0){var a=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos}));o={x:a.x+a.widthSum,y:a.y}}else o={x:i[0].glyphGroupInfos[0].x,y:i[0].glyphGroupInfos[0].y};var s=e.lineWidth-e.dSwitchWidth,l=e.parent.baseline;if(e.subSwitchs.li){var d={x:o.x+e.dSwitchWidth,y:o.y+l},h={x:d.x-s,y:d.y};r.moveTo(Math.ceil(h.x),Math.ceil(h.y)+.5),r.lineTo(Math.ceil(d.x),Math.ceil(d.y)+.5)}r.lineWidth=1;var c=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos}));r.strokeStyle=c&&c.font_color?c.font_color:"#000000",r.stroke(),r.restore(),ke(i,t,n)},Ie=function(e,t,n){var i=e.lines;if(i&&!(i.length<=0)){var r=e.numline?e.numline.rect.width:e.denline.rect.width,o=e.denline?e.denline.rect.width:e.numline.rect.width,a=Math.max(r,o),s=n.sublineRender.iGetCtx.getCtx("main-content");s.save();var l=void 0;l=e.numline&&e.denline?Math.min(e.numline.glyphGroupInfos[0].x,e.denline.glyphGroupInfos[0].x):e.numline?e.numline.glyphGroupInfos[0].x:e.denline.glyphGroupInfos[0].x;var d=n.yOffset+(e.numline?e.numline.glyphGroupInfos[0].y+e.numline.baseHeight:e.denline.glyphGroupInfos[0].y),h=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos}));h.isDocumentFieldHidden||(s.moveTo(Math.ceil(l),Math.ceil(d)-.5),s.lineTo(Math.ceil(l+a),Math.ceil(d)-.5)),s.lineWidth=1,s.strokeStyle=h&&h.font_color?h.font_color:"#000000",s.stroke(),s.restore(),ke(i,t,n)}},Te=function(e,t,n){var i=e.lines;if(i&&!(i.length<=0)){var r=i[0],o=i[1],a=i[2],s=e.switchProp.color,l=e.switch.measureSymbol(e,r,o,a,e.symbolline),d=l.symbolPoint,h=l.symbolWidth,c=l.symbolHeight,_=n.sublineRender.iGetCtx.getCtx("main-content");if(_.save(),e.symbolline)t(e.symbolline,n);else{var u=e.switchProp.data;r.glyphGroupInfos[0].isDocumentFieldHidden||function(e,t,n,i,r,o,a){var s=o.commands,l=i/o.viewboxSize.width,d=r/o.viewboxSize.height;e.fillStyle=a,e.translate(t,n),e.scale(l,d),e.beginPath(),s.forEach((function(t){var n=t.cmd,i=t.args;switch(n){case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"L":e.lineTo(i[0],i[1]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"S":e.bezierCurToContinue(i[0],i[1],i[2],i[3]);break;case"Z":e.closePath()}})),e.fill()}(_,d.x,d.y+n.yOffset,h,c,u,s)}_.restore(),ke(i,t,n)}},Re=function(e,t,n){var i=e.lines;if(i&&!(i.length<=0)){var r=n.sublineRender.iGetCtx.getCtx("main-content"),o=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos})),a=o&&o.font_color?o.font_color:"#000000";if(e.hasRoot){var s=2==i.length?i[1]:i[0],l=e.switch.getRootInfo(s.baseHeight),d={x:s.glyphGroupInfos[0].x,y:Math.ceil(s.glyphGroupInfos[0].y-1)+.5+n.yOffset},h=[{x:d.x+s.rect.width,y:d.y},{x:d.x,y:d.y},{x:d.x-(l.topHalf-l.secHalf/2),y:d.y+s.baseHeight},{x:d.x-l.topHalf,y:d.y+l.topHalf},{x:d.x-(l.topHalf+l.gap),y:d.y+s.baseHeight/2}];if(r.save(),!o.isDocumentFieldHidden){r.moveTo(h[0].x,h[0].y);for(var c=1;c<h.length;c++)r.lineTo(h[c].x,h[c].y)}r.lineWidth=1,r.strokeStyle=a,r.stroke(),r.restore()}ke(i,t,n)}},Ne=function(e,t,n){var i=function(e,t){var n=t.begin,i=t.end;e.moveTo(Math.ceil(n.x),Math.ceil(n.y)+.5),e.lineTo(Math.ceil(i.x),Math.ceil(i.y)+.5)},r=function(e,t){var n=t.begin,i=t.end;e.moveTo(Math.ceil(n.x)+.5,Math.ceil(n.y)),e.lineTo(Math.ceil(i.x)+.5,Math.ceil(i.y+1))},o=e.lines,a=void 0,s=void 0,l=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos}));if(!o||o.length<=0)a={width:e.realWidth,height:e.realHeight},s={x:l.x+e.switch.boundEx.w/8,y:(e.heightInfo?e.heightInfo.maxAscent:e.parent.baseline)-e.switch.boundEx.h/4};else{for(var d=0,h=0,c=0;c<o.length;c++)o[c].baseHeight>d&&(h=c,d=o[c].baseHeight);var _=o[0],u=o[h];a={width:e.realWidth+2*e.switch.boundEx.w/3,height:e.realHeight+e.switch.boundEx.h/3},s={x:_.glyphGroupInfos[0].x-e.switch.boundEx.w/3,y:u.glyphGroupInfos[0].y-e.switch.boundEx.h/4+n.yOffset}}var p=n.sublineRender.iGetCtx.getCtx("main-content");p.save();var f={x:s.x,y:s.y},g={x:s.x+a.width,y:s.y},v={x:s.x,y:s.y+a.height},m={x:s.x+a.width,y:s.y+a.height},y=!0;l.isDocumentFieldHidden||(e.subSwitchs.le&&(i(p,{begin:f,end:v}),y=!1),e.subSwitchs.ri&&(i(p,{begin:g,end:m}),y=!1),e.subSwitchs.to&&(i(p,{begin:f,end:g}),y=!1),e.subSwitchs.bo&&(i(p,{begin:v,end:m}),y=!1),y&&(i(p,{begin:f,end:g}),i(p,{begin:v,end:m}),r(p,{begin:f,end:v}),r(p,{begin:g,end:m}))),p.lineWidth=1,p.strokeStyle=l&&l.font_color?l.font_color:"#000000",p.stroke(),p.restore(),ke(o,t,n)},Ee=function(){function e(){a()(this,e),this.switchMap={a:Pe,b:Se,d:Me,f:Ie,i:Te,l:Ce,o:Ce,r:Re,s:Ce,x:Ne}}return l()(e,[{key:"lineSeek",value:function(e,t,n){if(e.label&&e.label==U.n)return t(e.line,n);if(e.label){var i=this.switchMap[e.label];if(i)return i(e,t,n)}}},{key:"render",value:function(e,t,n,i,r,o,a){var s=this,l={isTaskListDone:n,sublineRender:i,typoContext:r,baseFont:o,yOffset:a};if(e.error){var d=i.iGetCtx.getCtx("main-content");if(d){d.save(),d.fontFace=e.errorInfo.font;var h=e.parent.glyphGroupInfos.find((function(t){return t.zone==e&&t.zone.typoRange.pos==e.typoRange.pos}));return d.fillText(e.errorInfo.code,h.x,h.y+e.parent.baseline+a),void d.restore()}}this.lineSeek(e,(function e(t,i){t&&t.inEqZone&&t.isIgnore||(i.sublineRender.render(t,i.typoContext,n,o,a),t.zones&&t.zones.length>0&&t.zones.forEach((function(t){t.isEqZone&&s.lineSeek(t,e,i)})))}),l)}}]),e}(),Ae=function(){function e(){a()(this,e)}return l()(e,[{key:"render",value:function(e,t,n,i,r,o,a){if(e.renderLeftBracket(i),e.renderRightBracket(i),!e.renderWithOutLine(t)){var s=function(e,t){e.forEach((function(e){e.beginOffset+=t,e.endOffset+=t}))};e.updateLinesRange(),s(e.firstLine.glyphGroupInfos,t.range.pos-e.firstLine.range.pos),s(e.secondLine.glyphGroupInfos,t.range.pos-e.secondLine.range.pos),i.render(e.firstLine,r,n,o,a),i.render(e.secondLine,r,n,o,a),s(e.firstLine.glyphGroupInfos,e.firstLine.range.pos-t.range.pos),s(e.secondLine.glyphGroupInfos,e.secondLine.range.pos-t.range.pos)}}}]),e}(),Oe=n(1318),Le=n(2956),Fe=n(6111),De=n(626),Be=n(4110),je=n(8842),We=n(10096),Ue=n(1591),ze=function(e){function t(){a()(this,t);var e=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sublineRender=new xe,e}return _()(t,e),l()(t,[{key:"reset",value:function(e,t,n,i,r,o,a){this._init(e,t,null),this.iGetCtx=o,this.textflow=n,this.data=i,this.textpageBaseFont=r,this.textNodeBuff=a,this.sublineRender.reset(e,t,n,i,o,a),this.autoNumRender&&this.autoNumRender.reset(e,o.getCtx("main-content"),this.data,a)}},{key:"isNeedClip",value:function(e){if(!e)return!1;var t=e.getProp("line_spacing");if(t.def)return!1;var n=t.val.rule;if("exact"===n)return!0;var i=t.val.value;if("auto"===n){if(i>=100)return!1;if(0===i)return!0;var r=this.line.viewPage.section;if(!r)return!1;var o=r.getSnapMode();if(!je.a.isUpdateChannelByAlignGrid({gridMode:o,snapToGrid:e.getPropVal("snap_to_grid")}))return!0}return!1}},{key:"render",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.isHidden){this.node=this.line=e,this.typoContext=t;var i=this.iGetCtx.getCtx("main-content"),r=this.line.papx||this.line.sublines&&this.line.sublines[0]&&this.line.sublines[0].papx,o=!1;if(this.isNeedClip(r)){var a=this.line.renderRect.height,s=this.line.parent,l=s&&s.textflow.corX,d=s&&s.parent,h=d&&(d.outer_rect||d.rect),c=d&&("T2B"==l||"B2T"===l?h.height:h.width)||this.line.rect.width,_=this.line.renderRect,u=s.textflow.isReverseLine,p=this.line.rect.left-c,f=u?s.rect.width-_.top-_.height:_.top,g=this.line.rect.width+2*c;this.textNodeBuff&&this.textNodeBuff.commit(),i.save(),i.clipRect(p,f+n,g,a),o=!0}var v=void 0,m=void 0;if(this.line.sublines&&this.line.sublines.length)this.line.sublines.some((function(e){if(e.glyphGroupInfos&&e.glyphGroupInfos.length&&(e.glyphGroupInfos.some((function(e){if(v=e.font){var t=e.font_color;return m=""+(t||"#000000"),!0}})),v))return!0}));else{var y=this.line.glyphGroupInfos;y&&y.some((function(e){if(v=e.font){var t=e.font_color;return m=""+(t||"#000000"),!0}}))}v&&i.setTextlineBaseFont&&(this.baseFont=i.setTextlineBaseFont(v,m,this.textpageBaseFont)),this.baseFont=this.textpageBaseFont;var b=this.autonum,w=b?b.getTaskOrBulletListInfo():this.isTaskOrBulletListInfo,x=w&&w.isTaskList&&w.index==P.a;b&&this.renderAutoNum(b,w,n),this.line.sublines&&this.line.sublines.length>0?this.renderSublines(x,n):this.renderLinebase(this.line,x,n),o&&(this.textNodeBuff.commit(),i.restore())}}},{key:"renderAutoNum",value:function(e,t,n){var i=(this.sublines?this.sublines[0].auto_num_pos:this.line.auto_num_pos)||De.a.ZERO(),r=this.typoContext;r.enter(this.line);var o=0;this.textflow.isReverseLine&&(o=this.getTextpage().rect.width-this.line.rect.top-this.line.rect.height-this.line.rect.top);var a=De.a.initWithOrigin({x:i.x,y:i.y+o+n});this.autoNumRender||(this.autoNumRender=new G(this.canvas,this.iGetCtx.getCtx("main-content"),this.data,this.textNodeBuff)),this.autoNumRender.render(e,t.isTaskList?{}:this.autoNumChpx,t,this.baseFont,r,a,n),r.exit()}},{key:"renderSublines",value:function(e,t){var n=this;this.sublines.forEach((function(i){i.range.len>0&&n.renderSubLine(i,e,t)}))}},{key:"renderLinebase",value:function(e,t,n){this.renderSubLine(e,t,n)}},{key:"renderSubLine",value:function(e,t,n){var i=this;this.sublineRender.render(e,this.typoContext,t,this.baseFont,n),e.zones&&e.zones.forEach((function(r){i.renderZone(r,e,t,i.sublineRender,i.typoContext,i.baseFont,n)}))}},{key:"renderZone",value:function(e,t,n,i,r,o,a){switch(e.type){case Ue.b.TwoLinesInOne:this.tliozoneRender||(this.tliozoneRender=new Ae),this.tliozoneRender.render(e,t,n,i,r,o,a);break;case Ue.b.EQField:this.eqzoneRender||(this.eqzoneRender=new Ee),this.eqzoneRender.render(e,t,n,i,r,o,a)}}},{key:"autonum",get:function(){return this.line.auto_num}},{key:"sublines",get:function(){return this.line.sublines}},{key:"isTaskOrBulletListInfo",get:function(){if(this.line.papx&&!this.line.papx.hasAutoNum())return!1;var e=this.line;this.line.sublines&&this.line.sublines.length>0&&(e=this.line.sublines[0]);var t=new We.a({papxs:[{prop:e.papx}],doc:this.data.doc});switch(t.indexInfo.index){case P.a:case P.b:return{isTaskList:!0,index:t.indexInfo.index};case Fe.b:case Fe.f:case Fe.e:case Fe.g:case Fe.d:case Fe.a:case Fe.c:return{isBullet:!0,index:t.indexInfo.index}}return{isTaskList:!1,isBullet:!1}}},{key:"autoNumChpx",get:function(){var e=this.line.auto_num.chpx;if(!e){var t=this.line.range.pos,n=this.data.doc.getDataLogic("final"),i=n.getPapx(t),r=this.data.doc.autoNumMgr,o=i.prop.list_id,a=i.prop.hasAutoNum()&&r.findAutoNum(o);if(a){var s=i.prop.list_level;a.levels.length>0&&s>=a.levels.length&&(s=a.levels.length-1),a.levels[s].chpx&&(e=a.levels[s].chpx.duplicate())}var l=n.getChpx(i.pos+i.len,v.IT.Exclude).prop;e&&l?Be.a.union(l,e):e=e||l}var d=Object(he.Ti2Px)(parseInt(e.getPropVal("font_size_normal")||e.getPropVal("font_size_cs"),10))||14,h=Oe.c.DOCCharTypeFastDetecter,c=this.line.auto_num,_="";if(c.text.length){var u=void 0;switch(h.getUnicodeCharItem(c.text[0].charCodeAt(0)).charClass){case Oe.a.CC_FarEast:u=e.getPropVal("font_name_asia_east");break;case Oe.a.CC_Ascii:u=e.getPropVal("font_name_ascii");break;case Oe.a.CC_Shared:var p=e.getPropVal("share_hint");p===Le.c?u=e.getPropVal("font_name_asia_east"):p===Le.a?u=e.getPropVal("font_name_complex"):p===Le.b&&(u=e.getPropVal("font_name_ftcbi"));break;case Oe.a.CC_NoFarEast:u=e.getPropVal("font_name_complex");break;case Oe.a.CC_Complex:u=e.getPropVal("font_name_ftcbi");break;default:u=e.getPropVal("font_name_complex")}_=this.data.doc.fonttable.getName(u),window.APP.fontServer.requestLoadFontResource({family:_},this.line.range)}for(var f=!1,g=0;g<c.text.length;++g){var m=c.text.charCodeAt(g);if(m>=61440&&m<=61695){f=!0;break}}var y=!f&&e.getPropVal("italic")?"italic":"normal",b=!f&&e.getPropVal("bold")?"bold":"normal";return{fontFamily:_,fontSize:d,fontWeight:b,fontStyle:y,script_pos:e.script_pos,font:(y+" "+b+" "+d+'px "'+_+'"').trim(),fontColor:e.getPropVal("font_color")?e.getPropVal("font_color"):"#000000",_chpx:e}}}]),t}(p),Ge=n(772),He=n(1403),Ve=n(2011),qe=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(e,t){var n=t.layers;if(n){var i=void 0,r=void 0;n.topCards&&n.topCards.forEach((function(o){o.isWrap&&(i||(i=e.getCtx("wrap"),n.renderInfo||(n.renderInfo={}),r=n.renderInfo.svgNode,n.renderInfo.svgNode=i.save("cell-layers",r),r?r.setAttribute("transform","translate("+Math.round(t.rect.left+t.parent.rect.left)+", "+Math.round(t.rect.top)+")"):i.translate(Math.round(t.rect.left+t.parent.rect.left),Math.round(t.rect.top)),i.resetInsertPos()),o.renderInfo?i.seekNextInsertPos():(o.renderInCell=!0,o.renderInfo={svgNode:i.save("shape_"+o.shape_tree_type+"_"+o.id),needFirstRender:!0},i.restore()))})),i&&i.restore(!1,!!r)}}}]),e}(),Ye=function(e){function t(){a()(this,t);var e=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._docTextpageRender=new Zt,e}return _()(t,e),l()(t,[{key:"getCtx",value:function(e){var t=this._ctxs[e];if(!t){t=this._ctxs[e]=this.parentIGetCtx.getCtx(e);var n=this.renderInfo&&this.renderInfo.renderSvgs&&this.renderInfo.renderSvgs[e];"revision-lines"===e?t.save(null,n):this._doSaveAndClip(t,n)}return t}},{key:"reset",value:function(e,t,n,i){this._init(e,t,null),this.parentIGetCtx=i,this.data=n,this.isMobile=window.APP.isMobileMode()||window.APP.isWebMode(),this._ctxs={}}},{key:"render",value:function(e,t,n,i,r){var o=this;this.cell=this.node=e,this.tableStyle=t,this.style=n,this.typoContext=i,e.renderInfo||(e.renderInfo={renderUnits:{},renderSvgs:{}}),this.typoContext.enter(this.cell);var a=x.a.getRectByRectAndOffset(this.style.shd_rect,{x:this.typoContext.position.x,y:0}),s=this.renderCellBackground(a),l=i.outShd;s&&(i.outShd=s),this.cell.is_diag_cell?this.cell.diagCell.pages.forEach((function(e){o.docTextpageRender.render(e,!1,i,{yOffset:r})})):this.cell.cell_page&&this.docTextpageRender.render(this.cell.cell_page,!1,i,{yOffset:r}),i.outShd=l,qe.render(this,this.cell),this.typoContext.exit(),this._commitCtxs(),delete e.renderInfo.expired}},{key:"_commitCtxs",value:function(){var e=this;Object.keys(this._ctxs).forEach((function(t){var n=e._ctxs[t],i=n.currentNode;n.restore(!0)&&(e.renderInfo.renderSvgs[t]=i)}))}},{key:"_doSaveAndClip",value:function(e,t){var n=e.save(null,t);if(!t){var i=this.mergeType,r=this.cell.parent,o=r.rect.height,a=Math.round(r.maxBottomBorder||0);if(i===Ge.e.FIRST){var s=this.lastMergeCell;if(s&&s.parent)o=s.parent.rect.bottom-r.rect.top}var l=this.cell.rect.left+r.rect.left,d=this.cell.rect.top,h=this.cell.rect.width,c=Math.max(0,o-a);e.clipRect(l,d,h,c)}return n}},{key:"renderCellBackground",value:function(e){if(this.style.shd){var t=this.style.shd.backColor,n=new He.a(t),i=e.left,r=e.top,o=e.width,a=e.height;if(Ge.e.MIDDLE!==this.mergeType&&Ge.e.LAST!==this.mergeType){var s=n.colorEx;if("#ffffffffff000000"!==s){if(!this.cell.renderInfo.renderSvgs["cell-shd"]){var l=this.getCtx("cell-shd"),d=l.save();l.markRestore(),l.fillStyle=s,l.fillRect(i,r,o,a),l.restoreStyle(),l.restore(),this.cell.renderInfo.renderSvgs["cell-shd"]=d}return s}}}}},{key:"renderInfo",get:function(){return this.node.renderInfo}},{key:"docTextpageRender",get:function(){return this._docTextpageRender.reset(this.canvas,null,this.data,this),this._docTextpageRender}},{key:"mergeType",get:function(){return this.cell.merge_type}},{key:"posType",get:function(){return this.cell.pos_type}},{key:"range",get:function(){return this.cell.cell_page?this.cell.cell_page.range:null}},{key:"linePosType",get:function(){return this.cell.parent.position_in_page}},{key:"lastMergeCell",get:function(){for(var e=this.cell.rect.left,t=this.cell.rect.right,n=this.cell.parent,i=n.parent.lines,r=this.cell,o=i.indexOf(n)+1,a=i.length;o<a;++o){var s=i[o];if(!(s instanceof Ve.a))break;for(var l=s.tablecells,d=!1,h=0,c=l.length;h<c;++h){var _=l[h];if(!(_.rect.right<e||_.rect.left>t)&&(_.merge_type&&_.merge_type!=Ge.e.NONE)){d=!0,r=_;break}}if(!d)break}return r}}]),t}(p),Xe=n(7376),Qe=function(e){function t(){a()(this,t);var e=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.cellRender=new Ye,e}return _()(t,e),l()(t,[{key:"getCtx",value:function(e){var t=this._ctxs[e];if(!t){this._ctxs[e]=t=this.parentIGetCtx.getCtx(e);var n=this.renderInfo&&this.renderInfo.renderSvgs&&this.renderInfo.renderSvgs[e];t.save(null,n),n||t.translate(0,this.node.rect.top)}return t}},{key:"reset",value:function(e,t,n,i){this._init(e,t,null),this.parentIGetCtx=i,this.data=n,this._ctxs={}}},{key:"_commitCtxs",value:function(){var e=this,t=this.node.parent.renderInfo,n=this.node.rect.top,i=Object.keys(this._ctxs),r=this.node.renderInfo;i.forEach((function(i){var o=e._ctxs[i],a=o.currentNode;o.restore(!0)&&(r.renderSvgs[i]=a,t.renderUnits[i]||(t.renderUnits[i]=[]),t.renderUnits[i].push({y:n,lineRenderInfos:[r],svgNode:a}))}))}},{key:"render",value:function(e,t){this.node=this.linebase=e,e.renderInfo||(e.renderInfo={renderUnits:{},renderSvgs:{}}),e.renderInfo.renderUnits||(e.renderInfo.renderUnits={}),e.renderInfo.renderSvgs||(e.renderInfo.renderSvgs={}),this.typoContext=t,t.enter(this.linebase),this._render(),t.exit()}},{key:"_render",value:function(){var e=this,t=this.linebase.tablecells,n=Xe.a.init(this.linebase,this.data),i=this.cellRender,r=this.typoContext,o=this.canvas,a=this.data,s=-this.linebase.rect.top;t.forEach((function(t,l){var d=n.getCellStyle(l,t);t.style=d,i.reset(o,null,a,e),i.render(t,n,d,r,s)})),this._commitCtxs()}},{key:"renderInfo",get:function(){return this.node.renderInfo}}]),t}(p),Ze=n(3080),Ke=n(1807),Je=n(4579),$e=n(1916),et=n(1252),tt=n(684),nt=n(4974),it=n(6110),rt=n(984),ot=new(function(){function e(){a()(this,e)}return l()(e,[{key:"render",value:function(t,n){var i=this,r=void 0,o=void 0,a=t.renderInfo.renderUnits["table-border"]||[],s=function(){if(r){var s=void 0,l=0,d=void 0,h=void 0,c=!1;if(window.APP.data.typoMode!==tt.TYPO_MODE.MODE_PC&&window.APP.data.typoMode!==tt.TYPO_MODE.MODE_PAGINATION&&t.parent.layoutType===et.c.MobilePage){c=!0;var _=t.parent;l=Math.round(_.rect.bottom)-(Math.round(_.rect.top)+Math.round(_.rect.height)),_.renderInfo.extendHeightForTableBorder=l;var u=!_._nextTable&&t.lines[t.lines.length-1].isLastTable;h=_.getTableWidth(),_._prevTable?(s=u?Je.d:Je.c,d=e.getLastTableBottomBorder(_._prevTable)):s=u?Je.b:Je.a}var p=i.processTableBorder(r,s,l,d,h,c);if(p.length){o||(o=n.getCtx("table-border"));var f=!1,g=!1,v=r.map((function(e){var t=e.renderInfo;return t.needRefreshTableBorder?(f=!0,g=!0):t.needRenderTableBorder?f=!0:g=!0,t}));if(f){if(g)for(var m=function(e){var t=a[e],n=!1;v.some((function(e){if(t.lineRenderInfos.includes(e))return n=!0,!0})),n&&(t.svgNode.parentNode.removeChild(t.svgNode),a.splice(e,1))},y=a.length-1;y>=0;--y)m(y);var b=r[0].rect.top,w={svgNode:o.save(),y:b,lineRenderInfos:v};o.translate(0,b),p.forEach((function(e){var t=e.from,n=e.to,r=e.style,a=e.clipRect,s=r||{type:0},l=s.color,d=new He.a(l).color,h=Xe.a.getBorderWidth(s),_=h/2;c||(t.y==n.y?(t.x-=_,n.x+=_):t.x==n.x&&(t.y-=_,n.y+=_)),a&&(o.save(),o.clipRect(a.left,a.top-b,a.width,a.height)),o.beginPath(),0!==h||rt.getStatus(rt.types.NOT_SHOW_DASHED_BORDER)||(h=.5,d="#c8c8c8"),o.lineWidth=h,i.processBorderType(o,s.type),o.moveTo(t.x,t.y-b),o.lineTo(n.x,n.y-b),o.strokeStyle=d,o.stroke(),a&&o.restore()})),o.restore(),a.push(w)}}r=null}},l=window.APP.data.doc.viewSettings.isRevisionsFinalView(),d=null;t.lines.forEach((function(e){if(e.layoutType===et.c.TableLine&&e.tablecells){if(l){var t=e.range;if((!d||t.begin<d.begin||t.end>d.end)&&(d=i.getDeleteRevision(t)),d&&d.begin<=t.begin&&d.end>=t.end)return}var n=e.tablecells&&e.tablecells.length>0;if(e.rect.height<=0&&!n&&e.hasMergedCell)return;r?r.push(e):r=[e]}else s()})),r&&s(),a.length?t.renderInfo.renderUnits["table-border"]=a:delete t.renderInfo.renderUnits["table-border"]}},{key:"getHorizontalPath",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments[4],a=arguments[5],s=arguments[6],l=arguments[7],d=Xe.a.getBorderWidth(e);if(0!==d||!rt.getStatus(rt.types.NOT_SHOW_DASHED_BORDER)){var h=0;l&&d!==Math.floor(d)&&(h=i&&o?.5:-.5);var c=i?t.top:t.bottom+a,_={from:{x:t.left,y:c+h},to:{x:t.right,y:c+h},style:e};if(n.has(c)||n.set(c,{top:[],bottom:[]}),i)if(s){var u=[_];s.forEach((function(e){for(var t=u.length-1;t>=0;--t){var n=u[t];if(JSON.stringify(n.style)===JSON.stringify(e.style)&&!(e.left>=n.to.x||e.right<=n.from.x))if(e.left<=n.from.x)e.right>=n.to.x?u.splice(t,1):n.from.x=e.right;else if(e.right<n.to.x){n.to.x=e.left;var i={from:{x:e.right,y:n.from.y},to:r()({},n.to),style:n.style};u.push(i)}else n.to.x=e.right}})),u.length&&u.forEach((function(e){n.get(c).top.push(e)}))}else n.get(c).top.push(_);else n.get(c).bottom.push(_)}}},{key:"getVerticalPath",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments[8],d=Xe.a.getBorderWidth(e);if(0!==d||!rt.getStatus(rt.types.NOT_SHOW_DASHED_BORDER)){var h=0;l&&d!==Math.floor(d)&&(h=i&&r?-.5:.5);var c=i?t.right:t.left,_={from:{x:c+h,y:t.top+(o&&!a?-1:0)},to:{x:c+h,y:t.bottom+s},style:e};n.has(c)?n.get(c).push(_):n.set(c,[_])}}},{key:"processTableBorder",value:function(t,n,i,r,o,a){var s=this,l=[],d=new Map,h=new Map,c=new Map,_=[],u=[],p=null;return t.forEach((function(f,v){var m=f.tablecells,y=f.position_in_table,b=f.isRTL,w=void 0;if(void 0!==n)switch(n){case Je.b:w=1===t.length?Je.b:0===v?Je.a:v===t.length-1?Je.d:Je.c;break;case Je.a:w=0===v?Je.a:Je.c;break;case Je.c:w=Je.c;break;case Je.d:w=v===t.length-1?Je.d:Je.c}else w=y;var x=v===t.length-1?i:0;m.forEach((function(t,i){var f=t.style,m=f.border,y=f.rowStyle;m||y||(m=y=Object.create(null)),y?m||(m={}):y=m;var k=e.getAbsoluteReact(t,a),C=m.top||y.top,P=m.bottom||y.bottom,S=m.right||y.right,M=m.left||y.left,I=!1;switch(w){case Je.a:P=m.bottom||y.insideH,I=!0;break;case Je.c:P=m.bottom||y.insideH,C=m.top||y.insideH;break;case Je.d:C=m.top||y.insideH;break;case Je.b:I=!0}var T=!1,R=!1,N=!1,E=!1;switch(t.merge_type){case Ge.e.NONE:R=T=!0;break;case Ge.e.FIRST:T=!0,R=w===Je.b||w===Je.d;break;case Ge.e.MIDDLE:R=w===Je.b||w===Je.d,T=0===v||w===Je.b||w===Je.a;break;case Ge.e.LAST:R=!0,T=0===v||w===Je.b||w===Je.a}if(T&&s.getHorizontalPath(C,k,d,!0,I,x,r,a),R&&s.getHorizontalPath(P,k,d,!1,I,x,null,a),b){var A=k.left;k.left=k.right,k.right=A}var O=!1;switch(t.position_in_line){case Je.c:M=m.left||y.insideV,S=m.right||y.insideV,E=!0;break;case Je.d:M=m.left||y.insideV,N=E=!0,O=void 0===o||k.right>=o-1;break;case Je.b:M=m.left||y.left,S=m.right||y.right,N=E=!0,O=void 0===o||k.right>=o-1;break;case Je.a:E=!0,S=m.right||y.insideV}if(i>0&&(M&&M.type!==$e.l||(M=p),p&&p.lineWidth>M.lineWidth&&(M=p)),E&&s.getVerticalPath(M,k,h,!1,O,void 0!==n,I,x,a),N&&s.getVerticalPath(S,k,h,!0,O,void 0!==n,I,x,a),t.merge_type!==Ge.e.NONE){var L=k.left+"-"+k.right;c.has(L)?c.get(L).nextMergedCell=t:(_.push(t),u.push(t)),t.merge_type===Ge.e.LAST?c.delete(L):c.set(L,t)}else l.push.apply(l,g()(s.getDiagonalLine(t,a))),l.push.apply(l,g()(s.getWpsDiagonalLine(t)));p=S||{lineWidth:0}}))})),l.push.apply(l,g()(this.mergeHorizontalLines(d,a))),l.push.apply(l,g()(this.mergeVerticalLines(h,a))),_.forEach((function(e){l.push.apply(l,g()(s.getDiagonalLine(e,a)))})),u.forEach((function(e){l.push.apply(l,g()(s.getWpsDiagonalLine(e)))})),l}},{key:"processBorderType",value:function(e,t){if(void 0!==t&&void 0!==e)switch(e.restoreLineDash(),t){case $e.l:e.setLineDash([3,1]);break;case $e.n:break;case $e.f:e.setLineDash([1,1]);break;case $e.e:e.setLineDash([3,1]);break;case $e.d:e.setLineDash([4,4]);break;case $e.a:e.setLineDash([7,3,3,3]);break;case $e.b:e.setLineDash([6,2,2,2,2,2]);break;case $e.g:case $e.y:case $e.u:case $e.r:case $e.x:case $e.t:case $e.q:case $e.w:case $e.s:case $e.p:case $e.v:case $e.o:case $e.h:case $e.c:case $e.i:case $e.j:case $e.m:case $e.k:}}},{key:"getDiagonalLine",value:function(t,n){var i=[],r=void 0;if(t.style.border){var o=t.style.border,a=o.tr2Bl,s=o.tl2Br,l=[],d=t,h=t;l.push(a),l.push(s),l.forEach((function(t,o){if(t){var a=t.type,s=t.lineWidth;if(a!==$e.l&&0!==s){for(;h.nextMergedCell;)h=h.nextMergedCell;var l=e.getAbsoluteReact(d,n),c=e.getAbsoluteReact(h,n);r={from:1===o?{x:l.left,y:l.top}:{x:l.right,y:l.top},to:1===o?{x:c.right,y:c.bottom}:{x:c.left,y:c.bottom},style:t},i.push(r)}}}))}return i}},{key:"getWpsDiagonalLine",value:function(t){var n=[];if(t.diagCell){for(var i=t.style.diagonals,r=e.getAbsoluteReact(t),o=r.left,a=r.top,s=t;s.nextMergedCell;)s=s.nextMergedCell;var l=e.getAbsoluteReact(s),d=l.right,h=l.bottom;t.diagCell.diags.forEach((function(e,t){if(0!==t){var r=e.start,s=e.end,l={from:{x:o+Object(he.Ti2Px)(r.x),y:a+Object(he.Ti2Px)(r.y)},to:{x:o+Object(he.Ti2Px)(s.x),y:a+Object(he.Ti2Px)(s.y)},style:i[t-1].Border,clipRect:{left:o,top:a,width:d-o,height:h-a}};n.push(l)}}))}return n}},{key:"mergeVerticalLines",value:function(e,t){var n=[],i=null;return e.forEach((function(e){e.forEach((function(e){if(i){var t=JSON.stringify(e.style)===JSON.stringify(i.style);t&&i.to.y===e.from.y?i.to=e.to:t&&e.to.y<=i.to.y||(i=e,n.push(i))}else i=e,n.push(i)})),i=null})),t&&n.forEach((function(e){e.from.x!==Math.floor(e.from.x)&&(e.from.y+=.5,e.to.y-=.5)})),n}},{key:"mergeHorizontalLines",value:function(e,t){var n=this,i=[],r=null;return e.forEach((function(e){var t=e.top,o=e.bottom,a={},s=t,l=!1,d=o.length>0||t.length>0;o.length>0&&t.length>0&&(l=o.length!==t.length||o.some((function(e,n){return e.from.x!==t[n].from.x||e.to.x!==t[n].to.x})));var h=[];if(l||!rt.getStatus(rt.types.NOT_SHOW_DASHED_BORDER)&&d){var c=[],_=[];o.forEach((function(e){return c.push(e.from.x,e.to.x)})),s.forEach((function(e){return c.push(e.from.x,e.to.x)})),[].concat(g()(new Set(c))).sort((function(e,t){return e-t})).reduce((function(e,t){return _.push({left:e,right:t}),t})),_.forEach((function(e){var t=void 0,n=e.left,i=e.right,r=o.find((function(e){return e.from.x<=n&&e.to.x>=i})),a=s.find((function(e){return e.from.x<=n&&e.to.x>=i}));(t=r&&r.style&&r.style.type===$e.l&&a||!r||!r.style&&a?a:r&&r.style&&a&&a.style?r.style.lineWidth>=a.style.lineWidth?r:a:r)&&h.push({from:{x:n,y:t.from.y},to:{x:i,y:t.from.y},style:t.style})}))}else n.merge(o).forEach((function(e){var t=e.left,i=e.right,r=[];s.forEach((function(e){if(!e.discard){var o=e.from.x,a=e.to.x;o>=t&&a<=i||(o<i&&a>t?n.cut(t,i,{left:o,right:a}).forEach((function(t){r.push({from:{x:t.left,y:e.from.y},to:{x:t.right,y:e.from.y},style:e.style})})):r.push(e))}})),s=r})),h=[].concat(g()(s),g()(o));h.sort((function(e,t){return e.from.x-t.from.x})),h.reverse().forEach((function(e){if(r){if(JSON.stringify(e.style)===JSON.stringify(r.style)&&r.from.x===e.to.x)r.from=e.from,r.to.y=e.to.y;else{var t=e.from.x+"-"+e.to.x;a[t]||(r=e,i.push(r),a[t]=!0)}}else{var n=(r=e).from.x+"-"+r.to.x;a[n]||(i.push(r),a[n]=!0)}})),r=null})),t&&i.forEach((function(e){e.from.y!==Math.floor(e.from.y)&&(e.from.x+=.5,e.to.x-=.5)})),i}},{key:"merge",value:function(e){for(var t,n=[],i=0;i<e.length;++i){var r=(t=e[i]).from.x,o=t.to.x;!n.length||n[n.length-1].right<r?n.push({left:r,right:o}):n[n.length-1].right=Math.max(n[n.length-1].right,o)}return n}},{key:"cut",value:function(e,t,n){if(e<=n.left)return t>=n.right?[]:[{left:Math.max(t,n.left),right:n.right}];var i=[{left:n.left,right:Math.min(e,n.right)}];return t<n.right&&i.push({left:Math.max(t,n.left),right:n.right}),i}},{key:"getDeleteRevision",value:function(e){var t=window.APP.data.doc.viewSettings.getRevisionsMode(),n=window.APP.data.doc.revisions.getRevision(e.begin);return t!==it.b&&n&&n.revisionType===nt.a&&n.begin<=e.begin&&n.end>=e.end?n:null}}],[{key:"getAbsoluteReact",value:function(e,t){var n=e.parent.position2parent.x,i=e.parent.position2parent.y;function r(e){return t?Math.round(e):e}return{top:r(e.rect.top+i),bottom:r(i+e.rect.bottom),left:r(n+e.rect.left),right:r(n+e.rect.right)}}},{key:"getLastTableBottomBorder",value:function(t){var n=t.page.lines,i=n[n.length-1],r=i.isRTL?[].concat(g()(i.tablecells)).reverse():i.tablecells,o=[],a=void 0,s=void 0;return r.forEach((function(t,n){t.style||(s||(s=Xe.a.init(i,window.APP.data)),t.style=s.getCellStyle(n,t));var r=t.style,l=r.border,d=r.rowStyle;l||d||(l=d=Object.create(null)),d?l||(l={}):d=l;var h=l.bottom||d.bottom||d.insideH;if(0!==Xe.a.getBorderWidth(h)){var c=e.getAbsoluteReact(t,!0),_=c.left,u=c.right;a&&JSON.stringify(h,a.style)&&!(a.right<_||a.left>u)?(a.left=Math.min(a.left,_),a.right=Math.max(a.right,u)):(a={style:h,left:_,right:u},o.push(a))}})),o}}]),e}()),at=function(){function e(t){a()(this,e),this.ctx=t,this.normal={},this.rtl={},this.combine={},this.transpose={}}return l()(e,[{key:"fillNormal",value:function(e,t,n,i,r,o){this.ctx.fillTextBuff(e,t,n,i,r,o,this.normal)}},{key:"fillRTL",value:function(e,t,n,i,r,o){this.ctx.fillTextBuff(e,t,n,i,r,o,this.rtl)}},{key:"fillCombin",value:function(e,t,n,i,r,o,a){this.combine.text&&this.combine.right!=t[0]&&this.ctx.commitTextBuff(this.combine),this.ctx.fillTextBuff(e,t,n,i,r,a,this.combine,!0),this.combine.right=o}},{key:"saveAndSetAlpha",value:function(e){this.transposeCtx?this.transposeCtx.saveAndSetAlpha(e):(void 0===this.globalAlphaStack&&(this.globalAlphaStack=[]),this.globalAlphaStack.push(e))}},{key:"restoreAlpha",value:function(){this.transposeCtx?this.transposeCtx.restoreAlpha():this.globalAlphaStack&&this.globalAlphaStack.pop()}},{key:"getTransposeCtx",value:function(){if(!this.transposeCtx){var e=this.transposeCtx=this.ctx.createCtxFragment();if(e.save(),e.rotate(Math.PI/180*270),e.resetAlpha(),this.globalAlphaStack&&this.globalAlphaStack.length){for(var t=0,n=this.globalAlphaStack.length;t<n;++t)e.saveAndSetAlpha(this.globalAlphaStack[t]);this.globalAlphaStack=void 0}}return this.transposeCtx}},{key:"setFontFace",value:function(e){this.getTransposeCtx().fontFace=e}},{key:"setFillStyle",value:function(e){this.getTransposeCtx().fillStyle=e}},{key:"fillTranspose",value:function(e,t,n,i,r,o){this.getTransposeCtx().fillTextBuff(e,t,n,i,r,o,this.transpose)}},{key:"commit",value:function(){var e=this.ctx;e.commitTextBuff(this.normal),e.commitTextBuff(this.combine),e.commitTextBuff(this.rtl),this.transposeCtx&&(this.transposeCtx.commitTextBuff(this.transpose),e.commitVaildNodesToCurrentChild(this.transposeCtx,!0),this.transposeCtx=null)}}]),e}(),st=n(4418),lt=n(1732);function dt(e){var t=void 0,n=function(e){var n=e.revision;if(n&&(t=n.insert||n.format||n.delete))return!0};return e.sublines?e.sublines.some((function(e){if(e.glyphGroupInfos&&e.glyphGroupInfos.some(n),t)return!0})):e.glyphGroupInfos&&e.glyphGroupInfos.some(n),Object(O.isRevisionMarkVisible)(t)?t:null}function ht(e){return window.APP.data.selection.selCoop.getCooperatorColor(e)}var ct={defaultArgs:{lineWidth:1,alpha:.5},activeArgs:{alpha:1,lineWidth:2}};function _t(e){var t=e.pos,n=void 0===t?0:t,i=e.len,r=void 0===i?0:i,o=e.left,a=void 0===o?0:o,s=e.right,l=void 0===s?0:s,d=e.y,h=void 0===d?0:d,c=e.top,_=void 0===c?0:c,u=e.bottom,p=void 0===u?0:u,f=e.revisionColor;return{pos:n,len:r,left:a,right:l,y:h,top:_,bottom:p,revisionColor:void 0===f?0:f,firstRectFlag:!1,lastRectFlag:!1}}function ut(e,t,n){var i=n.glyphGroupInfos,r=i[t],o=r.x+r.widthSum;if(r.oMath&&(o=r.x+r.oMath.locate(r.oMath.len).x),t===i.length-1||t===i.length-2){var a=n.papx.getPropVal("bidi"),s=e.glyphpool.glyphBuff.getCharCode(r.endOffset+n.range.pos-1);K.a.isPageBreak(s)?a||(o=n.rect.right):K.a.isLineBreak(s)&&(a||(o+=8))}return o}function pt(e,t,n){var i=n.glyphGroupInfos,r=i[t],o=r.x;if(r.oMath&&(o+=r.oMath.locate(0).x),t===i.length-1||t===i.length-2){var a=n.papx.getPropVal("bidi"),s=e.glyphpool.glyphBuff.getCharCode(r.beginOffset+n.range.pos);K.a.isPageBreak(s)?a&&(o=n.rect.left):K.a.isLineBreak(s)&&a&&(o-=8)}return o}var ft=function(){function e(){a()(this,e)}return l()(e,null,[{key:"_isRangeOverlap",value:function(e,t,n,i){return Math.max(e,n)<Math.min(t,i)}},{key:"mergeOneLineRenderPos",value:function(t,n,i,r){var o=n.glyphGroupInfos,a=n.range,s=n.rect;if(!a)return[];for(var l=i.pos,d=i.len,h=l+d,c=Math.ceil(r),_=Math.floor(r+(s.bottom-s.top)),u=ht(i.userID),p=[],f=_t({pos:l,len:d,y:r,top:c,bottom:_,revisionColor:u}),g=null,v=null,m=a.pos,y=0;y<o.length;++y){var b=o[y],w=m+b.beginOffset,x=m+b.endOffset,k=b.x;b.oMath&&(k+=b.oMath.locate(0).x),e._isRangeOverlap(w,x,l,h)?(null===v?(f.left=pt(t,y,n),f.right=ut(t,y,n)):v===k?f.right=ut(t,y,n):g===ut(t,y,n)?f.left=pt(t,y,n):(f.left=Math.floor(f.left),f.right=Math.ceil(f.right),p.push(f),(f=_t({pos:l,len:d,y:r,top:c,bottom:_,revisionColor:u})).left=pt(t,y,n),f.right=ut(t,y,n)),g=f.left,v=f.right):null!==v&&(v=null,g=null,f.left=Math.floor(f.left),f.right=Math.ceil(f.right),p.push(f))}return null!==v&&(v=null,g=null,f.left=Math.floor(f.left),f.right=Math.ceil(f.right),p.push(f)),p}},{key:"preCalculate",value:function(t,n,i){if(!window.APP.data.doc.useCoreMeasure&&n.glyphGroupInfos){var r=t.selection.selRevision.activeRevisionInfo.activeRevision;return{revisionRange:r,active:function(e,t){if(!t||t.length<=0)return t;for(var n=e.papx.getPropVal("bidi"),i=-1,r=-1,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,s=0;s<t.length;++s){var l=t[s];l.left<o&&(o=l.left,i=s),l.left>a&&(a=l.left,r=s)}return t[n?r:i].firstRectFlag=!0,t[n?i:r].lastRectFlag=!0,t}(n,function(r){if(!r)return[];var o=n.range;if(!o)return[];var a=r.pos,s=r.len,l=o.pos;return a>=l+o.len||a+s<=l?[]:e.mergeOneLineRenderPos(t,n,r,i)}(r)),activeFirstRect:null,activeLastRect:null,hover:null}}}},{key:"render",value:function(e,t,n,i,r){var o=i.firstRectFlag,a=i.lastRectFlag,s=i.pos,l=i.len,d=i.top,h=i.left,c=i.bottom,_=i.right,u=i.revisionColor;if(!window.APP.data.doc.useCoreMeasure){var p=d,f=c;p=Math.max(1,p);var g=t.parent.sublines,v=-1!==(g?g.indexOf(t):-1),m=v?t.parent.range:t.range,y=s>=m.pos&&s<m.pos+m.len,b=s+l>m.pos&&s+l<=m.pos+m.len,w=v&&s>=t.range.begin&&s<t.range.end,x=v&&t.range.begin<s+l&&t.range.end>=s+l,k=t.papx.bidi;if(y){var C=!v||v&&w?6:0;e.beginPath(),r?k?(o?(e.moveTo(_,f-C),e.lineTo(_,f)):e.moveTo(_,f),e.lineTo(h,f)):(o?(e.moveTo(h,f-C),e.lineTo(h,f)):e.moveTo(h,f),e.lineTo(_,f)):k?(o?(e.moveTo(_,p+C),e.lineTo(_,p)):e.moveTo(_,p),e.lineTo(h,p)):(o?(e.moveTo(h,p+C),e.lineTo(h,p)):e.moveTo(h,p),e.lineTo(_,p)),e.lineWidth=2,e.strokeStyle=u,e.stroke()}var P=s+l,S=!1;if(b)S=!0;else if(P>0&&P-1>m.pos&&P-1===m.pos+m.len){var M=n.selection.getTableRange(P-1);M&&M.end===P&&(S=!0)}if(S){var I=!v||v&&x?6:0;T.isMobile?t.isInTable||(f+=1):f-=1,e.beginPath(),r?k?(a?(e.moveTo(h,p+I),e.lineTo(h,p)):e.moveTo(h,p),e.lineTo(_,p)):(a?(e.moveTo(_,p+I),e.lineTo(_,p)):e.moveTo(_,p),e.lineTo(h,p)):k?(a?(e.moveTo(h,f-I),e.lineTo(h,f)):e.moveTo(h,f),e.lineTo(_,f)):(a?(e.moveTo(_,f-I),e.lineTo(_,f)):e.moveTo(_,f),e.lineTo(h,f)),e.lineWidth=2,e.strokeStyle=u,e.stroke()}e.restoreStrokeStyle()}}},{key:"getTableRevisionParaOffset",value:function(e){for(var t=void 0,n=e.parent;n;){if(n instanceof Ge.c){t=n;break}n=n.parent}var i=0;if(t&&t.style){var r=t.style.vertAlign,o=e.rect.bottom-e.rect.top;if(r===st.Center)i=(t.height-o)/2;else if(r===st.Bottom){var a=0;t.style.border&&(t.style.border.top&&(a+=Object(he.Ti2Px)(t.style.border.top.lineWidth||0)),t.style.border.bottom&&(a+=Object(he.Ti2Px)(t.style.border.bottom.lineWidth||0))),i=t.height-o-a}}return i}},{key:"getMobileRevisionParaOffset",value:function(e){var t=e.parent;if(t instanceof u.a){var n=t.parent;if(n instanceof Ge.c){var i=n.parent;if(i instanceof Ve.a)if(i.parent instanceof u.d)return i.rect.top}}else if(t instanceof u.d)return t.rect.top;return 0}},{key:"getVerticalLineStartAndLineEnd",value:function(e){var t=Math.round(e.rect.top)-e.rect.top,n=t+Math.round(e.rect.height);try{var i=Object(lt.b)(e),r=window.APP.isPCMode();if(i&&i.viewOffset){var o=void 0;o=r?Math.round(i.rect.top)+Math.round(i.rect.height)-t:Math.round(i.viewOffset.y)+Math.round(i.rect.height)-Math.round(e.viewOffset.y),Math.abs(o)<2&&(t+=o)}}catch(e){}return{startY:t,endY:n}}},{key:"needRenderPara",value:function(e){var t=!1,n=e===e.parent.lines[0];e.papx&&e.papx.revision&&e.papx.revision.paraFormat&&(e.is_para_first||n)?t=!0:t=!!dt(e);return t}},{key:"renderPara",value:function(t,n,i,r,o){var a=n===n.parent.lines[0],s=n.papx&&n.papx.revision&&n.papx.revision.paraFormat;if(Object(O.isRevisionMarkVisible)(s)){var l=-9,d=window.APP,h=d.isEditMode,c=d.isCardMode,_=window.APP.workspace.revisionComment;if(l=window.APP.isPCMode()?-13:T.isMobile?-3:-11,s&&(n.is_para_first||a)){var u=i.doc.getDataLogic("final").getPapx(n.range.pos),p={begin:u.pos,end:u.end},f=Object(lt.c)(n,i),g=i.selection.end.position,v=g>=p.begin&&g<p.end,m=ht(s.userID);T.isMobile&&"#fc0d1b"===m&&_.rangesToBeRefresh&&_.rangesToBeRefresh.push({pos:n.range.pos,len:n.range.len}),t.strokeStyle=m,t.fillStyle=m;var y=e.getVerticalLineStartAndLineEnd(n),b=y.startY,w=y.endY,x=f.reduce((function(e,t,n){return 0===n?(e.startY=b,e.endY=w):e.endY+=Math.round(t.rect.height),e}),{startY:0,endY:0}),k=t.save(),C=v&&(c||h);k.setAttribute("visibility",C?"visible":"hidden"),t.saveAndSetAlpha(1),t.beginPath(),t.lineWidth=2,t.moveTo(l,x.startY),t.lineTo(l,x.endY),t.stroke(),t.restore();var P=null;n.is_para_first&&((P=t.save()).setAttribute("visibility",C?"hidden":"visible"),t.saveAndSetAlpha(.5),t.beginPath(),t.lineWidth=1,t.moveTo(l,b),t.lineTo(l,w),t.stroke(),t.restore()),o.revisionSvgNodeManager.setPapxRevision(n,k,P,n.renderInfo)}else{var S=ct.defaultArgs;if(r&&(c||h)){var M=r.pos,I=r.len;n.range.begin<M+I&&n.range.end>=M&&(S=ct.activeArgs)}var R=dt(n);if(R){var N=S,E=N.lineWidth,A=N.alpha,L=e.getVerticalLineStartAndLineEnd(n),F=L.startY,D=L.endY,B=ht(R.userID);T.isMobile&&"#fc0d1b"===B&&_.rangesToBeRefresh&&_.rangesToBeRefresh.push({pos:n.range.pos,len:n.range.len}),t.strokeStyle=B,t.fillStyle=B;var j=t.save();t.translate(l,F),t.beginPath(),t.lineWidth=E,t.saveAndSetAlpha(A),t.moveTo(0,0),t.lineTo(0,D-F),t.stroke(),t.restore(),j&&o.revisionSvgNodeManager.setChpxRevision(n,l,F,j,n.renderInfo)}else t.saveAndSetAlpha(1)}t.restoreFillStyle(),t.restoreStrokeStyle(),t.restoreAlpha()}}},{key:"renderRevisionForTextPage",value:function(t,n,i){if(!window.APP.data.doc.useCoreMeasure){var r=window.APP,o=r.isEditMode,a=r.isCardMode;if(!T.isMobile||o||a){var s=n.selection.selRevision.activeRevisionInfo.activeRevision,l=t.range;if(s&&l&&Object(O.isRevisionMarkVisible)(s)){var d=l.pos,h=d+l.len,c=s.pos,_=s.len;if(!(c>=h||c+_<=d)){var u=t.textflow.isReverseLine,p=t.rect.width,f=!1,g=function(t){var r=t.range,o=r.pos,a=r.len+o;if(!(c>=a||c+_<o)){var s=e.preCalculate(n,t,u?p-t.rect.top-t.rect.height:t.rect.top);s&&s.active&&s.active.length>0&&s.active.forEach((function(r){e.render(i,t,n,r,u),f=!0}))}};return t.lines.forEach((function(e){e instanceof Ke.a&&(e.sublines&&e.sublines.length?e.sublines.forEach((function(e){g(e)})):g(e))})),f}}}}}},{key:"updateParaRevision",value:function(e,t){var n=t.selection.getNormalRange();e.forEach((function(e){var i=e.activeSvgGroup,r=e.unActiveSvgGroup,o=e.linebase,a=t.doc.getDataLogic("final").getPapx(o.range.pos),s=n.pos>=a.pos&&n.pos<a.end,l=window.APP,d=l.isEditMode,h=l.isCardMode,c=s&&(d||h);i.setAttribute("visibility",c?"visible":"hidden"),r&&r.setAttribute("visibility",c?"hidden":"visible")}))}},{key:"updateChpxRevision",value:function(e,t){var n=t.selection.selRevision.activeRevisionInfo.activeRevision,i=t.selection.getNormalRange();e.forEach((function(e){var t=e.linebase,r=e.left,o=e.svgNode,a=t.range,s=e.top,l=!1;if(n&&(window.APP.isEditMode||window.APP.isCardMode)){var d=n.pos,h=n.len;a.pos+a.len<=d||a.pos>=d+h||(l=i.pos>=d&&i.pos<d+h)}var c=l?ct.activeArgs:ct.defaultArgs,_=c.lineWidth,u=c.alpha;window.APP.isPCMode()||(s=Math.ceil(s)),o.setAttribute("transform","translate("+r+", "+s+")");var p=o.childNodes[0];p.setAttribute("stroke-width",_),p.setAttribute("stroke-opacity",u)}))}},{key:"updateTextColor",value:function(e,t){var n=t.selection.selRevision.activeRevisionInfo.activeRevision;e.forEach((function(e){var t=e.textline,i=e.glyphGroupInfo,r=e.normalColor,o=e.revisionColor,a=e.svgNode,s=i.beginOffset+t.range.pos,l=n&&s>=n.pos&&s<n.pos+n.len,d=void 0;d=window.APP.isCooperationMode||l&&(!T.isMobile||!l||window.APP.isEditMode||window.APP.isCardMode)?r:o,a.setAttribute("fill",d)}))}}]),e}(),gt=n(4972),vt=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(t,n,i,r,o,a){var s=-t.rect.top,l=(i?r-t.rect.bottom:t.rect.top)+s,d=l+t.rect.height,h={},c={},_=t.renderInfo;n.save(),n.fillStyle="#F46D43",n.globalAlpha=.3,t.sublines&&t.sublines.length?t.sublines.forEach((function(t){t.documentFields&&e._doRender(t,l,d,{ctx:n,documentFiledPosMap:h,brackets:c,displayDocumentFields:o,canvas:a,renderInfo:_})})):e._doRender(t,l,d,{ctx:n,documentFiledPosMap:h,brackets:c,displayDocumentFields:o,canvas:a,renderInfo:_}),n.globalAlpha=1,n.strokeStyle="#F46D43",n.lineWidth=1;var u=t.papx?t.papx.bidi:t.sublines&&t.sublines[0].papx&&t.sublines[0].papx.bidi,p=a.documentFieldSvgNodeManager;c.start&&(u?c.start.forEach((function(t){var i=h[t];i&&p.addBracket(t,e._doRenderRightBracket(i.maxRight,l,d,n),_)})):c.start.forEach((function(t){var i=h[t];i&&p.addBracket(t,e._doRenderLeftBracket(i.minLeft,l,d,n),_)}))),c.end&&(u?c.end.forEach((function(t){var i=h[t];i&&p.addBracket(t,e._doRenderLeftBracket(i.minLeft,l,d,n),_)})):c.end.forEach((function(t){var i=h[t];i&&p.addBracket(t,e._doRenderRightBracket(i.maxRight,l,d,n),_)}))),c.cursor&&c.cursor.forEach((function(t){var i=t.name,r=t.pos;p.addBracket(i,e._doRenderCardBracket(r,l,d,n),_)})),n.restore()}},{key:"_doRender",value:function(t,n,i,r){var o=r.ctx,a=r.documentFiledPosMap,s=r.brackets,l=r.displayDocumentFields,d=r.canvas,h=r.renderInfo,c=t.documentFields,_=t.documentFieldBrackets,u=d.documentFieldSvgNodeManager,p=window.APP.data.selection.selContext.activeDocumentFieldNames,f=p&&p.length&&p[0],v=l===gt.wpsDisplayDocumentFields;c&&c.forEach((function(t){var r=t.documentFieldNames,s=t.range,l=s.left,d=s.right,c=v&&o.fillRect(l,n,d-l,i-n);r.forEach((function(t){var n=a[t];n?(n.minLeft=Math.min(l,n.minLeft),n.maxRight=Math.max(d,n.maxRight)):a[t]={minLeft:l,maxRight:d},v&&(u.addRect(t,c,h),t==f&&e.activeRect(c))}))})),_&&(_.start&&(s.start?s.start=[].concat(g()(s.start),g()(_.start)):s.start=_.start),_.end&&(s.end?s.end=[].concat(g()(s.end),g()(_.end)):s.end=_.end),_.cursor&&(s.cursor?s.cursor=[].concat(g()(s.cursor),g()(_.cursor)):s.cursor=_.cursor))}},{key:"_doRenderLeftBracket",value:function(e,t,n,i){return i.beginPath(),i.moveTo(e+2,t),i.lineTo(e,t),i.lineTo(e,n),i.lineTo(e+2,n),i.stroke()}},{key:"_doRenderRightBracket",value:function(e,t,n,i){return i.beginPath(),i.moveTo(e-2,t),i.lineTo(e,t),i.lineTo(e,n),i.lineTo(e-2,n),i.stroke()}},{key:"_doRenderCardBracket",value:function(e,t,n,i){return i.beginPath(),i.moveTo(e-2,t),i.lineTo(e+2,t),i.moveTo(e,t),i.lineTo(e,n),i.moveTo(e-2,n),i.lineTo(e+2,n),i.stroke()}},{key:"activeRect",value:function(e){e.setAttribute("fill-opacity",.6)}},{key:"unactiveRect",value:function(e){e.setAttribute("fill-opacity",.3)}},{key:"activeBracket",value:function(e){e.setAttribute("stroke-width",1.5)}},{key:"unactiveBracket",value:function(e){e.setAttribute("stroke-width",1)}}]),e}(),mt=n(260),yt=n(12958),bt=n(5298),wt={fontStyle:"",fontWeight:"",fontSize:"14",fontFamily:"sans-serif"},xt=Object(he.Ti2Px)(315),kt=Object(he.Ti2Px)(180),Ct=void 0;function Pt(){if(!Ct){var e=new M.a;Ct=e.calculateHeight({},"M",wt)}return Ct}function St(e,t){if(e.layoutType===et.c.TextLine){var n=e.papx||e.sublines&&e.sublines[0].papx;if(n&&!n.getPropVal("sup_line_num")){if(t){var i=e.glyphGroupInfos;if(i){var r=i.find((function(e){return e.isVisible()}));if(r&&(r.isParaBreak()||r.isLineBreak()))return!1}}return!0}}return!1}var Mt=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=r.isRTL,a=r.isMulCol,s=t.step,l=t.blankNoLineNumber,d=a?kt:xt;i.fontFace=wt,i.fillStyle="#000000";var h=e.textflow.corX,c=e.textflow.isReverseLine;e.lines.forEach((function(t){if(St(t,l)){var r=n.count++;if(r%s==0){var a=""+r,_=i.measureText(a).width,u=c?e.rect.width-t.rect.top-t.rect.height-t.rect.top:0,p=void 0;switch((t.papx||t.sublines&&t.sublines[0].papx).vertical_align_mode||("T2B"===h||"B2T"===h?S.middle:S.alphabetic)){case S.top:u+=(p=Pt()).ascent;break;case S.middle:u+=-(p=Pt()).height/2+p.ascent;break;case S.bottom:u-=(p=Pt()).descent}var f=t.rect.top+t.baseline+u,g=o?("T2B"===h||"B2T"===h?e.rect.height:e.rect.width)+d:-d-_;i.fillTextPos(a,g,f,{})}}}))}},{key:"updateLineNumbering",value:function(t,n){var i=t,r=n.getLayoutPageCache(t);if(r.mainpages&&r.mainpages[0].section.getLineNumbering()&&r.mainpages[0].section.getLineNumbering().restart!==bt.b)for(;i>0;){var o=n.getLayoutPageCache(i-1);if(void 0!==o.nextLineNumbering)break;var a=o.mainpages;if(!a)break;var s=a[a.length-1];if(!s||!s.section.getLineNumbering())break;--i;var l=a[0];if(!l.section.getLineNumbering()||l.section.getLineNumbering().restart===bt.b)break}for(var d=i;d<=t;++d)e._updateLineNumberingForLayoutPage(n.getLayoutPageCache(d),n.getLayoutPageCache(d-1))}},{key:"_updateLineNumberingForLayoutPage",value:function(e,t){var n=void 0,i=e.mainpages;i&&i.forEach((function(e,r){var o=e.section.getLineNumbering();if(o&&0!==o.step){if(n)r>0&&e.section!==i[r-1].section&&o.restart===bt.c&&(n.count=Math.max(1,o.start+1));else{var a=Math.max(1,o.start+1);if(t&&0===r)if(o.restart===bt.a&&void 0!==t.nextLineNumbering)a=t.nextLineNumbering;else if(o.restart===bt.c){var s=t.mainpages;s[s.length-1].section===e.section&&(a=t.nextLineNumbering)}n={count:Math.max(1,a)}}var l=o.blankNoLineNumber;e.lines.forEach((function(e){St(e,l)&&++n.count}))}else n=null})),n&&(e.nextLineNumbering=n.count)}}]),e}(),It=n(4114),Tt=n(302),Rt="75",Nt="150",Et="75150";function At(e){return{totalWidth:e.reduce((function(e,t){return e+t}),0),subWidths:e}}function Ot(e,t){return e===Rt?15:e===Nt?30:e===Et?t>=60?30:15:0}function Lt(e,t,n){function i(e){return e%1<=.75?Math.floor(e):Math.ceil(e)}n?(e.start.x=Math.ceil(e.start.x)+t,e.end.x=Math.ceil(e.end.x)+t):(e.start.y=i(e.start.y)+t,e.end.y=i(e.end.y)+t)}function Ft(e,t,n,i){var r=Math.round(Math.max(1,n));Lt(t,r/2,i),e.beginPath(),e.moveTo(t.start.x,t.start.y),e.lineTo(t.end.x,t.end.y),e.lineWidth=r,e.strokeStyle=t.color||"#000000",e.stroke()}function Dt(e,t,n,i,r){var o=Object(he.Ti2Px)(i);Lt(t,(o=Math.round(Math.max(1,o)))/2,r),e.beginPath(),e.setLineDash(n.map((function(e){return e*o}))),e.moveTo(t.start.x,t.start.y),e.lineTo(t.end.x,t.end.y),e.strokeStyle=t.color||"#000000",e.lineWidth=o,e.stroke()}function Bt(e,t,n,i){Lt(t,n/2,i);var r=Math.round(t.start.x),o=Math.round(t.start.y),a=Math.round(t.end.y),s=Math.round(t.end.x);e.beginPath(),e.moveTo(r,o);var l=[1,0,-1,0],d=0;if(i)for(var h=o+2;h<=a;h+=2)e.lineTo(s-2*l[d%l.length],h),d++;else for(var c=r+2;c<=s;c+=2)e.lineTo(c,a-2*l[d%l.length]),d++;e.lineWidth=n,e.strokeStyle=t.color||"#000000",e.stroke()}function jt(e,t,n,i){var r=t.width,o=t.start,a=t.end,s=t.style,l=t.color,d=function(e,t){switch(e){case $e.l:return At(0);case $e.n:case $e.f:case $e.e:case $e.d:case $e.a:case $e.b:case e.LineStyle_Outset:case e.LineStyle_Inset:return At([t,0,0,0,0]);case $e.g:return At([t,t,t,0,0]);case $e.y:return At([t,t,t,t,t]);case $e.u:var n=Ot(Rt,t);return At([t,n,n,0,0]);case $e.r:var i=Ot(Rt,t);return At([i,i,t,0,0]);case $e.x:var r=Ot(Rt,t);return At([r,r,t,r,r]);case $e.q:return At([t,t/2,t/2,0,0]);case $e.t:return At([t/2,t/2,t,0,0]);case $e.w:return At([t/2,t/2,t,t/2,t/2]);case $e.s:var o=Ot(Rt,t);return At([Ot(Nt,t),t,o,0,0]);case $e.p:var a=Ot(Nt,t);return At([Ot(Rt,t),t,a,0,0]);case $e.v:var s=Ot(Nt,t),l=Ot(Rt,t);return At([l,t,s,t,l]);case $e.o:return At([30===t?3*t:4*t,0,0,0,0]);case $e.h:return At([6*t,0,0,0,0]);case $e.c:return At([t,0,0,0,0]);case $e.i:case e.LineStyle_Engrave3D:var d=Ot(Et,t);return At([d,t,d,0,0]);default:return At([0,0,0,0,0])}}(s,r),h=d.subWidths,c=d.totalWidth;switch(i&&(n?(o.x-=Object(he.Ti2Px)(c),a.x-=Object(he.Ti2Px)(c)):(o.y-=Object(he.Ti2Px)(c),a.y-=Object(he.Ti2Px)(c))),e.save(),e.currentNode.setAttribute("shape-rendering","crispEdges"),s){case $e.n:Ft(e,t,Object(he.Ti2Px)(h[0]),n);break;case $e.f:Dt(e,t,[1,1],h[0],n);break;case $e.e:Dt(e,t,[3,1],h[0],n);break;case $e.d:Dt(e,t,[4,4],h[0],n);break;case $e.a:Dt(e,t,[7,3,3,3],h[0],n);break;case $e.b:Dt(e,t,[6,2,2,2,2,2],h[0],n);break;case $e.g:case $e.y:case $e.u:case $e.r:case $e.x:case $e.t:case $e.q:case $e.w:case $e.s:case $e.p:case $e.v:!function(e,t,n,i){n.forEach((function(n,r){if(n){var o=Object(he.Ti2Px)(n);o=Math.round(Math.max(1,o)),r%2==0?(Ft(e,t,o,i),i?(t.start.x+=o/2,t.end.x+=o/2):(t.start.y+=o/2,t.end.y+=o/2)):i?(t.start.x+=o,t.end.x+=o):(t.start.y+=o,t.end.y+=o)}}))}(e,t,h,n);break;case $e.o:Bt(e,t,Object(he.Ti2Px)(h[0])/4,n);break;case $e.h:Bt(e,t,Object(he.Ti2Px)(h[0])/6,n),Lt(t,2,n),Bt(e,t,Object(he.Ti2Px)(h[0])/6,n);break;case $e.i:r=Object(he.Ti2Px)(r);var _=o.x,u=o.y+r,p=a.x,f=e.createLinearGradient(_,u,_,u-r);f.addColorStop(0,"rgba("+Tt.default.hexToRgbStr(l)+", 0.8)"),f.addColorStop(1,"white"),e.fillStyle=f,e.fillRect(_,u-r,p-_,r);break;case $e.j:r=Object(he.Ti2Px)(r);var g=o.x,v=o.y,m=a.x,y=e.createLinearGradient(g,v,g,v+r);y.addColorStop(0,"rgba("+Tt.default.hexToRgbStr(l)+", 0.8)"),y.addColorStop(1,"white"),e.fillStyle=y,e.fillRect(g,v,m-g,r);break;default:e.moveTo(o.x,o.y),e.lineTo(a.x,a.y),e.lineWidth=Object(he.Ti2Px)(h[0]),e.stroke()}e.restore()}var Wt={lineWidth:0,style:0};function Ut(e){return new He.a(e.color).color}function zt(e,t){return e.color===t.color&&(e.width===t.width&&(e.style===t.style&&(e.start.x===t.start.x&&(e.end.x===t.end.x&&(e.start.y===t.end.y&&(t.end.y=e.end.y,!0))))))}function Gt(e){var t=e.border;if(t&&(t.before_width||t.after_width||t.left_width||t.right_width))return!0;var n=e.sublines,i=!1;return n&&n.some((function(e){if((t=e.border)&&(t.before_width||t.after_width||t.left_width||t.right_width))return i=!0,!0})),i}var Ht=function(){function e(){a()(this,e)}return l()(e,null,[{key:"renderPapxBorder",value:function(e,t){var n=t.textflow.isReverseLine,i=t.renderInfo.renderUnits["para-border"]||[],r=t.lines;r&&function(){for(var o=void 0,a=void 0,s=function(){a&&(o||(o=e.getCtx("para-border")),a.svgNode=o.save(),a.top&&(a.top.forEach((function(e){jt(o,e,!1,!0)})),delete a.top),a.bottom&&(a.bottom.forEach((function(e){jt(o,e,!1,!1)})),delete a.bottom),a.left&&(a.left.forEach((function(e){jt(o,e,!0,!0)})),delete a.left),a.right&&(a.right.forEach((function(e){jt(o,e,!0,!1)})),delete a.right),o.restore(),i.push(a),a=null)},l=function(e,i){var r=e.papx,o=r.getPropVal("border_top")||r.getPropVal("border_between")||Wt,s=r.getPropVal("border_left")||Wt,l=r.getPropVal("border_bottom")||Wt,d=r.getPropVal("border_right")||Wt,h=e.border,c=h.before_width,_=h.after_width,u=h.left_width,p=h.right_width,f=e.borderAndShdRect,g=f.left,v=f.right,m=e.borderAndShdRect,y=m.top,b=m.bottom;(n&&(y=(b=t.rect.width-y)-e.rect.height),i)&&(b=e.parent.rect.bottom-Object(he.Ti2Px)(l&&l.lineWidth||0));c&&o.lineWidth&&o.style&&(a.top||(a.top=[]),a.top.push({start:{x:g,y:n?b:y},end:{x:v,y:n?b:y},color:Ut(o),width:o.lineWidth,style:o.style}));var w=!1;if(_&&l.lineWidth&&l.style&&(a.bottom||(a.bottom=[]),a.bottom.push({start:{x:g,y:n?y:b},end:{x:v,y:n?y:b},color:Ut(l),width:l.lineWidth,style:l.style}),w=!0),u&&s.lineWidth&&s.style){a.left||(a.left=[]);var x=a.left.length?a.left[a.left.length-1]:null,k={start:{x:g,y:y},end:{x:g,y:b},color:Ut(s),width:s.lineWidth,style:s.style};x&&zt(k,x)||a.left.push(k)}if(p&&d.lineWidth&&d.style){a.right||(a.right=[]);var C=a.right.length?a.right[a.right.length-1]:null,P={start:{x:v,y:y},end:{x:v,y:b},color:Ut(d),width:d.lineWidth,style:d.style};C&&zt(P,C)||a.right.push(P)}return w},d=0,h=r.length;d<h;++d){var c=r[d];if(c.layoutType===te.DOCLayoutType.TextLine&&Gt(c)){if("continue"===function(){if(!c.renderInfo.needRenderBorder)return"continue";a||(a={y:0,lineRenderInfos:[]}),a.lineRenderInfos.push(c.renderInfo);var e=d===h-1&&c.host.layoutType===te.DOCLayoutType.SnippetScene,t=!1;c.sublines&&c.sublines.length?c.sublines.forEach((function(n){t=t||l(n,e)})):t=l(c,e),t&&s()}())continue}else s()}s()}(),i.length?t.renderInfo.renderUnits["para-border"]=i:delete t.renderInfo.renderUnits["para-border"]}}]),e}(),Vt=function(e){e.parentNode.removeChild(e)},qt=function(e){for(var t=e[0],n=1,i=e.length;n<i;++n)if(Math.abs(e[n]-t)>.01)return!1;return!0},Yt=function(e){var t=!1,n=!1,i=function e(i){var r=i.shadingBackColorInfos,o=i.highlightColorInfos,a=i.shading_back_color;n=r&&r.length||o&&o.length,t=!!a,i.zones&&i.zones.forEach((function(t){Ue.b.TwoLinesInOne===t.type&&t.secondLine&&(e(t.firstLine),e(t.secondLine))}))};return e.sublines&&e.sublines.length?e.sublines.forEach((function(e){i(e)})):i(e),{vaildShading_back_color:t,vaildShadingsOrHighlights:n}},Xt=function(e){var t=void 0,n=0;return Object.keys(e).forEach((function(i){e[i]>n&&(t=i,n=e[i])})),t},Qt=function(e,t,n){var i=e.getAttribute("transform")||"";i.startsWith("translate(")>=0&&(i=i.substr(i.indexOf(")")+1)),e.setAttribute("transform","translate("+t+", "+n+")"+i)},Zt=function(e){function t(){a()(this,t);var e=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.selfInfo=null,e.getCtx=e.getCtx.bind(e),e}return _()(t,e),l()(t,[{key:"reset",value:function(e,t,n,i){this._init(e,t,null),this.data=n,this.isMobile=window.APP.isMobileMode()||window.APP.isWebMode(),this.parentGetCtx=i,this._ctxs={},this._renderSvgs={}}},{key:"getCtx",value:function(e){var t=this._ctxs[e];if(!t){if(this.parentGetCtx){this._ctxs[e]=t=this.parentGetCtx.getCtx(e);var n=this.renderInfo&&this.renderInfo.renderSvgs&&this.renderInfo.renderSvgs[e];t.save(null,n);var i=It.b[e];n||this._doTranslate(t,!i||i.x,!i||i.y)}else{var r=this.ctx.currentNode,o=Object(Ze.findSvgNode)(e,r);o&&(this._renderSvgs[e]=o),this._ctxs[e]=t=this.ctx.createCtxFragment(e,{},o)}var a=It.a[e];a&&t.currentNode.setAttribute("shape-rendering",a)}return t}},{key:"get_coororigin_pos2precoor",value:function(){var e=this.textpage.coororigin_pos2parent,t=this.typoContext.position,n=De.a.add(e,t);return(!e||0===e.x&&0===e.y)&&(n=De.a.add(n,this.textpage.position2parent)),n}},{key:"getColorByTagid",value:function(e){return this.data.selection.selCoop.coopInfo.getColorByTagid(e)}},{key:"getSelfInfo",value:function(){return this.selfInfo||(window.APP.isLogin()?this.selfInfo=this.data.selection.selCoop.coopInfo.coopInfos.find((function(e){return e.userid===window.APP.info.userid})):this.selfInfo={tagid:-1}),this.selfInfo}},{key:"render",value:function(e,t,n,i){this.textpage=e;var r=this.renderInfo;if(!r||!r.svgNode||r.removed||r.expired||r.moved||i&&i.lineNumbering){this.typoContext=n,this.typoContext.enter(e),mt.default.dispatchEvent(mt.default.canvas.ON_BEFORE_TEXT_PAGE_RENDER,this.textpage),this.params=i,this.coororigin_pos2precoor=this.get_coororigin_pos2precoor();var o=this._render(i);return this.typoContext.exit(),o}if(i&&i.cleanLineNumbering){var a=Object(Ze.findSvgNode)("line-numbering",r.svgNode);if(a)try{a.parentNode.removeChild(a)}catch(e){}}this.ctx.seekNextInsertPos()}},{key:"_doTranslate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.coororigin_pos2precoor,r=this.textflow,o=r.rotate,a=r.scale,s=this.params&&this.params.yOffset||0;e.translate(t?Math.round(i.x):0,n?Math.round(i.y+s):0),e.rotate(o),e.scale(a.x,a.y)}},{key:"_updateRenderSvgTranslate",value:function(e,t,n){var i=this.coororigin_pos2precoor,r=this.params&&this.params.yOffset||0;Qt(e,t?Math.round(i.x):0,n?Math.round(i.y+r):0)}},{key:"_render",value:function(e){var t=this;this.renderInfo||(this.textpage.renderInfo={renderUnits:{}});var n=this.renderInfo.svgNode,i=void 0;if(this.parentGetCtx){if(this.renderInfo.moved){var r=this.renderInfo.renderSvgs;r&&Object.keys(r).forEach((function(e){var n=It.b[e];t._updateRenderSvgTranslate(r[e],!n||n.x,!n||n.y)})),delete this.renderInfo.moved}}else{var o=this.ctx;if(i=this.ctx.save(null,n),this.textpage.svgNode=i,n){if(this.renderInfo.moved){var a=this.coororigin_pos2precoor,s=this.params&&this.params.yOffset||0;Qt(n,Math.round(a.x),Math.round(a.y+s)),delete this.renderInfo.moved}}else if(this._doTranslate(o),e&&e.pageClipRect){var l=e.pageClipRect;o.clipRect(l.left-this.coororigin_pos2precoor.x,l.top-this.coororigin_pos2precoor.y,l.right-l.left,l.bottom-l.top),this.textpage.renderInfo.pageClipRect=l}}if(this.defaultColor="#000000",this.textpage.parent&&this.textpage.parent.style&&this.textpage.parent.style.shd){var d=this.textpage.parent.style.shd.backColor;"#000000"==new He.a(d).colorEx&&(this.defaultColor="#ffffff")}var h=this._prepare(),c=h.editExceptions,_=h.formatContentControls;if(Object(yt.renderFormatContentControlBackground)({getCtx:this.getCtx,textPage:this.textpage,doc:this.data.doc,ranges:_}),Object(yt.renderReadonlyProtectionBackground)({getCtx:this.getCtx,textPage:this.textpage,doc:this.data.doc,ranges:c}),this._renderColorBlock(),this._renderDocumentField(),this.renderRevisionLine(),Ht.renderPapxBorder(this,this.textpage),this.renderLines(),this.renderTableBorder(),this.renderColumnLine(e&&e.columnLine),e&&e.lineNumbering&&this._renderLineNumbering(e),this._commitCtxs(),this._afterRender(),!this.parentGetCtx){var u=this.ctx;u.restore(!1,!!n),n&&u.seekNextInsertPos()}}},{key:"_commitCtxs",value:function(){var e=this;this.renderInfo.renderSvgs||(this.renderInfo.renderSvgs={});var t=Object.keys(this._ctxs);if(this.parentGetCtx)t.forEach((function(t){var n=e._ctxs[t],i=n.__currentGroup;n.restore(!0)&&(e.renderInfo.renderSvgs[t]=i)}));else{var n=this.ctx,i=n.__currentGroup;t.forEach((function(t){!e._renderSvgs[t]&&n.commitVaildNodesToCurrentChild(e._ctxs[t],!1,Object(It.d)(t,i).index)}))}}},{key:"renderLines",value:function(){var e=this,t=this.lines,n=this.textpage.rect,i=this.textpage.textflow,r=i.corX,o="T2B"===r||"B2T"===r,a=0,s=o?n.width:n.height,l=this.textpage.parent.cell2page_offset;if(l)if(o){var d=l.x;"T2B"===r?i.isReverseLine?d<0&&(a-=d,s-=d):d>0&&(a+=d,s+=d):d<0&&(a-=d,s-=d)}else{var h=l.y;h<0&&(a-=h,s-=h)}var c=void 0,_=void 0,u=void 0,p=this.typoContext.defaultColor,f=this.defaultColor,g=this.getCtx("main-content"),v=new at(g),m=null,y=function(t){if(v.commit(),m){g.restore();var n=e.textpage.renderInfo.renderUnits["main-content"]||[];n.push(m),e.textpage.renderInfo.renderUnits["main-content"]=n,m=null}};t.forEach((function(t){switch(t.layoutType){case te.DOCLayoutType.TextLine:if((u=t.rect).top>s)return;if(u.bottom<a)return;if(!t.renderInfo.needRender)return void y();m?m.lineRenderInfos.push(t.renderInfo):(m={svgNode:g.save(),y:t.rect.top,lineRenderInfos:[t.renderInfo]},g.translate(0,m.y)),c||(e.textlineRender||(e.textlineRender=new ze),(c=e.textlineRender).reset(e.canvas,e.ctx,e.textflow,e.data,e.textpageBaseFont,e,v)),e.typoContext.defaultColor=f,c.render(t,e.typoContext,-m.y),m.lineRenderInfos.length>=4&&y();break;case te.DOCLayoutType.TableLine:if(y(),!t.tablecells)return;if(!t.renderInfo.needRenderTableContent)return;_||(e.tableLineRender||(e.tableLineRender=new Qe),_=e.tableLineRender),_.reset(e.canvas,null,e.data,e),e.typoContext.defaultColor=p,_.render(t,e.typoContext);break;default:y()}})),this.typoContext.defaultColor=p,y()}},{key:"_addCount",value:function(e,t){t[e]?++t[e]:t[e]=1}},{key:"_prepare",value:function(){var e=this,t={editExceptions:[],formatContentControls:[]},n=this.lines,i={},r={},o={},a={},s=this.data.doc.viewSettings.getDisplayDocumentFields(),l=s!==gt.wpsNotDisplayDocumentFileds,d=s===gt.wpsDisplayDocumentFields,h=function(t){e._addCount(t.fontStyle,o),e._addCount(t.fontWeight,a),e._addCount(t.fontSize,r),e._addCount(t.fontFamily,i)},c=!1,_=void 0,u=window.APP,p=!(u.isCooperationMode||!u.data.doc.viewSettings.getRevisionsShowMarkup()||u.data.doc.useCoreMeasure||u.isPaginationMode());this.textpage.range&&(this.needRenderReadonlyProtection&&(t.editExceptions=u.data.doc.protectExceptions.getExceptions(this.textpage.range)),this.needRenderFormatContentControlBackground&&(t.formatContentControls=u.formatContentController.getContentControlsByRange(this.textpage.range,{isOperable:!0})));var f=void 0;n.forEach((function(e,i){if(e.layoutType===te.DOCLayoutType.TextLine){if(!e.renderInfo||e.renderInfo.expired){e.renderInfo&&(f||(f=[]),f.push(e.renderInfo)),e.renderInfo={needRender:!0,y:e.rect.top},Gt(e)&&(e.renderInfo.needRenderBorder=!0);var r=Yt(e),o=r.vaildShading_back_color,a=r.vaildShadingsOrHighlights;if((o||a)&&(e.renderInfo.needRenderColorBlock=!0,o)){for(var s=i-1;s>=0;){var u=n[s--];if(u.layoutType!==te.DOCLayoutType.TextLine||!Yt(u).vaildShading_back_color)break;u.renderInfo.needRenderColorBlock=!0}for(var g=i+1;g<n.length;){var v=n[g++];if(v.layoutType!==te.DOCLayoutType.TextLine||!v.renderInfo||!Yt(v).vaildShading_back_color)break;v.renderInfo.needRenderColorBlock=!0}}(e.coopSelColorInfos||e.sublines&&e.sublines.some((function(e){return e.coopSelColorInfos})))&&(e.renderInfo.needRenderCoopSel=!0),l&&(d?(e.documentFields||e.documentFieldBrackets||e.sublines&&e.sublines.find((function(e){return e.documentFields||e.documentFieldBrackets})))&&(e.renderInfo.needRenderDocumentFields=!0):(e.documentFieldBrackets||e.sublines&&e.sublines.find((function(e){return e.documentFieldBrackets})))&&(e.renderInfo.needRenderDocumentFields=!0)),p&&(void 0===e.hasRevisionLine&&(e.hasRevisionLine=ft.needRenderPara(e)),e.hasRevisionLine&&(e.renderInfo.needRenderRevisionLine=!0));var m=e.range.pos,y=e.range.len+m;t.editExceptions.some((function(t){var n=t.pos,i=n+t.len;if(!(n>=y||i<=m))return e.renderInfo.needRenderEditable=!0,!0})),t.formatContentControls.some((function(t){var n=t.pos,i=n+t.len;if(!(n>=y||i<=m))return e.renderInfo.needRenderEditable=!0,!0}))}else e.renderInfo.moved&&(c=!0,_||(_=new Map),_.set(e.renderInfo,e.rect.top));if(e.sublines&&e.sublines.length){var b=!1;e.sublines.forEach((function(e){!b&&e.glyphGroupInfos&&e.glyphGroupInfos.some((function(e){var t=e.font;if(t)return h(t),b=!0,!0}))}))}else e.glyphGroupInfos&&e.glyphGroupInfos.some((function(e){var t=e.font;if(t)return h(t),!0}))}else if(e.layoutType===te.DOCLayoutType.TableLine&&e.tablecells)if(e.renderInfo)if(e.renderInfo.expired||e.hasMergedCell||e.rect.top!==e.renderInfo.y){var w=!0,x=e.tablecells.map((function(e){for(var t=e.nextMergedCell;t;){var n=t.cellHeight||0,i=t.rect&&t.rect.height||0;n!==i&&(w=!1),t.cellHeight=i,t=t.nextMergedCell}return{width:e.rect.width,mergeType:e.merge_type}}));e.renderInfo.height!==e.rect.height||function(e,t){if(e.length!==t.length)return!0;for(var n=0,i=e.length;n<i;++n){var r=e[n],o=t[n];if(r.width!==o.width||r.mergeType!==o.mergeType)return!0}return!1}(x,e.renderInfo.cells)||e.renderInfo.moved||!w||e.rect.top!==e.renderInfo.y?(f||(f=[]),f.push(e.renderInfo),e.cleanRenderInfo(!0),e.renderInfo={needRenderTableBorder:!0,y:e.rect.top,height:e.rect.height,needRenderTableContent:!0,cells:x}):e.renderInfo.needRenderTableContent=!0}else e.renderInfo.moved&&(c=!0,_||(_=new Map),_.set(e.renderInfo,e.rect.top));else{var k=e.tablecells.map((function(e){return{width:e.rect.width,mergeType:e.merge_type}}));e.renderInfo={needRenderTableBorder:!0,y:e.rect.top,height:e.rect.height,needRenderTableContent:!0,cells:k}}else e.renderInfo||(e.renderInfo=[])}));var v=window.APP.fontServer,m=this.getCtx("main-content").currentNode,y=function(e,t){var n=void 0;return m.hasAttribute(e)?n=m.getAttribute(e):(n=t(),m.setAttribute(e,n)),n};this.textpageBaseFont={style:y("font-style",(function(){return Xt(o)})),size:y("font-size",(function(){return Xt(r)})),family:y("font-family",(function(){return v.getFontNameForRender(Xt(i))})),weight:y("font-weight",(function(){return Xt(a)})),fillStyle:y("fill",(function(){return e.defaultColor}))};var b=this.renderInfo;if(b){var w=b.removed,x=b.renderUnits,k=void 0;if(w?(k=[].concat(g()(w)),f&&(k=k.concat(f))):f&&(k=f),k&&k.length&&this.canvas.onRemoveLineRenderInfos&&this.canvas.onRemoveLineRenderInfos(k),k&&k.length||c){var C=!1,P=void 0,S=function(e){k&&k.includes(e)?C=!0:e.moved&&(P||(P=[]),P.push(_.get(e)-e.y))},M={"main-content":function(e){e.needRender=!0},"para-border":function(e){e.needRenderBorder=!0},"chp-shd":function(e){e.needRenderColorBlock=!0},highlight:function(e){e.needRenderColorBlock=!0},coopsels:function(e){e.needRenderCoopSel=!0},documentfileds:function(e){e.needRenderDocumentFields=!0},"editable-area":function(e){e.needRenderEditable=!0},"revision-lines":function(e){e.needRenderRevisionLine=!0},"cell-shd":function(e){e.needRenderTableContent=!0},"table-border":function(e){e.needRenderTableBorder=!0},embed:function(e){},commentParagraph:function(e){}},I={"para-border":!0};Object.keys(x).forEach((function(e){!function(e,t,n){for(var i=e.length-1;i>=0;--i){var r=e[i];if(C=!1,P=null,r.lineRenderInfos.forEach(S),C)e.splice(i,1),t&&r.lineRenderInfos.forEach(t),Vt(r.svgNode);else if(P)if(P.length===r.lineRenderInfos.length&&qt(P)&&!n){var o=_.get(r.lineRenderInfos[0]);a=r.svgNode,s=o,a.setAttribute("transform","translate(0, "+s+")"),r.y=o}else e.splice(i,1),t&&r.lineRenderInfos.forEach(t),Vt(r.svgNode)}var a,s}(x[e],M[e],I[e])}))}}return t}},{key:"_afterRender",value:function(){this.lines.forEach((function(e){var t=e.renderInfo;e.layoutType===te.DOCLayoutType.TextLine?(delete t.needRender,delete t.moved,delete t.needRenderBorder,delete t.needRenderColorBlock,delete t.needRenderCoopSel,delete t.needRenderDocumentFields,delete t.expired,delete t.needRenderRevisionLine,delete t.needRenderEditable,t.y=e.rect.top):e.layoutType===te.DOCLayoutType.TableLine&&(delete t.needRenderTableBorder,delete t.needRenderTableContent,delete t.expired,delete t.moved,t.y=e.rect.top)}));var e=this.renderInfo;delete e.removed,delete e.expired}},{key:"_mergeColorBlock",value:function(e,t,n){var i=e.findIndex((function(e){return function(e,t){if(e===t)return!0;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;var r=!1;return n.some((function(n){if(e[n]!==t[n])return r=!0,!0})),!r}(e.color,t)}));if(i<0){var r={color:t,rects:[n]};e.push(r)}else e[i].rects.push(n)}},{key:"_renderColorBlock",value:function(){var e=this,t=[],n=[],i=[],r=[],o={papx_shadings:t,chpx_shadings:n,hightlighs:i,coopsels:r},a=this.textpage.textflow.isReverseLine,s=this.lines,l=this.textpage.rect.width;if(s.forEach((function(t){if(t instanceof Ke.a){var n=0;a&&(n=l-t.rect.top-t.rect.height-t.rect.top);var i=t.renderInfo;t.sublines?t.sublines.forEach((function(t){e._renderLinebaseColorBlock(t,i,n,o)})):e._renderLinebaseColorBlock(t,i,n,o)}})),t.length){var d=this.renderInfo.renderUnits["para-shd"]||[],h=this.getCtx("para-shd");t.forEach((function(e){var t=e.lineRenderInfos,n=e.y,i=e.color,r=e.rects,o={y:n,lineRenderInfos:t,svgNode:h.save()};h.translate(0,n),r.forEach((function(e){e.offset(0,-n)}));var a=Object(Ze.rects2Path)(r);i.type="papx_shadings",Object(Ze.renderColorBlock)(a,h,i),h.restore(),d.push(o)})),this.renderInfo.renderUnits["para-shd"]=d}var c=function(t,n,i){if(n.length){var r=e.renderInfo.renderUnits[t]||[],o=e.getCtx(t);n.forEach((function(e){var t=e.lineRenderInfos,n=e.y,a=e.blocks,s={y:n,lineRenderInfos:t,svgNode:o.save()};o.translate(0,n),a.forEach((function(e){var t=e.rects,r=e.color;t.forEach((function(e){e.offset(0,-n)}));var a=Object(Ze.rects2Path)(t);r.type=i,Object(Ze.renderColorBlock)(a,o,r)})),r.push(s),o.restore()})),e.renderInfo.renderUnits[t]=r}};c("chp-shd",n,"shadings"),c("highlight",i,"highlight"),c("coopsels",r,"coopsels")}},{key:"_renderLinebaseColorBlock",value:function(e,t,n,i){var r=this;this._doRenderColorBlock(e,t,n,i),e.zones&&e.zones.forEach((function(e){switch(e.type){case Ue.b.TwoLinesInOne:e.secondLine&&(r._doRenderColorBlock(e.firstLine,t,n,i),r._doRenderColorBlock(e.secondLine,t,n,i))}}))}},{key:"_doRenderColorBlock",value:function(e,t,n,i){var r=this,o=e.shadingBackColorInfos,a=e.highlightColorInfos,s=e.shading_back_color,l=e.coopSelColorInfos;if(t.needRenderColorBlock){if(s){var d=x.a.initByRawRect(e.borderAndShdRect);0!==n&&d.offset(0,n),d.bottom+=1;var h={alpha:0,color:s},c=i.papx_shadings,_=c.length?c[c.length-1]:null,u=_&&_.rects[_.rects.length-1];_&&h.alpha===_.color.alpha&&h.color===_.color.color&&(Math.abs(d.top-u.bottom)<=1||Math.abs(d.top-u.top)<=1)?(u.bottom-1===d.top&&(u.bottom-=1),_.rects.push(d),_.lineRenderInfos.push(t)):c.push({y:t.y,lineRenderInfos:[t],color:h,rects:[d]})}var p=e.rect.top+n,f=e.rect.bottom+n;if(o&&o.length){var g=e.glyphGroupInfos.metrics,v=g.height*(1/8),m={ascent:g.ascent+v,descent:g.descent+v,height:g.height+2*v},y=m.height,b=e.rect.top+(e.baseline-m.ascent)+n,w=i.chpx_shadings[i.chpx_shadings.length-1];w&&w.lineRenderInfos[0]===t||(w={y:t.y,lineRenderInfos:[t],blocks:[]},i.chpx_shadings.push(w)),o.forEach((function(t){var i=t.range,o=i.left,a=i.right,s=i.top,l=i.bottom,d={alpha:.2,back:t.shadingBackColor,fill:t.shadingFillColor,texture:t.shadingTexture},h=void 0!==s?e.rect.top+s+n:Math.max(p,b),c=void 0!==l?e.rect.top+l+n:Math.min(f,b+y),_=x.a.initByRawRect({left:o,top:h,right:a,bottom:c});r._mergeColorBlock(w.blocks,d,_)}))}if(a&&a.length){var k=i.hightlighs[i.hightlighs.length-1];k&&k.lineRenderInfos[0]===t||(k={y:t.y,lineRenderInfos:[t],blocks:[]},i.hightlighs.push(k));var C=p,P=f;if(e.strongAscent>0){var S=e.rect.top+e.baseline-e.strongAscent+n;C=Math.max(p,S),P=Math.min(f,S+e.strongAscent+e.strongDescent)}if(a.forEach((function(t){var i=t.range,o=i.left,a=i.right,s=i.top,l=i.bottom;if(void 0===s||void 0===l){var d=x.a.initByRawRect({left:o,top:C,right:a,bottom:P}),h={alpha:0,color:t.color};r._mergeColorBlock(k.blocks,h,d)}else{var c=x.a.initByRawRect({left:o,top:e.rect.top+s+n,right:a,bottom:e.rect.top+l+n}),_={alpha:0,color:t.color};r._mergeColorBlock(k.blocks,_,c)}})),e.auto_num&&e.auto_num.chpx&&e.auto_num.chpx.highlight_color&&"#ffffffffff000000"!==e.auto_num.chpx.highlight_color){var M={alpha:0,color:e.auto_num.chpx.highlight_color},I=e.auto_num.line.rect,T=I.left,R=I.right,N=x.a.initByRawRect({left:T,top:C,right:R,bottom:P});N.offset(e.auto_num_pos.x,0),this._mergeColorBlock(k.blocks,M,N)}}}if(l&&!this.isInCommentPage&&window.APP.isCooperationMode&&t.needRenderCoopSel){var E=this.getSelfInfo();if(E){var A=l.filter((function(e){return e.tagid!==E.tagid}));if(A.length){var O=e.rect.top+n,L=e.rect.bottom+n,F=e.rect.top+e.baseline-e.strongAscent+n,D=Math.max(O,F),B=Math.min(L,F+e.strongAscent+e.strongDescent),j=i.coopsels[i.coopsels.length-1];j&&j.lineRenderInfos[0]===t||(j={y:e.rect.top,lineRenderInfos:[t],blocks:[]},i.coopsels.push(j)),A.forEach((function(t){var i={alpha:.2,color:r.getColorByTagid(t.tagid)},o=t.range,a=o.left,s=o.right,l=o._top,d=o._bottom,h=void 0!==l?l+e.rect.top+n:D,c=void 0!==d?d+e.rect.top+n:B,_=x.a.initByRawRect({left:a,top:h,right:s,bottom:c});r._mergeColorBlock(j.blocks,i,_)}))}}}}},{key:"renderTableBorder",value:function(){ot.render(this.textpage,this)}},{key:"renderColumnLine",value:function(e){if(e&&e.shouldRender){var t=this.ctx.currentNode;if(!Object(Ze.findSvgNode)("columnline",t)){var n=this.getCtx("columnline");n.save(),n.strokeStyle="#000",n.beginPath(),n.moveTo(.5-e.leftOffset,0),n.lineTo(.5-e.leftOffset,this.textpage.rect.height),n.stroke(),n.restore()}}}},{key:"renderRevisionLine",value:function(){var e=this;if(!window.APP.isCooperationMode&&window.APP.data.doc.viewSettings.getRevisionsShowMarkup()&&!window.APP.data.doc.useCoreMeasure&&!window.APP.isPaginationMode()){var t=void 0,n=this.textpage.renderInfo.renderUnits["revision-lines"]||[],i=this.data.selection.selRevision.activeRevisionInfo.activeRevision;this.lines.forEach((function(r){if(r.hasRevisionLine&&r.renderInfo.needRenderRevisionLine){t||(t=e.getCtx("revision-lines"));var o=r.rect.top,a={y:o,lineRenderInfos:[r.renderInfo],svgNode:t.save()};n.push(a),t.translate(0,o),ft.renderPara(t,r,e.data,i,e.canvas),t.restore()}})),n.length?this.textpage.renderInfo.renderUnits["revision-lines"]=n:delete this.textpage.renderInfo.renderUnits["revision-lines"]}}},{key:"_renderDocumentField",value:function(){var e=this,t=this.textpage.textflow.isReverseLine,n=this.textpage.rect.width,i=this.data.doc.viewSettings.getDisplayDocumentFields(),r=void 0,o=this.textpage.renderInfo.renderUnits.documentfileds||[];i!==gt.wpsNotDisplayDocumentFileds&&this.lines.forEach((function(a){if(a.renderInfo.needRenderDocumentFields){r||(r=e.getCtx("documentfileds"));var s=a.rect.top,l={y:s,lineRenderInfos:[a.renderInfo],svgNode:r.save()};o.push(l),r.translate(0,s),vt.render(a,r,t,n,i,e.canvas),r.restore()}})),o.length?this.textpage.renderInfo.renderUnits.documentfileds=o:delete this.textpage.renderInfo.renderUnits.documentfileds}},{key:"_renderLineNumbering",value:function(e){var t=this.getCtx("line-numbering"),n=t.currentNode;try{for(var i=n.childNodes,r=i.length-1;r>=0;r--)i[r]&&n.removeChild(i[r])}catch(e){}var o={};e.isRTL&&(o.isRTL=!0),e.isMulCol&&(o.isMulCol=!0),Mt.render(this.textpage,e.lineNumbering,e.lineNumberingCount,t,o)}},{key:"isInCommentPage",get:function(){var e=this.textpage.viewPage;return!(!e||e.layoutType!==te.DOCLayoutType.CommentPage)}},{key:"needRenderReadonlyProtection",get:function(){var e=this.data.doc.viewSettings.getReadonlyProtectionExceptionsBackgroundVisible();return void 0===e&&(e=window.__CONFIG__.wps.highlightEditableAreas),e}},{key:"needRenderFormatContentControlBackground",get:function(){var e=window.APP.restrictEditHandler;return!(!e||!e.isInRestrictEditMode)&&window.__CONFIG__.wps.highlightControlAreas}},{key:"lines",get:function(){return this.textpage.lines}},{key:"rect",get:function(){return this.textpage.rect}},{key:"textflow",get:function(){return this.textpage.textflow}},{key:"renderInfo",get:function(){return this.textpage.renderInfo}}]),t}(p),Kt=n(309);function Jt(e,t,n,i,r){var o=e.getAttribute("clip-path")||"";if(o.startsWith("url(#")){var a=o.substring("url(#".length,o.length-1),s=Object(Ze.findSvgNode)(a,e);if(s){var l=s.childNodes[0];l.setAttribute("x",t),l.setAttribute("y",n),l.setAttribute("width",i),l.setAttribute("height",r)}}}function $t(e,t){if(!e)return!1;var n=function(e){var t=e&&e.getAttribute("clip-path")||"";if(t.startsWith("url(#")){var n=t.substring("url(#".length,t.length-1),i=Object(Ze.findSvgNode)(n,e);if(i){var r=i.childNodes[0];return{left:Number(r.getAttribute("x")),top:Number(r.getAttribute("y")),width:Number(r.getAttribute("width")),height:Number(r.getAttribute("height"))}}}return null}(e);return!(!n||!t)&&!function(e,t){return!!(e&&t&&Object(lt.d)(e.left,t.left)&&Object(lt.d)(e.top,t.top)&&Object(lt.d)(e.width,t.width)&&Object(lt.d)(e.height,t.height))}(n,t)}var en=function(e){function t(e,n,i){var r=i.textframe,o=i.typoContext,s=i.data;a()(this,t);var l=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return l.textframe=r,l.data=s,l.typoContext=o,l.docTextpageRender=new Zt,l}return _()(t,e),l()(t,[{key:"reset",value:function(e,n,i){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_init",this).call(this,e,n,i)}},{key:"render",value:function(e,t){this.textframe=e,this.typoContext=t,this.typoContext.enter(this.textframe),this._render(),this.typoContext.exit()}},{key:"_render",value:function(){var e=this.ctx;this.textframe.renderInfo||(this.textframe.renderInfo={renderSvgs:[]});var t=this.textframe.renderInfo,n=t.svgNode;t.svgNode=e.save(null,n);var i=this.textframe.subdoc_type===Kt.HeaderFooter!==this.data.selection.selContext.isInHeaderFooter;i&&e.saveAndSetAlpha(.6);var r=this.textframe.outer.host.layoutType===te.DOCLayoutType.TableLine;if(r){var o=this.textframe.outer,a=o.parent.parent,s=o.host,l=s.rect.height;if(1===a.merge_type){var d=function(e){for(var t=e.rect.left,n=e.rect.right,i=e.parent,r=i.parent.lines,o=e,a=r.indexOf(i)+1,s=r.length;a<s;++a){var l=r[a];if(l.layoutType!==te.DOCLayoutType.TableLine)break;for(var d=l.tablecells,h=!1,c=0,_=d.length;c<_;++c){var u=d[c];if(!(u.rect.right<=t||u.rect.left>=n)&&(u.merge_type&&u.merge_type!==Ge.e.NONE)){u.merge_type===Ge.e.LAST&&(h=!0),o=u;break}}if(h)break}return o}(a);if(d&&d.parent)l=d.parent.rect.bottom-s.rect.top}var h=ve.a.getPosition2view(a),c=h.x,_=h.y,u=a.rect.width,p=l,f=t.renderSvgs.cell_clip;e.save(null,f),f?t.moved&&Jt(f,c,_,u,p):e.clipRect(c,_,u,p)}var g=this._getClipRect();if(g){var v=t.renderSvgs.self_clip;e.save(null,v),v?(t.moved||$t(v,g))&&Jt(v,g.left,g.top,g.width,g.height):e.clipRect(g.left,g.top,g.width,g.height)}var m=t.renderSvgs.translate;t.renderSvgs.translate=e.save(null,m);var y=ve.a.getPosition2view(this.textframe);m?t.moved&&(m.setAttribute("transform","translate("+Math.round(y.x)+", "+Math.round(y.y)+")"),delete t.moved):e.translate(y.x,y.y);var b=this.docTextpageRender;if(b.reset(this.canvas,this.ctx,this.data),b.render(this.textFramePage,!1,this.typoContext),e.restore(null,!!m),g){var w=e.currentNode;e.restore(!0,!!t.renderSvgs.self_clip),t.renderSvgs.self_clip=w}if(r){var x=e.currentNode;e.restore(!0,!!t.renderSvgs.cell_clip),t.renderSvgs.cell_clip=x}i&&e.restoreAlpha(),e.restore(!0,!!n)}},{key:"_getClipRect",value:function(){if(this.textframe.isWrapTable)return null;var e=this.textframe.boundaryRect,t=this.textframe.visible_rect,n=ve.a.getPosition2view(this.textframe),i=this._getMargins();return{left:n.x+e.left-t.left-i.left,top:n.y+e.top-t.top-i.top,width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}}},{key:"_getMargins",value:function(){var e=0,t=0,n=0;if(this.textFramePage.lines.length){var i=this.textFramePage.lines[0];i.layoutType===te.DOCLayoutType.TableLine&&(t=i.leftMargin||0,n=i.rightMargin||0);var r=this.textframe.boundaryRect,o=this.textframe.visible_rect,a=this.textFramePage.lines[this.textFramePage.lines.length-1];e=Math.max(r.bottom-o.bottom,a.border&&a.border.after_width||0),t=Math.max(t,i.border&&i.border.left_width||0,a.border&&a.border.left_width||0),n=Math.max(n,i.border&&i.border.right_width||0,a.border&&a.border.right_width||0)}return{left:t,top:0,right:n,bottom:e}}},{key:"tableLayerLevel",get:function(){return this.textframe.table_layer_level}},{key:"visibleRect",get:function(){return this.textframe.visible_rect}},{key:"textFramePage",get:function(){return this.textframe.snippetPack}},{key:"shapesInTextframe",get:function(){return this.textframe.shapes_in_textframe}}]),t}(p),tn=n(80),nn=n.n(tn),rn=n(5300),on=n(2807),an=n(3904),sn=n.n(an),ln=n(4678),dn=n(4679),hn=n(5735),cn=function(e){function t(e,n,i){var r=i.textboxCard,o=i.typoContext,s=i.data,l=i.origin2View;a()(this,t);var d=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return d.textboxCard=r,d.data=s,d.typoContext=o,d.origin2View=l,d.docTextpageRender=new Zt,d}return _()(t,e),l()(t,[{key:"reset",value:function(e,n){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_init",this).call(this,e,n)}},{key:"render",value:function(e,t){this.textboxCard=e,this.typoContext=t,this.typoContext.enter(this.textboxCard),this._render(),this.typoContext.exit()}},{key:"_render",value:function(){var e=this.ctx,t=this.textboxCard.renderInfo.textboxOuterSvg,n=e.save(null,t),i=this.textboxPage.rect;if(!t||this.textboxCard.renderInfo.sizeChange||this.textboxPage.renderInfo.clipRectChange){var r=this.origin2View,o=this.textboxCard.renderScale||1,a=this.textboxCard,s=a.left_padding,l=a.right_padding,d=this.textboxCard.getTextBoxRect();e.clipRect(r.x+d.left-s,r.y+d.top,Math.max(d.width+s+l,0)/o,Math.max(d.height,0)/o),0!==r.x&&0!==r.y&&e.translate(r.x,r.y),this.textboxPage.renderInfo&&delete this.textboxPage.renderInfo.clipRectChange}var h=this.data.selection.selContext.isInHeaderFooter?this.textboxCard.subdoc_type===Kt.MainText:this.textboxCard.subdoc_type===Kt.HeaderFooter;h&&e.saveAndSetAlpha(.6);var c=this.typoContext.outShd,_=this.typoContext.outFontColor;this.typoContext.outShd=this.outShdColor,this.typoContext.outFontColor=this.outFontColor,this.docTextpageRender.reset(this.canvas,this.ctx,this.data),this.docTextpageRender.render(this.textboxPage,!1,this.typoContext),this.typoContext.outShd=c,this.typoContext.outFontColor=_,h&&e.restoreAlpha(),e.restore(!1,!!t),this.textboxCard.renderInfo.textboxOuterSvg=n,delete this.textboxCard.renderInfo.sizeChange,this.textboxPage.renderInfo.clipRect={left:i.left,top:i.top,width:i.width,height:i.height}}},{key:"_getOutLineWidth",value:function(){var e=this.textboxCard.shapeData.private;return e.outline&&e.outline.fill&&0===e.outline.fill.type?0:Math.ceil(Object(he.Ti2Px)(this.textboxCard.anchor&&this.textboxCard.anchor.outlineWidth||0))+1}},{key:"visibleRect",get:function(){return this.textboxCard.visible_rect}},{key:"textboxPage",get:function(){return this.textboxCard.textbox_page}},{key:"outShdColor",get:function(){var e=this.textboxCard.shapeProperty;if(e.fill&&0!==e.fill.type&&e.fill.color){var t=e.fill.color.hex;return t&&t.hex&&(t=t.hex),t}return null}},{key:"outFontColor",get:function(){var e=this.textboxCard.shapeData&&this.textboxCard.shapeData.private,t=e&&e.style;if(t){var n=t.fontColor&&t.fontColor.toRGB;if(n)return n.length>7&&(n="#"+n.slice(3,n.length)),n}return null}}]),t}(p),_n=n(1134),un=n(2849),pn=n(1090);function fn(e){return e&&(e.anchor&&e.anchor.nakedShapeData&&e.anchor.nakedShapeData.extData&&e.anchor.nakedShapeData.extData.isLatexMath||e.shapeData&&e.shapeData.private&&e.shapeData.private.extData&&e.shapeData.private.extData.isLatexMath)}function gn(e){return e&&e.indexOf("data:image/svg+xml;")>=0}var vn=new Map,mn=function(e){function t(e){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}var n;return _()(t,e),l()(t,[{key:"setShapeNodeInnerHtml",value:function(e,t,n){var i=e.svgNode,r=e.transformNode;if(!i)return!1;var o=r||i;try{var a=t.indexOf(","),s=t.substring(a+1),l=window.atob(s);l.startsWith("<?")&&(l=l.substring(l.indexOf(">")+1));for(var d=l.substring(l.indexOf(">")+1,l.lastIndexOf("<")),h=o.childNodes,c=h.length-1;c>=0;c--)h[c]&&o.removeChild(h[c]);var _=this.canvas.rootSvg.enterChildCtxByNode(o),u=_.save("latex-content"),p=/viewBox=\"(\d+) (\d+) (\d+) (\d+)\"/gi.exec(l),f=parseInt(p[3]),g=parseInt(p[4]),v={width:f,height:g},m=u.getAttribute("transform"),y=m;m||(m="");var b=m.indexOf("scale");b>=0&&(m=m.substring(0,b));var w=on.a.imageTransform(v,n);w.rotate&&(m=w.transform),(Math.abs(f-n.width)>1||Math.abs(g-n.height)>1)&&(w.rotate||(m+=w.transform)),y!==m&&u.setAttribute("transform",m),Object(ln.svgStringToSvgNode)(Object(rn.utf8ToUtf16)(d)).forEach((function(e,t){sn.a&&0===t&&Object(dn.default)(e),u.appendChild(e)})),_.restore()}catch(t){return Object(hn.showDebugInfo)(hn.MessageKey.setSrcFailedWhenPainting,e.shape.shape_tree_type+"-"+e.shape.id),console.error("set innser html svg fail",t),!1}return!0}},{key:"renderShape",value:function(e,t,n){if(window.APP.drawingTools){delete t.renderInfo.expired;var i=window.APP.collection.shape.recordRenderShape(t);if(t.isPresetDrawing)return this.renderPresetDrawing(e,t),void i.done();if(t.isWebshape){var o=t.anchor&&t.anchor.refShapeObjId,a=this.getAvailableSourceInfo(t.shape_tree_type,t.id,o),s=a.url,l=a.imageSize,d=a.isNewest;e.shape||(e.shape={id:t.id,shape_tree_type:t.shape_tree_type});var h=t.innerBoundary||r()({},t.size,{left:0,top:0}),c=this.canvas.rootSvg.enterChildCtxByNode(e.svgNode);e.transformNode=c.save("transform"),c.translate(Math.round(h.left),Math.round(h.top)),c.restore();var _={width:h.width,height:h.height},u=Date.now(),p=this.getRenderKey(e);return vn.set(p,u),s?(this.setWebshapeSrc(e,t.webshapeUrl,l,_),d?(Object(hn.showDebugInfo)(hn.MessageKey.existPaintingWhenCacheIsNewest,p),!0):void 0):void(this.renderWebshape(e,t,_)&&i.done())}if(this.needRenderTextbox(t)){var f=this.canvas.rootSvg.enterChildCtxByNode(e.svgNode);f.seekEndInsertPos();var g=!1,v=t.renderInfo.textboxRotationSvg,m=t.visualTransform2D,y=t.drawingLayout.layoutRect,b=m.rotation;m.verticalFlipped&&(b=(b+180)%360),t.isRotateText&&0!==b&&(g=!0,t.renderInfo.textboxRotationSvg=f.save("textboxRotation",v),v||f.rotate(b/180*Math.PI,y.width/2,y.height/2)),this.renderTextboxShapeForSvg(t,f),g&&f.restore(!1,!!v)}this._renderShape(e,t,n).then((function(e){e&&i.done()})).catch((function(e){i.fail(),console.warn(e)}))}else window.APP.initDrawing([{pos:t.pos,len:t.len}])}},{key:"_renderShape",value:(n=nn()(regeneratorRuntime.mark((function e(t,n,i){var r,o,a,s,l,d,h,c,_,u,p,f,g,v,m,y,b,w,x,k,C,P,S,M,I,T,R,N,E,A,O,L,F,D,B,j=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.shape||(t.shape={id:n.id,shape_tree_type:n.shape_tree_type}),r=i,o=n.shape_tree_type,a=n.id,s=n.visualTransform2D,l=(s=void 0===s?{horizontalFlipped:!1,verticalFlipped:!1,rotation:0}:s).horizontalFlipped,d=s.verticalFlipped,h=s.rotation,c=n.shapeData.private,_=c.picture,u=c.fill,p=c.isChart,f=fn(n),n.isRealPicture||p||f?(h||l||d)&&(m=this.canvas.rootSvg.enterChildCtxByNode(t.svgNode),t.transformNode=m.save("transform"),m.translate(r.width/2,r.height/2),0!==h&&m.rotate(h/180*Math.PI,0,0),(l||d)&&m.scale(l?-1:1,d?-1:1),m.translate(-r.width/2,-r.height/2),m.restore()):(g=n.innerBoundary,v=this.canvas.rootSvg.enterChildCtxByNode(t.svgNode),t.transformNode=v.save("transform"),v.translate(Math.round(g.left),Math.round(g.top)),v.restore(),r={width:g.width,height:g.height}),n.isRealPicture&&(y=t.svgNode,b=t.transformNode,u&&u.color&&u.type===_n.a.FillTypeSolidColor&&(w=this.canvas.rootSvg.enterChildCtxByNode(b||y),x=Object(un.c)(u.color.toRGB),w.fillStyle=x.hex,t.backShdNode=w.fillRect(0,0,r.width,r.height)),_.sourceRectangle&&((k=this.canvas.rootSvg.enterChildCtxByNode(b||y)).seekEndInsertPos(),t.sourceRectangleNode=k.save("source-rectangle"),C=_.sourceRectangle,P=C.left,S=C.top,M=C.right,I=C.bottom,(P>0||S>0||M>0||I>0)&&k.clipRect(0,0,r.width,r.height),r={width:r.width/(1-P-M),height:r.height/(1-S-I)},0===P&&0===S||(t.sourceRectangleNode=k.save(),k.translate(-r.width*P,-r.height*S),k.restore()),k.restore())),T=this.getRenderKey(t),n.isRealPicture&&(this.shapeManager.shapeMap.getShapeInfo(o,a,!0).isPicture=!0),R=this.shapeManager.shapeMap.getFormat(o,a),!(N=n.anchor&&this.shapeManager.getPicCache(n.anchor.shapeData.mimeDataId,n.anchor.shapeData))){e.next=16;break}return Promise.resolve(N).then((function(e){var n=e.url,i=e.info,o={width:i.width,height:i.height};(f&&gn(n)?j.setShapeNodeInnerHtml(t,n,r):j.setShapeNodeSrc(t,n,o,r))&&Object(hn.showDebugInfo)(hn.MessageKey.paintImageSuccessfullyWithOriginalCache,T)})),e.abrupt("return");case 16:if(E=n.anchor&&n.anchor.refShapeObjId,A=this.getAvailableSourceInfo(o,a,E),O=A.url,L=A.imageSize,F=A.isNewest,!O){e.next=24;break}if(Promise.resolve().then((function(){f&&gn(O)?j.setShapeNodeInnerHtml(t,O,r):j.setShapeNodeSrc(t,O,L,r)})),!F){e.next=23;break}return Object(hn.showDebugInfo)(hn.MessageKey.existPaintingWhenCacheIsNewest,T),e.abrupt("return",!0);case 23:Object(hn.showDebugInfo)(hn.MessageKey.waitToPaintWhenCacheIsOutOfDate,T);case 24:if(D=n.dataVersion,B=Date.now(),vn.set(T,B),null!==R){e.next=37;break}return e.prev=28,e.next=31,this.shapeManager.getShapeUrl(o,a,n.isRealPicture,!1,D);case 31:e.next=36;break;case 33:return e.prev=33,e.t0=e.catch(28),e.abrupt("return",Promise.reject(e.t0));case 36:R=this.shapeManager.shapeMap.getFormat(o,a);case 37:if(!f||"svg"!==R){e.next=41;break}return e.abrupt("return",this.renderLateXMath(t,n,r,B));case 41:return e.abrupt("return",this.renderImage(t,n,r,B,D));case 42:case"end":return e.stop()}}),e,this,[[28,33]])}))),function(e,t,i){return n.apply(this,arguments)})},{key:"renderImage",value:function(e,t,n,i,r){var o=this,a=this.getRenderKey(e),s=t.shape_tree_type,l=t.id;return this.shapeManager.getShapeUrl(s,l,t.isRealPicture,!1,r).then((function(r){var d=function(t,r){return!!o.checkShouldRender(!1,r,i,a)&&o.setShapeNodeSrc(e,t,r,n)}(r,o.shapeManager.getImageSize(s,l,t.isRealPicture));return d&&Object(hn.showDebugInfo)(hn.MessageKey.paintThumbnailSuccessfully,a),d}),(function(e){return console.warn("getShapeUrl error"),Promise.reject(e)}))}},{key:"renderWebshape",value:function(e,t,n,i){var r=this,o=t.dataVersion,a=t.shape_tree_type,s=t.id;return this.shapeManager.getShapeUrl(a,s,t.isRealPicture,!1,o).then((function(){var i=r.shapeManager.getImageSize(a,s,t.isRealPicture);r.setWebshapeSrc(e,t.webshapeUrl,i,n)}))}},{key:"renderLateXMath",value:function(e,t,n,i){var r=this,o=this.getRenderKey(e),a=t.shape_tree_type,s=t.id;return this.shapeManager.getShapeBase64Data(a,s).then((function(t){var l=function(t,a){return gn(t)?r.setShapeNodeInnerHtml(e,t,n):!!r.checkShouldRender(!1,a,i,o)&&r.setShapeNodeSrc(e,t,a,n)}(t,r.shapeManager.getImageSize(a,s,!0));return l&&Object(hn.showDebugInfo)(hn.MessageKey.paintThumbnailSuccessfully,o),l})).catch((function(e){console.warn("getShapeUrl error")}))}},{key:"checkShouldRender",value:function(e,t,n,i){return!e&&(void 0===t.width||void 0===t.height?(Object(hn.showDebugInfo)(hn.MessageKey.sourceSizeMissingWhenPainting,i),!1):!(n<vn.get(i))||(Object(hn.showDebugInfo)(hn.MessageKey.discardOutdatedPainting,i),!1))}},{key:"getRenderKey",value:function(e){var t=e.shape,n=t.shape_tree_type,i=t.id;return(this.layout||this.mobilepage).layout_index+"-"+n+"-"+i}},{key:"getAvailableSourceInfo",value:function(e,t,n){var i=this.shapeManager.getShapeFromMap(e,t),r=void 0,o=void 0,a=i&&!i.isOutOfDate,s=null,l=null;if(i&&(i.latestAvailableSourceInfo||i.latestAvailableOrgSourceInfo))s=i.latestAvailableSourceInfo,l=i.latestAvailableOrgSourceInfo;else if(n){var d=this.shapeManager.shapeMap.traverseMap((function(e){return e.refShapeObjId===n})).find((function(e){return!!e.latestAvailableSourceInfo||!!e.latestAvailableOrgSourceInfo}));d&&(s=d.latestAvailableSourceInfo,l=d.latestAvailableOrgSourceInfo)}return i&&l&&(l?(r=l.base64Data,o=l.size):a=!1),!r&&s&&(r=s.base64Data,o=s.size),{url:r,imageSize:o,isNewest:a}}},{key:"_getParentRotation",value:function(e){for(var t=0,n=e.parent;n;){var i=n.rotation;0!==i&&(t+=i),n=n.parent}return t}},{key:"renderPresetDrawing",value:function(e,t){var n=this,i=window.APP.drawingTools,r=this.canvas.rootSvg.enterChildCtxByNode(e.svgNode);if(t.isGroup)t.shapeData.isCanvasShape&&!t.renderInfo.shapeCanvas&&(t.renderInfo.shapeCanvas=r.save("shapeCanvas"),i.renderCanvasShape(t.shapeData,t.isTopShape?null:t.drawingLayout,r),r.restore()),t.childShapes.forEach((function(e){e.renderInfo||(e.renderInfo={});var t=e.renderInfo.svgNode,i=r.save("shape_"+e.shape_tree_type+"_"+e.id,t);e.renderInfo.svgNode=i;var o=e.drawingLayout.layoutRect;if(!e.isGroup&&!t){var a=e.rect2TopShape;r.translate(a.left,a.top)}r.restore(!1,!!t),t&&r.seekNextInsertPos(),n.renderShape({svgNode:i},e,{width:o.width,height:o.height})}));else{var o=t.drawingLayout,a=t.visualTransform2D,s=t.renderInfo.presetDrawingSvg;t.renderInfo.presetDrawingSvg=r.save("presetDrawing",s);var l=t.drawingLayout.layoutRect;if(s||(0!==a.rotation&&t.isRotateText&&t.hasEnterTextbox()&&r.rotate(-a.rotation/180*Math.PI,l.width/2,l.height/2),i.render(r,t.shapeData,o)),r.restore(!1,!!s),this.needRenderTextbox(t)){var d=!1,h=t.renderInfo.textboxRotationSvg,c=a.rotation;a.verticalFlipped&&(c=(c+180)%360),t.isRotateText&&0!==c&&(d=!0,t.renderInfo.textboxRotationSvg=r.save("textboxRotation",h),h||r.rotate(c/180*Math.PI,l.width/2,l.height/2)),this.renderTextboxShapeForSvg(t,r),d&&r.restore(!1,!!h)}}}},{key:"needRenderTextbox",value:function(e){return e.textbox_page}},{key:"renderTextboxShapeForSvg",value:function(e,t){var n=new me.a;n.enter(e.viewPage);var i=this.docTextboxShapeRender;i||(i=this.docTextboxShapeRender=new cn(this.canvas,t,{data:this.data,origin2View:{x:0,y:0}})),i.reset(this.canvas,t,this.data),i.render(e,n),n.exit()}},{key:"setWebshapeSrc",value:function(e,t,n,i){var r=e.svgNode,o=e.transformNode,a=e.sourceRectangleNode;o.firstChild&&o.removeChild(o.firstChild);var s=e.shapeNode,l=e.imagescale,d=e.shape,h=d.shape_tree_type+"-"+d.id,c=on.a.imageTransform(n,i);if(!r)return Object(hn.showDebugInfo)(hn.MessageKey.nodeMissingWhenPainting,h),!1;if(e.shapeNode){var _=r.children,u=_[_.length-1];s=e.shapeNode,u.appendChild(s)}else(s=e.shapeNode=document.createElementNS("http://www.w3.org/2000/svg","foreignObject")).setAttribute("draggable",!1),Object(pn.drawWebshape)(s,e.shape.id,t,c),a?a.insertBefore(s,a.firstChild):o.appendChild(s);try{var p=s.parentNode,f=on.a.imageTransform(n,i);if(Math.abs(n.width-i.width)>1||Math.abs(n.height-i.height)>1||l){var g=f.transform;l||(l=e.imagescale=this.canvas.context.createG("imagescale"),p.insertBefore(l,s),p.removeChild(s)),l.appendChild(s),l.setAttribute("transform",g)}s.setAttribute("width",f.width),s.setAttribute("height",f.height),s.setAttribute("style","border: 1px solid rgba(13, 13, 13, 0.12); border-radius: 8px; cursor: auto; display: flex; flex-direction: column; align-items: center; justify-content: flex-start;")}catch(e){return Object(hn.showDebugInfo)(hn.MessageKey.setSrcFailedWhenPainting,h,e),console.error("set webshape url fail:",e),!1}return!0}},{key:"setShapeNodeSrc",value:function(e,t,n,i){var r=e.svgNode,o=e.transformNode,a=e.sourceRectangleNode,s=e.backShdNode,l=e.shapeNode,d=e.imagescale,h=e.shape,c=h.shape_tree_type+"-"+h.id;if(!r)return Object(hn.showDebugInfo)(hn.MessageKey.nodeMissingWhenPainting,c),!1;e.shapeNode?l=e.shapeNode:((l=e.shapeNode=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("draggable",!1),a?a.insertBefore(l,a.firstChild):o?s?o.insertBefore(l,o.childNodes[1]):o.insertBefore(l,o.firstChild):s?r.insertBefore(l,r.childNodes[1]):r.insertBefore(l,r.firstChild));try{var _=l.parentNode,u=on.a.imageTransform(n,i);if(Math.abs(n.width-i.width)>1||Math.abs(n.height-i.height)>1||d){var p=u.transform;d||(d=e.imagescale=this.canvas.context.createG("imagescale"),_.insertBefore(d,l),_.removeChild(l),d.appendChild(l)),d.setAttribute("transform",p)}l.setAttribute("width",u.width),l.setAttribute("height",u.height),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t)}catch(e){return Object(hn.showDebugInfo)(hn.MessageKey.setSrcFailedWhenPainting,c,e),console.error("set image url fail:",e),!1}return!0}}]),t}(p),yn=function(e){function t(e,n){var i=n.data,r=n.shapes,o=n.renderEmbeds,s=n.typoContext,l=n.layout,d=n.shapesParent;a()(this,t);var c=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c.data=i,c.layer=i.doc.layer,c.shapeManager=i.shapeManager,c.shapeMap=c.shapeManager.shapeMap,c.canvas.shapes=c.shapes=r,c.needRenderEmbeds=o,c.typoContext=s,c.layout=l,c.shapesParent=d,c.embedShapes=l.renderEmbeds,window.APP.dumpPic&&(c.ignoralGif=!0,c.pageDumper=window.APP.workspace.canvasHandler.pageDumper),c}return _()(t,e),l()(t,[{key:"getShapeRect",value:function(e){var t=e.isTopShape?e.pic_rect||e.visible_rect||e.renderRect:e.viewRect;if(!t)return x.a.initByRawRect({left:0,top:0,right:0,bottom:0});var n=t.left,i=t.top,r=t.height,o=t.width;if(o=Math.max(o,1),20===e.shapeType&&Math.abs(r)<1e-6&&e.anchor&&(r=Object(he.Ti2Px)(e.anchor.outlineWidth)),r=Math.max(r,1),e.outer.parent.parent instanceof Ge.c){var a=e.visible_rect,s=e.coor_pos2view;a&&s&&(n=Math.round(a.left)+s.x,i=Math.round(a.top)+s.y)}return x.a.initByRawRect({left:n,top:i,right:n+o,bottom:i+r})}},{key:"clearImgCanvas",value:function(){}},{key:"doRenderShape",value:function(e,t,n){this.renderShape(e,t,n)}},{key:"detectAndRenderEmbeds",value:function(){var e=this,t=this.embedShapes;if(this.layout.decorativePage&&(t=[].concat(g()(t),g()(this.layout.decorativePage.renderEmbeds))),t){var n=[];Object.keys(t).forEach((function(e){n.push(t[e])})),n.length&&(this.pageDumper&&this.pageDumper.beforeRenderShapes(this.canvas,n),Object(pn.getEmbedsUrlInfo)(n),n.forEach((function(t){var n=t.shape,i=t.size;e.doRenderShape(t,n,i)})))}}},{key:"renderShapes",value:function(e,t){var n=this;this.pageDumper&&this.pageDumper.beforeRenderShapes(this.canvas,e),e.forEach((function(e){var i=n.getShapeRect(e),r=e.renderInCell,o=!1;e.renderInfo?e.renderInfo.needFirstRender||i.width===e.renderInfo.renderRect.width&&i.height===e.renderInfo.renderRect.height||(o=!0):e.renderInfo={},e.renderInfo.renderRect=i;var a=e.renderInfo.svgNode,s={svgNode:r?a:t.save("shape_"+e.shape_tree_type+"_"+e.id,a)};if(r&&e.renderInfo.needFirstRender)a.setAttribute("transform","translate("+Math.round(e.rect.left)+", "+Math.round(e.rect.top)+")");else if(a){if(e.renderInfo.moved){var l=a.getAttribute("transform");l.startsWith("translate(")&&(l=l.substring(l.indexOf(")")+1)),r?a.setAttribute("transform","translate("+Math.round(e.rect.left)+", "+Math.round(e.rect.top)+")"+l):a.setAttribute("transform","translate("+Math.round(i.left)+", "+Math.round(i.top)+")"+l)}}else t.translate(Math.round(i.left),Math.round(i.top));if(e.renderInfo.needRerender){for(var d=a.childNodes,h=d.length-1;h>=0;h--)d[h]&&a.removeChild(d[h]);e.childShapes.forEach((function(e){e.cleanRenderInfo()})),delete e.renderInfo.topGroupRotationSvg,delete e.renderInfo.presetDrawingSvg,delete e.renderInfo.textboxRotationSvg,delete e.renderInfo.shapeCanvas}else if(a&&o){for(var c=a.childNodes,_=c.length-1;_>=0;_--)c[_]&&a.removeChild(c[_]);if(e.childShapes.forEach((function(e){e.cleanRenderInfo()})),e.hasEnterTextbox()){var u=e.renderInfo.textboxOuterSvg;u.parentNode.removeChild(u),e.has_textbox&&e.textbox_page.cleanRenderInfo()}delete e.renderInfo.textboxOuterSvg,delete e.renderInfo.topGroupRotationSvg,delete e.renderInfo.presetDrawingSvg,delete e.renderInfo.textboxRotationSvg,delete e.renderInfo.shapeCanvas}o&&e.textbox_page&&e.textbox_page.cleanRenderInfo(),r||(t.restore(!1,!!a),a&&t.seekNextInsertPos(),e.renderInfo.svgNode=s.svgNode),(!a||o||e.renderInfo.expired||e.renderInfo.needRerender||r&&e.renderInfo.needFirstRender)&&n.doRenderShape(s,e,i.size),delete e.renderInfo.needRerender,delete e.renderInfo.needFirstRender}))}},{key:"needRenderTextbox",value:function(e){return!!e.textbox_page&&(!e.hasEnterTextbox()||(this.activeTextBoxShape=e,!1))}},{key:"renderTextFrames",value:function(e,t){var n=this,i=this.docTextFrameShapeRender;i||(i=this.docTextFrameShapeRender=new en(this.canvas,t,{data:this.data})),e.forEach((function(e){e.isTextFrame&&(i.reset(n.canvas,t,e.text_frame_page),i.render(e,n.typoContext))}))}},{key:"renderActiveTextboxShapesForSVG",value:function(e,t){var n=this.activeTextBoxShape;if(n&&n.hasEnterTextbox()){var i=this.data.doc.getSubDocType(n.begin),r=e(i==Kt.HeaderFooter||i==Kt.TextboxInHF),o=r.ctx,a=r.renderLayers,s=this.getShapeRect(n),l=a&&a.childNodes[0];o.save(null,l),!l&&o.translate(Math.round(s.left),Math.round(s.top)),this.activeTextBoxSizeChange&&(n.renderInfo.sizeChange=!0),n.has_textbox&&n.textbox_page.range&&this.renderTextboxShapeForSvg(n,o,s),o.restore(!0,!!l),t()}this.activeTextBoxShape=null,delete this.activeTextBoxSizeChange}},{key:"renderEmbedTextBoxs",value:function(e,t){var n=this,i=t?this.canvas.hfCtx:this.canvas.context;e.forEach((function(e){!function e(t){if(t.isGroup)t.childShapes.forEach((function(t){e(t)}));else if(t.textbox_page&&t.textbox_page.renderInfo&&t.textbox_page.renderInfo.expired){var r=n.getShapeRect(t),o=i.enterChildCtxByNode(t.renderInfo.svgNode);o.seekEndInsertPos(),n.renderTextboxShapeForSvg(t,o,r)}}(e)}))}}]),t}(mn),bn=n(5737),wn=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _()(t,e),l()(t,[{key:"render",value:function(e,n){var i=e.footer_type&&!this.data.selection.selContext.isInHeaderFooter;this.node=this.textpage=e,i&&this.ctx.saveAndSetAlpha(.6),y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e,!0,n),i&&this.ctx.restoreAlpha()}}]),t}(Zt),xn=n(3930),kn=n(3931),Cn=function(){function e(){a()(this,e)}return l()(e,null,[{key:"renderLayoutCorner",value:function(t,n){var i=xn.a.getLayoutCorner(n),r=i.left_top_corner,o=i.right_top_corner,a=i.left_bottom_corner,s=i.right_bottom_corner;n.hasRenderCorner?t.seekNextInsertPos():(t.save("page-corner"),e.renderRightAngle(t,r),e.renderRightAngle(t,o),e.renderRightAngle(t,a),e.renderRightAngle(t,s),t.restore(),n.hasRenderCorner=!0)}},{key:"renderRightAngle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:24,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#0D0D0D1F",r=kn.a.R2L,o=kn.b.B2T,a=t.x,s=t.y,l=t.ver,d=t.hor;if(!isNaN(a)&&!isNaN(s)){var h={y:s,x:d===r?a-n:a+n},c={x:a,y:l===o?s-n:s+n};e.markRestore(),e.strokeStyle=i,e.markRestore(),e.lineWidth=1,e.beginPath(),e.moveTo(h.x-.5,h.y-.5),e.lineTo(a-.5,s-.5),e.lineTo(c.x-.5,c.y-.5),e.stroke(),e.restoreLineWidth(),e.restoreStyle()}}}]),e}(),Pn=[6,4],Sn="#0D0D0D1F",Mn=1,In=function(e){function t(e){var n=e.canvas,i=e.layout,r=e.typoContext,o=e.data;a()(this,t);var s=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,n.hfCtx,i));return s.layout=i,s.typoContext=r,s.data=o,s}return _()(t,e),l()(t,[{key:"renderCorner",value:function(){Cn.renderLayoutCorner(this.ctx,this.layout)}},{key:"renderHeaderFooter",value:function(e,t){this.ctx=e,this.data.selection.selContext.isInHeaderFooter&&!window.APP.isPaginationMode()&&(this.renderHeaderFooterEditArea(this.header,!0,t),this.renderHeaderFooterEditArea(this.footer,!1,t)),this.renderSubDoc(this.header),this.renderSubDoc(this.footer)}},{key:"renderSubDoc",value:function(e){if(e&&e.lines&&!(e.lines.length<=0)){var t=new wn;t.reset(this.canvas,this.ctx,this.data),t.render(e,this.typoContext)}}},{key:"renderHeaderFooterEditArea",value:function(e,t,n){if(e){var i=this.layoutOuterRect.width,r=e.rect,o=t?"headerEditArea":"footerEditArea",a=this.layout.renderInfo[o];if(a||(this.layout.renderInfo[o]=a={layoutOuterWidth:i,rect:{}}),!a.svgNode||a.layoutOuterWidth!==i||r.left!==a.rect.left||r.top!==a.rect.top||r.width!==a.rect.width||r.height!==a.rect.height){a.svgNode&&a.svgNode.parentNode.removeChild(a.svgNode),a.svgNode=n.save(),this._renderHeaderFooterEditArea(r,i,t,n),a.layoutOuterWidth=i;var s=r.left,l=r.top,d=r.width,h=r.height;a.rect.top=l,a.rect.left=s,a.rect.width=d,a.rect.height=h,n.restore()}}}},{key:"_renderHeaderFooterEditArea",value:function(e,t,n,i){var r=xn.a.getLayoutCorner(this.layout).header_footer_limit,o=e.left,a=e.top,s=e.bottom,l=e.right,d=n?Math.max(s,r.top):Math.min(a,r.bottom),h=n?a:s,c={x:o,y:d},_={x:l,y:d},u={x:o,y:h},p={x:l,y:h},f=Sn,g=Mn,v=Pn,m=i;m.markRestore(),m.strokeStyle=f,m.lineWidth=g,m.setLineDash(v),m.beginPath();var y=this._skewDoubleNumLineForPoint(c);m.moveTo(y.x,y.y);var b=this._skewDoubleNumLineForPoint(u);m.lineTo(b.x,b.y);var w=this._skewDoubleNumLineForPoint(p);m.lineTo(w.x,w.y);var x=this._skewDoubleNumLineForPoint(_);m.lineTo(x.x,x.y),m.moveTo(0,y.y);var k=this._skewDoubleNumLineForPoint({x:t,y:y.y});m.lineTo(k.x,k.y),m.stroke(),m.restoreLineDash(),m.restoreStyle()}},{key:"_skewDoubleNumLineForPoint",value:function(e,t,n){var i=e.x,r=e.y;return{x:i=i%2==0?i:i+-1,y:r=r%2==0?r:r+-1}}},{key:"header",get:function(){return this.node.header}},{key:"footer",get:function(){return this.node.footer}},{key:"layoutInnerRect",get:function(){return this.node.inner_rect}},{key:"layoutOuterRect",get:function(){return x.a.initByRawRect(this.node.outer_rect)}}]),t}(p),Tn=function(e){function t(e,n){a()(this,t);var i=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.watermarkInfo=n,i}return _()(t,e),l()(t,[{key:"render",value:function(){if(this.watermarkInfo&&this.watermarkInfo.type&&this.watermarkInfo.value){var e=this.canvas.watermarkCtx;e.save();var t=this.canvas.getWatermarkPattern(this.watermarkInfo).patternId;e.addRect(0,0,"100%","100%","url(#"+t+")"),e.restore()}}}]),t}(p),Rn=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _()(t,e),l()(t,[{key:"render",value:function(){if(this.watermarkInfo&&this.watermarkInfo.type&&this.watermarkInfo.value){var e=this.canvas.watermarkSvg;if(e){var t=e.currentNode;if(t)for(var n=t.childNodes.length-1;n>=0;--n){var i=t.childNodes[n];"watermark"===i.getAttribute("id")&&(mt.default.dispatchEvent(mt.default.watermark.REMOVE_WATERMARK_OLD_NODE,{outerHTML:i.outerHTML}),t.removeChild(i))}e.save().setAttribute("id","watermark");var r=this.canvas.getWatermarkPattern(this.watermarkInfo);e.addRect(0,0,"100%","100%","url(#"+r.patternId+")"),e.restore()}}}}]),t}(Tn),Nn=n(144),En=n.n(Nn),An=n(4979);function On(e,t){var n=[].concat(g()(e));t.forEach((function(e){var t=void 0===e.begin?e.ctrl.begin:e.begin,i=void 0===e.end?e.ctrl.end:e.end,r=n.find((function(e){var n=void 0===e.begin?e.ctrl.begin:e.begin,r=void 0===e.end?e.ctrl.end:e.end;return n===t&&r===i}));r?Object.assign(r,e):n.push(e)}));var i=window.APP.data.selection.getNormalRange(),r=i.pos;return i.len||(n=n.filter((function(e){var t=void 0===e.begin?e.ctrl.begin:e.begin;return e._isShow||!r||t!=r&&t!=r+1}))),n}var Ln=function(e){function t(e,n,i){var r=i.data,o=i.layoutIndex;a()(this,t);var s=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.data=r,s.layoutIndex=o,s.typoMode=window.APP.typoMode,s}return _()(t,e),l()(t,[{key:"_createPath",value:function(e,t){var n=En()(t,1)[0];e.beginPath(),e.moveTo(n.x,n.y-0);for(var i=1;i<t.length-1;i++)e.lineTo(t[i].x,t[i].y-0);e.closePath()}},{key:"_renderDottedBox",value:function(e,t){var n=t.points;t.isInactive&&e.saveAndSetAlpha(ne.g),e.lineWidth=ne.h,e.setLineDash(ne.f),e.strokeStyle=ne.d.color,this._createPath(e,n),e.stroke(),e.restoreAlpha()}},{key:"_renderFullBox",value:function(e,t){var n=t.points,i=t.isInactive,r=t.controller,o=void 0===r?{}:r;i&&e.saveAndSetAlpha(ne.g);var a=[].concat(g()(n));e.lineWidth=ne.m,o.isDate?e.strokeStyle=ne.i.color:(o.isDropdownList||o.isComboBox)&&window.APP.isMobileMode()?e.strokeStyle=ne.j.color:e.strokeStyle=ne.l.color,this._createPath(e,a),e.stroke(),e.restoreAlpha()}},{key:"_renderColorBlock",value:function(e,t){var n=t.points;e.saveAndSetAlpha(ne.e),e.fillStyle=ne.d.color,this._createPath(e,n),e.fill(),e.restoreAlpha()}},{key:"renderCtrlHighlightArea",value:function(e,t){switch(t.type){case An.a.DOTTED_BOX:this._renderDottedBox(e,t);break;case An.a.COLOR_BLOCK:this._renderColorBlock(e,t);break;case An.a.FULL_BOX:this._renderFullBox(e,t)}}},{key:"hideAllUilController",value:function(){return mt.default.dispatchEvent(mt.default.contentControls.RENDER_CONTROLS,[]),!0}},{key:"_renderCtrlUILArea",value:function(e){var t=e.filter((function(e){return!!e&&!e.controller.isDate})),n=window.APP.workspace;if(!(t.length<=0)){if(t.length>1)return n&&(n.controllerRenderData=t),void mt.default.dispatchEvent(mt.default.contentControls.RENDER_CONTROLS,t);var i=t[0],r=[{points:i.points,rects:i.rects,controller:i.controller,minTextPage:i.minTextPage,maxTextPage:i.maxTextPage,minLayoutIndex:i.minLayoutIndex,maxLayoutIndex:i.maxLayoutIndex}];return n&&(n.controllerRenderData=r),mt.default.dispatchEvent(mt.default.contentControls.RENDER_CONTROLS,r),!0}this.hideAllUilController()}},{key:"_renderOrigiPicCtrlEntrance",value:function(e){var t=window.APP.workspace;t&&(t.picControlsRenderData=e),mt.default.dispatchEvent(mt.default.contentControls.RENDER_PIC_CONTROLS_ENTRANCE,e)}},{key:"_renderCtrlOutLine",value:function(e,t){var n=this;e.forEach((function(e){if(e.controller&&e.controller.data){var i=e.controller.data.objID+"-"+n.layoutIndex;t.save(i)}else t.save();n.renderCtrlHighlightArea(t,e),t.restore()}))}},{key:"_processActiveCtrlsUILArea",value:function(e){var t=this;return e&&e.map((function(e){var n=e.pointsMap,i=void 0===n?{}:n,r=e.ctrl,o=e.rect,a=e.highlightType,s=e.isInactive,l=e.minTextPage,d=e.maxTextPage,h=e.minLayoutIndex,c=e.maxLayoutIndex;return t.data.typoinfo.getPosition(r.begin).isTypeset?{isInactive:s,controller:r,type:a,rects:o,points:i,minTextPage:l,maxTextPage:d,minLayoutIndex:h,maxLayoutIndex:c}:null}))}},{key:"_processActiveCtrlsOutLine",value:function(e){var t=this;return e&&e.reduce((function(e,n){var i=n.pointsMap,r=void 0===i?{}:i,o=n.ctrl,a=n.highlightType,s=n.isInactive;if(!t.data.typoinfo.getPosition(o.begin).isTypeset)return e;var l=r[t.layoutIndex];if(!l)return e;for(var d=l.entries(),h=d.next(),c=[];!h.done;){h.value[1].forEach((function(e){c.push({isInactive:s,controller:o,type:a,points:e})})),h=d.next()}return[].concat(g()(e),c)}),[])}},{key:"_processOrigiPicCtrlsArea",value:function(){var e=this,t=[];if(window.APP.isMobileMode()||window.APP.isPaginationMode())return t;var n=void 0;return(n=window.APP.isWebMode()?window.APP.formatContentController.getAllSubDocsControls().filter((function(e){return e.isPicture&&e.showPlcHdr})):window.APP.formatContentController.getCurrentViewPageContentControls(!0))&&n.forEach((function(n){var i=e.data.typoinfo.embedShapeRanges&&e.data.typoinfo.embedShapeRanges.mapInRange(n.begin,n.end,v.IT.mapToNode,v.IT.strictIntersectTest);i&&i.length>=1&&i.forEach((function(e){var i=e.viewRect,r=e.viewPage.outer_rect;t.push({ctrl:n,rect:{left:i.left+r.left,top:i.top+r.top,width:i.width,height:i.height}})}))})),t}},{key:"render",value:function(e){var t=this._processOrigiPicCtrlsArea();t&&this._renderOrigiPicCtrlEntrance(t);var n=this._processActiveCtrlsUILArea(e);n&&this._renderCtrlUILArea(n);var i=this._processActiveCtrlsOutLine(e);i&&i.length>=1&&this._renderCtrlOutLine(i,this.ctx)}}]),t}(p),Fn=function(e){function t(e,n,i){var r=i.data,o=i.layoutIndex;a()(this,t);var s=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.data=r,s.layoutIndex=o,s.typoMode=window.APP.typoMode,s}return _()(t,e),l()(t,[{key:"_processActiveCatalogsOutLine",value:function(e){var t=this;return e&&e.reduce((function(e,n){var i=n.pointsMap,r=n.data,o=n.begin;if(!t.data.typoinfo.getPosition(o).isTypeset)return e;var a=i[t.layoutIndex];if(!a)return e;for(var s=a.entries(),l=s.next(),d=[];!l.done;){var h=l.value[1];d.push({data:r,points:h[0]}),l=s.next()}return[].concat(g()(e),d)}),[])}},{key:"_renderCatalogOutLine",value:function(e,t){var n=this;e.forEach((function(e){if(e&&e.data){var i=e.data.objID+"-"+n.layoutIndex;t.save(i)}else t.save();n._renderFullBox(t,e),t.restore()}))}},{key:"_renderFullBox",value:function(e,t){var n=t.points,i=[].concat(g()(n));e.lineWidth=ne.b,e.strokeStyle=ne.a.color,this._createPath(e,i),e.stroke(),e.restoreAlpha()}},{key:"_createPath",value:function(e,t){var n=En()(t,1)[0];e.beginPath(),e.moveTo(n.x,n.y-0);for(var i=1;i<t.length-1;i++)e.lineTo(t[i].x,t[i].y-0);e.closePath()}},{key:"render",value:function(e){var t=this._processActiveCatalogsOutLine(e);t&&t.length>=1&&this._renderCatalogOutLine(t,this.ctx)}}]),t}(p),Dn=n(10015),Bn=n(8843),jn=n(6006),Wn=function(){function e(){a()(this,e)}return l()(e,null,[{key:"render",value:function(e,t,n,i,r,o){e.renderInfo||(e.renderInfo={});var a=e.renderInfo.svgNode;e.renderInfo.svgNode=t.save(null,a);var s=e.parent.textflow;if(!a){var l=De.a.add(e.parent.position2parent,e.coororigin_pos2parent);if(t.translate(l.x,l.y),e.showSeparator){t.save();var d=void 0,h=void 0,c=void 0,_=void 0;"T2B"===s.corX?(d=c=s.isReverseLine?jn.b/2:e.rect.width-jn.b/2,h=0,_=Math.min(jn.c,e.rect.height)):"B2T"===s.corX?(d=c=jn.b/2,_=(h=e.rect.height)-Math.min(jn.c,e.rect.height)):(d=0,c=Math.min(jn.c,e.rect.width),h=_=jn.b/2),t.moveTo(d,h),t.lineTo(c,_),t.stroke(),t.restore()}}e.notes.forEach((function(e){e.renderInfo||(e.renderInfo={});var a=e.renderInfo.svgNode;e.renderInfo.svgNode=t.save(null,a),a||t.translate(e.rect.left,e.rect.top),o.reset(n,t,i),o.render(e.note_page,!1,r,{}),t.restore(!1,!!a)})),t.restore(!1,!!a)}}]),e}(),Un=n(6115),zn=n(4112),Gn=n(7209),Hn=Object(It.e)(["page-corner","bottom-shapes","headerFooterEditArea","mainpages","footEndNotes","textframes","top-shapes","active-textbox","layout-border"]),Vn=[zn.b,zn.c,zn.d,zn.a],qn=bn.a,Yn=function(e){e.parentNode.removeChild(e)},Xn=function(e){var t=e.renderInfo.renderRect,n=e.rect;return t.width!==n.width||t.height!==n.height},Qn=function(e){function t(e,n,i){a()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,null,n));return r.layout=n,r.data=i,r.typoContext=new me.a,r}return _()(t,e),l()(t,[{key:"render",value:function(){if(this.layout.isVisible){window.APP.data.typoinfo.updater.updateViewport(this.layout.outer_rect),this.typoContext.enter(this.layout);var e=this._render();return this.layout.isUpdate=!1,this.typoContext.exit(),e}}},{key:"_render",value:function(){if(this.layout.inner_rect){var e=qn?performance.now():0;this.layout.renderEmbeds=[],this.layout.decorativePage&&(this.layout.decorativePage.renderEmbeds=[]),(this.ctx=this.canvas.context).resetInsertPos();var t=new In({canvas:this.canvas,layout:this.layout,typoContext:this.typoContext,data:this.data});if(t.renderCorner(),!this.layout.isMoc){this.layout.decorativePage&&this.renderHeaderFooter(t),this.layout.renderInfo||(this.layout.renderInfo={});var n=this.layout.layers,i=n&&n.getTopShapeCards(),r=n&&n.getBottomShapeCards(),o=n&&n.getTextframeCards();this._prepareLayers(n,!1),r&&r.length&&this._renderShapesForSVG(r,!1,"bottom-shapes"),this.renderMainPage(),o&&o.length&&this._renderTextFramesForSVG(o,!1),i&&i.length&&this._renderShapesForSVG(i,!1,"top-shapes");var a=this._calaLayoutBorder();a&&this._renderLayoutBorder(a),this.data.selection.selContext.shapeIdxPathOfTextbox&&this._renderActiveTextboxShapeForSVG();var s=this.layout.renderEmbeds.length;if(this.layout.renderEmbeds.length||this.layout.decorativePage&&this.layout.decorativePage.renderEmbeds.length){this._renderEmbedsForSVG();var l=this.layout.renderEmbeds.length;(l+=this.layout.decorativePage?this.layout.decorativePage.renderEmbeds.length:0)>s&&this._renderEmbedsForSVG()}if(this.layout.renderEmbeds.length=0,this.layout.decorativePage&&this.layout.decorativePage.renderEmbeds&&(this.layout.decorativePage.renderEmbeds.length=0),this.data.selection.selContext.shapeIdxPathOfTextbox&&this._renderActiveTextboxShapeForSVG(),this.layout.renderEmbeds.length||this.layout.decorativePage&&this.layout.decorativePage.renderEmbeds.length){this._renderEmbedsForSVG();var d=this.layout.renderEmbeds.length;(d+=this.layout.decorativePage?this.layout.decorativePage.renderEmbeds.length:0)>s&&this._renderEmbedsForSVG()}delete n.renderInfo.removed,this.renderWatermark(),Object(Bn.renderCustomMark)({layoutPage:this.layout,ctx:this.canvas.customMarkCtx}),this.renderUILControl(),this.renderUILCatalog()}this.layout.svgNode=this.canvas.rootSvg,delete this.layout.renderInfo.expired,delete this.layout.renderInfo.removed,qn&&Object(bn.b)("DOCLayoutpageRender","page top"+this.layout.outer_rect.top,e)}}},{key:"renderHeaderFooter",value:function(e){this.layout.decorativePage.renderInfo||(this.layout.decorativePage.renderInfo={});var t=this.layout.decorativePage.layers,n=t&&t.getTopShapeCards(),i=t&&t.getBottomShapeCards(),r=t&&t.getTextframeCards();this._prepareLayers(t,!0),i&&i.length&&this._renderShapesForSVG(i,!0,"bottom-shapes");var o=this.canvas.hfCtx,a=this.layout.decorativePage.renderInfo.layers;a||(this.layout.decorativePage.renderInfo.layers=a=[]);var s="mainpages",l=a[s],d=this.data.selection.selContext.isInHeaderFooter&&!window.APP.isPaginationMode(),h=d&&a.headerFooterEditArea,c=o.createCtxFragment(s,{},l),_=d&&o.createCtxFragment("headerFooterEditArea",{},h);e.renderHeaderFooter(c,_),!h&&d&&(a.headerFooterEditArea=_.currentNode,o.commitVaildNodesToCurrentChild(_,!1,Object(It.d)("headerFooterEditArea",o.currentNode,Hn).index)),l||(a[s]=c.currentNode,o.commitVaildNodesToCurrentChild(c,!1,Object(It.d)(s,o.currentNode,Hn).index)),r&&r.length&&this._renderTextFramesForSVG(r,!0),n&&n.length&&this._renderShapesForSVG(n,!0,"top-shapes"),this.layout.decorativePage.svgNode=this.canvas.rootSvg,delete t.renderInfo.removed}},{key:"renderMainPage",value:function(){this.data.selection.selContext.isInHeaderFooter&&this.ctx.saveAndSetAlpha(.6);var e=new Zt,t=this.layout.renderInfo.removed;t&&t.forEach((function(e){e&&e.svgNode&&Yn(e.svgNode)})),delete this.layout.renderInfo.removed;var n=this.layout.mainpages;if(n){var i=this.canvas.context,o=this.layout.renderInfo.layers;o||(this.layout.renderInfo.layers=o=[]);for(var a=o.mainpages,s=i.createCtxFragment("mainpages",{},a),l=o.footEndNotes,d=i.createCtxFragment("footEndNotes",{},l),h=void 0,c=void 0,_=void 0,u=void 0,p=0;p<n.length;++p,++h){var f=n[p];if(!f.section||0!==p&&f.section===n[p-1].section||(h=0,c=f.section.getColumnsCount(),_=f.section.hasCompartLine()),f&&(f.footnotes&&Wn.render(f.footnotes,d,this.canvas,this.data,this.typoContext,e),f.endnotes&&Wn.render(f.endnotes,d,this.canvas,this.data,this.typoContext,e),f.lines&&!(f.lines.length<=0))){var g=void 0;if(c>1){var v=Object(he.Ti2Px)(f.section.getColumnItem(h).space)/2+1,m=h>0?Object(he.Ti2Px)(f.section.getColumnItem(h-1).space)/2:0;if(g={pageClipRect:{top:0,bottom:Math.min(f.rect.bottom,this.layout.outer_rect.bottom-this.layout.outer_rect.top),left:0===h?0:f.rect.left-m,right:h===c-1?this.layout.outer_rect.width:f.rect.right+v}},"TRANSPOSE"===f.textflow.chardirect&&(g.pageClipRect=null),_&&(g.columnLine={shouldRender:h>0,leftOffset:m}),g.pageClipRect&&f.renderInfo&&f.renderInfo.pageClipRect)(f.renderInfo.pageClipRect.top!=g.pageClipRect.top||f.renderInfo.pageClipRect.bottom!=g.pageClipRect.bottom||f.renderInfo.pageClipRect.left!=g.pageClipRect.left||f.renderInfo.pageClipRect.right!=g.pageClipRect.right)&&(Yn(f.renderInfo.svgNode),f.cleanRenderInfo())}var y=f.section.getLineNumbering();if(y&&0!==y.step)u?p>0&&f.section!==n[p-1].section&&y.restart===bt.c&&(u.count=Math.max(1,y.start+1)):u={count:Math.max(1,y.restart===bt.b?y.start+1:this.calcLineNumberingStart(p,f.section))},g||(g={}),g.lineNumbering=r()({},y),g.lineNumberingCount=u,0===p&&y.restart!==bt.b&&(this.layout.startLineNumbering=u.count),f.section.getColumnsBidi()&&(g.isRTL=!0),c>1&&(g.isMulCol=!0);else u=null,0===p&&delete this.layout.startLineNumbering,g||(g={}),g.cleanLineNumbering=!0;e.reset(this.canvas,s,this.data),e.render(f,!1,this.typoContext,g)}}if(u?this.layout.nextLineNumbering=u.count:delete this.layout.nextLineNumbering,!a){var b=i.commitVaildNodesToCurrentChild(s,!1,Object(It.d)("mainpages",i.currentNode,Hn).index);b&&(o.mainpages=b)}if(!l){var w=i.commitVaildNodesToCurrentChild(d,!1,Object(It.d)("footEndNotes",i.currentNode,Hn).index);o.footEndNotes=w}}this.data.selection.selContext.isInHeaderFooter&&this.ctx.restoreAlpha()}},{key:"calcLineNumberingStart",value:function(e,t){var n=t.getLineNumbering();if(e>0||0===this.layout.layout_index)return n.start+1;var i=this.data.typoinfo.getLayoutPageCache(this.layout.layout_index-1),r=i.mainpages&&i.mainpages[i.mainpages.length-1];return r&&(r.section===t||r.section.getLineNumbering()&&n.restart===bt.a)?(void 0===i.nextLineNumbering&&Mt.updateLineNumbering(this.layout.layout_index-1,this.data.typoinfo),i.nextLineNumbering||n.start+1):n.start+1}},{key:"_renderShapesForSVG",value:function(e,t,n){var i=this,r=this._getSvgShapeRender(),o=function(e){var o=void 0,a=void 0;t?(a=i.canvas.hfCtx,(o=i.layout.decorativePage.renderInfo.layers)||(i.layout.decorativePage.renderInfo.layers=o=[])):(a=i.canvas.context,(o=i.layout.renderInfo.layers)||(i.layout.renderInfo.layers=o=[]));var s=o[n],l=a.createCtxFragment(n,{},s);r.renderShapes(e,l),s||(o[n]=a.commitVaildNodesToCurrentChild(l,!1,Object(It.d)(n,a.currentNode,Hn).index))};if(window.APP.typoMode===tt.TYPO_MODE.MODE_PAGINATION){var a=[],s=[];e.forEach((function(e){e.isInk?a.push(e):s.push(e)})),s.length>0&&o(s);var l=this._getSvgInkRender();l&&a.forEach((function(e){var t=e.isBehindText?i.canvas.context:i.canvas.inkCtx;l.renderInkShape(e,t)}))}else o(e)}},{key:"_renderTextFramesForSVG",value:function(e,t){var n="textframes",i=void 0,r=void 0;t?(r=this.canvas.hfCtx,(i=this.layout.decorativePage.renderInfo.layers)||(this.layout.decorativePage.renderInfo.layers=i=[])):(r=this.canvas.context,(i=this.layout.renderInfo.layers)||(this.layout.renderInfo.layers=i=[]));var o=i[n],a=r.createCtxFragment(n,{},o);this._getSvgShapeRender().renderTextFrames(e,a),o||(i[n]=a.currentNode,r.commitVaildNodesToCurrentChild(a,!1,Object(It.d)(n,r.currentNode,Hn).index))}},{key:"_renderActiveTextboxShapeForSVG",value:function(){var e=this,t=this._getSvgShapeRender(),n="active-textbox",i=void 0,r=void 0,o=void 0,a=void 0;t.renderActiveTextboxShapesForSVG((function(t){return t?(r=e.canvas.hfCtx,(i=e.layout.decorativePage.renderInfo.layers)||(e.layout.decorativePage.renderInfo.layers=i=[])):(r=e.canvas.context,(i=e.layout.renderInfo.layers)||(e.layout.renderInfo.layers=i=[])),o=i[n],{ctx:a=r.createCtxFragment(n,{},o),renderLayers:o}}),(function(){i[n]=a.currentNode,r.commitVaildNodesToCurrentChild(a,!1,Object(It.d)(n,r.currentNode,Hn).index)}))}},{key:"_renderEmbedsForSVG",value:function(){this._getSvgShapeRender().detectAndRenderEmbeds()}},{key:"_getSvgShapeRender",value:function(){this.docShapeRender||(this.docShapeRender=new yn(this.canvas,{data:this.data,typoContext:this.typoContext,layout:this.layout,shapesParent:this.layout}));var e=this.data.selection.selContext.shapeIdxPathOfTextbox;return this.docShapeRender.shapeIdxPathOfTextbox=e,this.docShapeRender}},{key:"_getSvgInkRender",value:function(){return this.docInkRender||(this.docInkRender=new Dn.a(this.canvas.inkCtx)),this.docInkRender}},{key:"renderWatermark",value:function(){var e=window.APP.getWatermark();e&&!this.layout.renderInfo.hasRenderWaterMark&&(new Tn(this.canvas,e).render(),this.layout.renderInfo.hasRenderWaterMark=!0)}},{key:"renderUILControl",value:function(){var e=window.APP.workspace.getFormatContentManager();if(!T.isMobile||!e.isMoving){var t=this.data.selection,n=t.activeCtrls,i=void 0===n?[]:n,r=t.activeDateCtrls,o=On(i,void 0===r?[]:r),a=this.layout.layout_index;new Ln(this.canvas,this.canvas.uilcontrolCtx,{data:this.data,layoutIndex:a}).render(o)}}},{key:"_prepareLayers",value:function(e,t){var n=this;if(e.renderInfo){var i=e.renderInfo.removed;i&&i.forEach((function(e){e&&e.svgNode&&Yn(e.svgNode)})),e.childLayers&&e.childLayers.forEach((function(e){if(n._prepareLayers(e,t),e.parent.layoutType===et.c.Cell){var i=e.parent.parent;if(i.renderInfo&&i.renderInfo.moved){var r=e.topCards,o=e.textframes;r&&r.forEach((function(e){e.renderInfo&&(e.renderInfo.moved=!0)})),o&&o.forEach((function(e){e.renderInfo&&(e.renderInfo.moved=!0)}))}}})),delete e.renderInfo.removed}else e.renderInfo={};var r=[],o=function e(t){if(t.isGroup){var n=!1;return t.childShapes.some((function(t){if(e(t))return n=!0,!0})),n}return t.textbox_page&&t.textbox_page.renderInfo&&t.textbox_page.renderInfo.expired};e.embedShapes&&e.embedShapes.forEach((function(e){if(e.renderInfo)if(Xn(e)){Yn(e.renderInfo.svgNode);var t=e.renderInfo.line,n=t&&t.renderInfo;n&&(n.expired=!0),e.cleanRenderInfo()}else if(e.renderInfo.moved){var i=q.calcShapePos(e,e.renderInfo.line),a=i.x,s=i.y;e.renderInfo.svgNode.setAttribute("transform","translate("+a+", "+s+")"),delete e.renderInfo.moved}else o(e)&&r.push(e)}));var a=this.layout.embed_shape_map;(a&&Object.keys(a).forEach((function(e){var t=a[e];if(t.renderInfo)if(Xn(t)){Yn(t.renderInfo.svgNode);var n=t.renderInfo.line,i=n&&n.renderInfo;i&&(i.expired=!0),t.cleanRenderInfo()}else if(t.renderInfo.moved){var s=q.calcShapePos(t,t.renderInfo.line),l=s.x,d=s.y;t.renderInfo.svgNode.setAttribute("transform","translate("+l+", "+d+")"),delete t.renderInfo.moved}else o(t)&&r.push(t)})),r.length)&&this._getSvgShapeRender().renderEmbedTextBoxs(r,t);var s=window.APP.data.selection.selShapes;if(s&&1===s.length){var l=s[0],d=l.topShape;if(d.renderInfo&&d.renderInfo.needRerender&&l.renderInfo.textboxOuterSvg&&l.hasEnterTextbox()){var h=l.renderInfo.textboxOuterSvg.parentNode;Yn(h),delete l.renderInfo.textboxOuterSvg}}}},{key:"_calaLayoutBorder",value:function(){var e=this.layout.range;if(!e)return null;var t=window.APP.data.doc.sections.getSection(e.pos);if(!t)return null;var n=this.layout.isSecFirstPage,i=t.getBorderApplyTo();if(n&&Un.a.BorderApplyTo_OtherPage===i||!n&&Un.a.BorderApplyTo_FirstPage===i)return null;var r=t.getBorderPageDepth(),o={},a=!1;if(Vn.forEach((function(e){var n=t.getBorder(e);if(n){var i=function(e,t){if(e){var n=void 0,i=void 0,r=void 0,o=void 0;if(e.styleType===Un.c.BorderStyleType_LineStyle)n=e.style,i=Object(he.Ti2Px)(e.lineWidth);else{if(e.styleType!==Un.c.BorderStyleType_LineArtStyle)return null;r=e.artStyle,o=e.artLineWidth}var a=new He.a(e.color);return{lineStyle:n,width:i,color:t?He.a.darkenRGB(a.color):a.color,artLineStyle:r,artLineWidth:o,margin:Object(he.Ti2Px)(e.margin)}}return null}(n,r);i&&(o[e]=i,a=!0)}})),!a)return null;var s=0,l=0,d=0,h=0;if(t.getBorderDistanceFrom()===Un.b.BorderMeasureFrom_PageEdge){var c=this.layout.outer_rect,_=o[zn.b];_&&(_.lineStyle||_.artLineStyle)&&(d+=_.margin||0),h=c.width;var u=o[zn.c];u&&(u.lineStyle||u.artLineStyle)&&(h-=u.margin||0);var p=o[zn.d];p&&(p.lineStyle||p.artLineStyle)&&(s+=p.margin||0),l=c.height;var f=o[zn.a];f&&(f.lineStyle||f.artLineStyle)&&(l-=f.margin||0)}else{var g=this.layout.inner_rect;d=g.left;var v=o[zn.b];v&&(v.lineStyle||v.artLineStyle)&&(d-=v.margin||0),h=g.right;var m=o[zn.c];m&&(m.lineStyle||m.artLineStyle)&&(h+=m.margin||0),s=g.top;var y=o[zn.d];y&&(y.lineStyle||y.artLineStyle)&&(s-=y.margin||0),l=g.bottom;var b=o[zn.a];b&&(b.lineStyle||b.artLineStyle)&&(l+=b.margin||0)}var w=x.a.initByRawRect({left:d,top:s,right:h,bottom:l});return{borderDatas:o,borderRect:w}}},{key:"_renderLayoutBorder",value:function(e){var t=function(e,t,n,i,r){l.markRestore(),l.strokeStyle=n,l.markRestore(),l.lineWidth=i,function(e){l.restoreLineDash();var t=[];switch(e){case Gn.l:case Gn.n:break;case Gn.f:t=[1,1];break;case Gn.e:t=[3,1];break;case Gn.d:t=[4,4];break;case Gn.a:t=[7,3,3,3];break;case Gn.b:t=[6,2,2,2,2,2];break;case Gn.g:case Gn.y:case Gn.u:case Gn.r:case Gn.x:case Gn.t:case Gn.q:case Gn.w:case Gn.s:case Gn.p:case Gn.v:case Gn.o:case Gn.h:case Gn.c:case Gn.i:case Gn.j:case Gn.m:case Gn.k:}if(t.length){var n=Math.round(Math.max(1,void 0!==l.lineWidth?l.lineWidth:0));l.setLineDash(t.map((function(e){return e*n})))}}(r),l.beginPath(),l.moveTo(e.x,e.y),l.lineTo(t.x,t.y),l.stroke(),l.restoreLineWidth(),l.restoreStyle()},n=e.borderDatas,i=e.borderRect;if(n&&i&&0!==i.height&&0!==i.width){var r=this.canvas.context,o=this.layout.renderInfo.layers;o||(this.layout.renderInfo.layers=o=[]);var a="layout-border",s=o[a],l=r.createCtxFragment(a,{},s);if(Vn.forEach((function(e){var r=n[e];if(r&&r.lineStyle){var o=function(e){var t={},n={};if(e===zn.b)t.x=i.left,t.y=i.top,n.x=i.left,n.y=i.bottom;else if(e===zn.c)t.x=i.right,t.y=i.top,n.x=i.right,n.y=i.bottom;else if(e===zn.d)t.x=i.left,t.y=i.top,n.x=i.right,n.y=i.top;else{if(e!==zn.a)return console.log("Border Location Error!"),null;t.x=i.left,t.y=i.bottom,n.x=i.right,n.y=i.bottom}return{begin:t,end:n}}(e);o&&o.begin&&o.end&&(!function(e,t,n){if((n===zn.d||n===zn.a)&&e&&e.begin&&e.end){var i=t[zn.b]&&t[zn.b].width||0,r=t[zn.c]&&t[zn.c].width||0;e.begin.x-=i/2,e.end.x+=r/2}}(o,n,e),t(o.begin,o.end,r.color,r.width,r.lineStyle))}else r&&r.artStyle})),!s){var d=r.commitVaildNodesToCurrentChild(l,!1,Object(It.d)(a,r.currentNode,Hn).index);d&&(o[a]=d)}}}},{key:"renderUILCatalog",value:function(){var e=this.data.selection.activeCatalogs,t=this.layout.layout_index;new Fn(this.canvas,this.canvas.uilcatalogCtx,{data:this.data,layoutIndex:t}).render(e)}}]),t}(p),Zn=function(){function e(t){a()(this,e),this.data=t,this._lineRenderInfosMap=new Map}return l()(e,[{key:"updateActive",value:function(){this.shapeRevisions&&this.shapeRevisions.length&&V.update(this.shapeRevisions,this.data),this.paraRevisions&&this.paraRevisions.length&&ft.updateParaRevision(this.paraRevisions,this.data),this.chpxRevisions&&this.chpxRevisions.length&&ft.updateChpxRevision(this.chpxRevisions,this.data),this.revisionTexts&&this.revisionTexts.length&&ft.updateTextColor(this.revisionTexts,this.data),this.revisionUnderline&&this.revisionUnderline.length&&we.updateRevision(this.revisionUnderline),this.revisionStrikekthroughs&&this.revisionStrikekthroughs.length&&W.updateRevisionStrikethrough(this.revisionStrikekthroughs)}},{key:"clean",value:function(){this.shapeRevisions&&(this.shapeRevisions=null),this.paraRevisions&&(this.paraRevisions=null),this.chpxRevisions&&(this.chpxRevisions=null),this.revisionUnderline&&(this.revisionUnderline=null),this.revisionStrikekthroughs&&(this.revisionStrikekthroughs=null),this.revisionTexts&&(this.revisionTexts=null)}},{key:"onRemoveLineRenderInfos",value:function(e){var t=this;if(e&&0!==e.length){var n=function(e,t){e&&e.length&&e.forEach((function(e){var n=t.indexOf(e);n>=0&&t.splice(n,1)}))};e.forEach((function(e){if(t._lineRenderInfosMap.has(e)){var i=t._lineRenderInfosMap.get(e),r=i.para,o=i.chpx,a=i.underline,s=i.strikethrough,l=i.text;n(r,t.paraRevisions),n(o,t.chpxRevisions),n(a,t.revisionUnderline),n(s,t.revisionStrikekthroughs),n(l,t.revisionTexts),t._lineRenderInfosMap.delete(e)}}))}}},{key:"setShapeRevision",value:function(e,t){this.shapeRevisions||(this.shapeRevisions=[]),this.shapeRevisions.push({shapeInfo:e,svgNode:t})}},{key:"_getMapItem",value:function(e){var t=void 0;return this._lineRenderInfosMap.has(e)?t=this._lineRenderInfosMap.get(e):(t={},this._lineRenderInfosMap.set(e,t)),t}},{key:"setPapxRevision",value:function(e,t,n,i){this.paraRevisions||(this.paraRevisions=[]);var r={linebase:e,activeSvgGroup:t,unActiveSvgGroup:n};this.paraRevisions.push(r);var o=this._getMapItem(i);o.para||(o.para=[]),o.para.push(r)}},{key:"setChpxRevision",value:function(e,t,n,i,r){this.chpxRevisions||(this.chpxRevisions=[]);var o={linebase:e,left:t,top:n,svgNode:i};this.chpxRevisions.push(o);var a=this._getMapItem(r);a.chpx||(a.chpx=[]),a.chpx.push(o)}},{key:"setRevisionUnderline",value:function(e,t,n,i){this.revisionUnderline||(this.revisionUnderline=[]);var r={item:e,normalSvg:t,revisionSvg:n};this.revisionUnderline.push(r);var o=this._getMapItem(i);o.underline||(o.underline=[]),o.underline.push(r)}},{key:"setRevisionStrikethrough",value:function(e,t,n){this.revisionStrikekthroughs||(this.revisionStrikekthroughs=[]);var i={item:e,svgNode:t};this.revisionStrikekthroughs.push(i);var r=this._getMapItem(n);r.strikethrough||(r.strikethrough=[]),r.strikethrough.push(i)}},{key:"setRevisionText",value:function(e,t,n,i,r,o){this.revisionTexts||(this.revisionTexts=[]);var a={textline:e,glyphGroupInfo:t,normalColor:n,revisionColor:i,svgNode:r};this.revisionTexts.push(a);var s=this._getMapItem(o);s.text||(s.text=[]),s.text.push(a)}}]),e}(),Kn=function(){function e(){a()(this,e)}return l()(e,[{key:"onRemoveLineRenderInfos",value:function(e){var t=this;if(e&&e.length&&this.lineRenderInfoMap){var n=!1;this.lineRenderInfoMap.forEach((function(i,r){var o=i.comment,a=i.card,s=i.underline,l=i.commentSelected;e.includes(r)&&(o&&o.length&&o.forEach((function(e){var n=e.commentId,i=e.textpage,r=t.getComment(i,n);r&&t.deleteComment(i,n,r.svgNode)})),a&&a.length&&a.forEach((function(e){var n=e.commentId,i=e.textpage,r=t.getCommentCard(i,n);r&&t.deleteCommentCard(i,n,r.svgNode)})),s&&s.length&&s.forEach((function(e){var n=e.commentId,i=e.textpage,r=t.getCommentUnderline(i,n);r&&t.deleteCommentUnderline(i,n,r.svgNode)})),l&&l.length&&l.forEach((function(e){var n=e.commentId,i=e.textpage,r=t.getCommentSelected(i,n);r&&t.deleteCommentSelected(i,n,r.svgNode)})),n=!0,t.lineRenderInfoMap.delete(r))})),n&&this.lineRenderInfoMap.forEach((function(e,n){var i=e.comment,r=e.card,o=e.underline,a=e.commentSelected;if(i&&i.length)for(var s=i.length-1;s>=0;--s){var l=i[s],d=l.commentId,h=l.textpage;t.getComment(h,d)||i.splice(s,1)}if(r&&r.length)for(var c=r.length-1;c>=0;--c){var _=r[c],u=_.commentId,p=_.textpage;t.getCommentCard(p,u)||r.splice(c,1)}if(o&&o.length)for(var f=o.length-1;f>=0;--f){var g=o[f],v=g.commentId,m=g.textpage;t.getCommentUnderline(m,v)||o.splice(f,1)}if(a&&a.length)for(var y=a.length-1;y>=0;--y){var b=a[y],w=b.commentId,x=b.textpage;t.getCommentSelected(x,w)||a.splice(y,1)}}))}}},{key:"setComment",value:function(e,t,n,i,r){this.comments||(this.comments={}),this.comments[t]||(this.comments[t]=new Map),this.comments[t].set(e,{svgNode:n,color:i}),this._setLineRenderInfos(e,t,r,"comment")}},{key:"setCommentCard",value:function(e,t,n,i,r){this.commentCards||(this.commentCards={}),this.commentCards[t]||(this.commentCards[t]=new Map),this.commentCards[t].set(e,{svgNode:n,color:i}),this._setLineRenderInfos(e,t,r,"card")}},{key:"setCommentUnderline",value:function(e,t,n,i,r){this.commentsUnderline||(this.commentsUnderline={}),this.commentsUnderline[t]||(this.commentsUnderline[t]=new Map),this.commentsUnderline[t].set(e,{svgNode:n,color:i}),this._setLineRenderInfos(e,t,r,"underline")}},{key:"setCommentSelected",value:function(e,t,n,i,r){this.commentSelected||(this.commentSelected={}),this.commentSelected[t]||(this.commentSelected[t]=new Map),this.commentSelected[t].set(e,{svgNode:n,color:i}),this._setLineRenderInfos(e,t,r,"commentSelected")}},{key:"_setLineRenderInfos",value:function(e,t,n,i){var r=this;this.lineRenderInfoMap||(this.lineRenderInfoMap=new Map),n.forEach((function(n){var o=void 0;r.lineRenderInfoMap.has(n)?o=r.lineRenderInfoMap.get(n):(o={},r.lineRenderInfoMap.set(n,o)),o[i]||(o[i]=[]),o[i].push({commentId:t,textpage:e})}))}},{key:"getComment",value:function(e,t){return this.comments&&this.comments[t]?this.comments[t].get(e):null}},{key:"getCommentCard",value:function(e,t){return this.commentCards&&this.commentCards[t]?this.commentCards[t].get(e):null}},{key:"getCommentUnderline",value:function(e,t){return this.commentsUnderline&&this.commentsUnderline[t]?this.commentsUnderline[t].get(e):null}},{key:"getCommentSelected",value:function(e,t){return this.commentSelected&&this.commentSelected[t]?this.commentSelected[t].get(e):null}},{key:"deleteComment",value:function(e,t,n){try{n.parentNode.removeChild(n)}catch(e){}this.comments&&this.comments[t]&&this.comments[t].delete(e)}},{key:"deleteCommentCard",value:function(e,t,n){try{n.parentNode.removeChild(n)}catch(e){}this.commentCards&&this.commentCards[t]&&this.commentCards[t].delete(e)}},{key:"deleteCommentUnderline",value:function(e,t,n){try{n.parentNode.removeChild(n)}catch(e){}this.commentsUnderline&&this.commentsUnderline[t]&&this.commentsUnderline[t].delete(e)}},{key:"deleteCommentSelected",value:function(e,t,n){try{n.parentNode.removeChild(n)}catch(e){}this.commentSelected&&this.commentSelected[t]&&this.commentSelected[t].delete(e)}},{key:"clearComments",value:function(){if(this.comments){var e=this.comments;Object.keys(e).forEach((function(t){e[t].forEach((function(e){var t=e.svgNode;t.parentNode.removeChild(t)}))}))}if(this.comments=null,this.commentCards){var t=this.commentCards;Object.keys(t).forEach((function(e){t[e].forEach((function(e){var t=e.svgNode;t.parentNode&&t.parentNode.removeChild(t)}))}))}this.commentCards=null}},{key:"clearCommentsUnderline",value:function(){if(this.commentsUnderline){var e=this.commentsUnderline;Object.keys(e).forEach((function(t){e[t].forEach((function(e){var t=e.svgNode;t.parentNode&&t.parentNode.removeChild(t)}))}))}if(this.commentsUnderline=null,this.commentSelected){var t=this.commentSelected;Object.keys(t).forEach((function(e){t[e].forEach((function(e){var t=e.svgNode;t.parentNode&&t.parentNode.removeChild(t)}))}))}this.commentSelected=null}}]),e}(),Jn=function(){function e(){a()(this,e),this.spellCheckMark2TextPages=new Map,this.spellCheck={},this._handleRemoveWrongRanges=this._handleRemoveWrongRanges.bind(this),this._handleRemoveProgressRanges=this._handleRemoveProgressRanges.bind(this),this._handleSpellCheckClose=this._handleSpellCheckClose.bind(this),this._bindEvents()}return l()(e,[{key:"_bindEvents",value:function(){window.addEventListener(mt.default.spellCheck.REMOVE_WRONG_RANGES,this._handleRemoveWrongRanges),window.addEventListener(mt.default.spellCheck.BEFORE_REMOVE_PROGRESS_RANGES,this._handleRemoveProgressRanges),window.addEventListener(mt.default.spellCheck.CLOSE,this._handleSpellCheckClose)}},{key:"_unBindEvents",value:function(){window.removeEventListener(mt.default.spellCheck.REMOVE_WRONG_RANGES,this._handleRemoveWrongRanges),window.removeEventListener(mt.default.spellCheck.BEFORE_REMOVE_PROGRESS_RANGES,this._handleRemoveProgressRanges),window.removeEventListener(mt.default.spellCheck.CLOSE,this._handleSpellCheckClose)}},{key:"unLoadResouce",value:function(){this._unBindEvents(),this.clear()}},{key:"_handleRemoveMarkRangesCommon",value:function(e){var t=this,n=e.detail,i=this.spellCheckMark2TextPages.get(n);i&&(i.forEach((function(e){t.deleteSpellCheckSvgNodes(e,n)})),i.length<=0&&this.spellCheckMark2TextPages.delete(n))}},{key:"_handleRemoveWrongRanges",value:function(e){return this._handleRemoveMarkRangesCommon(e)}},{key:"_handleRemoveProgressRanges",value:function(e){return this._handleRemoveMarkRangesCommon(e)}},{key:"_handleSpellCheckClose",value:function(){this.clear()}},{key:"onRemoveLineRenderInfos",value:function(e){var t=this;if(e&&e.length&&this.lineRenderInfoMap){var n=!1;this.lineRenderInfoMap.forEach((function(i,r){e.includes(r)&&(i&&i.length&&i.forEach((function(e){var n=e.spellMark,i=e.textpage;t.deleteSpellCheckSvgNodes(i,n)})),t.lineRenderInfoMap.delete(r),n=!0)})),n&&this.lineRenderInfoMap.forEach((function(e,n){if(e&&e.length)for(var i=e.length-1;i>=0;--i){var r=e[i],o=r.spellMark,a=r.textpage;t.loadSpellCheckSvgNodes(a,o)||e.splice(i,1)}}))}}},{key:"storeSpellCheckSvgNodes",value:function(e,t,n,i){var r=this;this.spellCheck[e]||(this.spellCheck[e]=new Map),this.spellCheck[e].set(t,n);var o=this.spellCheckMark2TextPages.get(t);o||(o=[],this.spellCheckMark2TextPages.set(t,o)),o.push(e),this.lineRenderInfoMap||(this.lineRenderInfoMap=new Map),i.forEach((function(n){var i=void 0;r.lineRenderInfoMap.has(n)?i=r.lineRenderInfoMap.get(n):(i=[],r.lineRenderInfoMap.set(n,i)),i.push({spellMark:t,textpage:e})}))}},{key:"loadSpellCheckSvgNodes",value:function(e,t){if(this.spellCheck[e])return this.spellCheck[e].get(t)}},{key:"checkSvgNodesExist",value:function(e,t){return!!this.spellCheck[e]&&this.spellCheck[e].has(t)}},{key:"deleteSpellCheckSvgNodes",value:function(e,t){var n=this.loadSpellCheckSvgNodes(e,t);if(n){n.forEach((function(e){e.parentNode.removeChild(e)})),this.spellCheck[e].delete(t);var i=this.spellCheckMark2TextPages.get(t),r=-1;i.some((function(t,n){return r=n,t===e}))&&i.splice(r,1)}}},{key:"clear",value:function(){var e=this;Object.keys(this.spellCheck).forEach((function(t){for(var n=e.spellCheck[t].values(),i=n.next();!i.done;){i.value.forEach((function(e){e.parentNode.removeChild(e)})),i=n.next()}e.spellCheck[t].clear()})),this.spellCheckMark2TextPages.clear()}}]),e}(),$n=function(e,t,n){var i=P.b,r=P.a,o=void 0;switch(e){case i:t.taskListTodoUseId||(t.taskListTodoUseId="taskListTodo",n.addDefString(k.a.todoImageSvgContent)),o=t.taskListTodoUseId;break;case r:t.taskListDoneUseId||(t.taskListDoneUseId="taskListDone",n.addDefString(k.a.doneImageSvgContent)),o=t.taskListDoneUseId}return o},ei=function(e,t,n){var i=Fe.b,r=Fe.f,o=Fe.e,a=Fe.g,s=Fe.d,l=Fe.a,d=Fe.c,h=void 0,c=void 0;switch(e){case i:h=C.svgInfo.circleBulletSvgContent,c=C.circleBulletSvgContent;break;case r:h=C.svgInfo.squareBulletSvgContent,c=C.squareBulletSvgContent;break;case o:h=C.svgInfo.rhombusBulletSvgContent,c=C.rhombusBulletSvgContent;break;case a:h=C.svgInfo.xrhombusBulletSvgContent,c=C.xrhombusBulletSvgContent;break;case s:h=C.svgInfo.head2RightBulletSvgContent,c=C.head2RightBulletSvgContent;break;case l:h=C.svgInfo.checkbldBulletSvgContent,c=C.checkbldBulletSvgContent;break;case d:h=C.svgInfo.cuspopenBulletSvgContent,c=C.cuspopenBulletSvgContent}return h&&!t[h]&&(t[h]=h,n.addDefString(c)),h},ti={wps:"wpsCloudFileImage",et:"etCloudFileImage",ksheet:"ksheetCloudFileImage",wpp:"wppCloudFileImage",pdf:"pdfCloudFileImage",otl:"otlCloudFileImage",dbt:"dbtCloudFileImage",kw:"kwCloudFileImage",pof:"pofCloudFileImage",pom:"pomCloudFileImage",img:"imgCloudFileImage"},ni={wps:{content:'<svg id="'+ti.wps+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>16px</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-1">\n                <stop stop-color="#699EF4" offset="0%"></stop>\n                <stop stop-color="#0C73F2" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="16px" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="wps" fill="url(#linearGradient-1)">\n                <rect id="Rectangle-19-wps-Backups" x="0" y="0" width="16" height="16" rx="1"></rect>\n            </g>\n            <path d="M4,4 L4,10.666 L7.55281068,7.63864516 C7.78179264,7.44944229 8.10126619,7.42755791 8.35123064,7.57346101 L8.44139657,7.63604062 L12.01,10.674 L12.0104818,4 L13.0104818,4 L13.0104818,11.30701 C13.0104818,11.4683518 12.9547477,11.6247404 12.8527088,11.7497174 C12.6304356,12.0219571 12.2457907,12.0835297 11.9527008,11.9087779 L11.8677744,11.849237 L7.99862507,8.56562419 L4.14587844,11.8434228 C4.04550813,11.9263567 3.92452867,11.979238 3.79682325,11.9970732 L3.7,12.0038004 C3.34561729,12.0038004 3.05274177,11.7404567 3.00639017,11.3987862 L3,11.3038004 L3,4 L4,4 Z" id="Route-wps-15" fill="#FFFFFF" fill-rule="nonzero"></path>\n        </g>\n    </svg>',id:ti.wps},et:{content:'<svg id="'+ti.et+'" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><linearGradient id="linearGradient-2" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0" stop-color="#22ca87"/><stop offset="1" stop-color="#09b36f"/></linearGradient><g fill="none" fill-rule="evenodd"><rect fill="url(#linearGradient-2)" height="16" rx="1" width="16"/><path d="m5.75 3.5c1.24264069 0 2.25 1.00735931 2.25 2.25s-1.00735931 2.25-2.25 2.25h-5.75v-1h5.75c.69035594 0 1.25-.55964406 1.25-1.25s-.55964406-1.25-1.25-1.25h-3.5c-1.24264069 0-2.25-1.00735931-2.25-2.25s1.00735931-2.25 2.25-2.25h5.75v1h-5.75c-.69035594 0-1.25.55964406-1.25 1.25 0 .64720869.49187466 1.1795339 1.12219476 1.24354639l.12780524.00645361z" fill="#fff" fill-rule="nonzero" transform="translate(4 4)"/></g></svg>',id:ti.et},ksheet:{content:'<svg id="'+ti.ksheet+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>et</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-3">\n                <stop stop-color="#22CA87" offset="0%"></stop>\n                <stop stop-color="#09B36F" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="et" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19-backups" fill="url(#linearGradient-3)"></path>\n            <polygon id="Rectangle-ksheet" fill="#FFFFFF" points="4 4 6.5 4 6.5 6.5 4 6.5"></polygon>\n            <polygon id="Rectangle-ksheet-Backups-3" fill-opacity="0.75" fill="#FFFFFF" points="4 8 6.5 8 6.5 12 4 12"></polygon>\n            <polygon id="Rectangle-ksheet-Backups-6" fill-opacity="0.6" fill="#FFFFFF" points="8 8 12 8 12 12 8 12"></polygon>\n            <polygon id="Rectangle-ksheet-Backups" fill-opacity="0.9" fill="#FFFFFF" points="8 4 12 4 12 6.5 8 6.5"></polygon>\n        </g>\n    </svg>',id:ti.ksheet},wpp:{content:'<svg id="'+ti.wpp+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>ppt</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-4">\n                <stop stop-color="#F5926A" offset="0%"></stop>\n                <stop stop-color="#F06B42" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="ppt" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19-Backups" fill="url(#linearGradient-4)"></path>\n            <path d="M12.5,8 C12.5,10.4852814 10.4852814,12.5 8,12.5 C5.51471863,12.5 3.5,10.4852814 3.5,8 C3.5,5.51471863 5.51471863,3.5 8,3.5 L8,3.5 L8,8 Z" id="Shape-combination-wpp" fill="#FFFFFF"></path>\n            <path d="M9.00008516,3.0274738 C11.0857453,3.25807194 12.7417928,4.91404853 12.9724998,6.9996759 L9,7 Z" id="Shape-combination-wpp" fill-opacity="0.6" fill="#FFFFFF"></path>\n        </g>\n    </svg>',id:ti.wpp},pdf:{content:'<svg id="'+ti.pdf+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>pdf</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-5">\n                <stop stop-color="#EC6E6C" offset="0%"></stop>\n                <stop stop-color="#E13F3B" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="pdf" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19" fill="url(#linearGradient-5)"></path>\n            <g id="Marshalling-pdf" transform="translate(3.500000, 4.000000)" fill="#FFFFFF">\n                <path d="M3.5,0 L6,0 C7.65685425,-3.04359188e-16 9,1.34314575 9,3 C9,4.65685425 7.65685425,6 6,6 L3.5,6 L3.5,6 L3.5,0 Z" id="Shape-combination-pdf"></path>\n                <path d="M4.5,7 L4.5,9 L2,9 C0.8954305,9 1.3527075e-16,8.1045695 0,7 C-1.3527075e-16,5.8954305 0.8954305,5 2,5 L2.5,5 L2.5,7 L4.5,7 Z" id="Shape-combination-pdf" fill-opacity="0.6"></path>\n            </g>\n        </g>\n    </svg>',id:ti.pdf},otl:{content:'<svg id="'+ti.otl+'" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><linearGradient id="linearGradient-6" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0" stop-color="#9d84e8"/><stop offset="1" stop-color="#7663dd"/></linearGradient><g fill="none" fill-rule="evenodd"><path d="m1 0h14c.5522847 0 1 .44771525 1 1v14c0 .5522847-.4477153 1-1 1h-14c-.55228475 0-1-.4477153-1-1v-14c0-.55228475.44771525-1 1-1z" fill="url(#linearGradient-6)"/><g fill="#fff"><path d="m4 4h8v1.5h-8z"/><path d="m4 7h8v1.5h-8z" fill-opacity=".85"/><path d="m4 10h5v1.5h-5z" fill-opacity=".7"/></g></g></svg>',id:ti.otl},dbt:{content:'<svg id="'+ti.dbt+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>dbt</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-7">\n                <stop stop-color="#1CCCC7" offset="0%"></stop>\n                <stop stop-color="#00BBBB" offset="100%"></stop>\n            </linearGradient>\n            <path d="M0.525627633,0.300132835 L6.52760009,3.7272529 C6.81970558,3.89404483 7,4.20460864 7,4.54097922 L7,11.3947198 C7,11.5887865 6.84267788,11.7461086 6.6486112,11.7461086 C6.58749867,11.7461086 6.52744272,11.7301703 6.47437237,11.6998672 L0.472399912,8.2727471 C0.180294423,8.10595517 -1.8085109e-16,7.79539136 0,7.45902078 L0,0.605280205 C-2.45810918e-16,0.41121353 0.157322124,0.253891405 0.3513888,0.253891405 C0.412501331,0.253891405 0.472557279,0.269829717 0.525627633,0.300132835 Z" id="path-2"></path>\n            <filter x="-21.4%" y="-10.1%" width="142.9%" height="120.2%" filterUnits="objectBoundingBox" id="filter-4">\n                <feGaussianBlur stdDeviation="0.5" in="SourceGraphic"></feGaussianBlur>\n            </filter>\n        </defs>\n        <g id="DBSheet" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g>\n                <rect id="Rectangle-19" fill="url(#linearGradient-7)" x="0" y="0" width="16" height="16" rx="1"></rect>\n                <g id="Marshalling-dbt-4" transform="translate(4.000000, 1.500000)">\n                    <g id="Marshalling-dbt" opacity="0.741375151" transform="translate(2.000000, 0.000000)">\n                        <mask id="mask-3" fill="white">\n                            <use xlink:href="#path-2"></use>\n                        </mask>\n                        <use id="Rectangle-backups-dbt" fill="#91F4F3" xlink:href="#path-2"></use>\n                        <path d="M-0.609179573,0.223158059 L5.80242527,3.88417779 C5.92459435,3.95393621 6,4.08382523 6,4.22450757 L6,12.5499554 C6,12.69425 5.88302613,12.8112239 5.73873154,12.8112239 C5.69329248,12.8112239 5.64863903,12.7993732 5.60917957,12.7768419 L-0.802425268,9.11582221 C-0.92459435,9.04606379 -1,8.91617477 -1,8.77549243 L-1,0.450044582 C-1,0.305749997 -0.883026127,0.188776124 -0.738731543,0.188776124 C-0.693292483,0.188776124 -0.648639026,0.200626753 -0.609179573,0.223158059 Z" id="Rectangle-backups-dbt" fill="#0CCFCC" opacity="0.185362316" style="mix-blend-mode: multiply;" filter="url(#filter-4)" mask="url(#mask-3)"></path>\n                    </g>\n                    <g id="Marshalling-dbt-3" transform="translate(0.000000, 1.000000)" fill="#FFFFFF">\n                        <path d="M0.52590186,0.300916605 L6.52833136,3.7354561 C6.82002546,3.902361 7,4.21269495 7,4.54876443 L7,11.3940928 C7,11.5881594 6.84267788,11.7454816 6.6486112,11.7454816 C6.58739159,11.7454816 6.52723418,11.7294874 6.47409814,11.6990834 L0.471668639,8.2645439 C0.179974541,8.097639 -5.13954872e-16,7.78730505 0,7.45123557 L0,0.605907229 C6.24166033e-17,0.411840554 0.157322124,0.254518429 0.3513888,0.254518429 C0.412608414,0.254518429 0.472765824,0.270512614 0.52590186,0.300916605 Z" id="Rectangle-dbt"></path>\n                    </g>\n                    <path d="M5.1171296,8.07055759 C5.14013589,8.07055759 5.16263277,8.07733279 5.18181283,8.0900377 L5.5,8.30080558 C5.81224068,8.50763449 6,8.85722212 6,9.23175175 L6,10.2819173 C6,10.3466062 5.94755929,10.3990469 5.8828704,10.3990469 C5.85986411,10.3990469 5.83736723,10.3922717 5.81818717,10.3795668 L5.10489273,9.90707899 C5.03938918,9.8636893 5,9.79035089 5,9.71178002 L5,8.18768719 C5,8.1229983 5.05244071,8.07055759 5.1171296,8.07055759 Z M3.1171296,6.1734086 C3.13799086,6.1734086 3.15847359,6.1789801 3.1764605,6.18954717 L3.5,6.37962238 C3.80976181,6.56160337 4,6.89400445 4,7.25326684 L4,9.09534075 C4,9.16002964 3.94755929,9.21247035 3.8828704,9.21247035 C3.86200914,9.21247035 3.84152641,9.20689885 3.8235395,9.19633177 L3.1155974,8.78042509 C3.04398208,8.73835203 3,8.66150263 3,8.57844304 L3,6.2905382 C3,6.22584931 3.05244071,6.1734086 3.1171296,6.1734086 Z M1.1171296,4.11564122 C1.13970785,4.11564122 1.16180492,4.12216686 1.18076088,4.13443261 L1.5,4.3410013 C1.81175911,4.54272994 2,4.88874591 2,5.26007889 L2,8.14045562 C2,8.20514451 1.94755929,8.25758522 1.8828704,8.25758522 C1.86184111,8.25758522 1.84119967,8.25192366 1.82311308,8.24119491 L1.5,8.04952818 C1.19003805,7.86566253 1,7.531977 1,7.17158417 L1,4.23277082 C1,4.16808193 1.05244071,4.11564122 1.1171296,4.11564122 Z" id="Shape-combination-dbt" fill="#41CFCE"></path>\n                </g>\n            </g>\n        </g>\n    </svg>',id:ti.dbt},kw:{content:'<svg id="'+ti.kw+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>kw</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-8">\n                <stop stop-color="#606A83" offset="0%"></stop>\n                <stop stop-color="#404A63" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="kw" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19" fill="url(#linearGradient-8)"></path>\n            <g id="Marshalling-kw" transform="translate(7.548271, 8.465238) rotate(45.000000) translate(-7.548271, -8.465238) translate(4.548271, 3.465238)">\n                <path d="M6,7 L3,10 L5.05373521e-13,7 L6,7 Z" id="Shape-combination-kw" fill="#DADCE3"></path>\n                <rect id="Rectangle-kw" fill="#D8D8D8" x="0" y="0" width="6" height="6"></rect>\n                <rect id="Rectangle-kw" fill="#FFFFFF" x="0" y="0" width="2" height="6"></rect>\n                <rect id="Rectangle-kw-backups" fill="#B5B9C4" x="4" y="9.68114477e-14" width="2" height="6"></rect>\n                <rect id="Rectangle-kw-backups-2" fill="#DADCE3" x="2" y="2.91322522e-13" width="2" height="6"></rect>\n            </g>\n        </g>\n    </svg>',id:ti.kw},pof:{content:'<svg id="'+ti.pof+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>pof</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-9">\n                <stop stop-color="#1CCCC7" offset="0%"></stop>\n                <stop stop-color="#00BBBB" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="pof" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19" fill="url(#linearGradient-9)"></path>\n            <polygon id="Rectangle-pof" fill="#FFFFFF" points="3 6 8 6 8 10 3 10"></polygon>\n            <polygon id="Shape-combination-pof" fill-opacity="0.6" fill="#FFFFFF" points="7.91304348 4 13 4 13 7 6 7"></polygon>\n            <polygon id="Shape-combination-pof-backups" fill-opacity="0.6" fill="#FFFFFF" transform="translate(9.500000, 10.500000) scale(-1, 1) rotate(-180.000000) translate(-9.500000, -10.500000) " points="7.91304348 9 13 9 13 12 6 12"></polygon>\n        </g>\n    </svg>',id:ti.pof},pom:{content:'<svg id="'+ti.pom+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>pom</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-10">\n                <stop stop-color="#0FB9F5" offset="0%"></stop>\n                <stop stop-color="#15AEF7" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="pom" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-19" fill="url(#linearGradient-10)"></path>\n            <g id="Marshalling-pom" transform="translate(3.035515, 2.502537)" fill="#FFFFFF">\n                <polygon id="Shape-combination-pom" fill-opacity="0.5" points="3.70479311 7.49746298 8.35394389 7.49746298 9.96448509 8.99746298 8.35394389 10.497463 2.96448509 10.497463"></polygon>\n                <path d="M4.46448509,0 L8.96448509,4.49746298 L2.96448509,10.497463 L1.63658987,9.16771291 L3.10959562,7.64201409 L0,4.49746298 L4.46448509,0 Z M4.47,2.833 L2.815,4.5 L4.465,6.168 L6.135,4.498 L4.47,2.833 Z" id="Route-pom" fill-rule="nonzero"></path>\n            </g>\n        </g>\n    </svg>',id:ti.pom},img:{content:'<svg id="'+ti.img+'" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>img</title>\n        <defs>\n            <linearGradient x1="0%" y1="0%" x2="100%" y2="100%" id="linearGradient-11">\n                <stop stop-color="#9D84E8" offset="0%"></stop>\n                <stop stop-color="#7663DD" offset="100%"></stop>\n            </linearGradient>\n        </defs>\n        <g id="img" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <path d="M2,0 L14,0 C15.1045695,0 16,0.8954305 16,2 L16,14 C16,15.1045695 15.1045695,16 14,16 L2,16 C0.8954305,16 0,15.1045695 0,14 L0,2 C0,0.8954305 0.8954305,0 2,0 Z" id="Rectangle-3" fill="url(#linearGradient-11)"></path>\n            <g id="Marshalling-img" transform="translate(3.000000, 6.000000)" fill="#FFFFFF">\n                <path d="M3.42874646,1.71457744 L6,6 L6,6 L0.883095189,6 C0.606952815,6 0.383095189,5.77614237 0.383095189,5.5 C0.383095189,5.40937803 0.407724106,5.32045982 0.454348727,5.24275212 L2.57125354,1.71457744 C2.71332762,1.47778731 3.02045774,1.40100477 3.25724788,1.54307885 C3.32762268,1.58530373 3.38652158,1.64420264 3.42874646,1.71457744 Z" id="Triangle-img" fill-opacity="0.601316652"></path>\n                <path d="M6.41602515,0.624037721 L9.4817666,5.2226499 C9.63494283,5.45241425 9.5728559,5.76284892 9.34309155,5.91602515 C9.26095779,5.97078099 9.16445395,6 9.06574145,6 L2,6 L2,6 L5.58397485,0.624037721 C5.73715108,0.394273376 6.04758575,0.332186442 6.2773501,0.485362672 C6.33227624,0.521980101 6.37940772,0.569111577 6.41602515,0.624037721 Z" id="Triangle-backups-img"></path>\n            </g>\n            <circle id="Ellipse-img" fill="#FFFFFF" cx="6" cy="5" r="1"></circle>\n        </g>\n    </svg>',id:ti.img}},ii=function(e,t,n){if(ni[e]){var i=ni[e],r=i.id,o=i.content;return t[r]||(t[r]=r,n.addDefString(o)),r}return null},ri=function(e,t){if(!e.__spellcheckPattern){e.__spellcheckPattern={pattern:t.createPathPattern(5,5,"M 0 2.05 C 0.882 0, 1.617 0, 2.5 2.0588 \nS 4.117 4.117, 5.059 1.912","transparent",ne.w.naked_color.color),renderHeight:4.117},t.addDefNode(e.__spellcheckPattern.pattern)}return e.__spellcheckPattern},oi=n(7216);var ai=function(e,t,n){var i,r;if(t.__watermarkPattern&&(i=t.__watermarkPattern.info,r=e,!i&&r||Object.keys(r).some((function(e){return r[e]!==i[e]})))&&(n.__defs.removeChild(t.__watermarkPattern.pattern),t.__watermarkPattern=null),!t.__watermarkPattern){var o=Object(oi.a)(e);n.__defs.appendChild(o.patternElement),t.__watermarkPattern={info:e,pattern:o.patternElement,patternId:o.patternId}}return t.__watermarkPattern},si=vt.activeRect,li=vt.unactiveRect,di=vt.activeBracket,hi=vt.unactiveBracket,ci=function(){function e(){a()(this,e),this._rects={},this._bracket={},this._lineRenderInfosMap=new Map}return l()(e,[{key:"addRect",value:function(e,t,n){var i=this._rects[e];i?i.push(t):this._rects[e]=[t],this._lineRenderInfosMap.has(n)?this._lineRenderInfosMap.get(n).rect.push({name:e,node:t}):this._lineRenderInfosMap.set(n,{rect:[{name:e,node:t}],bracket:[]})}},{key:"addBracket",value:function(e,t,n){var i=this._bracket[e];i?i.push(t):this._bracket[e]=[t],this._lineRenderInfosMap.has(n)?this._lineRenderInfosMap.get(n).bracket.push({name:e,node:t}):this._lineRenderInfosMap.set(n,{rect:[],bracket:[{name:e,node:t}]})}},{key:"onRemoveLineRenderInfos",value:function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){if(t._lineRenderInfosMap.has(e)){var n=t._lineRenderInfosMap.get(e),i=n.bracket,r=n.rect;i.forEach((function(e){var n=e.name,i=e.node,r=t._bracket[n],o=r.indexOf(i);o>=0&&(r.splice(o,1),0===r.length&&delete t._bracket[n])})),r.forEach((function(e){var n=e.name,i=e.node,r=t._rects[n],o=r.indexOf(i);o>=0&&(r.splice(o,1),0===r.length&&delete t._rects[n])})),t._lineRenderInfosMap.delete(e)}}))}},{key:"updateActive",value:function(){var e=this._rects,t=this._bracket,n=window.APP.data.selection.selContext.activeDocumentFieldNames,i=n&&n[0];Object.keys(e).forEach((function(t){t!=i&&e[t].forEach((function(e){li(e)}))})),Object.keys(t).forEach((function(e){e!=i&&t[e].forEach((function(e){hi(e)}))})),i&&e[i]&&e[i].forEach((function(e){si(e)})),i&&t[i]&&t[i].forEach((function(e){di(e)}))}}]),e}(),_i=n(3284),ui=n(4103),pi=n(676),fi=n(1699),gi=n(805),vi="header-footer",mi="main",yi="custom-mark",bi="uilcontrol",wi="uilcatalog",xi="wmk",ki="ink",Ci=function(){function e(t){var n=t.workspace,i=t.container,r=t.layout,o=t.data,s=t.isForce;a()(this,e),this.shapeManager=ui.a.getInstance(),this.layout_index=r.layout_index,this.container=i,this.workspace=n,this.data=o,this.rect={},this.create(),this.refreshCvs(s)}return l()(e,[{key:"create",value:function(){this.canvas_unit=Object(pi.createElement)({type:"div",classname:"canvas-unit",style:"position: absolute;                     background: #ffffff;\n                    box-shadow: "+(window.APP.isPaginationMode()?"0px 2px 3px 0px rgba(158, 161, 165, 0.4)":"0px 1px 4px rgba(13, 13, 13, 0.14)")}),this.rootSvg=new _i.a({ctx:Object(fi.getMeasureCTX)()});var e=Object(pi.createElement)({type:"div",classname:"wps-custom-shadow-root"}),t=Object(gi.addShadowRoot)(e);(t||this.canvas_unit).appendChild(this.rootSvg.getSvg()),t&&this.canvas_unit.appendChild(e),T.isMobile&&(this.page_number=Object(pi.createElement)({type:"div",classname:"page-num",text:this.index+1}),this.canvas_unit.appendChild(this.page_number)),this.container.appendChild(this.canvas_unit)}},{key:"reSize",value:function(e){var t=e.x,n=e.y,i=e.width,r=e.height;if(t!==this.rect.x||n!==this.rect.y||i!==this.rect.width||r!==this.rect.height){this.rootSvg.reSize({width:i,height:r});var o=this.rootSvg.getLayoutSize();if(Object.assign(this.canvas_unit.style,{left:Math.round(t)+"px",top:Math.round(n)+"px",width:o.width+2+"px",height:o.height+2+"px"}),Object.assign(this.rect,{width:o.width,height:o.height,left:t,top:n,x:t,y:n,right:t+o.width,bottom:n+o.height}),this.page_number){var a=this.page_number.classList.contains("page-number-hidden");o.width>0&&o.height>0?a&&this.page_number.classList.remove("page-number-hidden"):a||this.page_number.classList.add("page-number-hidden")}}}},{key:"initCTXFragment",value:function(){var e=this,t=this.rootSvg.__closestGroupOrSvg(),n=function(n){return e.rootSvg.saveAndRestore(n,Object(Ze.findSvgNode)(n,t)).ctx};this.hfCtx=n(vi),this.context=n(mi),this.customMarkCtx=n(yi),this.uilcontrolCtx=n(bi),this.uilcatalogCtx=n(wi),this.watermarkCtx=n(xi),this.inkCtx=n(ki)}},{key:"onError",value:function(){}},{key:"bindLayoutPage",value:function(e){var t=!1,n=this.workspace.canvasHandler.layoutPage2Canvas;this.lastRenderLayoutPage&&e!==this.lastRenderLayoutPage&&(n.get(this.lastRenderLayoutPage)==this?this.lastRenderLayoutPage.cleanRenderInfo():n.delete(this.lastRenderLayoutPage),this.lastRenderLayoutPage=null,t=!0);return e&&n.set(e,this),this.lastRenderLayoutPage=e,t}},{key:"reuse",value:function(e,t){this.canvas_unit.classList.contains("doc-pending-canvas-unit")&&this.canvas_unit.classList.remove("doc-pending-canvas-unit"),this.layout_index=e.layout_index,this.refreshCvs(t)}},{key:"pend",value:function(){this.layout_index=-1,this.canvas_unit.classList.contains("doc-pending-canvas-unit")||this.canvas_unit.classList.add("doc-pending-canvas-unit"),this.bindLayoutPage(null),this.clean()}},{key:"refreshCvs",value:function(e,t){if(this.index<0)return this.clean(),void(this.lastRenderLayoutPage&&(this.lastRenderLayoutPage.cleanRenderInfo(),this.lastRenderLayoutPage=null));var n=this.vpsc_outer_rect;if(this.workspace.config.zoom<1){var i=this.container.clientWidth;n.left=(i-n.width)/2}if(this.reSize({x:n.left,y:n.origin.y,width:this.outerRect.size.width,height:this.outerRect.size.height}),t)this._renderSelectionCanvasAndUI();else{var r=this.bindLayoutPage(this.layoutPage);(e||r)&&(this.layoutPage&&this.layoutPage.cleanRenderInfo(),this.clean()),this._render(e)}}},{key:"getBoundRect",value:function(){return this.rect}},{key:"_render",value:function(e){this.initCTXFragment(),this._renderLayoutPage(),this._renderPageNum()}},{key:"_renderPageNum",value:function(){this.page_number&&(this.page_number.textContent=this.index+1)}},{key:"_renderLayoutPage",value:function(){var e=this.layoutPage;e&&!e.isMoc&&(this.data.typoinfo.composeProcessLayout(e),new Qn(this,e,this.data).render());if(this.isInHeaderFooter=this.data.selection.selContext.isInHeaderFooter,this.shapeIdxPathOfTextbox=this.data.selection.selContext.shapeIdxPathOfTextbox,this.shapeIdxPathOfTextbox){var t=this.data.selection.selShapes[0].rect,n=t.left,i=t.top,r=t.right,o=t.bottom;this.shapeRectForTextBox={left:n,top:i,right:r,bottom:o}}else this.shapeRectForTextBox=null;this.isCooperationMode=window.APP.isCooperationMode,this.isReadOnly=window.APP.isReadOnly()}},{key:"_renderSelectionCanvasAndUI",value:function(){var e=this.layoutPage;if(e){this._cleanUilcontrolCtx(!1),this._cleanUilcatalogCtx(!1);var t=new Qn(this,e,this.data);Object(Bn.renderCustomMark)({layoutPage:e,ctx:this.customMarkCtx}),t.renderUILControl(),t.renderUILCatalog(),this._updateRevisionActive(),this._updateDocumentFieldActive()}}},{key:"cleanDef",value:function(){var e=this;delete this.__spellcheckPattern,delete this.__watermarkPattern,delete this.taskListTodoUseId,delete this.taskListDoneUseId,delete this.circleBullet,delete this.rhombusBullet,delete this.head2RightBullet,delete this.checkbldBullet,delete this.squareBullet,delete this.xrhombusBullet,delete this.cuspopenBullet,Object.values(ti).forEach((function(t){return delete e[t]}))}},{key:"_cleanUilcontrolCtx",value:function(e){this.uilcontrolCtx&&this.uilcontrolCtx.clear(e)}},{key:"_cleanUilcatalogCtx",value:function(e){this.uilcatalogCtx&&this.uilcatalogCtx.clear(e)}},{key:"_updateRevisionActive",value:function(){this._revisionSvgNodeManager&&this._revisionSvgNodeManager.updateActive()}},{key:"_updateDocumentFieldActive",value:function(){this._documentFieldSvgNodeManager&&this._documentFieldSvgNodeManager.updateActive()}},{key:"clean",value:function(){this._revisionSvgNodeManager&&(this._revisionSvgNodeManager=null),this._commentSvgNodeManager&&(this._commentSvgNodeManager=null),this._documentFieldSvgNodeManager&&(this._documentFieldSvgNodeManager=null),this._spellCheckSvgNodeManager&&(this._spellCheckSvgNodeManager.unLoadResouce(),this._spellCheckSvgNodeManager=null),this.rootSvg.clear(),this.cleanDef()}},{key:"onRemoveLineRenderInfos",value:function(e){this._documentFieldSvgNodeManager&&this._documentFieldSvgNodeManager.onRemoveLineRenderInfos(e),this._revisionSvgNodeManager&&this._revisionSvgNodeManager.onRemoveLineRenderInfos(e),this._commentSvgNodeManager&&this._commentSvgNodeManager.onRemoveLineRenderInfos(e),this._spellCheckSvgNodeManager&&this._spellCheckSvgNodeManager.onRemoveLineRenderInfos(e)}},{key:"getTaskListUseId",value:function(e){return $n(e,this,this.rootSvg)}},{key:"getSpellCheckPattern",value:function(){return ri(this,this.rootSvg)}},{key:"getWatermarkPattern",value:function(e){return ai(e,this,this.rootSvg)}},{key:"getCloudFileId",value:function(e){return ii(e,this,this.rootSvg)}},{key:"getBulletListId",value:function(e){return ei(e,this,this.rootSvg)}},{key:"index",get:function(){return this.layout_index}},{key:"layoutPage",get:function(){return this.layout_index>=0&&this.layout_index<this.data.typoinfo.pageCount?this.data.typoinfo.getLayoutPageCache(this.layout_index):null}},{key:"outerRect",get:function(){var e=this.data.typoinfo.outer_rects[this.layout_index],t=e.left,n=e.top,i=e.width,r=e.height;return x.a.initByOriginAndSize({x:t,y:n},{width:i,height:r})}},{key:"vpsc_outer_rect",get:function(){return this.outerRect.vpsc_rect}},{key:"revisionSvgNodeManager",get:function(){return this._revisionSvgNodeManager||(this._revisionSvgNodeManager=new Zn(this.data)),this._revisionSvgNodeManager}},{key:"commentSvgNodeManager",get:function(){return this._commentSvgNodeManager||(this._commentSvgNodeManager=new Kn),this._commentSvgNodeManager}},{key:"documentFieldSvgNodeManager",get:function(){return this._documentFieldSvgNodeManager||(this._documentFieldSvgNodeManager=new ci),this._documentFieldSvgNodeManager}},{key:"spellCheckSvgNodeManager",get:function(){return this._spellCheckSvgNodeManager||(this._spellCheckSvgNodeManager=new Jn),this._spellCheckSvgNodeManager}}]),e}(),Pi=n(1583),Si=n(12962),Mi=n.n(Si);function Ii(e,t){var n=t.pos,i=n+t.len,r=[];e.lines.forEach((function(e){if(e.layoutType===et.c.TextLine){var t=e.range.pos,o=e.range.len+t;n>=o||i<=t||r.push(e.renderInfo)}}));for(var o=e.parent;o&&o instanceof Ge.c;){var a=o.parent;r.push(a.renderInfo),o=a.parent}return r}function Ti(e,t,n){if(e instanceof u.d&&e.svgNode)return Object(It.c)(e.svgNode,t,n);if(e instanceof Ge.c){var i=e.renderInfo&&e.renderInfo.renderSvgs&&e.renderInfo.renderSvgs[t];if(i)return n.enterChildCtxByNode(i);var r=Ti(e.parent,t,n),o=e,a=o.parent,s=o.rect,l=s.top,d=s.left,h=s.width,c=s.height;if(d+=a.rect.left,o.merge_type===Ge.e.FIRST){var _=function(e){for(var t=e.rect.left,n=e.rect.right,i=e.parent,r=i.parent.lines,o=e,a=r.indexOf(i)+1,s=r.length;a<s;++a){var l=r[a];if(!(l instanceof Ve.a))break;for(var d=l.tablecells,h=!1,c=0,_=d.length;c<_;++c){var u=d[c];if(!(u.rect.right<=t||u.rect.left>=n)&&(u.merge_type&&u.merge_type!==Ge.e.NONE)){u.merge_type===Ge.e.LAST&&(h=!0),o=u;break}}if(h)break}return o}(o);if(_&&_.parent)c=_.parent.rect.bottom-a.rect.top}var p=r.saveAndRestore();return i=p.node,(r=p.ctx).clipRect(d,l,h,c),e.renderInfo.renderSvgs||(e.renderInfo.renderSvgs={}),e.renderInfo.renderSvgs[t]=i,r}if(e instanceof Ve.a){var f=e.renderInfo&&e.renderInfo.renderSvgs&&e.renderInfo.renderSvgs[t];if(f)return n.enterChildCtxByNode(f);var g=Ti(e.parent,t,n),v=e.rect.top,m=g.saveAndRestore();f=m.node,(g=m.ctx).translate(0,v),e.renderInfo.renderSvgs||(e.renderInfo.renderSvgs={}),e.renderInfo.renderSvgs[t]=f;var y=e.parent.renderInfo;return y.renderUnits[t]||(y.renderUnits[t]=[]),y.renderUnits[t].push({y:v,lineRenderInfos:[e.renderInfo],svgNode:f}),g}var b=e.renderInfo&&e.renderInfo.renderSvgs&&e.renderInfo.renderSvgs[t];if(b)return n.enterChildCtxByNode(b);var w=Ti(e.parent,t,n),x=w.saveAndRestore();b=x.node,w=x.ctx;var k=e,C=k.textflow,P=C.rotate,S=C.scale,M=De.a.copy(k.coororigin_pos2parent||k.position2parent||{x:0,y:0});return e.parent instanceof Ge.c&&(M=De.a.add(M,e.parent.position2parent,e.parent.cell2page_offset,{x:e.parent.parent.rect.left,y:0})),w.translate(Math.round(M.x),Math.round(M.y)),w.rotate(P),w.scale(S.x,S.y),e.renderInfo.renderSvgs||(e.renderInfo.renderSvgs={}),e.renderInfo.renderSvgs[t]=b,w}var Ri=function(){function e(){a()(this,e)}return l()(e,null,[{key:"isCard",value:function(e,t,n){return n<=0||1===n&&e.getText(t,n).charCodeAt(0)===U.a}},{key:"setHover",value:function(e,t){t.childNodes&&t.childNodes[0]&&t.childNodes[0].setAttribute("fill-opacity",e?.5:.2)}},{key:"isPara",value:function(e,t){var n=T.isMobile?e.id:e.rc_id;return t&&t.length>0&&t.indexOf(n)>-1}},{key:"updateColor",value:function(e,t){e.childNodes&&e.childNodes[0]&&e.childNodes[0].setAttribute("fill",t)}},{key:"updateUnderlineStroke",value:function(e,t){e.childNodes&&e.childNodes[0]&&e.childNodes[0].setAttribute("stroke",t)}},{key:"updateComment",value:function(t,n,i){var r=n.selection,o=r.activeCommentParaData,a=r.hoverCommentParaData,s=n.typoinfo,l=!0,d=window.APP.typoMode;l=d!==tt.TYPO_MODE.MODE_PAGINATION&&(d===tt.TYPO_MODE.MODE_MOBILE?(!window.APP.workspace.revisionComment.isShowComment||window.APP.isCardMode)&&t&&t.length:t&&t.length),t.forEach((function(t){var n=t.body.comment,r=[t.range||{pos:n.pos,len:n.len}],d=e.isPara(t,o),h=a&&a.length>0&&a.indexOf(t.rc_id)>-1,c=t.color,_="commentParagraph";Object(Ze.getTextPageByRanges)(r,s).forEach((function(n){var o=null;if(n.viewPage.svgNode&&!n.viewPage.isUpdate&&(o=i(n.viewPage)),n.range&&n.viewPage.svgNode&&o){var a=o.commentSvgNodeManager,s=a.getComment(n,t.rc_id);if(s){var u=s.svgNode;s.color!==c&&(e.updateColor(u,c),s.color=c),e.setHover(d||h,u)}else if(l){var p=n.renderInfo,f=p.renderUnits[_]||[],g=Ii(n,r[0]);if(g.length){var v=g[0].y,m=Object(Ze.getRangesPath)(r,n,!1,!0,Ze.USE_HEIGHT_WAY.LINE_TEXT_HEIGHT,-v);if(m){var y=Ti(n,_,o.rootSvg),b={svgNode:y.save(),y:v,lineRenderInfos:g};y.translate(0,v);var w=Object(Ze.renderCommentParagraph)(m,y,c,!1);a.setComment(n,t.rc_id,w,c,g),y.restore(),f.push(b),e.setHover(d||h,w)}}f.length&&(p.renderUnits[_]=f)}var x=a.getCommentCard(n,t.rc_id);if(d){if(x)return void(x.color!==c&&(e.updateColor(x.svgNode,c),x.color=c));var k=Ii(n,r[0]);if(!k.length)return;var C=n.renderInfo,P=C.renderUnits[_]||[],S=Ti(n,_,o.rootSvg),M=k[0].y,I={y:M,lineRenderInfos:k,svgNode:S.save()};S.translate(0,M);var T=Object(Ze.renderCommentCard)(r,n,c,S,-M);S.restore(),P.push(I),C.renderUnits[_]=P,a.setCommentCard(n,t.rc_id,T,c,k)}else if(x){var R=n.renderInfo.renderUnits[_]||[],N=x.svgNode.parentNode,E=R.findIndex((function(e){return e.svgNode===N}));if(a.deleteCommentCard(n,t.rc_id,x.svgNode),E>=0){try{N.parentNode.removeChild(N)}catch(e){}R.splice(E,1)}}}}))}))}},{key:"updateCommentUnderline",value:function(t,n,i){var r=n.selection,o=r.activeCommentParaData,a=r.hoverCommentParaData,s=n.typoinfo,l=[];t.forEach((function(t){var n=t.body.comment,r=[t.range||{pos:n.pos,len:n.len}],d="commentParagraph",h=Object(Ze.getTextPageByRanges)(r,s),c=e.isPara(t,o),_=a&&a.length>0&&a.indexOf(t.rc_id)>-1,u=c||_,p=t.isDone?"#BFC4CC":"#F1A100",f=t.isHide,g=!1;h.forEach((function(n){var o=null;if(n.viewPage.svgNode&&!n.viewPage.isUpdate&&(o=i(n.viewPage)),n.range&&n.viewPage.svgNode&&o){var a=o.commentSvgNodeManager,s=a.getCommentUnderline(n,t.rc_id),l=a.getCommentSelected(n,t.rc_id);if(f){if(s){var h=s.svgNode;e.updateUnderlineStroke(h,"none")}if(l){var c=l.svgNode;e.updateColor(c,"none")}}else{if(s){var _=s.svgNode;s.color!==p&&(e.updateUnderlineStroke(_,p),s.color=p)}else{var v=n.renderInfo,m=v.renderUnits[d]||[],y=Ii(n,r[0]);if(y.length){var b=y[0].y,w=Object(Ze.getUnderlinePath)(r,n,!1,!0,Ze.USE_HEIGHT_WAY.LINE_TEXT_HEIGHT,-b);if(w){var x=Ti(n,d,o.rootSvg),k={svgNode:x.save(),y:b,lineRenderInfos:y};x.translate(0,b);var C=Object(Ze.renderCommentUnderline)(w,x,p);a.setCommentUnderline(n,t.rc_id,C,p,y),x.restore(),m.push(k)}}m.length&&(v.renderUnits[d]=m)}if(l){var P=l.svgNode;e.updateColor(P,u?p:"none")}else if(u){var S=n.renderInfo,M=S.renderUnits[d]||[],I=Ii(n,r[0]);if(I.length){var T=I[0].y,R=Object(Ze.getRangesPath)(r,n,!1,!0,Ze.USE_HEIGHT_WAY.LINE_CONTENT_HEIGHT,-T);if(R){var N=Ti(n,d,o.rootSvg),E={svgNode:N.save(),y:T,lineRenderInfos:I};N.translate(0,T);var A=Object(Ze.renderCommentParagraph)(R,N,p,!1);a.setCommentSelected(n,t.rc_id,A,p,I),N.restore(),M.push(E)}}M.length&&(S.renderUnits[d]=M)}g=!0}}})),g&&l.push(t)})),e.updateCommentsTip(l)}},{key:"updateCommentsTip",value:function(e){mt.default.dispatchEvent(mt.default.comments.ON_COMMENTS_SVG_UPDATE,{comments:e})}}]),e}(),Ni=n(12963),Ei=n(3487),Ai=n(966),Oi=n(1146);function Li(e,t,n,i){var o=window.APP.data,a=window.APP.typoMode;o.selection.activeShapeIdxPath||function(e,t,n,i){var r=e.selection.getNormalRanges(),o=e.selection.isManualRangeSelect||i!==tt.TYPO_MODE.MODE_MOBILE&&i!==tt.TYPO_MODE.MODE_PAGINATION;if(!r&&!r.length)return;if(o){var a=n.tableLineRanges,s=new Map;r.forEach((function(e){a.mapInRange(e.pos,e.pos+e.len,(function(e){return e._node.line}),v.IT.strictIntersectTest).forEach((function(t){t&&t.tablecells&&t.tablecells.forEach((function(n){var i=Object(Ze.getCellSelectionRect)(n,[e]),r=Object(Ni.getViewPage)(n.viewPage);if(r.svgNode&&!r.isUpdate&&i&&i.width>0&&i.height>0){var o=t.parent,a=s.get(o);a||(a=[],s.set(o,a)),a.push(i)}}))}))})),s.forEach((function(e,n){if(t(n.viewPage)){var i=Object(Ze.getNodePathToTextPageWithSvgNode)(n),r=Object(It.c)(i[0].svgNode,"selection",t(n.viewPage).rootSvg),o=r.currentNode,a=Object(Ze.rects2Path)(e);Object(Ze.renderPathWithNodePath)([a,r],r,i,Ze.renderSelection),Bi(o)}}))}var l=Object(Ze.getTextPageByRanges)(r,n),d=e.selection.selectionComposingRenderCheck()&&(i===tt.TYPO_MODE.MODE_PC||i===tt.TYPO_MODE.MODE_WEB);l.forEach((function(e){var n=Object(Ni.getViewPage)(e.viewPage),i=t(n);if(i&&n.svgNode&&!n.isUpdate){var a=e.range;if(!a)return;var s=a.pos,l=s+a.len,h=r.filter((function(e){return!(e.len<=0||e.pos>=l||e.pos+e.len<=s)})),c=d,_=d?Ze.USE_HEIGHT_WAY.DEFAUL_HEIGHT:Ze.USE_HEIGHT_WAY.LINE_HEIGHT;window.APP.isInkMode&&(_=Ze.USE_HEIGHT_WAY.LINE_TEXT_HEIGHT);var u=Object(Ze.getRangesPath)(h,e,o,c,_);if(u&&u.length){var p=Object(Ze.getNodePathToTextPageWithSvgNode)(e),f=Object(It.c)(p[0].svgNode,"selection",i.rootSvg),g=f.currentNode;Object(Ze.renderPathWithNodePath)([u,f],f,p,Ze.renderSelection),Bi(g)}}}))}(o,i,e,a);var s=o.selection.activeOMath;s&&function(e,t,n){if(!e)return;var i=[e];Object(Ze.getTextPageByRanges)(i,n).forEach((function(e){var n=Object(Ni.getViewPage)(e.viewPage);if(n.svgNode&&!n.isUpdate){var r=Object(Ze.getRangesPath)(i,e,!1,!1,!1);if(r&&r.length){var o=Object(Ze.getNodePathToTextPageWithSvgNode)(e),a=Object(It.c)(o[0].svgNode,"selection",t(n).rootSvg),s=a.currentNode;Object(Ze.renderPathWithNodePath)([r,a],a,o,Ze.renderActiveOMath),Bi(s)}}}))}(s,i,e);var l=o.doc.findResults;l&&l.length&&function(e,t,n){Object(Ze.getTextPageByRanges)(e,n).forEach((function(n){var i=Object(Ni.getViewPage)(n.viewPage);if(i.svgNode&&!i.isUpdate){var r=n.range;if(!r)return;var o=r.pos,a=o+r.len,s=e.filter((function(e){return!(e.len<=0||e.pos>=a||e.pos+e.len<=o)})),l=Object(Ze.getRangesPath)(s,n);if(l){var d=Object(Ze.getNodePathToTextPageWithSvgNode)(n),h=Object(It.c)(d[0].svgNode,"findHighlight",t(i).rootSvg),c=h.currentNode;Object(Ze.renderPathWithNodePath)([l,h],h,d,Ze.renderFindHightlight),Bi(c)}}}))}(l,i,e),function(e,t,n,i){var o=[];if(t===tt.TYPO_MODE.MODE_PAGINATION){var a=window.APP.workspace.currentUsedPage;if(!a)return;if(a[0]>0){var s=a[0]-1;a.unshift(s)}var l=a.length-1;if(a[l]){var d=a[l]+1;a.push(d)}var h=Object(Ei.c)(e,a,!1,!0,!1);o=h.reduce((function(e,t){if(t.type===Ai.CR_TYPE.comments){var n=(t.data||[]).filter((function(e){return!Object(Oi.isRefusalToAppeal)(e.comment_id)})),i=!1;i=t.data&&t.data[0]?Object(Oi.isRefusalToAppeal)(t.data[0].comment_id):0===n.length;var o=(n||[]).every((function(e){return e.isDone}));e.push(r()({},t.data[0],{id:t.id,isDone:o,isHide:i}))}else e.push(r()({},t));return e}),[])}else o=e.selection.activeAllCommentsData&&e.selection.activeAllCommentsData.comments;var c=o&&o.length;window.APP.isCommentEnabled||(c=!1);if(!c)return n(),void Ri.updateCommentsTip([]);Ri.updateCommentUnderline(o,e,i)}(o,a,n,i);var d=o.doc.recordHighlightRanges;d&&d.length&&(d.sort((function(e,t){return e.pos-t.pos})),function(e,t,n,i){var r=i!==tt.TYPO_MODE.MODE_MOBILE&&i!==tt.TYPO_MODE.MODE_PAGINATION;if(r){var o=n.tableLineRanges,a=new Map;e.forEach((function(e){o.mapInRange(e.pos,e.pos+e.len,(function(e){return e._node.line}),v.IT.strictIntersectTest).forEach((function(t){t&&t.tablecells&&t.tablecells.forEach((function(n){var i=Object(Ze.getCellSelectionRect)(n,[e]),r=Object(Ni.getViewPage)(n.viewPage);if(r.svgNode&&!r.isUpdate&&i&&i.width>0&&i.height>0){var o=t.parent,s=a.get(o);s||(s=[],a.set(o,s)),s.push(i)}}))}))})),a.forEach((function(e,n){var i=Object(Ze.getNodePathToTextPageWithSvgNode)(n),r=Object(It.c)(i[0].svgNode,"recordHighlight",t(n.viewPage).rootSvg),o=r.currentNode,a=Object(Ze.rects2Path)(e);Object(Ze.renderPathWithNodePath)([a,r],r,i,Ze.renderRecordHighlight),Bi(o)}))}var s=window.APP.data.selection.selectionComposingRenderCheck()&&(i===tt.TYPO_MODE.MODE_PC||i===tt.TYPO_MODE.MODE_WEB);Object(Ze.getTextPageByRanges)(e,n).forEach((function(n){var i=Object(Ni.getViewPage)(n.viewPage);if(i.svgNode&&!i.isUpdate){var o=n.range;if(!o)return;var a=o.pos,l=a+o.len,d=e.filter((function(e){return!(e.len<=0||e.pos>=l||e.pos+e.len<=a)})),h=Object(Ze.getRangesPath)(d,n,r,s);if(h){var c=Object(Ze.getNodePathToTextPageWithSvgNode)(n),_=Object(It.c)(c[0].svgNode,"recordHighlight",t(i).rootSvg),u=_.currentNode;Object(Ze.renderPathWithNodePath)([h,_],_,c,Ze.renderRecordHighlight),Bi(u)}}}))}(d,i,e,a)),function(e,t,n){var i=e.selection.selRevision.activeRevisionInfo.activeRevision,r=window.APP.data.doc.viewSettings.getRevisionsShowMarkup();if(window.APP.isCooperationMode||!i||!r)return;Object(Ze.getTextPageByRanges)([i],n,!0).forEach((function(n){var i=Object(Ni.getViewPage)(n.viewPage);if(i.svgNode&&!i.isUpdate){var r=Object(Ze.getNodePathToTextPageWithSvgNode)(n),o=t(i),a=o&&Object(It.c)(r[0].svgNode,"revision",o.rootSvg),s=a&&a.currentNode;if(!s)return;Object(Ze.renderPathWithNodePath)([n,e,a],a,r,ft.renderRevisionForTextPage),Bi(s)}}))}(o,i,e),function(e,t,n){var i=e.getGlobalBlink();if(i){var r=n.tableLineRanges;i.forEach((function(e){var i=r.mapInRange(e.pos,e.pos+e.len,(function(e){return e._node.line}),v.IT.strictIntersectTest),o={type:"blink",color:e.color,alpha:.5};i.forEach((function(n){n&&n.tablecells&&n.tablecells.forEach((function(i){var r=Object(Ze.getCellSelectionRect)(i,[e]),a=Object(Ze.rects2Path)([r]),s=Object(Ni.getViewPage)(i.viewPage);if(a&&a.length&&s.svgNode&&!s.isUpdate){var l=Object(Ze.getNodePathToTextPageWithSvgNode)(n),d=Object(It.c)(l[0].svgNode,"twinkle-light-container",t(s).rootSvg),h=d.currentNode;Object(Ze.renderPathWithNodePath)([a,d,o,"twinkle-light"],d,l,Ze.renderColorBlock),Bi(h)}}))})),Object(Ze.getTextPageByRanges)([e],n,!0).forEach((function(n){var i=Object(Ni.getViewPage)(n.viewPage);if(i.svgNode&&!i.isUpdate){var r=Object(Ze.getRangesPath)([e],n,!0);if(r){var a=Object(Ze.getNodePathToTextPageWithSvgNode)(n),s=Object(It.c)(a[0].svgNode,"twinkle-light-container",t(i).rootSvg),l=s.currentNode;Object(Ze.renderPathWithNodePath)([r,s,o,"twinkle-light"],s,a,Ze.renderColorBlock),Bi(l)}}}))}))}}(o,i,e),function(e,t){var n=window.APP.workspace.spellCheckManager,i=window.APP.workspace.data.doc.getDataLogic("final").specHidden;if(!n||!n.isOpened)return;var r=n.checkCore.spellingMarks.getViewPageWrongMarks(),o=n.checkCore.spellingProgressMarks.getViewPageWrongMarks();Di(e,t,r,(function(e){return e.getShowRange(i)})),Di(e,t,o,(function(e){return e.getShowRange(i)}))}(i,e)}function Fi(){var e=window.APP.workspace;e&&(e.selectionSvgs&&e.selectionSvgs.forEach((function(e){try{e.parentNode.removeChild(e)}catch(e){}})),e.selectionSvgs=[])}function Di(e,t,n,i){var r=new Map;n.forEach((function(n){var o=i&&i(n)||[n];!o||o.length<=0||Object(Ze.getTextPageByRanges)(o,t).forEach((function(t){var i=Object(Ni.getViewPage)(t.viewPage);if(i.svgNode&&!i.isUpdate){var a=e(i),s=a.spellCheckSvgNodeManager;if(!s.loadSpellCheckSvgNodes(t,n)){var l=t.range;if(l){var d=l.pos,h=d+l.len,c=o.filter((function(e){return!(e.len<=0||e.pos>=h||e.pos+e.len<=d)})),_=Ii(t,c[0]);if(_.length){var u="spellCheck",p=Object(Ze.getRangesRects)(c,t,!1,!1,!1,Ze.USE_HEIGHT_WAY.DEFAUL_HEIGHT);if(p&&p.length){r.has(t)||r.set(t,Ti(t,u,a.rootSvg));var f=r.get(t),g=_[0].y,v={y:g,lineRenderInfos:_,svgNode:f.save()};p.forEach((function(e){e.offset(0,-g)})),f.translate(0,g);var m=Object(Ze.renderSpellCheck)(p,f,a);f.restore(),t.renderInfo.renderUnits[u]||(t.renderInfo.renderUnits[u]=[]),t.renderInfo.renderUnits[u].push(v),s.storeSpellCheckSvgNodes(t,n,m,_)}}}}}}))}))}function Bi(e){var t=window.APP.workspace.selectionSvgs;t||(t=window.APP.workspace.selectionSvgs=[]),t.indexOf(e)<0&&t.push(e)}var ji=n(623),Wi=n(4108);var Ui=function(){function e(t,n){var i=this;a()(this,e),this.workspace=t,this.data=n,this._canvasPool=[],this.layoutPage2Canvas=new Map,window.APP.dumpPic&&Mi()((function(e){i.pageDumper=e.createPageDumper(i),i.refreshCanvas(null,!0)}))}return l()(e,[{key:"onAfterFirstRender",value:function(){this.afterFirstRender=!0}},{key:"init",value:function(){return this.onScroll()}},{key:"generateCanvas",value:function(e){var t=this.data.typoinfo.getLayoutPageCache(e);if(t)try{var n=new Ci({workspace:this.workspace,container:this.workspace.container,layout:t,data:this.data,isForce:!!this.pageDumper,measureCtx:Object(fi.getMeasureCTX)()});this._canvasPool.push(n),this.pageDumper&&this.pageDumper.onRenderCanvas(n)}catch(t){window.report(ji.TYPE.COUNT,"wps_pagemode_canvas_generate_error",1),console.error(t),this.pageDumper&&this.pageDumper.onRenderError(e,t)}}},{key:"_intersects",value:function(e,t,n,i){return!(e>i||n>t)}},{key:"_scaleValue",value:function(e){return e*Pi.a.getZoom()}},{key:"getCvsList",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workspace.getCurrentRect(),t=[],n=this.data.typoinfo.calcRects(),i=0;i<n.length;i++){var r=n[i];this._intersects(e.top,e.bottom,this._scaleValue(r.top),this._scaleValue(r.top+r.height))&&t.push(i)}return t}},{key:"onScroll",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getCvsList(),n=[],i=0;i<e.length;i++){var r=e[i],o=t.indexOf(r);o>-1&&(n.push(r),t.splice(o,1))}return this.handleCvsList(t,n),t}},{key:"getCurrentPagesIndex",value:function(){return this.availableCvsList.map((function(e){return e.index}))}},{key:"handleCvsList",value:function(e,t){var n=this;this.queryPages(e.concat(t));var i=this._canvasPool.filter((function(n){return e.indexOf(n.index)<0||t.indexOf(n.index)>-1})),r=e.filter((function(e){return n._canvasPool.map((function(e){return e.index})).indexOf(e)<0}));if((r=r.concat(t))&&r.length){Fi();for(var o=void 0;void 0!==(o=r.shift());){var a=i.length&&i.shift();if(a){var s=this.data.typoinfo.getLayoutPageCache(o);try{s&&a.reuse(s,!!this.pageDumper||t.includes(o)),this.pageDumper&&this.pageDumper.onRenderCanvas(a)}catch(e){window.report(ji.TYPE.COUNT,"wps_pagemode_canvas_reuse_error",1),console.error(e),this.pageDumper&&this.pageDumper.onRenderError(o,e)}}else this.generateCanvas(o)}this._updateSvgForSelectionChange()}i.forEach((function(e){-1!==e.layout_index&&e.pend()}))}},{key:"hasUpdatePage",value:function(e){return this.data.typoinfo.getLayoutPageCache(e).isUpdate}},{key:"refreshCanvas",value:function(e,t,n){var i=this.data.typoinfo,o=i.updater,a=this._canvasPool,s=!1,l=this.hasFontChange,d=this.data.doc.useCoreTypo;i.shouldClearCanvas.length>0&&(i.shouldClearCanvas.forEach((function(e){return e.pend()})),this.handleCvsList(this.getCvsList(),n||[]),i.shouldClearCanvas=[]);var h=function(e){var t=i.getLayoutPageCache(e);if(t.isUpdate)return!0;if(d){var n=!1;if(t.mainpages&&t.mainpages.some((function(e){return n=!e.lineNumberingParam||function(e,t){var n=!1;return Object.keys(e).some((function(i){if(e[i]!==t[i])return n=!0})),n}(e.lineNumberingParam,e.section.getLineNumbering())})),n)return!0}if(void 0!==t.startLineNumbering&&e>0){var r=i.getLayoutPageCache(e-1);if(void 0!==r.nextLineNumbering){if(t.startLineNumbering!==r.nextLineNumbering)return!0}else if(t.mainpages&&t.mainpages[0]&&t.startLineNumbering!==(t.mainpages[0].section.getLineNumbering().start||0)+1)return!0}return!1};Fi();var c,_,u=n;if(!u){var p=a.map((function(e){return e.index})).filter((function(e){return e>-1}));p.sort((function(e,t){return e-t})),p.length>0&&o.updatePages({from:p[0],to:p[p.length-1]})}for(var f=0;f<a.length;f++){var g=a[f],v=g.index;if("number"==typeof v&&v>=0&&v<i.pageCount){var m=void 0,y=t||u&&u.includes(v)||this.data.selection.selContext.isInHeaderFooter!==g.isInHeaderFooter||!Object(Wi.b)(this.data.selection.selContext.shapeIdxPathOfTextbox,g.shapeIdxPathOfTextbox)||g.shapeIdxPathOfTextbox&&(c=this.data.selection.selShapes[0].rect,_=g.shapeRectForTextBox,!(c.left===_.left&&c.top===_.top&&c.right===_.right&&c.bottom===_.bottom&&this.data.selection.selShapes[0].renderInfo))||window.APP.isCooperationMode!==g.isCooperationMode||window.APP.isReadOnly()!==g.isReadOnly;m=!y&&(!l&&!h(v)&&i.getLayoutPageCache(v)==g.lastRenderLayoutPage);try{g.refreshCvs(y||!!this.pageDumper,m),d&&g.layoutPage.mainpages&&g.layoutPage.mainpages.forEach((function(e){e.section&&(e.lineNumberingParam=r()({},e.section.getLineNumbering()))})),this.pageDumper&&this.pageDumper.onRenderCanvas(g)}catch(e){window.report(ji.TYPE.COUNT,"wps_pagemode_canvas_refresh_error",1),console.error(e),this.pageDumper&&this.pageDumper.onRenderError(v,e),g.onError()}}else s=!0,g.pend()}return this._updateSvgForSelectionChange(),this.hasFontChange=!1,mt.default.dispatchEvent(mt.default.canvas.ON_AFTER_REFRESH_CANVAS),s}},{key:"getRelationRect",value:function(){this.workspace.config.zoom>0&&(this.workspace.currentPage=this.workspace.getPageCurrent(!0));for(var e=this._canvasPool[0],t=0;t<this._canvasPool.length;t++)if(this._canvasPool[t].layout_index==this.workspace.currentPage){e=this._canvasPool[t];break}return e?e.getBoundRect():{left:0,top:0,right:0,bottom:0,width:0,height:0}}},{key:"queryPages",value:function(e){var t=this,n=-1,i=-1;e.forEach((function(e){var r=t.data.typoinfo.getLayoutPageCache(e);r&&r.isMoc&&((-1==n||n>e)&&(n=e),i<e&&(i=e))})),-1==n||-1==i?this.data.typoinfo.queryRangeForPage():this.data.typoinfo.queryRangeForPage(n,i)}},{key:"onSelectionChanged",value:function(){Fi(),this._updateSvgForSelectionChange()}},{key:"_updateSvgForSelectionChange",value:function(){var e=this;Li(this.view,0,(function(){for(var t=0;t<e._canvasPool.length;t++){var n=e._canvasPool[t];n._commentSvgNodeManager&&n._commentSvgNodeManager.clearCommentsUnderline()}}),(function(t){var n=void 0,i=t;return i.isDecorativePage&&(i=i.contentPage),e._canvasPool.some((function(e){if(e.lastRenderLayoutPage===i)return n=e,!0})),n}))}},{key:"onFontUpdate",value:function(){this.hasFontChange=!0}},{key:"canvasPool",get:function(){return this._canvasPool}},{key:"view",get:function(){return this.data.typoinfo}},{key:"availableCvsList",get:function(){return this._canvasPool.filter((function(e){return e.index>=0}))}}]),e}(),zi=n(3319);var Gi=function(e){function t(e,n){var i=n.mobilepage,r=n.data,o=n.coor;a()(this,t);var s=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.mobilepage=i,s.data=r,s.shapeManager=r.shapeManager,s.coor=o,s.localCache={},s}return _()(t,e),l()(t,[{key:"_setShapeRenderInfo",value:function(e,t){this.shapeManager._shapeRenderInfo||(this.shapeManager._shapeRenderInfo={});var n=e.rect,i=e.innerBoundary,r=e.renderScale,o=void 0===r?1:r,a=n.left+(i?i.left*o:0),s=n.top+(i?i.top*o:0),l=new zi.a({left:a,top:s,right:a+(i?i.width*o:n.width),bottom:s+(i?i.height*o:n.height)});return this.shapeManager._shapeRenderInfo[e.id]={coor:{x:0,y:0},rect:l,mobilePage:t},this.shapeManager._shapeRenderInfo[e.id]}},{key:"render",value:function(){var e=this,t=this.mobilepage,n=this.canvas.context,i=this.embeds;Object(pn.getEmbedsUrlInfo)(i),i&&i.forEach((function(t){var n=t.shape,i=t.size;e.renderShape(t,n,i)})),t.layers&&!t.layers.renderInfo&&(t.layers.renderInfo={});t.layers&&function e(t){t.embedShapes&&t.embedShapes.forEach((function(e){if(e.renderInfo&&e.renderInfo.moved){var t=q.calcShapePos(e,e.renderInfo.line),n=t.x,i=t.y,r="translate("+n+", "+i+")";e.renderScale&&(r+=" scale("+e.renderScale+", "+e.renderScale+")"),e.renderInfo.svgNode.setAttribute("transform",r),e.renderInfo.x=n,e.renderInfo.y=i,delete e.renderInfo.moved}})),t.childLayers&&t.childLayers.forEach((function(t){e(t)}))}(t.layers);var r=void 0;if(t.isTable){if(function(e){if(e._nextTable)return!1;var t=e.page&&e.page.lines;return t[t.length-1].isLastTable}(t)){r=[];for(var o=t;o;){var a=o.layers;if(a){var s=a.getShapeCards();s&&s.length&&(r=[].concat(g()(s),g()(r))),a.renderInfo&&a.renderInfo.removed&&(a.renderInfo.removed.forEach((function(e){try{e&&e.svgNode&&e.svgNode.parentNode.removeChild(e.svgNode)}catch(e){}})),delete a.renderInfo.removed)}o=o._prevTable}}}else r=t.layers&&t.layers.getShapeCards();r&&r.forEach((function(i){if(!i.isInk){var r=i.id,o=i.rect;e._setShapeRenderInfo(i,t),i.renderInfo||(i.renderInfo={});var a=i.renderInfo.svgNode,s={svgNode:n.save("shape_"+i.shape_tree_type+"_"+r,a)},l=Math.round(o.left),d=Math.round(o.top);if(a){var h=a.getAttribute("transform");h.startsWith("translate(")&&(h=h.substring(h.indexOf(")")+1)),a.setAttribute("transform","translate("+l+", "+d+")"+h)}else if(n.translate(l,d),i.renderScale){var c=i.renderScale;n.scale(c,c)}n.restore(!1,!!a),a&&n.seekNextInsertPos(),i.renderInfo.svgNode=s.svgNode,(!a||i.renderInfo.expired||i.renderInfo.needRerender)&&e.doRenderShape(s,i,i.rect.size),delete i.renderInfo.needRerender}})),(i=this.embeds)&&i.forEach((function(t){var n=t.shape,i=t.size;e.renderShape(t,n,i)}))}},{key:"doRenderShape",value:function(e,t,n){this.renderShape(e,t,n)}},{key:"shapes",get:function(){return this.mobilepage.shapes}},{key:"embeds",get:function(){return this.mobilepage.renderEmbeds}},{key:"shapeMap",get:function(){return this.shapeManager.shapeMap}},{key:"offsetTopOfShapes",get:function(){return this.mobilepage.offsetTopOfShapes}},{key:"width",get:function(){return this.mobilepage.width}}]),t}(mn),Hi=function(e,t,n){return e.pos>=n||e.len&&e.pos+e.len===t||e.pos+e.len<t},Vi=function(e,t){var n=[],i=[],r=t.page.lines.length&&!e.every((function(e){return Hi(e,t.begin,t.end)})),o=1/0,a=0;if(r){var s=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;e.forEach((function(e){var r=t.page.lines.filter((function(e){return e.isInTable})),d=r[0].tablecells.map((function(e){return e.rect})),h=void 0;r.forEach((function(t,i){0===i&&(o=Math.min(t.range.begin,o)),i===r.length-1&&(a=Math.max(t.range.end,a));var d=t.tablecells;d[0].merge_type===Ge.e.FIRST&&(h=i),Hi(e,t.range.begin,t.range.end)||(d[0].merge_type===Ge.e.MIDDLE||d[0].merge_type===Ge.e.LAST?n.push(h):n.push(i)),d.forEach((function(t){var n=t.range;n&&!Hi(e,n.pos,n.pos+n.len)&&(s=Math.min(Math.floor(t.rect.left),s),l=Math.max(Math.floor(t.rect.right),l))}))})),d.forEach((function(e,t){s>=Math.floor(e.right)||l<=Math.floor(e.left)||i.push(t)}))}))}var d={isSelectionInRange:r,activeRows:n,activeColumns:i};return o<a&&(d.tableRange={pos:o,len:a-o}),d},qi=n(12964),Yi=n.n(qi),Xi=new(function(){function e(){a()(this,e)}return l()(e,[{key:"createImage",value:function(e,t,n){var i=Object(pi.createElement)({type:"div",classname:e,style:"display: none;",parent:document.body});if(i&&"icons-other-table_select_all"===e){var r=new Image(t,n);return r.src=Yi.a,r}if(i){var o=window.getComputedStyle(i,!1)["background-image"],a=/(data:image.*)\)/g.exec(o);if(!a||!a[1])return null;var s=a[1].replace(/\"/g,"");if(!s)return null;var l=new Image(t,n);return l.src=s,l}}},{key:"selectAllImage",get:function(){return this._selectAllImage||(this._selectAllImage=this.createImage("icons-other-table_select_all",18,18)),this._selectAllImage}}]),e}()),Qi=function(e){function t(){return a()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _()(t,e),l()(t,[{key:"_renderSelectAllButton",value:function(e,t){var n=Xi.selectAllImage,i=t._drawingOffset.x;t.svgTableMenu.table=e.save(),e.translate(i,this.offset.y),e.addImageNode(n.src,0,0,n.width,n.height),e.restore()}},{key:"activate",value:function(e,t){[{activeIndexes:e,childNodes:this.mobilePage.svgTableMenu.rowChildren},{activeIndexes:t,childNodes:this.mobilePage.svgTableMenu.columnChildren}].forEach((function(e){for(var t=e.activeIndexes,n=void 0===t?[]:t,i=e.childNodes,r=void 0===i?[]:i,o=0;o<r.length;o++){var a=r[o],s=a.index,l=a.node,d=En()(l.childNodes,2),h=d[0],c=d[1];-1!==n.indexOf(s)?(l.parentNode.appendChild(l),h.setAttribute("stroke",ne.y.color),h.setAttribute("fill",ne.x.color),c.setAttribute("fill",ne.z.color)):(h.setAttribute("stroke",ne.B.color),h.setAttribute("fill",ne.A.color),c.setAttribute("fill",ne.E.color))}}))}}]),t}(function(e){function t(e,n){var i=n.data,r=n.mobilePage;a()(this,t);var o=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.data=i,o.mobilePage=r,o.offset={x:-20,y:-20},o.padding=3,o}return _()(t,e),l()(t,[{key:"_renderSelectCellButton",value:function(e,t,n,i,r){var o=t.left,a=t.top,s=o+t.width,l=a+t.height;e.lineWidth=ne.C,e.strokeStyle=r?ne.y.color:ne.B.color,e.fillStyle=r?ne.x.color:ne.A.color,e.beginPath(),e.moveTo(o+n.tl,a),e.lineTo(s-n.tr,a),n.tr&&e.quadraticCurveTo(s,a,s,a+n.tr),e.lineTo(s,l-n.br),n.br&&e.quadraticCurveTo(s,l,s-n.br,l),e.lineTo(o+n.bl,l),n.bl&&e.quadraticCurveTo(o,l,o,l-n.bl),e.lineTo(o,a+n.tl),n.tl&&e.quadraticCurveTo(o,a,o+n.tl,a),e.closePath(),e.fill(),e.stroke(),e.fillStyle=r?ne.z.color:ne.E.color,e.fontFace={fontSize:"10",fontFamily:"sans-serif"},e.textAlign="center",e.textBaseline="middle",e.fillText(i,s/2,l/2)}},{key:"_renderSelectAllButton",value:function(e){var t=Xi.selectAllImage;e.drawImage(t,0,0,t.width,t.height)}},{key:"_renderColumnMenu",value:function(e,t,n){var i=this;t.svgTableMenu.column=e.save();var r=-this.offset.x;e.translate(r,this.padding+this.offset.y);var o=t.page.lines[0].tablecells,a=o.length,s=o.reduce((function(e,t,i){var r={index:i,isActive:-1!==n.indexOf(i),rect:t.rect};return r.isActive?e.push(r):e.unshift(r),e}),[]);t.svgTableMenu.columnChildren=[],s.forEach((function(n){var r=n.index,o=n.isActive,s=n.rect,l=s.left,d=s.top,h=s.width,c={tl:0,tr:0,bl:0,br:0};0===r&&(c.tl=2,c.bl=2),r===a-1&&(c.tr=2,c.br=2);var _={index:r,node:e.save()};e.translate(l,d);var u=function(e){for(var t="",n="A".charCodeAt(0),i="Z".charCodeAt(0)-n+1,r=e;r>=0;)t=String.fromCharCode(r%i+n)+t,r=Math.floor(r/i)-1;return t}(r);i._renderSelectCellButton(e,{left:0,top:0,width:h,height:ne.D},c,u,o),t.svgTableMenu.columnChildren.push(_),e.restore()})),e.restore()}},{key:"_renderRowMenuMask",value:function(e,t,n){t.svgTableMenu.rowMask=e.save(),e.translate(-this.padding-(t.view.verticalPadding+this.offset.x),n?this.offset.y:-1);var i=t.view.verticalPadding-1,r=Math.round(t.rect.bottom)-(Math.round(t.rect.top)+Math.round(t.rect.height)),o=t.rect.height+r+(n?0:1);e.fillStyle="#fff",e.fillRect(0,0,i,o),e.restore()}},{key:"_renderRowMenu",value:function(e,t,n,i){var r=this;t.svgTableMenu.row=e.save();var o=t._drawingOffset.x;e.translate(o,0),this._renderRowMenuMask(e,t,i);for(var a=t.page.lines.filter((function(e){return e.isInTable})),s=a.length,l=void 0,d=0,h=t._prevTable;h;)d+=h.page.lines.length,h=h._prevTable;var c=a.reduce((function(e,t,i){var r={index:i,isActive:-1!==n.indexOf(i),rect:{left:t.rect.left,top:t.rect.top,height:t.rect.height}},o=t.tablecells[0].merge_type;if(o!==Ge.e.FIRST&&(l||o!==Ge.e.MIDDLE&&o!==Ge.e.LAST)){if(o===Ge.e.MIDDLE||o===Ge.e.LAST)return l.rect.height+=r.rect.height,e}else l=r;return r.displayIndex=d,r.isActive?e.push(r):e.unshift(r),d++,e}),[]);t.svgTableMenu.rowChildren=[],c.forEach((function(n){var i=n.index,o=n.displayIndex,a=n.isActive,l=n.rect,d=l.left,h=l.top,c=l.height,_={tl:0,tr:0,bl:0,br:0};0===i&&(_.tl=2,_.tr=2),i===s-1&&(_.bl=2,_.br=2);var u={index:i,node:e.save()};e.translate(d,h);var p=(o+1).toString();r._renderSelectCellButton(e,{left:0,top:0,width:ne.D,height:c},_,p,a),t.svgTableMenu.rowChildren.push(u),e.restore()})),e.restore()}},{key:"render",value:function(e,t,n){var i=this.canvas.context,r=this.mobilePage;r.svgTableMenu={},i.seekEndInsertPos&&i.seekEndInsertPos();var o=r.svgTableMenu.wrapper=i.save("table-menu");e||o.setAttribute("display","none"),i.translate(this.offset.x,r.page.position2parent.y);var a=!r._prevTable;a&&this._renderColumnMenu(i,r,n),this._renderRowMenu(i,r,t,a),a&&this._renderSelectAllButton(i,r),i.restore()}}]),t}(p)),Zi=n(227),Ki=n(4583),Ji="main",$i=function(){function e(t,n,i,r){a()(this,e),this.handler=i,this.mobilepage=n,this.rootSvg=t,this.initCTXFragment(r),this._revisionSvgNodeManager=n.revisionSvgNodeManager,this._commentSvgNodeManager=n.commentSvgNodeManager,this._documentFieldSvgNodeManager=n.documentFieldSvgNodeManager,this._spellCheckSvgNodeManager=n.spellCheckSvgNodeManager}return l()(e,[{key:"initCTXFragment",value:function(e){e&&(this.ctx=this.context=this.rootSvg.saveAndRestore(Ji,Object(Ze.findSvgNode)(Ji,this.rootSvg.__closestGroupOrSvg())).ctx)}},{key:"onRemoveLineRenderInfos",value:function(e){this._documentFieldSvgNodeManager&&this._documentFieldSvgNodeManager.onRemoveLineRenderInfos(e),this._revisionSvgNodeManager&&this._revisionSvgNodeManager.onRemoveLineRenderInfos(e),this._commentSvgNodeManager&&this._commentSvgNodeManager.onRemoveLineRenderInfos(e),this._spellCheckSvgNodeManager&&this._spellCheckSvgNodeManager.onRemoveLineRenderInfos(e)}},{key:"getTaskListUseId",value:function(e){return this.handler.getTaskListUseId(e)}},{key:"getSpellCheckPattern",value:function(){return this.handler.getSpellCheckPattern()}},{key:"getCloudFileId",value:function(e){return this.handler.getCloudFileId(e)}},{key:"getBulletListId",value:function(e){return this.handler.getBulletListId(e)}},{key:"revisionSvgNodeManager",get:function(){var e=this;return this._revisionSvgNodeManager||(this._revisionSvgNodeManager=new Zn(this.handler.data),this.handler.revisionSvgNodeManagers||(this.handler.revisionSvgNodeManagers=new Set),this.handler.revisionSvgNodeManagers.add(this._revisionSvgNodeManager),this.mobilepage.doRemoveRevisionSvgManager=function(){e.handler.revisionSvgNodeManagers.delete(e._revisionSvgNodeManager),e.mobilepage.revisionSvgNodeManager=null},this.mobilepage.revisionSvgNodeManager=this._revisionSvgNodeManager),this._revisionSvgNodeManager}},{key:"commentSvgNodeManager",get:function(){var e=this;return this._commentSvgNodeManager||(this._commentSvgNodeManager=new Kn,this.handler.commentSvgNodeManagers||(this.handler.commentSvgNodeManagers=new Set),this.handler.commentSvgNodeManagers.add(this._commentSvgNodeManager),this.mobilepage.doRemoveCommentSvgManager=function(){e.handler.commentSvgNodeManagers.delete(e._commentSvgNodeManager),e.mobilepage.commentSvgNodeManager=null},this.mobilepage.commentSvgNodeManager=this._commentSvgNodeManager),this._commentSvgNodeManager}},{key:"documentFieldSvgNodeManager",get:function(){var e=this;return this._documentFieldSvgNodeManager||(this._documentFieldSvgNodeManager=new ci,this.handler.documentFieldSvgNodeManagers||(this.handler.documentFieldSvgNodeManagers=new Set),this.handler.documentFieldSvgNodeManagers.add(this._documentFieldSvgNodeManager),this.mobilepage.doDocumentFieldSvgNodeManager=function(){e.handler.documentFieldSvgNodeManagers.delete(e._documentFieldSvgNodeManager),e.mobilepage.documentFieldSvgNodeManager=null},this.mobilepage.documentFieldSvgNodeManager=this._documentFieldSvgNodeManager),this._documentFieldSvgNodeManager}},{key:"spellCheckSvgNodeManager",get:function(){var e=this;return this._spellCheckSvgNodeManager||(this._spellCheckSvgNodeManager=new Jn,this.handler.spellCheckSvgNodeManager||(this.handler.spellCheckSvgNodeManager=new Set),this.handler.spellCheckSvgNodeManager.add(this._spellCheckSvgNodeManager),this.mobilepage.doRemoveSpellCheckSvgNodeManager=function(){e.handler.spellCheckSvgNodeManager.delete(e._spellCheckSvgNodeManager),e.mobilepage.spellCheckSvgNodeManager&&e.mobilepage.spellCheckSvgNodeManager.unLoadResouce(),e.mobilepage.spellCheckSvgNodeManager=null},this.mobilepage.spellCheckSvgNodeManager=this._spellCheckSvgNodeManager),this._spellCheckSvgNodeManager}}]),e}();function er(e,t,n,i){for(var r=n,o=0;o<t;++o){var a=e[o];a.startLineNumbering&&a.startLineNumbering===r?r=a.nextLineNumbering:(a.startLineNumbering=r,a.isTable||a.page.lines.forEach((function(e){St(e,i)&&++r})),a.nextLineNumbering=r)}}var tr=function(){function e(t,n){a()(this,e),this.workspace=t,this.data=n,this.view=n.typoinfo,this.typoMode=t.app.typoMode,this.pageRender=new Zt,this.renderInterval=0,this.rootSvgHeight=0,this.rootSvgWidth=0,this.clearWhenIdle=window.utils.Lodash.debounce(this.clearWhenIdle.bind(this),2e3)}return l()(e,[{key:"onAfterFirstRender",value:function(){this.afterFirstRender=!0}},{key:"isTableNonEditable",value:function(e){if(window.APP.restrictEditHandler.isInRestrictEditMode&&e){var t=this.workspace.app.formatContentController,n=e.pos,i=e.len;if(!t.checkIsEditable(n,i))return!0}return!1}},{key:"init",value:function(){return this.onScroll()}},{key:"onScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return this.refreshCanvas(e.detail&&e.detail.renderRect,!1,t),this.getCvsList()}},{key:"getFilenameContainerInfo",value:function(){if(this.typoMode===tt.TYPO_MODE.MODE_WEB){var e=this.view,t=e.width,n=e.verticalPadding,i=e.horizontalPadding;return{width:Math.round(t-2*i),height:Math.round(n),container:this.fileNameContainerDiv}}}},{key:"createBox",value:function(e){if(this.typoMode==tt.TYPO_MODE.MODE_WEB){var t=Object(pi.createElement)({type:"div",classname:"canvas-unit outbox",style:"position: absolute; z-index: 1; background: #ffffff;"}),n=Object(pi.createElement)({type:"div",classname:"wps-custom-shadow-root"}),i=Object(gi.addShadowRoot)(n);(i||t).appendChild(e),i&&t.appendChild(n),this.outerDiv=t;var r=this.view,o=Math.round(r.width-2*r.horizontalPadding),a=Math.round(r.verticalPadding),s=Object(pi.createElement)({classname:"view-container",type:"div",style:"position: absolute; z-index: 2; left:"+Math.round(r.horizontalPadding)+"px; top:0px; width:"+o+"px; height:"+a+"px"});this.fileNameContainerDiv=s,t.appendChild(s);var l=this.data.doc.docInfo;return Zi.default.dispatchEvent(mt.default.webMode.ON_UPDATE_OUTDIV,{containerDiv:s,containerHeight:a,containerWidth:o,docInfo:l}),t}return e}},{key:"updateBox",value:function(){var e=this.view,t=Math.round(e.width-2*e.horizontalPadding),n=Math.round(e.verticalPadding);Object.assign(this.fileNameContainerDiv.style,{width:t+"px"});var i=this.data.doc.docInfo;Zi.default.dispatchEvent(mt.default.webMode.ON_UPDATE_OUTDIV,{containerDiv:this.fileNameContainerDiv,containerHeight:n,containerWidth:t,docInfo:i})}},{key:"getWatermarkPattern",value:function(e){return ai(e,this,this.watermarkSvg)}},{key:"getWatermarkWrapperInfo",value:function(){var e={};return window.APP.isWebMode()?(e.wrapper=this.outerDiv,e.wrapperWidth=this.view.width,e.wrapperHeight=this.view.height):(e.wrapper=this.workspace.container,e.wrapperWidth=Math.max(this.workspace.scrollWidth,document.body.cacheDOMAttr.clientWidth),e.wrapperHeight=Math.max(this.workspace.scrollHeight,document.body.cacheDOMAttr.clientHeight)),e}},{key:"isRendered",value:function(e){var t=e.top,n=e.bottom,i=this.view.hitViewPage(t),r=this.view.layout_pages;if(i){for(var o=i.index;o<r.length&&o<this.view.pageCount;++o){var a=r[o];if(a.rect.top>=n)break;if(!a.svgNode||a.isUpdate)return!1}return!0}return!1}},{key:"refreshCanvas",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Date.now();if(this.rootSvg?window.APP.isAdaptMode()&&this.view.width!==this.rootSvg.width&&(this.rootSvg.width=this.view.width,this.updateBox()):(this.rootSvg=new _i.a({width:this.view.width,height:this.innerHeight,segmentOffsetHeight:window.APP.isWebMode()?0:1e4,ctx:Object(fi.getMeasureCTX)()}),this.workspace.container.appendChild(this.createBox(this.rootSvg.getSvg())),this.rootSvgHeight=this.innerHeight),this.isWatermarkRendered=!t,!this.watermarkSvg&&this.workspace.app.getWatermark()){var r=this.getWatermarkWrapperInfo(),o=r.wrapper,a=r.wrapperWidth,s=r.wrapperHeight;this.watermarkSvg=new _i.a({width:a,height:s,ctx:Object(fi.getMeasureCTX)()});var l=this.watermarkSvg.getSvg(),d="position: absolute; top: 0; left: 0;";window.APP.isWebMode()&&(d+="width: 100%; height: 100%"),l.setAttribute("style",d),o.appendChild(l),this.watermarkSvgWidth=a,this.watermarkSvgHeight=s,this.isWatermarkRendered=!1}var h=this.view,c=Pi.a.getZoom(),_=e||this.getRenderPage(t),u=_.top,p=_.bottom,f=!1;if(this.data.typoinfo.updater){var g=!1;if(this.afterFirstRender){var v=h.layout_pages[h.pageCount-1];if(v&&v.isPageBroken&&v.rect.top<=p){var m=v.page.range,y=this.data.doc.getDataLogic("final").getPapx(m.pos);y.len>1600&&(g=!0)}}f=this.data.typoinfo.updater.updateViewport({top:u,left:0,bottom:p,right:this._pageWidth},{disableTableBreak:this.afterFirstRender,disablePageBreak:g})}var b=u,w=void 0;w=h.pageCount===h.layout_pages.length?h.layout_pages:h.layout_pages.slice(0,h.pageCount),t&&w.forEach((function(e){e.onDel()}));var x=h.size,k=x.width,C=x.height;if(C==this.rootSvgHeight&&k===this.rootSvgWidth&&this.zoom==c||(this.rootSvg.reSize(h.size),this.rootSvgHeight=C,this.rootSvgWidth=k),this.outerDiv){var P=this.workspace.container.clientWidth;this.workspaceWidth!=P&&(this.relationRect=null,this.workspaceWidth=P);var S=this.view.viewOffset.y*c,M=0;window.APP.isAdaptMode()?M=this.view.offsetLeft:(this.view.width*c<P&&(M=Math.round((P-this.view.width*c)/2)),M=Math.max(Math.round((h.padding||0)/2),M)),Object.assign(this.outerDiv.style,{left:M+"px",top:S+"px",width:Math.round(this.view.width*c)+"px",height:Math.round(this.view.height*c)+"px"}),this.view.setViewOffsetX(M/c),this.view.setViewOffsetY(S/c)}if(this.fileNameContainerDiv&&Object.assign(this.fileNameContainerDiv.style,{transform:"scale("+c+")","transform-origin":"left top",left:Math.round(h.horizontalPadding*c)+"px"}),this.watermarkSvg){var I=this.getWatermarkWrapperInfo(),R=I.wrapperWidth,N=I.wrapperHeight;R===this.watermarkSvgWidth&&N===this.watermarkSvgHeight||(this.isWatermarkRendered=!1,this.watermarkSvg.reSize({width:R,height:N}),this.watermarkSvgWidth=R,this.watermarkSvgHeight=N)}b||(b=h.verticalPadding),Fi(),(window.APP.isWebMode()&&this.isCooperationMode!==window.APP.isCooperationMode||T.isMobile&&this.isEditMode!==window.APP.isEditMode)&&w.forEach((function(e){e.onDel()}));var E=h.hitViewPage(b),A=[];if(E){var O=new Ki.b(h),L=new me.a,F=window.APP.isWebMode()&&w[0].section.getLineNumbering(),D=F&&F.step&&F;L.enter(h);var B=D&&{count:Math.max(D.start+1,1)},j=D?{lineNumberingCount:B,lineNumbering:{restart:bt.a,start:D.start||0,step:D.step,blankNoLineNumber:D.blankNoLineNumber},isRTL:w[0].section.getColumnsBidi()}:null,W=D&&D.step||0;if(this._lineNumberingStep&&this._lineNumberingStep!==W&&w.forEach((function(e){e.isUpdate=!0})),this._lineNumberingStep=W,D&&E.index>0){var U=w[E.index-1];U.nextLineNumbering||er(w,E.index,Math.max(D.start+1,1),D.blankNoLineNumber),B.count=U.nextLineNumbering}for(var z=E.index,G=w.length;z<G;++z){var H=w[z];if(H.rect.top>=p)break;if(A.push(H),!H.svgNode||H.isUpdate||B&&B.count!==H.startLineNumbering)O.composeMobilePage(H),this.renderMobilePage(H,L,j),H.isUpdate=!1;else if(D)j.lineNumberingCount.count=H.nextLineNumbering;else if(H.startLineNumbering){var V=H.page.svgNode,q=Object(Ze.findSvgNode)("line-numbering",V);q&&V.removeChild(q),delete H.startLineNumbering,delete H.nextLineNumbering}}L.exit()}this.typoMode==tt.TYPO_MODE.MODE_MOBILE&&this._renderTableMenu(),Object(Bn.renderCustomMarkForWebMode)({layoutPages:A,ctx:this.rootSvg}),this.renderWatermark(),this.renderUILControl(),this.renderUILCatalog(),this.zoom=c,this.isCooperationMode=window.APP.isCooperationMode,this.isEditMode=window.APP.isEditMode,this._updateSvgForSelectionChange();var Y=n.doNotClear;T.isMobile&&!0===Y||this.clearWhenIdle(),this.renderInterval=Date.now()-i;var X=n.onUpdate;f&&X&&X()}},{key:"getRenderPage",value:function(e){var t=Pi.a.getZoom(),n=this.workspace.scrollTop/t,i=this._pageHeight/t,r=void 0;return r=this.afterFirstRender&&!1!==e?this.renderInterval>50?2*i:3*i:i,{top:Math.max(0,n-r),bottom:n+r,zoom:t}}},{key:"clearWhenIdle",value:function(){if(!this.clearing){var e=!1,t=this.rootSvg.currentNode.children;if(t.length>=300)e=!0;else if(0!==t.length){var n=0;this.view.layout_pages.forEach((function(e){e.svgNode&&(n+=e.rect.height)}));var i=5*this._pageHeight;n>i&&(e=!0)}e&&(this.clearing=!0,window.requestAnimationFrame?window.requestAnimationFrame(this.clearInVisibleNode.bind(this)):setTimeout(this.clearInVisibleNode.bind(this)))}}},{key:"clearInVisibleNode",value:function(){var e=this.view.layout_pages,t=this.getRenderPage(),n=t.top,i=t.bottom;e.forEach((function(e){if(e.svgNode&&(e.rect.bottom<=n||e.rect.top>=i))if(e.isTable)if(e._nextTable||!e.page.lines[e.page.lines.length-1].isLastTable)e.onDel(!0);else{e.onDel();for(var t=e._prevTable;t;)t.cleanCardRenderInfo(),t=t._prevTable}else e.onDel()})),this.refreshCanvas(void 0,void 0,{doNotClear:!0}),this.clearing=!1}},{key:"moveRect",value:function(){this.refreshCanvas()}},{key:"_clearAll",value:function(){this.view.layout_pages.forEach((function(e){e.onModify()}))}},{key:"onSelectionChanged",value:function(){var e=this.workspace;Fi(),e.tableMenuSvgs&&e.tableMenuSvgs.forEach((function(e){e.svgNode&&e.svgNode.setAttribute("display","none")})),e.tableMenuSvgs=[];var t=!1;window.APP.forceCompose||this.data.doc.isPalaceMuseumTemplate||window.APP.isCooperationMode!=this.isCooperationMode?(t=!0,this._clearAll()):(this._updateSvgForSelectionChange(),this._updateRevisionActive(),this._updateDocumentFieldActive(),this.typoMode==tt.TYPO_MODE.MODE_MOBILE&&this._activateTableMenu()),null==this._isEditMode?this._isEditMode=window.APP.isEditMode:this._isEditMode!=window.APP.isEditMode&&(this._isEditMode=window.APP.isEditMode,t||this._clearAll())}},{key:"isAllowRenderShapeSelection",value:function(){var e=this.data.selection,t=e.activeShapeIdxPath,n=e.activeShape,i=void 0===n?{}:n,r=this.typoMode===tt.TYPO_MODE.MODE_WEB;return t&&!(r&&i.isEmbedShape)}},{key:"_updateSvgForSelectionChange",value:function(){var e=this,t=new Map;Li(this.view,0,(function(){e.commentSvgNodeManagers&&e.commentSvgNodeManagers.size&&e.commentSvgNodeManagers.forEach((function(e){e.clearCommentsUnderline()}))}),(function(n){var i=t.get(n);return i||(i=new $i(e.rootSvg,n,e),t.set(n,i)),i})),this.isAllowRenderShapeSelection()&&this._renderShapeSelection(),window.APP.isCommentState&&this._renderBackGroundWhenAddComment()}},{key:"_updateRevisionActive",value:function(){this.revisionSvgNodeManagers&&this.revisionSvgNodeManagers.size&&this.revisionSvgNodeManagers.forEach((function(e){e.updateActive()}))}},{key:"_updateDocumentFieldActive",value:function(){this.documentFieldSvgNodeManagers&&this.documentFieldSvgNodeManagers.size&&this.documentFieldSvgNodeManagers.forEach((function(e){e.updateActive()}))}},{key:"_renderShapeStart",value:function(){var e=this.data.selection.activeShape;if(e&&e.upper&&e.viewPage.svgNode){var t=e.upper,n=Object(Ze.getNodePathToTextPageWithSvgNode)(t),i=Object(It.c)(n[0].svgNode,"shapeSelection",this.rootSvg),r=i.currentNode,o=this.workspace.selectionSvgs.findIndex((function(e){return e===r}));o>-1&&(i.clear(),this.workspace.selectionSvgs.splice(o,1)),Object(Ze.renderPathWithNodePath)([e,i],i,n,Ze.renderShapeSelection),this.workspace.selectionSvgs.push(r)}}},{key:"_renderShapeSelection",value:function(){var e=this,t=this.data.selection.activeShape;if(t){var n=t.shape_tree_type,i=t.id,r=t.isRealPicture;t.isPresetDrawing?this._renderShapeStart():this.data.shapeManager.getShapeUrl(n,i,r).then((function(){var t=e.data.selection.activeShape;t&&t.id===i&&t.shape_tree_type===n&&e._renderShapeStart()}),(function(){}))}}},{key:"_renderBackGroundWhenAddComment",value:function(){var e=this,t=this.data.selection;if(t&&t.begin&&t.end){var n=t.begin.position,i=t.end.position,r=!1;if(i===n){r=!0;var o=t.begin.pos.line.viewPage;i=o.end,n=o.begin}var a=[{pos:n,len:i-n}];Object(Ze.getTextPageByRanges)(a,this.view).forEach((function(t){if(t.viewPage.svgNode){var n=t.range.pos,i=n+t.range.len,o=a.filter((function(e){return!(e.len<=0||e.pos>=i||e.pos+e.len<=n)}));if(o&&o.length){var s=void 0,l=void 0;r?(s=n,l=i-n):(s=Math.max(n,o[0].pos),l=Math.min(i-s,o[0].len));var d=Object(Ze.getRangesPath)([{pos:s,len:l}],t);if(d){var h=Object(Ze.getNodePathToTextPageWithSvgNode)(t),c=Object(It.c)(h[0].svgNode,"selection",e.rootSvg),_=c.currentNode;Object(Ze.renderPathWithNodePath)([d,c,null,!0],c,h,Ze.renderCommentParagraph),e.workspace.selectionSvgs.push(_)}}}}))}}},{key:"_activateTableMenu",value:function(){var e=this;if(window.APP.isEditMode){var t=this.data.selection.getNormalRanges(),n=Object(Ze.getTextPageByRanges)(t,this.view,!1),i=Array.from(n).reduce((function(e,t){for(var n=t;n.layoutType!==te.DOCLayoutType.MobilePage;n=n.parent);return n.isTable&&e.add(n),e}),new Set);i.forEach((function(n){var r=n.svgTableMenu&&n.svgTableMenu.wrapper,o=Vi(t,n),a=o.activeRows,s=o.activeColumns,l=o.tableRange;r&&(e.workspace.tableMenuSvgs.push({svgNode:r}),r.removeAttribute("display"),e.isTableNonEditable(l)||new Qi({context:e.rootSvg},{data:e.data,mobilePage:n}).activate(a,s));for(var d=n._prevTable;d&&d._prevTable;)d=d._prevTable;d&&d.svgTableMenu&&!i.has(d)&&(d.svgTableMenu&&d.svgTableMenu.wrapper.removeAttribute("display"),new Qi({context:e.rootSvg},{data:e.data,mobilePage:d}).activate([],s))}))}}},{key:"_renderTableMenu",value:function(){var e=this,t=window.APP.isEditMode;if(!window.APP.isReadOnly()&&t){var n=this.data.selection.getNormalRanges(),i=Object(Ze.getTextPageByRanges)(n,this.view,!1),r=Array.from(i);r.reduce((function(e,t){var n=t.viewPage;if(n.svgNode&&n.isTable){e.add(n);for(var i=n._prevTable;i;)i.svgNode&&e.add(i),i=i._prevTable;for(var r=n._nextTable;r;)r.svgNode&&e.add(r),r=r._nextTable}return e}),new Set).forEach((function(t){var i=Vi(n,t),o=i.activeRows,a=i.activeColumns,s=i.tableRange;if(!e.isTableNonEditable(s)){var l=a;if(0!==a.length||t._prevTable||(l=Vi(n,r[0].viewPage).activeColumns),t.svgTableMenu&&t.svgTableMenu.wrapper)try{t.svgTableMenu.wrapper.parentNode.removeChild(t.svgTableMenu.wrapper)}catch(e){}var d=window.APP.isEditMode,h=e.rootSvg.saveAndRestore(null,t.svgNode).ctx;if(new Qi({context:h},{data:e.data,mobilePage:t}).render(d,o,l),d){var c=t.svgTableMenu.wrapper;e.workspace.tableMenuSvgs||(e.workspace.tableMenuSvgs=[]),e.workspace.tableMenuSvgs.push({svgNode:c})}}}))}}},{key:"renderMobilePage",value:function(e,t,n){var i=this.rootSvg;t.enter(e);var r=e.svgNode;e.svgNode=i.save(null,r);var o=e.rect,a=o.top,s=o.bottom;if(r)r.setAttribute("transform","translate("+Math.round(e.rect.left-e._drawingOffset.x)+", "+Math.round(a)+")");else if(i.translate(Math.round(e.rect.left-e._drawingOffset.x),Math.round(a)),function(e){return!(e.outer_rect.height<=0)&&((e.isFootnoteSep||!!e.isEndnoteSep)&&(window.APP.data.doc.settings.getFootnotePr()||{showSeparator:!0}).showSeparator)}(e)){var l=Math.min(jn.c,e.rect.width),d=jn.b/2,h=d,c=i;c.save(),c.moveTo(0,d),c.lineTo(l,h),c.stroke(),c.restore()}s-a>1e4&&i.getSvg().setAttribute("style","transform: translateZ(0);"),e.renderEmbeds=[];var _=new $i(i,e,this,!0),u=this.pageRender;(u.reset(_,_.ctx,this.data),n&&n.lineNumbering&&(e.startLineNumbering=n.lineNumberingCount.count),u.render(e.page,!1,t,n),n&&n.lineNumbering&&(e.nextLineNumbering=n.lineNumberingCount.count),e.layers&&e.layers.renderInfo&&e.layers.renderInfo.removed&&(e.layers.renderInfo.removed.forEach((function(e){e&&e.svgNode&&e.svgNode.parentNode.removeChild(e.svgNode)})),delete e.layers.renderInfo.removed),e.renderEmbeds.length||e.layers||e.isTable)&&new Gi(_,{mobilepage:e,data:this.data}).render();if(this.typoMode==tt.TYPO_MODE.MODE_MOBILE)if(e.isTable);else if(e.svgTableMenu){try{var p=e.svgTableMenu.wrapper;p.parentNode.removeChild(p)}catch(e){}delete e.svgTableMenu}i.restore(!1,r),t.exit(),delete e.renderInfo.expired}},{key:"renderUILControl",value:function(){if(!window.APP.workspace.getFormatContentManager().isMoving){this.uiControlNode&&this.uiControlNode.parentNode&&this.uiControlNode.parentNode.removeChild(this.uiControlNode),this.uiControlNode=this.rootSvg.save();var e=this.data.selection,t=e.activeCtrls,n=void 0===t?[]:t,i=e.activeDateCtrls,r=void 0===i?[]:i,o=e.activeCatalogCtrls,a=void 0===o?[]:o,s=[].concat(g()(On(n,r)),g()(a));new Ln(null,this.rootSvg,{data:this.data,layoutIndex:0}).render(s),this.rootSvg.restore()}}},{key:"renderUILCatalog",value:function(){this.uiCatalogNode&&this.uiCatalogNode.parentNode&&this.uiCatalogNode.parentNode.removeChild(this.uiCatalogNode),this.uiCatalogNode=this.rootSvg.save();var e=this.data.selection.activeCatalogs,t=void 0===e?[]:e;new Fn(null,this.rootSvg,{data:this.data,layoutIndex:0}).render(t),this.rootSvg.restore()}},{key:"renderWatermark",value:function(){var e=this.workspace.app.getWatermark();e&&!this.isWatermarkRendered&&(new Rn(this,e).render(),this.isWatermarkRendered=!0)}},{key:"getRelationRect",value:function(){return this.relationRect||(this.relationRect=new x.a.initByOriginAndSize({x:0,y:0},{width:this._pageWidth,height:this._pageHeight})),this.relationRect}},{key:"getCvsList",value:function(){var e=Pi.a.getZoom(),t=this.workspace.scrollTop/e,n=this._pageHeight/e,i=this.view,r=t+n,o=i.layout_pages,a=[],s=Math.max(t,i.verticalPadding),l=i.hitViewPage(s);if(l)for(var d=l.index,h=o.length;d<h;++d){if(o[d].rect.top>=r)break;a.push(d)}return a}},{key:"onFontUpdate",value:function(){this.view.layout_pages.forEach((function(e){e.onModify()}))}},{key:"getTaskListUseId",value:function(e){return $n(e,this,this.rootSvg)}},{key:"getSpellCheckPattern",value:function(){return ri(this,this.rootSvg)}},{key:"getCloudFileId",value:function(e){return ii(e,this,this.rootSvg)}},{key:"getBulletListId",value:function(e){return ei(e,this,this.rootSvg)}},{key:"_pageHeight",get:function(){return this.innerHeight}},{key:"_pageWidth",get:function(){return this.innerWidth}},{key:"innerHeight",get:function(){return this._innerHeight&&!window.APP.isWebMode()||(this._innerHeight=0===window.innerHeight?500:window.innerHeight),this._innerHeight}},{key:"innerWidth",get:function(){return window.APP.workspace.element.clientWidth}}]),e}(),nr=n(7212),ir="comment",rr=function(){function e(){a()(this,e)}return l()(e,[{key:"updateActive",value:function(){}},{key:"commit",value:function(){}},{key:"clean",value:function(){}},{key:"setShapeRevision",value:function(){}},{key:"setPapxRevision",value:function(){}},{key:"setChpxRevision",value:function(){}},{key:"setRevisionUnderline",value:function(){}},{key:"setRevisionStrikethrough",value:function(){}},{key:"setRevisionText",value:function(){}},{key:"onRemoveLineRenderInfos",value:function(){}}]),e}(),or=function(){function e(t,n,i,r){a()(this,e),r&&t.initCanvas([ir]),this.ctx=this.context=t.enterChildCtxByNode(n.svgNode.childNodes[0]),this.handler=i,this.page=n,this.rootSvg=t}return l()(e,[{key:"revisionSvgNodeManager",get:function(){return this._revisionSvgNodeManager||(this._revisionSvgNodeManager=new rr),this._revisionSvgNodeManager}}]),e}(),ar=function(){function e(t){a()(this,e),this.data=t,this.view=t.typoinfo,this.pageRender=new Zt,this.renderUnits={},this.selectionSvgGroups=[]}return l()(e,[{key:"createRenderUnit",value:function(e,t){var n=this.renderUnits[e];if(void 0===n){if(!(t instanceof HTMLElement))return console.error("Error: container must be an instance of HTML element"),null;n={container:t,rootSvg:new _i.a({width:nr.b,height:nr.a,ctx:Object(fi.getMeasureCTX)()})},this.renderUnits[e]=n}else n.container=t;return t.children&&t.children.length>0&&Array.from(t.children).forEach((function(e){t.removeChild(e)})),(Object(gi.addShadowRoot)(t)||t).appendChild(n.rootSvg.getSvg()),n}},{key:"removeRenderUnit",value:function(e,t){var n=this.renderUnits[e];if(!n)return!1;var i=n.rootSvg;if(n.container!==t)return!1;var r=i.getSvg();return t.contains(r)&&t.removeChild(r),!0}},{key:"renderPage",value:function(e,t,n){n.enter(t),t.svgNode=e.save(),e.translate(t.rect.left,t.rect.top);var i=new or(e,t,this,!0);this.pageRender.reset(i,i.ctx,this.data),t.page.cleanRenderInfo(),this.pageRender.render(t.page,!0,n),e.restore(),n.exit()}},{key:"refresh",value:function(e,t){var n=this,i=[];return(void 0!==e?[e]:Object.keys(this.renderUnits)).forEach((function(e){var r=n.renderUnits[e];if(r){var o=n.view.getCommentPage(e);if(o){if(o.isUpdate||t){var a=r.rootSvg;a.clear(),a.reSize({width:nr.b,height:o.height+2},{withZoom:!1});var s=new me.a;s.enter(n.view),n.renderPage(a,o,s),o.isUpdate=!1,i.push(e),s.exit()}}else delete n.renderUnits[e]}})),i}},{key:"onSelectionChanged",value:function(){this.selectionSvgGroups.length>0&&(this.selectionSvgGroups.forEach((function(e){try{e.parentNode.removeChild(e)}catch(e){}})),this.selectionSvgGroups.length=0);var e=this.data.selection.selContext.getCommentRcId(),t=this.renderUnits[e];if(!t)return!1;var n=this.data.selection.getNormalRanges()||[];if(!(n=n.filter((function(e){return e.len>0})))||!n.length)return!1;var i=this.view.getCommentPage(e);if(!i)return!1;var r=i.svgNode,o=i.isUpdate,a=i.page;if(r&&!o){var s=this.data.selection.selectionComposingRenderCheck(),l=s?Ze.USE_HEIGHT_WAY.DEFAUL_HEIGHT:Ze.USE_HEIGHT_WAY.LINE_HEIGHT,d=Object(Ze.getRangesPath)(n,a,!0,s,l);if(d&&d.length){var h=Object(Ze.getNodePathToTextPageWithSvgNode)(a),c=Object(It.c)(h[0].svgNode,"selection",t.rootSvg),_=c.currentNode;return Object(Ze.renderPathWithNodePath)([d,c],c,h,Ze.renderSelection),this.selectionSvgGroups.push(_),!0}}return!1}}]),e}(),sr=function(){switch(window.APP.typoMode){case tt.TYPO_MODE.MODE_PC:case tt.TYPO_MODE.MODE_PAGINATION:return Ui;case tt.TYPO_MODE.MODE_MOBILE:case tt.TYPO_MODE.MODE_WEB:return tr;default:return null}},lr=function(){return ar}},1090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateWebshapeByEdit=t.getAllUrlsInfo=t.getStageInfo=t.setStageInfo=t.getEmbedsUrlInfo=t.getFileInfo=t.elementToSnapshot=t.uploadMimeDataImg=t.urlsInfo=t.urlsStatus=t.drawWebshape=void 0;var i=n(5),r=i.__importDefault(n(312)),o=n(358),a=n(167),s=n(1569),l=i.__importDefault(n(1570)),d=i.__importDefault(n(1571)),h=!1,c={},_={s:700,f:700,w:650};function u(e){var t=null==e?void 0:e.split("/");return(null==e?void 0:e.startsWith("http"))?t[0]+"//"+t[2]:t[0]}function p(e,t){var n,i,r=I(e),a=(n=null==r?void 0:r.url,"string"!=typeof(i=null==r?void 0:r.icon)?"":new RegExp(/^(?:http(s)?:\/\/)?(\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/).test(i)||"data:image"===i.split("/")[0]?i:u(n)+(i||"/favicon.ico"));return v({tag:"div",options:{id:"frame_topbar",style:"height: 44px; padding: 8px 0px 8px 12px; display: flex; flex-direction: row; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(13, 13, 13, 0.12); cursor: auto; background-color: white;"},childList:[{tag:"div",options:{style:"height: 44px; width: fit-content; display: flex; flex-direction: row; align-items: center; padding: 0px; gap: 4px;"},childList:(null==r?void 0:r.url)&&[{tag:"i",options:{style:"height: 16px; width: 16px; background-image: url(".concat(a,"); background-size: contain;")}},{tag:"span",options:{title:null==r?void 0:r.title,style:"height: 44px; font-style: normal; font-family: 'PingFang SC'; font-weight: 400; font-size: 14px; line-height: 44px; color: rgba(13, 13, 13, 0.9); text-transform: capitalize; display: flex; white-space: nowrap; align-items: center; max-width: ".concat(t.width-128,"px;")},innerText:null==r?void 0:r.title}]},{tag:"div",options:{style:"height: 28px; width: fit-content; display: flex; flex-direction: row; align-items: center; border-radius: 6px; padding: 3px 12px 3px 24px; cursor: pointer; background-color: white;"},childList:[{tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: #0A6CFF;"},innerText:_i18n("applications.writer.helpers.webshapeDraw.openLink", "Open Link"),events:(null==r?void 0:r.url)&&{onclick:function(){(0,o.openHyperlink)(null==r?void 0:r.url),window.collection("commandbar","click","webshape_openPreviewViewLink")},ontouchend:function(){(0,o.openHyperlink)(null==r?void 0:r.url),window.collection("commandbar","click","webshape_openPreviewViewLink")}}}]}]})}function f(e){var t=e.width,n=e.height;return v({tag:"div",options:{id:"frame_page",style:"height: ".concat(n-44,"px; width: ").concat(t,"px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #FAFAFA;")}})}function g(e){var t=r.default.iconTypes.other.wps_webshape_iframe_error.split(" "),n=t[0],i=t[1];return v({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 16px; padding: 0px; width: fit-content; height: fit-content; margin-bottom: 16px;"},childList:[{tag:"div",options:{class:"icons-".concat(n,"-").concat(i),style:"height: 100px; width: 100px;"}},{tag:e&&"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:e}]})}function v(e){var t=e.tag,n=e.options,i=e.innerText,r=e.childList,o=e.events,a=document.createElementNS("http://www.w3.org/1999/xhtml",t);for(var s in i&&(a.innerText=i),r&&r.length&&r.forEach((function(e){if(e.tag){var t=v(e);a.appendChild(t)}})),o)a[s]=o[s];for(var s in n)a.setAttribute(s,n[s]);return a}function m(e,t){var n=f(e),i=g(_i18n("applications.writer.helpers.webshapeDraw.loadFailed", "Failed to load")),r=v({tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: ".concat(a.isMobile||a.isPad?"white":"#0A6CFF","; padding: 3px 8px; height: 28px; width: 80px;\n          cursor: pointer; background: ").concat(a.isMobile||a.isPad?"#0A6CFF":"white","; text-align: center; border-radius: 4px;")},innerText:_i18n("applications.writer.helpers.webshapeDraw.reload", "Reload"),events:{onclick:function(){t&&t()},ontouchend:function(){t&&t()}}});return n.appendChild(i),n.appendChild(r),n}function y(e){var t=f(e),n=g(_i18n("applications.writer.helpers.webshapeDraw.cantOpen", "Access failed.")),i=v({tag:"span",options:{style:"height: 22px; font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.46);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.rejectConnect", "The web page denied your connection.")});return t.appendChild(n),t.appendChild(i),t}function b(e){var t=f(e),n=g(_i18n("applications.writer.helpers.webshapeDraw.notSupportView", "You cannot preview this web page."));return t.appendChild(n),t}function w(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,s.getUrlsStatus)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function x(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,s.getUrlsInfo)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function k(e,t){var n=e.children,i=t.page,r=t.topBar,o=n.frame_page||n[1],a=n.frame_topbar||n[0];r&&(e.removeChild(a),e.insertBefore(r,o)),i&&(e.innerHTML="",e.appendChild(a),e.appendChild(i))}function C(e,t,n,r){e.innerHTML="";var o=function(){P(n).then((function(i){if("ok"!==i.result)throw new Error("fail to horization");delete c[n],R([n]),C(e,t,n,r)}))},l=function(){var t=b(r);k(e,{page:t})},g=function(){var i=null;!function e(t,n){return!!t&&(t===n.fileInfo.id||n!==n._parent&&e(t,n._parent))}(I(n).id,window)?(i=function(e,t,n,i,r){var o,a=(0,s.isKdocsDoc)(n)?n.split("?")[0]+"?simple&hidecmb&readonly&title_not_update&hide_public_popups&disablePlugins&enterView=card":n,l=i.width,d=i.height,h=(null===(o=window.APP.data.selection.activeShape)||void 0===o?void 0:o.id)===t,c=setTimeout((function(){try{var r=p.firstChild.contentWindow;r&&(r.document.write(""),r.document.close())}catch(e){}var o=m(i,(function(){C(e,t,n,i)}));k(e,{page:o})}),5e3),u=function(){var t=e.querySelector(".webshape-iframe-mask");t&&(t.style.display="none");var n=null==p?void 0:p.parentElement.getBoundingClientRect(),i=n.x,r=n.y,o=window.APP.uilManager.hit({event:{pageX:i,pageY:r}});window.APP.data.selection.selAlter.selectShape(null==o?void 0:o.shapeInfo,{})},p=v({tag:"div",options:{style:"height: ".concat(d-44,"px; width: ").concat(l,"px;")},childList:[{tag:"iframe",options:{style:"height: ".concat(d-44,"px; width: ").concat(l,"px; border: 1px solid rgba(0,0,0,0);"),src:a,allowpaymentrequest:!0,frameBorder:"0",allow:"encrypted-media",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation"},events:{onload:function(t){var o;c&&clearTimeout(c),c=null;try{var a=p.firstChild.contentDocument;if(a){var d=null===(o=I(n))||void 0===o?void 0:o.officeType,h=_[d];p.firstChild.contentWindow.addEventListener("resize",(function(){var e=(0,s.isKdocsDoc)(n)&&a.getElementsByClassName("cmd-status-bar")[0]||a.getElementsByClassName("et-cmd-status-bar")[0];window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width?e&&h&&e.setAttribute("style",""):e&&h&&(e.style.width="".concat(h,"px"),e.style.transform="scale(".concat(l>h?1:l/h,")"),e.style.left="-".concat((h-l)/2,"px"))}));var u=setInterval((function(){var e,i=(0,s.isKdocsDoc)(n)&&a.getElementsByClassName("cmd-status-bar")[0]||a.getElementsByClassName("et-cmd-status-bar")[0];i&&h&&(i.style.width="".concat(h,"px"),i.style.transform="scale(".concat(l>h?1:l/h,")"),i.style.left="-".concat((h-l)/2,"px"),"w"===d&&(null===(e=p.firstChild.contentWindow)||void 0===e||e.APP.workspace.scrollTo({scrollTop:70,scrollLeft:110})),f&&clearTimeout(f),u&&clearInterval(u),f=null,u=null,r&&r(t))}),500),f=setTimeout((function(){u&&clearInterval(u),u=null,f=null,r&&r(t)}),5e3)}else r&&r(t)}catch(t){var g=y(i);k(e,{page:g})}}}},{tag:"div",options:{class:"webshape-iframe-mask",style:"position: absolute; top: 0; left: 0; right: 0;bottom: 0; display: ".concat(h?"none":"block","; cursor: move;")},events:{onmouseup:u,ontouchend:u}}]});return p}(e,t,n,r,(function(){var t=e.children;t.frame_page&&e.removeChild(t.frame_page),document.title=N})),e.appendChild(i)):(i=function(e){var t=f(e),n=v({tag:"div",options:{style:"font-size: 16px"},innerText:_i18n("applications.writer.helpers.webshapeDraw.noNest", "Viewing the preview view is not supported.")});return t.appendChild(n),t}(r),k(e,{page:i}))},S=function(i){if(n.startsWith("http://")){var s=b(r);k(e,{page:s})}else switch(i){case"succeed":switch(I(n).frame_option){case"DENY":O=y(r),k(e,{page:O});break;case"SAMEORIGIN":u(n)===window.top.location.origin?g():(O=y(r),k(e,{page:O}));break;default:g()}break;case"failed":O=b(r),k(e,{page:O});break;case"unauthorized":O=function(e,t,n,i){var r=f(e),o=v({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 8px;"},childList:[{tag:"p",options:{style:"height: 24px; font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.askTrust", "Are you sure you want to trust this web page?")},{tag:"p",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; text-align: center; color: rgba(13, 13, 13, 0.66);"},innerText:"".concat(_i18n("applications.writer.helpers.webshapeDraw.trustInfo", "For the security of your personal information, make sure that the web page can be trusted to prevent security risks:")).concat(t)},{tag:"div",options:{style:"width: 154px; display: flex; flex-direction: row; align-items: center; gap: 8px; height: 32px;"},childList:[{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #F5F7FA; border-radius: 4px; padding: 4px 15px;\n                          line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; \n                          color: rgba(13, 13, 13, 0.9); cursor: pointer;\n                          box-shadow: 0px 0px 0px 1px rgba(13, 13, 13, 0.1), 0px 1px 0px rgba(13, 13, 13, 0.14);"},innerText:a.isMobile||a.isPad?_i18n("applications.writer.helpers.webshapeDraw.cancel", "Cancel"):_i18n("applications.writer.helpers.webshapeDraw.notTrust", "Do Not Trust"),events:{onclick:function(){i&&i()},ontouchend:function(){i&&i()}}},{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #0A6CFF; border-radius: 4px; padding: 4px 15px;\n                          cursor: pointer; line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; color: #FFFFFF;"},innerText:a.isMobile||a.isPad?_i18n("applications.writer.helpers.webshapeDraw.confirm", "OK"):_i18n("applications.writer.helpers.webshapeDraw.trust", "Trust"),events:{onclick:function(){n?n():P(t)},ontouchend:function(){n?n():P(t)}}}]}]});return r.appendChild(o),r}(r,n,o,l),k(e,{page:O});break;default:var d=setTimeout((function(){clearInterval(h),clearTimeout(d),O=m(r,(function(){C(e,t,n,r)})),k(e,{page:O})}),1e4),h=setInterval((function(){var i=I(n);R([n]),i&&(clearInterval(h),clearTimeout(d),C(e,t,n,r))}),1e3);Promise.race([d,h])}},N=document.title,E=function(e){var t=f(e),n=v({tag:"div",options:{style:"display: flex; flex-direction: row; align-items: center; padding: 0px; height: 22px; gap: 4px;"},childList:[{tag:"img",options:{style:"width: 16px; height: 16px;",src:d.default}},{tag:"span",options:{style:"font-size: 14px; font-weight: 400; height: 22px; line-height: 22px; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.contentIsLoading", "Loading the content...")}]});return t.appendChild(n),t}(r),A=p(n,r),O=E;if(e.appendChild(A),e.appendChild(O),T(n)&&!h)h=!0,w([n]).then((function(e){e&&"succeed"===e[0].status?x([n]).then((function(t){t[0]&&(M(i.__assign(i.__assign({},e[0]),t[0])),S(e[0].status)),h=!1})):(S(e&&e[0].status),h=!1)}));else{var L=I(n);S(L&&L.status||"")}}function P(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,window.APP.dispatch((0,s.authorizedUrl)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function S(e,t){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,a;return i.__generator(this,(function(i){return n=e.split("?")[0],r=n.split("/"),o=r[r.length-1],(a=new XMLHttpRequest).open("GET","/api/office/file/"+o),a.send(),a.onload=function(){t(JSON.parse(a.response))},[2]}))}))}function M(e){(null==e?void 0:e.url)&&(c[e.url]=e)}function I(e){return c[e]}function T(e){var t=I(e);return t&&t.status&&"succeed"===t.status&&void 0===t.icon&&void 0!==t.title||!t}function R(e,t){if(!(!1===t||h&&void 0!==t)&&e.length&&window.__CONFIG__.wps.isEnableSwitchToWebshape){h=!0;var n=e.filter((function(e){return"string"==typeof e})),r=n.filter((function(e){return T(e)&&!(0,s.isKdocsDoc)(e)})),o=n.filter((function(e){return T(e)&&(0,s.isKdocsDoc)(e)})),a=r.length+o.length;if(0!==a){var l=0;o.map((function(e){S(e,(function(t){if(null==t?void 0:t.file){var n=t.file.name,i=t.file.office_type,r=i?"https://qn.cache.wpscdn.cn/kdocs/cloud/dotview/favicon/favicon_".concat(i,".png"):"https://www.kdocs.cn/favicon.ico";M({url:e,status:"succeed",title:n,icon:r,id:t.file.id,officeType:i})}else M({url:e,status:"succeed",title:"",icon:""});(l+=1)===a&&(h=!1)}))})),r.length&&w(r).then((function(e){var t=(e||[]).filter((function(e){return"succeed"===e.status})).map((function(e){return e.url}));t.length?x(t).then((function(t){t&&t[0]?r.forEach((function(n){var r=null==e?void 0:e.find((function(e){return e.url===n})),o=null==t?void 0:t.find((function(e){return e.url===n}));M(i.__assign(i.__assign({url:n},r),o)),(l+=1)===a&&(h=!1)})):(r.forEach((function(t){var n=null==e?void 0:e.find((function(e){return e.url===t}));M(i.__assign({url:t},n)),l+=1})),h=!1)})):r.forEach((function(t){M(null==e?void 0:e.find((function(e){return e.url===t}))),(l+=1)===a&&(h=!1)}))}))}else h=!1}}t.urlsStatus=w,t.urlsInfo=x,t.uploadMimeDataImg=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){return[2,window.APP.data.api.postObjectURL().then((function(n){var i=new XMLHttpRequest;i.open("GET",l.default),i.responseType="blob",i.send(),i.onload=function(){var r=t||new Blob([i.response],{type:"image/*"}),o=new FormData;o.append("object",r,t&&t.name||"loading"),window.__WPSENV__.request({method:"POST",url:n,body:o}).end().then((function(t){e&&e(t.body.uploadid)}))}}))]}))}))},t.drawWebshape=C,t.getFileInfo=S,t.elementToSnapshot=function(e){if(!e)throw new Error("can not find element");var t=document.createElement("canvas"),n=t.getContext("2d"),i='data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg">'.concat((new XMLSerializer).serializeToString(e),"</svg>").replace(/\n/g,"").replace(/#/g,"%23"),r=new Image;r.src=i,n.drawImage(r,0,0);for(var o=t.toDataURL("image/png").split(","),a=o[0].match(/:(.*?);/)[1],s=window.atob(o[1]),l=s.length,d=new Uint8Array(l);l--;)d[l]=s.charCodeAt(l);return new File([d],s.slice(0,16)+".png",{type:a})},t.setStageInfo=M,t.getStageInfo=I,t.getEmbedsUrlInfo=function(e){var t=!!e.find((function(e){return e.shape.isWebshape}));R(e.filter((function(e){return e.shape.isWebshape})).map((function(e){return e.shape.webshapeUrl})),t)},t.getAllUrlsInfo=R,t.updateWebshapeByEdit=function(e,t,n){var i=e.getBoundingClientRect();C(e,n,t,i)}},1134:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},r={Shape:function(e){return"s_"+e},BackendShape:function(e){return"backend_s_"+e},Geomerty:function(e){return"s_"+e+"_geomerty"},Media:function(e){return"s_"+e+"_media"},Text:function(e){return"s_"+e+"_text"},TextParagraph:function(e){return"s_"+e+"_textParagraph"},Ink:function(e){return"s_"+e+"_ink"},Table:function(e){return"s_"+e+"_table"},TableCell:function(e){return"s_"+e+"_tableCell"},TableText:function(e){return"s_"+e+"_tableText"},TableBorder:function(e){return"s_"+e+"_tableBorder"},ShapeFill:function(e,t){return"s_"+e+"_shapeFill_"+t},ShapeImage:function(e,t){return"s_"+e+"_image_"+t},ShapeFillPath:function(){return"shape_fill"},ShapeOutlinePath:function(){return"shape_outline"}}},12957:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportReplaceEmoji=void 0;var i="📄";t.supportReplaceEmoji=function(e){return e===i}},12958:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormatContentControlBackground=t.renderReadonlyProtectionBackground=void 0;var i=n(3080),r=n(411),o="editable-area";function a(e){var t=e.ctx,n=e.renderInfo,r=e.color,o=e.textPage,a=n.line,s={pos:n.pos,len:n.len},l=(0,i.getRangesRects)([s],o)[0];if(!l)return null;var d=a.rect.top,h=0,c=-d,_=t.save();function u(e){return e%1<=.75?Math.floor(e):Math.ceil(e)}t.translate(0,u(d));var p=u(l.left+h)+.5,f=u(l.right+h)+.5,g=u(l.top+c)+.5,v=u(l.bottom+c)+.5,m=l.width,y=l.height;t.fillStyle=r.background,t.fillRect(p,g+1,u(m),u(y-2));var b=!1;if(n.hasLeftBracket&&(t.beginPath(),t.moveTo(p+2,g+1),t.lineTo(p,g+1),t.lineTo(p,v-1),t.lineTo(p+2,v-1),b=!0),n.hasRightBracket){var w=s.pos+s.len;n.hasLeftBracket||t.beginPath();var x=0===w?p:f;t.moveTo(x-2,g+1),t.lineTo(x,g+1),t.lineTo(x,v-1),t.lineTo(x-2,v-1),b=!0}if(b){t.strokeStyle=r.bracket;var k=window.devicePixelRatio;t.lineWidth=1/k*Math.round(k),t.stroke()}return t.restore(),{y:a.rect.top,lineRenderInfos:[a.renderInfo],svgNode:_}}function s(e){var t=e.textPage.range,n=[];if(!t)return n;var i,o,a=e.textPage.lines,s=t.pos,l=s+t.len;return e.ranges.forEach((function(e){i=e.pos,(o=i+e.len)<s||i>=l||a.forEach((function(t){if(t.layoutType===r.DOCLayoutType.TextLine){var a=t.range.pos,s=t.range.len+a;o<=a||i>=s||(i>=a&&o<=s?n.push({pos:e.pos,len:e.len,hasLeftBracket:!0,hasRightBracket:!0,line:t}):i<a&&o>s?n.push({pos:a,len:s-a,hasLeftBracket:!1,hasRightBracket:!1,line:t}):i<a&&o<=s?n.push({pos:a,len:o-a,hasLeftBracket:!1,hasRightBracket:!0,line:t}):i>=a&&o>s&&n.push({pos:i,len:s-i,hasLeftBracket:!0,hasRightBracket:!1,line:t}))}}))})),n}function l(){var e=window.APP.restrictEditHandler;return e&&(e.isInReadonlyProtectMode||e.isInCommentProtectMode)?{background:"rgba(170,210,255, 0.5)",bracket:"rgb(47, 85, 151)"}:{background:"rgba(192, 192, 192, 0.5)",bracket:"#000000"}}t.renderReadonlyProtectionBackground=function(e){var t=e.getCtx(o);t.currentNode.setAttribute("shape-rendering","crispEdges");var n=e.textPage.renderInfo.renderUnits[o]||[];s({ranges:e.ranges,textPage:e.textPage}).forEach((function(i){var r=a({ctx:t,textPage:e.textPage,renderInfo:i,color:l()});r&&n.push(r)})),e.textPage.renderInfo.renderUnits[o]=n},t.renderFormatContentControlBackground=function(e){var t=e.getCtx(o);t.currentNode.setAttribute("shape-rendering","crispEdges");var n=e.textPage.renderInfo.renderUnits[o]||[];s({ranges:e.ranges,textPage:e.textPage}).forEach((function(i){var r=a({ctx:t,textPage:e.textPage,renderInfo:i,color:{background:"#AAD2FF",bracket:"#2F5597"}});r&&n.push(r)})),e.textPage.renderInfo.renderUnits[o]=n}},12959:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),r=n(12960),o=i.__importDefault(n(7211)),a=i.__importStar(n(2503)),s=n(4746),l=n(10407),d=n(8844),h=null;t.default=function(e){var t=e.mainPage,n=e.ctx,i=function(e){var t=window.APP.customRenderManager.underline.getRangesByRange(e.range);return(0,s.getRangesInTextPageAndSplitByLine)(t,e)}(t);if(0===i.length)return!1;n.save("custom-underline"),n.translate((0,d.keepDecimal)(t.rect.left,2),(0,d.keepDecimal)(t.rect.top,2));var c=!1;return i.forEach((function(e){c=function(e,t){var n=function(e){var t,n=new o.default,i=e.line,r=e.type,s=e.pos-i.range.pos,l=s+e.len;if(void 0===t){for(var d=i.papx||i.parent.papx,h=i.parent,c=h.textflow;h&&!c;)h=h.parent,c=h.textflow;var _=c?c.corX:"T2B";t=d.vertical_align_mode||("T2B"===_||"B2T"===_?a.middle:a.alphabetic)}return i.glyphGroupInfos.forEach((function(o,a,d){if(!(o.beginOffset>=l||o.endOffset<=s)){var h={y:o.y,scriptPos:o.script_pos,metrics:o.metrics,vertAlignMode:t,underline:1,underlineWidth:1,underlineType:r,underlineColor:e.color,isLast:a===d.length-1},c=o.x,_=o.x+o.widthSum;s>=o.beginOffset&&l<=o.endOffset?(c=u(s),_=u(l),Object.assign(h,{beginPosition:i.range.pos+s,endPosition:i.range.pos+l,x:c,widthSum:_-c})):s<o.beginOffset&&l>o.endOffset?Object.assign(h,{beginPosition:i.range.pos+o.beginOffset,endPosition:i.range.pos+o.endOffset,x:c,widthSum:_-c}):s<o.beginOffset&&l<=o.endOffset?(_=u(l),Object.assign(h,{beginPosition:i.range.pos+o.beginOffset,endPosition:i.range.pos+l,x:c,widthSum:_-c})):s>=o.beginOffset&&l>o.endOffset&&(c=u(s),Object.assign(h,{beginPosition:i.range.pos+s,endPosition:i.range.pos+o.endOffset,x:c,widthSum:_-c})),n.process(h)}function u(e){return o.widths.reduce((function(t,n,i){return i<e-o.beginOffset?t+n:t}),o.x)}})),n.getItems(i)}(e);if(0===n.length)return!1;var i=e.line,s=i.baseline;h&&h===e.color||(t.beginPath(),h=e.color);t.strokeStyle=e.color;var c={x:0,y:0};i.isInTable&&((c=(0,d.getOffsetToHost)(e.textPage)).x+=i.host.rect.left,c.y+=i.host.rect.top);return n.forEach((function(n){var i=n.startX+c.x,o=n.endX+c.x,a=(0,d.keepDecimal)(n.yPos+s+c.y,0);e.type===r.UnderlineType.Wave?(0,l.generatePathForWave)(t,{x:i,y:a},o-i):(t.moveTo(Math.round(i)+1,a),t.lineTo(Math.round(o),a))})),t.lineWidth=1,t.stroke(),!0}(e,n)||c})),n.restore(!1,!c),h=null,c}},12960:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnderlineType=void 0,function(e){e.Straight="Straight",e.Wave="Wave"}(t.UnderlineType||(t.UnderlineType={}))},12961:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3080),r=n(4746),o=n(8844),a=null;t.default=function(e){var t=e.mainPage,n=e.ctx,s=function(e){var t=window.APP.customRenderManager.highlight.getRangesByRange(e.range);return(0,r.getRangesInTextPageAndSplitByLine)(t,e)}(t);if(!s.length)return!1;n.save("custom-highlight"),n.translate(Math.round(t.rect.left),Math.round(t.rect.top));var l=!1;return s.forEach((function(e){l=function(e,t){var n=(0,i.getRangesPath)([t],t.textPage,void 0,void 0,i.USE_HEIGHT_WAY.LINE_TEXT_HEIGHT);if(0===n.length)return!1;var r=t.color;function s(e){return e%1<=.75?Math.floor(e):Math.ceil(e)}a&&a===r||(e.beginPath(),a=r);var l={x:0,y:0};t.line.isInTable&&((l=(0,o.getOffsetToHost)(t.textPage)).x+=t.line.host.rect.left,l.y+=t.line.host.rect.top);return n.forEach((function(t,i){t.forEach((function(t,n){0===n?e.moveTo(s(t.x+l.x),s(t.y+l.y)):e.lineTo(s(t.x+l.x),s(t.y+l.y))})),i===n.length-1&&e.closePath()})),e.fillStyle=r,e.fill(),!0}(n,e)||l})),n.restore(!1,!l),a=null,l}},12962:function(e,t,n){e.exports=function(e,t){n.e(768).then(n.bind(null,15640)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},12963:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getViewPage=void 0,t.getViewPage=function(e){var t=e;return t.isDecorativePage&&(t=t.contentPage),t}},12964:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCAzNiAzNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xOCAzNmM5Ljk0MSAwIDE4LTguMDU5IDE4LTE4UzI3Ljk0MSAwIDE4IDAgMCA4LjA1OSAwIDE4czguMDU5IDE4IDE4IDE4em0wLTJDOS4xNjMgMzQgMiAyNi44MzcgMiAxOFM5LjE2MyAyIDE4IDJzMTYgNy4xNjMgMTYgMTYtNy4xNjMgMTYtMTYgMTZ6IiBmaWxsPSIjRUJFQkVCIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBmaWxsPSIjNDE3RkY5IiBkPSJNMTAgMTBoNnYyaC02em0wIDE0aDZ2MmgtNnptMTAtMTRoNnYyaC02eiIvPjxwYXRoIGZpbGw9IiM0MTdGRjkiIGQ9Ik0xMiAxMHY2aC0ydi02em0wIDEwdjZoLTJ2LTZ6bTE0IDB2NmgtMnYtNnptMC0xMHY2aC0ydi02eiIvPjxwYXRoIGZpbGw9IiM0MTdGRjkiIGQ9Ik0yMCAyNGg2djJoLTZ6Ii8+PC9nPjwvc3ZnPg=="},1530:function(e,t,n){},1569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKdocsDoc=t.getDocInfo=t.authorizedUrl=t.getUrlsInfo=t.getUrlsStatus=void 0;var i=n(5).__importDefault(n(361));t.getUrlsStatus=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/status");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.get(t).query({urls:e.join(",")}).end()}}},t.getUrlsInfo=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/info");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.get(t).query({urls:e.join(",")}).end()}}},t.getDocInfo=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var t=e.split("?")[0].split("/"),n=t[t.length-1],r="/api/office/file/".concat(n);return{types:i.default.HTTP_TYPES,callAPI:function(e){return e.get(r).query({disableSubFileId:!0}).end()}}},t.authorizedUrl=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/authorization");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.post(t).send({url:e}).end()}}},t.isKdocsDoc=function(e){return new RegExp(/(http(s)?:(\/\/)?)?(www.)?kdocs.cn\/(office\/)?([a-z]){1}\/([a-z]|[A-Z]|[\d]){12}/).test(e)}},1570:function(e,t,n){e.exports=n.p+"images/frameLoading.449d1bc4.png"},1571:function(e,t,n){e.exports=n.p+"images/loading.1c6861da.gif"},1699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMeasureCTX=void 0;var i,r=n(676);t.getMeasureCTX=function(){if(!i){var e=(0,r.createElement)({type:"canvas",classname:"measure-canvas",style:{"data-type":"svg-blob",display:"none"},parent:document.body});i=e.getContext("2d")}return i}},2474:function(e,t,n){"use strict";n.r(t),n.d(t,"ExistingFileOrPage",(function(){return i})),n.d(t,"PlaceInDoc",(function(){return r})),n.d(t,"EmailAddress",(function(){return o}));var i=0,r=1,o=2},248:function(e,t,n){"use strict";n.r(t);var i=n(144),r=n.n(i),o=n(1),a=n.n(o),s=n(2),l=n.n(s),d=n(22),h=n.n(d),c=n(23),_=n.n(c),u=(n(724),n(238)),p=n.n(u),f=n(250),g=n.n(f),v=n(284),m=n.n(v),y=n(227),b={},w=function(e){function t(e){a()(this,t);var n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkOnline=function(){if(window.__WPSENV__.store){var e=window.__WPSENV__.store.getState().public.network.connected;n.setState({onLine:e})}},n.handleOnline=n.handleOnline.bind(n),n.state={onLine:window.navigator.onLine},n}return _()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.state.onLine||(this.checkOnline(),window.addEventListener("online",this.handleOnline),window.addEventListener(y.default.names.network.ON_CONNECTED,this.handleOnline))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("online",this.handleOnline),window.removeEventListener(y.default.names.network.ON_CONNECTED,this.handleOnline)}},{key:"handleOnline",value:function(){this.setState({onLine:!0})}},{key:"getTypeName",value:function(e,t,n){var i=this.state.onLine,r="icons-"+t+"-"+n;return window.__WPSENV__.isHybrid?r:e||i||b[r]?(b[r]=!0,r):""}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.className,i=e.title,o=e.role,a=e.onClick,s=e.altScPosition;if(!t)return p.a.createElement("i",{className:"icons "+n});var l=t.split(" "),d=r()(l,3),h=d[0],c=d[1],_=d[2],u="icons icons-"+h;"loading"===(c=c||"")?u+=" icons-loading":u+=" "+this.getTypeName(_,h,c.toLowerCase());return n&&(u+=" "+n),p.a.createElement(g.a,{title:i},p.a.createElement("i",{className:u,onClick:a,role:o,"alt-sc-position":s}))}}]),t}(u.PureComponent);w.types=m.a,t.default=w},250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementType=void 0;var i=n(5),r=i.__importStar(n(238)),o=i.__importDefault(n(244)),a=i.__importStar(n(167)),s=i.__importDefault(n(604)),l=i.__importDefault(n(398)),d=n(426);Object.defineProperty(t,"PlacementType",{enumerable:!0,get:function(){return d.PlacementType}});var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currDom=null,t.position=null,t.handleClose=function(){void 0===t.props.visible&&t.close()},t.handleMouseEnter=function(e){var n=t.props,i=n.title;void 0===n.visible&&i&&!t.position&&t.show(e)},t.handleMouseLeave=function(e){var n=t.props,i=n.title;void 0===n.visible&&i&&t.position&&t.close()},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.currDom=o.default.findDOMNode(this),this.bindEvents()},t.prototype.componentDidUpdate=function(e){if(e!==this.props){var t=o.default.findDOMNode(this);t!==this.currDom&&(this.unbindEvents(),this.currDom=t,this.bindEvents())}var n=this.props,i=n.title,r=n.visible;void 0!==r&&void 0!==e.visible?r?this.show(null):this.close():e.title!==i&&this.position&&(i?this.update():this.close())},t.prototype.componentWillUnmount=function(){this.position&&this.close(),this.unbindEvents()},t.prototype.bindEvents=function(){a.isPad||(this.currDom.addEventListener("mouseenter",this.handleMouseEnter),this.currDom.addEventListener("mouseleave",this.handleMouseLeave))},t.prototype.unbindEvents=function(){this.currDom.removeEventListener("mouseenter",this.handleMouseEnter),this.currDom.removeEventListener("mouseleave",this.handleMouseLeave)},t.prototype.show=function(e){void 0!==this.props.visible&&(e={pageX:0,pageY:0,currentTarget:o.default.findDOMNode(this)});var t=e.currentTarget;void 0===this.props.isMustShowTitle?l.default.isMustShowTitle(t,this.props.title)&&(this.position={x:e.pageX,y:e.pageY},this.update()):this.props.isMustShowTitle&&(this.position={x:e.pageX,y:e.pageY},this.update())},t.prototype.close=function(){this.position=null,this.update()},t.prototype.update=function(){var e=this.props,t=e.title,n=e.visible,i=e.middleShow,r=e.verticalMiddleShow,o=e.placement,a={title:this.position?t:null,element:this.position?this.currDom:null,position:this.position,middleShow:void 0!==n||i,verticalMiddleShow:r,onClose:this.handleClose,placement:o};_(a)},t.prototype.handleEventFromChildrenOrRoot=function(e,t,n){return function(){for(var i,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];e?e.apply(void 0,o):r.default.isValidElement(n)&&n.props[t]&&(i=n.props)[t].apply(i,o)}},t.prototype.render=function(){var e=this.props.children;(0,r.isValidElement)(e)||(e=r.default.createElement("span",null,e));var t={onClick:this.handleEventFromChildrenOrRoot(this.props.onClick,"onClick",e),onMouseEnter:this.handleEventFromChildrenOrRoot(this.props.onMouseEnter,"onMouseEnter",e),onMouseLeave:this.handleEventFromChildrenOrRoot(this.props.onMouseLeave,"onMouseLeave",e)};return r.default.cloneElement(e,t)},t.defaultProps={placement:d.PlacementType.topBottom},t}(r.PureComponent);t.default=h;var c=null,_=function(e){var t;c||((t=document.createElement("div")).className="wowui-tooltip",document.body.appendChild(t),c=t),o.default.render(r.default.createElement(s.default,i.__assign({},e)),c)}},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(691),l=n(1290),d=n(2474),h=n(309),c=n(2701),_=n(1090),u=n(324),p=[h.Comment,h.MainText],f=[h.Comment,h.MainText,h.HeaderFooter,h.Textbox,h.TextboxInHF],g=["http://","https://","mailto:","ftp://"],v=function(){function e(t,n,i){r()(this,e),this.data=t,this.field=n,Object(_.getAllUrlsInfo)([this.getAddress()]),this.curPos=i||-1}return a()(e,[{key:"isEmailAddress",value:function(e){return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)}},{key:"isKWProtocolAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:(mention|link|filelink)\S+/.test(e)}},{key:"isMentionAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:mention\S+/.test(e)}},{key:"isFileLinkAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:filelink\S+/.test(e)}},{key:"isLegalURL",value:function(e){if(!e)return!1;var t=e.toLowerCase();return g.some((function(e){return 0===t.indexOf(e)&&t.length>e.length}))}},{key:"isEmbHyperLink",value:function(){for(var e=this.data.doc.getText(this.field.begin,this.field.len),t=0,n=0;n<e.length;n++){if(t>1)return!0;e.charCodeAt(n)==u.n&&(t+=1)}return!1}},{key:"getEmbHyperLink",value:function(e,t,n){for(var i=n,r={rg:[],code:""},o=0,a=i;a<t.length;){if(t.charCodeAt(a)===u.n&&(i=a,o>0&&(r.rg.push({begin:o+1,end:i}),o=(a=this.getEmbHyperLink(e,t,i))-1)),t.charCodeAt(a)===u.p&&(o=a,r.code=t.slice(i+1,o)),t.charCodeAt(a)===u.o)return r.rg.push({begin:o+1,end:a}),e.push(r),a+1;a++}}},{key:"getHyperLinkCode",value:function(e){if(!this.isEmbHyperLink()){var t=this.field.begin+1,n=this.field.sepDistance-2;return this.data.doc.getText(t,n)}var i=this.data.doc.getText(this.field.begin,this.field.len),r=[];this.getEmbHyperLink(r,i,0),this.curPos<0&&(this.curPos=this.data.selection.begin.position),void 0!==e&&(this.curPos=e);for(var o=this.curPos-this.field.begin,a=0;a<r.length;a++)for(var s=r[a],l=0;l<s.rg.length;l++){var d=s.rg[l];if(d.begin<=o&&d.end>o)return s.code}return r[r.length-1].code}},{key:"getAddress",value:function(e){var t=this.getHyperLinkCode(e),n=new c.a;return n.parse(t),0!==n.params.length?n.params[0].url:null}},{key:"getKWProtocolParams",value:function(){var e={},t=this.getAddress();if(this.isKWProtocolAddress(t)){var n=t.indexOf("?");-1!==n&&(e=Object(l.toParams)(t.slice(n+1))),e.extraAttrs&&(e.extraAttrs=decodeURIComponent(window.atob(e.extraAttrs)))}return e}},{key:"getPositionExist",value:function(){var e=this.field.begin+1,t=this.field.sepDistance-2,n=this.data.doc.getText(e,t),i=Object(l.parseFieldCode)(n);if(!i.switchs.l)return!1;var r=i.switchs.l,o=this.data.doc.bookmarks.map[r];if("_top"===r||o){var a=o.pos,s=this.data.doc.getSubDocType(a);return!!(window.APP.isPaginationMode()&&f.indexOf(s)>=0||window.APP.isMobileMode()&&p.indexOf(s)>=0)}return!1}},{key:"getType",value:function(){var e=this.field.begin+1,t=this.field.sepDistance-2,n=this.data.doc.getText(e,t),i=Object(l.parseFieldCode)(n);return 0!==i.params.length?0===i.params[0].indexOf("mailto:")?d.EmailAddress:d.ExistingFileOrPage:i.switchs.l?d.PlaceInDoc:d.ExistingFileOrPage}},{key:"getDisplayText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=void 0,n=void 0,i=this.data.selection.selAreas.activeArea.getNormalRanges(),r=i[0];if(r.pos>i[i.length-1].pos?(t=i[i.length-1].pos,n=i[0].pos+i[0].len):(t=i[0].pos,n=i[i.length-1].pos+i[i.length-1].len),t<this.field.begin&&n>=this.field.end)return this.data.selection.selInfo.getDisplayText(e);var o=this.getResult();if(o)for(var a=0;a<o.length;++a){var l=o.charCodeAt(a);if(Object(s.isSpecialPlaceholder)(l)||Object(s.isFieldPlaceholder)(l))return e&&(e.hasSpecialHolder=!0),_i18n("applications.writer.components.core.shell.model.doc.hyperLink.chose", "<<Selected content in document>>")}return o}},{key:"getResult",value:function(){var e=this.field.sep+1,t=this.field.end;if(t>e)return this.data.doc.getText(e,t-e-1)}}]),e}()},2807:function(e,t,n){"use strict";var i=n(167),r="webOffice_",o="position: fixed; left: 0; top: 0; z-index: -1; display: none;",a=function(e,t){var n=new FileReader;n.onload=function(e){var n=new DataView(e.target.result);if(65496!==n.getUint16(0,!1))return t(-2);for(var i=n.byteLength,r=2;r<i;){if(n.getUint16(r+2,!1)<=8)return t(-1);var o=n.getUint16(r,!1);if(r+=2,65505===o){if(1165519206!==n.getUint32(r+=2,!1))return t(-1);var a=18761===n.getUint16(r+=6,!1);r+=n.getUint32(r+4,a);var s=n.getUint16(r,a);r+=2;for(var l=0;l<s;l++)if(274===n.getUint16(r+12*l,a))return t(n.getUint16(r+12*l+8,a))}else{if(65280!=(65280&o))break;r+=n.getUint16(r,!1)}}return t(-1)},n.readAsArrayBuffer(e)};t.a={localDownload:function(e){var t=e.href,n=e.name;if(t){var i=(void 0===n?r:n)+(new Date).getTime(),a=document.createElement("a");if("download"in a){a.setAttribute("download",i+".png"),a.href=t;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),a.dispatchEvent(s),s=null}else{var l=document.createElement("iframe");l.setAttribute("style",o),l.setAttribute("name",i),document.body.appendChild(l),window.frames[i].document.execCommand("SaveAs"),document.body.removeChild(l)}}else console.warn("pulic/**/imageEdit.js; the 'href' of option is empty.")},getPictureOrientation:a,imageWithRotation:function(e,t,n){a(e,(function(e){var i=Math.min(2*window.screen.width/t.width,1),r=t.width*i,o=t.height*i,a=document.createElement("canvas"),s=a.getContext("2d");switch(a.width=r,a.height=o,e){case 6:a.height=r,a.width=o,s.rotate(Math.PI/2),s.translate(0,-o);break;case 3:s.rotate(Math.PI),s.translate(-r,-o);break;case 8:a.height=r,a.width=o,s.rotate(-Math.PI/2),s.translate(-o,0)}s.scale(i,i),s.drawImage(t,0,0);var l=a.toDataURL("Image/jpeg",1);n&&n(l)}))},imagePreview:function(e,t){var n=[],i={info:{}},r=void 0;return"image/jpg"!==e.type&&"image/jpeg"!==e.type||(r=new Promise((function(t,n){var r=new FileReader;r.onload=function(e){Object.assign(i.info,function(e){var t={},n=new DataView(e);if(255!==n.getUint8(0)||216!==n.getUint8(1))return t;var i=2,r=function(){if(255!==n.getUint8(i))return"break";if(225!==n.getUint8(i+1))return i+=2+n.getUint16(i+2),"continue";var e=i+4;if(1165519206!==n.getUint32(e,!1))return"break";var r=void 0,o=e+6;if(18761===n.getUint16(o))r=!1;else{if(19789!==n.getUint16(o))return"break";r=!0}if(42!==n.getUint16(o+2,!r))return"break";var a=n.getUint32(o+4,!r);if(a<8)return"break";var s=-1,l=function(e,i){for(var o=n.getUint16(i,!r),a=0;a<o;a++){var l=i+12*a+2,d=n.getUint16(l,!r);274===d?t.orientation=n.getUint16(l+8,!r):256===d||40962===d?t.width=n.getUint32(l+8,!r):257===d||40963===d?t.height=n.getUint32(l+8,!r):34665===d&&(s=n.getUint32(l+8,!r))}};return l(0,o+a),s>0&&l(0,o+s),"break"};e:for(;i<e.byteLength;){switch(r()){case"break":break e;case"continue":continue}}return t}(e.target.result)),t(i)},r.readAsArrayBuffer(e)})),n.push(r)),r=new Promise((function(t,n){var r=new Image;r.onload=function(){Object.assign(i.info,{width:r.width,height:r.height}),window.URL.revokeObjectURL(r.src),t(i)},r.onerror=function(){},r.src=window.URL.createObjectURL(e)})),n.push(r),r=new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){i.url=r.result,t(i)}})),n.push(r),Promise.all(n).then((function(){t&&t(i)}))},imageTransform:function(e,t){var n=e.width,r=e.height,o=e.orientation,a={width:n,height:r,transform:""};(Math.abs(n-t.width)>1||Math.abs(r-t.height)>1)&&(a.transform="scale("+t.width/n+", "+t.height/r+")");var s=i.isMobileIos&&i.iosVersion<13;if(i.isIE||i.isQQBrowser||i.isWps2019||i.isPCWxMiniProgram||i.isAndroid&&(i.isMobileQQBrowser||i.isInQQMiniProgram||i.isInWeixin||i.isInWxMiniProgram)||s&&(i.isMobileQQBrowser||i.isInQQMiniProgram||i.isInWeixin||i.isInWxMiniProgram||i.isWpsClient||i.isSafari)){var l=function(e){return Math.round(1e5*e)/1e5};switch(o){case 3:a.transform="scale("+l(t.height/r)+" "+l(t.width/n)+") rotate(180) translate(-"+n+" -"+r+")",a.rotate=!0;break;case 6:a.transform="scale("+l(t.height/n)+" "+l(t.width/r)+") rotate(90) translate(0 -"+r+")",a.rotate=!0;break;case 8:a.transform="scale("+l(t.height/n)+" "+l(t.width/r)+") rotate(-90) translate(-"+n+" 0)",a.rotate=!0}}else switch(o){case 6:case 8:a.width=r,a.height=n,(Math.abs(a.width-t.width)>1||Math.abs(a.height-t.height)>1)&&(a.transform="scale("+t.width/a.width+", "+t.height/a.height+")")}return a}}},284:function(e,t){e.exports={size16:{ai_logo:"16 ai_logo",back_normal:"16 back_normal 1",network_normal:"16 network_normal 1",network_slow:"16 network_slow 1",network_offline:"16 network_offline 1",topbar_more:"16 topbar_more 1",minus:"16 minus 1",add:"16 add 1",full_screen:"16 full_screen 1",format_painter:"16 format_painter 1",view_zoom_best:"16 View_Best 1",structure:"16 structure 1",helper:"16 helper 1",more_horiz:"16 more_horiz 1",more_vertical:"16 more_vertical 1",close:"16 close 1",share_file:"16 share_file 1",share_cooperation:"16 share_cooperation 1",undo:"16 undo 1",redo:"16 redo 1",clear_formats:"16 clear_formats 1",font_size_add:"16 font_size_add 1",font_size_minus:"16 font_size_minus 1",font_bold:"16 font_bold 1",font_italic:"16 font_italic 1",font_underline:"16 font_underline 1",font_del_line:"16 font_del_line 1",font_color:"16 font_color 1",align_left:"16 align_left 1",align_horiz:"16 align_horiz 1",align_right:"16 align_right 1",align_vertical:"16 align_vertical 1",sheet_sort_ascending:"16 sort_ascending 1",picture:"16 picture 1",find:"16 find 1",border_all:"16 border_all 1",img_checked:"16 img_checked",db_add:"16 db_add 1",db_kanban_view:"16 db_kanban_view 1",db_grid_view:"16 db_grid_view 1",db_gallery_view:"16 db_gallery_view 1",db_form_view:"16 db_form_view 1",db_form_view_unactived:"16 db_form_view_unactived 1",db_gantt_view:"16 db_gantt_view 1",db_query_view:"16 db_query_view 1",db_row_height:"16 db_row_height 1",db_group:"16 db_group 1",db_group_expand:"16 db_group_expand 1",db_group_collapse:"16 db_group_collapse 1",db_card_style:"16 db_card_style 1",db_field_manage:"16 db_field_manage 1",db_filter:"16 db_filter 1",db_ungroup_first:"16 db_ungroup_first 1",db_ungroup_last:"16 db_ungroup_last 1",db_create_from_et:"16 db_create_from_et 1",db_create_from_template:"16 db_create_from_template 1",db_create_blank:"16 db_create_blank 1",db_add_dashboard:"16 db_add_dashboard 1",db_fp_create_blank:"16 db_fp_create_blank 1",db_sheet_menu:"16 db_sheet_menu 1",db_arrow_down:"16 db_arrow_down",db_arrow_up:"16 db_arrow_up",db_arrow_down_fill:"16 db_arrow_down_fill",db_arrow_right_fill:"16 db_arrow_right_fill",db_view_fold:"16 db_view_fold 1",db_view_unfold:"16 db_view_unfold 1",db_generate_form:"16 db_generate_form",db_form_field_edit:"16 db_form_field_edit",db_form_clean:"16 db_form_clean",db_single_default:"16 db_single_default",db_single_default_selected:"16 db_single_default_selected",db_fav_default:"16 db_fav_default 1",db_fav_selected:"16 db_fav_selected 1",db_personal_view:"16 db_personal_view",db_view_more:"16 db_view_more",db_tool_notice:"16 db_tool_notice",db_editable_field_config:"16 db_editable_field_config",db_clear:"16 db_clear",db_field_readonly:"16 db_field_readonly",k_merge_new:"16 k_merge_new",k_merge_modify:"16 k_merge_modify",k_cell_origin_image:"16 k_cell_origin_image",k_expand_merge_cell:"16 k_expand_merge_cell",k_air_script:"16 k_air_script",line_spacing:"16 increase_spacing 1",align_decentralized:"16 decentralized_alignment 1",increase_indentation:"16 increase_indentation 1",reduce_indentation:"16 reduce_indentation 1",numbering:"16 numbeing 1",bullet:"16 bullet 1",font_highlight:"16 font_highlight 1",wordtool:"16 wordtool 1",font_attr:"16 font_attr 1",insert_panel:"16 insert_panel 1",align_both:"16 alignment7 1",web_mode:"16 web_mode 1",show_paramark:"16 show_paramark 1",wps_structure:"16 wps_structure 1",wps_web_mode:"16 wps_web_mode 1",slide:"16 slide 1",insert_panel_geomerty:"16 insert_panel_geomerty 1",play_from_active:"16 play_from_active 1",highlight_play:"16 highlight_play 1",otl_highlight_play:"16 otl_highlight_play 1",hidden_taskbar:"16 hidden_taskbar",hover_hidden_taskbar:"16 hover_hidden_taskbar",show_taskbar:"16 show_taskbar",hover_show_taskbar:"16 hover_show_taskbar",comment_reply:"16 comment_reply",comment_at:"16 comment_at",comment_more:"16 comment_more",statusbar_keyboard:"16 statusbar_keyboard",pdf_first_page:"16 pdf_first_page 1",pdf_last_page:"16 pdf_last_page 1",pdf_next_page:"16 pdf_next_page 1",pdf_prev_page:"16 pdf_prev_page 1",pdf_converter:"16 pdf_converter 1",pdf_drag_mode:"16 pdf_drag_mode 1",pdf_go_to:"16 pdf_go_to 1",pdf_multi_page:"16 pdf_multi_page 1",pdf_background:"16 pdf_background 1",pdf_eye:"16 pdf_eye 1",pdf_rotate_page:"16 pdf_rotate_page 1",pdf_auto_scroll:"16 pdf_auto_scroll 1",pdf_highlight:"16 pdf_highlight 1",pdf_underline:"16 pdf_underline 1",pdf_strikeout:"16 pdf_strikeout 1",pdf_eraser:"16 pdf_eraser 1",pdf_page_first:"16 pdf_page_first 1",pdf_page_last:"16 pdf_page_last 1",pdf_page_prev:"16 pdf_page_prev 1",pdf_page_next:"16 pdf_page_next 1",pdf_catalog:"16 pdf_catalog 1",left_side_bar:"16 left_side_bar 1",right_side_bar:"16 right_side_bar 1",pdf_full_size_zoom:"16 pdf_full_size_zoom 1",pdf_adapt_zoom:"16 pdf_adapt_zoom 1",pdf_view_zoom_best:"16 pdf_view_best 1",pdf_page_width_zoom:"16 pdf_page_width_zoom 1",pdf_normal_pen:"16 pdf_normal_pen",pdf_more_color:"16 pdf_more_color",pdf_play:"16 pdf_play 1",todo_list:"16 todo_list 1",otl_inline_code:"16 otl_inline_code 1",otl_cover_pic_loading:"16 otl_cover_pic_loading 1",merge_new:"16 merge_new",merge_modify:"16 merge_modify",merge_warn:"16 merge_warn",merge_select:"16 merge_select",merge_refresh:"16 merge_refresh",merge_info:"16 merge_info",merge_last_stamp:"16 merge_last_stamp",processon:"16 processon",full_screen2:"16 full_screen2",insert_symbol:"16 insert_symbol",validation_list:"16 validation_list",new_validation_list:"16 new_validation_list",new_validation_list_delete:"16 new_validation_list_delete",hyper_link:"16 hyper_link",func_logical:"16 func_logical",func_info:"16 func_info",insert_left_col:"16 insert_left_col",insert_right_col:"16 insert_right_col",copy:"16 copy",exit_full_screen:"16 exit_full_screen",exit_full_screen2:"16 exit_full_screen2",text_box_horizontal:"16 text_box_horizontal",text_box_vertical:"16 text_box_vertical",inc_indent:"16 increase_indent",dec_indent:"16 decrease_indent",hide_slide:"16 hide_slide",wpp_export_pdf:"16 wpp_export_pdf",laserpen:"16 laserpen",processon_edit:"16 processon_edit",check_origin_pic:"16 check_origin_pic",set_to_bg:"16 set_to_bg",play_from_start:"16 play_from_start",hide_slide_icon:"16 hide_slide_icon",coop_num:"16 coop_num",play_from_meeting:"16 play_from_meeting",mark:"16 mark",wpp_brush_format:"16 wpp_brush_format",wpp_brush_position:"16 wpp_brush_position",wpp_brush_animation:"16 wpp_brush_animation",wpp_object_tile_top:"16 wpp_object_tile_top",wpp_object_tile_right:"16 wpp_object_tile_right",wpp_object_tile_bottom:"16 wpp_object_tile_bottom",wpp_object_tile_left:"16 wpp_object_tile_left",wpp_object_tile_center:"16 wpp_object_tile_center",wpp_object_tile_ver_average:"16 wpp_object_tile_ver_average",wpp_object_tile_ver_center:"16 wpp_object_tile_ver_center",wpp_object_tile_hor_average:"16 wpp_object_tile_hor_average",wpp_object_tile_hor_center:"16 wpp_object_tile_hor_center",wpp_object_tile_consider_slide:"16 wpp_object_tile_consider_slide",wpp_object_rotate:"16 wpp_object_rotate",wpp_object_rotate_90left:"16 wpp_object_rotate_90left",wpp_object_rotate_90right:"16 wpp_object_rotate_90right",wpp_object_rotate_some:"16 wpp_object_rotate_some",wpp_object_rotate_hor:"16 wpp_object_rotate_hor",wpp_object_rotate_ver:"16 wpp_object_rotate_ver",wpp_object_rotate_reset:"16 wpp_object_rotate_reset",wpp_shape_ungroup:"16 wpp_shape_ungroup",anime_exit:"16 anime_exit",anime_emphasis:"16 anime_emphasis",anime_entrance:"16 anime_entrance",anime_path:"16 anime_path",anime_media:"16 anime_media",docer_icons:"16 docer_icons",backward_arrow:"16 backward_arrow",replace_picture:"16 replace_picture",download_picture:"16 download_picture",matting_picture:"16 matting_picture",adjust_layer:"16 adjust_layer",layer_front:"16 layer_front",layer_back:"16 layer_back",layer_forward:"16 layer_forward",layer_backward:"16 layer_backward",wpp_image_clip:"16 wpp_image_clip",wpp_clip_list:"16 wpp_clip_list",wpp_clip_cancel:"16 wpp_clip_cancel",wpp_shape_1to1:"16 wpp_shape_1to1",wpp_shape_4to3:"16 wpp_shape_4to3",wpp_shape_16to9:"16 wpp_shape_16to9",wpp_shape_bigger:"16 wpp_shape_bigger",wpp_shape_lower:"16 wpp_shape_lower",wpp_shape_roundRectangle:"16 wpp_shape_roundRectangle",wpp_shape_ellipse:"16 wpp_shape_ellipse",wpp_shape_flowChartDelay:"16 wpp_shape_flowChartDelay",wpp_shape_diamond:"16 wpp_shape_diamond",wpp_shape_heart:"16 wpp_shape_heart",wpp_shape_parallelogram:"16 wpp_shape_parallelogram",wpp_shape_pentagon:"16 wpp_shape_pentagon",wpp_shape_star5:"16 wpp_shape_star5",wpp_shape_rightTriangle:"16 wpp_shape_rightTriangle",wpp_shape_trapezoid:"16 wpp_shape_trapezoid",wpp_ipad_select_text_all:"16 wpp_ipad_select_text_all",wpp_autofit_format:"16 wpp_autofit_format",wpp_import_loading:"16 wpp_import_loading",warn_tip:"16 warn_tip",wpp_explain_replay:"16 wpp_explain_replay",wpp_explain_zan_empty:"16 wpp_explain_zan_empty",wpp_explain_zan_lighten:"16 wpp_explain_zan_lighten",wpp_reading_order_ltr:"16 wpp_reading_order_ltr",wpp_reading_order_rtl:"16 wpp_reading_order_rtl",pdf_anno_color_selected:"16 pdf_anno_color_selected",pdf_text_mode:"16 pdf_text_mode",pdf_background_default:"16 pdf_background_default 1",pdf_background_dark:"16 pdf_background_dark 1",pdf_background_sheep:"16 pdf_background_sheep 1",pdf_background_eyes:"16 pdf_background_eyes 1",pdf_anno_list:"16 pdf_anno_list 1",pdf_anno_list_right:"16 comment_count",pdf_anno_list_text:"16 pdf_anno_list_text",pdf_anno_list_filter:"16 pdf_anno_list_filter",pdf_anno_list_filter_selected:"16 pdf_anno_list_filter_selected",pdf_anno_list_voice:"16 pdf_anno_list_voice",pdf_start:"16 pdf_start",pdf_pause:"16 pdf_pause",pdf_stop:"16 pdf_stop",font_color2:"16 font_color2",fill_color2:"16 fill_color2",fill_color:"16 fill_color",merge_cancel_cell:"16 merge_cancel_cell",add_lines:"16 add_lines",delete_lines:"16 delete_lines",border_empty:"16 border_empty",border_external:"16 border_external",border_bold:"16 border_bold",border_bottom:"16 border_bottom",border_top:"16 border_top",border_left:"16 border_left",border_right:"16 border_right",border_color:"16 border_color",comment_add:"16 comment_add",delete:"16 delete",comment_next:"16 comment_next",comment_prev:"16 comment_prev",sub_script:"16 subscript",super_script:"16 superscript",format_eraser:"16 format_eraser",insert_date_time:"16 insert_date_time",insert_panel_seperatorline:"16 insert_panel_seperatorline",insert_panel_page:"16 insert_panel_page",insert_panel_table:"16 insert_panel_table",insert_panel_hyperlink:"16 insert_panel_hyperlink",insert_panel_picture:"16 insert_panel_picture",revision:"16 revision",align_left_selected:"16 alignment4_white",align_horiz_selected:"16 alignment5_white",align_right_selected:"16 alignment6_white",align_both_selected:"16 alignment7_white",align_decentralized_selected:"16 decentralized_alignment_white",align_fill:"16 alignment_fill",align_fill_selected:"16 alignment_fill_white",align_cas:"16 alignment_cas",align_cas_white:"16 alignment_cas_white",font_bold_selected:"16 Bold_white",font_italic_selected:"16 Italic_white",font_del_line_selected:"16 Deleting_line_white",super_script_selected:"16 superscript_white",sub_script_selected:"16 subscript_white",font_del_doubleline:"16 Deleting_doubleline",font_focus_upper:"16 focus_upper",font_focus_lower:"16 focus_lower",wps_title_style:"16 wps_title_style",wps_fill_color:"16 wps_fill_color",wps_border_all:"16 wps_border_all",wps_border_empty:"16 wps_border_empty",wps_border_external:"16 wps_border_external",wps_table_align_left:"16 wps_table_align_left",wps_table_align_horiz:"16 wps_table_align_horiz",wps_table_align_right:"16 wps_table_align_right",font_del_doubleline_selected:"16 Deleting_doubleline_white",font_focus_upper_selected:"16 focus_upper_white",font_focus_lower_selected:"16 focus_lower_white",select_black:"16 Select_black",select_white:"16 Select_white",color_empty:"16 Unfilled_color",wpp_color_empty:"16 wpp_color_empty",setting:"16 setting",k_setting:"16 k_setting",ksheet_setting:"16 ksheet_setting",setting_white:"16 setting_white",replace:"16 replace",add_blue:"16 add_blue",switch_menu:"16 switch",close_white:"16 close_white",close_red:"16 close_red",delete_column:"16 delete_column",delete_row:"16 delete_row",delete_leftmove:"16 delete_leftmove",delete_moveup:"16 delete_moveup",delete_worksheet:"16 delete_worksheet",insert_column:"16 insert_column",insert_row:"16 insert_row",mention:"16 mention 1",cooper_version_view:"16 version_view",cooper_history_reduction:"16 reduction",cooper_history_filter:"16 cooper_history_filter",cooper_history_down:"16 array_down",cooper_history_up:"16 array_up",filter_number:"16 filter_number",filter_below_average:"16 filter_below_average",filter_above_average:"16 filter_above_average",back:"16 back",search:"16 search_icon",search_menu:"16 search_menu",download:"16 download",password_hide:"16 code_hide",password_show:"16 code_show",share_contact:"16 contact",share_scan:"16 scan",sheet_sort_descending:"16 sort_descending",sheet_sort_custom:"16 sheet_sort_custom",version_restore:"16 restore",frozen_row:"16 frozen_row",frozen_col:"16 frozen_col",frozen_cancel:"16 frozen_cancel",vertical_more:"16 vertical_more",notice_warn:"16 notice_warn",notice_info:"16 notice_info",wpp_remark:"16 wpp_remark",insert_hyper_links:"16 insert_hyper_links",insert_picture:"16 insert_picture",insert_cell_picture_cloud:"16 insert_cell_picture_cloud",insert_signature:"16 insert_signature",paper_horizontal_direct:"16 paper_horizontal_direct",paper_vertical_direct:"16 paper_vertical_direct",report:"16 report",wordtool1:"16 wordtool1",wordtool2:"16 wordtool2",wordtool3:"16 wordtool3",wordtool4:"16 wordtool4",wordtool5:"16 wordtool5",wordtool6:"16 wordtool6",wordtool7:"16 wordtool7",wordtool8:"16 wordtool8",wordtool9:"16 wordtool9",wordtool10:"16 wordtool10",wordtool11:"16 wordtool11",wps_title_style_1:"16 wps_title_style_1",wps_title_style_2:"16 wps_title_style_2",wps_title_style_3:"16 wps_title_style_3",wps_title_style_4:"16 wps_title_style_4",wps_title_style_5:"16 wps_title_style_5",wps_title_style_6:"16 wps_title_style_6",wps_title_style_7:"16 wps_title_style_7",wps_title_style_8:"16 wps_title_style_8",wps_title_style_9:"16 wps_title_style_9",wps_official_document:"16 wps_official_document",wps_more_btn:"16 wps_more_btn",wps_comment_share:"16 wps_comment_share",wps_comment_praise:"16 wps_comment_praise",wps_comment_filter:"16 wps_comment_filter",wps_comment_filter_selected:"16 wps_comment_filter_selected",wps_catalog_arrow:"16 wps_catalog_arrow",wps_close:"16 wps_close",wps_switch_to_webshape:"16 wps_switch_to_webshape",wps_copy_link:"16 wps_copy_link",wps_edit_link:"16 wps_edit_link",wps_cancel_link:"16 wps_cancel_link",wps_jump_link:"16 wps_jump_link",wps_switch_to_hyperlink:"16 wps_switch_to_hyperlink",wps_webshape_add_comment:"16 wps_webshape_add_comment",insert_panel_codeblock:"16 insert_panel_codeblock",insert_panel_footer:"16 insert_panel_footer",insert_panel_reference:"16 insert_panel_reference",insert_panel_bookmark:"16 insert_panel_bookmark",header_footer_setting:"16 header_footer_setting",page_number:"16 page_number",paragraph_setting:"16 paragraph_setting",close_paragraph_setting:"16 close_paragraph_setting",watermark_edit:"16 insert_panel_watermark",watermark_delete:"16 watermark_delete",watermark_more:"16 watermark_more",page_break:"16 page_break",line_break:"16 line_break",column_break:"16 column_break",section_break_continue:"16 section_break_continue",section_break_next_page:"16 section_break_next_page",section_break_odd:"16 section_break_odd",section_break_even:"16 section_break_even",export_img:"16 export_img",export_img_new:"16 export_img_new",export_pdf:"16 export_pdf",export_pdf_new:"16 export_pdf_new",page_margin:"16 page_margin",paper_direct:"16 paper_direct",wps_paper_size:"16 wps_paper_size",wps_custom_checkbox:"16 wps_custom_checkbox",trash:"16 trash",del_red:"16 del_red",print_wait:"16 print_wait",slide_copy:"16 slide_copy",slide_cut:"16 slide_cut",slide_new_ppt:"16 slide_new_ppt",slide_delete_ppt:"16 slide_delete_ppt",slide_new_section:"16 slide_new_section",slide_paste:"16 slide_paste",slide_paste_pic:"16 slide_paste_pic",slide_paste_select:"16 slide_paste_select",et_error_tips:"16 et_error_tips",remove_highlight:"16 remove_highlight",picture_edit:"16 picture_edit",processon_close:"16 processon-close",image_loading:"16 image_loading",image_loading_circle_white:"16 image_loading_circle_white",approval:"16 approval",page_setting:"16 page_setting",enter_header_footer:"16 enter_header_footer",exit_header_footer:"16 exit_header_footer",enter_line_numbering:"16 enter_line_numbering",highlight_cooperation:"16 highlight_cooperation",insert_comment:"16 insert_comment",display_comment:"16 display_comment",font_decorate:"16 font_decorate",arrow_left:"16 arrow_left",arrow_right:"16 arrow_right",single_arrow_left:"16 single_arrow_left",double_arrow_left:"16 double_arrow_left",notice_ok_normal:"16 notice_ok_normal",k_notice_ok_normal:"16 k_notice_ok_normal",border_inside_horz:"16 InsideHorz_frameline",border_inside_vert:"16 InsideVert_frameline",border_diag_down:"16 DiagDown_frameline",border_diag_up:"16 DiagUp_frameline",revision_submit:"16 revision_submit",revision_cancel:"16 revision_cancel",revision_history_prev:"16 revision_history_prev",revision_history_next:"16 revision_history_next",mind_map:"16 mind_map",flow_chart:"16 flow_chart",text_control_entry:"16 text_control_entry",revision_modify:"16 revision_modify",restrict_edit:"16 restrict_edit",docer_vip_label:"16 docer_vip_label",arrow_up:"16 arrow_up 1",arrow_down:"16 arrow_down 1",arrow_first:"16 arrow_first 1",arrow_end:"16 arrow_end 1",specify_page:"16 specify_page",play_auto:"16 play_auto",play_autostop:"16 play_autostop",showmore_close:"16 showmore_close",showmore_open:"16 showmore_open",et_full_screen:"16 et_full_screen",plugin_center_icon:"16 plugin_center_icon",help_question_mark:"16 help_question_mark",info:"16 info",usinghelp:"16 usinghelp",feedback:"16 feedback",bulb:"16 bulb",tips:"16 tips",float_cancel:"16 float_cancel",float_ok:"16 float_ok",logo:"16 logo",warning:"16 warning",warning_red:"16 warning_red",fmt_delete:"16 fmt_delete",number_custom:"16 number_custom",cell_history:"16 cell_history",name_del:"16 name_del",taskpanel_bookmark_pos:"16 taskpanel_bookmark_pos",selective_paste:"16 selective_paste",selective_paste_preserve:"16 selective_paste_preserve",selective_paste_match:"16 selective_paste_match",selective_paste_text_only:"16 selective_paste_text_only",selective_paste_wpp:"16 selective_paste_wpp",insert_audio:"16 insert_audio",insert_video:"16 insert_video",icon_selected:"16 icon_selected",setting_open:"16 setting_open",setting_close:"16 setting_close",interline:"16 interline",filename:"16 filename",revision_question_mark:"16 revision_question_mark",revision_status_setting:"16 revision_status_setting",dv_date:"16 dv_date",dv_time:"16 dv_time",dv_clear_col:"16 dv_clear_col",checkbox_true:"16 checkbox_true",checkbox_false:"16 checkbox_false",et_checkbox_true:"16 et_checkbox_true",et_export_db:"16 et_export_db",db_type_single_text:"16 db_type_single_text",db_type_single_text_small:"16 db_type_single_text_small",db_type_multi_text:"16 db_type_multi_text",db_type_multi_text_small:"16 db_type_multi_text_small",db_type_date:"16 db_type_date",db_type_date_small:"16 db_type_date_small",db_type_time:"16 db_type_time",db_type_time_small:"16 db_type_time_small",db_type_number:"16 db_type_number",db_type_number_small:"16 db_type_number_small",db_type_currency:"16 db_type_currency",db_type_currency_small:"16 db_type_currency_small",db_type_percentage:"16 db_type_percentage",db_type_percentage_small:"16 db_type_percentage_small",db_type_id:"16 db_type_id",db_type_id_small:"16 db_type_id_small",db_type_phone:"16 db_type_phone",db_type_phone_small:"16 db_type_phone_small",db_type_email:"16 db_type_email",db_type_email_small:"16 db_type_email_small",db_type_hyperlink:"16 db_type_link",db_type_hyperlink_small:"16 db_type_link_small",db_type_checkbox:"16 db_type_checkbox",db_type_checkbox_small:"16 db_type_checkbox_small",db_type_checkbox_false:"16 db_type_checkbox_false",db_checkbox_true:"16 db_checkbox_true",db_checkbox_false:"16 db_checkbox_false",db_type_single:"16 db_type_single",db_type_single_small:"16 db_type_single_small",db_type_multi:"16 db_type_multi",db_type_multi_small:"16 db_type_multi_small",db_type_grade:"16 db_type_grade",db_type_grade_small:"16 db_type_grade_small",db_type_grade_gray:"16 db_type_grade_gray",db_type_progress:"16 db_type_progress",db_type_progress_small:"16 db_type_progress_small",db_type_image:"16 db_type_image",db_type_image_small:"16 db_type_image_small",db_type_file:"16 db_type_file",db_type_file_small:"16 db_type_file_small",db_type_contacts:"16 db_type_contacts",db_type_contacts_small:"16 db_type_contacts_small",db_type_formula:"16 db_type_formula",db_type_formula_small:"16 db_type_formula_small",db_type_auto_number:"16 db_type_auto_number",db_type_auto_number_small:"16 db_type_auto_number_small",db_type_creator:"16 db_type_creator",db_type_creator_small:"16 db_type_creator_small",db_type_create_time:"16 db_type_create_time",db_type_create_time_small:"16 db_type_create_time_small",db_type_trigger:"16 db_type_trigger",db_type_trigger_small:"16 db_type_trigger_small",db_type_note:"16 db_type_note",db_type_note_small:"16 db_type_note_small",db_type_link_record:"16 db_type_link_record",db_type_link_record_small:"16 db_type_link_record_small",db_type_field_lookup:"16 db_type_field_lookup",db_type_field_lookup_small:"16 db_type_field_lookup_small",db_type_address:"16 db_type_address",db_type_address_small:"16 db_type_address_small",db_type_last_modified_time:"16 db_type_last_modified_time",db_type_last_modified_time_small:"16 db_type_last_modified_time_small",db_type_last_modified_by:"16 db_type_last_modified_by",db_type_last_modified_by_small:"16 db_type_last_modified_by_small",db_field_tip:"16 db_field_tip",db_add_link_field:"16 db_add_link_field",db_new_add:"16 db_new_add",db_rename:"16 db_rename",db_get_link:"16 db_get_link",db_card_prev:"16 db_card_prev",db_card_next:"16 db_card_next",db_card_arrow_up:"16 db_card_arrow_up",db_card_arrow_down:"16 db_card_arrow_down",db_print:"16 db_print",db_print_preview:"16 db_print_preview",db_print_fullScreen:"16 db_print_fullscreen",db_print_quit_fullscreen:"16 db_print_quit_fullscreen",k_sheet_db_type_auto_number:"16 k_sheet_db_type_auto_number",k_sheet_db_type_checkbox:"16 k_sheet_db_type_checkbox",k_sheet_db_type_checkbox2:"16 k_sheet_db_type_checkbox2",k_sheet_db_type_contacts:"16 k_sheet_db_type_contacts",k_sheet_db_type_create_time:"16 k_sheet_db_type_create_time",k_sheet_db_type_currency:"16 k_sheet_db_type_currency",k_sheet_db_type_email:"16 k_sheet_db_type_email",k_sheet_db_type_creator:"16 k_sheet_db_type_creator",k_sheet_db_type_field_lookup:"16 k_sheet_db_type_field_lookup",k_sheet_db_type_address:"16 k_sheet_db_type_address",k_sheet_db_type_file:"16 k_sheet_db_type_file",k_sheet_db_type_image:"16 k_sheet_db_type_file",k_sheet_db_type_formula:"16 k_sheet_db_type_formula",k_sheet_db_type_grade:"16 k_sheet_db_type_grade",k_sheet_db_type_hyperlink:"16 k_sheet_db_type_hyperlink",k_sheet_db_type_id:"16 k_sheet_db_type_id",k_sheet_db_type_link_record:"16 k_sheet_db_type_link_record",k_sheet_db_type_multi:"16 k_sheet_db_type_multi",k_sheet_db_type_multi_text:"16 k_sheet_db_type_multi_text",k_sheet_db_type_single_text:"16 k_sheet_db_type_multi_text",k_sheet_db_type_note:"16 k_sheet_db_type_note",k_sheet_db_type_number:"16 k_sheet_db_type_number",k_sheet_db_type_percentage:"16 k_sheet_db_type_percentage",k_sheet_db_type_phone:"16 k_sheet_db_type_phone",k_sheet_db_type_progress:"16 k_sheet_db_type_progress",k_sheet_db_type_single:"16 k_sheet_db_type_single",k_sheet_db_type_time:"16 k_sheet_db_type_time",k_sheet_db_type_trigger:"16 k_sheet_db_type_trigger",k_sheet_db_type_date:"16 k_sheet_db_type_date",k_p_s_format:"16 k_p_s_format",k_p_s_val_dig:"16 k_p_s_val_dig",k_p_s_format_all:"16 k_p_s_format_all",k_p_s_value:"16 k_p_s_value",k_p_s_trans:"16 k_p_s_trans",k_trans_image:"16 k_trans_image",k_dv_image_album:"16 k_dv_image_album",ksheet_db_type_checkbox:"16 ksheet_db_type_checkbox",ksheet_db_type_progress:"16 ksheet_db_type_progress",ksheet_db_type_date:"16 ksheet_db_type_date",ksheet_db_type_time:"16 ksheet_db_type_time",ksheet_db_type_single:"16 ksheet_db_type_single",ksheet_db_type_image:"16 ksheet_db_type_image",ksheet_db_type_email:"16 ksheet_db_type_email",ksheet_db_type_hyperlink:"16 ksheet_db_type_link",ksheet_db_type_phone:"16 ksheet_db_type_phone",ksheet_db_type_id:"16 ksheet_db_type_id",ksheet_dv_clear_col:"16 ksheet_dv_clear_col",k_sheet_db_clear:"16 k_sheet_db_clear",ksheet_db_add:"16 ksheet_db_add",ksheet_db_get_link:"16 ksheet_db_get_link",ksheet_db_form_edit_mode:"16 ksheet_db_form_edit_mode",ksheet_db_blue_add:"16 ksheet_db_blue_add",ksheet_db_editor_close:"16 ksheet_db_editor_close",ksheet_comment_at:"16 ksheet_comment_at",ksheet_cell_history_sm:"16 ksheet_cell_history_sm",ksheet_color_empty:"16 ksheet_color_empty",as_dv_tip:"16 as_dv_tip",db_dv_tip:"16 db_dv_tip",pub_menu_item_tip:"16 pub_menu_item_tip",pub_menu_item_new_tip:"16 pub_menu_item_new_tip",menu_search:"16 menu_search",new_sheet_normal:"16 new_sheet_normal",eye_open:"16 eye_open",eye_close:"16 eye_close",db_row_h1:"16 db_row_h1",db_row_h2:"16 db_row_h2",db_row_h3:"16 db_row_h3",db_row_h4:"16 db_row_h4",db_card_link_go:"16 db_card_link_go",db_primary_field:"16 db_primary_field",db_image_add:"16 db_image_add",db_image_download:"16 db_image_download",db_image_viewer:"16 db_image_viewer",db_image_delete:"16 db_image_delete",db_attachment_download:"16 db_attachment_download",db_attachment_viewer:"16 db_attachment_viewer",db_attachment_delete:"16 db_attachment_delete",db_sheet_normal:"16 db_sheet_normal",db_sheet_normal_1:"16 db_sheet_normal_1",db_sheet_normal_active:"16 db_sheet_normal_active",db_dashboard:"16 db_dashboard",db_dashboard_active:"16 db_dashboard_active",db_sheet_normal_fp:"16 db_sheet_normal_fp",db_sheet_normal_fp_active:"16 db_sheet_normal_fp_active",db_pack_up:"16 db_pack_up",db_notice:"16 db_notice",db_gallery_cover_picture:"16 db_gallery_cover_picture",db_gallery_cover_attachment:"16 db_gallery_cover_attachment",db_gallery_no_cover:"16 db_gallery_no_cover",db_add_trigger:"16 db_add_trigger",db_unfold:"16 db_unfold",db_fold:"16 db_fold",db_view_share:"16 db_view_share",db_query_setting:"16 db_query_setting",db_video_viewer_close:"16 db_video_viewer_close",db_find_pre:"16 db_find_prev",db_find_next:"16 db_find_next",db_find_pre_active:"16 db_find_prev_active",db_find_next_active:"16 db_find_next_active",db_search:"16 db_search",db_add_record:"16 db_add_record",re_application:"16 re_application",show_all:"16 show_all",filter_auto:"16 filter_auto",more_color:"16 more_color",db_help:"16 db_help",db_show_more_green:"16 db_show_more_green",db_show_more:"16 db_show_more",db_fold_green:"16 db_fold_green",db_fold_gray:"16 db_fold_gray",db_protect_disable:"16 db_protect_disable",db_white_close:"16 db_white_close",db_protect_entry:"16 db_protect_entry",db_preview:"16 db_preview",db_qrcode:"16 db_qrcode",db_minipro_code:"16 db_minipro_code",db_hyperlink_edit:"16 db_hyperlink_edit",db_batch_paste:"16 db_batch_paste",db_form_drag:"16 db_form_drag",drag:"16 drag",db_formula_operator:"16 db_formula_operator",db_formula_add:"16 db_formula_add",db_formula_mult:"16 db_formula_mult",db_formula_sub:"16 db_formula_sub",db_formula_divi:"16 db_formula_divi",db_formula_list:"16 db_formula_list",db_change_arrow:"16 db_change_arrow",db_eye_close:"16 db_eye_close",db_editor_close:"16 db_editor_close",db_editor_fold:"16 db_editor_fold",db_editor_unfold:"16 db_editor_unfold",db_link_arrow:"16 db_link_arrow",db_form_edit_mode:"16 db_form_edit",db_form_design_mode:"16 db_form_design",ksheet_unfold:"16 ksheet_unfold",ksheet_dbsheet_new_sheet:"16 ksheet_dbsheet_new_sheet",ksheet_et_delete:"16 ksheet_et_delete",ksheet_hide_slide:"16 ksheet_hide_slide",ksheet_eye_open:"16 ksheet_eye_open",ksheet_copy:"16 ksheet_copy",ksheet_set_chart:"16 ksheet_set_chart",ksheet_set_type_chart:"16 ksheet_set_type_chart",keyboard:"16 keyboard",grid:"16 grid",add_canvas:"16 add_canvas",repeat:"16 repeat",text_vertical:"16 text_vertical",text_horizontal:"16 text_horizontal",note_color_diff:"16 note_color_diff",adapt_window:"16 adapt_window",kw_border_none:"16 kw_border_none",font:"16 font",para:"16 para",autonum:"16 autonum",average_col_width:"16 average_col_width",average_row_height:"16 average_row_height",border_center:"16 border_center",border_center_horizental:"16 border_center_horizental",border_center_vertical:"16 border_center_vertical",droplist_setting_minus:"16 droplist_setting_minus",droplist_setting_plus:"16 droplist_setting_plus",droplist_setting_draw:"16 droplist_setting_draw",font_size_add_white:"16 font_size_add_white",font_size_minus_white:"16 font_size_minus_white",edit_name:"16 edit_name",window_btn:"16 window_btn",play_explain:"16 play_explain",auto_play:"16 auto_play",docer_logo:"16 docer_logo",protect_edit:"16 protect_edit",spell_check_enabled:"16 spell_check_enabled",spell_check_disabled:"16 spell_check_disabled",calculate_finish_status:"16 calculate_finish_status",wps_selected:"16 selected_w",et_selected:"16 selected_s",wpp_selected:"16 selected_p",pdf_selected:"16 selected_f",disabled_tag:"16 disabled-tag",submenu_dropdown:"16 submenu-dropdown",arrow_gray:"16 arrow_gray",bell:"16 bell",bell_ban:"16 bell_ban",add_one:"16 add_one",praise:"16 praise",chart_element:"16 chart_element",chart_layout:"16 chart_layout",chart_color:"16 chart_color",chart_style:"16 chart_style",chart_power:"16 chart_power",chart_linear:"16 chart_linear",chart_logarithm:"16 chart_logarithm",chart_multinomial:"16 chart_multinomial",chart_exponent:"16 chart_exponent",chart_moveavg:"16 chart_moveavg",chart_marker_square:"16 chart_marker_square",chart_marker_diamond:"16 chart_marker_diamond",chart_marker_triangle:"16 chart_marker_triangle",chart_marker_x:"16 chart_marker_x",chart_marker_star:"16 chart_marker_star",chart_marker_dot:"16 chart_marker_dot",chart_marker_dash:"16 chart_marker_dash",chart_marker_circle:"16 chart_marker_circle",chart_marker_plus:"16 chart_marker_plus",chart_question:"16 chart_question",wpp_switch_queue:"16 wpp_switch_queue",wpp_add_anime:"16 wpp_add_anime",wpp_format_setting:"16 wpp_format_setting",default_layout:"16 default_layout",add_new:"16 add_new",copy_format:"16 copy_format",paste_format:"16 paste_format",copy_once:"16 copy_once",exchange:"16 exchange",animation:"16 animation",reduce:"16 reduce",opacity:"16 opacity",text_attribute:"16 text_attribute",border_none:"16 border_none",fill_none:"16 fill_none",wps_circle_checkbox_checked:"16 wps_circle_checkbox_checked",wps_circle_checkbox:"16 wps_circle_checkbox",wps_comment_panel:"16 wps_comment_panel",add_sign:"16 add_sign",delete_sign:"16 delete_sign",sign_manage:"16 sign_manage",sign_manage_ok:"16 sign_manage_ok",info_warn:"16 info_warn",warn_red:"16 warn_red",help_info:"16 help_info",import:"16 import",insert_hr:"16 insert_hr",block_quote:"16 block_quote",code_block:"16 code_block",font_h1:"16 font_h1",font_h2:"16 font_h2",font_h3:"16 font_h3",font_h4:"16 font_h4",font_h5:"16 font_h5",quote:"16 quote",comment_count:"16 comment_count",insert_bilibili:"16 insert_bilibili",insert_ximalaya:"16 insert_ximalaya",insert_netease_music:"16 insert_netease_music",insert_thirdsresources:"16 insert_thirdsresources",link_open:"16 link_open",link_reload:"16 link_reload",outline_user:"16 outline_user",outline_date:"16 outline_date",outline_link:"16 outline_link",outline_doc:"16 outline_doc",outline_template_plugin:"16 outline_template_plugin",otl_pco_edit:"16 otl_pco_edit",otl_add_todo:"16 otl_add_todo",otl_image_border:"16 otl_image_border",otl_image_rotate:"16 otl_image_rotate",otl_full_screen:"16 otl_full_screen",otl_insert_comment:"16 otl_insert_comment",img_full_screen:"16 img_full_screen",table_insert_right:"16 table_insert_right",table_insert_left:"16 table_insert_left",table_insert_below:"16 table_insert_below",table_insert_ahead:"16 table_insert_ahead",paragraph_bar_insert_blank:"16 paragraph_bar_insert_blank",insert_date:"16 insert_date",insert_img:"16 insert_img",insert_schedule:"16 insert_schedule",insert_markdown:"16 insert_markdown",insert_column_block:"16 insert_column_block",insert_highlight_block:"16 insert_highlight_block",insert_lock_block:"16 insert_lock_block",cancel_lock_block:"16 cancel_lock_block",set_object_block_style:"16 set_object_block_style",otl_cancel_link:"16 otl_cancel_link",otl_comment_add:"16 otl_comment_add",otl_video:"16 otl_video",otl_copy_right_click:"16 otl_copy_right_click",otl_paste_right_click:"16 otl_paste_right_click",otl_paste_text_right_click:"16 otl_paste_text_right_click",otl_cut_right_click:"16 otl_cut_right_click",table_merge_cells:"16 table_merge_cells",table_split_cell:"16 table_split_cell",blue_right_arrow:"16 blue_right_arrow",gray_right_arrow:"16 gray_right_arrow",countdown:"16 countdown",otl_table_vertical_top:"16 otl_table_vertical_top",otl_table_vertical_middle:"16 otl_table_vertical_middle",otl_table_vertical_bottom:"16 otl_table_vertical_bottom",otl_pc_comment:"16 otl_pc_comment",otl_pc_find:"16 otl_pc_find",otl_increase_indentation:"16 otl_increase_indentation",otl_reduce_indentation:"16 otl_reduce_indentation",otl_font_sup:"16 otl_font_sup",otl_font_sub:"16 otl_font_sub",otl_font_color:"16 otl_font_color",otl_redo:"16 otl_redo",otl_undo:"16 otl_undo",otl_font_highlight:"16 otl_font_highlight",otl_cmb_more_btn:"16 otl_cmb_more_btn",otl_align_left:"16 otl_align_left",otl_align_horiz:"16 otl_align_horiz",otl_align_right:"16 otl_align_right",otl_todo_list:"16 otl_todo_list",otl_bullet:"16 otl_bullet",otl_numbering:"16 otl_numbering",otl_close_comment:"16 otl_close_comment",otl_comment_show_btn:"16 otl_comment_show_btn",dropdown_selected:"16 dropdown_selected",voice_telephone:"16 voice_telephone",koa_chat:"16 koa_chat",woa_chat:"16 woa_chat",menu_meeting:"16 menu_meeting",latex_formula:"16 latex_formula",toggle_panel:"16 toggle_panel",tip:"16 tip",otl_nps_icon:"16 otl_nps_icon",img_fill:"16 img_fill",ksheet_nps_icon:"16 ksheet_nps_icon",spreadsheet_nps_icon:"16 spreadsheet_nps_icon",wpp_nps_icon:"16 wpp_nps_icon",pdf_nps_icon:"16 pdf_nps_icon",wps_nps_icon:"16 wps_nps_icon",nps_close:"16 nps_close",otl_insert_panel:"16 otl_insert_panel",common_fullscreen:"16 common_fullscreen",sub_dropdown:"16 sub_dropdown",k_app_share:"16 k_app_share",k_app_add:"16 k_app_add",k_app_close:"16 k_app_close",k_more:"16 k_more",k_app_config:"16 k_app_config",k_app_data:"16 k_app_data",k_app_more:"16 k_app_more",k_app_preview:"16 k_app_preview",link_copy:"16 link_copy",footnote_endnote:"16 footnote_endnote",insert_footnote:"16 insert_footnote",insert_endnote:"16 insert_endnote",footnote_setting:"16 footnote_setting",endnote_setting:"16 endnote_setting",dropdown_arrow:"16 dropdown_arrow",chat_tick_success:"16 chat_tick_success"},size24:{more:"24 more 1",otl_view_img:"24 otl_view_img",k_et_icon:"24 k_et_icon",arrow_up_white:"24 arrow_up_white",arrow_down_white:"24 arrow_down_white",add_white:"24 add_white",db_card_close:"24 db_card_close",play_from_start:"24 play_from_start",play_from_active:"24 play_from_active",play_fast:"24 play_fast",remark:"24 remark",insert_text:"24 insert_text",stop_play:"24 stop_play",wpp_insert_picture:"24 wpp_insert_picture",picture_shortcut:"24 picture_shortcut 1",table_shortcut:"24 table_shortcut 1",chart_shortcut:"24 chart_shortcut 1",cell_delete:"24 delete",cell_format:"24 format",et_data_manage:"24 et_data_manage",et_set_chart:"24 et_set_chart",et_set_style_chart:"24 et_set_style_chart",et_set_type_chart:"24 et_set_type_chart",url_cell_pic:"24 url_cell_pic",cell_origin_image:"24 cell_origin_image",delete_circle:"24 delete_circle",close:"24 close",enter:"24 enter",format_painter_wps:"24 format_painter",print:"24 print",trash:"24 trash",topbar_font:"24 topbar_font",warning:"24 warning",topbar_history:"24 topbar_history",success:"24 ok_24",wrong:"24 wrong_24",info:"24 message_24",border_empty:"24 border_empty",border_external:"24 border_external",border_fill_color:"24 Fill",border_inside:"24 Inside_frameline",merge_center:"24 Merge",cooper_history:"24 Revised_record",topbar_hidden:"24 topbar_fold",password_btn_disabled:"24 go_disable",password_btn_normal:"24 go_normal",back:"24 back",mobile_cooperation:"24 mobile_cooperation",lock:"24 lock",exportFile:"24 export",rotate:"24 rotate",rotate_2:"24 rotate_2",mobile_play_fast:"24 mobile_play_fast",more_items:"24 more_items",hyper_link:"24 hyper_link",func:"24 func",et_image_save_excel:"24 et_image_save_excel",et_image_save_cloud_last:"24 et_image_save_cloud_last",et_loading_finish:"24 et_loading_finish",et_export_img:"24 et_export_img",et_export_pdf:"24 et_export_pdf",et_condition_format:"24 et_condition_format",fill_color:"24 fill_color",wps_export_pdf:"24 wps_export_pdf",wps_export_img:"24 wps_export_img",textWrappingAboveCharacter:"24 text_wrapping_above_character",textWrappingSurroundUpAndDown:"24 text_wrapping_around_up_and_down",textWrappingEmbedded:"24 text_wrapping_embedded",textWrappingSurround:"24 text_wrapping_surround",textWrappingThroughAround:"24 text_wrapping_through_around",textWrappingTightAround:"24 text_wrapping_tight_around",textWrappingUnderCharacter:"24 text_wrapping_under_character",textWrappingWebModeEmbedded:"24 text_wrapping_web_mode_embedded",textWrappingWebModeExclusive:"24 text_wrapping_web_mode_exclusive",et_error_check_tips:"24 et_error_check_tips",insert_picture:"24 insert_picture",processon_edit_2:"24 processon_edit_2",process_edit:"24 process-edit",sign_clear:"24 sign_clear",sign_cancel:"24 sign_cancel",wpp_uil_tip_close:"24 wpp_uil_tip_close",wpp_uil_tip_open:"24 wpp_uil_tip_open",unfold:"24 unfold",wps_bookmark_item:"24 wps_bookmark_item",wpp_play_mark:"24 wpp_play_mark",wpp_add_new:"24 wpp_add_new",wpp_add_new_gray:"24 wpp_add_new_gray",kw_close_btn:"24 kw_close_btn",mind_map:"24 mind_map",flow_chart:"24 flow_chart",note:"24 note",picture:"24 picture",select:"24 select",textbox:"24 textbox",insert_geometry:"24 insert_geometry",wpp_play_start:"24 wpp_play_start",wpp_play_stop:"24 wpp_play_stop",wpp_play_fullscreen:"24 wpp_play_fullscreen",wpp_explain_exit_fullscreen:"24 wpp_explain_exit_fullscreen",wpp_play_exit_fullscreen:"24 wpp_play_exit_fullscreen",wpp_play_loading:"24 wpp_play_loading",wpp_play_loading_gray:"24 wpp_play_loading_gray",wpp_playbar_more:"24 wpp_playbar_more",wpp_playbar_fullscreen_exit:"24 wpp_playbar_fullscreen_exit",wpp_playbar_fullscreen:"24 wpp_playbar_fullscreen",wpp_playbar_laser:"24 wpp_playbar_laser",wpp_playbar_laser_active:"24 wpp_playbar_laser_active",wpp_playbar_create_meeting:"24 wpp_playbar_create_meeting",wpp_playbar_finish:"24 wpp_playbar_finish",wpp_playbar_audience_view:"24 wpp_playbar_audience_view",setting_white:"24 setting_white",time_countdown:"24 time_countdown",start_autoplay:"24 start_autoplay",play_page:"24 play_page",mark:"24 mark",show_mark:"24 show_mark",audio_icon_1:"24 audio_icon_1",audio_icon_2:"24 audio_icon_2",audio_icon_3:"24 audio_icon_3",audio_icon_4:"24 audio_icon_4",audio_icon_5:"24 audio_icon_5",audio_icon_6:"24 audio_icon_6",media_muted:"24 media_muted",media_volume:"24 media_volume",remarks_view:"24 remarks_view",pdf_mouse:"24 pdf_mouse",pdf_play_left_bar:"24 pdf_play_left_bar",pdf_play_right_bar:"24 pdf_play_right_bar",pdf_play_drag:"24 pdf_play_drag",pdf_auto_scroll:"24 pdf_auto_scroll",pdf_end_play:"24 pdf_end_play",pdf_enter_full:"24 pdf_enter_full",pdf_exit_full:"24 pdf_exit_full",pdf_play_prev:"24 pdf_play_prev",pdf_play_next:"24 pdf_play_next",pdf_play_enlarge:"24 pdf_play_enlarge",pdf_play_narrow:"24 pdf_play_narrow",pdf_play_adapt:"24 pdf_play_adapt",pdf_play_pagew:"24 pdf_play_pagew",pdf_play_multi_page:"24 pdf_play_multi_page",otl_reload:"24 otl_reload",otl_cut:"24 otl_cut",otl_copy:"24 otl_copy",otl_paste:"24 otl_paste",otl_arrow_mouse:"24 otl_arrow_mouse",otl_select_text_all:"24 otl_select_text_all",otl_comment:"24 otl_comment",otl_edit:"24 otl_edit",otl_delete:"24 otl_delete",otl_jumplink:"24 otl_jumplink",otl_clean:"24 otl_clean",otl_table_insert:"24 otl_table_insert",otl_image_add_border:"24 otl_image_add_border",otl_image_cancel_border:"24 otl_image_cancel_border",otl_image_rotate:"24 otl_image_rotate",otl_table_merge_cells:"24 otl_table_merge_cells",otl_table_split_cell:"24 otl_table_split_cell",otl_close:"24 otl_close",otl_playbar_close:"24 otl_playbar_close",otl_playbar_edit:"24 otl_playbar_edit",otl_playbar_finish:"24 otl_playbar_finish",otl_zoom_in:"24 otl_zoom_in",otl_zoom_out:"24 otl_zoom_out",text_align_left:"24 align_l",text_align_right:"24 align_r",text_align_center:"24 align_c",vertical_top:"24 vertical_top",vertical_middle:"24 vertical_middle",vertical_bottom:"24 vertical_bottom",image_zoom_in:"24 image_zoom_in",image_zoom_out:"24 image_zoom_out",image_rotate_left:"24 image_rotate_left",image_rotate_right:"24 image_rotate_right",image_adapt_size:"24 image_adapt_size",image_origin_size:"24 image_origin_size",image_download:"24 image_download",image_more:"24 image_more",image_last:"24 image_last",image_next:"24 image_next",image_thumb_last:"24 image_thumb_last",image_thumb_next:"24 image_thumb_next",image_location:"24 image_location",image_edit:"24 image_edit",image_close:"24 image_close",image_mini_mode:"24 image_mini_mode",image_full_mode:"24 image_full_mode",image_loading:"24 image_loading",i_more:"24 i_more",i_rotate_left:"24 i_rotate_left",i_rotate_right:"24 i_rotate_right",i_zoom_in:"24 i_zoom_in",i_zoom_out:"24 i_zoom_out",i_origin_size:"24 i_origin_size",i_adapt_size:"24 i_adapt_size",image_aerial_view:"24 image_aerial_view",image_exit_fullscreen:"24 image_exit_fullscreen",image_fullscreen:"24 image_fullscreen",db_logo:"24 db",k_logo:"24 k_logo",go_forward_five:"24 go_forward_five",go_back_five:"24 go_back_five",wpp_theme_loading:"24 wpp_theme_loading",ksheet_more:"24 ksheet_more",other:"24 other",ksheet_other:"24 ksheet_other",protect_other:"24 protect_other",video_play:"24 video_play",video_pause:"24 video_pause",video_volume:"24 video_volume",video_fullscreen:"24 video_fullscreen",video_volume_muted:"24 video_volume_muted",video_exit_fullscreen:"24 video_exit_fullscreen",video_loading:"24 video_loading",video_volume_active:"24 video_volume_active"},size38:{warn:"38 warn",success:"38 ok",wrong:"38 wrong",safe:"38 safe",process_on_edit:"38 process_on_edit",portrait:"38 portrait",landscape:"38 landscape",allColPage:"38 allColPage",allRowPage:"38 allRowPage",inPage:"38 inPage"},size48:{close:"48 close",share:"48 share",invite:"48 invite",rename:"48 rename",feedback:"48 feedback",settings:"48 settings",exportFile:"48 export",saveAs:"48 saveAs",reportFile:"48 reportFile",aboutWps:"48 aboutwps",other_apps:"48 other_apps",scan_code:"48 scan_code",edit:"48 edit",edit_finish:"48 edit_finish",rotate:"48 rotate",format_satting:"48 format_satting",format_satting_selected:"48 format_satting_selected",et_aido_fill:"48 et_aido_fill",et_aido_signature:"48 et_aido_signature",text_encoding:"48 text_encoding",wpp_image_reload:"48 wpp_image_reload",et_link_green:"48 et_link_green",db_gallery_add:"48 db_gallery_add",db_image_placeholder:"48 db_image_placeholder",nps_submit:"48 nps_submit",image_loading:"48 image_loading"},size64:{cooper_histories_none:"64 No_collaboration",cooper_version_none:"64 historic_version",et_condition_format_none:"64 et_condition_format_none",et_aido_fill:"64 et_aido_fill",et_aido_signature:"64 et_aido_signature",k_link_green:"64 k_link_green",ksheet_condition_format_none:"64 ksheet_condition_format_none"},line:{blsThin:"line bls_thin",blsHair:"line bls_hair",blsDotted:"line bls_dotted",blsDashed:"line bls_dashed",blsDashDot:"line bls_dash_dot",blsDashDotDot:"line bls_dash_dot_dot",blsDouble:"line bls_double",blsMedium:"line bls_medium",blsMediumDashed:"line bls_medium_dashed",blsMediumDashDot:"line bls_medium_dash_dot",blsMediumDashDotDot:"line bls_medium_dash_dot_dot",blsSlantedDashDot:"line bls_slanted_dash_dot",blsThick:"line bls_thick"},outline:{single:"outline single",double:"outline double",thin_thick:"outline thin_thick",thick_thin:"outline thick_thin",thin_thick_thin:"outline thin_thick_thin",round_dot:"outline round_dot",short_dash:"outline short_dash",dash_dot:"outline dash_dot",double_dot:"outline double_dot",header_btn_triangle:"outline header_btn_triangle 1",header_btn_triangle_hover:"outline header_btn_triangle_hover",insert_panel_table:"outline insert_panel_table",insert_panel_table2:"16 insert_panel_table2",insert_panel_kanban:"outline insert_panel_kanban",insert_panel_todolist:"outline insert_panel_todolist",insert_panel_emoji:"outline insert_panel_emoji",insert_panel_group_card:"outline insert_panel_group_card",mind_map:"16 mind_map",flow_chart:"16 flow_chart",delete_column:"outline delete_table_element",delete_row:"outline delete_table_element",delete_table:"outline delete_table_element",add_column_hover:"outline add_table_element_hover",add_column_not_hover:"outline add_table_element_not_hover",add_row_hover:"outline add_table_element_hover",add_row_not_hover:"outline add_table_element_not_hover",template_btn_hover:"outline template_btn_element_hover",template_btn_not_hover:"outline template_btn__element_not_hover",video_load_fail:"outline video_load_fail",new_comment_close:"outline new_comment_close",question_mark:"outline question_mark",spin_loading:"outline spin_loading",checkbox_active:"outline checkbox_active",vote_multiple_choice:"outline vote_multiple_choice",vote_single_choice:"outline vote_single_choice",extensions:"outline extensions",extensions_channels_activity:"outline extensions_channels_activity",extensions_file_update_notice:"outline extensions_file_update_notice",vote_add_16:"outline vote_add_16",vote_arrow_16:"outline vote_arrow_16",vote_close_16:"outline vote_close_16",dropdown_normal_16_vote:"outline dropdown_normal_16_vote",dropdown_normal_16_h1:"outline dropdown_normal_16_h1",dropdown_normal_16_h2:"outline dropdown_normal_16_h2",dropdown_normal_16_h3:"outline dropdown_normal_16_h3",dropdown_normal_16_h4:"outline dropdown_normal_16_h4",dropdown_normal_16_h5:"outline dropdown_normal_16_h5",dropdown_normal_16_un_order_list:"outline dropdown_normal_16_un_order_list 1",dropdown_normal_16_order_list:"outline dropdown_normal_16_order_list 1",dropdown_normal_16_todo_list:"outline dropdown_normal_16_todo_list 1",dropdown_normal_16_highlight_block:"outline dropdown_normal_16_highlight_block",dropdown_normal_16_quote:"outline dropdown_normal_16_quote",dropdown_normal_16_code_block:"outline dropdown_normal_16_code_block",dropdown_normal_16_align_left:"outline dropdown_normal_16_align_left",dropdown_normal_16_align_center:"outline dropdown_normal_16_align_center",dropdown_normal_16_align_right:"outline dropdown_normal_16_align_right",dropdown_normal_16_link:"outline dropdown_normal_16_link 1",dropdown_colorful_16_image:"outline dropdown_colorful_16_image",dropdown_colorful_16_table:"outline dropdown_colorful_16_table",dropdown_colorful_16_cloud_documents:"outline dropdown_colorful_16_cloud_documents",dropdown_colorful_16_highlight_block:"outline dropdown_colorful_16_highlight_block",dropdown_colorful_16_date:"outline dropdown_colorful_16_date",dropdown_colorful_16_code_block:"outline dropdown_colorful_16_code_block",dropdown_colorful_16_quote:"outline dropdown_colorful_16_quote",dropdown_colorful_16_emoji:"outline dropdown_colorful_16_emoji",dropdown_colorful_16_hyperlink:"outline dropdown_colorful_16_hyperlink",dropdown_colorful_16_dividing_line:"outline dropdown_colorful_16_dividing_line",dropdown_colorful_16_latex:"outline dropdown_colorful_16_latex",dropdown_colorful_16_mind_mapping:"outline dropdown_colorful_16_mind_mapping",dropdown_colorful_16_flow_chart:"outline dropdown_colorful_16_flow_chart",dropdown_colorful_16_et:"outline dropdown_colorful_16_et",dropdown_colorful_16_db:"outline dropdown_colorful_16_db",dropdown_colorful_16_db_grid_view:"outline dropdown_colorful_16_db_grid_view",dropdown_colorful_16_db_kanban_view:"outline dropdown_colorful_16_db_kanban_view",dropdown_colorful_16_db_gallery_view:"outline dropdown_colorful_16_db_gallery_view",dropdown_colorful_16_db_kanban:"outline dropdown_colorful_16_db_kanban",dropdown_colorful_16_db_todolist:"outline dropdown_colorful_16_db_todolist",dropdown_colorful_16_countdown:"outline dropdown_colorful_16_countdown",dropdown_colorful_16_schedule:"outline dropdown_colorful_16_schedule",dropdown_colorful_16_group_business_card:"outline dropdown_colorful_16_group_business_card",dropdown_colorful_16_markdown:"outline dropdown_colorful_16_markdown",dropdown_colorful_16_third_party:"outline dropdown_colorful_16_third_party",dropdown_colorful_16_share_paragraph_link:"outline dropdown_colorful_16_share_paragraph_link",dropdown_colorful_16_content_protection:"outline dropdown_colorful_16_content_protection",dropdown_colorful_16_content_un_protection:"outline dropdown_colorful_16_content_un_protection",dropdown_colorful_16_color_settings:"outline dropdown_colorful_16_color_settings",dropdown_colorful_16_add_kdocs_todo:"outline dropdown_colorful_16_add_kdocs_todo",dropdown_colorful_16_woa_tpl:"outline dropdown_colorful_16_woa_tpl",intention_collection:"outline intention_collection",hide_table_border:"outline hide_table_border",otl_cloud_32:"outline otl_cloud_32",otl_save_success_32:"outline otl_save_success_32",dropdown_colorful_16_insert_below:"outline dropdown_colorful_16_insert_below",dropdown_colorful_image_properties:"outline dropdown_colorful_image_properties",dropdown_normal_16_frame:"outline dropdown_normal_16_frame",dropdown_normal_16_rotate_90:"outline dropdown_normal_16_rotate_90",dropdown_colorful_16_text_attribute:"outline dropdown_colorful_16_text_attribute 1",dropdown_normal_16_text_bold:"outline dropdown_normal_16_text_bold 1",dropdown_normal_16_text_italic:"outline dropdown_normal_16_text_italic 1",dropdown_normal_16_text_underline:"outline dropdown_normal_16_text_underline 1",dropdown_normal_16_text_del_line:"outline dropdown_normal_16_text_del_line 1",dropdown_colorful_16_copy:"outline dropdown_colorful_16_copy",dropdown_colorful_16_cut:"outline dropdown_colorful_16_cut",dropdown_colorful_16_delete:"outline dropdown_colorful_16_delete",dropdown_colorful_16_paste:"outline dropdown_colorful_16_paste",dropdown_colorful_16_paste_text:"outline dropdown_colorful_16_paste_text",et_full_screen:"outline et_full_screen",linkpanel_copylink:"outline linkpanel_copylink",linkpanel_editlink:"outline linkpanel_editlink",linkpanel_unlink:"outline linkpanel_unlink",otl_cloud_document_comment:"16 otl_cloud_document_comment",otl_cloud_document_preview_view:"16 otl_cloud_document_preview_view",otl_cloud_document_title_view:"16 otl_cloud_document_title_view",otl_cloud_document_link:"16 otl_cloud_document_link",dropdown_arrow_fold:"outline dropdown_arrow_fold",dropdown_arrow_unfold:"outline dropdown_arrow_unfold",otl_doc_menu_loading:"outline otl_doc_menu_loading",font_color_select_white:"outline font_color_select_white",font_color_black:"outline font_color_black",font_color_red:"outline font_color_red",font_color_orange:"outline font_color_orange",font_color_green:"outline font_color_green",font_color_blue:"outline font_color_blue",font_color_lightBlue:"outline font_color_lightBlue",font_color_gray:"outline font_color_gray",font_color_pink:"outline font_color_pink",font_color_gold:"outline font_color_gold",font_color_lightGreen:"outline font_color_lightGreen",font_color_rainbowBlue:"outline font_color_rainbowBlue",font_color_violet:"outline font_color_violet",font_color_pink_orange:"outline font_color_pink_orange",font_color_gold_green:"outline font_color_gold_green",font_color_blue_violet:"outline font_color_blue_violet",font_color_orange_rainbowBlue:"outline font_color_orange_rainbowBlue",font_color_lightBlue_red:"outline font_color_lightBlue_red",font_color_lightGreen_blue:"outline font_color_lightGreen_blue",high_light_color_empty:"outline high_light_color_empty",high_light_color_clear:"outline high_light_color_clear",high_light_color_select_black:"outline high_light_color_select_black",high_light_color_select_black46:"outline high_light_color_select_black46",table_merge_cells:"outline table_merge_cells",table_split_cell:"outline table_split_cell",table_align_center:"outline table_align_center",table_align_left:"outline table_align_left 1",table_align_right:"outline table_align_right",table_insert_left:"outline table_insert_left",table_insert_right:"outline table_insert_right",table_trash:"outline table_trash",table_insert_ahead:"outline table_insert_ahead",table_insert_below:"outline table_insert_below",table_vertical_top:"outline table_vertical_top",table_vertical_middle:"outline table_vertical_middle",table_vertical_bottom:"outline table_vertical_bottom",table_average_column_widths:"outline table_average_column_widths",image_full_screen:"outline image_full_screen",image_border:"outline image_border",image_rotate:"outline image_rotate",picture_caption:"outline picture_caption",image_link:"outline image_link",image_link_placeholder:"outline image_link_placeholder",image_link_more:"outline image_link_more",image_link_open:"outline image_link_open",image_link_edit:"outline image_link_edit",image_link_cancel:"outline image_link_cancel",latex_edit:"outline latex_edit",comment_insert:"outline comment_insert 1",et_comment_insert:"outline et_comment_insert",comment_voice_microphone:"outline comment_voice_microphone",comment_voice_keyboard:"outline comment_voice_keyboard",comment_add:"outline comment_add 1",otl_logo:"outline otl_logo",kdocs_home:"outline kdocs_home",switch_catalog:"outline switch_catalog 1",undo:"outline undo 1",redo:"outline redo 1",cmb_more_btn:"outline cmb_more_btn 1",reduce_indentation:"outline reduce_indentation 1",increase_indentation:"outline increase_indentation 1",todo_list:"outline todo_list 1",numbering:"outline numbering 1",bullet:"outline bullet 1",find:"outline find 1",insert_panel:"outline insert_panel 1",inline_code:"outline inline_code 1",font_sub:"outline font_sub 1",font_sup:"outline font_sup 1",font_highlight:"outline font_highlight 1",font_color:"outline font_color 1",name_more:"outline name_more 1",cancel_lock_block:"outline cancel_lock_block",dialog_close_16:"outline dialog_close_16",link_reload:"outline link_reload",link_open:"outline link_open",double_arrow_left:"outline double_arrow_left",single_arrow_left:"outline single_arrow_left",double_arrow_right:"outline double_arrow_right",single_arrow_right:"outline single_arrow_right",find_panel_close:"outline find_panel_close",play_mode_edit:"outline play_mode_edit",play_mode_checked:"outline play_mode_checked",play_mode_zoom_out:"outline play_mode_zoom_out",play_mode_zoom:"outline play_mode_zoom",play_mode_exit:"outline play_mode_exit",play_mode_btn:"outline play_mode_btn",paperclip:"outline paperclip",close_1:"outline close_1",restore:"outline restore",change:"outline change",say_ai_good:"outline say_ai_good",say_ai_just_so_so:"outline say_ai_just_so_so",ai_heart_occupy:"outline ai_heart_occupy",ai_warning:"outline ai_warning",ai_discard:"outline ai_discard",ai_edit_active:"outline ai_edit_active",ai_more_menu:"outline ai_more_menu",ai_insert:"outline ai_insert",ai_insert_into_content:"outline ai_insert_into_content",like_ai_reply:"outline like_ai_reply",like_ai_reply_active:"outline like_ai_reply_active",unlike_ai_reply:"outline unlike_ai_reply",unlike_ai_reply_active:"outline unlike_ai_reply_active",drop_ai_content:"outline drop_ai_content",ai_assist_icon:"outline ai_assist_icon",abort_ask_ai:"outline abort_ask_ai",ai_menu_button_icon:"outline ai_menu_button_icon",ai_question_send_button:"outline ai_question_send_button",ai_scene_define_button:"outline ai_scene_define_button",ai_fast_entrance_scene_outline:"outline ai_fast_entrance_scene_outline",ai_session_history:"outline ai_session_history",slash_colorful_16_h1:"outline slash_colorful_16_h1",slash_colorful_16_h2:"outline slash_colorful_16_h2",slash_colorful_16_h3:"outline slash_colorful_16_h3",slash_colorful_16_h4:"outline slash_colorful_16_h4",slash_colorful_16_h5:"outline slash_colorful_16_h5",slash_colorful_16_h6:"outline slash_colorful_16_h6",slash_colorful_16_al_video:"outline slash_colorful_16_al_video",slash_colorful_16_bilibili:"outline slash_colorful_16_bilibili",slash_colorful_16_map:"outline slash_colorful_16_map",slash_colorful_16_mock:"outline slash_colorful_16_mock",slash_colorful_16_modao:"outline slash_colorful_16_modao",slash_colorful_16_net_music:"outline slash_colorful_16_net_music",slash_colorful_16_xiaohuozhuo:"outline slash_colorful_16_xiaohuozhuo",slash_colorful_16_figma:"outline slash_colorful_16_figma",slash_colorful_16_mastergo:"outline slash_colorful_16_mastergo",ipad_ai_logo:"outline ai_logo",ipad_comment:"outline ipad_comment",ipad_copy:"outline ipad_copy",ipad_cut:"outline ipad_cut",ipad_delete:"outline ipad_delete",ipad_edit:"outline ipad_edit",ipad_jump_link:"outline ipad_jump_link",ipad_paste:"outline ipad_paste",ipad_select_text_all:"outline ipad_select_text_all",ipad_table_insert:"outline ipad_table_insert",ipad_table_merge_cells:"outline ipad_table_merge_cells",ipad_table_split_cell:"outline ipad_table_split_cell",ipad_average_column_widths:"outline ipad_average_column_widths",ipad_fullscreen:"outline ipad_fullscreen",ipad_reload:"outline ipad_reload",ipad_view_image:"outline ipad_view_image",ipad_image_add_border:"outline ipad_image_add_border",ipad_image_rotate:"outline ipad_image_rotate",ipad_text_align_left:"outline ipad_text_align_left",ipad_text_align_center:"outline ipad_text_align_center",ipad_text_align_right:"outline ipad_text_align_right",ipad_vertical_top:"outline ipad_vertical_top",ipad_vertical_middle:"outline ipad_vertical_middle",ipad_vertical_bottom:"outline ipad_vertical_bottom",ipad_arrow_mouse:"outline ipad_arrow_mouse",ipad_view:"outline ipad_view",save_loading:"outline save_loading",latex_question:"outline latex_question",otl_video:"outline otl_video",code_block_setting_btn_black:"outline code_block_setting_btn_black",code_block_setting_btn_white:"outline code_block_setting_btn_white",code_block_setting_btn_blue:"outline code_block_setting_btn_blue",code_arrow_down_dark:"outline code_arrow_down_dark",code_arrow_down_light:"outline code_arrow_down_light",code_arrow_up:"outline code_arrow_up",kd_logo_origin:"outline kd_logo_origin",catalog_pin:"outline catalog_pin",catalog_pin_active:"outline catalog_pin_active",loading_white:"outline loading_white",page_zoom_plus:"outline page_zoom_plus 1",page_zoom_plus_default:"outline page_zoom_plus_default 1",page_zoom_minus:"outline page_zoom_minus 1",page_zoom_minus_default:"outline page_zoom_minus_default 1",otl_cover_placeholder:"outline otl_cover_placeholder",otl_random:"outline otl_random",otl_refresh:"outline otl_refresh",otl_no_third_party_pic:"outline otl_no_third_party_pic",otl_empty_gallery:"outline otl_empty_gallery",notice_detail_question:"outline notice_detail_question"},other:{topbar_history:"other topbar_history 1",topbar_at_in_box:"other topbar_at_in_box 1",toast_wrong:"other toast_wrong 1",toast_message:"other toast_message 1",toast_ok:"other toast_ok 1",application:"other application 1",meeting_launch:"other meeting_launch 1",helper:"other helper 1",koa_chat:"other koa_chat 1",voice_telephone:"other voice_telephone 1",checked:"other checkbox 1",checkbox_s:"other checkbox_s 1",checkbox_k:"other checkbox_k 1",checkbox_w:"other checkbox_w 1",checkbox_p:"other checkbox_p 1",checkbox_f:"other checkbox_f 1",checkbox_system:"other checkbox_system 1",ksheet_cooper:"other ksheet_cooper 1",text_hold_up:"other text_hold_up 1",text_hold_down:"other text_hold_down 1",checkbox_select:"other checkbox_select 1",checkbox_normal:"other checkbox_normal 1",comment_tip_add_active:"other comment_tip_add_active",comment_tip_add_normal:"other comment_tip_add_normal 1",comment_tip_add_normal_black:"other comment_tip_add_normal_black 1",comment_emoji_tip_add_active:"other comment_emoji_tip_add_active 1",comment_emoji_tip_add_normal:"other comment_emoji_tip_add_normal 1",comment_emoji_tip_add_normal_black:"other comment_emoji_tip_add_normal_black 1",checkbox_done:"other checkbox_done 1",highlight_play:"other highlight_play 1",highlight_pdf_play:"other highlight_pdf_play 1",otl_highlight_play:"other otl_highlight_play 1",otl_cover_pic_fail:"other otl_cover_pic_fail 1",otl_play:"other otl_play 1",otl_play_default:"other otl_play_default 1",otl_width_standard:"other otl_width_standard 1",otl_width_self_adaptive:"other otl_width_self_adaptive 1",otl_fullwidth:"other otl_fullwidth 1",otl_fullwidth_default:"other otl_fullwidth_default 1",select_white:"other select_white 1",indeterminate:"other indeterminate 1",publish:"other publish",tip_warning:"other tip_warning",error_page:"other error_page",stop_publish:"other stop_publish",file_too_large:"other file_too_large",_404:"other 404",file_error:"other error",dropdown:"other Arrow",arrow_left:"other Arrow_left",arrow_right:"other Arrow_right",dropdown_triangle_15:"other dropdown_triangle_15",dropdown_triangle_17:"other dropdown_triangle_17",dropdown_triangle_19:"other dropdown_triangle_19",dropdown_triangle_21:"other dropdown_triangle_21",dropdown_triangle_23:"other dropdown_triangle_23",dropdown_triangle_25:"other dropdown_triangle_25",session_full:"other session_full",no_permission:"other no_permission",drag_right_bottom:"other drag_bar",arrow_collapse:"other arrow_collapse",arrow_expand:"other arrow_expanding",new_empty_et:"other new_empty_et",new_empty_ksheet:"other new_empty_ksheet",new_empty_wps:"other new_empty_wps",new_empty_wpp:"other new_empty_wpp",view_eye:"other view_eye",type_icon_et:"other type_icon_et",type_icon_wps:"other type_icon_wps",type_icon_wpp:"other type_icon_wpp",cooper_history_expand:"other Unfold2",timeline_arrow_open:"other Unfold4",timeline_arrow_close:"other Unfold3",cooper_history_news:"other news",arrow_left_2:"other arrow_left_2",arrow_right_2:"other arrow_right_2",close_2:"other close_2",Newline:"other Newline",tab:"other tab",coopShare:"other list_share",collapse:"other buttom_arrow",shareList:"other list_arrow",cooperation_write:"other cooperation_write",avatar_default:"other avatar_default",from_scratch:"other from_scratch",from_active:"other from_active",increase_line:"other increase_line",delete_row:"other delete_row",delete:"other delete",adjust_column:"other adjust_column",adjust_table:"other adjust_table",vertical_center:"other table_vertical_center",menu_arrow:"other table_menu_arrow",menu_arrow_selected:"other table_menu_arrow_white",wps_table_menu:"other wps_table_menu",wps_table_menu_hover:"other wps_table_menu_hover",wps_table_menu_highlight:"other wps_table_menu_highlight",column_row_add:"other column_row_add",column_row_remove:"other column_row_remove",k_color_clean:"other k_color_clean",wps_webshape_iframe_error:"other wps_webshape_iframe_error",blue_table_1:"other blue_table_1",blue_table_2:"other blue_table_2",blue_table_3:"other blue_table_3",blue_table_4:"other blue_table_4",dark_table_1:"other dark_table_1",dark_table_2:"other dark_table_2",dark_table_3:"other dark_table_3",dark_table_4:"other dark_table_4",green_table_1:"other green_table_1",green_table_2:"other green_table_2",green_table_3:"other green_table_3",green_table_4:"other green_table_4",purple_table_1:"other purple_table_1",purple_table_2:"other purple_table_2",purple_table_3:"other purple_table_3",purple_table_4:"other purple_table_4",yellow_table_1:"other yellow_table_1",yellow_table_2:"other yellow_table_2",yellow_table_3:"other yellow_table_3",yellow_table_4:"other yellow_table_4",default_table_0:"other default_table_0",default_table_5:"other default_table_5",hyper_link_url:"other hyper_link_url",hyper_link_image:"other hyper_link_image",comment_tip:"other comment_tip",zoom_in:"other zoom_in",zoom_out:"other zoom_out",original_size:"other original_size",maximum_size:"other maximum_size",download:"other download",nextImage:"other nextImage",lastImage:"other lastImage",close:"other close",info:"other info",wpsUnderlineNone:"other wpsUnderlineNone",wpsUnderlineSingle:"other wpsUnderlineSingle",wpsUnderlineDouble:"other wpsUnderlineDouble",wpsUnderlineDotted:"other wpsUnderlineDotted",wpsUnderlineThick:"other wpsUnderlineThick",wpsUnderlineDash:"other wpsUnderlineDash",wpsUnderlineDotDash:"other wpsUnderlineDotDash",wpsUnderlineDotDotDash:"other wpsUnderlineDotDotDash",wpsUnderlineWavyHeavy:"other wpsUnderlineWavyHeavy",wpsUnderlineDottedHeavy:"other wpsUnderlineDottedHeavy",wpsUnderlineDashHeavy:"other wpsUnderlineDashHeavy",wpsUnderlineDotDashHeavy:"other wpsUnderlineDotDashHeavy",wpsUnderlineDotDotDashHeavy:"other wpsUnderlineDotDotDashHeavy",wpsUnderlineDashLong:"other wpsUnderlineDashLong",wpsUnderlineDashLongHeavy:"other wpsUnderlineDashLongHeavy",wpsUnderlineWavyDouble:"other wpsUnderlineWavyDouble",wpsUnderlineWavy:"other wpsUnderlineWavy",back:"other back",public_qrcode:"other public_qrcode",file_et:"other file_et",file_wps:"other file_wps",file_wpp:"other file_wpp",file_pdf:"other file_pdf",edit_no_lock:"other edit_no_lock",tmp_more:"other tmp_more",play_from_active:"other play_from_active",meeting_tips:"other meeting_tips",meeting_tips_close:"other meeting_tips_close",color_empty_round:"other color_empty_round",duplicate_remove:"other duplicate_remove",insert_line_group_geomerty:"other insert_line_group_geomerty",insert_rectangle_group_geomerty:"other insert_rectangle_group_geomerty",insert_normal_group_geomerty:"other insert_normal_group_geomerty",insert_arrow_group_geomerty:"other insert_arrow_group_geomerty",insert_formual_group_geomerty:"other insert_formual_group_geomerty",insert_process_group_geomerty:"other insert_process_group_geomerty",insert_startandflag_group_geomerty:"other insert_startandflag_group_geomerty",insert_callout_group_geomerty:"other insert_callout_group_geomerty",insert_action_group_geomerty:"other insert_action_group_geomerty",ink_hand_rect:"other ink_hand_rect",ink_geo_rect:"other ink_geo_rect",ink_hand_star:"other ink_hand_star",ink_geo_star:"other ink_geo_star",ink_hand_para:"other ink_hand_para",ink_geo_para:"other ink_geo_para",ink_hand_line:"other ink_hand_line",ink_geo_line:"other ink_geo_line",ink_hand_circle:"other ink_hand_circle",ink_geo_circle:"other ink_geo_circle",ink_hand_triangle:"other ink_hand_triangle",ink_geo_triangle:"other ink_geo_triangle",ink_hand_diamond:"other ink_hand_diamond",ink_geo_diamond:"other ink_geo_diamond",ink_hand_arrow:"other ink_hand_arrow",ink_geo_arrow:"other ink_geo_arrow",ink_arrow:"other ink_arrow",wpp_line_end_type:"other wpp_line_end_type",wps_line_end_type:"other wps_line_end_type",time_out:"other time_out",explain_empty:"other explain_empty",wpp_new_empty_slide:"other wpp_new_empty_slide",hot:"other hot",no_picture:"other no_picture",helper_new_msg:"other helper_new_msg",et_col_more:"other et_col_more",et_col_more_dark:"other et_col_more_dark",sequence1:"other sequence1",sequence2:"other sequence2",sequence3:"other sequence3",sequence4:"other sequence4",sequence5:"other sequence5",sequence6:"other sequence6",sequence7:"other sequence7",sequence8:"other sequence8",sequence9:"other sequence9",numbering_symbol1:"other numbering_symbol1",numbering_symbol2:"other numbering_symbol2",numbering_symbol3:"other numbering_symbol3",numbering_symbol4:"other numbering_symbol4",numbering_symbol5:"other numbering_symbol5",numbering_symbol6:"other numbering_symbol6",numbering_symbol7:"other numbering_symbol7",symbol1:"other symbol1",symbol2:"other symbol2",symbol3:"other symbol3",symbol4:"other symbol4",symbol5:"other symbol5",symbol6:"other symbol6",symbol7:"other symbol7",bullets_symbol1:"other bullets_symbol1",bullets_symbol2:"other bullets_symbol2",bullets_symbol3:"other bullets_symbol3",bullets_symbol4:"other bullets_symbol4",bullets_symbol5:"other bullets_symbol5",bullets_symbol6:"other bullets_symbol6",bullets_symbol7:"other bullets_symbol7",symbol_mult_1:"other symbol_mult_1",symbol_mult_2:"other symbol_mult_2",symbol_mult_3:"other symbol_mult_3",symbol_mult_4:"other symbol_mult_4",symbol_mult_5:"other symbol_mult_5",symbol_mult_6:"other symbol_mult_6",symbol_mult_7:"other symbol_mult_7",sequence_mult_1:"other sequence_mult_1",sequence_mult_2:"other sequence_mult_2",sequence_mult_3:"other sequence_mult_3",sequence_mult_4:"other sequence_mult_4",sequence_mult_5:"other sequence_mult_5",sequence_mult_6:"other sequence_mult_6",sequence_mult_7:"other sequence_mult_7",sequence_mult_8:"other sequence_mult_8",sequence_mult_9:"other sequence_mult_9",sequence_mult_10:"other sequence_mult_10",woa_chat:"other woa_chat 1",db_none_group:"other none_group",db_book_no_access:"other db_book_no_access",comment_panel_not_cmt:"other comment_panel_not_cmt",comment_panel_not_resolve_cmt:"other comment_panel_not_resolve_cmt",et_to_db:"other et_to_db",db_none_record:"other db_none_record",db_card_no_note:"other db_card_no_note",db_field_note_tip:"other db_field_note_tip",db_field_link_tip:"other db_field_link_tip",db_field_lookup_tip:"other db_field_lookup_tip",db_link_delete:"other db_link_delete",divider_right:"other divider_right",db_no_history:"other db_no_history",db_flash:"other db_flash",db_date_banner:"other db_date_banner",db_gantt_warn:"other db_gantt_warn",db_none_query_result:"other db_none_query_result",db_dropdown:"other db_dropdown",db_video_viewer_error:"other db_video_viewer_error",db_empty_chart:"other db_empty_chart",db_chart_invalid:"other db_chart_invalid",db_basic_bar:"other db_basic_bar",db_basic_line:"other db_basic_line",db_horiz_bar:"other db_horiz_bar",db_basic_pie:"other db_basic_pie",db_value:"other db_value",k_sheet_db_dropdown:"other k_sheet_db_dropdown",ksheet_et_share_confirm:"other ksheet_et_share_confirm",k_arrow_down_white:"other k_arrow_down_white",otl_playbar_plus:"other otl_playbar_plus",otl_playbar_minus:"other otl_playbar_minus",otl_switch_catalog:"other otl_switch_catalog",otl_cloud:"other otl_cloud",otl_catalog_arrow:"other otl_catalog_arrow",otl_catalog_arrow_hover:"other otl_catalog_arrow_hover",otl_catalog_pin_active:"other otl_catalog_pin_active",otl_moremenu:"other otl_moremenu 1",otl_at_in_box:"other otl_at_in_box",otl_woa:"other otl_woa",otl_meetings:"other otl_meetings",otl_message:"other otl_message",otl_logo:"other otl_logo",otl_arrow_down:"other otl_arrow_down",et_icon_30:"other et_icon_30",office_icon_30:"other office_icon_30",pdf_touch_scroll:"other pdf_touch_scroll",emotion_hate:"other emotion_hate",emotion_dislike:"other emotion_dislike",emotion_neutral:"other emotion_neutral",emotion_like:"other emotion_like",emotion_love:"other emotion_love",new_tag:"other new_tag",weboffice:"other weboffice",video_play_large:"other video_play_large",video_replay:"other video_replay",nonsupport_video:"other nonsupport_video",nonsupport_video_in_template:"other nonsupport_video_in_template",video_no_permission:"other video_no_permission",video_load_fail:"other video_load_fail",video_loading:"other video_loading",pdf_anno_list_right_empty:"other pdf_anno_list_right_empty",ksheet_invalid_page:"other invalid_page",ksheet_db_pic_placeholder:"other ksheet_db_pic_placeholder",k_app_local:"other k_app_local",ksheet_app_close:"other ksheet_app_close",k_logo:"other k_logo",k_keyboard_mark:"other k_keyboard_mark",k_keyboard_backslash:"other k_keyboard_backslash",k_keyboard_semicolon:"other k_keyboard_semicolon",k_keyboard_bracket:"other k_keyboard_bracket",k_portrait:"other k_portrait",k_landscape:"other k_landscape",k_allColPage:"other k_allColPage",k_allRowPage:"other k_allRowPage",k_inPage:"other k_inPage",k_color_select_white:"other k_color_select_white",k_color_select_black:"other k_color_select_black",k_et_icon:"other k_et_icon",ksheet_switch_catalog:"other ksheet_switch_catalog",ksheet_moremenu:"other ksheet_moremenu",ksheet_db_none_query_result:"other ksheet_db_none_query_result",scrollbar_left_arrow:"other scrollbar_left_arrow",template_btn:"other template_btn",template_btn_hover:"other template_btn_hover",pivot_move:"other pivot_move",air_flow_print_fullscreen:"other air_flow_print_fullscreen",air_flow_print_quit_fullscreen:"other air_flow_print_quit_fullscreen",air_flow_no_script:"other air_flow_no_script",air_flow_maximize:"other air_flow_maximize",air_flow_restore_window:"other air_flow_restore_window"},voice:{voiceNormal:"other voiceNormal",transform:"other transform",transform_hot:"other transform_hot",loading:"24 loading",comment_alert:"other comment_alert"},text_style:{title1:"text_style text_style1",title2:"text_style text_style2",title3:"text_style text_style3",title4:"text_style text_style4",title5:"text_style text_style5"},separator_line:{line_single:"separator_line line_single",line_dot:"separator_line line_dot",line_dash_small_gap:"separator_line line_dash_small_gap",line_dash_large_gap:"separator_line line_dash_large_gap",line_dash_dot:"separator_line line_dash_dot",line_dash_dot_dot:"separator_line line_dash_dot_dot",line_double:"separator_line line_double",line_triple:"separator_line line_triple",line_thin_thick_small_gap:"separator_line line_thin_thick_small_gap",line_thick_thin_small_gap:"separator_line line_thick_thin_small_gap",line_thin_thick_thin_small_gap:"separator_line line_thin_thick_thin_small_gap",line_thin_thick_med_gap:"separator_line line_thin_thick_med_gap",line_thick_thin_med_gap:"separator_line line_thick_thin_med_gap",line_thin_thick_thin_med_gap:"separator_line line_thin_thick_thin_med_gap",line_thin_thick_large_gap:"separator_line line_thin_thick_large_gap",line_thick_thin_large_gap:"separator_line line_thick_thin_large_gap",line_thin_thick_thin_large_gap:"separator_line line_thin_thick_thin_large_gap",line_single_wavy:"separator_line line_single_wavy",line_double_wavy:"separator_line line_double_wavy",line_dash_dot_stroked:"separator_line line_dash_dot_stroked",line_emboss_3D:"separator_line line_emboss_3D",line_engrave_3D:"separator_line line_engrave_3D"},summary:{share:"summary share",pdf:"summary pdf",print:"summary print",picture:"summary picture",modal_bg:"summary modal_bg",feedback:"summary feedback",step1:"summary step1",step2:"summary step2",step3:"summary step3",wrong:"summary wrong",right:"summary right",checked:"summary checked",logo:"summary logo"},context:{copy:"context copy",cut:"context cut",paste:"context paste",k_copy:"context k_copy",k_cut:"context k_cut",k_paste:"context k_paste",paste_text:"context paste_text",share:"context share",convense:"context convense",hyperlink:"context hyperlink",link_edit:"context link_edit",link_delete:"context link_delete",insert_bookmark:"context insert_bookmark",hyperlink_more:"context hyperlink_more",change_img:"context change_img",save_img:"context save_img",img_org_src:"context img_org_src",insert_row_col:"context insert_row_col",delete_row_col:"context delete_row_col",insert_top_row:"context insert_top_row",insert_bottom_row:"context insert_bottom_row",insert_left_col:"context insert_left_col",insert_right_col:"context insert_right_col",delete_row:"context delete_row",delete_col:"context delete_col",delete_table:"context delete_table",font:"context font",paragraph_bar_insert_below:"context paragraph_bar_insert_below",paragraph_bar_image_operate:"context paragraph_bar_image_operate",paragraph_bar_text_attr:"context paragraph_bar_text_attr",paragraph_bar_object_attr:"context set_object_block_style",dashed_border:"context dashed_border"}}},2849:function(e,t,n){"use strict";function i(e){var t={};if(9===e.length){t.hex="#"+e.substring(3);var n=parseInt(e.substring(1,3),16);t.trans=Math.round(100*(255-n)/255)}else t.hex=e,t.trans=100;return t}function r(e,t){var n=Math.round(255*(100-t)/100).toString(16);n.length<2&&(n="0"+n);var i=e.substring(1);return 1===i.length?i="00000"+i:i.length>6&&(i=i.substring(i.length-6)),"#"+n+i}function o(e){var t=0,n=0,i=0,r=0;return 9===e.length?(t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),r=parseInt(e.substring(7),16)):8===e.length?(t=parseInt(e.substring(1,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),r=parseInt(e.substring(6),16)):7===e.length&&(n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5),16),t=0),{a:t,r:n,g:i,b:r}}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},302:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=function(){function e(){r()(this,e)}return a()(e,null,[{key:"rgbIntToHexStr",value:function(t){var n=e.storeHex.get(t);if(n)return n;if("number"!=typeof t)return"";var i=t.toString(16).toUpperCase();return i.length<"000000".length&&(i="000000".slice(i.length)+i),e.storeHex.set(t,"#"+i),"#"+i}},{key:"extractLiteral",value:function(t){var n=e.storeExtra.get(t);if(n)return n;var i={red:parseInt(t.substr(1,2),16),green:parseInt(t.substr(3,2),16),blue:parseInt(t.substr(5,2),16)};return e.storeExtra.set(t,i),i}},{key:"hexStrToRgbInt",value:function(e){return e=e.replace("#","0x"),parseInt(e)}},{key:"argbIntToHexStr",value:function(e){if("number"!=typeof e)return"";var t=(e&=16777215).toString(16).toUpperCase();return t.length<"000000".length&&(t="000000".slice(t.length)+t),"#"+t}},{key:"hexStrToArgbInt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return console.assert(t>=0&&t<=255),e=e.replace("#","0x"+t.toString(16)),parseInt(e)}},{key:"rgbIntToRgbStr",value:function(e){return[e>>16&255,e>>8&255,255&e].join(",")}},{key:"hexToRgbStr",value:function(t){var n=e.hexStrToRgbInt(t);return e.rgbIntToRgbStr(n)}},{key:"rgbObjToHexStr",value:function(e){var t=e.red<<16|e.green<<8|e.blue;return this.rgbIntToHexStr(t)}},{key:"compareThemeColor",value:function(e,t){return void 0===e&&void 0===t||void 0!==e&&void 0!==t&&e.get()===t.get()}},{key:"middleHexColor",value:function(e,t){e=e.substr(1),t=t.substr(1);for(var n=[e.substr(0,2),e.substr(2,2),e.substr(4,2)],i=[t.substr(0,2),t.substr(2,2),t.substr(4,2)],r=[],o=0;o<n.length;o++){var a=parseInt(n[o],16)+parseInt(i[o],16);1===(a=parseInt(a/2).toString(16)).length&&(a="0"+a),r.push(a.toUpperCase())}return"#"+r.join("")}},{key:"blendColor",value:function(e,t){var n=this.hexStrToRgbInt(e),i=this.hexStrToRgbInt(t),r=void 0;if(0===n)return r=this.rgbObjToHexStr({red:66,green:73,blue:90}),r;var o=.67*(n>>16&255)+.33*(i>>16&255)&255,a=.65*(n>>8&255)+.35*(i>>8&255)&255,s=.67*(255&n)+.33*(255&i)&255;return r=this.rgbObjToHexStr({red:o,green:a,blue:s}),r}},{key:"reverseAlphaBlend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6,n=this.hexStrToRgbInt(e),i=n>>16&255,r=n>>8&255,o=255&n,a=1/(1-t);return i=a*(i-255*t),r=a*(r-255*t),o=a*(o-255*t),this.rgbObjToHexStr({red:i,green:r,blue:o})}},{key:"checkLightColor",value:function(e){var t=(e=e.replace("rgb(","").replace(")","")).split(",");return.299*t[0]+.587*t[1]+.114*t[2]>=192}}]),e}();s.storeHex=new Map,s.storeExtra=new Map,t.default=s},312:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(22),l=n.n(s),d=n(23),h=n.n(d),c=(n(1530),n(238)),_=n.n(c),u=n(250),p=n.n(u),f=n(248),g=function(e){function t(){var e,n,i,o;r()(this,t);for(var a=arguments.length,s=Array(a),d=0;d<a;d++)s[d]=arguments[d];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.refWrap=_.a.createRef(),o=n,l()(i,o)}return h()(t,e),a()(t,[{key:"componentDidMount",value:function(){}},{key:"getElement",value:function(){return this.refWrap.current}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.selected,r="component-icon-btn";return e.isDropdown&&(r+=" dropdown"),n&&(r+=" disabled"),i&&(r+=" selected"),e.showBorder&&(r+=" show-border"),t&&(r+=" "+t),r}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.disabled,i=e.title,r=e.iconType,o=e.keepEdit,a=e.altHintKeep,s=e.altForceDirection,l=e.altHintEvent,d=e.altRenderDelay,h=e.altScPosition,c=e.onClick,u=e.onDoubleClick,g=e.onMouseEnter,v=e.onMouseLeave;n&&(c=void 0,u=void 0);var m=this.getClassName();return _.a.createElement(p.a,{title:i,onMouseEnter:g,onMouseLeave:v},_.a.createElement("div",{ref:this.refWrap,id:t,className:m,"data-keep-edit":o||void 0,onClick:c,onDoubleClick:u,role:"button","alt-hint-keep":a,"alt-hint-event":l,"alt-render-delay":d,"alt-sc-position":h,"alt-force-direction":s},_.a.createElement(f.default,{type:r})))}}]),t}(c.PureComponent);g.iconTypes=f.default.types,t.default=g},3284:function(e,t,n){"use strict";var i=n(8),r=n.n(i),o=n(1),a=n.n(o),s=n(2),l=n.n(s),d=n(1583),h=n(167),c=n(260),_={},u=[];function p(e){var t=_[e];return void 0===t?(t=0,_[e]=1):++_[e],e+"_"+t}function f(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}window.addEventListener(c.default.watermark.REMOVE_WATERMARK_OLD_NODE,(function(e){var t=e.detail.outerHTML;u=u.filter((function(e){return!t||!t.match(e.key)||(e.observer.disconnect(),!1)}))}));var g={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},v=Object.keys(g),m=function(){function e(t,n){a()(this,e),this.__root=t,this.__ctx=n}return l()(e,[{key:"addColorStop",value:function(e,t){var n=this.__ctx.__createElement("stop"),i=void 0;n.setAttribute("offset",e),-1!==t.indexOf("rgba")?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t),n.setAttribute("stop-color","rgb("+i[1]+","+i[2]+","+i[3]+")"),n.setAttribute("stop-opacity",i[4])):n.setAttribute("stop-color",t),this.__root.appendChild(n)}}]),e}(),y=function e(t,n){a()(this,e),this.__root=t,this.__ctx=n},b=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00(?=[\s]+)))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:%|in|[cem]m|ex|p[ctx])))?\s*([\s\S]+?)$/i,w={},x=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,e);var i={width:500,height:500};this.__width=n.width||i.width,this.__height=n.height||i.height,this.__segmentOffsetHeight=n.segmentOffsetHeight||0,this.__fakeHeight=0,this.canvas=this,this.__document=n.document||document,n.ctx?this.__ctx=n.ctx:console.error("必须传入ctx参数"),this.__setDefaultStyles(),n.globalAlpha&&(this.globalAlpha=n.globalAlpha),this.__undoStack=[],this.__groupStack=[],this.__insertPosStack=[],this.__createSVGElement=function(e){return t.__document.createElementNS("http://www.w3.org/2000/svg",e)},this.__createTextNode=function(e,n){e.appendChild(t.__document.createTextNode(n))},this.__root=this.__createSVGElement("svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.__width),this.__root.setAttribute("height",this.__height),this.__root.setAttribute("overflow","hidden"),this.__root.setAttribute("viewBox","0 0 "+this.__width+" "+this.__height),this.__defs=this.__createSVGElement("defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__createSVGElement("g"),this.__root.appendChild(this.__currentElement),n.blobMode||(this.__root.setAttribute("class","text-page"),this.__root.addEventListener("dragstart",(function(e){if("IMAGE"===e.target.tagName.toUpperCase())return e.preventDefault(),!1}),!0))}return l()(e,[{key:"__createElement",value:function(e,t,n){var i=t;void 0===i&&(i={});var r=this.__createSVGElement(e),o=Object.keys(i),a=void 0,s=void 0;for(n&&(r.setAttribute("fill","none"),r.setAttribute("stroke","none")),a=0;a<o.length;a++)s=o[a],r.setAttribute(s,i[s]);return r}},{key:"getElem",value:function(){return this}},{key:"getContext",value:function(){return this}},{key:"__setDefaultStyles",value:function(){var e=v,t=void 0,n=void 0;for(t=0;t<e.length;t++)this["__"+(n=e[t])]=g[n].canvas}},{key:"__applyStyleToCurrentElement",value:function(e){var t=this.__currentElement,n=this.__currentElementsToStyle;n&&(t.setAttribute(e,""),t=n.element,n.children.forEach((function(t){t.setAttribute(e,"")})));var i=v,r=void 0,o=void 0,a=void 0,s=void 0;for(r=0;r<i.length;r++)if(o=g[i[r]],void 0!==(a=this["__"+i[r]])&&o.apply)if(a instanceof y)t.setAttribute(o.apply,"url(#"+a.__root.getAttribute("id")+")");else if(a instanceof m)t.setAttribute(o.apply,"url(#"+a.__root.getAttribute("id")+")");else if(-1!==o.apply.indexOf(e)&&o.svg!==a)if("stroke"!==o.svgAttr&&"fill"!==o.svgAttr||-1===a.indexOf("rgba")){var l=o.svgAttr;if("globalAlpha"===i[r]&&(l=e+"-"+o.svgAttr,t.getAttribute(l)))continue;t.setAttribute(l,a)}else if(s=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(a)){t.setAttribute(o.svgAttr,"rgb("+s[1]+","+s[2]+","+s[3]+")");var d=s[4],h=this.globalAlpha;null!=h&&(d*=h),t.setAttribute(o.svgAttr+"-opacity",d)}}},{key:"__closestGroupOrSvg",value:function(e){var t=e;return"g"===(t=t||this.__currentElement).nodeName||"svg"===t.nodeName?t:this.__currentGroup?this.__currentGroup:this.__closestGroupOrSvg(t.parentNode)}},{key:"getSvg",value:function(){return this.__root}},{key:"resetInsertPos",value:function(){this.__insertPos=0}},{key:"seekNextInsertPos",value:function(){++this.__insertPos}},{key:"seekEndInsertPos",value:function(){this.__insertPos=this.__currentElement.childNodes.length}},{key:"saveAndRestore",value:function(e,t){var n=t||this.__createElement("g");t||(e&&n.setAttribute("id",e),this.__closestGroupOrSvg().appendChild(n));var i=this.enterChildCtxByNode(n);return i.__currentElement=i.__currentGroup=n,{ctx:i,node:n}}},{key:"save",value:function(e,t){var n=t||this.__createElement("g");e&&n.setAttribute("id",e);var i=this.__closestGroupOrSvg();return this.__groupStack.push(i),this.__currentGroup=this.__currentElement=n,this.__undoStack.push(this.__undoState),this.__undoState=null,this.__insertPosStack.push(this.__insertPos),this.__insertPos=0,n}},{key:"restore",value:function(e,t){for(var n=this.__currentGroup;n.parentNode;)n=n.parentNode;var i=!t&&(!e||this.hasVaildNoes(n));if(i&&n.clipRect){var r=n.clipRect,o=r.x,a=r.y,s=r.width,l=r.height;this.clipRect(o,a,s,l),n.clipRect=null}return this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]),this.__currentGroup=this.__currentElement,this.__insertPos=this.__insertPosStack.pop(),i&&(this.__insertPos>=this.__currentElement.childNodes.length?this.__currentElement.appendChild(n):this.__currentElement.insertBefore(n,this.__currentElement.childNodes[this.__insertPos]),++this.__insertPos),this.__undo(this.__undoState),this.__undoState=this.__undoStack.pop(),i}},{key:"__addTransform",value:function(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0||t.clipRect){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var n=this.__createElement("g");t.appendChild(n),this.__currentElement=n}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=e,this.__currentElement.setAttribute("transform",i)}},{key:"scale",value:function(e,t){var n=t;void 0===n&&(n=e),1==e&&1==n||this.__addTransform("scale("+e+","+n+")")}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){var i=180*e/Math.PI;this.__addTransform("rotate("+i+", "+t+", "+n+")")}}},{key:"translate",value:function(e,t){0==e&&0==t||this.__addTransform("translate("+e+", "+t+")")}},{key:"transform",value:function(e,t,n,i,r,o){this.__addTransform("matrix("+e+", "+t+", "+n+", "+i+", "+r+", "+o+")")}},{key:"beginPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.__currentDefaultPath="",this.__currentPosition={};var t=this.__createElement("path",e,!0),n=this.__closestGroupOrSvg();this.__parentOfPath=n,this.__currentElement=t}},{key:"__applyCurrentDefaultPath",value:function(){var e=this.__currentElement;"path"===e.nodeName?(e.setAttribute("d",this.__currentDefaultPath),this.__parentOfPath&&this.__parentOfPath.appendChild(e)):console.error("Attempted to apply path command to node",e.nodeName)}},{key:"__addPathCommand",value:function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e}},{key:"moveTo",value:function(e,t){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand("M "+e+" "+t)}},{key:"closePath",value:function(){this.__currentDefaultPath&&this.__addPathCommand("Z")}},{key:"lineTo",value:function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand("L "+e+" "+t):this.__addPathCommand("M "+e+" "+t)}},{key:"bezierCurveTo",value:function(e,t,n,i,r,o){this.__currentPosition={x:r,y:o},this.__addPathCommand("C "+e+" "+t+" "+n+" "+i+" "+r+" "+o)}},{key:"bezierCurToContinue",value:function(e,t,n,i){this.__currentPosition={x:n,y:i},this.__addPathCommand("S "+e+" "+t+" "+n+" "+i)}},{key:"quadraticCurveTo",value:function(e,t,n,i){this.__currentPosition={x:n,y:i},this.__addPathCommand("Q "+e+" "+t+" "+n+" "+i)}},{key:"arcTo",value:function(e,t,n,i,r,o,a){this.__currentPosition={x:o,y:a},this.__addPathCommand("A "+e+" "+t+" "+n+" "+i+" "+r+" "+o+" "+a)}},{key:"stroke",value:function(){if("path"===this.__currentElement.nodeName){var e=g.fillStyle.svg;null!==e&&"none"!==e&&this.__currentElement.setAttribute("paint-order","fill stroke markers")}return this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke"),this.__currentElement}},{key:"fill",value:function(e){"path"===this.__currentElement.nodeName&&(this.__currentElement.setAttribute("paint-order","stroke fill markers"),"evenodd"==e&&this.__currentElement.setAttribute("fill-rule","evenodd")),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")}},{key:"rect",value:function(e,t,n,i){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.lineTo(e,t),this.closePath()}},{key:"fillRect",value:function(e,t,n,i){var r=this.__createElement("rect",{x:e,y:t,width:Math.max(n,0),height:Math.max(i,0)},!0);return this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("fill"),r}},{key:"strokeRect",value:function(e,t,n,i){var r=this.__createElement("rect",{x:e,y:t,width:Math.max(n,0),height:Math.max(i,0)},!0);this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")}},{key:"createLinearGradient",value:function(e,t,n,i){var r=this.__createElement("linearGradient",{id:p("LG"),x1:e+"px",x2:n+"px",y1:t+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__currentElement.appendChild(r),new m(r,this)}},{key:"createRadialGradient",value:function(e,t,n,i,r,o){var a=this.__createElement("radialGradient",{id:p("RG"),cx:i+"px",cy:r+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__currentElement.appendChild(a),new m(a,this)}},{key:"__parseFontStr",value:function(e){var t=e.indexOf('"'),n=void 0,i=void 0;t>=0?(n=e.substring(0,t)+"fontName",i=e.substring(t).trim()):n=e;var r=b.exec(n)||[];return 0===r.length&&console.log("svg font cannot match canvas font!maybe regex error!"),{fontStyle:r[1]||"normal",fontSize:r[4]||"10px",fontFamily:i||r[6]||"sans-serif",fontWeight:r[3]||"normal"}}},{key:"__wrapTextLink",value:function(e,t){if(e.href){var n=this.__createElement("a");return n.setAttribute("xlink:href",e.href),n.appendChild(t),n}return t}},{key:"__applyText",value:function(e,t,n,i){var r,o,a=this.fontFace,s=this.__closestGroupOrSvg(),l=this.__createElement("text",{"font-family":this.getFixFontFamilyName(a.fontFamily),"font-size":a.fontSize,"font-style":a.fontStyle,"font-weight":a.fontWeight,x:t,y:n,"text-anchor":(r=this.textAlign,o={left:"start",right:"end",center:"middle",start:"start",end:"end"},o[r]||o.start),"dominant-baseline":f(this.textBaseline)},!0);this.__createTextNode(l,e),this.__currentElement=l,this.__applyStyleToCurrentElement(i);var d=this.__wrapTextLink(a,l);s.appendChild(d)}},{key:"fillText",value:function(e,t,n){this.__applyText(e,t,n,"fill")}},{key:"strokeText",value:function(e,t,n){this.__applyText(e,t,n,"stroke")}},{key:"measureText",value:function(e){var t=this.fontFace,n=t.fontStyle,i=t.fontWeight,r=t.fontSize,o=t.fontFamily;return this.__ctx.font=n+" "+i+" "+r+' "'+o+'"',this.__ctx.measureText(e)}},{key:"arc",value:function(e,t,n,i,r,o){var a=i,s=r;if(a!==s){(a%=2*Math.PI)===(s%=2*Math.PI)&&(s=(s+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var l=e+n*Math.cos(s),d=t+n*Math.sin(s),h=e+n*Math.cos(a),c=t+n*Math.sin(a),_=o?0:1,u=0,p=s-a;p<0&&(p+=2*Math.PI),u=o?p>Math.PI?0:1:p>Math.PI?1:0,this.lineTo(h,c),this.__addPathCommand("A "+n+" "+n+" 0 "+u+" "+_+" "+l+" "+d),this.__currentPosition={x:l,y:d}}}},{key:"clip",value:function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),n=p("CP");this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",n),t.appendChild(this.__currentElement),e.setAttribute("clip-path","url(#"+n+")"),this.__currentElement=e,e.appendChild(t)}},{key:"clipRect",value:function(e,t,n,i){var r=this.__closestGroupOrSvg(),o=p("CP"),a=this.__createElement("clipPath",{id:o}),s=this.__createElement("rect",{x:e,y:t,width:n,height:i});a.appendChild(s),this.__currentElement=r,r.setAttribute("clip-path","url(#"+o+")"),r.appendChild(a)}},{key:"drawImage",value:function(){var t=Array.prototype.slice.call(arguments),n=t[0],i=void 0,r=void 0,o=void 0,a=void 0,s=0,l=0,d=void 0,h=void 0,c=void 0,_=void 0,u=void 0,p=void 0,f=void 0;if(3===t.length)i=t[1],r=t[2],o=d=n.width,a=h=n.height;else if(5===t.length)i=t[1],r=t[2],o=t[3],a=t[4],d=n.width,h=n.height;else{if(9!==t.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);s=t[1],l=t[2],d=t[3],h=t[4],i=t[5],r=t[6],o=t[7],a=t[8]}var g=this.__closestGroupOrSvg(),v="translate("+i+", "+r+")";if(n instanceof e){if((c=n.getSvg().cloneNode(!0)).childNodes&&c.childNodes.length>1){for(_=c.childNodes[0];_.childNodes.length;)this.__defs.appendChild(_.childNodes[0]);if(u=c.childNodes[1]){var m=u.getAttribute("transform"),y=void 0;y=m?m+" "+v:v,u.setAttribute("transform",y),g.appendChild(u)}}}else if("CANVAS"===n.nodeName||"IMG"===n.nodeName)return(p=this.__createSVGElement("image")).setAttribute("width",o),p.setAttribute("height",a),p.setAttribute("preserveAspectRatio","none"),(s||l||d!==n.width||h!==n.height)&&((f=this.__document.createElement("canvas")).width=o,f.height=a,f.getContext("2d").drawImage(n,s,l,d,h,0,0,o,a),n=f),p.setAttribute("transform",v),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===n.nodeName?n.toDataURL():n.getAttribute("src")),g.appendChild(p),p}},{key:"createPattern",value:function(t,n){var i=this.__createSVGElement("pattern"),r=p("PATTERN"),o=void 0;return i.setAttribute("id",r),i.setAttribute("width",t.width),i.setAttribute("height",t.height),i.setAttribute("patternUnits","userSpaceOnUse"),"CANVAS"===t.nodeName||"IMG"===t.nodeName?((o=this.__createSVGElement("image")).setAttribute("width",t.width),o.setAttribute("height",t.height),o.setAttribute("xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),i.appendChild(o),this.__defs.appendChild(i)):t instanceof e&&(i.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(i)),new y(i,this)}},{key:"createPathPattern",value:function(e,t,n,i,r){var o=this.__createSVGElement("pattern"),a=p("PATTERN");o.setAttribute("id",a),o.setAttribute("patternUnits","userSpaceOnUse"),o.setAttribute("width",e),o.setAttribute("height",t);var s=this.__createSVGElement("path");return s.setAttribute("d",n),r&&s.setAttribute("stroke",r),i&&s.setAttribute("fill",i),o.appendChild(s),this.__closestGroupOrSvg().appendChild(o),new y(o,this)}},{key:"setLineDash",value:function(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null}},{key:"saveAndSetAlpha",value:function(e){this.oldGlobalAlyph||(this.oldGlobalAlyph=[]),this.oldGlobalAlyph.push(this.globalAlpha),this.globalAlpha=e}},{key:"restoreAlpha",value:function(){this.oldGlobalAlyph&&(this.globalAlpha=this.oldGlobalAlyph.pop())}},{key:"resetAlpha",value:function(){this.__globalAlpha=1}},{key:"setLineWidth",value:function(e){this.lineWidth=e}},{key:"drawFocusRing",value:function(){}},{key:"createImageData",value:function(){}},{key:"getImageData",value:function(){}},{key:"putImageData",value:function(){}},{key:"globalCompositeOperation",value:function(){}},{key:"setTransform",value:function(){}},{key:"markRestore",value:function(){}},{key:"restoreLineWidth",value:function(){}},{key:"restoreStyle",value:function(){}},{key:"restoreTextBaseline",value:function(){this.textBaseline="alphabetic"}},{key:"retoreFillStyle",value:function(){}},{key:"restoreFillStyle",value:function(){}},{key:"restoreLineDash",value:function(){this.setLineDash&&this.setLineDash([])}},{key:"retoreStrokeStyle",value:function(){}},{key:"restoreStrokeStyle",value:function(){}},{key:"getDominantBaseline",value:function(e){return f(e)}},{key:"enterChildCtxByNode",value:function(e){var t={};t.parent=this,t.__proto__=this.__proto__,t.__width=this.__width,t.__height=this.__height,t.__document=this.__document,t.__root=this.__root,t.__undoStack=[],t.__groupStack=[],t.__insertPosStack=[],t.__defs=this.__defs,t.__canvas=this.__canvas,t.__ctx=this.__ctx,t.__createSVGElement=this.__createSVGElement,t.__createTextNode=this.__createTextNode,t.__currentElement=e,t.__mode=this.__mode,t.__insertPos=0;for(var n=0,i=v.length;n<i;++n){var r="__"+v[n];t[r]=this[r]}return t}},{key:"createCtxFragment",value:function(e,t,n){var i=this.enterChildCtxByNode();return i.__currentElement=i.__currentGroup=n||i.createG(e),i}},{key:"hasVaildNoes",value:function(e){if("g"===e.nodeName)for(var t=e.childNodes,n=0,i=t.length;n<i;++n){var r=t[n],o=r.nodeName;if("g"===o){if(""!==e.getAttribute("id")||this.hasVaildNoes(r))return!0}else if("clipPath"!==o)return!0}return!1}},{key:"commitVaildNodesToCurrentChild",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=e.__currentGroup||e.__currentElement;if(this.hasVaildNoes(i)){var r=this.__closestGroupOrSvg(),o=r.childNodes;return t||!o.length||n>=o.length?r.appendChild(i):r.insertBefore(i,o[Math.max(n,0)]),i}return null}},{key:"reSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.width,i=e.height;n=Math.ceil(n),i=Math.ceil(i);var r=t.withZoom,o=void 0===r||r,a=o?d.a.getZoom():1,s=Math.ceil(n*a),l=Math.ceil(i*a),h=!1;this.__width!==s&&(h=!0,this.__width=s,this.__root.setAttribute("width",this.__width)),this.__height!==l&&(this.__height=l,this.__segmentOffsetHeight?this.__height>=this.__fakeHeight&&(h=!0,this.__fakeHeight=(this.__height<this.__fakeHeight+this.__segmentOffsetHeight*a?this.__fakeHeight:this.__height)+this.__segmentOffsetHeight*a,this.__root.setAttribute("height",this.__fakeHeight)):(h=!0,this.__fakeHeight=l,this.__root.setAttribute("height",this.__height))),h&&this.__root.setAttribute("viewBox","0 0 "+n+" "+Math.ceil(this.__fakeHeight/a))}},{key:"getLayoutSize",value:function(){return{width:this.__width,height:this.__height}}},{key:"initCanvas",value:function(e){var t=this;e.forEach((function(e){var n=t.__createSVGElement("g");n.setAttribute("id",e),t.__currentElement.appendChild(n)}))}},{key:"clearRect",value:function(e,t,n,i){}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=function(e){for(var t=e.childNodes,n=t.length-1;n>=0;n--)t[n]&&("wmk"===t[n].id&&function(){var e=t[n].querySelector("g rect"),i=e&&e.getAttribute("fill");u=u.filter((function(e){return e.fill!==i||(e.observer.disconnect(),!1)}))}(),e.removeChild(t[n]))};t(this.__currentElement),e&&t(this.__defs)}},{key:"fillTextPos",value:function(e,t,n,i){var r="",o="",a="";e instanceof Array?e.forEach((function(e){r+=e})):r=e,t instanceof Array?t.forEach((function(e){o+=e.toFixed(2)+" "})):o=t,n instanceof Array?n.forEach((function(e){a+=e.toFixed(2)+" "})):a=n;var s={x:o,y:a},l=this.fontFace,d=this.__closestGroupOrSvg();l&&(i.family!=l.fontFamily&&(s["font-family"]=this.getFixFontFamilyName(l.fontFamily)),i.size!=l.fontSize&&(s["font-size"]=this.toFixFontSize(l.fontSize)),i.style!=l.fontStyle&&(s["font-style"]=l.fontStyle),i.weight!=l.fontWeight&&(s["font-weight"]=l.fontWeight)),i&&i.fillStyle!=this.fillStyle&&(s.fill=this.fillStyle),this.globalAlpha&&1!==this.globalAlpha&&(s.opacity=this.globalAlpha);var h=this.__createSVGElement("text");this.__createTextNode(h,r);for(var c,_=Object.keys(s),u=0,p=_.length;u<p;++u)c=_[u],h.setAttribute(c,s[c]);return d.appendChild(h),h}},{key:"fillTextBuff",value:function(e,t,n,i,r,o,a,s){var l={},d=this.fontFace;if(d&&(o.family!=d.fontFamily&&(l["font-family"]=this.getFixFontFamilyName(d.fontFamily)),o.size!=d.fontSize&&(l["font-size"]=this.toFixFontSize(d.fontSize)),o.style!=d.fontStyle&&(l["font-style"]=d.fontStyle),o.weight!=d.fontWeight&&(l["font-weight"]=d.fontWeight)),o&&o.fillStyle!=this.fillStyle&&(l.fill=this.fillStyle),this.globalAlpha&&1!==this.globalAlpha&&(l.opacity=this.globalAlpha),a.attrs){var h=a.horzScale!=i||a.vertScale!=r,c=Object.keys(l),_=void 0,u=c.length,p=void 0,f=a.attrs;if(h||Object.keys(f).length!==u)h=!0;else for(_=0,u=c.length;_<u;++_){var g=f[p=c[_]];if(void 0===g||g!=l[p]){h=!0;break}}if(!h)return s||(a.x.push(t),a.y.push(n)),void a.text.push(e);this.commitTextBuff(a)}a.attrs=l,a.horzScale=i,a.vertScale=r,a.text=[e],a.x=[t],a.y=[n]}},{key:"commitTextBuff",value:function(e){var t=e.attrs,n=e.text,i=e.horzScale,r=e.vertScale,o=e.x,a=e.y;if(n&&n.length){var s=this.__createSVGElement("text");this.__createTextNode(s,n.join(""));var l,d=Object.keys(t),h=void 0,c=void 0;for(h=0,l=d.length;h<l;++h)c=d[h],s.setAttribute(c,t[c]);s.setAttribute("x",o.join("")),s.setAttribute("y",a.join(""));var _=1!=i||1!=r;_&&(this.save(),this.scale(i,r)),this.__closestGroupOrSvg().appendChild(s),_&&this.restore(),e.attrs=null,e.text=null}}},{key:"addImageNode",value:function(e,t,n,i,r){var o=this.__createSVGElement("image");o.setAttribute("draggable",!1);var a=this.__closestGroupOrSvg();return void 0!==t&&o.setAttribute("x",Math.round(t)),void 0!==n&&o.setAttribute("y",Math.round(n)),void 0!==i&&o.setAttribute("width",Math.round(i)),void 0!==r&&o.setAttribute("height",Math.round(r)),e&&o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),a.appendChild(o),o}},{key:"addDefString",value:function(e){if(h.isIE){var t=document.createElement("div");t.innerHTML=e,this.__defs.appendChild(t.firstElementChild)}else this.__defs.innerHTML+=e}},{key:"addDefNode",value:function(e){if(e instanceof y)return this.__defs.appendChild(e.__root);this.__defs.appendChild(e)}},{key:"addRect",value:function(e,t,n,i,r){var o=this.__createElement("rect",{x:e,y:t,width:n,height:i,fill:r},!1);return this.__closestGroupOrSvg().appendChild(o),r.match("#wmk")&&!u.find((function(e){return e.fill===r}))&&this.watchWatermarkElement(r),o}},{key:"watchWatermarkElement",value:function(e){var t=this.__root.querySelector("svg.text-page > g"),n=new MutationObserver((function(e){e.forEach((function(e){if("childList"===e.type){var t=[].concat(r()(e.addedNodes)),n=[].concat(r()(e.removedNodes));1!==t.length||"wmk"!==t[0].id&&"wmk"!==e.target.id?n.length&&n.forEach((function(e){u.forEach((function(t){if(e.outerHTML.match(t.key)){var n=t.mount.querySelector("#wmk");n&&t.mount.removeChild(n),t.mount.appendChild(t.element),t.element=t.element.cloneNode(!0)}}))})):u.forEach((function(n){var i="wmk"===t[0].id?t[0]:"wmk"===e.target.id?e.target:void 0;i&&i.outerHTML.match(n.key)&&!n.element&&(n.element=i.cloneNode(!0))}))}else"attributes"===e.type&&e.target.removeAttribute("style")}))}));n.observe(t,{attributes:!0,childList:!0,subtree:!0});var i=e.match(/url\(#([^)]*)\)/)[1];u.push({key:i,fill:e,observer:n,mount:t})}},{key:"getFixFontFamilyName",value:function(e){var t=e,n=window.APP.fontServer;return w[t]||(w[t]=t.replace(/"/g,"")),t=w[t],n.getFontNameForRender(t)}},{key:"setTextpageBaseFont",value:function(e){var t=this.__closestGroupOrSvg();e.family&&t.setAttribute("font-family",e.family),e.size&&t.setAttribute("font-size",this.toFixFontSize(e.size)),e.style&&t.setAttribute("font-style",e.style),e.weight&&t.setAttribute("font-weight",e.weight),e.fillStyle&&t.setAttribute("fill",e.fillStyle)}},{key:"toFixFontSize",value:function(e){var t=e,n=t.indexOf(".");return n>=0&&(t=t.substring(0,n+3)),t}},{key:"createG",value:function(e){return this.__createElement("g",{id:e})}},{key:"__saveOrgVal",value:function(e){var t=e;this.__undoState||(this.__undoState={}),t="__"+t,this.__undoState[t]||(this.__undoState[t]=this[t])}},{key:"__undo",value:function(e){if(e)for(var t=Object.keys(e),n=0,i=t.length;n<i;++n){var r=t[n];this[r]=e[r]}}},{key:"use",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i.width,o=i.height,a=i.xScale,s=void 0===a?1:a,l=i.yScale,d=void 0===l?1:l,h=i.style,c=this.__createSVGElement("use");c.setAttribute("x",t),c.setAttribute("y",n),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+e),1===s&&1===d||c.setAttribute("transform","scale("+s+", "+d+")"),r&&c.setAttribute("width",r),o&&c.setAttribute("height",o),h&&c.setAttribute("style",h);var _=this.__closestGroupOrSvg();_.appendChild(c)}},{key:"getLastGroup",value:function(){return this.__closestGroupOrSvg()}},{key:"width",get:function(){return this.__width},set:function(e){window.__CONFIG__.wps.isAdaptWebView?(this.__width=e,this.__root.setAttribute("width",this.__width),this.__root.setAttribute("viewBox","0 0 "+this.__width+" "+this.__height)):console.error("目前仅在自适应模式下使用，一般模式，设置该值，放大缩小会有问题")}},{key:"height",get:function(){return this.__height}},{key:"currentNode",get:function(){return this.__currentElement}},{key:"strokeStyle",get:function(){return this.__strokeStyle},set:function(e){this.__strokeStyle!==e&&(this.__saveOrgVal("strokeStyle"),this.__strokeStyle=e)}},{key:"fillStyle",get:function(){return this.__fillStyle},set:function(e){this.__fillStyle!==e&&(this.__saveOrgVal("fillStyle"),this.__fillStyle=e)}},{key:"lineWidth",get:function(){return this.__lineWidth},set:function(e){this.__lineWidth!==e&&(this.__saveOrgVal("lineWidth"),this.__lineWidth=e)}},{key:"globalAlpha",get:function(){return this.__globalAlpha},set:function(e){this.__globalAlpha!==e&&(this.__saveOrgVal("globalAlpha"),this.__globalAlpha=e)}},{key:"font",get:function(){if(!this.__fontFace)return"10px sans-serif";var e=this.__fontFace;return e.fontStyle+" "+e.fontWeight+" "+e.fontSize+'px "'+e.fontFamily+'"'},set:function(e){this.fontFace=this.__parseFontStr(e)}},{key:"fontFace",set:function(e){this.__fontFace!==e&&(this.__saveOrgVal("fontFace"),this.__fontFace=e)},get:function(){return this.__fontFace}},{key:"textAlign",get:function(){return this.__textAlign},set:function(e){this.__textAlign!==e&&(this.__saveOrgVal("textAlign"),this.__textAlign=e)}},{key:"textBaseline",get:function(){return this.__textBaseline},set:function(e){this.__textBaseline!==e&&(this.__saveOrgVal("textBaseline"),this.__textBaseline=e)}},{key:"lineDash",set:function(e){this.__lineDash!==e&&(this.__saveOrgVal("lineDash"),this.__lineDash=e)},get:function(){return this.__lineDash}}]),e}();t.a=x,window.createCanvas2Svg=function(e){return new x(e)}},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCustomProtocalURL=t.registerCustomProtocal=t.isCanFallow=t.isLegalURL=t.openHyperlink=void 0;var i=n(5),r=n(167),o=i.__importDefault(n(82)),a=n(386),s=n(327),l=n(14),d=n(454),h=(0,l.getQuery)("incognito"),c="true"===h||"1"===h,_=function(e){var t=(0,l.getQuery)("sublink"),n=t?parseInt(t)+1:2,i="sublink=".concat(n);e=e+(e.includes("?")?"&":"?")+i,(0,s.callAppLink)(encodeURI(e)).catch((function(){u(e)}))},u=function(e,t){void 0===t&&(t="_blank");var n=window.open(e,t),i=n&&n.opener;!v(e)&&i&&(n.opener=null)};t.openHyperlink=function(e,t){if(w(e)){var n=x(e);return n||window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),n}if(!p(e)||c)return window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1;if(g(e))return r.isMobile?(u(e),!0):(window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1);window.collection2("open_hyperlink");/^[a-z]*\:\/\/|^mailto\:/i.test(e)||(e="https://".concat(e));var i={okBtnText:_i18n("applications.public.helpers.openHyperlink.followLinkCopyLink", "Copy Link"),text:_i18n("applications.public.helpers.openHyperlink.followLinkAlertText", "Due to platform limitations, this link can only be opened in external browsers"),cancelBtnText:_i18n("applications.public.helpers.openHyperlink.cancel", "Cancel"),onOk:function(){(0,a.copyToClipboard)(e),window.Toast.success(_i18n("applications.public.helpers.openHyperlink.followLinkCopySuccessTips", "Copy link succeeded")),t&&t.onOk&&t.onOk()},onCancel:function(){t&&t.onCancle&&t.onCancle()}},o=t&&t.fileInfo;return r.isPCWxMiniProgram||r.isPad&&r.isPadMiniProgram?v(e)?(u(e),!0):(window.Confirm(i),!1):r.isInMiniProgram?v(e)?(_(e),!0):(window.Confirm(i),!1):r.isMobile&&r.isMobileWpsClient||(r.isMobile||r.isPad)&&r.isWOA?(v(e)?_(e):u(e),!0):(0,d.isSupportOfflineOpen)(o)?((0,d.offlineOpen)(e,o,(function(){u(e)})),!0):r.isSafari?(function(e){if(v(e))try{var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noreferrer";var n=new MouseEvent("click",{bubbles:!0,cancelable:!1});t.dispatchEvent(n)}catch(t){u(e)}else u(e)}(e),!0):(u(e),!0)};var p=function(e){var t=/^[`、|~,.?;:/<>'"{}\\\[\]\(\)!@#$%\^&\*\-_=\+·，。、￥？《》：；’‘“{}【】（）——！…]/;if(e.indexOf("javascript:")>-1)return!1;if(/^((https?|ftp)\:\/\/).+/i.test(e)){var n=e.replace(/^https?\:\/\//i,"").replace(/^ftp\:\/\//i,"").replace(/^mailto\:/i,"");if(t.test(n))return!1;return!/^[0-9]/.test(n)||f(n)}if(/^(mailto\:).+/i.test(e))return!0;if(g(e)){n=e.replace(/^tel:/i,"");return!t.test(n)}if(w(e))return!0;if(window.officeType===o.default.dbsheet){if(/^[a-z]*\:\/\/\S/i.test(e))return!0}return f(e)};t.isLegalURL=p;var f=function(e){return/^(((www\.)?[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*\.(com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|xxx|idv|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|yr|za|zm|zw)|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3})(:\d{1,5})?(?:(\/).*)?)$/i.test(e)},g=function(e){var t=new RegExp("^".concat("tel:\\s?").concat("((\\+86|86)\\s?)?1[3-9]\\d{9}","$")),n=new RegExp("^".concat("tel:\\s?").concat("((\\(0\\d{2,3}\\))|(0\\d{2,3}-?))?[1-9]\\d{6,7}","$"));return t.test(e)||n.test(e)},v=function(e){var t=/^https?:\/\/[^\/\?\#]+/i.exec(e.toLowerCase());if(!t)return!1;var n=t[0];return n===window.location.origin.toLowerCase()||m(n)};t.isCanFallow=v;var m=function(e){return!!(window.__CONFIG__.miniProgramHyperLinksWhiteList||"").split(",").find((function(t){return t&&e.endsWith(t)}))},y={},b=function(e){var t=e.match(/^(\w+)\:\/\//i);return t?t[1]:""};t.registerCustomProtocal=function(e,t){return!["https","http"].includes(e)&&(y[e]=t,!0)};var w=function(e){var t=b(e);return!!y[t]};t.isCustomProtocalURL=w;var x=function(e){var t=b(e),n=y[t];return!(!n||"function"!=typeof n)&&(window.collection("openkdocshyperlink",e),n(e))}},386:function(e,t,n){"use strict";n.r(t),n.d(t,"copyToClipboard",(function(){return r}));function i(e,t){var n,i,r,o,a,s,l=!1;t||(t={}),n=t.debug||!1;try{if(r=function(){var e=document.getSelection();if(!e.rangeCount&&0!==e.rangeCount)return function(){};for(var t=document.activeElement,n=[],i=0;i<e.rangeCount;i++)n.push(e.getRangeAt(i));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),o=document.createRange(),a=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",document.body.appendChild(s),o.selectNode(s),a.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),l=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(o):a.removeAllRanges()),s&&document.body.removeChild(s),r()}return l}function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null;t&&(r=t.getContainer||null);var o=n||_i18n("applications.public.helpers.copy2clipboard.success", "Copy success");return i(e,t)?(window.Toast.success(o,r),!0):(window.Toast.error(_i18n("applications.public.helpers.copy2clipboard.fail", "Copy failed"),r),!1)}},3904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5).__importStar(n(167)),r="mmmmmmmmmmlli1ƒ⁇";i.isPCWxMiniProgram||i.isInWeixin||i.isQQBrowser?r+=String.fromCharCode(160):i.isIE?r=r+String.fromCharCode(0)+String.fromCharCode(59336):i.isWps2019?r+=String.fromCharCode(0):i.isMacOs&&(r+=String.fromCharCode(33));var o=document.createElement("div"),a=document.createElement("span"),s=document.createElement("span");o.className="doc-font-checker-container",o.setAttribute("style","position: fixed;text-align: center;z-index: -99;opacity: 0;top: 0;left: 0;transform: translateZ(-1px)"),a.className="doc-font-checker-container-default-font-use",s.className="doc-font-checker-container-check-font-use",a.textContent=r,s.textContent=r;var l={top:"0",left:"0",margin:"0",padding:"0",fontSize:"76px",zIndex:"-99",position:"absolute",display:"inline","white-space":"nowrap"};for(var d in l)l.hasOwnProperty(d)&&(a.style[d]=l[d],s.style[d]=l[d]);var h=document.body;o.appendChild(a),o.appendChild(s),h.appendChild(o),a.style.fontFamily="'".concat("Cambria Math","'")+", '".concat("Arial","'"),s.style.fontFamily="'".concat("Arial","'");var c=!(a.offsetWidth===s.offsetWidth&&a.offsetHeight===s.offsetHeight);h.removeChild(o),t.default=c},3930:function(e,t,n){"use strict";var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(3931),l=n(336),d=function(){function e(){r()(this,e)}return a()(e,null,[{key:"getLayoutCorner",value:function(e){var t=1440,n=1440,i=1800,r=1800,o=e.range;if(o){var a=window.APP.data.doc.sections.getSection(o.pos);if(a){var d=a.getPageMargin();t=d.top,n=d.bottom,i=d.left,r=d.right}}var h=Object(l.Ti2Px)(t),c=Object(l.Ti2Px)(n),_=Object(l.Ti2Px)(i),u=Object(l.Ti2Px)(r),p=e.outer_rect,f=s.b.T2B,g=s.b.B2T,v=s.a.L2R,m=s.a.R2L,y=p.width-u,b=p.height-c;return{header_footer_limit:{top:h,bottom:b},left_top_corner:{x:_,y:h,ver:g,hor:m},right_top_corner:{x:y,y:h,ver:g,hor:v},left_bottom_corner:{x:_,y:b,ver:f,hor:m},right_bottom_corner:{x:y,y:b,ver:f,hor:v}}}}]),e}();t.a=d},3931:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var i={T2B:0,B2T:1},r={L2R:0,R2L:1}},398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(238);function r(e,t){if(e.wholeText===t){var n=e.parentNode;if(0===n.scrollWidth||0===n.clientWidth){for(var i=n;i.parentNode&&0===i.parentNode.clientWidth;)i=i.parentNode;var o=i.nextSibling,a=!1;if(o){var s=o.getBoundingClientRect(),l=i.getBoundingClientRect();a=Math.max(s.left,l.left)<=Math.min(s.right,l.right)&&Math.max(s.top,l.top)<=Math.min(s.bottom,l.bottom)}return i.parentNode&&i.offsetWidth<=i.parentNode.clientWidth&&!a}return n.scrollWidth>0&&Math.abs(n.scrollWidth-n.clientWidth)<1&&n.scrollHeight>0&&Math.abs(n.scrollHeight-n.clientHeight)<1}for(var d=e.childNodes,h=0;h<d.length;h++)if(r(d[h],t))return!0;return!1}t.default={isMustShowTitle:function(e,t){return(0,i.isValidElement)(t)&&t.props.children?!r(e,t.props.children):"string"!=typeof t||!r(e,t)},getLottiePosition:function(e,t){var n,i=e.clientWidth,r=e.clientHeight,o=t.getBoundingClientRect(),a=document.body,s=a.clientWidth,l=a.clientHeight,d=s-o.right-4,h=o.left-4,c=o.right+4,_=Math.max(4,o.left-4-i);n=d>=i?c:h>=i?_:d>=h?c:_;var u=l-o.top,p=o.bottom,f=o.top,g=Math.max(4,o.bottom-r);return{left:n,top:u>=r?f:p>=r?g:u>=p?f:g}},getBubblePosition:function(e,t,n,i,r){var o,a,s=e.clientWidth,l=e.clientHeight,d=t.getBoundingClientRect(),h=document.body,c=h.clientWidth,_=h.clientHeight;return o=!i&&d.width>100?n.x-10:d.left+d.width/2-s/2,o=Math.min(c-s-10,o),o=Math.max(10,o),r?(a=d.top+d.height/2-l/2,o+=d.left>o?-10:10):_-10<(a=Math.max(n.y+25,d.bottom+10))+l&&(a=d.top-l-10),{left:o,top:a}}}},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementType=void 0,function(e){e.leftRight="leftRight",e.topBottom="topBottom"}(t.PlacementType||(t.PlacementType={}))},4418:function(e,t,n){"use strict";n.r(t),n.d(t,"Auto",(function(){return i})),n.d(t,"Top",(function(){return r})),n.d(t,"Center",(function(){return o})),n.d(t,"Bottom",(function(){return a})),n.d(t,"BaseLine",(function(){return s}));var i=0,r=1,o=2,a=3,s=4},454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offlineOpen=t.isSupportOfflineOpen=void 0;var i=n(5),r=i.__importDefault(n(168)),o=i.__importDefault(n(84)),a=i.__importDefault(n(85)),s=n(167),l=n(82),d=function(){return!!(s.isMobileWps&&window.wps&&window.wps.openLink)},h=function(e){return!!((0,o.default)()&&e&&e.file_id&&e.file_type)};t.isSupportOfflineOpen=function(e){return d()||h(e)};t.offlineOpen=function(e,t,n){d()?function(e,t){var n=!!t&&t.file_type&&t.file_id&&t.file_name;window.wps.openLink({url:e,link_type:n?"web_office":"common",file_type:n?t.file_type:"",file_id:n?t.file_id:"",file_name:n?t.file_name:""})}(e,t):h(t)&&function(e,t,n){var i=(0,l.getOfficeTypeByFileType)(t.file_type);if(!i)return n(e);r.default.check("openDocsOnlineFile").then((function(r){r?(0,a.default)("openDocsOnlineFile",{fileId:t.file_id,officeType:i}):n(e)})).catch((function(){n(e)}))}(e,t,n)}},4678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.svgStringToSvgNode=void 0;var i=["a","clipPath","defs","g","linearGradient","path","rect","svg","stop","text","use","polygon","tspan"],r=["clip-path","d","draggable","dominant-baseline","fill","fill-opacity","fill-rule","font-family","font-size","font-style","font-weight","height","id","offset","overflow","paint-order","patternUnits","stop-color","stop-opacity","stroke","stroke-opacity","stroke-width","text-anchor","transform","version","viewBox","width","x","xlink:href","xmlns","xmlns:xlink","y","style","points"];t.svgStringToSvgNode=function(e){var t=[],n=[],o=0;if(function(e,t){for(var n=t.onStart,i=t.onEnd,r=t.onAttr,o=t.onText,a=0,s=-1,l=-1,d=-1,h=-1,c="",_="",u=[function(e,t){switch(e){case"<":a=1;break;default:a=2,l=t}},function(e,t){switch(e){case"/":a=4;break;default:s=t,a=3}},function(t,n){"<"===t&&(o(e.substring(l,n).replace("&lt;","<").replace("&gt;",">")),a=1)},function(t,i){switch(t){case" ":a=6,c=e.substring(s,i),n(c);break;case">":a=0,c=e.substring(s,i),n(c);break;case"/":c=e.substring(s,i),n(c),a=11}},function(e,t){switch(e){case">":throw new Error;default:a=5,s=t}},function(t,n){switch(t){case">":c=e.substring(s,n),i(c),a=0;break;case" ":case"\n":throw Error()}},function(e,t){switch(e){case">":a=0;break;case" ":break;case"/":a=11;break;default:d=t,a=7}},function(t,n){switch(t){case"=":case" ":case"\n":a=8,_=e.substring(d,n);break;case">":throw new Error}},function(e,t){switch(e){case'"':h=t+1,a=9}},function(t,n){switch(t){case'"':r(_,e.substring(h,n)),a=6;break;case"\\":a=10}},function(e,t){a=9},function(e,t){if(">"!==e)throw new Error;i(c),a=0}],p=0,f=e.length;p<f;++p){var g=e.charAt(p);(0,u[a])(g,p)}}(e,{onStart:function(e){if(o>0)++o;else if(i.includes(e)){var r=t;n.push(r),t=document.createElementNS("http://www.w3.org/2000/svg",e),Array.isArray(r)?r.push(t):r.appendChild(t)}else o=1},onEnd:function(e){if(o>0)--o;else{if(t.nodeName!==e)throw new Error;t=n.pop()}},onAttr:function(e,n){o>0||r.includes(e)&&("xlink:href"===e?t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n):t.setAttribute(e,n))},onText:function(e){o>0||t.appendChild(document.createTextNode(e))}}),!Array.isArray(t))throw new Error;return t}},4679:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i="_glypy_0x".length;function r(e){for(var t=[],n=0;n<e.childNodes.length;){var r=e.childNodes[n];if("path"===r.nodeName&&r.getAttribute("id").startsWith("_glypy_0x")){var o=r.getAttribute("id"),a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttribute("id",o),a.setAttribute("x",0),a.setAttribute("y",0),a.setAttribute("font-family",'"Cambria Math"'),a.setAttribute("font-size",2048),a.setAttribute("font-style","normal"),a.setAttribute("font-weight","normal");var s=parseInt(o.substring(i),16),l=String.fromCodePoint(s);a.appendChild(document.createTextNode(l)),t.push(a),e.removeChild(r)}else++n}t.forEach((function(t){e.appendChild(t)}))}},4746:function(e,t,n){"use strict";n.r(t),n.d(t,"getParentTextPage",(function(){return s})),n.d(t,"getBaseCoordinate",(function(){return l})),n.d(t,"isRevisionMarkVisible",(function(){return d})),n.d(t,"getRangesInTextPageAndSplitByLine",(function(){return h}));var i=n(8),r=n.n(i),o=n(1032),a=n(411);function s(e){for(var t=e;t&&!(t instanceof o.d);)t=t.parent;return t}function l(e,t){var n=s(e),i=n.textflow.isReverseLine;return{x:t.x,y:i?n.rect.width-t.y-e.rect.height:t.y,baseline:e.baseline}}function d(e){return!e||!window.APP.editor||window.APP.editor.viewSettings.revisionMark.isVisibleForUser(e.user)}function h(e,t){var n=t.range;if(!n)return[];var i=[],o=t.lines,s=n.pos,l=s+n.len;return e.forEach((function(e){var n=e.pos,d=n+e.len;d<=s||n>=l||o.forEach((function(o){if(o.layoutType===a.DOCLayoutType.TextLine){var s=o.range.pos,l=o.range.len+s;if(d<=s||n>=l)return;var c=Object.assign({},e,{line:o,textPage:t});switch(!0){case n>=s&&d<=l:c.pos=n,c.len=d-n,i.push(c);break;case n<s&&d>l:c.pos=s,c.len=l-s,i.push(c);break;case n<s&&d<=l:c.pos=s,c.len=d-s,i.push(c);break;case n>=s&&d>l:c.pos=n,c.len=l-n,i.push(c)}}else if(o.layoutType===a.DOCLayoutType.TableLine){(o.tablecells||[]).forEach((function(t){i.splice.apply(i,[i.length,0].concat(r()(h([e],t.cell_page))))}))}}))})),i}},515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(794);var r=i.__importStar(n(238)),o=i.__importDefault(n(795)),a=i.__importDefault(n(796)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isUnmount=!1,t.animation=null,t.state={style:{width:null,height:null}},t.refDiv=r.default.createRef(),t}return i.__extends(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.config.style,i=n.width,r=n.height;return i!==t.style.width||r!==t.style.height?{style:{width:i,height:r}}:null},t.prototype.componentDidMount=function(){this.load()},t.prototype.componentWillUnmount=function(){this.isUnmount=!0,this.animation&&this.animation.destroy()},t.prototype.load=function(){var e=this,n=this.props.config;t.preload(n).then((function(t){if(!e.isUnmount){var i=t[0],r=t[1],o=n.loop,a=n.autoplay;e.animation=i.loadAnimation({loop:o,autoplay:a,container:e.refDiv.current,renderer:"svg",animationData:r})}}))},t.prototype.render=function(){var e=this.props,t=e.className,n=e.border,i=this.state.style,o=r.default.classNames({"wowui-lottie":n},t);return r.default.createElement("div",{ref:this.refDiv,className:o,style:i})},t.Config=a.default,t.preload=function(e){var t=[new Promise((function(e){(0,o.default)((function(t){return e(t)}))}))];e&&(Array.isArray(e)?e:[e]).forEach((function(e){var n=new Promise((function(t){e.loader((function(e){return t(e.default)}))}));t.push(n)}));return Promise.all(t)},t.defaultProps={border:!0},t}(r.PureComponent);t.default=s},5298:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var i=0,r=1,o=2},5300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utf8ToUtf16=t.utf16ToUtf8=void 0;t.utf16ToUtf8=function(e){for(var t="",n=0,i=e.length;n<i;++n){var r=e.charCodeAt(n);if(r>=0&&r<=127)t+=String.fromCodePoint(r);else if(r>=128&&r<=2047)t+=String.fromCodePoint(192|31&r>>6),t+=String.fromCodePoint(128|63&r);else if(r>=2048&&r<=55295||r>=57344&&r<=65535)t+=String.fromCodePoint(224|15&r>>12),t+=String.fromCodePoint(128|63&r>>6),t+=String.fromCodePoint(128|63&r);else{if(r>56319)throw Error("must be hight surrogates");var o=e.charCodeAt(++n);if(o<56320||o>57343||isNaN(o))throw new Error("must be low surrogates");var a=65536+(r-55296<<10|o-56320);t+=String.fromCodePoint(240|7&a>>18),t+=String.fromCodePoint(128|63&a>>12),t+=String.fromCodePoint(128|63&a>>6),t+=String.fromCodePoint(128|63&a)}}return t};t.utf8ToUtf16=function(e){for(var t,n,i,r,o=e.length,a="",s=0;s<o;)switch((t=e.charCodeAt(s++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=e.charAt(s-1);break;case 12:case 13:n=e.charCodeAt(s++),a+=String.fromCodePoint((31&t)<<6|63&n);break;case 14:n=e.charCodeAt(s++),i=e.charCodeAt(s++),a+=String.fromCodePoint((15&t)<<12|(63&n)<<6|(63&i)<<0);break;case 15:n=e.charCodeAt(s++),i=e.charCodeAt(s++),r=e.charCodeAt(s++),a+=String.fromCodePoint((7&t)<<18|(63&n)<<12|(63&i)<<6|63&r)}return a}},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(605);var r=i.__importStar(n(238)),o=i.__importDefault(n(515)),a=i.__importDefault(n(398)),s=n(426),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={style:null},t.handleWindowMouseDown=function(){t.props.element&&t.props.onClose()},t.refWrap=r.default.createRef(),t}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("mousedown",this.handleWindowMouseDown,!0),this.adjustUI()},t.prototype.componentWillUnmount=function(){window.removeEventListener("mousedown",this.handleWindowMouseDown,!0)},t.prototype.componentDidUpdate=function(e,t){this.props!==e&&this.adjustUI()},t.prototype.adjustUI=function(){var e=this.props,t=e.title,n=e.element,i=e.position,r=e.middleShow,l=e.verticalMiddleShow,d=e.placement;if(n&&t){var h=this.refWrap.current,c=void 0;c=t.type===o.default||d===s.PlacementType.leftRight?a.default.getLottiePosition(h,n):a.default.getBubblePosition(h,n,i,r,l),this.setState({style:c})}else this.setState({style:{left:0,top:0}})},t.prototype.renderTitle=function(){var e=this.props.title;if("string"==typeof e){var t=r.default.classNames({"tooltip-text":1,"tooltip-auto-wrap":e.length>20});e=r.default.createElement("div",{className:t},e)}return e},t.prototype.render=function(){var e=this.props,t=e.element,n=e.title,i=this.state.style;if(!t||!n)return!1;var a=r.default.classNames({"wowui-tooltip-content":1,"not-lottie":n.type!==o.default});return r.default.createElement("div",{ref:this.refWrap,className:a,style:i},this.renderTitle())},t}(r.PureComponent);t.default=l},605:function(e,t,n){},6743:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineHeight=t.isEmpty=void 0;var i={basestyle:{id:0},bidi:!1,horizontal_align_mode:4,line_spacing:{rule:"auto",value:240},left_indent_abs:0,left_indent_chars:0,right_indent_chars:0,right_indent_abs:0,para_lineunit_margin_after:0,para_lineunit_margin_before:0,first_line_indent_abs:0,first_line_indent_chars:0,out_line_level:9,list_id:0};t.isEmpty=function(){var e,t;try{if(!window.APP.canEdit()||!window.APP.isMobileMode()&&!window.APP.isPCMode()||!window.APP.data.doc.isEmptyMainDoc())return!1;if(window.APP.restrictEditHandler.isRestrictProtectOn)return!1;var n=window.APP.data.selection.selInfo.getPapx(),r=!1;if(n&&(r=Object.keys(i).some((function(e){return!!n.hasOwnProperty(e)&&("basestyle"===e?n[e].id!==i[e].id:"line_spacing"===e?n[e].rule!==i[e].rule||n[e].value!==i[e].value:"list_id"===e?n[e]>i[e]:i[e]!==n[e])}))),r)return!1;var o=window.APP.data.doc.bookmarks.rangeClass.map();if(o&&o.length>0)return!1;var a=window.APP.data.typoinfo.getLayoutPageCache(0);if(a){var s=null===(e=null==a?void 0:a.header)||void 0===e?void 0:e.range,l=null===(t=null==a?void 0:a.footer)||void 0===t?void 0:t.range;if(s&&s.len>1||l&&l.len>1)return!1}}catch(e){}return!0};t.getLineHeight=function(){var e,t,n,i,r,o=(null===(n=null===(t=null===(e=window.APP.data)||void 0===e?void 0:e.selection)||void 0===t?void 0:t.begin)||void 0===n?void 0:n.pos)||0,a=(null===(r=null===(i=window.APP.workspace)||void 0===i?void 0:i.config)||void 0===r?void 0:r.zoom)||0;return Math.floor(o.charHeight*a)}},724:function(e,t,n){},7375:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(167),l=n(676),d=new(function(){function e(){r()(this,e),this.todoImageSvgContent='<g id="taskListTodo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect width="14" height="14" rx="2" fill="white"/><rect x="0.5" y="0.5" width="13" height="13" rx="1.5" stroke="#0D0D0D" stroke-opacity="0.48"/></g>',this.doneImageSvgContent='<g id="taskListDone" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect width="14" height="14" rx="2" fill="#3B89FF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M11.6895 3.29378C12.0965 3.69232 12.1044 4.34643 11.7072 4.75477L6.6184 10.6885C6.23825 11.0792 5.62065 11.1057 5.20859 10.749L2.35706 7.51658C1.92645 7.14381 1.87859 6.49142 2.25017 6.05943C2.62176 5.62744 3.27206 5.57944 3.70267 5.95221L5.82091 8.54986L10.2331 3.31153C10.6304 2.90319 11.2824 2.89524 11.6895 3.29378Z" fill="white"/></g>'}return a()(e,[{key:"init",value:function(){}},{key:"createImage",value:function(e){var t=Object(l.createElement)({type:"div",classname:e,style:"display:none;",parent:document.body});if(!t)return null;var n=window.getComputedStyle(t,!1)["background-image"],i=/(data:image.*)\)/g.exec(n);if(!i||!i[1])return null;var r=i[1].replace(/\"/g,"");if(!r)return null;var o=new Image;return o.src=r,o}},{key:"getImageSize",value:function(){return s.isMobile?{width:16,height:16}:{width:14,height:14}}},{key:"todoImage",get:function(){return this._todoImage||(this._todoImage=this.createImage("icons-other-checkbox_normal")),this._todoImage}},{key:"doneImage",get:function(){return this._doneImage||(this._doneImage=this.createImage("icons-other-checkbox_done")),this._doneImage}}]),e}())},7376:function(e,t,n){"use strict";var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(772),l=n(400),d=n(1916),h=n(336),c=n(4579),_=n(411),u=function(){function e(t,n){r()(this,e),this.table_style={nest_level:t.nest_level,para_type:t.para_type,type:t.type},this.table_row_style=t.table_row,this.tableline=n;var i=n.parent&&n.parent.parent&&n.parent.parent.layoutType===_.DOCLayoutType.MobilePage&&n.parent.parent,o=n.position_in_table;this.isFirstLine=(o===c.b||c.a)&&(!i||!i._prevTable),this.isLastLine=(o===c.b||c.d)&&(!i||!i._nextTable&&n.isLastTable)}return a()(e,[{key:"getCellStyle",value:function(t,n){var i=this,r=this.table_row_style,o=r&&r.tableCells&&r.tableCells[t],a=r&&r.borders||null,d=l.a.copy(n.rect);n.merge_type===s.e.FIRST&&function(){for(var e=i.tableline.parent.lines,t=e.indexOf(i.tableline),r=n.rect,o=r.left,a=r.right,h=t+1;h<e.length&&e[h].tablecells;h++){var c=e[h].tablecells.find((function(e){return!(e.rect.right<=o||e.rect.left>=a)}));if(!c)break;var _=c.merge_type;if(_===s.e.NONE||_===s.e.FIRST)break;var u=l.a.copy(c.rect);if(u.top=n.rect.top,u.bottom=n.rect.bottom,!l.a.equal(n.rect,u))break;var p=c.rect.size;if(d.addSize({width:0,height:p.height}),_===s.e.LAST)break}}();var h=o&&o.border&&o.border.top||a&&(this.isFirstLine?a.top:a.insideH),c=o&&o.border&&o.border.bottom||a&&(this.isLastLine?a.bottom:a.insideH),_=h&&e.getBorderWidth(h)/2||0,u=c&&e.getBorderWidth(c)/2||0;0!==u&&d.addOffset({x:0,y:_}),_+u>0&&d.addSize({width:0,height:-(_+u)});var p={rowStyle:a,shd_rect:d};return o?Object.assign(o,p):p}}],[{key:"init",value:function(t,n){var i=t.cell_style_cp;return new e(n.doc.getDataLogic("final").getPap(i),t)}},{key:"getBorderWidth",value:function(e){if(!e||!e.type||e.type===d.l||e.type>d.k)return 0;var t=Object(h.Ti2Px)(e.lineWidth),n=Math.floor(t);return(t=t-n>.5?n+.5:n)||(t=.5),t}}]),e}();t.a=u},794:function(e,t,n){},795:function(e,t,n){e.exports=function(e,t){n.e(223).then(n.t.bind(null,1481,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},796:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Data=void 0;var i=n(5),r=i.__importDefault(n(797)),o=i.__importDefault(n(798)),a=i.__importDefault(n(799)),s=i.__importDefault(n(800)),l=i.__importDefault(n(801)),d=i.__importDefault(n(802)),h=i.__importDefault(n(803)),c=function(e,t,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0),this.loader=e,this.style={width:t,height:n},this.loop=i,this.autoplay=r};t.Data=c,t.default={db:{AddGridView:new c(r.default,240,180),AddKanbanVIew:new c(o.default,240,180),AddGalleryView:new c(a.default,240,180),AddFormView:new c(s.default,240,180),AddGanttView:new c(l.default,240,180),AddQueryView:new c(d.default,240,180)},wps:{SyncRevisionsStauts:new c(h.default,240,160)}}},797:function(e,t,n){e.exports=function(e,t){n.e(549).then(n.bind(null,1482)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},798:function(e,t,n){e.exports=function(e,t){n.e(550).then(n.bind(null,1483)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},799:function(e,t,n){e.exports=function(e,t){n.e(547).then(n.bind(null,1484)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},800:function(e,t,n){e.exports=function(e,t){n.e(546).then(n.bind(null,1485)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},801:function(e,t,n){e.exports=function(e,t){n.e(548).then(n.bind(null,1486)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},802:function(e,t,n){e.exports=function(e,t){n.e(551).then(n.bind(null,1487)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},803:function(e,t,n){e.exports=function(e,t){n.e(552).then(n.bind(null,1488)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8841:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return s}));var i=0,r=1,o=2,a=3,s=4},8842:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(1),r=n.n(i),o=n(2),a=n.n(o),s=n(3078),l=n(336),d=n(309),h=function(){function e(){r()(this,e)}return a()(e,null,[{key:"adjust",value:function(e,t,n){var i={height:0,bNeedSetAlign:!0,bLocked:!1,blineSpacingIsMinZero:!1,align:null};return this.setChannelAlign(i,e),e.hasExclusiveEmbed?i.height=t:this.getChannelHeightAndAlign(i,t,n,e),i}},{key:"setChannelAlign",value:function(e,t){var n=t.vertAlignMode;e.align="middle"==n?s.b.Typo_caMiddle:"top"==n?s.b.Typo_caTop:s.b.Typo_caBottom}},{key:"getChannelHeightAndAlign",value:function(e,t,n,i){if(this.updateChannelByLineSpacing(e,t,n,i),e.bLocked&&e.bNeedSetAlign)this.getChannelAlignByVertAlign(i,e);else{var r=i.gridMode,o=i.snapToGrid,a=i.dataStatus.subdocType;if(!e.blineSpacingIsMinZero&&this.isUpdateChannelByAlignGrid({gridMode:r,snapToGrid:o,subDocType:a})){var l={height:this.updateChannelByAlignGrid(e,t,i),align:s.b.Typo_caMiddle};l.height>e.height&&(e.height=l.height,e.align=l.align)}e.bNeedSetAlign&&this.getChannelAlignByVertAlign(i,e)}}},{key:"getChannelAlignByVertAlign",value:function(e,t){var n=e.vertAlignMode;t.align="middle"==n?s.b.Typo_caFixedMiddle:"top"==n?s.b.Typo_caFixedTop:s.b.Typo_caFixedBottom}},{key:"updateChannelByLineSpacing",value:function(e,t,n,i){if(!e.bLocked){var r=i.lineSpacing,o=i.lineSpacingScale,a=r.val;if(r.isHeightOrMargin)if(r.bMetricOrPercent)r.bFixedOrMin?(e.bLocked=!0,e.height=Object(l.Ti2Px)(a)):(0==a&&(e.blineSpacingIsMinZero=!0),e.bNeedSetAlign=!1,e.align=s.b.Typo_caMinBottom,e.height=Math.max(t,Object(l.Ti2Px)(a)));else{var d=i.gridMode,h=i.snapToGrid,c=i.dataStatus.subdocType;this.isUpdateChannelByAlignGrid({gridMode:d,snapToGrid:h,subDocType:c})&&i.gridHeight>0?(e.height=240==a?Object(l.Ti2Px)(i.gridHeight):Object(l.Ti2Px)(i.gridHeight)*(a/240),0==a&&0==i.paraMarginBefore&&0==i.paraMarginAfter&&(e.blineSpacingIsMinZero=!0),e.bNeedSetAlign=!1,e.align=s.b.Typo_caMiddle):(e.height=240==a?t:t+n*(a/240-1),e.bNeedSetAlign=!1,e.align=a>=240?s.b.Typo_caTop:s.b.Typo_caBottom,window.APP.isWebMode()&&(e.align=s.b.Typo_caMiddle))}e.height*=o}}},{key:"isUpdateChannelByAlignGrid",value:function(e){var t=e.gridMode,n=e.snapToGrid,i=e.subDocType;return!(t==s.c.Typo_GridMode_None||!n||window.APP.isWebMode()||i==d.Comment)}},{key:"updateChannelByAlignGrid",value:function(e,t,n){var i=Object(l.Ti2Px)(n.gridHeight),r=Math.ceil(t/i);return t>r*i&&++r,i*r*n.lineSpacingScale}},{key:"adjPageBottomLine",value:function(e,t){var n=e.rect.height,i=t-e.rect.top,r=e.baseline+e.textHeight-e.ascent;return i>r&&(r=i),!(n-r<Math.abs(t-e.rect.bottom))}},{key:"getPageBottomAdjHeight",value:function(e,t){var n=t.lineSpacing;return n.bMetricOrPercent&&n.bFixedOrMin?e.rect.height:e.baseline+e.textHeight-e.ascent}}]),e}()},8843:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderCustomMarkForWebMode=t.renderCustomMark=void 0;var i=n(5),r=i.__importDefault(n(12959)),o=i.__importDefault(n(12961)),a=n(8844);t.renderCustomMark=function(e){try{e.ctx.clear(!1),e.layoutPage.mainpages.forEach((function(t){t.range&&l(t,e.ctx)}))}catch(e){console.error("render custom mark failed",e)}};var s=null;function l(e,t){return[(0,r.default)({mainPage:e,ctx:t}),(0,o.default)({mainPage:e,ctx:t})].includes(!0)}t.renderCustomMarkForWebMode=function(e){try{s&&s.parentNode&&s.parentNode.removeChild(s),s=e.ctx.save("customMark");var t=!1;e.layoutPages.forEach((function(n){if(n.page.range){e.ctx.save(),e.ctx.translate((0,a.keepDecimal)(n.rect.left,2),(0,a.keepDecimal)(n.rect.top,2));var i=l(n.page,e.ctx);t=i||t,e.ctx.restore(!1,!i)}})),e.ctx.restore(!1,!t)}catch(e){console.error("render custom mark failed",e)}}},8844:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOffsetToHost=t.keepDecimal=void 0,t.keepDecimal=function(e,t){var n=Math.pow(10,Math.max(0,t));return Math.round(e*n)/n},t.getOffsetToHost=function(e){for(var t=e.host,n={x:0,y:0},i=e;i&&i!==t;)n.x+=i.position2parent.x,n.y+=i.position2parent.y,i=i.parent;return n}}}]);