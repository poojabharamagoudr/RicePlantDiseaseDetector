(window.webpackJsonp=window.webpackJsonp||[]).push([[797],{1090:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.updateWebshapeByEdit=n.getAllUrlsInfo=n.getStageInfo=n.setStageInfo=n.getEmbedsUrlInfo=n.getFileInfo=n.elementToSnapshot=n.uploadMimeDataImg=n.urlsInfo=n.urlsStatus=n.drawWebshape=void 0;var i=t(5),o=i.__importDefault(t(312)),r=t(358),a=t(167),l=t(1569),s=i.__importDefault(t(1570)),c=i.__importDefault(t(1571)),p=!1,d={},u={s:700,f:700,w:650};function f(e){var n=null==e?void 0:e.split("/");return(null==e?void 0:e.startsWith("http"))?n[0]+"//"+n[2]:n[0]}function h(e,n){var t,i,o=P(e),a=(t=null==o?void 0:o.url,"string"!=typeof(i=null==o?void 0:o.icon)?"":new RegExp(/^(?:http(s)?:\/\/)?(\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/).test(i)||"data:image"===i.split("/")[0]?i:f(t)+(i||"/favicon.ico"));return m({tag:"div",options:{id:"frame_topbar",style:"height: 44px; padding: 8px 0px 8px 12px; display: flex; flex-direction: row; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(13, 13, 13, 0.12); cursor: auto; background-color: white;"},childList:[{tag:"div",options:{style:"height: 44px; width: fit-content; display: flex; flex-direction: row; align-items: center; padding: 0px; gap: 4px;"},childList:(null==o?void 0:o.url)&&[{tag:"i",options:{style:"height: 16px; width: 16px; background-image: url(".concat(a,"); background-size: contain;")}},{tag:"span",options:{title:null==o?void 0:o.title,style:"height: 44px; font-style: normal; font-family: 'PingFang SC'; font-weight: 400; font-size: 14px; line-height: 44px; color: rgba(13, 13, 13, 0.9); text-transform: capitalize; display: flex; white-space: nowrap; align-items: center; max-width: ".concat(n.width-128,"px;")},innerText:null==o?void 0:o.title}]},{tag:"div",options:{style:"height: 28px; width: fit-content; display: flex; flex-direction: row; align-items: center; border-radius: 6px; padding: 3px 12px 3px 24px; cursor: pointer; background-color: white;"},childList:[{tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: #0A6CFF;"},innerText:_i18n("applications.writer.helpers.webshapeDraw.openLink", "Open Link"),events:(null==o?void 0:o.url)&&{onclick:function(){(0,r.openHyperlink)(null==o?void 0:o.url),window.collection("commandbar","click","webshape_openPreviewViewLink")},ontouchend:function(){(0,r.openHyperlink)(null==o?void 0:o.url),window.collection("commandbar","click","webshape_openPreviewViewLink")}}}]}]})}function w(e){var n=e.width,t=e.height;return m({tag:"div",options:{id:"frame_page",style:"height: ".concat(t-44,"px; width: ").concat(n,"px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #FAFAFA;")}})}function g(e){var n=o.default.iconTypes.other.wps_webshape_iframe_error.split(" "),t=n[0],i=n[1];return m({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 16px; padding: 0px; width: fit-content; height: fit-content; margin-bottom: 16px;"},childList:[{tag:"div",options:{class:"icons-".concat(t,"-").concat(i),style:"height: 100px; width: 100px;"}},{tag:e&&"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:e}]})}function m(e){var n=e.tag,t=e.options,i=e.innerText,o=e.childList,r=e.events,a=document.createElementNS("http://www.w3.org/1999/xhtml",n);for(var l in i&&(a.innerText=i),o&&o.length&&o.forEach((function(e){if(e.tag){var n=m(e);a.appendChild(n)}})),r)a[l]=r[l];for(var l in t)a.setAttribute(l,t[l]);return a}function v(e,n){var t=w(e),i=g(_i18n("applications.writer.helpers.webshapeDraw.loadFailed", "Failed to load")),o=m({tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: ".concat(a.isMobile||a.isPad?"white":"#0A6CFF","; padding: 3px 8px; height: 28px; width: 80px;\n          cursor: pointer; background: ").concat(a.isMobile||a.isPad?"#0A6CFF":"white","; text-align: center; border-radius: 4px;")},innerText:_i18n("applications.writer.helpers.webshapeDraw.reload", "Reload"),events:{onclick:function(){n&&n()},ontouchend:function(){n&&n()}}});return t.appendChild(i),t.appendChild(o),t}function y(e){var n=w(e),t=g(_i18n("applications.writer.helpers.webshapeDraw.cantOpen", "Access failed.")),i=m({tag:"span",options:{style:"height: 22px; font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.46);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.rejectConnect", "The web page denied your connection.")});return n.appendChild(t),n.appendChild(i),n}function k(e){var n=w(e),t=g(_i18n("applications.writer.helpers.webshapeDraw.notSupportView", "You cannot preview this web page."));return n.appendChild(t),n}function b(e){var n;return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,l.getUrlsStatus)(e))];case 1:return t=i.sent(),[2,null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.body]}}))}))}function x(e){var n;return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,l.getUrlsInfo)(e))];case 1:return t=i.sent(),[2,null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.body]}}))}))}function C(e,n){var t=e.children,i=n.page,o=n.topBar,r=t.frame_page||t[1],a=t.frame_topbar||t[0];o&&(e.removeChild(a),e.insertBefore(o,r)),i&&(e.innerHTML="",e.appendChild(a),e.appendChild(i))}function _(e,n,t,o){e.innerHTML="";var r=function(){T(t).then((function(i){if("ok"!==i.result)throw new Error("fail to horization");delete d[t],A([t]),_(e,n,t,o)}))},s=function(){var n=k(o);C(e,{page:n})},g=function(){var i=null;!function e(n,t){return!!n&&(n===t.fileInfo.id||t!==t._parent&&e(n,t._parent))}(P(t).id,window)?(i=function(e,n,t,i,o){var r,a=(0,l.isKdocsDoc)(t)?t.split("?")[0]+"?simple&hidecmb&readonly&title_not_update&hide_public_popups&disablePlugins&enterView=card":t,s=i.width,c=i.height,p=(null===(r=window.APP.data.selection.activeShape)||void 0===r?void 0:r.id)===n,d=setTimeout((function(){try{var o=h.firstChild.contentWindow;o&&(o.document.write(""),o.document.close())}catch(e){}var r=v(i,(function(){_(e,n,t,i)}));C(e,{page:r})}),5e3),f=function(){var n=e.querySelector(".webshape-iframe-mask");n&&(n.style.display="none");var t=null==h?void 0:h.parentElement.getBoundingClientRect(),i=t.x,o=t.y,r=window.APP.uilManager.hit({event:{pageX:i,pageY:o}});window.APP.data.selection.selAlter.selectShape(null==r?void 0:r.shapeInfo,{})},h=m({tag:"div",options:{style:"height: ".concat(c-44,"px; width: ").concat(s,"px;")},childList:[{tag:"iframe",options:{style:"height: ".concat(c-44,"px; width: ").concat(s,"px; border: 1px solid rgba(0,0,0,0);"),src:a,allowpaymentrequest:!0,frameBorder:"0",allow:"encrypted-media",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation"},events:{onload:function(n){var r;d&&clearTimeout(d),d=null;try{var a=h.firstChild.contentDocument;if(a){var c=null===(r=P(t))||void 0===r?void 0:r.officeType,p=u[c];h.firstChild.contentWindow.addEventListener("resize",(function(){var e=(0,l.isKdocsDoc)(t)&&a.getElementsByClassName("cmd-status-bar")[0]||a.getElementsByClassName("et-cmd-status-bar")[0];window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width?e&&p&&e.setAttribute("style",""):e&&p&&(e.style.width="".concat(p,"px"),e.style.transform="scale(".concat(s>p?1:s/p,")"),e.style.left="-".concat((p-s)/2,"px"))}));var f=setInterval((function(){var e,i=(0,l.isKdocsDoc)(t)&&a.getElementsByClassName("cmd-status-bar")[0]||a.getElementsByClassName("et-cmd-status-bar")[0];i&&p&&(i.style.width="".concat(p,"px"),i.style.transform="scale(".concat(s>p?1:s/p,")"),i.style.left="-".concat((p-s)/2,"px"),"w"===c&&(null===(e=h.firstChild.contentWindow)||void 0===e||e.APP.workspace.scrollTo({scrollTop:70,scrollLeft:110})),w&&clearTimeout(w),f&&clearInterval(f),w=null,f=null,o&&o(n))}),500),w=setTimeout((function(){f&&clearInterval(f),f=null,w=null,o&&o(n)}),5e3)}else o&&o(n)}catch(n){var g=y(i);C(e,{page:g})}}}},{tag:"div",options:{class:"webshape-iframe-mask",style:"position: absolute; top: 0; left: 0; right: 0;bottom: 0; display: ".concat(p?"none":"block","; cursor: move;")},events:{onmouseup:f,ontouchend:f}}]});return h}(e,n,t,o,(function(){var n=e.children;n.frame_page&&e.removeChild(n.frame_page),document.title=S})),e.appendChild(i)):(i=function(e){var n=w(e),t=m({tag:"div",options:{style:"font-size: 16px"},innerText:_i18n("applications.writer.helpers.webshapeDraw.noNest", "Viewing the preview view is not supported.")});return n.appendChild(t),n}(o),C(e,{page:i}))},E=function(i){if(t.startsWith("http://")){var l=k(o);C(e,{page:l})}else switch(i){case"succeed":switch(P(t).frame_option){case"DENY":D=y(o),C(e,{page:D});break;case"SAMEORIGIN":f(t)===window.top.location.origin?g():(D=y(o),C(e,{page:D}));break;default:g()}break;case"failed":D=k(o),C(e,{page:D});break;case"unauthorized":D=function(e,n,t,i){var o=w(e),r=m({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 8px;"},childList:[{tag:"p",options:{style:"height: 24px; font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.askTrust", "Are you sure you want to trust this web page?")},{tag:"p",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; text-align: center; color: rgba(13, 13, 13, 0.66);"},innerText:"".concat(_i18n("applications.writer.helpers.webshapeDraw.trustInfo", "For the security of your personal information, make sure that the web page can be trusted to prevent security risks:")).concat(n)},{tag:"div",options:{style:"width: 154px; display: flex; flex-direction: row; align-items: center; gap: 8px; height: 32px;"},childList:[{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #F5F7FA; border-radius: 4px; padding: 4px 15px;\n                          line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; \n                          color: rgba(13, 13, 13, 0.9); cursor: pointer;\n                          box-shadow: 0px 0px 0px 1px rgba(13, 13, 13, 0.1), 0px 1px 0px rgba(13, 13, 13, 0.14);"},innerText:a.isMobile||a.isPad?_i18n("applications.writer.helpers.webshapeDraw.cancel", "Cancel"):_i18n("applications.writer.helpers.webshapeDraw.notTrust", "Do Not Trust"),events:{onclick:function(){i&&i()},ontouchend:function(){i&&i()}}},{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #0A6CFF; border-radius: 4px; padding: 4px 15px;\n                          cursor: pointer; line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; color: #FFFFFF;"},innerText:a.isMobile||a.isPad?_i18n("applications.writer.helpers.webshapeDraw.confirm", "OK"):_i18n("applications.writer.helpers.webshapeDraw.trust", "Trust"),events:{onclick:function(){t?t():T(n)},ontouchend:function(){t?t():T(n)}}}]}]});return o.appendChild(r),o}(o,t,r,s),C(e,{page:D});break;default:var c=setTimeout((function(){clearInterval(p),clearTimeout(c),D=v(o,(function(){_(e,n,t,o)})),C(e,{page:D})}),1e4),p=setInterval((function(){var i=P(t);A([t]),i&&(clearInterval(p),clearTimeout(c),_(e,n,t,o))}),1e3);Promise.race([c,p])}},S=document.title,O=function(e){var n=w(e),t=m({tag:"div",options:{style:"display: flex; flex-direction: row; align-items: center; padding: 0px; height: 22px; gap: 4px;"},childList:[{tag:"img",options:{style:"width: 16px; height: 16px;",src:c.default}},{tag:"span",options:{style:"font-size: 14px; font-weight: 400; height: 22px; line-height: 22px; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.contentIsLoading", "Loading the content...")}]});return n.appendChild(t),n}(o),H=h(t,o),D=O;if(e.appendChild(H),e.appendChild(D),I(t)&&!p)p=!0,b([t]).then((function(e){e&&"succeed"===e[0].status?x([t]).then((function(n){n[0]&&(L(i.__assign(i.__assign({},e[0]),n[0])),E(e[0].status)),p=!1})):(E(e&&e[0].status),p=!1)}));else{var N=P(t);E(N&&N.status||"")}}function T(e){var n;return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,window.APP.dispatch((0,l.authorizedUrl)(e))];case 1:return t=i.sent(),[2,null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.body]}}))}))}function E(e,n){return i.__awaiter(this,void 0,void 0,(function(){var t,o,r,a;return i.__generator(this,(function(i){return t=e.split("?")[0],o=t.split("/"),r=o[o.length-1],(a=new XMLHttpRequest).open("GET","/api/office/file/"+r),a.send(),a.onload=function(){n(JSON.parse(a.response))},[2]}))}))}function L(e){(null==e?void 0:e.url)&&(d[e.url]=e)}function P(e){return d[e]}function I(e){var n=P(e);return n&&n.status&&"succeed"===n.status&&void 0===n.icon&&void 0!==n.title||!n}function A(e,n){if(!(!1===n||p&&void 0!==n)&&e.length&&window.__CONFIG__.wps.isEnableSwitchToWebshape){p=!0;var t=e.filter((function(e){return"string"==typeof e})),o=t.filter((function(e){return I(e)&&!(0,l.isKdocsDoc)(e)})),r=t.filter((function(e){return I(e)&&(0,l.isKdocsDoc)(e)})),a=o.length+r.length;if(0!==a){var s=0;r.map((function(e){E(e,(function(n){if(null==n?void 0:n.file){var t=n.file.name,i=n.file.office_type,o=i?"https://qn.cache.wpscdn.cn/kdocs/cloud/dotview/favicon/favicon_".concat(i,".png"):"https://www.kdocs.cn/favicon.ico";L({url:e,status:"succeed",title:t,icon:o,id:n.file.id,officeType:i})}else L({url:e,status:"succeed",title:"",icon:""});(s+=1)===a&&(p=!1)}))})),o.length&&b(o).then((function(e){var n=(e||[]).filter((function(e){return"succeed"===e.status})).map((function(e){return e.url}));n.length?x(n).then((function(n){n&&n[0]?o.forEach((function(t){var o=null==e?void 0:e.find((function(e){return e.url===t})),r=null==n?void 0:n.find((function(e){return e.url===t}));L(i.__assign(i.__assign({url:t},o),r)),(s+=1)===a&&(p=!1)})):(o.forEach((function(n){var t=null==e?void 0:e.find((function(e){return e.url===n}));L(i.__assign({url:n},t)),s+=1})),p=!1)})):o.forEach((function(n){L(null==e?void 0:e.find((function(e){return e.url===n}))),(s+=1)===a&&(p=!1)}))}))}else p=!1}}n.urlsStatus=b,n.urlsInfo=x,n.uploadMimeDataImg=function(e,n){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return[2,window.APP.data.api.postObjectURL().then((function(t){var i=new XMLHttpRequest;i.open("GET",s.default),i.responseType="blob",i.send(),i.onload=function(){var o=n||new Blob([i.response],{type:"image/*"}),r=new FormData;r.append("object",o,n&&n.name||"loading"),window.__WPSENV__.request({method:"POST",url:t,body:r}).end().then((function(n){e&&e(n.body.uploadid)}))}}))]}))}))},n.drawWebshape=_,n.getFileInfo=E,n.elementToSnapshot=function(e){if(!e)throw new Error("can not find element");var n=document.createElement("canvas"),t=n.getContext("2d"),i='data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg">'.concat((new XMLSerializer).serializeToString(e),"</svg>").replace(/\n/g,"").replace(/#/g,"%23"),o=new Image;o.src=i,t.drawImage(o,0,0);for(var r=n.toDataURL("image/png").split(","),a=r[0].match(/:(.*?);/)[1],l=window.atob(r[1]),s=l.length,c=new Uint8Array(s);s--;)c[s]=l.charCodeAt(s);return new File([c],l.slice(0,16)+".png",{type:a})},n.setStageInfo=L,n.getStageInfo=P,n.getEmbedsUrlInfo=function(e){var n=!!e.find((function(e){return e.shape.isWebshape}));A(e.filter((function(e){return e.shape.isWebshape})).map((function(e){return e.shape.webshapeUrl})),n)},n.getAllUrlsInfo=A,n.updateWebshapeByEdit=function(e,n,t){var i=e.getBoundingClientRect();_(e,t,n,i)}},1290:function(e,n,t){"use strict";t.r(n),t.d(n,"shallowEqual",(function(){return h})),t.d(n,"getNextWord",(function(){return w})),t.d(n,"parseFieldCode",(function(){return g})),t.d(n,"isRangeIntersect",(function(){return m})),t.d(n,"toParams",(function(){return v})),t.d(n,"NODETYPE",(function(){return y})),t.d(n,"getLinks",(function(){return b})),t.d(n,"getMentions",(function(){return x})),t.d(n,"getHyperlinks",(function(){return C})),t.d(n,"getCatalogs",(function(){return _})),t.d(n,"getPictures",(function(){return T})),t.d(n,"handleTypes",(function(){return E})),t.d(n,"getRelatedUserIdsByContent",(function(){return L}));var i,o=t(13),r=t.n(o),a=t(8),l=t.n(a),s=t(144),c=t.n(s),p=t(30),d=t.n(p),u=t(1806),f=t(698),h=function(e,n){if(e!==n)if(e instanceof Array&&n instanceof Array){if(e.length!==n.length)return!1;for(var t=0,i=e.length;t<i;t++)if(e[t]!==n[t])return!1}else{var o=Object.keys(e),r=Object.keys(n);if(o.length!==r.length)return!1;for(var a in e)if(!n.hasOwnProperty(a)||e[a]!==n[a])return!1}return!0};function w(e,n){for(var t="",i=n;" "===e[i];)++i;for(var o=!1;i<e.length;++i)if('"'===e[i]){if(o)break;o=!0}else t+=e[i];return++i,{string:t.trim(),idx:i}}function g(e){for(var n=[],t={},i=0;" "===e[i];)++i;for(;i<e.length;)if('"'===e[i]){var o=w(e,i);n.push(o.string),i=o.idx}else if("\\"===e[i]){var r=w(e,++i+1);t[e[i]]=r.string,i=r.idx}else++i;return{params:n,switchs:t}}function m(e,n){return!(e.pos+e.len<=n.pos||e.pos>=n.pos+n.len)}function v(e){return e.split("&").reduce((function(e,n){var t=n.indexOf("="),i=n.slice(0,t),o=n.slice(t+1);return void 0!==i&&void 0!==o&&("type"===i?e._type=o:e[i]=o),e}),{})}var y={TEXT:"text",MENTION:"mention",PICTURE:"picture",HYPERLINK:"hyperlink",CATALOG:"catalog"},k=(i={},d()(i,y.MENTION,"mentionNodes"),d()(i,y.HYPERLINK,"linkNodes"),d()(i,y.CATALOG,"catalogNodes"),i);function b(e){var n,t=window.APP.data.doc,i=e.pos,o=e.len,r=t.fields.getFields({begin:i,end:i+o}),a=[],l=[],s=[];return r.forEach((function(e){var n=e.pos,i=e.len,o=e._node;if("HYPERLINK"===o.type){var r=t.getText(n,i),p=r.match(/\x13 HYPERLINK "kw:mention\?(.+)" \x14@(.+)\x15/);if(p){var d=c()(p,3),h=d[1],w=d[2],g=v(h);g.userid&&(g.userid=parseInt(g.userid)),g.classes=u.classes.mention;var m={pos:n,len:i,text:"@"+w,attrs:g};return void l.push(m)}var y=r.match(/\x13 HYPERLINK "(.+)" \x14(.+)\x15/);if(y){var k=c()(y,3),b=k[1],x=k[2];a.push({pos:n,len:i,text:Object(f.filterSpecialPlaceholder)(x),link:b,classes:u.classes.link})}}else if("TOC"===o.type){var C={pos:n,len:i,text:Object(f.getText)({pos:n,len:i})};s.push(C)}})),n={},d()(n,k[y.MENTION],l),d()(n,k[y.HYPERLINK],a),d()(n,k[y.CATALOG],s),n}function x(e){return b(e)[k[y.MENTION]]}function C(e){return b(e)[k[y.HYPERLINK]]}function _(e){return b(e)[k[y.CATALOG]]}function T(e){var n=window.APP.data.doc,t=e.pos,i=e.len,o=n.inlineAnchors.getAnchors(t,i),r=n.anchors.getAnchors(t,i);return[].concat(l()(o),l()(r)).map((function(e){var n=(e.anchor||{len:0}).len;return e.len=n,e}))}function E(e,n,t){var i=n.pos,o=n.len,a=i+o-1,l=[];if(t){var s=t.hyperlinks,c=void 0===s?[]:s,p=t.range;l=c.map((function(e){var n=r()({},e.params);return r()({},p,{text:e.text.slice(1),attrs:n,_nType:y.MENTION})}))}var d=void 0,u=Object.keys(e).reduce((function(t,i){var o=void 0;(k[i]&&(d||(d=b(n)),o=d[k[i]]),o)||(o=(0,e[i])(n));return o.forEach((function(e){return e._nType=i})),t.concat(o)}),l).sort((function(e,n){return(e.pos||0)-(n.pos||0)}));return u.length?u.reduce((function(e,n,t){var o=n.pos,r=n.len;if(i<o){var l=i,s=o-i,c={pos:l,len:s,text:Object(f.getText)({pos:l,len:s}),_nType:y.TEXT};e.push(c)}if(e.push(n),i=o+r,t===u.length-1&&i<a){var p=i,d=a-i,h={pos:p,len:d,text:Object(f.getText)({pos:p,len:d}),_nType:y.TEXT};e.push(h)}return e}),[]):[{pos:i,len:o,text:Object(f.getText)({pos:i,len:o}),_nType:y.TEXT}]}var L=function(e,n){var t=new Set(n||[]);return e.replace(/\x13 HYPERLINK "kw:mention\?(.+?)" \x14@.+?\x15/g,(function(e,n){var i=v(n).userid;i&&t.add(i)})),Array.from(t)}},1299:function(e,n,t){"use strict";t.r(n);var i=t(238),o=t.n(i),r=t(239);n.default=Object(r.a)("chain_disconnect",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M3 2.99988L13 12.9999",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),o.a.createElement("path",{d:"M3.59517 7.83853L2.44531 8.98839C1.1849 10.2488 1.1849 12.2923 2.44531 13.5527C3.70572 14.8131 5.74925 14.8131 7.00966 13.5527L8.15952 12.4029M7.83781 3.59589L8.99034 2.44335C10.2508 1.18294 12.2943 1.18294 13.5547 2.44336C14.8151 3.70377 14.8151 5.74729 13.5547 7.00771L12.4022 8.16024",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1569:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isKdocsDoc=n.getDocInfo=n.authorizedUrl=n.getUrlsInfo=n.getUrlsStatus=void 0;var i=t(5).__importDefault(t(361));n.getUrlsStatus=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var n="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/status");return{types:i.default.HTTP_TYPES,callAPI:function(t){return t.get(n).query({urls:e.join(",")}).end()}}},n.getUrlsInfo=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var n="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/info");return{types:i.default.HTTP_TYPES,callAPI:function(t){return t.get(n).query({urls:e.join(",")}).end()}}},n.getDocInfo=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var n=e.split("?")[0].split("/"),t=n[n.length-1],o="/api/office/file/".concat(t);return{types:i.default.HTTP_TYPES,callAPI:function(e){return e.get(o).query({disableSubFileId:!0}).end()}}},n.authorizedUrl=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var n="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/authorization");return{types:i.default.HTTP_TYPES,callAPI:function(t){return t.post(n).send({url:e}).end()}}},n.isKdocsDoc=function(e){return new RegExp(/(http(s)?:(\/\/)?)?(www.)?kdocs.cn\/(office\/)?([a-z]){1}\/([a-z]|[A-Z]|[\d]){12}/).test(e)}},1570:function(e,n,t){e.exports=t.p+"images/frameLoading.449d1bc4.png"},1571:function(e,n,t){e.exports=t.p+"images/loading.1c6861da.gif"},16081:function(e,n,t){},16824:function(e,n,t){"use strict";t.r(n);var i=t(1),o=t.n(i),r=t(2),a=t.n(r),l=t(22),s=t.n(l),c=t(23),p=t.n(c),d=t(238),u=t.n(d),f=t(80),h=t.n(f),w=t(144),g=t.n(w),m=t(240),v=t(2474),y=t(1283),k=t(260),b=t(3953),x=t(412),C=t(1090),_=function(e){function n(e){o()(this,n);var t=s()(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleTextChange=t.handleTextChange.bind(t),t.handleLinkChange=t.handleLinkChange.bind(t),t.handleClick=t.handleClick.bind(t),t.handleTextAreaKeyDown=t.handleTextAreaKeyDown.bind(t),t.handleInputTextKeyUp=t.handleInputTextKeyUp.bind(t),t.handleOnCancel=t.handleOnCancel.bind(t),t.handleCompositionStart=t.handleCompositionStart.bind(t),t.handleCompositionEnd=t.handleCompositionEnd.bind(t),t.modalSwitch=t.modalSwitch.bind(t),t.selectionMoveToEnd=t.selectionMoveToEnd.bind(t),t.state={modalVisible:!1,linkInsertEnterType:null},t.compositionEndTime=0,t}var t;return p()(n,e),a()(n,[{key:"componentDidMount",value:function(){window.addEventListener(k.default.hyperLink.ON_LINK_MODAL_SWITCH,this.modalSwitch)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(k.default.hyperLink.ON_LINK_MODAL_SWITCH,this.modalSwitch)}},{key:"modalSwitch",value:function(e){var n=e.detail,t=n.hyperLink,i=n.linkInsertEnterType;this.setState({modalVisible:!0,linkInsertEnterType:i,hyperLink:t}),this.getLinkInfo(t)}},{key:"selectionMoveToEnd",value:function(e){var n=e.target.value.length;e.target.selectionStart=n,e.target.selectionEnd=n}},{key:"getLinkInfo",value:function(e){if(!window.APP.coreDataInvalid()){var n=window.APP.data.selection,t="",i="",o=0,r=!1,a=!1,l=!1,s={},c=(e||{}).field,p=n.begin.position,d=n.end.position,u=p>d?[d,p]:[p,d],f=g()(u,2),h=(p=f[0])!==(d=f[1]),w=c&&c.begin>=p&&c.end<=d;switch(!e&&h?i=n.selInfo.getDisplayText(s)||i:e&&(i=(w?n.selInfo.getDisplayText(s):e.getDisplayText(s))||i,t=e.getAddress()||t,o=e.getType()),o){case v.ExistingFileOrPage:break;case v.PlaceInDoc:t=_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.notSupport", "Document location settings are not supported at this time"),a=!0}s.hasSpecialHolder&&(r=!0),t=t.trim().replace(/\\{2}/g,"\\");var m=!!(i=i.trim());t||(l=!0),this.setState({link:t,text:i,hasText:m,linkType:o,linkReadonly:a,textReadonly:r,isInsertLink:l})}}},{key:"handleTextChange",value:function(e){var n=e.target.value;this.isComposing||(n=n.trim()),this.setState({text:n,hasText:!0})}},{key:"handleLinkChange",value:function(e){var n=this.state.hasText,t=this.state.text,i=e.target.value;this.isComposing||(i=i.trim());i=i.replace(/^(www\.)([\s\S]*?)/,"https://www.$2"),n||(t=i),this.setState({link:i,text:t})}},{key:"handleClick",value:(t=h()(regeneratorRuntime.mark((function e(){var n,t,i,o,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.APP.coreDataInvalid()){e.next=2;break}return e.abrupt("return");case 2:if(n=this.state,t=n.link,i=n.isInsertLink,o=this.state.text,t){e.next=6;break}return e.abrupt("return");case 6:if(o=o||t,window.APP.data.selection.selContext.isInHeaderFooter&&window.collection("doc_insert_target_in_header_footer","hyperlink"),this.state.linkType!==v.PlaceInDoc){e.next=10;break}return e.abrupt("return");case 10:if(!window.APP.data.selection.selInfo.info.isOutOfEditableArea){e.next=13;break}return this.setState({modalVisible:!1}),e.abrupt("return");case 13:return e.next=15,window.__WPSENV__.reduxDispatch(Object(x.auditText)(o+" "+t));case 15:if(!e.sent.error){e.next=18;break}return e.abrupt("return");case 18:r=this.state.hyperLink,a=window.APP.editor,Object(C.getAllUrlsInfo)([t]),i?a.insertHyperlink({textToDisplay:o,address:t}):a.editHyperlink(r,{address:t,textToDisplay:o}),this.setState({modalVisible:!1});case 23:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleTextAreaKeyDown",value:function(e){var n=e.key,t=e.keyCode;"Enter"!==n&&13!==t||(m.stopBubble(e),Date.now()-this.compositionEndTime>150&&this.handleClick())}},{key:"handleInputTextKeyUp",value:function(e){var n=e.key,t=e.keyCode;"Enter"!==n&&13!==t||Date.now()-this.compositionEndTime>150&&this.handleClick()}},{key:"handleOnCancel",value:function(){this.setState({modalVisible:!1})}},{key:"handleCompositionStart",value:function(){this.isComposing=!0}},{key:"handleCompositionEnd",value:function(){this.isComposing=!1,this.compositionEndTime=Date.now()}},{key:"renderSectionInput",value:function(){var e=this,n=this.state.modalVisible,t=this.state,i=t.text,o=t.link,r=t.linkReadonly,a=t.textReadonly;return u.a.createElement("div",{className:"link-section-input",onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd},u.a.createElement("div",{className:"link-text-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.text", "Text")),u.a.createElement(b.Input,{value:i,placeholder:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.textplaceholder", "Enter text"),disabled:a,onChange:this.handleTextChange,onKeyUp:this.handleInputTextKeyUp})),u.a.createElement("div",{className:"link-textarea-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.link", "Link")),u.a.createElement("div",{className:"textarea-wrap"},u.a.createElement("div",{ref:function(n){return e.div=n},className:"link-textarea"},o),u.a.createElement(b.Textarea,{inputRef:function(n){return e.textarea=n},placeholder:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.linkPlaceholder", "Enter link address"),value:o,disabled:r,onFocus:this.selectionMoveToEnd,autoFocus:n,onChange:this.handleLinkChange,onKeyDown:this.handleTextAreaKeyDown}))))}},{key:"render",value:function(){if(!this.state.modalVisible)return null;var e=this.state.link,n=!this.props.connected;e||(n=!0);var t=this.renderSectionInput(),i=u.a.createElement("div",{className:"hyper-link-section"},t);return u.a.createElement(y.default,{className:"component-hyper-link-modal",title:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.insertLink", "Insert link"),okText:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.confirm", "OK"),okDisabled:n,onOk:this.handleClick,cancelText:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkModal.cancel", "Cancel"),onCancel:this.handleOnCancel},i)}}]),n}(d.PureComponent),T=t(8),E=t.n(T),L=(t(16081),t(258)),P=t.n(L),I=t(961),A=t(843),S=t(531),O=t(2631),H=t(1299),D=t(252),N=t.n(D),M=t(167),R=t(1290),F=function(e){function n(e){o()(this,n);var t=s()(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.sliceTipText=t.sliceTipText.bind(t),t.cardSwitch=t.cardSwitch.bind(t),t.onClose=t.onClose.bind(t),t.state={cardVisible:!1,position:{x:0,y:0},hyperLinkInfo:{}},t}return p()(n,e),a()(n,[{key:"componentDidMount",value:function(){window.addEventListener(k.default.hyperLink.ON_LINK_CARD_SWITCH,this.cardSwitch),this.getAllLinkInfo()}},{key:"componentWillUnmount",value:function(){window.removeEventListener(k.default.hyperLink.ON_LINK_CARD_SWITCH,this.cardSwitch)}},{key:"cardSwitch",value:function(e){var n=e.detail,t=n.hyperLink,i=n.visible,o=n.position,r=n.urlStatus,a=void 0===r?"failed":r,l=null;if(t)switch((l=this.initHyperInfo(e.detail.hyperLink)).linkType){case v.PlaceInDoc:return;case v.ExistingFileOrPage:}this.setState({cardVisible:i,position:o,hyperLinkInfo:l,urlStatus:a}),!0===i&&setTimeout((function(){window.APP.workspace.switchIndicatorState(!1)}),150)}},{key:"initHyperInfo",value:function(e){var n=this,t=window.APP.data.doc.documentFields.getFields(e.field).every((function(n){return!(n.begin<=e.field.begin&&n.end>=e.field.end)||!n._node.readonly}));return e.isEmbHyperLink()&&(t=!1),{editable:t,title:e.getDisplayText(),address:e.getAddress(),onPreView:function(){n.onClose(),window.APP.editor.switchToWebshape(e),!M.isPad&&window.APP.workspace.focusWithoutScroll(),window.collection("commandbar","click","pop_hyperlink_switchPreviewView")},onEdit:function(){n.onClose(),e.isFromCardEdit=!0,k.default.dispatchEvent(k.default.hyperLink.ON_LINK_MODAL_SWITCH,{hyperLink:e}),window.collection("commandbar","click","pop_hyperlink_edit")},onOpen:function(){n.onClose(),window.APP.editor.navigateByHyperlink(e),!M.isPad&&window.APP.workspace.focusWithoutScroll(),window.collection("commandbar","click","pop_hyperlink_open")},onCancel:function(){n.onClose(),window.APP.editor.deleteHyperlink(e),!M.isPad&&window.APP.workspace.focusWithoutScroll(),window.collection("commandbar","click","pop_hyperlink_cancel")},onCopy:function(){n.onClose(),window.APP.editor.copyHyperlink(e),!M.isPad&&window.APP.workspace.focusWithoutScroll(),window.collection("commandbar","click","pop_hyperlink_copy")},description:"",image:"",linkType:e.getType()}}},{key:"getAllLinkInfo",value:function(){var e=[],n=Math.max.apply(Math,E()(window.APP.data.doc.subdocs.map((function(e){return e.subdoc_offset+e.subdoc_size}))));Object(R.getLinks)({pos:0,len:n}).linkNodes.forEach((function(n){e.includes(n.link)||e.push(n.link)})),Object(C.getAllUrlsInfo)(e)}},{key:"onClose",value:function(){this.setState({cardVisible:!1})}},{key:"sliceTipText",value:function(){var e=this.state.hyperLinkInfo.address;if(e)return e=(e=e.replace(/\\{2}/g,"\\")).length<=25?e:e.slice(0,25)+"..."}},{key:"renderCardMenu",value:function(){var e=this.state,n=e.hyperLinkInfo,t=e.urlStatus,i=this.sliceTipText(),o=window.APP.data.selection.selInfo.info.isSelectionRangeNonEditable,r="failed"!==t&&window.__CONFIG__.wps.isEnableSwitchToWebshape&&!M.isMacOs&&!M.isIos;return u.a.createElement("div",{className:"link-menu"},u.a.createElement("div",{className:P()("link-btn-group",{disabled:!n.editable||o})},u.a.createElement(N.a,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkCard.copy", "Copy")},u.a.createElement("div",{className:"link-menu-item link-copy-btn",onClick:n.onCopy},u.a.createElement(A.default,{size:16,className:"item-icon"}))),r&&u.a.createElement(N.a,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkCard.preView", "Preview View")},u.a.createElement("div",{className:"link-menu-item link-edit-btn",onClick:n.onPreView},u.a.createElement(O.a,{size:16,className:"item-icon"}))),u.a.createElement(N.a,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkCard.edit", "Edit")},u.a.createElement("div",{className:"link-menu-item link-edit-btn",onClick:n.onEdit},u.a.createElement(S.default,{size:16,className:"item-icon"}))),u.a.createElement(N.a,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.HyperLink.HyperLinkCard.cancel", "Cancel link")},u.a.createElement("div",{className:"link-menu-item link-cancel-btn",onClick:n.onCancel},u.a.createElement(H.default,{size:16,className:"item-icon"})))),u.a.createElement("span",{className:"link-address",onClick:n.onOpen},i))}},{key:"render",value:function(){var e=this.props.connected,n=this.state,t=n.cardVisible,i=n.position,o=n.hyperLinkInfo;if(!e||!t)return!1;if(o){var r=this.renderCardMenu();return u.a.createElement(I.default,{position:i,onClose:this.onClose},r)}}}]),n}(d.Component),j=function(e){function n(){return o()(this,n),s()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return p()(n,e),a()(n,[{key:"render",value:function(){var e=this.props.connected;return u.a.createElement(u.a.Fragment,null,u.a.createElement(_,{connected:e}),u.a.createElement(F,{connected:e}))}}]),n}(d.PureComponent);n.default=j},1806:function(e,n,t){"use strict";t.r(n),t.d(n,"classes",(function(){return i})),t.d(n,"ItemConfig",(function(){return o})),t.d(n,"categories",(function(){return r}));var i={mention:"mention",filelink:"filelink",link:"link"},o={user:"mention",file:"filelink"},r={avatar:"avatar",text:"text"}},2474:function(e,n,t){"use strict";t.r(n),t.d(n,"ExistingFileOrPage",(function(){return i})),t.d(n,"PlaceInDoc",(function(){return o})),t.d(n,"EmailAddress",(function(){return r}));var i=0,o=1,r=2},2631:function(e,n,t){"use strict";var i=t(238),o=t.n(i),r=t(239);n.a=Object(r.a)("view_preview",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M1.75 7.25C1.75 6.42157 2.42157 5.75 3.25 5.75H12.75C13.5784 5.75 14.25 6.42157 14.25 7.25V12.75C14.25 13.5784 13.5784 14.25 12.75 14.25H3.25C2.42157 14.25 1.75 13.5784 1.75 12.75V7.25Z",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),o.a.createElement("path",{d:"M1.75 1.75H14.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},358:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isCustomProtocalURL=n.registerCustomProtocal=n.isCanFallow=n.isLegalURL=n.openHyperlink=void 0;var i=t(5),o=t(167),r=i.__importDefault(t(82)),a=t(386),l=t(327),s=t(14),c=t(454),p=(0,s.getQuery)("incognito"),d="true"===p||"1"===p,u=function(e){var n=(0,s.getQuery)("sublink"),t=n?parseInt(n)+1:2,i="sublink=".concat(t);e=e+(e.includes("?")?"&":"?")+i,(0,l.callAppLink)(encodeURI(e)).catch((function(){f(e)}))},f=function(e,n){void 0===n&&(n="_blank");var t=window.open(e,n),i=t&&t.opener;!m(e)&&i&&(t.opener=null)};n.openHyperlink=function(e,n){if(b(e)){var t=x(e);return t||window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),t}if(!h(e)||d)return window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1;if(g(e))return o.isMobile?(f(e),!0):(window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1);window.collection2("open_hyperlink");/^[a-z]*\:\/\/|^mailto\:/i.test(e)||(e="https://".concat(e));var i={okBtnText:_i18n("applications.public.helpers.openHyperlink.followLinkCopyLink", "Copy Link"),text:_i18n("applications.public.helpers.openHyperlink.followLinkAlertText", "Due to platform limitations, this link can only be opened in external browsers"),cancelBtnText:_i18n("applications.public.helpers.openHyperlink.cancel", "Cancel"),onOk:function(){(0,a.copyToClipboard)(e),window.Toast.success(_i18n("applications.public.helpers.openHyperlink.followLinkCopySuccessTips", "Copy link succeeded")),n&&n.onOk&&n.onOk()},onCancel:function(){n&&n.onCancle&&n.onCancle()}},r=n&&n.fileInfo;return o.isPCWxMiniProgram||o.isPad&&o.isPadMiniProgram?m(e)?(f(e),!0):(window.Confirm(i),!1):o.isInMiniProgram?m(e)?(u(e),!0):(window.Confirm(i),!1):o.isMobile&&o.isMobileWpsClient||(o.isMobile||o.isPad)&&o.isWOA?(m(e)?u(e):f(e),!0):(0,c.isSupportOfflineOpen)(r)?((0,c.offlineOpen)(e,r,(function(){f(e)})),!0):o.isSafari?(function(e){if(m(e))try{var n=document.createElement("a");n.href=e,n.target="_blank",n.rel="noreferrer";var t=new MouseEvent("click",{bubbles:!0,cancelable:!1});n.dispatchEvent(t)}catch(n){f(e)}else f(e)}(e),!0):(f(e),!0)};var h=function(e){var n=/^[`、|~,.?;:/<>'"{}\\\[\]\(\)!@#$%\^&\*\-_=\+·，。、￥？《》：；’‘“{}【】（）——！…]/;if(e.indexOf("javascript:")>-1)return!1;if(/^((https?|ftp)\:\/\/).+/i.test(e)){var t=e.replace(/^https?\:\/\//i,"").replace(/^ftp\:\/\//i,"").replace(/^mailto\:/i,"");if(n.test(t))return!1;return!/^[0-9]/.test(t)||w(t)}if(/^(mailto\:).+/i.test(e))return!0;if(g(e)){t=e.replace(/^tel:/i,"");return!n.test(t)}if(b(e))return!0;if(window.officeType===r.default.dbsheet){if(/^[a-z]*\:\/\/\S/i.test(e))return!0}return w(e)};n.isLegalURL=h;var w=function(e){return/^(((www\.)?[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*\.(com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|xxx|idv|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|yr|za|zm|zw)|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3})(:\d{1,5})?(?:(\/).*)?)$/i.test(e)},g=function(e){var n=new RegExp("^".concat("tel:\\s?").concat("((\\+86|86)\\s?)?1[3-9]\\d{9}","$")),t=new RegExp("^".concat("tel:\\s?").concat("((\\(0\\d{2,3}\\))|(0\\d{2,3}-?))?[1-9]\\d{6,7}","$"));return n.test(e)||t.test(e)},m=function(e){var n=/^https?:\/\/[^\/\?\#]+/i.exec(e.toLowerCase());if(!n)return!1;var t=n[0];return t===window.location.origin.toLowerCase()||v(t)};n.isCanFallow=m;var v=function(e){return!!(window.__CONFIG__.miniProgramHyperLinksWhiteList||"").split(",").find((function(n){return n&&e.endsWith(n)}))},y={},k=function(e){var n=e.match(/^(\w+)\:\/\//i);return n?n[1]:""};n.registerCustomProtocal=function(e,n){return!["https","http"].includes(e)&&(y[e]=n,!0)};var b=function(e){var n=k(e);return!!y[n]};n.isCustomProtocalURL=b;var x=function(e){var n=k(e),t=y[n];return!(!t||"function"!=typeof t)&&(window.collection("openkdocshyperlink",e),t(e))}},386:function(e,n,t){"use strict";t.r(n),t.d(n,"copyToClipboard",(function(){return o}));function i(e,n){var t,i,o,r,a,l,s=!1;n||(n={}),t=n.debug||!1;try{if(o=function(){var e=document.getSelection();if(!e.rangeCount&&0!==e.rangeCount)return function(){};for(var n=document.activeElement,t=[],i=0;i<e.rangeCount;i++)t.push(e.getRangeAt(i));switch(n.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":n.blur();break;default:n=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||t.forEach((function(n){e.addRange(n)})),n&&n.focus()}}(),r=document.createRange(),a=document.getSelection(),(l=document.createElement("span")).textContent=e,l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",document.body.appendChild(l),r.selectNode(l),a.addRange(r),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");s=!0}catch(o){t&&console.error("unable to copy using execCommand: ",o),t&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),s=!0}catch(o){t&&console.error("unable to copy using clipboardData: ",o),t&&console.error("falling back to prompt"),i=function(e){var n=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,n)}("message"in n?n.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{a&&("function"==typeof a.removeRange?a.removeRange(r):a.removeAllRanges()),l&&document.body.removeChild(l),o()}return s}function o(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=null;n&&(o=n.getContainer||null);var r=t||_i18n("applications.public.helpers.copy2clipboard.success", "Copy success");return i(e,n)?(window.Toast.success(r,o),!0):(window.Toast.error(_i18n("applications.public.helpers.copy2clipboard.fail", "Copy failed"),o),!1)}},3953:function(e,n,t){"use strict";t.r(n),t.d(n,"Input",(function(){return m})),t.d(n,"Textarea",(function(){return v}));var i=t(13),o=t.n(i),r=t(1),a=t.n(r),l=t(2),s=t.n(l),c=t(22),p=t.n(c),d=t(23),u=t.n(d),f=t(238),h=t.n(f),w=t(486),g=function(e){window.APP.canCopy()||((window.fileInfo&&window.fileInfo.user_acl||{}).copy&&w.canRequestForAuthForSecurityDoc&&Object(w.isCopyLimitedSecurityDoc)()?Object(w.requestForAuth)({type:w.AUTH_TYPES.COPY}):window.Toast.info(_i18n("applications.writer.components.other.HandleCutAndCopyInput.cannotCopyOrCut", "You do not have permission for this operation, please contact the owner to modify the permission")),e.preventDefault())},m=function(e){function n(){return a()(this,n),p()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u()(n,e),s()(n,[{key:"render",value:function(){var e=o()({},this.props,{ref:this.props.inputRef});return delete e.inputRef,h.a.createElement("input",o()({},e,{onCopy:g,onCut:g}))}}]),n}(h.a.Component),v=function(e){function n(){return a()(this,n),p()(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u()(n,e),s()(n,[{key:"render",value:function(){var e=o()({},this.props,{ref:this.props.inputRef});return delete e.inputRef,h.a.createElement("textarea",o()({},e,{onCopy:g,onCut:g}))}}]),n}(h.a.Component)},412:function(e,n,t){"use strict";t.r(n),t.d(n,"auditText",(function(){return o}));var i=t(783),o=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t={text:e};return n&&(t.fileId=window.fileInfo.id),{types:i.a.HTTP_TYPES,callAPI:function(e){return e.post("/api/v3/office/comment/create").send(t).end()}}}},454:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.offlineOpen=n.isSupportOfflineOpen=void 0;var i=t(5),o=i.__importDefault(t(168)),r=i.__importDefault(t(84)),a=i.__importDefault(t(85)),l=t(167),s=t(82),c=function(){return!!(l.isMobileWps&&window.wps&&window.wps.openLink)},p=function(e){return!!((0,r.default)()&&e&&e.file_id&&e.file_type)};n.isSupportOfflineOpen=function(e){return c()||p(e)};n.offlineOpen=function(e,n,t){c()?function(e,n){var t=!!n&&n.file_type&&n.file_id&&n.file_name;window.wps.openLink({url:e,link_type:t?"web_office":"common",file_type:t?n.file_type:"",file_id:t?n.file_id:"",file_name:t?n.file_name:""})}(e,n):p(n)&&function(e,n,t){var i=(0,s.getOfficeTypeByFileType)(n.file_type);if(!i)return t(e);o.default.check("openDocsOnlineFile").then((function(o){o?(0,a.default)("openDocsOnlineFile",{fileId:n.file_id,officeType:i}):t(e)})).catch((function(){t(e)}))}(e,n,t)}},531:function(e,n,t){"use strict";t.r(n);var i=t(238),o=t.n(i),r=t(239);n.default=Object(r.a)("pen",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M8.75075 3.99977L10.1901 2.56043C10.7759 1.97465 11.7256 1.97465 12.3114 2.56043L13.6901 3.93911C14.2759 4.5249 14.2759 5.47465 13.6901 6.06043L12.2508 7.49977M8.75075 3.99977L3.00117 9.74913C2.83649 9.9138 2.71241 10.1146 2.63877 10.3355L1.41422 14.0094C1.34138 14.2279 1.53179 14.4436 1.75766 14.3984L5.80541 13.5888C6.0958 13.5308 6.36249 13.388 6.5719 13.1786L12.2508 7.49977M8.75075 3.99977L12.2508 7.49977",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},843:function(e,n,t){"use strict";t.r(n);var i=t(238),o=t.n(i),r=t(239);n.default=Object(r.a)("copy",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M4.5 6.75H3.25C2.42157 6.75 1.75 7.42157 1.75 8.25V12.75C1.75 13.5784 2.42157 14.25 3.25 14.25H7.75C8.57843 14.25 9.25 13.5784 9.25 12.75V11.5M8.25 9.25H12.75C13.5784 9.25 14.25 8.57843 14.25 7.75V3.25C14.25 2.42157 13.5784 1.75 12.75 1.75H8.25C7.42157 1.75 6.75 2.42157 6.75 3.25V7.75C6.75 8.57843 7.42157 9.25 8.25 9.25Z",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))}}]);