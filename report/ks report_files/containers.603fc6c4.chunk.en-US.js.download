(window.webpackJsonp=window.webpackJsonp||[]).push([[873],{10038:function(e,t,n){"use strict";var i=n(300),o=n.n(i),a=n(80),r=n.n(a),s=n(13),l=n.n(s),c=n(30),u=n.n(c),d=n(8),_=n.n(d),E=n(1),h=n.n(E),f=n(2),O=n.n(f),p=n(2183),m=n(4669),N=function(){function e(t,n){h()(this,e),this.dispatch=n,this.fileId=t,this.ids=new Set([]),this.requestingIds=new Set,this.timer=null,this.eventDispatcher=new m.a}return O()(e,[{key:"request",value:function(e){var t=this,n=this.requestingIds.has(e);return n||(this.ids.add(e),this._request()),new Promise((function(i,o){t.eventDispatcher.once(e,(function(e){return e instanceof Error?o(e):i(e)})),n||setTimeout((function(){t.eventDispatcher.fire(e,new Error("get comment time out!")),t.requestingIds.delete(e)}),2e4)}))}},{key:"_isAttainRequestLimit",value:function(e){var t=e.size,n="";return e.forEach((function(e){n+=e})),t>=50||n.length>=1800}},{key:"_requestHandler",value:function(e){var t=this;this.dispatch(Object(p.auditCommentList)({cids:e})).then((function(n){if(n&&!n.error){var i=n.response.body.Data||[],o={};i.forEach((function(e){o[e.comment_id]=e})),e.forEach((function(e){t.eventDispatcher.fire(e,o[e]),t.requestingIds.delete(e)}))}else console.error("Error: get comments fail",n.error.message)}))}},{key:"_request",value:function(){var e=this;if(this._isAttainRequestLimit(this.ids)){clearTimeout(this.timer);var t=Array.from(this.ids);t.forEach((function(t){return e.requestingIds.add(t)})),this._requestHandler(t),this.ids.clear()}else clearTimeout(this.timer),this.timer=setTimeout((function(){var t=Array.from(e.ids);t.forEach((function(t){return e.requestingIds.add(t)})),e._requestHandler(t),e.ids.clear()}),50)}}]),e}(),v=function(){function e(t){h()(this,e),this.ids=[],this.map={},this.max=t}return O()(e,[{key:"set",value:function(e,t){var n=this.ids;if(e){if(n.length===this.max){var i=n.pop();this._del(i)}this._del(e),this._set(e,t)}}},{key:"get",value:function(e){return this.map[e]}},{key:"clean",value:function(){this.ids=[],this.map={}}},{key:"_del",value:function(e){this.map.hasOwnProperty(e)&&(this.ids=this.ids.filter((function(t){return t!=e})),delete this.map[e])}},{key:"_set",value:function(e,t){this.ids.push(e),this.map[e]=t}}]),e}(),C=n(6452),T=n(260),A=n(1643),I=n(313),S=function(){function e(t,n,i){var o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;h()(this,e),this.commentIdsToWaitRequest=new Set,this.handleEmojiUpdate=function(e){var t=e.detail,n=t.comment_id,i=t.emoji_id,a=t.user_info,r=t.is_add;if(n&&i&&a){var s=o.getCommentCache(n);if(s){var l=s.emojis;if(r)if(l){var c=l[i];if(c){var d=c.users||[];d.find((function(e){return e.id===a.id}))||(c.users=[a].concat(_()(d)))}else l[i]={users:[a]}}else s.emojis=u()({},i,{users:[a]});else if(l){var E=l[i];if(E&&E.users){var h=E.users.findIndex((function(e){return e.id===a.id}));h>-1&&E.users.splice(h,1),E.users.length||delete l[i]}}}}},this.app=i,this.commentsCache=new v(a),this.mergeRequest=new N(t,n),this.fileId=t,this.dispatch=n,this.unReadCommentList=[],this.commentMap=this.app.data.doc.getCommentMapInMainText(),this.app.commentsDataManager=this,window.addEventListener(T.default.comments.COMMENT_EMOJI_UPDATE,this.handleEmojiUpdate)}var t,n,i,a;return O()(e,[{key:"clearAll",value:function(){this.commentMap=null,window.removeEventListener(T.default.comments.COMMENT_EMOJI_UPDATE,this.handleEmojiUpdate)}},{key:"setCommentCacheObjProperty",value:function(e,t){this.commentsCache.get(e)||this.commentsCache.set(e,t)}},{key:"dataFilter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};return e.filter((function(e){var n=e.rc_id||e.comment_id||e.local_id||e.key||e.uuId;return!!n&&(!t[n]&&(t[n]=!0,!0))}))}},{key:"addComment",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=this,o=arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=window.APP.data.doc.comments.getCommentByCommentId(n),s=n&&r?{p_comment_id:n}:{};return this.dispatch(Object(p.commentReviewAsync)(l()({text:t},s))).then((function(s){if(s&&!s.error){var c=s.response.body;return c?(a&&i.collectionLength(t),c.content.text=t,n&&r&&(c.p_comment_id=n,c.isReply=!0),i.app.services.userCommentsManager.docUserCommentsHandle.insertComment(null,c,e,o),i.commentsCache.get(c.comment_id)||i.commentsCache.set(c.comment_id,c),l()({},c,{range:e})):(i.onAddFail("DATA_ERROR"),!1)}i.onAddFail()})).catch((function(e){console.log(e),i.onAddFail()}))}},{key:"addTempComment",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.dispatch(Object(C.preCreateComment)({fileid:this.fileId})).then((t=r()(regeneratorRuntime.mark((function t(o){var a,r,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o||o.error){t.next=17;break}return(a=o.response.body)||n.onAddFail("DATA_ERROR"),r=n.app.data.doc.comments.getCommentByCommentId(i),s=n.app.info,c={comment_id:a.id,content:{type:"text",text:"",duration:0,url:"",voicetext:""},time:a.time,user_info:{avatar_url:s.avatar,name:s.username,id:s.userid}},i&&r&&(c.p_comment_id=i,c.isReply=!0),n.commentsCache.get(a.id)||n.commentsCache.set(a.id,c),t.next=10,n.commitComment({comment_id:a.id});case 10:if(t.sent){t.next=13;break}return t.abrupt("return",!1);case 13:return n.app.services.userCommentsManager.docUserCommentsHandle.insertComment(null,c,e),t.abrupt("return",l()({},c,{range:e}));case 17:n.onAddFail();case 18:case"end":return t.stop()}}),t,n)}))),function(e){return t.apply(this,arguments)})).catch((function(e){console.log(e)}))}},{key:"commitComment",value:function(e){var t=this,n=e.comment_id,i=e.replyId,o=void 0===i?"":i,a=e.text,r=void 0===a?"":a,s=n&&this.commentsCache.get(n)||{},c=s.p_comment_id?s.p_comment_id:o&&window.APP.data.doc.comments.getCommentByCommentId(o)&&o||"",u=l()({text:r},n?{cid:n}:{},c?{p_comment_id:c}:{});return this.dispatch(Object(p.commentReviewAsync)(u)).then((function(e){if(e&&!e.error&&e.response&&e.response.body){var n=e.response.body,i=n.comment_id,a=n.user_info,s=n.p_comment_id,c=n.content,u=void 0===c?{}:c,d=n.time,_=s||o,E={comment_id:i,time:d,user_info:a,p_comment_id:_,isReply:!!_,content:l()({},u,{text:u.text||r})};return t.commentsCache.set(i,E),E}return t.onAddFail(),!1})).catch((function(e){return console.log(e),t.onAddFail(),!1}))}},{key:"commitTempComment",value:function(e){var t=e.range,n=(e.text,e.contents),i=e.content,a=(e.commentId,o()(e,["range","text","contents","content","commentId"])),r=l()({contents:n,content:i},a);return this.app.services.userCommentsManager.docUserCommentsHandle.insertComment(null,r,t),r}},{key:"modifyComment",value:function(e){return this.app.services.userCommentsManager.docUserCommentsHandle.modifyComment(e)}},{key:"notifyComment",value:function(e){if(!window.__CONFIG__.wps.isSendCommentMessage)return Promise.resolve();var t=e.id,n=e.isVoice,i=e.text,o=e.duration,a=this.commentsCache.get(t)||{};if(a.isNotified)return Promise.resolve();var r=this.commentsCache.get(a.p_comment_id)||{},s=r.user_info&&r.user_info.id,l=[],c=!s;s!==this.app.info.id&&l.push(s);var u={isNew:c,data:{comment_id:t,voice_id:t,type:n?1:0,text:i,duration:o,user_ids:l}};return a.isNotified=!0,this.dispatch(Object(C.sendCommentNotification)(u)).then((function(e){return!(!e||e.error)||(a.isNotified=!1,!1)}))}},{key:"getCommentsSync",value:function(e){var t=this;return this.dataFilter(e).map((function(e){var n=e.comment_id,i=t.commentsCache.get(n);return i&&e&&(i.content.text=e.content&&e.content.text||i.content.text,"text"===i.content.type&&(i.content.voicetext=""),i.time=e.time||i.time),i||e}))}},{key:"getComments",value:function(e){var t=this,n=this.dataFilter(e);if(!n)return Promise.resolve([]);var i=[];return n.forEach((function(e){i.push(t._getComment(e))})),Promise.all(i)}},{key:"updateCommentCache",value:function(e){var t=e&&e.p_comment_id;if(t){var n=this.commentsCache.get(t),i=this.app.data.doc.comments.getCommentByCommentId(t);if(i){var o=n||{},a=o.user_info,r=o.avatar_url,s=o.content;e.p_comment_user_info={name:a&&a.name||i.author,avatar:r||"",user_id:a&&a.id||i.comment_userId},e.p_comment_type=s&&s.type||i.comment_type,e.p_comment_text=s&&"text"!==s.type&&s.voicetext||i.content,e.p_comment_valid=!0}else e.p_comment_valid=!1;e.p_comment_exist=!0}return e}},{key:"getCommentCache",value:function(e){return e?this.updateCommentCache(this.commentsCache.get(e)):null}},{key:"_getComment",value:(a=r()(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.comment_id||("comment"==t.uuIdType?t.uuId:null)){e.next=3;break}return e.abrupt("return",t);case 3:if(!(i=this.commentsCache.get(n))){e.next=8;break}return i.content.text=t.content&&t.content.text||i.content.text,i.time=t.time||i.time,e.abrupt("return",i);case 8:if(!1!==i){e.next=10;break}return e.abrupt("return",t);case 10:return e.prev=10,e.next=13,this.mergeRequest.request(n);case 13:if(i=e.sent){e.next=17;break}return this.commentsCache.set(n,!1),e.abrupt("return",t);case 17:i.content.text=i.content.text||t&&t.content||"",i.user_info.avatar=i.user_info.avatar_url||i.user_info.avatar,delete i.user_info.avatar_url,t&&t.range&&(i.range=t.range),i.isNotified=!0,this.commentsCache.get(n)||(this.commentsCache.set(i.comment_id,i),this.app.commentsDataManager=this),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(10),console.log("request comment error:",e.t0),i=t;case 29:return e.abrupt("return",i);case 30:case"end":return e.stop()}}),e,this,[[10,25]])}))),function(e){return a.apply(this,arguments)})},{key:"onAddFail",value:function(){window.collection("webcomment",{area:this.app.data.selection.selInfo.getTrackArea(),result:"fail",type:"normal"}),window.APP.workspace.showToast("error",_i18n("applications.writer.components.other.Comment.tryAgain", "Submission failed. Please enter again!"))}},{key:"collectionLength",value:function(e){var t=Math.ceil(e.length);t>0?t>20&&(t=21):t=0,window.collection("webcomment",{area:this.app.data.selection.selInfo.getTrackArea(),result:"success",type:"normal"})}},{key:"_getUnReadOtherUserComments",value:(i=r()(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,this.getComments(t);case 3:return e.sent.forEach((function(e,o){e.user_info?e.user_info.id!==i.app.info.userid&&n.push(t[o]):e.author!==i.app.info.username&&n.push(t[o])})),n=n.filter((function(e){return e.date>i._lastReviewTime})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_updateLastReviewTime",value:function(){var e=this,t=((window.__WPSENV__||{}).file_info||{}).file.id||this.fileId;return this.dispatch(Object(C.updateLastReviewTime)(t)).then((function(t){if(t&&!t.error){var n=t.response.body;e._lastReviewTime=n.pre_read_time||0}})).catch((function(e){console.error("Error:",e)}))}},{key:"getLatestUnReadComments",value:(n=r()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._lastReviewTime){e.next=16;break}if(0!==Object.keys(this.commentMap).length){e.next=3;break}return e.abrupt("return",this.unReadCommentList);case 3:return e.next=5,this._updateLastReviewTime();case 5:if(0===this._lastReviewTime){e.next=11;break}return e.next=8,this._getUnReadOtherUserComments(Object.values(this.commentMap));case 8:this.unReadCommentList=e.sent,e.next=14;break;case 11:return e.next=13,this._getUnReadOtherUserComments(Object.values(this.commentMap));case 13:this.unReadCommentList=e.sent;case 14:this.unReadCommentList.sort((function(e,t){return t.date-e.date})),this.unReadCommentList.length=Math.min(this.unReadCommentList.length,3);case 16:return e.abrupt("return",this.unReadCommentList);case 17:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"handleCommentUpdate",value:(t=r()(regeneratorRuntime.mark((function e(t){var n,i,o,a,r,s,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.app.data.doc.getCommentMapInMainText(),i=Object.keys(n),o=Object.keys(this.commentMap),!t){e.next=14;break}return e.next=6,this._updateLastReviewTime();case 6:return a=new Set(o),r=i.filter((function(e){return!a.has(e)})),e.next=10,this._getUnReadOtherUserComments(r.map((function(e){return n[e]})));case 10:(s=e.sent).length&&(this.unReadCommentList=[].concat(_()(this.unReadCommentList),_()(s)).sort((function(e,t){return t.date-e.date})),this.unReadCommentList.length=Math.min(this.unReadCommentList.length,3),T.default.dispatchEvent(T.default.comments.UNREAD_COMMENT_APPENDED,{data:this.unReadCommentList})),e.next=19;break;case 14:l=new Set(i),c=o.filter((function(e){return!l.has(e)})),u=this.unReadCommentList.filter((function(e){return!c.includes(e.comment_id)&&!c.includes(e.rc_id)})),this.unReadCommentList.length>u&&T.default.dispatchEvent(T.default.comments.UNREAD_COMMENT_DELETED,{data:u}),this.unReadCommentList=u;case 19:this.commentMap=n;case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onInsertComment",value:function(){this.handleCommentUpdate(!0)}},{key:"onDeleteComment",value:function(){this.handleCommentUpdate(!1)}},{key:"addEditingCommentToGetOnlineData",value:function(e){this.commentIdsToWaitRequest.add(e)}},{key:"removeEditingCommentToGetOnlineData",value:function(e){this.commentIdsToWaitRequest.delete(e)}},{key:"getUserInfoByCommentId",value:function(e){var t=void 0;try{var n=this.app.data.doc.comments.getCommentByCommentId(e);if(n){var i=Object(A.getCommentUserIdByCommentBody)(n.body);if(i){var o=Object(I.getCachedMembers)([i])[i].a;o||(o=this.app.data.selection.selCoop.coopInfo.coopInfos.find((function(e){return e.userid===i}))),o&&(t={id:o.id||o.userid,name:o.name||o.username||o.member.name,avatar:o.avatar||o.member.avatar})}}}catch(e){}return t}}]),e}();t.a=S},10060:function(e,t,n){"use strict";var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(8213),n(238)),_=n.n(d),E=n(144),h=n.n(E),f=n(260),O=(n(8214),function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1,leftX:-1,leftY:-1,rightX:-1,rightY:-1},n.visibleChange=n.visibleChange.bind(n),n.calcPos=n.calcPos.bind(n),n.hideDragMark=n.hideDragMark.bind(n),n.handleResize=n.handleResize.bind(n),n.timeoutKey=null,n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(f.default.mobile.RENDER_DRAG_MARK,this.visibleChange),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.default.mobile.RENDER_DRAG_MARK,this.visibleChange),window.removeEventListener("resize",this.handleResize)}},{key:"calcPos",value:function(){var e=window.APP.data.selection,t=e.begin,n=e.end,i=t.position>n.position?[n,t]:[t,n],o=h()(i,2),a=o[0],r=o[1],s=window.APP.workspace.config.zoom;this.setState({show:!0,leftX:a.pos.posX*s-10+window.APP.workspace.getZoomDiff(),leftY:a.pos.posY*s-4,rightX:r.pos.posX*s+5+window.APP.workspace.getZoomDiff(),rightY:r.pos.posY*s-4})}},{key:"hideDragMark",value:function(){this.state.show&&this.setState({show:!1})}},{key:"visibleChange",value:function(e){var t=this;if(window.APP.isEditMode){var n=e.detail,i=n.visible,o=n.autoHide;!0===i?(this.calcPos(),this.timeoutKey&&clearTimeout(this.timeoutKey),!0===o&&(this.timeoutKey=setTimeout((function(){t.hideDragMark()}),2e3))):this.hideDragMark()}}},{key:"handleResize",value:function(){!0===this.state.show&&this.calcPos()}},{key:"render",value:function(){var e=this.state,t=e.show,n=e.leftX,i=e.leftY,o=e.rightX,a=e.rightY;return t?_.a.createElement(_.a.Fragment,null,_.a.createElement("span",{className:"drag-mark left-drag-mark",style:{left:n,top:i}}),_.a.createElement("span",{className:"drag-mark right-drag-mark",style:{left:o,top:a}})):null}}]),t}(d.PureComponent)),p=function(e){function t(e){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),r()(t,[{key:"render",value:function(){return _.a.createElement("div",{className:"float-element-wrapper"},_.a.createElement(O,null))}}]),t}(d.PureComponent);t.a=p},10260:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return _}));var i,o=n(30),a=n.n(o),r=n(284),s=n.n(r),l=n(8211),c=s.a.size24,u=(i={},a()(i,l.a.history,{name:"history",iconType:c.topbar_history,title:_i18n("applications.writer.components.CommandBars.TaskPane.topbarHistory", "Collaboration Record")}),a()(i,l.a.font,{name:"font",iconType:c.topbar_font,title:_i18n("applications.writer.components.CommandBars.TaskPane.topbarFont", "Text Properties")}),a()(i,l.a.exportPdf,{name:"exportPdf",iconType:c.wps_export_pdf,title:_i18n("applications.writer.components.CommandBars.TaskPane.exportPDF", "Export as PDF")}),a()(i,l.a.exportImg,{name:"exportImg",iconType:c.wps_export_img,title:_i18n("applications.writer.components.CommandBars.TaskPane.exportImg", "Export as Picture")}),[l.a.history,l.a.font,l.a.cooper,l.a.bookmark,l.a.officialDocumentField]),d={min:0,normal:0,max:314,guide:322},_=[l.a.history,l.a.cooper]},10261:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={styles:"styles",paragraph:"paragraph"}},10262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={attribute:"attribute",text:"text"}},10263:function(e,t,n){"use strict";var i=n(238),o=n.n(i).a.createContext({visible:!1,connected:!1,readOnly:!0,inRestrictEditMode:!0,isAllowFormatWithControl:!0,isShowDocMap:!1,isInReadonlyDocumentField:!1});t.a=o},1146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCommentHide=t.isLoadedAuditComment=t.isRefusalToAppeal=t.checkReportVisible=t.checkVisible=t.auditComments=t.CommentAudit=t.CommentShowType=t.CommentType=t.COMMENT_REVIEW_STATUS=t.ReviewAttr=void 0;var i,o,a,r,s=n(5),l=n(2183),c=s.__importDefault(n(260));!function(e){e[e.PASS=0]="PASS",e[e.IN_REVIEW=1]="IN_REVIEW",e[e.FORBID=2]="FORBID",e[e.UN_REVIEW=3]="UN_REVIEW"}(i||(i={})),t.COMMENT_REVIEW_STATUS=i,function(e){e.TEXT="text",e.VOICE="voice"}(o||(o={})),t.CommentType=o,function(e){e[e.visible=0]="visible",e[e.forbid=1]="forbid",e[e.loading=2]="loading",e[e.forbidFeedback=3]="forbidFeedback"}(a||(a={})),t.CommentShowType=a,function(e){e[e.FORBIDAPPEALABLE=0]="FORBIDAPPEALABLE",e[e.APPEALABLE=1]="APPEALABLE"}(r||(r={})),t.ReviewAttr=r;var u=function(e){var t,n,o,a,s,l;return{id:e.comment_id,status:null!==(n=null===(t=e.content)||void 0===t?void 0:t.review_status)&&void 0!==n?n:i.IN_REVIEW,userId:null!==(a=null===(o=e.user_info)||void 0===o?void 0:o.id)&&void 0!==a?a:null,attr:e.content.review_attr,isRefusalToAppeal:(null===(s=e.content)||void 0===s?void 0:s.review_attr)===r.FORBIDAPPEALABLE&&(null===(l=e.content)||void 0===l?void 0:l.review_status)===i.FORBID}},d=function(e){var t=O.get(e);if(!t&&window.APP.commentsDataManager&&window.APP.commentsDataManager.commentsCache){var n=window.APP.commentsDataManager.commentsCache.get(e);n&&(t=u(n))}return t},_=function(e){return s.__awaiter(void 0,void 0,Promise,(function(){var t;return s.__generator(this,(function(n){switch(n.label){case 0:return[4,(i=e,s.__awaiter(void 0,void 0,void 0,(function(){var e;return s.__generator(this,(function(t){switch(t.label){case 0:return[4,window.__WPSENV__.reduxDispatch((0,l.auditCommentList)(i))];case 1:return!(e=t.sent())||e.error?[2,null]:[2,e.response.body]}}))}))).catch(console.error)];case 1:return(t=n.sent())?[2,t.Data.reduce((function(e,t){var n=t.comment_id,i=u(t);return e.set(n,i),e}),new Map)]:[2,new Map]}var i}))}))},E=function(e){var t=a.visible;if(!e)return t;var n=d(e);if(!n)return t;var o=n.userId===window.__WPSENV__.user_id;if(n.status===i.FORBID)t=n.attr===r.FORBIDAPPEALABLE?a.forbidFeedback:a.forbid;else{if(n.status===i.PASS||n.status===i.UN_REVIEW)return t;o||(t=a.loading)}return t};t.checkVisible=E;t.checkReportVisible=function(e){var t=e.authorId,n=e.commentId;if(!n)return!1;var i=window.__WPSENV__.file_info.user;if(t===i.id)return!1;var o,r=null,s=window.APP.commentsDataManager.commentsCache.get(n);return s&&(r=s.user_info&&s.user_info.attrs&&s.user_info.attrs.company_id),(!i.attrs||r!==i.attrs.company_id||"0"===r)&&(!!(o=window.__WPSPLUGIN__.helper).has(o.types.ReportComment)&&E(n)===a.visible)};var h=function(e){if(!e)return!1;var t=d(e);return!!t&&t.isRefusalToAppeal};t.isRefusalToAppeal=h;var f=!1;t.isLoadedAuditComment=function(){return f};t.isCommentHide=function(e){if(!e)return!1;var t=!1,n=window.APP.data.doc.commentBubbles.getBubblesByRange(e.pos,e.len);n&&n.length>0&&n.some((function(n){return!!(n.data||[]).some((function(t){return t.comment_id===e.comment_id}))&&(t=h(n.data[0].comment_id),!0)}));var i=h(e.comment_id);return!(!t&&!i)};var O=new Map;t.auditComments=O;var p=function(){function e(){}var n;return n=e,e.subscribed=!1,e.subscribes=function(){n.subscribed||(n.subscribed=!0,n.updateAuditComments(),window.addEventListener(c.default.comments.ON_COMMENT_TEXT_REVIEW,n.handleTextAudit))},e.unsubscribes=function(){n.subscribed=!1,window.removeEventListener(c.default.comments.ON_COMMENT_TEXT_REVIEW,n.handleTextAudit)},e.handleTextAudit=function(t){var n=t.detail.message;if(n){var i=JSON.parse(n),o=i.type,a=i.comment_id;"review_result"===o&&e.updateCommentById(a)}},e.updateAuditComments=function(){return s.__awaiter(void 0,void 0,void 0,(function(){var e;return s.__generator(n,(function(n){switch(n.label){case 0:return e={review_status:"".concat(i.IN_REVIEW,",").concat(i.FORBID)},[4,_(e)];case 1:return t.auditComments=O=n.sent(),f=!0,c.default.dispatchEvent(c.default.comments.GET_ONLINE_AUDIT_COMMENTS),[2,O]}}))}))},e.updateCommentById=function(e){return s.__awaiter(void 0,void 0,void 0,(function(){var t,i,o;return s.__generator(n,(function(n){switch(n.label){case 0:return e?(t={cids:"".concat(e)},[4,_(t)]):[2,O];case 1:return i=n.sent(),(o=i.get(e))&&(O.set(e,o),c.default.dispatchEvent(c.default.comments.GET_ONLINE_AUDIT_COMMENTS)),[2,O]}}))}))},e}();t.CommentAudit=p},11748:function(e,t,n){},11749:function(e,t,n){},11750:function(e,t,n){},11751:function(e,t,n){e.exports=function(e,t){n.e(807).then(n.bind(null,16703)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11752:function(e,t,n){e.exports=function(e,t){n.e(809).then(n.bind(null,16706)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11753:function(e,t,n){e.exports=function(e,t){n.e(806).then(n.bind(null,16816)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11754:function(e,t,n){e.exports=function(e,t){n.e(805).then(n.bind(null,16817)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11755:function(e,t,n){e.exports=function(e,t){n.e(803).then(n.bind(null,14008)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11756:function(e,t,n){e.exports=function(e,t){n.e(808).then(n.bind(null,16873)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11757:function(e,t,n){e.exports=function(e,t){n.e(804).then(n.bind(null,16793)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11758:function(e,t,n){e.exports=function(e,t){n.e(775).then(n.bind(null,14018)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11759:function(e,t,n){e.exports=function(e,t){n.e(784).then(n.bind(null,14020)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11760:function(e,t,n){e.exports=function(e,t){n.e(783).then(n.bind(null,14021)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11761:function(e,t,n){e.exports=function(e,t){n.e(779).then(n.t.bind(null,14022,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11762:function(e,t,n){e.exports=function(e,t){n.e(801).then(n.bind(null,16787)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11763:function(e,t,n){e.exports=function(e,t){n.e(795).then(n.bind(null,16690)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11764:function(e,t,n){e.exports=function(e,t){n.e(857).then(n.bind(null,14061)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11765:function(e,t,n){e.exports=function(e,t){n.e(787).then(n.bind(null,16740)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11766:function(e,t,n){e.exports=function(e,t){n.e(786).then(n.bind(null,16874)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11767:function(e,t,n){e.exports=function(e,t){n.e(840).then(n.bind(null,16875)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11768:function(e,t,n){e.exports=function(e,t){n.e(863).then(n.bind(null,16794)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11769:function(e,t,n){e.exports=function(e,t){n.e(845).then(n.bind(null,16795)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11770:function(e,t,n){e.exports=function(e,t){n.e(839).then(n.bind(null,16796)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11771:function(e,t,n){},11772:function(e,t,n){e.exports=function(e,t){n.e(849).then(n.bind(null,16876)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11773:function(e,t,n){e.exports=function(e,t){n.e(851).then(n.bind(null,16818)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11774:function(e,t,n){e.exports=function(e,t){n.e(850).then(n.bind(null,16877)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11775:function(e,t,n){e.exports=function(e,t){n.e(785).then(n.bind(null,14094)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11776:function(e,t,n){e.exports=function(e,t){n.e(778).then(n.bind(null,14096)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11777:function(e,t,n){e.exports=function(e,t){n.e(776).then(n.bind(null,16878)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11778:function(e,t,n){e.exports=function(e,t){n.e(844).then(n.bind(null,14100)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11779:function(e,t,n){e.exports=function(e,t){n.e(871).then(n.bind(null,14102)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11780:function(e,t,n){e.exports=function(e,t){n.e(870).then(n.bind(null,14104)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11781:function(e,t,n){e.exports=function(e,t){n.e(853).then(n.bind(null,14106)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11782:function(e,t,n){e.exports=function(e,t){n.e(842).then(n.bind(null,16819)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11783:function(e,t,n){e.exports=function(e,t){n.e(847).then(n.bind(null,14109)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11784:function(e,t,n){e.exports=function(e,t){n.e(793).then(n.bind(null,14112)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11785:function(e,t,n){e.exports=function(e,t){n.e(864).then(n.bind(null,14115)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11786:function(e,t,n){e.exports=function(e,t){n.e(860).then(n.bind(null,16754)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11787:function(e,t,n){e.exports=function(e,t){n.e(777).then(n.bind(null,14134)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11788:function(e,t,n){e.exports=function(e,t){n.e(859).then(n.bind(null,16729)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11789:function(e,t,n){e.exports=function(e,t){n.e(865).then(n.bind(null,14139)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11790:function(e,t,n){e.exports=function(e,t){n.e(867).then(n.bind(null,16788)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11791:function(e,t,n){e.exports=function(e,t){n.e(868).then(n.bind(null,14153)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11792:function(e,t,n){e.exports=function(e,t){n.e(869).then(n.bind(null,14155)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11793:function(e,t,n){e.exports=function(e,t){n.e(866).then(n.t.bind(null,14157,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11794:function(e,t,n){e.exports=function(e,t){n.e(846).then(n.t.bind(null,14159,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11795:function(e,t,n){},11796:function(e,t,n){},1276:function(e,t,n){"use strict";n.r(t),t.default={Confirm:"Confirm",Bookmark:"Bookmark",CopyLink:"CopyLink",SwitchWebMode:"SwitchWebMode",MissingFont:"MissingFont"}},1327:function(e,t,n){},1490:function(e,t,n){"use strict";n.r(t),n.d(t,"changeTaskPaneWidth",(function(){return s})),n.d(t,"changeGuideWidth",(function(){return l})),n.d(t,"getTaskPaneWidth",(function(){return c})),n.d(t,"changeLoginGuidVisible",(function(){return u})),n.d(t,"changeHeaderVisible",(function(){return d}));var i=n(227),o=n(1373),a=0,r=0,s=function(e,t){a=e;var n=e+r;i.default.dispatchEvent(i.default.names.ON_TASK_PANE_WIDTH_CHANGE,{width:n}),!0!==t&&i.default.cooper.onContainerResize()},l=function(e){r=e},c=function(){return a},u=function(e){return function(t){t({type:o.a.LOGIN_GUIDE_VISIBLE,visible:e})}},d=function(e){return function(t){t({type:o.a.HEADER_VISIBLE,visible:e})}}},1643:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeBkName",(function(){return s})),n.d(t,"decodeBkName",(function(){return l})),n.d(t,"getTime",(function(){return c})),n.d(t,"isValidCommentBkName",(function(){return u})),n.d(t,"getCommentUserIdByCommentBody",(function(){return d}));var i=n(144),o=n.n(i),a="_T",r="_V",s=function(e,t){var n=e+"_"+window.APP.info.userid;return"voice"==t?r+n:a+n},l=function(e){if(!e||e.length<3||"_"!=e[0])return null;var t=e.slice(0,2),n="",i="",s="",l=e.slice(2).split("_"),c=o()(l,2);return i=c[0],s=c[1],t===r?n="voice":t===a?n="text":(n="other",i=e,s=""),{type:n,comment_id:i,userId:s}},c=function(e){var t=e;if("string"==typeof e)t=new Date(t.replace(/-/g,"/"));else{if("number"==typeof e)return e;t=new Date}return Math.floor(t.getTime()/1e3)},u=function(e){return e.length>2&&"_"===e[0]&&("V"===e[1]||"T"===e[1])};function d(e){var t=window.APP.data.doc.bookmarks.getBookmarkByCommentBody(e);if(t){var n=t.data.getName(),i=l(n);if(i)return i.userId}}},16700:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"switchRestrictEditMode",(function(){return Jt}));var o=n(13),a=n.n(o),r=n(1),s=n.n(r),l=n(2),c=n.n(l),u=n(22),d=n.n(u),_=n(23),E=n.n(_),h=n(238),f=n.n(h),O=n(241),p=n(537),m=n(258),N=n.n(m),v=n(227),C=n(240),T=n(167),A=n(14),I=n(260),S=n(30),w=n.n(S),g=(n(11748),n(259)),R=n.n(g),P=n(1490),D=(n(11749),n(11750),n(312)),b=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return E()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.showBorderBottom,i=e.onClose,o=-1!==t.indexOf("//"),a="component-task-pane-header";return n&&(a+=" show-border-bottom"),f.a.createElement("div",{className:a},f.a.createElement("div",{className:"title"+(o?" is-img":"")},o&&f.a.createElement("img",{src:t,alt:""}),!o&&t),f.a.createElement(D.default,{className:"close-btn",iconType:D.default.iconTypes.size16.close,onClick:i}))}}]),t}(h.PureComponent);b.defaultProps={showBorderBottom:!0};var M=b,L=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refContent=f.a.createRef(),n.state={id:e.id,caption:e.caption,onShow:null,onClose:null},n}return E()(t,e),c()(t,[{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n&&this._onShow?this._onShow():!n&&this._onClose&&this._onClose())}},{key:"getElement",value:function(){return this.refContent.current}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onClose,i=this.state.caption,o="task-sub-panel custom-task-pane";return t||(o+=" hidden"),f.a.createElement("div",{className:o},f.a.createElement(M,{title:i,onClose:n}),f.a.createElement("div",{ref:this.refContent,className:"panel-content"}))}},{key:"id",get:function(){return this.state.id}},{key:"__visible",set:function(e){e&&!this.props.visible?this.props.onForceShow():!e&&this.props.visible&&this.props.onClose()},get:function(){return this.props.visible}},{key:"caption",set:function(e){this.setState({caption:e})},get:function(){return this.state.caption}},{key:"onShow",set:function(e){this._onShow=e},get:function(){return this._onShow}},{key:"onClose",set:function(e){this._onClose=e},get:function(){return this._onClose}}]),t}(h.PureComponent),y=n(247),k=n(8210),H=n.n(k),B=n(3532),G=n.n(B),W=n(5027),F=n.n(W),V=n(11751),U=n.n(V),x=n(11752),j=n.n(x),K=n(11753),Y=n.n(K),X=n(11754),J=n.n(X),z=n(11755),Z=n.n(z),q=n(11756),Q=n.n(q),$=n(11757),ee=n.n($),te=n(8211),ne=n(10260),ie=n(10261),oe=n(342),ae=n(984),re=ae.types.TASK_PANEL_OPENED,se=function(){return ae.getStatus(re,!0)},le=function(e){ae.setStatus(re,e,!0)},ce=function(){ae.deleteStatus(re,!0)},ue=n(10262),de=window.CommandBarComponent,_e=de.cmbIds.wps,Ee=function(e){function t(e){var n;s()(this,t);var i=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,_e.TaskPane));fe.call(i),i.handleHistoryVisible=i.handleHistoryVisible.bind(i),i.handleClose=i.handleClose.bind(i),i.handleHistoryMergeVisible=i.handleHistoryMergeVisible.bind(i);var o=(n={},w()(n,te.a.history,{loader:G.a}),w()(n,te.a.cooper,{loader:H.a}),w()(n,te.a.historyMerge,{loader:F.a}),w()(n,te.a.font,{loader:U.a}),w()(n,te.a.exportPdf,{loader:Y.a}),w()(n,te.a.exportImg,{loader:J.a}),w()(n,te.a.bookmark,{loader:Z.a}),w()(n,te.a.officialDocumentField,{loader:Q.a}),w()(n,te.a.comment,{loader:ee.a}),w()(n,te.a.shape,{loader:j.a}),n);return Object.keys(o).forEach((function(e){o[e].visible=!1,o[e].loaded=!1,o[e].isThirdPartyPanel=!1,o[e].data=null})),i.state={panelMap:o,status:ne.c.normal,activeLabels:[],activeTab:"",historyVersionRecordKey:0,cooperRecordKey:0,switchPanelManually:!1,collectType:"insert"},i.handleCooperVisible=i.handleCooperVisible.bind(i),i.handleShowExportPdf=i.handleShowExportPdf.bind(i),i.handleShowExportImg=i.handleShowExportImg.bind(i),i.handleShowFont=i.handleShowFont.bind(i),i.handleShowPara=i.handleShowPara.bind(i),i.handleTabChange=i.handleTabChange.bind(i),i.handleBookmarkVisibile=i.handleBookmarkVisibile.bind(i),i.handleShowComment=i.handleShowComment.bind(i),i.handleShowShapeAttr=i.handleShowShapeAttr.bind(i),i.handleShowShapeText=i.handleShowShapeText.bind(i),i}return E()(t,e),c()(t,[{key:"componentDidMount",value:function(){Object(A.hasQuery)("version")&&this.handleActivePanel(te.a.history);var e=this.state.status;if(Object(P.changeTaskPaneWidth)(e,!0),e===ne.c.max&&this.handleActivePanel(te.a.history),!Object(A.getBoolQuery)("hidePanel")&&this.props.openSuccess&&!window.APP.isReadOnly()){var t=se();t&&this.handleActivePanel(te.a[t])}window.addEventListener(v.default.names.cooper.ON_HISTORY_VISIBLE_CHANGE,this.handleHistoryVisible),window.addEventListener(v.default.names.cooper.ON_COOPER_VISIBLE_CHANGE,this.handleCooperVisible),window.addEventListener(v.default.names.cooper.ON_HISTORY_MERGE_CHANGE,this.handleHistoryMergeVisible),window.addEventListener(v.default.names.file.ON_EXPORT_PDF,this.handleShowExportPdf),window.addEventListener(v.default.names.file.ON_EXPORT_IMG,this.handleShowExportImg),window.addEventListener(I.default.taskPane.OPEN_BOOKMARK,this.handleBookmarkVisibile),window.addEventListener(I.default.taskPane.OPEN_FONT_FONT,this.handleShowFont),window.addEventListener(I.default.taskPane.OPEN_FONT_PARA,this.handleShowPara),this.wrapNode.addEventListener("scroll",this.handleScroll),window.addEventListener(I.default.taskPane.OPEN_OFFICIAL_DOCUMENT,this.showOfficialDocumentField),window.addEventListener(I.default.taskPane.OPEN_SHAPE_ATTR,this.handleShowShapeAttr),window.addEventListener(I.default.taskPane.OPEN_SHAPE_TEXT,this.handleShowShapeText),window.addEventListener(I.default.taskPane.OPEN_COMMENT_PANEL,this.handleShowComment),window.addEventListener(I.default.taskPane.CLOSE_TASK_PANEL,this.handleClose),this.wrapNode.addEventListener("copy",this.handleCopy)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state.status;n!==t.status&&(Object(P.changeTaskPaneWidth)(n,!0),window.APP&&window.APP.workspace&&window.APP.workspace&&window.APP.workspace.resize());var i=this.props.openSuccess;if(i&&i!==e.openSuccess&&(!Object(A.getBoolQuery)("hidePanel")&&!window.APP.isReadOnly())){var o=se();o&&this.handleActivePanel(te.a[o])}e.inRestrictEditMode!==this.props.inRestrictEditMode&&(this.setState({historyVersionRecordKey:~this.state.historyVersionRecordKey}),this.setState({cooperRecordKey:~this.state.cooperRecordKey}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener(v.default.names.cooper.ON_HISTORY_VISIBLE_CHANGE,this.handleHistoryVisible),window.removeEventListener(v.default.names.cooper.ON_COOPER_VISIBLE_CHANGE,this.handleCooperVisible),window.removeEventListener(v.default.names.cooper.ON_HISTORY_MERGE_CHANGE,this.handleHistoryMergeVisible),window.removeEventListener(v.default.names.file.ON_EXPORT_PDF,this.handleShowExportPdf),window.removeEventListener(v.default.names.file.ON_EXPORT_IMG,this.handleShowExportImg),window.removeEventListener(I.default.taskPane.OPEN_FONT_FONT,this.handleShowFont),window.removeEventListener(I.default.taskPane.OPEN_FONT_PARA,this.handleShowPara),window.removeEventListener(I.default.taskPane.OPEN_BOOKMARK,this.handleBookmarkVisibile),window.removeEventListener(I.default.taskPane.OPEN_OFFICIAL_DOCUMENT,this.showOfficialDocumentField),window.removeEventListener(I.default.taskPane.OPEN_COMMENT_PANEL,this.handleShowComment),window.removeEventListener(I.default.taskPane.CLOSE_TASK_PANEL,this.handleClose),window.removeEventListener(I.default.taskPane.OPEN_SHAPE_ATTR,this.handleShowShapeAttr),window.removeEventListener(I.default.taskPane.OPEN_SHAPE_TEXT,this.handleShowShapeText),this.wrapNode.removeEventListener("scroll",this.handleScroll),this.wrapNode.removeEventListener("copy",this.handleCopy)}},{key:"handleActivePanel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&(e!==te.a.officialDocumentField||window.__CONFIG__.wps.enableDocumentField)&&(e!==te.a.comment||window.APP.isCommentEnabled)){this.preventScrollBarShow();var i=this.props.handleToggleTaskPane,o=a()({},this.state.panelMap);Object.keys(o).forEach((function(e){return o[e].visible=!1})),o[e].visible=!0,o[e].loaded=!0,o[e].data=n,e!==te.a.comment&&(v.default.dispatchEvent(I.default.taskPane.KILL_COMMENT_PANEL),this.showCommentBubbles()),i(!0),this.setState({panelMap:o,status:ne.c.max},(function(){t.visibleChangeAfter(),v.default.dispatchEvent(I.default.taskPane.ON_TASK_PANE_VISIBLE,{visible:!0})})),-1!==ne.a.indexOf(e)?le(e):ce(),!0!==this.firstExpand&&this.tryToChangeGuideVisible()}}},{key:"add",value:function(e){var t=this,n=e.id,i=e.caption,o=e.visible,r=void 0!==o&&o;if(this.state.panelMap[n])throw new Error("该控件ID已存在："+n);return ne.b.push(n),this.state.panelMap[n]={loader:function(e){return e(L)},isThirdPartyPanel:!0},new Promise((function(e){var o={id:n,caption:i};if(t._ref(n).resolve=e,r)t.handleActivePanel(n,o);else{var s=a()({},t.state.panelMap);s[n].visible=!1,s[n].loaded=!0,s[n].data=o,t.setState({panelMap:s})}}))}},{key:"remove",value:function(e){var t=this,n=ne.b.indexOf(e);-1!==n&&ne.b.splice(n,1);var i=a()({},this.state.panelMap),o=this.state.status;return i[e].visible&&(o=ne.c.min),delete i[e],this.setState({panelMap:i,status:o},(function(){t.visibleChangeAfter()})),!0}},{key:"visibleChangeAfter",value:function(){var e=this.state.panelMap,t=Object.keys(e).filter((function(t){return e[t].visible})).length>0,n=t?ne.c.max:ne.c.min;n!==this.state.status&&this.setState({status:n}),this.tryToChangeGuideVisible(t)}},{key:"handleShowExportPdf",value:function(){window.collection("commandbar","click","head|more_export_pdf"+(window.APP.isWebMode()?"web":"")),window.collection("exportpdf","entrance"),this.handleActivePanel(te.a.exportPdf)}},{key:"handleShowExportImg",value:function(){var e=this;window.collection("commandbar","click","head|more_export_pic"+(window.APP.isWebMode()?"web":"")),window.collection("exportimg","entrance");var t=window.__WPSPLUGIN__.loader,n={pluginType:oe.PLUGIN_TYPE.ShapeExport};t.search(n)?t.loadSingleInstance(n).then((function(e){e.messageGet({action:"show"})})).catch((function(t){console.error("加载插件失败，启用原生的导出"),e.handleActivePanel(te.a.exportImg)})):this.handleActivePanel(te.a.exportImg)}},{key:"handleShowFont",value:function(){this.handleActivePanel(te.a.font),this.handleTabChange(ie.a.styles)}},{key:"handleShowPara",value:function(){this.handleActivePanel(te.a.font),this.handleTabChange(ie.a.paragraph)}},{key:"handleHistoryVisible",value:function(){this.handleActivePanel(te.a.history)}},{key:"handleCooperVisible",value:function(){this.handleActivePanel(te.a.cooper)}},{key:"handleHistoryMergeVisible",value:function(e){this.handleActivePanel(te.a.historyMerge,e.detail)}},{key:"handleBookmarkVisibile",value:function(e){var t=e.detail.collectType;this.handleActivePanel(te.a.bookmark),this.setState({collectType:t})}},{key:"handleShowComment",value:function(){v.default.dispatchEvent(I.default.comments.SHOW_COMMENTS_TIPS,{checked:!0}),this.handleActivePanel(te.a.comment,!0),v.default.dispatchEvent(I.default.taskPane.GET_COMMENT_PANEL_DATA,{openCommentPanel:!0})}},{key:"handleTabChange",value:function(e){this.setState({activeTab:e})}},{key:"handleShowShapeAttr",value:function(){this.handleActivePanel(te.a.shape),this.handleTabChange(ue.a.attribute)}},{key:"handleShowShapeText",value:function(){this.handleActivePanel(te.a.shape),this.handleTabChange(ue.a.text)}},{key:"tryToChangeGuideVisible",value:function(e,t){var n=this.props.isWriteGuide,i=t||this.state.status;n&&v.default.dispatchEvent(I.default.guide.CLOSE_GUIDE,{status:i,visible:e})}},{key:"preventScrollBarShow",value:function(){var e=this;if(window.APP){var t=window.APP.workspace.container.parentElement;t.scrollWidth>t.clientWidth||(t.style.overflowX="hidden",this.resetWorkspaceOverflowTimer&&clearTimeout(this.resetWorkspaceOverflowTimer),this.resetWorkspaceOverflowTimer=setTimeout((function(){t.style.overflowX="",e.resetWorkspaceOverflowTimer=0}),1e3))}}},{key:"handleClose",value:function(){var e=this.state.panelMap,t=this.props,n=t.isWriteGuide,i=t.handleToggleTaskPane;Object.values(e).forEach((function(e){return e.visible=!1})),e=a()({},e),this.setState({activeLabels:[],panelMap:e,status:ne.c.normal},(function(){v.default.dispatchEvent(I.default.taskPane.ON_TASK_PANE_VISIBLE,{visible:!1})})),ce(),i(!1),!T.isPad&&window.APP.workspace.focusWithoutScroll(),n&&v.default.dispatchEvent(I.default.guide.OPEN_GUIDE,{status:ne.c.normal}),this.showCommentBubbles()}},{key:"showCommentBubbles",value:function(){if(window.APP&&window.APP.appApi){if(window.APP.appApi.getCommentShowStatus().commentBubble)return;v.default.dispatchEvent(I.default.comments.CANCEL_SELECT_COMMENT_PANEL),window.APP.appApi.showComments({checked:!0}),window.APP.appApi.setCommentShowStatus({commentBubble:!0}),v.default.dispatchEvent(I.default.revision.SHOW_REVISION_BUBBLE,{visible:!0})}}},{key:"getClassName",value:function(){var e=this.props.showTaskPane,t=this.state,n=t.status,i=t.panelMap,o="word-component-task-pane";T.isIEPure&&(o+=" ie-browser"),this.props.showCommandBars||(o+=" top0",o+=" top5"),n===ne.c.min?o+=" status-min":n===ne.c.normal?o+=" status-normal alt-pane":n===ne.c.max&&(o+=" status-max alt-pane"),i[te.a.officialDocumentField].loaded&&(o+=" scrollable");var a=n===ne.c.max?Object.values(i).filter((function(e){return e.visible}))[0]:null;return(i[te.a.exportImg].visible&&a===te.a.exportImg||i[te.a.exportPdf].visible&&a===te.a.exportPdf||e)&&(o+=" visible"),o}},{key:"_ref",value:function(e){var t=this;return this._refMap=this._refMap||{},this._refMap[e]=this._refMap[e]||{cb:function(n){t._refMap[e].el=n;var i=t._refMap[e].resolve;i&&(delete t._refMap[e].resolve,i(n))}},this._refMap[e]}},{key:"renderPanels",value:function(){var e=this,t=this.props.public.network.connected,n=this.props.public.file,i=this.props,o=i.hasPassword,r=i.dispatch,s=i.isAllowFormatWithControl,l=i.isAllowInsertBookmarkWithControl,c=i.readOnly,u=i.inRestrictEditMode,d=i.isOutOfEditableArea,_=i.isInComment,E=this.state,h=E.panelMap,O=E.activeTab,p=E.switchPanelManually,m=E.historyVersionRecordKey,N=E.cooperRecordKey,v=[],C=function(i){if(h.hasOwnProperty(i)&&h[i].loaded){var E=h[i],C=E.visible,T=E.isThirdPartyPanel,A=void 0;switch(A){case te.a.history:A=m;break;case te.a.cooper:A=N}var I=a()({},h[i].data,{dispatch:r,readOnly:c,file:n,connected:t,hasPassword:o,visible:C,inRestrictEditMode:u,isInComment:_,isAllowFormatWithControl:s,isAllowInsertBookmarkWithControl:l,activeTab:O,key:A,shapeVisible:h[te.a.shape].visible,switchPanelManually:p,handleTabChange:e.handleTabChange,handleScroll:e.handleScroll,onClose:e.handleClose,onForceShow:function(){return e.handleActivePanel(i,h[i].data)}});[te.a.history,te.a.cooper,te.a.historyMerge].includes(i)&&(I.canRollback=!u),T?I.ref=e._ref(i).cb:(I.isOutOfEditableArea=d,I.collectType=e.state.collectType);var S=Object(y.default)(h[i].loader,I);v.push(f.a.cloneElement(S,{key:i}))}};for(var T in h)C(T);return v}},{key:"render",value:function(){var e=this,t=this.renderPanels(),n=this.getClassName();return f.a.createElement("div",{className:n},f.a.createElement("div",{className:"panel-wrap",ref:function(t){return e.wrapNode=t}},t))}}]),t}(de);Ee.propTypes={showCommandBars:R.a.bool.isRequired,hasPassword:R.a.bool.isRequired,openSuccess:R.a.bool.isRequired,inRestrictEditMode:R.a.bool,isWriteGuide:R.a.bool,readOnly:R.a.bool,showTaskPane:R.a.bool,handleToggleTaskPane:R.a.func,public:R.a.object,dispatch:R.a.func,isAllowInsertBookmarkWithControl:R.a.bool,isAllowFormatWithControl:R.a.bool,isInComment:R.a.bool},Ee.defaultProps={inRestrictEditMode:!1};var he,fe=function(){var e=this;this.showOfficialDocumentField=function(){e.handleActivePanel(te.a.officialDocumentField,!0),e.setState({switchPanelManually:!0})},this.handleScroll=function(){var t=document.querySelectorAll(".component-dropdown-popup");if(t.length>0)for(var n=e.wrapNode.getBoundingClientRect(),i=n.left,o=n.top,a=0;a<t.length;a++){var r=t[a],s=r.clientWidth,l=r.getBoundingClientRect(),c=l.left,u=l.top;if(c+s>i&&u>o){v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL);break}}},this.handleCopy=function(t){var n=e.state.panelMap;window.APP.copyControl()&&n[te.a.cooper].visible&&t.preventDefault()}},Oe=Object(O.connect)((function(e){return e}))(Ee),pe=n(1276),me=n(300),Ne=n.n(me),ve=n(662),Ce=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return E()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.tips,i=Ne()(e,["text","tips"]),o=f.a.createElement("div",null,f.a.createElement(ve.default.Text,null,t),!!n&&f.a.createElement(ve.default.Tips,null,n));return f.a.createElement(ve.default,a()({},i,{maskClosable:!0}),o)}}]),t}(h.PureComponent),Te=n(11758),Ae=n.n(Te),Ie=n(11759),Se=n.n(Ie),we=n(11760),ge=n.n(we),Re=n(11761),Pe=n.n(Re),De=(he={},w()(he,pe.default.Confirm,{component:Ce,offlineClose:!1}),w()(he,pe.default.Bookmark,{component:function(e){return Object(y.default)(Ae.a,e)},offlineClose:!0}),w()(he,pe.default.CopyLink,{component:function(e){return Object(y.default)(Se.a,e)},offlineClose:!1}),w()(he,pe.default.SwitchWebMode,{component:function(e){return Object(y.default)(ge.a,e)},offlineClose:!0}),w()(he,pe.default.MissingFont,{component:function(e){return Object(y.default)(Pe.a,e)},offlineClose:!1}),he),be=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={type:null,data:null},n.handleShowAlert=n.handleShowAlert.bind(n),n.handleShowToast=n.handleShowToast.bind(n),n.handleCancel=n.handleCancel.bind(n),n.handleOk=n.handleOk.bind(n),n}return E()(t,e),c()(t,[{key:"componentWillReceiveProps",value:function(e){if(!e.connected&&this.props.connected){var t=this.state.type;t&&De[t].offlineClose&&this.handleCancel()}}},{key:"componentDidMount",value:function(){window.addEventListener(I.default.pcDialogs.WPS_SHOW_ALERT,this.handleShowAlert)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(I.default.pcDialogs.WPS_SHOW_ALERT,this.handleShowAlert)}},{key:"handleCancel",value:function(){var e=this.state.data.onCancel;e&&"function"==typeof e&&e(),this.setState({type:null,data:null})}},{key:"handleOk",value:function(){var e=this.state.data.onOk;e&&"function"==typeof e&&e(),this.setState({type:null,data:null})}},{key:"handleShowAlert",value:function(e){var t=e.detail,n=t.type,i=t.data;!this.props.connected&&pe.default[n].offlineClose||this.setState({type:n,data:i||{}})}},{key:"handleShowToast",value:function(e){var t=e.detail,n=t.type,i=t.msg,o=e.detail,a=o.getContainer,r=o.duration,s=o.top;a=null===a?void 0:a,r=null===r?void 0:r,s=null===s?void 0:s,window.Toast[n](i,a,r,s)}},{key:"render",value:function(){var e=this.state,t=e.type,n=e.data;if(!t)return!1;var i=this.props.dispatch,o=Object.assign({},n);return o.onOk=this.handleOk,o.onCancel=this.handleCancel,o.dispatch=i,f.a.createElement(De[t].component,o,!1)}}]),t}(h.PureComponent),Me=n(11762),Le=n.n(Me),ye=n(600),ke=n(3353),He=n.n(ke),Be=n(2939),Ge=n(7172),We=n.n(Ge),Fe=n(11763),Ve=n.n(Fe),Ue=n(244),xe=n.n(Ue),je=n(248),Ke=n(11764),Ye=n.n(Ke),Xe=n(11765),Je=n.n(Xe),ze=n(11766),Ze=n.n(ze),qe=n(11767),Qe=n.n(qe),$e=n(11768),et=n.n($e),tt=n(7796),nt=n(11769),it=n.n(nt),ot=n(11770),at=n.n(ot),rt=(n(11771),function(e){function t(e){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return E()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.pos,n=e.bound,i=e.isShow,o=e.isHeader;if(!i)return f.a.createElement("div",{className:"doc-header-footer-hit-tip hide"});var a=t.x,r=t.y,s=o?_i18n("applications.writer.components.UilDom.pc.editHeader", "Double click to edit the header"):_i18n("applications.writer.components.UilDom.pc.editFooter", "Double click to edit the footer"),l={left:a+8+"px",top:(r+8+8>n.y?n-8:r+8)+"px"};return f.a.createElement("div",{className:"doc-header-footer-hit-tip",style:l},s)}}]),t}(h.PureComponent)),st=n(11772),lt=n.n(st),ct=n(11773),ut=n.n(ct),dt=n(11774),_t=n.n(dt),Et=n(11775),ht=n.n(Et),ft=n(11776),Ot=n.n(ft),pt=n(11777),mt=n.n(pt),Nt=n(11778),vt=n.n(Nt),Ct=n(11779),Tt=n.n(Ct),At=n(11780),It=n.n(At),St=new(function(){function e(){s()(this,e)}return c()(e,[{key:"HeaderFooterHitTip",value:function(e){return f.a.createElement(rt,e)}},{key:"WaterDropPointerWrapper",value:function(e){return Object(y.default)(It.a,a()({},e))}},{key:"PageNumTip",value:function(e){var t=a()({},e,{type:"page-tip"});return Object(y.default)(Ye.a,a()({},t))}},{key:"CoopSelTip",value:function(e){var t=a()({},e,{type:"coop-sel",placement:tt.a.bottomLeft});return Object(y.default)(Ye.a,a()({},t))}},{key:"TableFloatMenus",value:function(e){return Object(y.default)(Je.a,a()({},e))}},{key:"SelectivePasteFloatMenu",value:function(e){return Object(y.default)(Ze.a,a()({},e))}},{key:"ContentBlockFloatMenus",value:function(e){return Object(y.default)(ht.a,a()({},e))}},{key:"DOCContentControllerProperty",value:function(e){return Object(y.default)(Ot.a,a()({},e))}},{key:"DOCDroplistControllerProperty",value:function(e){return Object(y.default)(mt.a,a()({},e))}},{key:"clearAllControllerDialog",value:function(){this.ReactDom.unmountComponentAtNode(window.APP.workspace.formatContentProperty._element)}},{key:"CommentsTip",value:function(e){return Object(y.default)(Qe.a,a()({},e))}},{key:"RevisionComment",value:function(e){return Object(y.default)(et.a,a()({},e))}},{key:"DateTimeConfig",value:function(e){return Object(y.default)(it.a,a()({},e))}},{key:"CatalogFloatMenus",value:function(e){return Object(y.default)(at.a,a()({},e))}},{key:"DrawingResizer",value:function(e){return Object(y.default)(lt.a,a()({},e))}},{key:"DrawingPreviewer",value:function(e){return Object(y.default)(ut.a,a()({},e))}},{key:"DrawingAdjustHandler",value:function(e){return Object(y.default)(_t.a,a()({},e))}},{key:"Icon",value:function(e){return f.a.createElement(je.default,e)}},{key:"DOCShapeChangeBtn",value:function(e){return Object(y.default)(vt.a,a()({},e))}},{key:"FileName",value:function(e){return Object(y.default)(Tt.a,a()({},e))}},{key:"React",get:function(){return f.a}},{key:"ReactDom",get:function(){return xe.a}},{key:"IconTypes",get:function(){return je.default.types}}]),e}()),wt=n(2698),gt=n(8212),Rt=n(10060),Pt=n(144),Dt=n.n(Pt),bt=n(11781),Mt=n.n(bt),Lt=n(560),yt=n.n(Lt);function kt(e){var t=e.connected,n=(e.templateType,e.readOnly),i=!1,o=!1;try{i=window.APP.data.selection.selContext.isInHeaderFooter,o=window.APP.restrictEditHandler&&window.APP.restrictEditHandler.isInReadonlyProtectMode}catch(e){}var a=Object(h.useState)(0),r=Dt()(a,2)[1];return yt()(Lt.DOCCustomEvents.names.DOC_SELECTION_CHANGED,(function(){r(Date.now())})),i&&!n&&!o?Object(y.default)(Mt.a,{connected:t}):null}kt.propTypes={connected:R.a.bool.isRequired};var Ht=kt,Bt=n(10038),Gt=n(11782),Wt=n.n(Gt);function Ft(e){var t=e.available,n=Object(h.useState)([]),i=Dt()(n,2),o=i[0],a=i[1],r=Object(h.useState)(!1),s=Dt()(r,2),l=s[0],c=s[1],u=Object(h.useState)(!1),d=Dt()(u,2),_=d[0],E=d[1];return Object(h.useEffect)((function(){function e(e){t&&(c(!0),a(_?[]:function(t){return t.push(e),t}))}return _||window.addEventListener(I.default.cooperation.ON_CONVENE_LIST_UPDATE,e),function(){_||window.removeEventListener(I.default.cooperation.ON_CONVENE_LIST_UPDATE,e)}}),[_,t]),t&&l?Object(y.default)(Wt.a,{initialEvents:o,handleLoaded:function(){return E(!0)}}):null}Ft.propTypes={available:R.a.bool.isRequired};var Vt=n(11783),Ut=n.n(Vt),xt=n(11784),jt=n.n(xt),Kt=n(11785),Yt=n.n(Kt),Xt=n(4520),Jt=function(e){return{type:Xt.a.RESTRICT_EDIT_MODE,data:{inRestrictEditMode:e}}},zt=n(8215),Zt=function(){function e(){var t=this;if(s()(this,e),this.commentsToolBtnReady=this.commentsToolBtnReady.bind(this),this.rcHandlerReady=this.rcHandlerReady.bind(this),this.bindEvent(),T.isIE||T.isWpsClient&&T.isWindows){this.status={_fileopen:!1,_toolbtn:!1,_handler:!1,_manager:!1};var n=function(e){var n=e.substring(1);Object.defineProperty(t.status,n,{set:function(i){if(void 0!==t.status[n]){t.status[e]=i;var o=!1;for(var a in t.status)t.status[a]||(o=!0);!o&&t.start(),Object(A.hasQuery)("version")&&t.status.fileopen&&t.status.handler&&t.status.manager&&t.start()}},get:function(){return t.status[e]},enumerable:!0,configurable:!0})};for(var i in this.status)n(i)}else this.status=new Proxy({fileopen:!1,toolbtn:!1,handler:!1,manager:!1},{set:function(e,n,i){if(void 0!==e[n]){e[n]=i;var o=!1;for(var a in e)e[a]||(o=!0);return!o&&t.start(),Object(A.hasQuery)("version")&&e.fileopen&&e.handler&&e.manager&&t.start(),!0}}})}return c()(e,[{key:"bindEvent",value:function(){window.addEventListener(I.default.comments.COMMENTS_LOADED,this.commentsToolBtnReady),window.addEventListener(I.default.comments.RCHANDLER_LOADED,this.rcHandlerReady)}},{key:"unBindEvent",value:function(){window.removeEventListener(I.default.comments.COMMENTS_LOADED,this.commentsToolBtnReady),window.removeEventListener(I.default.comments.RCHANDLER_LOADED,this.rcHandlerReady)}},{key:"setStatus",value:function(e,t){this.status&&(this.status[e]=t)}},{key:"commentsToolBtnReady",value:function(){this.setStatus("toolbtn",!0)}},{key:"rcHandlerReady",value:function(){this.setStatus("handler",!0)}},{key:"start",value:function(){this.app=window.APP;var e=this.app.data.doc.getDocInfo();(this.app.getLinkName()&&this.app.handleBookmark(e),this.app.workspace.revisionComment.trackChange(),this.notVisible||e.woTemplate&&!this.app.isWebMode())?this.app.appApi.showComments({checked:!1,stored:!0,isTemplate:e.woTemplate}):(this.app.workspace.createRevisionComment(),this.app.appApi.getCommentShowStatus().commentPanel||this.app.appApi.showComments({checked:!0,stored:!1}))}},{key:"notVisible",get:function(){return"0"===window.sessionStorage.getItem("commentsVisible")}}]),e}(),qt=n(11786),Qt=n.n(qt),$t=n(10263);var en=f.a.memo((function(e){return e.visible?f.a.createElement($t.a.Provider,{value:e},f.a.createElement("div",{className:"page-plugins"},Object(y.default)(Qt.a,{connected:e.connected}))):null})),tn=n(8216),nn=n.n(tn),on=n(11787),an=n.n(on),rn=n(8217),sn=n(11788),ln=n.n(sn),cn=n(11789),un=n.n(cn),dn=n(11790),_n=n.n(dn),En=n(11791),hn=n.n(En),fn=n(8219),On=n.n(fn),pn=n(11792),mn=n.n(pn),Nn=(n(1805),n(11793)),vn=n.n(Nn),Cn=n(11794),Tn=n.n(Cn),An=n(1146),In=(n(11795),n(8220),n(11796),n(1327),n(961),n(3368),n(4509),n(4903)),Sn=n.n(In);document.documentElement.setAttribute("data-theme","wps");var wn=T.isIEPure,gn=window.__WPSPLUGIN__.type,Rn=window.__WPSPLUGIN__.helper.has(gn.GroupTlibrary);window.Notice=Sn.a;var Pn=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Dn.call(n),window.utils={Lodash:ye},n.handleFilePassword=n.handleFilePassword.bind(n),n.handleOffline=n.handleOffline.bind(n),n.openFile=n.openFile.bind(n),n.handleScrollBarClick=n.handleScrollBarClick.bind(n),n.handleWorkspaceScroll=window.utils.Lodash.throttle(n.handleWorkspaceScroll.bind(n),200),n.handleRestrictEditStateChange=n.handleRestrictEditStateChange.bind(n),n.handleToggleTaskPane=n.handleToggleTaskPane.bind(n),n.revisionDataEnd=n.revisionDataEnd.bind(n),n.handleSelectionChange=window.utils.Lodash.throttle(n.handleSelectionChange,150).bind(n),n.changeHorizontalScroll=n.changeHorizontalScroll.bind(n),n.handleToggleGuidePane=n.handleToggleGuidePane.bind(n),n.handleOnCreateWebViewOutDiv=n.handleOnCreateWebViewOutDiv.bind(n),n.handleBeforeOpen=n.handleBeforeOpen.bind(n),n.handleAfterInit=n.handleAfterInit.bind(n),n.handleAfterOpen=n.handleAfterOpen.bind(n),n.beforeViewModeChanged=n.beforeViewModeChanged.bind(n),n.afterViewModeChanged=n.afterViewModeChanged.bind(n),n.handleOfdDialog=n.handleOfdDialog.bind(n),n.actions=Object(p.bindActionCreators)(i,e.dispatch),n}return E()(t,e),c()(t,[{key:"bindEvent",value:function(){window.addEventListener(v.default.names.network.ON_FILE_PASSWORD_ERROR,this.handleFilePassword),window.addEventListener(I.default.scroll.FREE_SCROLL_BAR_STYLE,this.handleScrollBarStyle),Object(wt.b)()||(window.addEventListener(v.default.names.network.ON_CONNECTED,this.handleConnected),window.addEventListener(v.default.names.network.ON_RPC_OFFLINE,this.handleOffline),window.addEventListener(v.default.names.network.UPDATE_NEW_VERSION,this.handleStoreGcp),window.addEventListener(v.default.names.file.ON_EXPORT_OFD,this.handleOfdDialog),window.addEventListener(I.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,this.handleRestrictEditStateChange),window.addEventListener(I.default.names.DOC_SELECTION_CHANGED,this.handleSelectionChange),window.addEventListener(I.default.names.DOC_WORKSPACE_SHOULD_HORIZONTAL_SCROLL,this.changeHorizontalScroll),window.addEventListener(I.default.revision.REVISION_DATA_END,this.revisionDataEnd),window.addEventListener(I.default.webMode.ON_UPDATE_OUTDIV,this.handleOnCreateWebViewOutDiv),window.addEventListener(I.default.webMode.ON_FILENAME_SWITCH,this.handleWebModeFilenameSwitched),window.addEventListener(I.default.document.ON_DOC_BEFORE_OPEN,this.handleBeforeOpen),window.addEventListener(I.default.document.ON_DOC_AFTER_INIT,this.handleAfterInit),window.addEventListener(I.default.document.ON_DOC_AFTER_OPEN,this.handleAfterOpen),window.addEventListener(I.default.view.BEFORE_VIEW_MODE_CHANGED,this.beforeViewModeChanged),window.addEventListener(I.default.view.AFTER_VIEW_MODE_CHANGED,this.afterViewModeChanged),window.addEventListener(I.default.names.DOC_INIT_IMAGE_END,this.initImageEnd),window.addEventListener(I.default.names.ON_CORE_ERROR,this.handleCoreError),this.workspaceDom.addEventListener("mousedown",this.handleScrollBarClick),this.workspaceDom.addEventListener("mouseup",this.handleScrollBarClick),this.workspaceDom.addEventListener("scroll",this.handleWorkspaceScroll),An.CommentAudit.subscribes())}},{key:"unBindEvent",value:function(){window.removeEventListener(v.default.names.network.ON_FILE_PASSWORD_ERROR,this.handleFilePassword),window.removeEventListener(I.default.scroll.FREE_SCROLL_BAR_STYLE,this.handleScrollBarStyle),Object(wt.b)()||(window.removeEventListener(v.default.names.network.ON_CONNECTED,this.handleConnected),window.removeEventListener(v.default.names.network.ON_RPC_OFFLINE,this.handleOffline),window.removeEventListener(v.default.names.network.UPDATE_NEW_VERSION,this.handleStoreGcp),window.removeEventListener(v.default.names.file.ON_EXPORT_OFD,this.handleOfdDialog),window.removeEventListener(I.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,this.handleRestrictEditStateChange),window.removeEventListener(I.default.names.DOC_SELECTION_CHANGED,this.handleSelectionChange),window.removeEventListener(I.default.names.DOC_WORKSPACE_SHOULD_HORIZONTAL_SCROLL,this.changeHorizontalScroll),window.removeEventListener(I.default.revision.REVISION_DATA_END,this.revisionDataEnd),window.removeEventListener(I.default.webMode.ON_UPDATE_OUTDIV,this.handleOnCreateWebViewOutDiv),window.removeEventListener(I.default.webMode.ON_FILENAME_SWITCH,this.handleWebModeFilenameSwitched),window.removeEventListener(I.default.document.ON_DOC_BEFORE_OPEN,this.handleBeforeOpen),window.removeEventListener(I.default.document.ON_DOC_AFTER_INIT,this.handleAfterInit),window.removeEventListener(I.default.document.ON_DOC_AFTER_OPEN,this.handleAfterOpen),window.removeEventListener(I.default.view.BEFORE_VIEW_MODE_CHANGED,this.beforeViewModeChanged),window.removeEventListener(I.default.view.AFTER_VIEW_MODE_CHANGED,this.afterViewModeChanged),window.removeEventListener(I.default.names.DOC_INIT_IMAGE_END,this.initImageEnd),window.removeEventListener(I.default.names.ON_CORE_ERROR,this.handleCoreError),this.workspaceDom.removeEventListener("mouseup",this.handleScrollBarClick),this.workspaceDom.removeEventListener("mousedown",this.handleScrollBarClick),this.workspaceDom.removeEventListener("scroll",this.handleWorkspaceScroll),An.CommentAudit.unsubscribes())}},{key:"componentDidMount",value:function(){this.bindEvent(),Object(wt.b)()?(this.openFile(),document.body.removeAttribute("oncontextmenu"),window.addEventListener("contextmenu",(function(e){e.stopPropagation()}),{capture:!0}),document.body.classList.add("wps-preview")):(this.initDocRc(),this.initCoopInfo(),this.openFile())}},{key:"initDocRc",value:function(){this.docRcStart=new Zt}},{key:"openFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.setState({hasPassword:!!n||!!i});var o=this.props.dispatch,a=this.props.public,r=a.user,s=a.file,l=this.props.match.params.fileid,c=function(a,c){a.docRcStart=t.docRcStart,a.frontUtil=St,a.fileId=l,a.dispatch=o,a.isPreview=Object(wt.b)(),a.setWatermark(window.__WPSENV__.watermark),a.load(l,(function(){var e=a.isWebMode(),n=!1!==a.data.doc.docInfo.woTemplateFileNameVisible;o(zt.b(e)),o(zt.a(n)),a.setWatermark(s.watermark),a.isNewDoc=C.checkIsNew(s),r&&r.id&&a.loadInfo({userid:r.id,username:r.name,avatar:r.avatar}),t.setState({filePasswordType:null}),c();var i={modeinfo:"webmode_"+(e?"on":"off"),fileid:window.fileInfo?window.fileInfo.id:"unknown",new:a.isNewDoc?"webNew":"others"};a.isReadOnly()||(i.titleinfo="title_"+(n?"on":"off")),window.collection("webmodeinfo",i);var l={fileid:window.fileInfo?window.fileInfo.id:"unknown",tableCount:a.data.doc.docInfo.tableCount};window.collection("docTableInfo",l)}),e,n,i)};return new Promise((function(e){t.app?c(t.app,e):We()((function(n){t.app=n.createApp(),c(t.app,e)}))})).then((function(){if(!t.app.isPreview){var e={commentsDataManager:new Bt.a(l,t.props.dispatch,t.app),dispatch:t.props.dispatch,updateCommentsDataManager:function(e){e.servicesLoader.commentsDataManager.clearAll(),e.servicesLoader.commentsDataManager=e.commentsDataManager=new Bt.a(l,this.dispatch,e)}};t.app.setServicesLoader(e),t.docRcStart.setStatus("manager",!0)}})).then((function(){v.default.dispatchEvent(v.default.names.ON_UIL_FINISH)}))}},{key:"componentWillUnmount",value:function(){this.app.frontUtil&&this.app.frontUtil.clearAllControllerDialog(),this.unBindEvent()}},{key:"componentWillReceiveProps",value:function(e){var t=e.public.network.openSuccess;if(t&&t!==this.props.public.network.openSuccess){var n=this.app.data.doc.getReadOnly()||!this.app.canEdit(),i=this.app.data.doc.templateType,o=this.app.data.doc.templateIndex,a=this.app.data.doc.templateVersion,r=this.app.data.doc.isTemplate,s=this.app.data.doc.isEnhancedTemplate;this.setState({contentReadonly:n,isTemplate:r,isEnhancedTemplate:s,templateType:i,templateIndex:o,templateVersion:a})}if(this.app){var l=e.public.user,c=l.id,u=l.name,d=l.avatar,_=e.public.file.user_acl;if(this.app.userAclUpdate=_.update,c&&this.app.loadInfo({userid:c,username:u,avatar:d}),this.props&&this.props.public.file.name!==e.public.file.name&&this.app.isWebMode()&&this.app.workspace.canvasHandler){var E=this.app.workspace.canvasHandler.getFilenameContainerInfo(),h=E.width,f=E.height,O=E.container;O&&this.app.frontUtil.ReactDom.render(this.app.frontUtil.FileName({containerWidth:h,containerHeight:f,docInfo:this.app.data.doc.docInfo,file:e.public.file,dispatch:this.props.dispatch}),O)}}this.initCoopInfo()}},{key:"handleSelectionChange",value:function(e){var t=e.detail.selectionInfo,n=void 0===t?{}:t,i=n.isAllowFormatWithControl,o=n.isAllowInsertBookmarkWithControl,a=n.isInReadonlyDocumentField,r=n.isOutOfEditableArea,s=window.APP.data.selection.selContext.isInComment();this.setState({isAllowFormatWithControl:i,isAllowInsertBookmarkWithControl:o,isInReadonlyDocumentField:a,isOutOfEditableArea:r,isInComment:s})}},{key:"initCoopInfo",value:function(){var e=this.props.match.params.fileid,t=this.props.public.file.user_acl;Be.a.init(a()({},v.default.names.cooper,I.default.names,I.default.cooperation,{dispatchEvent:v.default.dispatchEvent}),e,t,this.props.dispatch)}},{key:"handleToggleTaskPane",value:function(e){this.setState({taskPaneOpen:e})}},{key:"handleToggleGuidePane",value:function(e){this.setState({guidePaneOpen:e})}},{key:"handleWorkspaceScroll",value:function(e){e.target===this.workspaceDom&&(this.workspaceDom.cacheDOMAttr.scrollTop>0?this.setState({scroll:!0}):this.setState({scroll:!1})),this._clickScrollBarStart&&(this._hasScrolledByScrollBar=!0)}},{key:"changeHorizontalScroll",value:function(e){var t=e.detail.isHorizontalScroll;this.setState({isHorizontalScroll:t})}},{key:"handleScrollBarClick",value:function(e){var t=this.workspaceDom.getBoundingClientRect().right;if(window.APP&&window.APP.workspace&&!(window.APP.workspace.container.cacheDOMAttr.clientHeight<=this.workspaceDom.cacheDOMAttr.clientHeight)){if("mousedown"===e.type){if(!(e.x>=t-17&&e.x<=t))return;this._clickScrollBarStart=!0,this._clickScrollBarStartTime=Date.now(),this._hasScrolledByScrollBar=!1}"mouseup"===e.type&&this._clickScrollBarStart&&(this._hasScrolledByScrollBar?Date.now()-this._clickScrollBarStartTime>300?window.collection("scrollbar","action","drag"):window.collection("scrollbar","action","click_scroll"):window.collection("scrollbar","action","click"),this._clickScrollBarStart=!1)}}},{key:"handleFilePassword",value:function(e){this.setState({filePasswordType:e.detail.type})}},{key:"handleRestrictEditStateChange",value:function(e){var t=e.detail.isRestrict;this.setState({inRestrictEditMode:t}),this.actions.switchRestrictEditMode(t)}},{key:"handleConnected",value:function(){window.APP.workspace&&window.APP.workspace.hideToast()}},{key:"handleOffline",value:function(){window.APP.workspace&&"CONNECTED"!=window.RPCClient.getState()&&window.fileInfo&&!window.fileInfo.isDelete&&window.APP.workspace.showToast("warn",Object(gt.getDisconnectedToastMessage)(),null,0)}},{key:"handleStoreGcp",value:function(){window.APP.workspace.allowRestoreGcp()}},{key:"beforeViewModeChanged",value:function(){this.setState({viewChanging:!0})}},{key:"afterViewModeChanged",value:function(){this.setState({viewChanging:!1})}},{key:"handleBeforeOpen",value:function(){window.APP&&window.APP.workspace&&window.APP.workspace&&window.APP.workspace.storeGcp(),this.setState({initializing:!0,opening:!0})}},{key:"handleAfterInit",value:function(){this.setState({initializing:!1})}},{key:"handleAfterOpen",value:function(){this.setState({opening:!1})}},{key:"revisionDataEnd",value:function(e){var t=e.detail,n=t.isShowRevisionPaginator,i=t.data,o=t.compareVersion;this.setState({isShowRevisionPaginator:n,modifyData:i,compareVersion:o},(function(){I.default.dispatchEvent(I.default.revision.ON_HISTORY_REVISION_TOOL_SHOW,{visible:n})}))}},{key:"handleOnCreateWebViewOutDiv",value:function(e){this.switchWebModeFilename(e.detail,!0)}},{key:"handleOfdDialog",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({isShowOfd:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.filePasswordType,i=t.contentReadonly,o=t.isTemplate,a=t.isEnhancedTemplate,r=t.templateType,s=t.templateIndex,l=t.hasPassword,c=t.scroll,u=t.taskPaneOpen,d=t.templateVersion,_=t.inRestrictEditMode,E=t.isAllowFormatWithControl,h=void 0===E||E,O=t.isAllowInsertBookmarkWithControl,p=void 0===O||O,m=t.isHorizontalScroll,v=t.guidePaneOpen,C=t.isShowRevisionPaginator,I=t.modifyData,S=t.compareVersion,w=t.initializing,g=t.opening,R=t.viewChanging,P=t.isInReadonlyDocumentField,D=t.isOutOfEditableArea,b=t.isInComment,M=t.isShowOfd,L=t.isInitImageEnd,k=t.isCoreError,H=t.isShowTemplateModel,B=t.scrollBarStyle,G=this.props,W=G.dispatch,F=G.writer,V=this.props.public,U=V.user,x=V.file,j=V.network.openSuccess,K=!Object(A.hasQuery)("version")&&!Object(A.hasQuery)("hidecmb"),Y=i||!x.user_acl.update,X=this.props.public.network.connected,J={"--bgColor":B.bgColor,"--hoverBgColor":B.hoverBgColor,"--borderRadius":B.borderRadius,"--scrollbarTrackWidth":B.scrollbarTrackWidth},z=K&&j||Object(A.hasQuery)("version")&&!Object(A.hasQuery)("simple"),Z=K&&j&&!Y&&a,q=!Object(A.hasQuery)("version")&&(j||!w),Q=F&&F.docmap.show,$=Object(A.hasQuery)("version")&&!Object(A.hasQuery)("simple"),ee=Object(wt.b)();return ee?f.a.createElement("div",{className:"xc-preview-container",style:J},!!this.state.filePasswordType&&Object(y.default)(He.a,{type:this.state.filePasswordType,file:this.props.public.file,submit:this.openFile}),f.a.createElement("div",{className:"preview-page-container"},f.a.createElement("div",{className:"pages-list",tabIndex:"-1"})),j&&Object(y.default)(Le.a,{openSuccess:j,connected:X,readOnly:Y,dispatch:W,app:this.app,fileInfo:x,user:U}),j&&Object(y.default)(hn.a,{connected:X,dispatch:W,isPreview:ee}),f.a.createElement(be,{connected:X,dispatch:W})):f.a.createElement("div",{className:"edit-area",style:J},window.__CONFIG__.wps.isShowDocMap&&!g&&j&&!R&&Object(y.default)(Ut.a,{readOnly:Y,loadCMB:K,taskPaneOpen:u,isHorizontalScroll:m}),!Object(A.hasQuery)("simple")&&f.a.createElement(Oe,{readOnly:Y,showCommandBars:K,hasPassword:l,isWriteGuide:Z,showTaskPane:z,openSuccess:j,handleToggleTaskPane:this.handleToggleTaskPane,inRestrictEditMode:_,isAllowFormatWithControl:h,isAllowInsertBookmarkWithControl:p,isOutOfEditableArea:D,isInComment:b}),Z&&Object(y.default)(jt.a,{showCommandBars:K,connected:X,templateType:r,templateIndex:s,templateVersion:d,handleToggleTaskPane:this.handleToggleTaskPane,handleToggleGuidePane:this.handleToggleGuidePane}),f.a.createElement(be,{connected:X,dispatch:W}),q&&Object(y.default)(Ve.a,{dispatch:W,readOnly:Y,isTemplate:o,scroll:c,taskPaneOpen:u,inRestrictEditMode:_,isAllowFormatWithControl:h,visible:K}),C&&Object(y.default)(Yt.a,{data:I,compareVersion:S,dispatch:W}),f.a.createElement(Ft,{available:!Y&&!Z}),f.a.createElement("div",{className:N()("wps-wrap",{"show-cmd-bar":K,"is-history":$,"show-doc-map":Q,"show-task-pane":u&&!n,"show-guide-pane":v&&!n,"show-status-bar":window.__CONFIG__.wps.isShowBottomStatusBar})},f.a.createElement("div",{id:"workspace",ref:function(t){return e.workspaceDom=t},className:N()({"show-paginator":C,"is-horizontal-scroll":m,"is-IE":wn})},!!n&&Object(y.default)(He.a,{type:n,file:x,submit:this.openFile}),f.a.createElement(Rt.a,{connected:X}),f.a.createElement("div",{className:"dom-container"},f.a.createElement("div",{className:"no-scale-container no-scale"},f.a.createElement("div",{className:"components-container index-level-1"},f.a.createElement(rn.a,{openSuccess:j,viewChanging:R}))),f.a.createElement("div",{className:"scale-container scale"},f.a.createElement("div",{className:"components-container index-level-1"}),f.a.createElement("div",{className:"components-container index-level-2"},!g&&Object(y.default)(ln.a,{connected:X,inRestrictEditMode:_}),!g&&f.a.createElement(f.a.Fragment,null,f.a.createElement(Ht,{connected:X,readOnly:Y}),Object(y.default)(nn.a,{connected:X}),f.a.createElement(en,{visible:j,connected:X,readOnly:Y,inRestrictEditMode:_,isAllowFormatWithControl:h,isShowDocMap:Q,isInReadonlyDocumentField:P}),!Y&&Object(y.default)(un.a,{})))),f.a.createElement("div",{className:"no-scale-container"},f.a.createElement("div",{className:"permanent-container cursor-container index-level-1"})),f.a.createElement("div",{className:"scale-container"})),f.a.createElement("div",{className:"uil-monitor-tier"},f.a.createElement("div",{className:"page-container "+(T.isMacOs?" is-mac":"")})),f.a.createElement("div",{className:"page-outside-container"},j&&Object(y.default)(On.a),j&&T.isPad&&Object(y.default)(mn.a)),j&&Rn&&Object(y.default)(Tn.a,{isShowTemplateModel:H,onChangeTemplateVisible:this.handleChangeTemplateVisible})),j&&Object(y.default)(Le.a,{openSuccess:j,connected:X,readOnly:Y,dispatch:W,app:this.app,fileInfo:x,user:U})),j&&Object(y.default)(_n.a,{file:x,connected:X,user:U,readOnly:Y,inRestrictEditMode:_,isAllowFormatWithControl:h,isInitImageEnd:L,isCoreError:k,dispatch:W}),j&&M&&Object(y.default)(an.a,{connected:X,dispatch:W,cancel:function(){return e.handleOfdDialog(!1)}}),j&&Rn&&Object(y.default)(vn.a,{isShowTemplateModel:H,onChangeTemplateVisible:this.handleChangeTemplateVisible}))}}]),t}(h.PureComponent),Dn=function(){var e=this;this.state={officeType:C.getPageOfficeType(),filePasswordType:null,contentReadonly:!1,hasPassword:!1,inRestrictEditMode:void 0,taskPaneOpen:!1,scroll:!1,isTemplate:!1,isEnhancedTemplate:!1,isInitImageEnd:!1,isAllowFormatWithControl:!0,isAllowInsertBookmarkWithControl:!0,isHorizontalScroll:!1,guidePaneOpen:!1,isShowRevisionPaginator:!1,modifyData:null,compareVersion:null,initializing:!0,opening:!0,isShowOfd:!1,isCoreError:!1,isShowTemplateModel:!1,scrollBarStyle:{bgColor:"#C0C6CF",hoverBgColor:"#9298A2",borderRadius:"8px",scrollbarTrackWidth:"14px"}},this.handleCoreError=function(){e.setState({isCoreError:!0})},this.initImageEnd=function(){e.setState({isInitImageEnd:!0})},this.switchWebModeFilename=function(t,n){var i=t.containerDiv,o=t.containerHeight,a=t.containerWidth,r=t.docInfo,s=r.woTemplateFileNameVisible;if(!n||!1!==s){var l=e.props.dispatch,c={file:e.props.public.file,dispatch:l,containerHeight:o,containerWidth:a,docInfo:r};l(zt.a(!1!==s)),e.app.frontUtil.ReactDom.render(e.app.frontUtil.FileName(c),i)}},this.handleWebModeFilenameSwitched=function(t){e.switchWebModeFilename(t.detail,!1)},this.handleChangeTemplateVisible=function(t){e.setState({isShowTemplateModel:t})},this.handleScrollBarStyle=function(t){var n=e.state.scrollBarStyle,i=t.detail,o=i.BackgroundColor,a=i.HoverBackgroundColor,r=i.ScrollBarWidth,s=i.BorderRadius,l="number"==typeof r?r+8+"px":n.scrollbarTrackWidth,c="number"==typeof s?s+"px":n.borderRadius;e.setState({scrollBarStyle:{borderRadius:c,scrollbarTrackWidth:l,bgColor:o||n.bgColor,hoverBgColor:a||n.hoverBgColor}})}};t.default=Object(O.connect)((function(e){return e}))(Pn)},1805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrivileges=t.privileges=void 0,t.privileges={font_founder_official:!1};var i=null;function o(){var e=window.__WPSENV__;if(window.__CONFIG__.wps.isOfficialFounderFont)return t.privileges.font_founder_official=!0,Promise.resolve(t.privileges);try{var n=e.user_id;if(n&&("-1"===n||n.startsWith("fake")))throw new Error("not login");if(!window.fileInfo||!window.fileInfo.id)throw new Error("no file info")}catch(e){return Promise.reject(e)}return i||((i=e.request({method:"POST",url:"/api/v3/office/file/".concat(window.fileInfo.id,"/privilege_list"),responseType:"json",body:JSON.stringify({privilege_names:["font_founder_official"]})}).end().then((function(e){if(200===e.status){var n=e.body.privileges.font_founder_official;if(n)n.expire_at>0&&1e3*n.expire_at<Date.now()||(t.privileges.font_founder_official=!0);return t.privileges}throw new Error("unknown response status")})).catch((function(e){throw i=null,e})))||Promise.reject("parse response error"))}t.getPrivileges=o,o().catch(Function.prototype)},2183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.auditCommentList=t.commentReviewAsync=t.delEmoji=t.addEmoji=void 0;var i=n(5).__importStar(n(146));t.addEmoji=function(e){return{types:i.HTTP_TYPES,autoErrorToast:!1,callAPI:function(t){return t.post("/api/v3/office/file/".concat(window.urlFileId,"/comment/emoji")).send(e).end()}}};var o;t.delEmoji=function(e){return{types:i.HTTP_TYPES,autoErrorToast:!1,callAPI:function(t){return t.del("/api/v3/office/file/".concat(window.urlFileId,"/comment/emoji")).send(e).end()}}},function(e){e.TEXT="text",e.VOICE="voice"}(o||(o={}));t.commentReviewAsync=function(e){var t=window.fileInfo.id,n={};return Object.keys(e).forEach((function(t){e[t]&&(n[t]=e[t])})),n.type||(n.type=o.TEXT),{types:i.HTTP_TYPES,callAPI:function(e){return e.post("/api/v3/office/file/".concat(t,"/comment/async")).fields(n).end()}}};t.auditCommentList=function(e){return{types:i.HTTP_TYPES,callAPI:function(t){return t.get("/api/v3/office/file/".concat(window.urlFileId,"/comments/all")).query(e).end()}}}},258:function(e,t,n){var i;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var a=typeof i;if("string"===a||"number"===a)e.push(i);else if(Array.isArray(i)){if(i.length){var r=o.apply(null,i);r&&e.push(r)}}else if("object"===a){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var s in i)n.call(i,s)&&i[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(i=function(){return o}.apply(t,[]))||(e.exports=i)}()},260:function(e,t,n){"use strict";n.r(t),n.d(t,"guide",(function(){return a}));var i=n(227),o={ON_HEADER_TOOLBAR_STATUS_CHANGE:"ON_HEADER_TOOLBAR_STATUS_CHANGE",ON_ACTIVATE_KEYBOARD:"ON_ACTIVATE_KEYBOARD",ON_COMMAND_BARS_TAB_CHANGE:"ON_COMMAND_BARS_TAB_CHANGE",ON_HIDE_EDIT_TOOLBAR_PANEL:"ON_HIDE_EDIT_TOOLBAR_PANEL",ON_SHOW_EDIT_TOOLBAR_PANEL:"ON_SHOW_EDIT_TOOLBAR_PANEL",ON_COMMENT_TAB_SWITCH:"ON_COMMENT_TAB_SWITCH",ON_AUDIO_PERMISSION_CHANGE:"ON_AUDIO_PERMISSION_CHANGE",ON_SHOW_POPOVER_BARS:"ON_SHOW_POPOVER_BARS",ON_HIDE_POPOVER_BARS:"ON_HIDE_POPOVER_BARS",ON_SHOW_POPOVER_TOAST:"ON_SHOW_POPOVER_TOAST",ON_HIDE_POPOVER_TOAST:"ON_HIDE_POPOVER_TOAST",ON_POPOVER_VISIBILITY_CHANGED:"ON_POPOVER_VISIBILITY_CHANGED",POPOVER_BARS_EVENTS:{COPY:_i18n("applications.writer.constants.copy", "Copy"),PASTE:_i18n("applications.writer.constants.paste", "Paste"),CUT:_i18n("applications.writer.constants.cut", "Cut"),SELECT:_i18n("applications.writer.constants.select", "Select "),SELECTALL:_i18n("applications.writer.constants.selectall", "Select all"),IMAGE_COPY:_i18n("applications.writer.constants.imageCopy", "Copy"),IMAGE_SHARE:_i18n("applications.writer.constants.imageShare", "Share"),COMMENT:_i18n("applications.writer.constants.comment", "Comment"),VOICE:_i18n("applications.writer.constants.voice", "Voice"),VIEW:_i18n("applications.writer.constants.view", "View image"),DEL:_i18n("applications.writer.constants.del", "Delete"),FORMAT:_i18n("applications.writer.constants.format", "Format"),CONVENE:_i18n("applications.writer.constants.convene", "Convene"),VIEWCOMMENT:_i18n("applications.writer.constants.viewcomment", "View comments"),VIEWREVISION:_i18n("applications.writer.constants.viewrevision", "View changes"),INSERT_ROW:_i18n("applications.writer.constants.insertRow", "Insert row"),DELETE_ROW:_i18n("applications.writer.constants.deleteRow", "Del row"),INSERT_COLUMN:_i18n("applications.writer.constants.insertColumn", "Insert column"),DELETE_COLUMN:_i18n("applications.writer.constants.deleteColumn", "Del column"),DELETE_TABLE:_i18n("applications.writer.constants.deleteTable", "Delete table")},ON_IMAGE_CLICK:"ON_IMAGE_CLICK",ON_IMAGE_CLICK_VIEW:"ON_IMAGE_CLICK_VIEW",ON_IMAGE_LONG_PRESS:"ON_IMAGE_LONG_PRESS",ON_NATIVE_KEYBOARD_CLOSE:"ON_NATIVE_KEYBOARD_CLOSE",ON_IMAGE_CLICK_EDIT_MODE:"ON_IMAGE_CLICK_EDIT_MODE",ON_KEYBOARD_ACTIVE:"ON_KEYBOARD_ACTIVE",ON_KEYBOARD_INACTIVE:"ON_KEYBOARD_INACTIVE",ON_KEYBOARD_HEIGHT_UPDATED:"ON_KEYBOARD_HEIGHT_UPDATED",ON_TOGGLE_EDIT_MODE:"ON_TOGGLE_EDIT_MODE",ON_TOGGLE_READ_MODE:"ON_TOGGLE_READ_MODE",ON_INK_PANEL_VISIBLE:"ON_INK_PANEL_VISIBLE",ON_SHOW_INK_PANEL:"ON_SHOW_INK_PANEL",ON_CHANGE_INK_COLOR:"ON_CHANGE_INK_COLOR",ON_MODE_CHANGED:"ON_MODE_CHANGED",ON_READ_SETTING_CHANGED:"ON_SETTING_CHANGED",ON_SHOW_COMMENT_ENTRY:"ON_SHOW_COMMENT_ENTRY",ON_HIDE_COMMENT_ENTRY:"ON_HIDE_COMMENT_ENTRY",ON_SHOW_VOICE_COMMENT:"ON_SHOW_VOICE_COMMENT",ON_SEND_PRISE_COMMENT:"ON_SEND_PRISE_COMMENT",CHECK_CAN_SHOW_VOICE_COMMENT:"CHECK_CAN_SHOW_VOICE_COMMENT",ON_EDIT_TOOLBAR_TAB_CHANGED:"ON_EDIT_TOOLBAR_TAB_CHANGED",ON_FIND_REPLACE_BAR_CHANGED:"ON_FIND_REPLACE_BAR_CHANGED",ON_SHOW_FONT_STYLE_PANEL:"ON_SHOW_FONT_STYLE_PANEL",ON_RECORD_CARD_SCROLL_TOP:"ON_RECORD_CARD_SCROLL_TOP",ON_UPDATE_CONTAINER:"ON_UPDATE_CONTAINER",ON_SET_POSITION_ON_VISIBLE:"ON_SET_POSITION_ON_VISIBLE",ON_SCROLL_INTO_VIEW:"ON_SCROLL_INTO_VIEW",ON_WINDOW_HIDDEN:"ON_WINDOW_HIDDEN",ON_WORKSPACE_CLICK_IN_READING_MOD:"ON_WORKSPACE_CLICK_IN_READING_MOD",ON_SWIPE_IN_READ_MODE:"ON_SWIPE_IN_READ_MODE",ON_PINCHING_TO_ZOOM_IN_READ_MODE:"ON_PINCHING_TO_ZOOM_IN_READ_MODE",ON_SHOW_DIALOG:"ON_SHOW_DIALOG",ON_CLOSE_DIALOG:"ON_CLOSE_DIALOG",ON_HYPERLINK_CLICK:"ON_HYPERLINK_CLICK",ON_WEBSHAPE_CLICK:"ON_WEBSHAPE_CLICK",ON_HYPERLINK_JUMP:"ON_HYPERLINK_JUMP",ON_HYPERLINK_COPY:"ON_HYPERLINK_COPY",ON_HYPERLINK_CANCEL:"ON_HYPERLINK_CANCEL",ON_HYPERLINK_TO_WEBSHAPE:"ON_HYPERLINK_TO_WEBSHAPE",ON_WEBSHAPE_TO_HYPERLINK:"ON_WEBSHAPE_TO_HYPERLINK",ON_OPEN_HYPERLINK_EDITOR:"ON_OPEN_HYPERLINK_EDITOR",SHOW_HYPERLINK_EDITOR_PANEL:"SHOW_HYPERLINK_EDITOR_PANEL",ON_TEXT_ENCODING_PANEL_VISIBLE_CHANGE:"ON_TEXT_ENCODING_PANEL_VISIBLE_CHANGE",ON_SHOW_RC_RECORD_CARD:"ON_SHOW_RC_RECORD_CARD",ON_SHOW_APPOINT_CARD:"ON_SHOW_APPOINT_CARD",ON_SHOW_RC_RECORD_LIST:"ON_SHOW_RC_RECORD_LIST",ON_RECORD_CARD_CHANGE:"ON_RECORD_CARD_CHANGE",RC_DATA_CHANGE:"RC_DATA_CHANGE",REVISION_INDEX_CHANGE:"REVISION_INDEX_CHANGE",ON_SHOW_CARD_MENU_PANEL:"ON_SHOW_CARD_MENU_PANEL",COMMENT_MORE_SHOW:"COMMENT_MORE_SHOW",TOUCH_SWIPER_SHOW:"TOUCH_SWIPER_SHOW",VOICE_COMMENT_TIP_VISIBLE:"VOICE_COMMENT_TIP_VISIBLE",REVISION_COMMENT_TIP_VISIBLE:"REVISION_COMMENT_TIP_VISIBLE",REVISION_CURSOR_TIP_SHOW:"REVISION_CURSOR_TIP_SHOW",REVISION_NUM_CHANGE:"REVISION_NUM_CHANGE",TOUCH_MOVE_DELETE_SHOW:"TOUCH_MOVE_DELETE_SHOW",FONT_DOWNLOAD:{ON_FONT_RESOURCE_DOWNLOAD_ERROR:"ON_FONT_RESOURCE_DOWNLOAD_ERROR",ON_FONT_RESOURCE_DOWNLOAD_FINISHED:"ON_FONT_RESOURCE_DOWNLOAD_FINISHED",ON_DOWNLOAD_CANCEL:"ON_DOWNLOAD_CANCEL",ON_FONT_RESOURCE_DOWNLOAD_REQUEST:"ON_FONT_RESOURCE_DOWNLOAD_REQUEST"},ON_UPDATE_TABLE_VIEW:"ON_UPDATE_TABLE_VIEW",RENDER_DRAG_MARK:"RENDER_DRAG_MARK",RENDER_DRAG_SELECT_EFFECT:"RENDER_DRAG_SELECT_EFFECT",DOC_WORKSPACE_SCROLL_TO:"DOC_WORKSPACE_SCROLL_TO",ON_UPDATE_WORKSPACE:"ON_UPDATE_WORKSPACE",ON_TOGGLE_GUIDE_CONTAINER:"ON_TOGGLE_GUIDE_CONTAINER",FORCE_UPDATE_SCROLL_INNER_SIZE:"FORCE_UPDATE_SCROLL_INNER_SIZE",ON_SHOW_TYPO_MODE_PANEL:"ON_SHOW_TYPO_MODE_PANEL",ON_SHOW_EXPORT_PDF_PANEL:"ON_SHOW_EXPORT_PDF_PANEL",ON_SHOW_FUNCTION_LIMIT_NOTICE:"ON_SHOW_FUNCTION_LIMIT_NOTICE",ON_SHOW_DROPLIST_CONTROL_MODAL:"ON_SHOW_DROPLIST_CONTROL_MODAL",ON_SYNC_HEADER_STATUS:"ON_SYNC_HEADER_STATUS",SWITCH_FINGER_SWIPE_MODE:"SWITCH_FINGER_SWIPE_MODE",SWITCH_WORKSPACE_SCROLL_CSS_ANIMATE:"SWITCH_WORKSPACE_SCROLL_CSS_ANIMATE",TOGGLE_HEADER_FOOTER_TOOLBAR:"TOGGLE_HEADER_FOOTER_TOOLBAR",INK_MODE:"INK_MODE",INK_RENDER:"INK_RENDER",CLEAR_INK:"CLEAR_INK",CLEAR_SINGLE_INK:"CLEAR_SINGLE_INK",CLOSE_INK_PANEL:"CLOSE_INK_PANEL",RESET_INK_CONTAINER_SIZE:"RESET_INK_CONTAINER_SIZE"},a={OPEN_GUIDE:"OPEN_GUIDE",CLOSE_GUIDE:"CLOSE_GUIDE",SWITCH_GUIDE_CONTENT:"SWITCH_GUIDE_CONTENT",ON_CONTENT_STRUCTURE_CHANGED:"ON_CONTENT_STRUCTURE_CHANGED",TOGGLE_GUID_MODE:"TOGGLE_GUID_MODE",CONFIRM_DELETE:"CONFIRM_DELETE"},r={names:{DOC_SELECTION_CHANGED:"doc.selectionChanged",DOC_SELECTION_SYNC_CHANGED:"doc.selectionSyncChanged",SELECTION_CHANGE_AND_CONTENT_UPDATED:"SELECTION_CHANGE_AND_CONTENT_UPDATED",DOC_TYPO_FINISHED:"doc.typo.finished",DOC_TYPO_ALL_PAGE_DONE:"doc typo all page done",DOC_COOPERATION_MODE_TOGGLED:"doc.update.coopinfo",DOC_COOPINFO_UPDATED:"doc.coopinfo.updated",DOC_COOPRANGE_UPDATED:"doc.cooprange.updated",DOC_SCROLL_INTO_VIEW:"doc.scroll.into.view",DOC_SHOW_FIND_PANEL:"doc.show.find.panel",DOC_SHOW_REPLACE_PANEL:"doc.show.replace.panel",DOC_REPLACE_RESULT:"doc.replace.result",DOC_FINDRESULTS_CHANGED:"doc.findresults.changed",DOC_FIND_PREV:"doc.find.prev",DOC_FIND_NEXT:"doc.find.next",DOC_WORKSPACE_SCROLL:"doc.workspace.scroll",DOC_WORKSPACE_AFTER_RESIZE:"doc.workspace.after_resize",DOC_WORKSPACE_SHOULD_HORIZONTAL_SCROLL:"doc.workspace.should.horizontal.scroll",DOC_SET_PROPS:"doc.set.props",DOC_INIT_IMAGE_END:"doc.init.image.end",ON_STYLE_TAG_RECEIVED:"ON_STYLE_TAG_RECEIVED",DOC_SHOW_CONTEXT_MENU:"doc.show.context.menu",DOC_CLOSE_CONTEXT_MENU:"doc.close.context.menu",DOC_RELEASE_CONTEXT_MENU:"doc.release.context.menu",DOC_PAGE_CHANGE:"DOC_PAGE_CHANGE",DOC_SECTION_CHANGE:"DOC_SECTION_CHANGE",DOC_GUEST_CONFIRM_LOGIN:"DOC_GUEST_CONFIRM_LOGIN",DOC_APP_INFO_LOADED:"DOC_APP_INFO_LOADED",TOGGLE_INSERT_PANEL_MENU:"TOGGLE_INSERT_PANEL_MENU",ON_CUSTOM_MODAL_VISIBLE_CHANGE:"ON_CUSTOM_MODAL_VISIBLE_CHANGE",ON_DATETIME_CONFIG_PANEL_VISIBLE_CHANGE:"ON_DATETIME_CONFIG_PANEL_VISIBLE_CHANGE",DOC_FONT_WAIT_TO_REPLACE:"DOC_FONT_WAIT_TO_REPLACE",DOC_FONT_WAIT_TO_LOAD:"DOC_FONT_WAIT_TO_LOAD",DOC_FONT_LOAD_CHANGE:"DOC_FONT_LOAD_CHANGE",DOC_FONT_MISSING:"DOC_FONT_MISSING",DOC_DISABLE_COMMAND_BAR:"DOC_DISABLE_COMMAND_BAR",ON_SIGNATURE_PANEL_SHOW:"ON_SIGNATURE_PANEL_SHOW",ON_SELECTIVE_PASTE:"ON_SELECTIVE_PASTE",SELECTIVE_PASTE_SUCCESS:"SELECTIVE_PASTE_SUCCESS",ON_ACTIVE_LINE_CHANGE:"ON_ACTIVE_LINE_CHANGE",DOC_UNDO_REDO:"DOC_UNDO_REDO",ON_ENTER_PARAGRAPH_SETTING_MODE:"ON_ENTER_PARAGRAPH_SETTING_MODE",ON_EXIT_PARAGRAPH_SETTING_MODE:"ON_EXIT_PARAGRAPH_SETTING_MODE",ON_KEYBOARD_HEIGHT_CHANGED:"ON_KEYBOARD_HEIGHT_CHANGED",ON_LATEX_MATH_PANEL_SHOW:"ON_LATEX_MATH_PANEL_SHOW",ON_CORE_ERROR:"ON_CORE_ERROR",SHOW_MENTION_PANEL:"SHOW_MENTION_PANEL",DOC_CLEAR_PARA:"DOC_CLEAR_PARA",DOC_CURSOR_POSITION_CHANGE:"DOC_CURSOR_POSITION_CHANGE",ON_PAGE_CONTAINER_SIZE_CHANGE:"ON_PAGE_CONTAINER_SIZE_CHANGE"},comments:{COMMENT_ENABLED_STATUS_CHANGE:"COMMENT_ENABLED_STATUS_CHANGE",COMMENTS_SHOULD_UPDATE:"comments_should_update",COMMENTS_SHOULD_DELETE:"comments_should_delete",COMMENTS_SHOULD_MOVE:"comments_should_move",COMMENTS_SHOULD_HIDE:"comments_should_hide",COMMENTS_SHOULD_SHOW:"comments_should_show",RCHANDLER_LOADED:"RCHANDLER_LOADED",COMMENTS_LOADED:"COMMENTS_LOADED",OPEN_COMMENTS_DIALOG_BY_BTN:"OPEN_COMMENTS_DIALOG_BY_BTN",OPEN_COMMENTS_DIALOG:"OPEN_COMMENTS_DIALOG",SHOW_COMMENTS_TIPS:"SHOW_COMMENTS_TIPS",SHOW_COMMENTS:"SHOW_COMMENTS",CHECKED_COMMENTS_DROPDOWN:"CHECKED_COMMENTS_DROPDOWN",COMMENTS_PARA_ACTIVE_BEGIN:"COMMENTS_PARA_ACTIVE_BEGIN",COMMENTS_PARA_ACTIVE:"COMMENTS_PARA_ACTIVE",COMMENTS_PARA_INACTIVE:"COMMENTS_PARA_INACTIVE",COMMENTS_PARA_ACTIVE_END:"COMMENTS_PARA_ACTIVE_END",GET_ONLINE_COMMENTS:"GET_ONLINE_COMMENTS",GET_ONLINE_COMMENTS_END:"GET_ONLINE_COMMENTS_END",ON_ACTIVE:"ON_ACTIVE",ON_EDIT_ITEM:"ON_EDIT_ITEM",ON_DELETE_ITEM:"ON_DELETE_ITEM",ON_DELETE_ITEMS:"ON_DELETE_ITEMS",ON_REPLY_ITEM:"ON_REPLY_ITEM",ON_CANCEL_REPLY_ITEM:"ON_CANCEL_REPLY_ITEM",ON_HOVER:"ON_HOVER",ON_LEAVE:"ON_LEAVE",ON_CLOSE:"ON_CLOSE",ON_DID_MOUNT:"ON_DID_MOUNT",ACTIVE_COMMENT_BY_RANGE:"ACTIVE_COMMENT_BY_RANGE",INACTIVE_COMMENT:"INACTIVE_COMMENT",COMMENTS_MODAL_RESIZE:"COMMENTS_MODAL_RESIZE",ON_ADD_ITEM_BY_MODAL:"ON_ADD_ITEM_BY_MODAL",ON_ADD_ITEM_BY_BTN:"ON_ADD_ITEM_BY_BTN",COMMENTS_PARAS_INVALID:"COMMENTS_PARAS_INVALID",SCROLL_TO_COMMENT:"SCROLL_TO_COMMENT",SCROLL_FIND_COMMENT:"SCROLL_FIND_COMMENT",COMMENT_SHOW_IN_PARA:"COMMENT_SHOW_IN_PARA",ON_TEMP_COMMENT_MODAL_SHOW:"ON_TEMP_COMMENT_MODAL_SHOW",ON_ENTER_COMMENT_BODY:"ON_ENTER_COMMENT_BODY",ON_EXIT_COMMENT_BODY:"ON_EXIT_COMMENT_BODY",COMMIT_AND_INSERT_NEW_COMMENT:"COMMIT_AND_INSERT_NEW_COMMENT",NAVIGATE_TO_COMMENT_HIGHLIGHT:"NAVIGATE_TO_COMMENT_HIGHLIGHT",DRAW_CONTENT_BY_COMMENT:"DRAW_CONTENT_BY_COMMENT",ON_COMMENT_SHOW_STATUS_UPDATE:"ON_COMMENT_SHOW_STATUS_UPDATE",CANCEL_SELECT_COMMENT_PANEL:"CANCEL_SELECT_COMMENT_PANEL",CANCEL_COMMENT_PANEL_BUBBLE_ACTIVE:"CANCEL_COMMENT_PANEL_BUBBLE_ACTIVE",UPDATE_COMMENT_DATA_INCLUDE_USER_INFO:"UPDATE_COMMENT_DATA_INCLUDE_USER_INFO",NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED:"NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED",MENTION_IN_COMMENT:"MENTION_IN_COMMENT",ACTIVE_COMMENT_PANEL_BUBBLE:"ACTIVE_COMMENT_PANEL_BUBBLE",ON_COMMENT_PANEL_BUBBLE_ACTIVE:"ON_COMMENT_PANEL_BUBBLE_ACTIVE",ON_COMMENT_PANEL_BUBBLE_INACTIVE:"ON_COMMENT_PANEL_BUBBLE_INACTIVE",ON_COMMENT_PANEL_SCROLL:"ON_COMMENT_PANEL_SCROLL",SET_COMMENT_OR_COMMENT_PANEL_CHECKED:"SET_COMMENT_OR_COMMENT_PANEL_CHECKED",GO_TO_ALL_COMMENT_PANEL:"GO_TO_ALL_COMMENT_PANEL",BEFORE_MODIFY_COMMENT:"BEFORE_MODIFY_COMMENT",INSERT_EMOJI_COMMENT_BY_BTN:"INSERT_EMOJI_COMMENT_BY_BTN",COMMENT_PANEL_VISIBLE:"COMMENT_PANEL_VISIBLE",COMMENT_NUM_CHANGE:"COMMENT_NUM_CHANGE",UNREAD_COMMENT_APPENDED:"UNREAD_COMMENT_APPENDED",UNREAD_COMMENT_DELETED:"UNREAD_COMMENT_DELETED",COMMENTS_DATA_CHANGED:"COMMENTS_DATA_CHANGED",COMMENTS_PANEL_DIALOG_CLOSE:"COMMENTS_PANEL_DIALOG_CLOSE",TOGGLE_COMMENT_SHOW_IN_PARA:"TOGGLE_COMMENT_SHOW_IN_PARA",SWITCH_COMMENT_TYPE:"SWITCH_COMMENT_TYPE",AFTER_COMMENT_INSERTED:"AFTER_COMMENT_INSERTED",COMMENT_INSERTOREDIT_SUCCESS:"COMMENT_INSERTOREDIT_SUCCESS",ON_CLICK_OPEN_AT:"ON_CLICK_OPEN_AT",SHOW_AT_MODEL:"SHOW_AT_MODEL",COLSE_AT_MODEL:"COLSE_AT_MODEL",SEARCH_AT_MODEL:"SEARCH_AT_MODEL",ON_CONFIRM_AT:"ON_CONFIRM_AT",ON_CLOSE_AT:"ON_CLOSE_AT",RICHTEXT_INPUT_FOCUS:"RICHTEXT_INPUT_FOCUS",RICHTEXT_INPUT_BLUR:"RICHTEXT_INPUT_BLUR",STOP_BODY_SCROLL:"STOP_BODY_SCROLL",ON_INSERT_TEMP_COMMENT:"ON_INSERT_TEMP_COMMENT",COMMENT_EMOJI_UPDATE:"COMMENT_EMOJI_UPDATE",COMMENT_UPDATE_LAYOUT:"COMMENT_UPDATE_LAYOUT",COMMENT_RICHTEXT_HEIGHT_CHANGE:"COMMENT_RICHTEXT_HEIGHT_CHANGE",UPDATE_COMMENT_PARAMS:"UPDATE_COMMENT_PARAMS",ON_COMMENTS_SVG_UPDATE:"ON_COMMENTS_SVG_UPDATE",ON_COMMENT_TEXT_REVIEW:"COMMENT_TEXT_REVIEW",GET_ONLINE_AUDIT_COMMENTS:"GET_ONLINE_AUDIT_COMMENTS",ON_COMMENT_MENU_CLICK:"ON_COMMENT_MENU_CLICK",CHANGE_COMMENT_ICON_ZINDEX:"CHANGE_COMMENT_ICON_ZINDEX"},revision:{DISABLE_REVISION:"DISABLE_REVISION",ENABLE_REVISION:"ENABLE_REVISION",REVISION_TRACK_CHANGE:"REVISION_TRACK_CHANGE",REVISION_DATA_END:"REVISION_DATA_END",REVISION_ACTIVE_CHANGE:"REVISION_ACTIVE_CHANGE",REVISION_CLIENT_TOAST:"REVISION_CLIENT_TOAST",REVISION_DATA_CHANGE:"REVISION_DATA_CHANGE",REVISION_COUNT:"REVISION_COUNT",REVISION_ACCEPTREFUSE:"REVISION_ACCEPTREFUSE",ON_HISTORY_REVISION_TOOL_SHOW:"ON_HISTORY_REVISION_TOOL_SHOW",REVISION_SETTINGS_CHANGE:"REVISION_SETTINGS_CHANGE",REVISION_BTN_DISPLAY_CHANGE:"REVISION_BTN_DISPLAY_CHANGE",SHOW_REVISION_BUBBLE:"SHOW_REVISION_BUBBLE"},table:{ON_TABLE_INSERT:"ON_TABLE_INSERT",ON_TABLE_COPY:"ON_TABLE_COPY",ON_TABLE_CUT:"ON_TABLE_CUT",ON_TABLE_DELETE:"ON_TABLE_DELETE",ON_TABLE_SELECT_ALL:"ON_TABLE_SELECT_ALL",ON_TABLE_BEGIN_RESIZING:"ON_TABLE_BEGIN_RESIZING",ON_TABLE_END_RESIZING:"ON_TABLE_END_RESIZING",ON_TABLE_MERGE_CELLS:"ON_TABLE_MERGE_CELLS",ON_TABLE_SPLIT_CELLS:"ON_TABLE_SPLIT_CELLS",ON_TABLE_KEEP_ACTIVE:"ON_TABLE_KEEP_ACTIVE",ON_TABLE_CANCEL_ACTIVE:"ON_TABLE_CANCEL_ACTIVE",ON_TABLE_SELECT_COLUMN_OR_ROW:"ON_TABLE_SELECT_COLUMN_OR_ROW",ON_TABLE_SELECTS_START:"ON_TABLE_SELECTS_START",ON_TABLE_MOVING_START:"ON_TABLE_MOVING_START",ON_TABLE_MOVING_EDIT_MODE:"ON_TABLE_MOVING_EDIT_MODE",ON_TABLE_MOVING_EDIT_MODE_END:"ON_TABLE_MOVING_EDIT_MODE_END",ON_TABLE_DRAG_START_COLUMN_OR_ROW:"ON_TABLE_DRAG_START_COLUMN_OR_ROW",ON_TABLE_DRAG_COLUMN_OR_ROW:"ON_TABLE_DRAG_COLUMN_OR_ROW",ON_TABLE_DRAG_END_COLUMN_OR_ROW:"ON_TABLE_DRAG_COLUMN_OR_ROW_END",ON_TABLE_SELECT_BY_SHORTCUT:"ON_TABLE_SELECT_BY_SHORTCUT"},shape:{ON_IMAGE_MOVING_EDIT_MODE:"ON_IMAGE_MOVING_EDIT_MODE",ON_IMAGE_MOVING_EDIT_MODE_END:"ON_IMAGE_MOVING_EDIT_MODE_END",ON_SHOW_IMAGE_VIEWER:"ON_SHOW_IMAGE_VIEWER",ON_HIDE_IMAGE_VIEWER:"ON_HIDE_IMAGE_VIEWER",ON_SHAPE_BEGIN_RESIZING:"ON_SHAPE_BEGIN_RESIZING",ON_SHAPE_END_RESIZING:"ON_SHAPE_END_RESIZING",HIT_ON_SHAPE:"HIT_ON_SHAPE",ON_SHAPE_SELECTED:"ON_SHAPE_SELECTED",ON_SHAPE_CANCEL_SELECT:"ON_SHAPE_CANCEL_SELECT",ON_IMAGE_UPLOAD_REQUEST:"ON_IMAGE_UPLOAD_REQUEST",ON_IMAGE_INSERT:"ON_IMAGE_INSERT",AFTER_IMAGE_INSERT:"AFTER_IMAGE_INSERT",ON_SHAPE_BEGIN_PREVIEW:"ON_SHAPE_BEGIN_PREVIEW",ON_SHAPE_END_PREVIEW:"ON_SHAPE_END_PREVIEW",ON_SHAPE_BEGIN_SET_ADJUSTHANDLER:"ON_SHAPE_BEGIN_SET_ADJUSTHANDLER",ON_SHAPE_END_SET_ADJUSTHANDLER:"ON_SHAPE_END_SET_ADJUSTHANDLER",ON_SHAPE_SET_ADJUSTHANDLER:"ON_SHAPE_SET_ADJUSTHANDLER",ON_SHAPE_PRE_INSERT:"ON_SHAPE_PRE_INSERT",ON_SHAPE_CANCLE_INSERT:"ON_SHAPE_CANCLE_INSERT"},mobile:o,dispatchEvent:i.default.dispatchEvent,cooper:i.default.cooper,hyperLink:{ON_LINK_INSERT:"ON_LINK_INSERT",ON_LINK_EDIT:"ON_LINK_EDIT",ON_LINK_SELECT:"ON_LINK_SELECT",ON_LINK_DELETE:"ON_LINK_DELETE",ON_LINK_OPEN:"ON_LINK_OPEN",ON_LINK_CARD_SWITCH:"ON_LINK_CARD_SWITCH",ON_LINK_MODAL_SWITCH:"ON_LINK_MODAL_SWITCH",ON_LINK_ITEM_CLICK:"ON_LINK_ITEM_CLICK",ON_LINK_COPY:"ON_LINK_COPY",SWITCH_TO_WEBSHAPE:"SWITCH_TO_WEBSHAPE"},webshape:{ON_WEBSHAPE_CARD_SWITCH:"ON_WEBSHAPE_CARD_SWITCH",SWITCH_TO_LINK:"SWITCH_TO_LINK",ON_WEBSHAPE_INSERT:"ON_WEBSHAPE_INSERT",ON_WEBSHAPE_MODAL_SWITCH:"ON_WEBSHAPE_MODAL_SWITCH"},footnoteEndnote:{ON_NOTE_SETTING_DIALOG_SWITCH:"ON_NOTE_SETTING_DIALOG_SWITCH",ON_FOOTNOTE_SETTING_CT:"ON_FOOTNOTE_SETTING_CT",ON_ENDNOTE_SETTING_CT:"ON_ENDNOTE_SETTING_CT"},zoom:{ZOOM_TO_FITPAGE:"ZOOM_TO_FITPAGE",ZOOM_TO_WORD:"ZOOM_TO_WORD",ZOOM_TO_TOTALPAGE:"ZOOM_TO_TOTALPAGE",ZOOM_TO_DECREASE:"ZOOM_TO_DESCRESE",ZOOM_TO_INCREASE:"ZOOM_TO_INCREASE",ZOOM_TO_100_PERCENT:"ZOOM_TO_100_PERCENT",DOC_SCALE:"DOC_SCALE",ON_SCALING_CHANGE:"ON_SCALING_CHANGE"},content:{MODIFY:"MODIFY",CLEAR:"CLEAR",PROP_CHANGE:"PROP_CHANGE",EDIT:"EDIT"},formatPainter:{ON_FORMAT_PAINTER_APPLIED:"ON_FORMAT_PAINTER_APPLIED",ON_FORMAT_PAINTER_RESET:"ON_FORMAT_PAINTER_RESET"},pageSetting:{ON_PAGE_MARGIN_VISIBLE:"ON_PAGE_MARGIN_VISIBLE",ON_PAGE_DIRECT_VISIBLE:"ON_PAGE_DIRECT_VISIBLE"},contentControls:{BEFORE_CONTENT_CONTROLS_DATE_APPLY:"BEFORE_CONTENT_CONTROLS_DATE_APPLY",RENDER_CONTROLS:"RENDER_CONTROLS",RENDER_PIC_CONTROLS_ENTRANCE:"RENDER_PIC_CONTROLS_ENTRANCE",ON_CONTROL_ITEM_CLICK:"ON_CONTROL_ITEM_CLICK",ON_CONTENT_CONTROL_ENTER:"ON_CONTENT_CONTROL_ENTER"},catalog:{BEFORE_CATALOG_APPLY:"BEFORE_CATALOG_APPLY",ON_CATALOG_CONFIG_PANEL_VISIBLE_CHANGE:"ON_CATALOG_CONFIG_PANEL_VISIBLE_CHANGE",SHOW_CATALOG_TIP:"SHOW_CATALOG_TIP"},docmap:{SHOW:"SHOW",HIDE:"HIDE",INIT:"INIT",INSERTED:"INSERTED",DELETED:"DELETED",MODIFIED:"MODIFIED",SELECTED:"SELECTED",AUTONUM_CHANGED:"AUTONUM_CHANGED",ON_PANEL_OPEN:"ON_PANEL_OPEN",ON_PANEL_CLOSE:"ON_PANEL_CLOSE",ON_ITEM_CLICK:"ON_ITEM_CLICK"},cooperation:{COOPERATOR_SELECTION_CHANGE:"COOPERATOR_SELECTION_CHANGE",ON_CONVENE_LIST_UPDATE:"ON_CONVENE_LIST_UPDATE",ON_RESPONSE_CONVENE:"ON_RESPONSE_CONVENE",ON_CONVENE_INITIATE:"ON_CONVENE_INITIATE",CHANGE_COOPERATION_STATUS:"CHANGE_COOPERATION_STATUS",ON_AVATAR_VISIBLE_CHANGE:"ON_AVATAR_VISIBLE_CHANGE",SHOW_COOPERATOR_NAME_TIP:"SHOW_COOPERATOR_NAME_TIP",ON_NOTIFY_TIPS:"ON_NOTIFY_TIPS"},watermark:{CHANGE_MODIFY_WATERMARK:"CHANGE_MODIFY_WATERMARK",REMOVE_WATERMARK_OLD_NODE:"REMOVE_WATERMARK_OLD_NODE"},pcDialogs:{WPS_SHOW_ALERT:"WPS_SHOW_ALERT",ON_OPEN_UPLOAD_DECORATOR:"ON_OPEN_UPLOAD_DECORATOR",WPS_SUMMARY_TIPS:"WPS_SUMMARY_TIPS"},taskPane:{OPEN_FONT_FONT:"OPEN_FONT_FONT",OPEN_FONT_PARA:"OPEN_FONT_PARA",OPEN_BOOKMARK:"OPEN_BOOKMARK",OPEN_OFFICIAL_DOCUMENT:"OPEN_OFFICIAL_DOCUMENT",OPEN_COMMENT_PANEL:"OPEN_COMMENT_PANEL",GET_COMMENT_PANEL_DATA:"GET_COMMENT_PANEL_DATA",KILL_COMMENT_PANEL:"KILL_COMMENT_PANEL",OPEN_SHAPE_ATTR:"OPEN_SHAPE_ATTR",OPEN_SHAPE_TEXT:"OPEN_SHAPE_TEXT",ON_TASK_PANE_VISIBLE:"ON_TASK_PANE_VISIBLE",CLOSE_TASK_PANEL:"CLOSE_TASK_PANEL"},restrictEdit:{ON_RESTRICT_STATE_CHANGE:"ON_RESTRICT_STATE_CHANGE",SHOW_RESTRICT_OPEN_DIALOG:"SHOW_RESTRICT_OPEN_DIALOG"},guide:a,print:{OPEN_PRINT:"OPEN_PRINT"},processon:{CREATE:"CREATE"},document:{ON_OTHER_USER_CHANGE_DOCUMENT_ENCODING:"ON_OTHER_USER_CHANGE_DOCUMENT_ENCODING",ON_DOCUMENT_OPEN:"ON_DOCUMENT_OPEN",ON_DOC_BEFORE_OPEN:"ON_DOC_BEFORE_OPEN",ON_DOC_AFTER_INIT:"ON_DOC_AFTER_INIT",ON_DOC_AFTER_OPEN:"ON_DOC_AFTER_OPEN",ON_DOC_DATA_LOAD:"ON_DOC_DATA_LOAD"},webMode:{ON_UPDATE_OUTDIV:"ON_UPDATE_OUTDIV",ON_FILENAME_SETTING_CHANGE:"ON_FILENAME_SETTING_CHANGE",ON_FILENAME_SWITCH:"ON_FILENAME_SWITCH",ON_WEBMODE_GUIDE:"ON_WEBMODE_GUIDE"},bookmark:{ON_BOOKMARKS_CHANGE:"ON_BOOKMARKS_CHANGE",ON_BOOKMARKS_SORT:"ON_BOOKMARKS_SORT"},view:{BEFORE_VIEW_MODE_CHANGED:"BEFORE_VIEW_MODE_CHANGED",AFTER_VIEW_MODE_CHANGED:"AFTER_VIEW_MODE_CHANGED",VISUAL_VIEWPORT_LOCATE_TIMEOUT:"VISUAL_VIEWPORT_LOCATE_TIMEOUT",ON_OPENAPI_INIT:"ON_OPENAPI_INIT"},pluginEvent:{CUSTOM_PLUGIN_EVENT:"CUSTOM_PLUGIN_EVENT"},preview:{ON_PAGE_APPENDED:"ON_PAGE_APPENDED"},input:{ON_INPUT_VALUE_CHANGED:"ON_INPUT_VALUE_CHANGED"},canvas:{ON_BEFORE_TEXT_PAGE_RENDER:"ON_BEFORE_TEXT_PAGE_RENDER",ON_AFTER_REFRESH_CANVAS:"ON_AFTER_REFRESH_CANVAS"},spellCheck:{OPEN:"OPEN",CLOSE:"CLOSE",MISSION_BEFORE_TERMINATE:"MISSION_BEFORE_TERMINATE",RELEASE_MISSION:"RELEASE_MISSION",SAVE_IGNORE_DATA2_STORAGE:"SAVE_IGNORE_DATA2_STORAGE",DELETE_REMOVE_WRONG_RANGES:"DELETE_REMOVE_WRONG_RANGES",INSERT_REMOVE_WRONG_RANGES:"INSERT_REMOVE_WRONG_RANGES",SET_PROP_REMOVE_WRONG_RANGES:"SET_PROP_REMOVE_WRONG_RANGES",REMOVE_WRONG_RANGES:"REMOVE_WRONG_RANGES",BEFORE_REMOVE_PROGRESS_RANGES:"BEFORE_REMOVE_PROGRESS_RANGES"},documentField:{DOC_DOCUMENTFIELDS_DATA_UPDATE:"DOC_DOCUMENTFIELDS_DATA_UPDATE"},interactions:{SWIPE:"SWIPE"},edit:{ON_AUTO_FORMAT_BY_INSERT_TEXT:"ON_AUTO_FORMAT_BY_INSERT_TEXT",ON_ANCHOR_DATA_CHANGED:"ON_ANCHOR_DATA_CHANGED",ON_SHAPE_DATA_CHANGED:"ON_SHAPE_DATA_CHANGED"},scroll:{FREE_SCROLL_BAR_STYLE:"FREE_SCROLL_BAR_STYLE"}};t.default=r},2698:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n(14),o=function(){return(window.fileInfo||window.__WPSENV__.file_info.file).id};function a(){var e=Object(i.getQuery)("wpsPreview");return"0"!==e&&"false"!==e&&void 0!==e}},289:function(e,t,n){"use strict";t.a=function(e){return Object.prototype.toString.call(e)}},2939:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var i=n(24),o=n.n(i),a=n(8),r=n.n(a),s=n(80),l=n.n(s),c=n(1),u=n.n(c),d=n(2),_=n.n(d),E=n(361),h=function(e){return{types:E.default.HTTP_TYPES,callAPI:(t=l()(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.post("/api/v3/office/file/"+window.urlFileId+"/users").send({ids:e}).end();case 2:return i=t.sent,t.abrupt("return",{body:i.body});case 4:case"end":return t.stop()}}),t,void 0)}))),function(e){return t.apply(this,arguments)})};var t},f=n(227),O=n(676),p=Function.prototype,m=0;function N(e){return new Promise((function(t){setTimeout(t,e)}))}var v=[],C=!1,T=function(){function e(){u()(this,e)}return _()(e,[{key:"loadUserInfos",value:function(e,t){var n=new Promise((function(n){var i;i=l()(regeneratorRuntime.mark((function i(){var o,a,s,l,c,u,d;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:C=!0,o=[],a=0;case 3:if(!(a<e.length)){i.next=20;break}if(s=e.slice(a,a+200),a+=200,!((l=Date.now())-m<200)){i.next=10;break}return i.next=10,N(200-(l-m));case 10:return c=null,i.next=13,t(h(s));case 13:u=i.sent,d=u.response,c=d&&d.body||[],m=Date.now(),o.push.apply(o,r()(c)),i.next=3;break;case 20:n(o),v.length>0&&v.shift()(),C=!1;case 23:case"end":return i.stop()}}),i,this)}))),p=function(){return i.apply(this,arguments)}}));return C?v.push(p):p(),n}}]),e}(),A=new(function(){function e(){if(u()(this,e),"object"===o()(e._instance_))return e._instance_;e._instance_=this,this.loader=new T,this.colors=["#0484DA","#33A02C","#FF7F00","#6A3D9A","#3D959A","#AE8B00","#9A3D84","#5B68D0","#7BAE00","#f15989","#155884","#1C8015","#9E5812","#4E217F","#21687F","#876800","#7F2164","#151B84","#708700","#A7191A","#1F78B4","#0BBE00","#CA6400","#6003C3","#009788","#C38D00","#BD006C","#1800CC","#A0B200","#D20002"],this.userColorsFromOutside=new Map,this.coopInfos=[],this.styleTags=[],this.cooperCenter=f.default.cooper.getCooperCenter(),this.handleCooperModeToggled=this.handleCooperModeToggled.bind(this),this.handleStyleTagReceived=this.handleStyleTagReceived.bind(this),this._isInit=!1,this._isFetchingInfos=!1,this._isFetchRequestShelved=!1}var t;return _()(e,[{key:"setUsersColor",value:function(e,t){var n=this;if(e.forEach((function(e){n.userColorsFromOutside.set(e.userId,e.color);var t=n.coopInfos.find((function(t){return t.userid+""==e.userId+""}));t&&(t.color=e.color)})),t){var i=window.APP.data.selection.activeAllCommentsData;i&&i.comments&&i.comments.forEach((function(e){var t=n.userColorsFromOutside.get(e.userid)||e.color;e.color=t})),this.events.dispatchEvent(this.events.COOPERATOR_SELECTION_CHANGE),window.APP.workspace.refreshDryly()}}},{key:"getColorByTagid",value:function(e){var t=this.coopInfos.find((function(t){return t.tagid===e}));return t&&this.userColorsFromOutside.has(t.userid)?this.userColorsFromOutside.get(t.userid):this.colors[(e-1)%this.colors.length]}},{key:"getUserColor",value:function(e){if(this.userColorsFromOutside.has(e))return this.userColorsFromOutside.get(e);var t=this.coopInfos.find((function(t){return t.userid===e}));if(t)return t.color;var n=this.styleTags.find((function(t){return t.userid===e}));return n?this.colors[(n.tagid-1)%this.colors.length]:"#fc0d1b"}},{key:"getRevisionColor",value:function(e){return this.userColorsFromOutside.has(e)?this.userColorsFromOutside.get(e):this.colors[e%this.colors.length]}},{key:"init",value:function(e,t,n,i){this.acl=n,this.fileid=t,this.dispatch=i,this.events=e,window.addEventListener(this.events.ON_STYLE_TAG_RECEIVED,this.handleStyleTagReceived),window.addEventListener(this.events.DOC_COOPERATION_MODE_TOGGLED,this.handleCooperModeToggled),this.init=Function.prototype}},{key:"handleStyleTagReceived",value:(t=l()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.styleTags=t.detail.data,this._isInit&&this.updateUserInfo();case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"afterOpen",value:function(){this._isInit=!0,this.copyUserInfoFromPublic(),this.updateUserInfo()}},{key:"copyUserInfoFromPublic",value:function(){var e=this;this.cooperCenter._users.forEach((function(t){e.generateUserInfo(Object.assign({},t))}))}},{key:"generateUserInfo",value:function(e){if(e){var t={avatar:e.avatar,userid:e.id,username:e.name},n=e.tagid;void 0!==n?(t.tagid=n,t.color=this.userColorsFromOutside.get(e.id)||this.colors[(n-1)%this.colors.length]):t.color=e._color||"#fc0d1b";var i=this.coopInfos.find((function(e){return e.userid===t.userid}));i?Object.assign(i,t):this.coopInfos.push(t)}}},{key:"getUserInfoFromPublic",value:function(e){var t=e.userid,n=e.tagid,i=this.cooperCenter._users.get(t);i&&this.generateUserInfo(Object.assign({tagid:n},i))}},{key:"updateUserInfo",value:function(){var e=this;if(this._isFetchingInfos)this._isFetchRequestShelved=!0;else{this._isFetchingInfos=!0,this.styleTags.forEach(this.getUserInfoFromPublic,this);var t=this.fetchUserInfoThatNonexistentYet().then((function(){e.events.dispatchEvent(e.events.DOC_COOPINFO_UPDATED)}));Object(O.enableFinally)(t).finally((function(){e._isFetchingInfos=!1,e._isFetchRequestShelved&&(e._isFetchRequestShelved=!1,e.updateUserInfo())}))}}},{key:"fetchUserInfoThatNonexistentYet",value:function(){var e=this,t=this.styleTags.filter((function(t){return!e.coopInfos.some((function(e){return e.userid===t.userid}))}));if(t.length>0){var n=t.map((function(e){return e.userid}));return this.loader.loadUserInfos(n,this.dispatch).then((function(t){t.forEach((function(i){var o=i.avatar_url,a=i.name,r=i.id,s=e.styleTags.find((function(e){return e.userid===r})),l={avatar:o,userid:r,username:a,color:e.userColorsFromOutside.get(r)};s?(l.tagid=s.tagid,l.color=l.color||e.colors[(s.tagid-1)%e.colors.length]):(l.color=l.color||"#fc0d1b",console.error("id无法匹配，协作信息加载错误！",t,n,e.styleTags)),e.coopInfos.push(l)}))}))}return Promise.resolve()}},{key:"handleCooperModeToggled",value:function(e){e.detail.state&&!this._isInit||this.events.dispatchEvent(this.events.DOC_COOPINFO_UPDATED)}},{key:"hasCooperMembers",get:function(){return!(0===this.coopInfos.length||1===this.coopInfos.length&&this.coopInfos[0].userid==window.APP.info.userid)}}]),e}())},308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i={arrayTag:"[object Array]",boolTag:"[object Boolean]",dateTag:"[object Date]",funcTag:"[object Function]",numberTag:"[object Number]",objectTag:"[object Object]",stringTag:"[object String]",symbolTag:"[object Symbol]"},o={FUNC_ERROR_TEXT:"need function",ARRAY_ERROR_TEXT:"need array",ARRAYObj_ERROR_TEXT:"need obj or array"}},315:function(e,t,n){"use strict";n.r(t);var i=n(24),o=n.n(i),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),_=n.n(d),E=n(238),h=n.n(E),f=n(240),O=n(250),p=n.n(O),m=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refDiv=h.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return _()(t,e),l()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(f.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getClassName",value:function(){var e=this.props,t=e.selected,n=e.disabled,i=e.disabledTag,a=e.children,r=e.className,s=e.readonly,l="component-menu-item",c=this.refDiv.current;c&&-1!==c.className.indexOf(" hover")&&(l+=" hover"),t&&(l+=" selected"),n&&(l+=" disabled"),s&&(l+=" readonly"),i&&(l+=" disabled-tag"),r&&(l+=" "+r);var u=void 0===a?"undefined":o()(a);return"string"!==u&&"number"!==u||(l+=" only-text"),r&&(l+=" "+r),l}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.keepEdit,o=e.dataKey,a=e.title,r=e.draggable,s=e.onDragStart,l=e.onDragEnd,c=e.altHintKeep,u=e.altRenderDelay,d=e.altForceDirection,_=e.altRole,E=e.altCustom,f=this.getClassName();return h.a.createElement(p.a,{title:a},h.a.createElement("div",{ref:this.refDiv,id:t,className:f,role:_,"alt-hint-keep":c,"alt-render-delay":u,"alt-force-direction":d,"alt-custom":E,"data-keep-edit":i||void 0,"data-key":o||void 0,draggable:r,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:s,onDragEnd:l},n))}}]),t}(E.PureComponent);m.defaultProps={altRole:"option"},t.default=m},3353:function(e,t,n){e.exports=function(e,t){n.e(528).then(n.bind(null,4761)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},3368:function(e,t,n){"use strict";var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(4295),n(238)),_=n.n(d),E=n(240),h=n(82),f=n(248),O=n(250),p=n.n(O),m=f.default.types.other,N=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refContainer=_.a.createRef(),n.handleClick=n.handleClick.bind(n),n.state={officeType:Object(E.getPageOfficeType)()},n}return u()(t,e),r()(t,[{key:"handleClick",value:function(e){var t=this.props,n=t.onChange,i=t.value,o=t.checked,a=t.isNeedNativeEvent;n&&(a?n(!o,i,e):n(!o,i))}},{key:"getElement",value:function(){return this.refContainer.current}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.indeterminate,i=e.disabled,o=e.checked,a=e.isAuto,r=this.state.officeType,s="component-checkbox";return i&&(s+=" disabled"),n&&(s+=" indeterminate"),a&&(s+=" "+r),t&&(s+=" "+t),o&&(s+=" checked"),s}},{key:"renderIcon",value:function(){var e=this.props,t=e.checked,n=e.isAuto;if(!t)return!1;var i=m.checked;if(n){var o=this.state.officeType;i=o===h.default.writer?m.checkbox_w:o===h.default.spreadsheet?m.checkbox_s:o===h.default.ksheet?m.checkbox_k:o===h.default.presentation?m.checkbox_p:o===h.default.pdf?m.checkbox_f:m.checkbox_system}return _.a.createElement(f.default,{type:i})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.value,o=e.altScPosition,a=e.altVpSelector,r=this.getClassName(),s=this.renderIcon();return _.a.createElement(p.a,{title:n,middleShow:!0},_.a.createElement("div",{ref:this.refContainer,className:r,onClick:this.handleClick,"data-value":i,role:"checkbox","alt-sc-position":o,"alt-vp-selector":a},_.a.createElement("div",{className:"checkbox-icon"},s),!!t&&_.a.createElement("div",{className:"checkbox-text"},t)))}}]),t}(d.PureComponent);N.defaultProps={checked:!1,indeterminate:!1,disabled:!1,isAuto:!0,isNeedNativeEvent:!1},t.a=N},351:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(650),n(238)),_=n.n(d),E=n(244),h=n.n(E),f=n(167),O=n(227),p=n(319),m=n(510),N=n(393),v={click:"click",hover:"hover"},C=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.trigger===v.hover&&!f.isTouchScreen},n.refDropDown=_.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,o=n.destroyOnHide;!i&&e.visible&&!o&&void 0!==o&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&O.default.dispatchEvent(O.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||h.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,o=t.trigger;i?i(e):o===v.hover&&!f.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,o=n.right,a=n.top,r=n.bottom,s=e.pageX,l=e.pageY;if(s>=i&&s<=o&&l>=a&&l<=r)return}this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,o=t.visible,a=t.placement,r=t.distance,s=t.panelClass,l=t.isAuto,c=t.offsetX,u=t.autoClose;return _.a.createElement(m.a,{ref:this.refDropDown,isAuto:l,className:s,triggerElement:this.btnDom,rect:e,offsetX:c,visible:o,placement:a,distance:r,isSetHeight:n,onClose:this.handleContentClose,autoClose:u,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,o=e.destroyOnHide;t=t||n.props.disabled;var a=this.getRect();if(!t){var r=n.props.title;r&&i&&(r=null),n=_.a.cloneElement(n,{title:r,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return _.a.createElement(_.a.Fragment,null,n,!!a&&_.a.createElement(p.default,{visible:i,destroyOnHide:o},this.renderContent()))}}]),t}(d.PureComponent);C.placementTypes=m.a.placementTypes,C.DropdownPanel=N.default,C.triggerTypes=v,C.defaultProps={visible:!1,trigger:v.click,distance:4,offsetX:0,autoClose:!0},t.default=C},3532:function(e,t,n){e.exports=function(e,t){n.e(590).then(n.bind(null,3424)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},393:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(432),n(238)),_=n.n(d),E=n(167),h=n(227),f=n(240),O=n(248),p=n(565),m=n(608),N=n(246),v="right",C="down",T="rightDown",A=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){if(!n.props.disabledScrollSelectedChildren)for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer),window.__WPSENV__.altStatus&&window.postMessage(JSON.stringify({eventName:"alt_web_access",cmd:"refresh"}))}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var o=n.refPanel.current,a=o.scrollTop;a+o.clientHeight+t>=o.scrollHeight&&i({scrollTop:a})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=_.a.createRef(),n.refContent=_.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(f.getPageOfficeType)(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){E.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(e){E.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(e),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(e){if(this.props.onItemHover&&!E.isTouchScreen){var t=this.getHoverItem();this.props.onItemHover(t,!0)}window.__WPSENV__.altStatus&&h.default.dispatchEvent(h.default.names.EXIT_ALT_MODE,e)}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(f.stopBubble)(e);var i=e.clientX,o=e.clientY,a=e.target,r=e.currentTarget.getAttribute("data-orien");a.setCapture&&a.setCapture();var s=this.state,l=s.width,c=s.height,u=s.minWidth,d=s.minHeight;document.onmousemove=function(e){Object(f.stopBubble)(e);var n=e.clientX,a=e.clientY,s=Math.max(u,l+n-i),_=Math.max(d,c+a-o);r===v?_=c:r===C&&(s=l),t.setState({width:s,height:_},(function(){h.default.dispatchEvent(h.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(f.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,a.releaseCapture&&a.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus){var i=Object(N.getKey)(e);switch(i){case N.Keys.Enter:var o=this.getHoverItem();o&&(Object(f.stopBubble)(e),o.click());break;case N.Keys.ArrowUp:case N.Keys.ArrowDown:var a=i===N.Keys.ArrowUp;this.setPreSelectItem(a,e),this.props.isPreSelectCloseDropdown&&h.default.dispatchEvent(h.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(f.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);o.classList.add("hover"),this.showPreSelectItem(o)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var a=i-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){i=a;break}}else for(var r=i+1;r<t.length;r++)if(-1===t[r].className.indexOf("disabled")){i=r;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,o=t.maxWidth,a=t.maxHeight;if(n||i||o||a)return{width:n,minWidth:i,maxWidth:o,maxHeight:a}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,o=e.isAuto,a=e.altStartMode,r="dropdown-panel";o&&(r+=" "+this.officeType),i&&(r+=" can-resize"),t&&(r+=" "+t);var s=this.getPanelStyle();return _.a.createElement("div",{ref:this.refPanel,className:r,style:s,tabIndex:0,"alt-start-mode":a,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0,role:"listbox"},_.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),_.a.createElement("div",{className:"drag-hand rightBottom","data-orien":T,onMouseDown:this.handleDragMouseDown},_.a.createElement(O.default,{type:O.default.types.other.drag_right_bottom})),_.a.createElement("div",{className:"drag-hand right","data-orien":v,onMouseDown:this.handleDragMouseDown}),_.a.createElement("div",{className:"drag-hand bottom","data-orien":C,onMouseDown:this.handleDragMouseDown}))}}]),t}(d.PureComponent);A.Item=p.default,A.Divider=m.a,A.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=A},405:function(e,t,n){"use strict";var i=n(289),o=n(308);t.a=function(e,t){if(Object(i.a)(e)!=o.a.arrayTag)throw new TypeError(o.b.ARRAY_ERROR_TEXT);for(var n=e.length,a=-1;++a<n;)if(t(e[a],a,e))return a;return-1}},406:function(e,t,n){"use strict";var i=n(289),o=n(308);t.a=function(e,t){var n=Object(i.a)(e);if(n===o.a.objectTag)for(var a in e)e.hasOwnProperty(a)&&t(e[a],a);else{if(n!==o.a.arrayTag)throw new TypeError(o.b.ARRAYObj_ERROR_TEXT);e.forEach(t)}}},428:function(e,t,n){"use strict";n.r(t),t.default={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"}},4295:function(e,t,n){},432:function(e,t,n){},448:function(e,t,n){"use strict";t.a=function(e,t,n){var i=!(n&&!1===n.trailing),o=Date.now(),a=void 0,r=void 0,s=null;function l(){for(var n=arguments.length,l=Array(n),c=0;c<n;c++)l[c]=arguments[c];a=this;var u=Date.now();if(void 0===r)return r=-1,s=e.apply(this,l),o=u,s;var d=u-o,_=t-d;return _>0?-1===r&&(r=setTimeout((function(){!1!==i&&(s=e.apply(a,l),o=Date.now()),r=-1}),_)):(s=e.apply(this,l),o=u),s}return Number(t)||(t=16),l.cancel=function(){r&&-1!==r&&(clearTimeout(r),r=-1)},l}},4509:function(e,t,n){"use strict";n.r(t);var i=n(5721),o=n.n(i),a=n(4517),r=n.n(a),s={Toast:o.a,Message:r.a};try{window.__WPSPLUGIN__.pluginMgr.helper.ui=window.__WPSPLUGIN__.pluginMgr.helper.ui||{},Object.assign(window.__WPSPLUGIN__.pluginMgr.helper.ui,s)}catch(e){console.error("[pluginMgr] init ui failed",e),window.badJsFunc(!1,{error:e})}},4669:function(e,t,n){"use strict";var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=function(){function e(){o()(this,e),this._listeners={}}return r()(e,[{key:"on",value:function(e,t){return this._on(e,{handler:t})}},{key:"once",value:function(e,t){return this._on(e,{handler:t,once:!0})}},{key:"off",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._listeners[e];if(e)if(t){if(n){var i=window.utils.Lodash.findIndex(n,(function(e){return e.handler==t}));n.splice(i,1)}}else delete this._listeners[e];else this._listeners={};return this}},{key:"fire",value:function(e,t){var n=this._listeners[e];if(n)for(var i=n.length-1;i>=0;--i)n[i].handler(t),n[i].once&&(n.splice(i,1),0===n.length&&delete this._listeners[e]);return this}},{key:"_on",value:function(e,t){return this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t),this}},{key:"simpleOn",value:function(e,t){this._listeners[e]=[{handler:t}]}}]),e}();t.a=s},490:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(238),_=n.n(d),E=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.className,t="component-menu-divider";return e&&(t+=" "+e),_.a.createElement("div",{className:t})}}]),t}(d.PureComponent);t.default=E},5027:function(e,t,n){e.exports=function(e,t){n.e(589).then(n.bind(null,7384)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},510:function(e,t,n){"use strict";var i=n(30),o=n.n(i),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),_=n.n(d),E=(n(651),n(238)),h=n.n(E),f=n(167),O=n(240),p=n(246),m=n(227),N=n(428),v=n(571),C=n(628),T=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,o=n.props.triggerElement;!i||i.contains(t)||C.inTriggerElement(o,e)||v.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=h.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return _()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,this.observer=new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})),this.observer.observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){var e=this;setTimeout((function(){e.props.autoClose&&e.props.onClose()}))}},{key:"handleWindowKeyDown",value:function(e){p.getKey(e)===p.Keys.Esc&&(v.b(this.level+1)||(Object(O.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){f.isPad&&window.performance.now()-this.timestamp<=300||this.handleClose(e)}},{key:"handleWindowResize",value:function(e){var t=(e.detail||{}).isClosePanel;(void 0===t?null:t)||(f.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose())}},{key:"bindEvents",value:function(){this.observerPanel(),m.default.dispatchEvent(m.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(m.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(m.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){m.default.dispatchEvent(m.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(m.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(m.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize),this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=C.getShowOrigin(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},o()(t,window.rightToLeft?"right":"left",0),o()(t,"top",0),t),i=this.props,a=i.placement,r=i.rect,s=i.distance,l=i.isAuto,c=i.triggerElement;if(c){var u=c.getBoundingClientRect(),d=u.top,_=u.bottom;r=Object.assign({},r,{top:d,bottom:_})}var E=C.getPositionStyle(a,e,r,s);return l&&(E=C.showFullPanel(E,e)),Object.assign(n,E),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},o()(n,window.rightToLeft?"right":"left",0),o()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var a=this.props,r=a.distance,s=a.isSetHeight;if(a.forceUpdate||!this.style){this.style=this.createStyle(t),s&&(this.style.height=C.getHeight(this.style.top,t,r));var l=t.getBoundingClientRect().height;Math.abs(l-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return h.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=v.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,o=e.className,a=this.state.visible,r=null;"function"==typeof t.type&&(r={isListenEvent:a});var s=h.a.cloneElement(t,r),l=this.getPanelStyle(),c=this.getAnimationOrigin(l),u=this.calcTransparentPlaceholder(c),d=v.c;return a&&(this.showAnimation&&(d+=" animation-fade-scaleY-in"),d+=" origin-"+c,o&&(d+=" "+o)),h.a.createElement("div",{ref:this.refPanel,className:d,style:l,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},u,s)}}]),t}(E.PureComponent);T.placementTypes=N.default,T.defaultProps={placement:N.default.bottomLeft,distance:0,offsetX:0,isSetHeight:!1,forceUpdate:!1,autoClose:!0},t.a=T},514:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(773),n(238)),_=n.n(d),E=n(227),h=n(240),f=n(543),O=n(167),p=n(490),m=n(315),N=(n(774),n(248)),v=n(81),C=n(775),T=N.default.types.size16,A=function(e){function t(){var e,n,i,a;o()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={isEmpty:!1,isFocus:!1},i.handleInputChange=function(){if(!i.isChineseInputting){var e=i.refInput.current.value;!!i.props.data?i.customChange(e):i.defaultChange(e)}},i.keyword="",i.defaultChange=Object(v.debounce)((function(e){if(i.refInput.current){var t=i.getContentElement();if(t){var n=i.props,o=n.flexHeight,a=n.onChange,r=e.toLowerCase();o||(r?i.keyword||(t.style.height=t.offsetHeight+"px"):t.style.height="");for(var s=[],l=t.querySelectorAll(".component-menu-item"),c=void 0,u=0;u<l.length;u++){var d=l[u],_=d.innerText.trim(),E=-1!==_.toLowerCase().indexOf(r),h="";E?(s.push(_),Object(f.removeClass)(d,"disabled")):(Object(f.addClass)(d,"disabled"),h="none"),d.style.display=h,!c&&E&&(c=d)}if(i.setState({isEmpty:!s.length}),r&&c)Object(f.addHoverItem)(c);else{var O=t.querySelector(".component-menu-item.hover");O&&Object(f.removeHoverItem)(O)}i.keyword=e,a(e,s)}else console.error("搜索框必须在panel/panel-header内才支持搜索")}}),100),i.customChange=Object(v.debounce)((function(e){var t=Object(C.search)(e,i.props.data);i.setState({isEmpty:!t.length}),i.props.onChange(e,t)}),100),i.isChineseInputting=!1,i.handleCompositionStart=function(){i.isChineseInputting=!0},i.handleCompositionEnd=function(){i.isChineseInputting=!1,i.handleInputChange()},i.handleFocus=function(){i.setState({isFocus:!0})},i.handleBlur=function(){i.setState({isFocus:!1})},i.refDiv=_.a.createRef(),i.refInput=_.a.createRef(),a=n,l()(i,a)}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.focus()}},{key:"focus",value:function(){this.refInput.current.focus()}},{key:"getContentElement",value:function(){return this.refDiv.current.parentElement}},{key:"render",value:function(){var e=this.state,t=e.isEmpty,n=e.isFocus,i=Object(d.classNames)({"component-menu-search":1,focus:n});return _.a.createElement("div",{className:"menu-search",ref:this.refDiv},_.a.createElement("div",{className:i},_.a.createElement(N.default,{type:T.menu_search}),_.a.createElement("input",{ref:this.refInput,type:"text",maxLength:500,"data-keep-wsad":!0,placeholder:this.props.placeholder,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onChange:this.handleInputChange,onFocus:this.handleFocus,onBlur:this.handleBlur})),t&&_.a.createElement("div",{className:"component-menu-empty"},_.a.createElement("div",{className:"empty-content"},_i18n("applications.public.components.general.Menu.MenuSearch.empty", "No search results yet"))))}}]),t}(d.PureComponent);A.defaultProps={placeholder:_i18n("applications.public.components.general.Menu.MenuSearch.placeholder", "Search worksheet"),onChange:function(){}};var I=A,S=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isEmpty:!1,height:null},n.setPanelHeight=function(){var e=n.props,t=e.showSearch,i=e.autoHeight;if(Object(f.checkCanSetSize)(t,i)){var o=n.refPanel.current.offsetHeight;n.setState({height:o})}},n.scrollSelectedChildren=function(){var e=n.refContent.current;if(e)for(var t=0;t<e.childElementCount;t++){var i=e.children[t];if(i.classList.contains("selected")){i.scrollIntoViewIfNeeded();break}}},n.handleSearch=function(e,t){var i=n.props.onSearch,o=void 0===i?function(){}:i;n.setState({isEmpty:!t.length}),o(e,t),n.setPreSelectItem(!0,null)},n.focus=function(){n.props.showSearch&&n.refSearch.current&&!O.isPad?n.refSearch.current.focus():n.refPanel.current.focus()},n.getStyle=function(){var e=n.props,t=e.showSearch,i=e.autoHeight,o=n.state.height;if(Object(f.checkCanSetSize)(t,i))return{height:o}},n.refPanel=_.a.createRef(),n.refSearch=_.a.createRef(),n.refContent=_.a.createRef(),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.officeType=Object(h.getPageOfficeType)(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.refPanel.current&&(e.focus(),e.scrollSelectedChildren(),e.setPanelHeight())}),10)}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"handleKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus)switch(e.keyCode){case 13:var i=this.getHoverItem();i&&(Object(h.stopBubble)(e),i.click());break;case 38:case 40:var o=38===e.keyCode;this.setPreSelectItem(o,e);break;case 9:case 39:var a=this.getHoverItem();if(a){Object(h.stopBubble)(e);var r={visible:!0,element:a,parent:this.refPanel.current};E.default.dispatchEvent(E.default.names.SUB_MENU_VISIBLE_CHANGE,r)}break;case 37:Object(h.stopBubble)(e),this.props.onLeftArrow&&this.props.onLeftArrow()}}}},{key:"handleMouseMove",value:function(e){var t=this.refPanel.current;if(!t.contains(document.activeElement)&&t.contains(e.target)&&t.focus(),this.props.onItemHover){var n=this.getHoverItem();this.props.onItemHover(n,t)}window.__WPSENV__.altStatus&&E.default.dispatchEvent(E.default.names.EXIT_ALT_MODE,e)}},{key:"handleMouseOut",value:function(){if(this.props.onItemHover){var e=this.getHoverItem();this.props.onItemHover(e,this.refPanel.current)}}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("component-menu-item");if(n.length){Object(h.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);if(o.classList.add("hover"),o.scrollIntoViewIfNeeded(),i!==o){var a={visible:!1,element:i,parent:this.refPanel.current};E.default.dispatchEvent(E.default.names.SUB_MENU_VISIBLE_CHANGE,a)}this.props.onItemHover&&this.props.onItemHover(o,this.refPanel.current)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var a=i-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){i=a;break}}else for(var r=i+1;r<t.length;r++)if(-1===t[r].className.indexOf("disabled")){i=r;break}return t[Math.max(0,i)]}},{key:"preSelectFirst",value:function(){this.setPreSelectItem(!0,null),this.refPanel.current.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.isAuto,i=e.children,o=e.onScroll,a=e.onMouseEnter,r=e.showSearch,s=e.data,l=this.state.isEmpty,c=Object(d.classNames)({"component-menu":1,"show-empty":l});n&&(c+=" "+this.officeType),t&&(c+=" "+t);var u=this.getStyle();return _.a.createElement("div",{ref:this.refPanel,className:c,tabIndex:0,style:u,onKeyDown:this.handleKeyDown,onScroll:o,onMouseMove:this.handleMouseMove,onMouseEnter:a,onMouseOut:this.handleMouseOut},r&&_.a.createElement(I,{ref:this.refSearch,data:s,onChange:this.handleSearch}),_.a.createElement("div",{ref:this.refContent,className:"menu-content"},i))}}]),t}(d.PureComponent);S.Divider=p.default,S.Item=m.default,S.Search=I,S.defaultProps={isAuto:!0,enabledHotKey:!0};t.default=S},543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkCanSetSize=t.removeHoverItem=t.addHoverItem=t.removeClass=t.addClass=void 0;var i=null;t.addClass=function(e,t){e.classList.add(t)};t.removeClass=function(e,t){e.classList.remove(t)};t.addHoverItem=function(e){i!==e&&(i&&(0,t.removeClass)(i,"hover"),i=e,(0,t.addClass)(e,"hover"))};t.removeHoverItem=function(e){i===e&&((0,t.removeClass)(i,"hover"),i=null)};t.checkCanSetSize=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),e&&!t}},560:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PublicCustomEvents=t.DOCCustomEvents=void 0;var o=n(238),a=n(260);Object.defineProperty(t,"DOCCustomEvents",{enumerable:!0,get:function(){return i(a).default}});var r=n(227);Object.defineProperty(t,"PublicCustomEvents",{enumerable:!0,get:function(){return i(r).default}}),t.default=function(e,t,n,i){var a=(0,o.useRef)(t);a.current=t;var r,s="boolean"==typeof(r=i)?r+"":r?"capture: ".concat(r.capture," once: ").concat(r.once," passive: ").concat(r.passive," signal: ").concat(r.signal):"",l="function"==typeof n?n():n||window;(0,o.useEffect)((function(){var t=e&&l&&"function"==typeof l.addEventListener,n=function(e){var t=a.current.handleEvent||a.current;"function"==typeof t&&t(e)};return t&&l.addEventListener(e,n,i),function(){t&&l.removeEventListener(e,n,i)}}),[e,l,s])}},565:function(e,t,n){"use strict";n.r(t);var i=n(13),o=n.n(i),a=n(24),r=n.n(a),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(22),_=n.n(d),E=n(23),h=n.n(E),f=n(238),O=n.n(f),p=n(240),m=n(250),N=n.n(m),v=function(e){function t(e){l()(this,t);var n=_()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=O.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return h()(t,e),u()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(p.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,o=e.children,a="panel-item",s=this.refDiv.current;s&&-1!==s.className.indexOf(" hover")&&(a+=" hover"),t&&(a+=" disabled"),n&&(a+=" selected");var l=void 0===o?"undefined":r()(o);return"string"!==l&&"number"!==l||(a+=" only-text"),i&&(a+=" "+i),a}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,a=e.children,r=e.getStyle,s=e.visible,l=e.dataKey,c=e.keepEdit,u=e.draggable,d=e.onMouseEnter,_=e.onMouseLeave,E=e.onDragEnter,h=e.onDragStart,f=e.onDragEnd,p=e.altHintKeep,m=e.altRole;if(!s)return!1;var v=this.getClassName(),C=r?r(i):null,T={};return d&&(T.onMouseEnter=d),_&&(T.onMouseLeave=_),O.a.createElement(N.a,o()({title:n},T),O.a.createElement("div",o()({ref:this.refDiv,id:t,className:v,style:C,role:m,"data-key":l||void 0,"data-keep-edit":c||void 0,"alt-hint-keep":p,draggable:u,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:h,onDragEnter:E,onDragEnd:f},T),a))}}]),t}(f.PureComponent);v.defaultProps={visible:!0,altRole:"option"},t.default=v},600:function(e,t,n){"use strict";n.r(t),n.d(t,"findIndex",(function(){return i.a})),n.d(t,"find",(function(){return r})),n.d(t,"each",(function(){return s.a})),n.d(t,"sortBy",(function(){return d})),n.d(t,"groupBy",(function(){return _})),n.d(t,"throttle",(function(){return E.a})),n.d(t,"debounce",(function(){return h.debounce})),n.d(t,"debounceFrame",(function(){return f})),n.d(t,"getType",(function(){return o.a})),n.d(t,"memoize",(function(){return p}));var i=n(405),o=n(289),a=n(308),r=function(e,t){if(Object(o.a)(e)!=a.a.arrayTag)throw new TypeError(a.b.ARRAY_ERROR_TEXT);var n=Object(i.a)(e,t);return n>-1?e[n]:void 0},s=n(406),l=n(8),c=n.n(l),u=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,r=e==e,s=Object(o.a)(e)===a.a.symbolTag,l=void 0!==t,c=null===t,u=t==t,d=Object(o.a)(e)===a.a.symbolTag;if(!c&&!d&&!s&&e>t||s&&l&&u&&!c&&!d||i&&l&&u||!n&&u||!r)return 1;if(!i&&!s&&!d&&e<t||d&&n&&r&&!i&&!s||c&&n&&r||!l&&r||!u)return-1}return 0},d=function(e){var t=Object(o.a)(e);if(!e||t===a.a.stringTag||t===a.a.numberTag)return[];if(t===a.a.arrayTag&&e.length<=1||t===a.a.objectTag&&Object.keys(e).length<=1)return e;for(var n=Array.prototype.slice.call(arguments,1),i=-1,r=n.length,s=[];++i<r;){var l=n[i],d=Object(o.a)(l);d===a.a.stringTag||d===a.a.funcTag?s.push(l):d===a.a.arrayTag&&s.push.apply(s,c()(l))}return 0===s.length&&s.push((function(e){return e})),(e=(e=t===a.a.objectTag?Object.values(e):e).map((function(e,t){var n=s.map((function(t){return Object(o.a)(t)===a.a.funcTag?t(e):e&&void 0!==e[t]?e[t]:e}));return e&&e.value?{index:t,value:e.value,filter:n}:{index:t,value:e,filter:n}}))).sort((function(e,t){for(var n=-1,i=s.length;++n<i;){var o=u(e.filter[n],t.filter[n]);if(o)return o}return e.index-t.index})),e.map((function(e){return e.value}))},_=function(e,t){if(null==e||!t)return{};var n={};return Object(s.a)(e,(function(e){var i=void 0,r=Object(o.a)(t);if(r===a.a.stringTag?i=e[t]:r===a.a.funcTag&&(i=t(e)),void 0!==i){var s=n[i];n[i]=s?[].concat(c()(s),[e]):[e]}})),n},E=n(448),h=n(81),f=function(e,t){if(Object(o.a)(e)!=a.a.funcTag)throw new TypeError(a.b.FUNC_ERROR_TEXT);t=Number(t)||0;var n=void 0,i=void 0,r=void 0,s=void 0;function l(){n&&cancelAnimationFrame(n),performance.now()-i>=t?e.apply(r,s):n=requestAnimationFrame(l)}return function(){s=Array.prototype.slice.call(arguments),r=this,i=performance.now(),n=requestAnimationFrame(l)}};function O(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];var r=t?t.apply(this,o):o[0],s=n.cache;if(s.has(r))return s.get(r);var l=e.apply(this,o);return l&&l.then?l.then((function(e){return n.cache=s.set(r,e)||s,e})):(n.cache=s.set(r,l)||s,l)};return n.cache=new(O.Cache||Map),n}O.Cache=Map;var p=O},608:function(e,t,n){"use strict";var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(432),n(238)),_=n.n(d),E=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){return _.a.createElement("div",{className:"divider-line"})}}]),t}(d.PureComponent);t.a=E},628:function(e,t,n){"use strict";n.r(t),n.d(t,"getPositionStyle",(function(){return r})),n.d(t,"showFullPanel",(function(){return s})),n.d(t,"getHeight",(function(){return l})),n.d(t,"getShowOrigin",(function(){return c})),n.d(t,"inTriggerElement",(function(){return u}));var i=n(13),o=n.n(i),a=n(428);var r=function(e,t,n,i){n=function(e){var t=o()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var r=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case a.default.topCenter:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body.clientHeight,r=t.left+t.width/2-i/2,s=t.top-n,l=a-t.bottom-n,c=t.top-n-o,u=t.bottom+n;return{left:r,top:s>=o?c:l>=o?u:s>=50||s>=l?c:u}}(t,n,i);break;case a.default.topRight:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-i,d=t.left,_=void 0;_=l>=i?u:c>=i?d:l>=50||l>=c?u:d;var E=s-t.bottom-n,h=t.top-n,f=t.bottom+n,O=t.top-n-o;return{left:_,top:h>=o?O:E>=o||E>=50||E>=h?f:O}}(t,n,i);break;case a.default.topLeft:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-i,d=t.left,_=void 0;_=c>=i?d:l>=i||l>=50||l>=c?u:d;var E=s-t.bottom-n,h=t.top-n,f=t.bottom+n,O=t.top-n-o;return{left:_,top:h>=o?O:E>=o||E>=50||E>=h?f:O}}(t,n,i);break;case a.default.bottomLeft:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.left,c=t.right,u=t.left,d=t.right-i,_=void 0;_=l>=i?u:c>=i?d:l>=50||l>=c?u:d;var E=s-t.bottom-n,h=t.top-n,f=t.bottom+n,O=t.top-n-o;return{left:_,top:E>=o?f:h>=o?O:E>=50||E>=h?f:O}}(t,n,i);break;case a.default.bottomRight:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-i,d=t.left,_=void 0;_=l>=i?u:c>=i?d:l>=50||l>=c?u:d;var E=s-t.bottom-n,h=t.top-n,f=t.bottom+n,O=t.top-n-o;return{left:_,top:E>=o?f:h>=o?O:E>=50||E>=h?f:O}}(t,n,i);break;case a.default.rightBottom:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,_=void 0;_=l>=i?u:c>=i?d:l>=50||l>=c?u:d;var E=s-t.top,h=t.bottom,f=t.top,O=t.bottom-o;return{left:_,top:E>=o?f:h>=o?O:E>=50||E>=h?f:O}}(t,n,i);break;case a.default.leftBottom:r=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,_=void 0;_=c>=i?d:l>=i||l>=50||l>=c?u:d;var E=s-t.top,h=t.bottom,f=t.top,O=t.bottom-o;return{left:_,top:E>=o?f:h>=o?O:E>=50||E>=h?f:O}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(r.right=document.body.clientWidth-r.left-t.offsetWidth,delete r.left),r},s=function(e,t){var n=e.left,i=e.right,o=e.top,a=t.offsetWidth,r=t.offsetHeight,s=document.body,l=s.clientWidth,c=s.clientHeight;return window.rightToLeft?(i+a+4>l&&(i=l-a-4),i=Math.max(4,i)):(n+a+4>l&&(n=l-a-4),n=Math.max(4,n)),o+r+4>c&&(o=c-r-4),o=Math.max(4,o),window.rightToLeft?{right:i,top:o}:{left:n,top:o}},l=function(e,t,n){var i=document.body.clientHeight,o=i-e-n;return e<0&&(o=i-2*n),t.offsetHeight<o?void 0:o},c=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var o=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(o>=n.top+n.height/2?"bottom":"top")},u=function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,o=i.pageX,a=i.pageY;return o>=n.left&&o<=n.right&&a>=n.top&&a<=n.bottom}return!1}},6452:function(e,t,n){"use strict";n.r(t),n.d(t,"changeCommentDialogVisible",(function(){return o})),n.d(t,"setCommentDialogData",(function(){return a})),n.d(t,"setCommentDialogLeft",(function(){return r})),n.d(t,"preCreateComment",(function(){return s})),n.d(t,"postComments",(function(){return l})),n.d(t,"sendCommentNotification",(function(){return c})),n.d(t,"updateLastReviewTime",(function(){return u}));var i=n(783),o=function(e,t){return function(n){n({type:i.a.COMMENT_DIALOG_VISIBLE,visible:e,focus:t})}},a=function(e){return function(t){t({type:i.a.SETCOMMENT_DIALOG_DATA,data:e})}},r=function(e){return function(t){t({type:i.a.SETCOMMENT_DIALOG_LEFT,data:e})}},s=function(e){var t=e.fileid;return{types:i.a.HTTP_TYPES,autoErrorToast:!1,ignoreNotLogin:!0,callAPI:function(e){return e.post("/api/v3/office/file/"+t+"/comment/precreate").end()}}},l=function(e){var t=e.fileid,n=e.file,o=e.duration,a=e.timeout,r=e.text,s=e.replyId,l=e.id;a=a||3e4;var c={type:"text"};return n&&(a=18e4,c.type="voice"),o&&(c.duration=o),r&&(c.text=r),s&&(c.p_comment_id=s),l&&(c.cid=l),{types:i.a.HTTP_TYPES,autoErrorToast:!1,callAPI:function(e){var i=e.post("/api/v3/office/file/"+t+"/comment");return n&&i.attach("file",n),i.fields(c),i.timeout(a).end()}}},c=function(e){var t=e.isNew,n=e.data,o=t?"new_comment":"reply_comment";return{types:i.a.HTTP_TYPES,autoErrorToast:!1,callAPI:function(e){return e.post("/api/kdocs/notification/"+window.urlFileId+"/normal/"+o).send(n).end()}}},u=function(e){return{types:i.a.HTTP_TYPES,autoErrorToast:!1,ignoreNotLogin:!0,callAPI:function(t){return t.put("/api/v3/office/file/"+e+"/comment/log").end()}}}},650:function(e,t,n){},651:function(e,t,n){},676:function(e,t,n){"use strict";n.r(t),n.d(t,"createElementNS",(function(){return s})),n.d(t,"createElement",(function(){return l})),n.d(t,"assignStyle2",(function(){return u})),n.d(t,"hexToRgba",(function(){return d})),n.d(t,"getPrefix",(function(){return _})),n.d(t,"enableFinally",(function(){return h}));var i=n(24),o=n.n(i),a=n(144),r=n.n(a);function s(e){var t=document.createElementNS(e.namespaceURI,e.type);return c(e,t,!0)}function l(e){var t=document.createElement(e.type);return c(e,t)}var c=function(e,t,n){var i=e.style,a=e.id,s=e.classname,l=e.parent,c=e.text,u=e.isInsertBefore,d=void 0!==u&&u,_=e.attributes;if(t.attachTo=function(e){if(d){var n=e.children||[],i=r()(n,1)[0];if(i)return void e.insertBefore(t,i)}e.appendChild(t)},s&&(t.className=s),i)switch(void 0===i?"undefined":o()(i)){case"string":t.setAttribute("style",i);break;case"object":for(var E in i)i.hasOwnProperty(E)&&(t.style[E]=i[E])}if(a&&(t.id=a),l&&t.attachTo(l),c&&(t.innerText=c),_)for(var h in _)_.hasOwnProperty(h)&&t.setAttribute(h,_[h]);return n||s||a||console.error("为了方便定位问题，创建div时，必须在创建同时，声明classname或id"),t},u=function(e,t){for(var n in t)e.style.setProperty(n,t[n])},d=function(e){var t=void 0;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),"rgba("+[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t].join(",")+",1)";throw new Error("Bad Hex")},_=function(){var e=window.getComputedStyle(document.documentElement,"");return(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1]};function E(e){var t=function(t){return Promise.resolve(e()).then((function(){return t}))};return this.then((function(e){return t(e)}),(function(e){return t(Promise.reject(e))}))}function h(e){return e.finally||(e.finally=E),e}!function(e){Promise.prototype.finally=Promise.prototype.finally||E,HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),o=i.length,a=new Uint8Array(o),r=0;r<o;r++)a[r]=i.charCodeAt(r);e(new Blob([a],{type:t||"image/png"}))}});var t=e.Element.prototype;"function"!=typeof t.matches&&(t.matches=t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=0;t[n]&&t[n]!==this;)++n;return Boolean(t[n])}),"function"!=typeof t.closest&&(t.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})}(window)},773:function(e,t,n){},774:function(e,t,n){},775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.search=void 0;var i=n(5);t.search=function(e,t){if(!e)return t.map((function(e){return e.value}));for(var n=[],o=[],a=[],r=e.toLowerCase(),s=0;s<t.length;s++){var l=t[s],c=l.name.toLowerCase();if(c!==r){var u=c.indexOf(r);0===u?o.push(l.value):-1!==u&&a.push(l.value)}else n.push(l.value)}return i.__spreadArray(i.__spreadArray(i.__spreadArray([],n,!0),o,!0),a,!0)}},7796:function(e,t,n){"use strict";t.a={top:"top",left:"left",right:"right",bottom:"bottom",bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right"}},8210:function(e,t,n){e.exports=function(e,t){n.e(588).then(n.bind(null,5995)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8211:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={history:"history",cooper:"cooper",historyMerge:"historyMerge",font:"font",exportPdf:"exportPdf",exportImg:"exportImg",exportOfd:"exportOfd",bookmark:"bookmark",officialDocumentField:"officialDocumentField",comment:"comment",shape:"shape"}},8212:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDisconnectedToastMessage=void 0,t.getDisconnectedToastMessage=function(){return window.APP.isReadOnly()?_i18n("applications.writer.containers.offlineToastForReadonly", "Disconnected from the server, please check the network settings first."):_i18n("applications.writer.containers.offlineToast", "To disconnect from the server, in order to avoid loss of content after editing, please check the network settings first.")}},8213:function(e,t,n){},8214:function(e,t,n){},8215:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var i=n(4519),o=function(e){return{type:i.a.SWITCH_WEB_MODE,data:{isWebMode:e}}},a=function(e){return{type:i.a.SWITCH_FILE_NAME,data:{isVisible:e}}}},8216:function(e,t,n){e.exports=function(e,t){n.e(841).then(n.bind(null,10894)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8217:function(e,t,n){"use strict";var i=n(144),o=n.n(i),a=n(238),r=n.n(a),s=n(247),l=n(8218),c=n.n(l),u=n(560),d=n.n(u),_=n(167);t.a=r.a.memo((function(e){var t=e.openSuccess,n=e.viewChanging,i=Object(a.useState)(!0),r=o()(i,2),l=r[0],E=r[1];return d()(u.DOCCustomEvents.cooperation.ON_AVATAR_VISIBLE_CHANGE,(function(e){E(e.detail.visible)})),!t||n||_.isMobile&&window.APP.isPaginationMode()?null:Object(s.default)(c.a,{avatarVisible:l})}))},8218:function(e,t,n){e.exports=function(e,t){n.e(843).then(n.bind(null,10911)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8219:function(e,t,n){e.exports=function(e,t){n.e(861).then(n.bind(null,10921)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8220:function(e,t,n){},858:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(238),_=n.n(d),E=n(227),h=n(240),f=n(571),O=n(351),p=n(514),m=O.default.triggerTypes,N=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.isUnmount=!1,n.preSelectFirst=!1,n.delayShowSubMenuTimer=null,n.isMouseOut=!1,n.refDiv=_.a.createRef(),n.refMenu=_.a.createRef(),n.refDropDownBtn=_.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.onMouseLeaveDropBtn=n.onMouseLeaveDropBtn.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleSubMenuVisible=n.handleSubMenuVisible.bind(n),n.handleSubMenuLeftArrow=n.handleSubMenuLeftArrow.bind(n),n.startDelayVisibleChange=n.startDelayVisibleChange.bind(n),n.clearDelayShowSubMenu=n.clearDelayShowSubMenu.bind(n),n.onMouseEnterMenu=n.onMouseEnterMenu.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(E.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.addEventListener(E.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.removeEventListener(E.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.removeEventListener(E.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"handleSubMenuVisible",value:function(e){var t=e.detail,n=t.visible,i=t.element,o=t.parent;i===this.refDiv.current&&(n?(this.isMouseOut=!1,this.state.visible?this.refMenu.current.preSelectFirst():(this.preSelectFirst=!0,this.parentNode=o,this.refDiv.current.click())):this.state.visible&&(this.setState({visible:!1}),this.parentNode&&this.parentNode.focus()))}},{key:"startDelayVisibleChange",value:function(e){var t=this;e?(E.default.dispatchEvent(E.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.delayShowSubMenuTimer=setTimeout((function(){t.handleVisibleChange(!0)}),250)):this.handleVisibleChange(!1)}},{key:"clearDelayShowSubMenu",value:function(){clearTimeout(this.delayShowSubMenuTimer)}},{key:"handleVisibleChange",value:function(e){var t=this;if(!this.isUnmount){if(!e&&this.state.visible){var n=Object(f.a)(this.refDiv.current);if(Object(f.b)(n+2))return;this.props.onItemHover&&this.props.onItemHover(null,null)}this.setState({visible:e},(function(){e&&t.preSelectFirst&&(t.preSelectFirst=!1,t.refMenu.current.preSelectFirst()),e||t.isMouseOut&&t.refDiv.current.classList.remove("hover"),t.props.onVisibleChange&&t.props.onVisibleChange(e)}))}}},{key:"handleMouseMove",value:function(){this.isMouseOut=!1,this.activateSubMenuHover()}},{key:"onMouseLeaveDropBtn",value:function(){this.clearDelayShowSubMenu()}},{key:"activateSubMenuHover",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"onMouseEnterMenu",value:function(){E.default.dispatchEvent(E.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.activateSubMenuHover()}},{key:"handleMouseOut",value:function(e){this.isMouseOut=!0,this.state.visible||Object(h.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"handleSubMenuLeftArrow",value:function(){var e=this;this.props.onItemHover&&this.props.onItemHover(null,null),this.setState({visible:!1},(function(){e.refDiv.current.focus()}))}},{key:"getClassName",value:function(){var e=this.props,t=e.visible,n=e.selected,i=e.disabled,o=e.className,a="component-menu-item sub-menu-item";o&&(a+=" "+o);var r=this.refDiv.current;return(t||r&&-1!==r.className.indexOf(" hover"))&&(a+=" hover"),n&&(a+=" selected"),this.state.visible&&(a+=" sub-visible"),i&&(a+=" disabled"),a}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.subClassName,o=e.destroyOnHide,a=e.trigger,r=e.onItemHover,s=e.showScrollBar,l=e.offsetX,c=e.disableContentMouseLeave,u=e.placement,d=e.enabledHotKey,E=e.altHintKeep,h=e.altForceDirection,f=e.altRole,m=this.state.visible,N=this.getClassName(),v=_.a.createElement(p.default,{ref:this.refMenu,className:i,showScrollBar:s,onItemHover:r,onMouseEnter:this.onMouseEnterMenu,onLeftArrow:this.handleSubMenuLeftArrow,enabledHotKey:d},t);return _.a.createElement(O.default,{isAuto:!0,panel:v,visible:m,distance:0,offsetX:l,trigger:a,destroyOnHide:o,onVisibleChange:this.startDelayVisibleChange,onMouseLeaveDropBtn:this.onMouseLeaveDropBtn,placement:u,disableContentMouseLeave:c,ref:this.refDropDownBtn},_.a.createElement("div",{ref:this.refDiv,className:N,tabIndex:0,role:f,"alt-hint-keep":E||"true","alt-force-direction":h,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut},n))}}]),t}(d.PureComponent);N.triggerTypes=m,N.defaultProps={trigger:m.hover,offsetX:8,placement:O.default.placementTypes.rightBottom,altRole:"option"},t.default=N},961:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(238),_=n.n(d),E=n(319),h=n(510),f=n(514),O=n(858),p=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.position,i=e.size,o=e.visible,a=e.onClose,r=e.destroyOnHide,s=i.width,l=i.height,c={left:n.x,right:n.x+s,top:n.y,bottom:n.y+l,width:s,height:l};return _.a.createElement(E.default,{visible:o,destroyOnHide:r},_.a.createElement(h.a,{isAuto:!0,visible:o,rect:c,distance:0,onClose:a},t))}}]),t}(d.PureComponent);p.Menu=f.default,p.SubMenu=O.default,p.defaultProps={visible:!0,size:{width:0,height:0}},t.default=p},984:function(e,t,n){"use strict";n.r(t),n.d(t,"setStatus",(function(){return s})),n.d(t,"getStatus",(function(){return l})),n.d(t,"deleteStatus",(function(){return c})),n.d(t,"clearExpireItems",(function(){return u})),n.d(t,"types",(function(){return o}));var i=n(2698),o={DOCMAP:"DOCMAP",TYPOMODE:"TYPOMODE",INK_SCROLL_TIPS:"INK_SCROLL_TIPS",SPELLCHECKAUTOOPEN:"SPELLCHECKAUTOOPEN",SPELLCHECKIGNOREWORDS:"SPELLCHECKIGNOREWORDS",SPELLCHECKREPLACEWORDS:"SPELLCHECKREPLACEWORDS",FONTCOLOR:"FONTCOLOR",HIGHLIGHTCOLOR:"HIGHLIGHTCOLOR",SHOW_COMMENT:"SHOW_COMMENT",READING_MODE_FONT_SIZE:"READING_MODE_FONT_SIZE",READING_MODE_LINE_SPACING:"READING_MODE_LINE_SPACING",TASK_PANEL_OPENED:"TASK_PANEL_OPENED",OFFICIAL_DOCUMENT_FIELD_DELETE_OPTION:"OFFICIAL_DOCUMENT_FIELD_DELETE_OPTION",KEYBOARD_ACTIVE_NOTICE:"KEYBOARD_ACTIVE_NOTICE",STORE_GCP:"STORE_GCP",STORE_GCP_SWITCH:"STORE_GCP_SWITCH",REVISION_VIEW:"REVISION_VIEW",REVISION_SHOW_MARK:"REVISION_SHOW_MARK",REVISION_SHOW_FRAME:"REVISION_FRAME",REVISION_MODE:"REVISION_MODE",NOT_SHOW_DASHED_BORDER:"NOT_SHOW_DASHED_BORDER",MISSING_FONT_ALERT_HIDDEN:"MISSING_FONT_ALERT_HIDDEN"},a=function(e,t){return t||(new Date).getTime()+(e?12096e5:94608e7)},r=function(e,t){return"w-st-"+e+(t?"-"+Object(i.a)():"")},s=function(e,t,n,i){window.localStorage.setItem(r(e,n),JSON.stringify({value:void 0!==t&&t,expire:a(n,i)}))},l=function(e,t){var n=window.localStorage.getItem(r(e,t));if(n){var i=JSON.parse(n),o=i.value,a=i.expire,s=(new Date).getTime();if(a&&a>s)return o}return null},c=function(e,t){var n=r(e,t);n in window.localStorage&&window.localStorage.removeItem(n)},u=function(){var e=(new Date).getTime(),t=[];for(var n in window.localStorage)0===n.indexOf("w-st")&&(JSON.parse(window.localStorage.getItem(n)).expire||0)<e&&t.push(n);return t.forEach((function(e){window.localStorage.removeItem(e)})),!0}}}]);