(window.webpackJsonp=window.webpackJsonp||[]).push([[801],{1007:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("screen_full",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M9.75 1.75H12.75C13.5784 1.75 14.25 2.42157 14.25 3.25V6.25M6.25 14.25H3.25C2.42157 14.25 1.75 13.5784 1.75 12.75V9.75M6.25 1.75L3.25 1.75C2.84064 1.75 2.46958 1.91398 2.19893 2.17984M1.75 6.25L1.75 3.25C1.75 2.83093 1.92185 2.452 2.19893 2.17984M2.19893 2.17984L6 6M14.25 9.75V12.75C14.25 13.1642 14.0821 13.5392 13.8107 13.8107M9.75 14.25H12.75C13.1642 14.25 13.5392 14.0821 13.8107 13.8107M13.8107 13.8107L10 10",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},10073:function(e,t,n){"use strict";var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(9267),n(238)),h=n.n(d),p=n(227),f=n(243),m=n.n(f),v=n(1940),w=n(1941),g=n(1939),b=n(1938),y={normal:{icon:h.a.createElement(v.a,null),tips:_i18n("applications.public.components.commandbars.NetworkStatus.normal", "Good Network Condition")},slow:{icon:h.a.createElement(b.a,{fill:"var(--kd-color-icon-secondary)"}),tips:_i18n("applications.public.components.commandbars.NetworkStatus.slow", "Network speed delay {0} ms")},disconnected:{icon:h.a.createElement(w.a,null),tips:_i18n("applications.public.components.commandbars.NetworkStatus.disconnected", "Network disconnected. Check the network configuration")},offLine:{icon:h.a.createElement(g.a,null),tips:_i18n("applications.public.components.commandbars.NetworkStatus.offline", "Network disconnected. Check the network configuration")}},E=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={offLine:!1,speed:0},n.handleOffline=n.handleOffline.bind(n),n.handleOnline=n.handleOnline.bind(n),n.handleNetworkSpeedChange=n.handleNetworkSpeedChange.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(p.default.names.network.ON_NETWORK_SPEED_CHANGE,this.handleNetworkSpeedChange),window.addEventListener("offline",this.handleOffline),window.addEventListener("online",this.handleOnline)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(p.default.names.network.ON_NETWORK_SPEED_CHANGE,this.handleNetworkSpeedChange),window.removeEventListener("offline",this.handleOffline),window.removeEventListener("online",this.handleOnline)}},{key:"handleNetworkSpeedChange",value:function(e){this.setState({speed:e.detail})}},{key:"handleOffline",value:function(){console.log("已断网"),this.setState({offLine:!0})}},{key:"handleOnline",value:function(){console.log("已联网"),this.setState({offLine:!1})}},{key:"render",value:function(){var e=this.props,t=e.connected,n=e.className,o=this.state,i=o.offLine,a=o.speed,r=y.normal;t?i?r=y.offLine:a>500&&(r=y.slow):r=y.disconnected;var s=r.tips.replace("{0}",a);return h.a.createElement(m.a,{disabled:r===y.disconnected,className:n,size:f.Size.medium,icon:r.icon,title:s})}}]),t}(d.PureComponent);t.a=E},1060:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("screen_full_exit",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M9.75 1.75H12.75C13.5784 1.75 14.25 2.42157 14.25 3.25V6.25M6.25 14.25H3.25C2.42157 14.25 1.75 13.5784 1.75 12.75V9.75M1.75 6.25L4.75 6.25C5.15936 6.25 5.53042 6.08602 5.80107 5.82016M6.25 1.75L6.25 4.75C6.25 5.16907 6.07815 5.548 5.80107 5.82016M5.80107 5.82016L2 2M9.75 14.25V11.25C9.75 10.8358 9.91789 10.4608 10.1893 10.1893M14.25 9.75L11.25 9.75C10.8358 9.75 10.4608 9.91789 10.1893 10.1893M10.1893 10.1893L14 14",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1228:function(e,t,n){"use strict";n.r(t);var o=n(289),i=n(308);t.default=function(e,t){if(Object(o.a)(e)!=i.a.funcTag)throw new TypeError(i.b.FUNC_ERROR_TEXT);t=Number(t)||0;var n=void 0,a=void 0,r=void 0;function s(){n&&(clearTimeout(n),n=null)}function l(){s(),e.apply(a,r)}function c(){r=Array.prototype.slice.call(arguments),a=this,s(),n=setTimeout(l,t)}return c.cancel=s,c}},14024:function(e,t,n){},14025:function(e,t,n){e.exports=function(e,t){n.e(802).then(n.bind(null,16056)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},14026:function(e,t,n){},1425:function(e,t,n){"use strict";var o=n(13),i=n.n(o),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),h=n.n(d),p=(n(2021),n(238)),f=n.n(p),m=n(167),v=n(227),w=n(312),g=n(319),b=n(1289),y=w.default.iconTypes.size16,E=function(e){function t(){var e,n,o,i;r()(this,t);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return n=o=u()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={didMount:!1,left:void 0,right:void 0,top:void 0,bottom:void 0},o.handleCloseModal=function(){o.props.visible&&o.props.isExclusive&&o.props.onClose()},o.handleKeyDown=function(e){!o.props.visible||"Escape"!==e.code&&27!==e.keyCode||o.props.onClose(e)},o.handleWindowResize=function(e){var t=(e.detail||{}).isClosePanel;(void 0===t?null:t)||o.props.visible&&(m.isTouchScreen?o.forceUpdate():o.fullDisplay(!0))},o.handleTouchStart=function(e){1===e.touches.length&&o.handleDragModal(e,!0)},o.handleDragModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=o.refTitle.current,i=o.refContainer.current,a=e.target,r=a.tagName;if("TEXTAREA"!==r&&"INPUT"!==r&&"true"!==a.contentEditable&&i.contains(a)){var s=o.props.isAllDrag;if(s||(s=a.classList&&a.classList.contains("drag")),s||(s=!!n&&n.contains(e.target)),s){var l=o.props.retainSize,c=function(e,t){if(e&&o.setState(e),o.props.onDragMove){var n=!e;o.props.onDragMove(n,t)}};b.onDragMove(e,i,l,c,t)}}},o.refContainer=f.a.createRef(),o.refTitle=f.a.createRef(),i=n,u()(o,i)}return h()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),window.addEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal),this.props.visible&&this.firstShow()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.visible,o=t.position;if(n){var i=JSON.stringify(o)===JSON.stringify(e.position);n===e.visible&&i||(this.state.didMount&&i?this.fullDisplay():this.firstShow())}}},{key:"firstShow",value:function(){var e=this.props.position,t=this.refContainer.current,n=t.offsetWidth,o=t.offsetHeight,a=i()({},e);a.didMount=!0,e||(a.left="calc(50% - "+n/2+"px",a.top="calc(50% - "+o/2+"px"),this.setState(a,this.fullDisplay)}},{key:"fullDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.isExclusive&&(v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL),v.default.dispatchEvent(v.default.names.CLOSE_MODAL_DIALOG));var t=this.refContainer.current,n=this.state,o=n.left,i=n.right,a=n.top,r=n.bottom,s={left:o,right:i,top:a,bottom:r},l=b.fullDisplay(s,t,e?0:this.props.retainSize);this.setState(l,e?null:this.props.onShow)}},{key:"getClassName",value:function(){var e=this.props.className,t="component-non-modal animation-bounce-in drag";return this.state.didMount&&(t+=" did-mount"),e&&(t+=" "+e),t}},{key:"render",value:function(){if(!this.props.visible&&!this.state.didMount)return!1;var e=this.props,t=e.children,n=e.visible,o=e.title,i=e.options,a=e.showCloseBtn,r=this.props.onClose,s=this.state,l={left:s.left,top:s.top,right:s.right,bottom:s.bottom,width:s.width,height:s.height,minHeight:s.minHeight,minWidth:s.minWidth,maxHeight:s.maxHeight,maxWidth:s.maxWidth},c=this.getClassName();return f.a.createElement(g.default,{destroyOnHide:!1,visible:n},f.a.createElement("div",{ref:this.refContainer,className:c,tabIndex:"1",style:l,onTouchStart:this.handleTouchStart,onKeyDown:this.handleKeyDown,onMouseDown:this.handleDragModal},!!o&&f.a.createElement("div",{className:"non-modal-header drag"},f.a.createElement("div",{ref:this.refTitle,className:"title drag"},o),i,a&&f.a.createElement(w.default,{className:"close-btn",iconType:y.close,onClick:r})),f.a.createElement("div",{className:"non-modal-body"},t)))}},{key:"element",get:function(){return this.refContainer.current}}]),t}(p.PureComponent);E.defaultProps={visible:!0,showCloseBtn:!0,retainSize:30,isExclusive:!0,isAllDrag:!1},t.a=E},1550:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("doc_list_vertical",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M8.75 4.75H10.25M8.75 11.25H10.25M8.75 8H10.25",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"}),i.a.createElement("path",{d:"M5 4.75024C5 4.33603 5.33579 4.00024 5.75 4.00024C6.16421 4.00024 6.5 4.33603 6.5 4.75024C6.5 5.16446 6.16421 5.50024 5.75 5.50024C5.33579 5.50024 5 5.16446 5 4.75024Z",stroke:"none"}),i.a.createElement("path",{d:"M5 11.2502C5 10.836 5.33579 10.5002 5.75 10.5002C6.16421 10.5002 6.5 10.836 6.5 11.2502C6.5 11.6645 6.16421 12.0002 5.75 12.0002C5.33579 12.0002 5 11.6645 5 11.2502Z",stroke:"none"}),i.a.createElement("path",{d:"M5 8C5 7.58579 5.33579 7.25 5.75 7.25C6.16421 7.25 6.5 7.58579 6.5 8C6.5 8.41421 6.16421 8.75 5.75 8.75C5.33579 8.75 5 8.41421 5 8Z",stroke:"none"}),i.a.createElement("path",{d:"M2.75 3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H11.75C12.5784 1.75 13.25 2.42157 13.25 3.25V12.75C13.25 13.5784 12.5784 14.25 11.75 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25Z",fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1583:function(e,t,n){"use strict";var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(1142);var l=function(){function e(){i()(this,e),this._zoom=1}return r()(e,[{key:"single_reset",value:function(){}},{key:"zoom",get:function(){return this._zoom},set:function(e){this._zoom=e}},{key:"dpr",get:function(){return window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI||1}}],[{key:"getZoom",value:function(){return e.getInstance().zoom}},{key:"getDPR",value:function(){return e.getInstance().dpr}},{key:"setZoom",value:function(t){e.getInstance().zoom=t}}]),e}();t.a=l;s.a.buildInstance(l)},1602:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("screen_fit",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#3B64FC",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#3B64FC"},i.a.createElement("path",{d:"M5.75 6.25C5.75 5.97386 5.97386 5.75 6.25 5.75H9.75C10.0261 5.75 10.25 5.97386 10.25 6.25V9.75C10.25 10.0261 10.0261 10.25 9.75 10.25H6.25C5.97386 10.25 5.75 10.0261 5.75 9.75V6.25Z",fill:"none",vectorEffect:"non-scaling-stroke"})),i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M5.5 1.75H3.25C2.42157 1.75 1.75 2.42157 1.75 3.25V6M10.5 1.75H12.75C13.5784 1.75 14.25 2.42157 14.25 3.25V5.5M1.75 10.5V12.75C1.75 13.5784 2.42157 14.25 3.25 14.25H5.5M14.25 10.5V12.75C14.25 13.5784 13.5784 14.25 12.75 14.25H10.5",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1661:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("page_pagination",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M13.25 14.25V10.05C13.25 9.88431 13.1157 9.75 12.95 9.75H3.05C2.88431 9.75 2.75 9.88431 2.75 10.05V14.25M13.25 1.75V5.95C13.25 6.11569 13.1157 6.25 12.95 6.25H3.05C2.88431 6.25 2.75 6.11569 2.75 5.95V1.75",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},16787:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(14024),n(238)),h=n.n(d),p=n(258),f=n.n(p),m=n(5360),v=n(252),w=n.n(v),g=n(260),b=n(448),y=0,E=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateInfo=function(){window.APP.data.selection.selContext.isInComment()||n.setState(n.fetchState())},n.throttleUpdateInfo=Object(b.a)(n.updateInfo,500),n.fetchState=function(){var e=window.APP.data,t=e.wordStat,o=e.selection,i={hasWordData:!!t},a=window.APP.isPCMode();if(t){var r=o.selInfo.getWordCount()||0,s=t.wordCount;if(a){var l=o.selInfo.getCurrentWordInfo();if(l){var c=l.pageIndex,u=l.sectionIndex;i=Object.assign(i,{currentPageNum:c,currentSectionNum:u,currentColumn:o.end.colOfTextPage,currentRow:o.end.rowOfTextPage||n.state.currentRow,selectedWordNum:r,docTotalWordNum:s})}}else i=Object.assign(i,{selectedWordNum:r,docTotalWordNum:s})}return i},n.updatePageInfo=function(){if(Date.now()-y>=200){y=Date.now();var e=window.APP.isPCMode(),t=window.APP.data,o=t.typoinfo,i=t.doc;if(e){var a=o.stablePageCount,r=i.sections.length;a===n.state.docTotalPageAmount&&r===n.state.totalSectionAmount||n.setState({docTotalPageAmount:a,totalSectionAmount:r})}}},n.beforeViewportChanged=function(){n.unbindUpdateEvents()},n.afterViewportChanged=function(){n.updateInfo(),n.updatePageInfo(),n.bindUpdateEvents()},n.state={currentRow:1},n.updatePageInfo=n.updatePageInfo.bind(n),n}return u()(t,e),r()(t,[{key:"bindUpdateEvents",value:function(){window.addEventListener(g.default.names.DOC_TYPO_FINISHED,this.updatePageInfo),window.addEventListener(g.default.names.DOC_SELECTION_CHANGED,this.throttleUpdateInfo),window.addEventListener(g.default.names.DOC_WORKSPACE_SCROLL,this.throttleUpdateInfo)}},{key:"unbindUpdateEvents",value:function(){window.removeEventListener(g.default.names.DOC_TYPO_FINISHED,this.updatePageInfo),window.removeEventListener(g.default.names.DOC_SELECTION_CHANGED,this.throttleUpdateInfo),window.removeEventListener(g.default.names.DOC_WORKSPACE_SCROLL,this.throttleUpdateInfo)}},{key:"componentDidMount",value:function(){this.bindUpdateEvents(),window.addEventListener(g.default.document.ON_DOC_BEFORE_OPEN,this.beforeViewportChanged),window.addEventListener(g.default.document.ON_DOC_AFTER_OPEN,this.afterViewportChanged),window.addEventListener(g.default.view.BEFORE_VIEW_MODE_CHANGED,this.beforeViewportChanged),window.addEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,this.afterViewportChanged),this.throttleUpdateInfo(),this.updatePageInfo()}},{key:"componentWillUnmount",value:function(){this.unbindUpdateEvents(),window.removeEventListener(g.default.document.ON_DOC_BEFORE_OPEN,this.beforeViewportChanged),window.removeEventListener(g.default.document.ON_DOC_AFTER_OPEN,this.afterViewportChanged),window.removeEventListener(g.default.view.BEFORE_VIEW_MODE_CHANGED,this.beforeViewportChanged),window.removeEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,this.afterViewportChanged)}},{key:"render",value:function(){var e=this.state,t=e.currentPageNum,n=e.docTotalPageAmount,o=e.currentSectionNum,i=e.totalSectionAmount,a=e.currentRow,r=e.currentColumn,s=e.selectedWordNum,l=e.docTotalWordNum,c=e.hasWordData,u=this.props.className;if(!c)return null;var d=window.APP.isPCMode();return h.a.createElement("div",{className:"word-stat-info clearfix "+u},d&&h.a.createElement("div",{className:"items-group-left"},h.a.createElement("div",{className:"item page-number"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.pageNumberTitle", "Pages in the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.pageNumber", "Page:")," "+t))),h.a.createElement("div",{className:"item page-info"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.pageInfoTitle", "Number of pages in the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.pageInfo", "Page:")," "+t+"/"+n))),h.a.createElement("div",{className:"item section-info"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.sectionInfoTitle", "Section number of the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.sectionInfo", "Section:")," "+o+"/"+i))),h.a.createElement("div",{className:"divider"})),d&&h.a.createElement("div",{className:"items-group-left"},h.a.createElement("div",{className:"item row-num"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.rowNumTitle", "Row number of the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.rowNum", "Row:")," "+a))),h.a.createElement("div",{className:"item column-num"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.columnNumTitle", "Column number of the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.columnNum", "Column:")," "+r))),h.a.createElement("div",{className:"divider"})),h.a.createElement("div",{className:"items-group-left"},h.a.createElement("div",{className:"item row-num"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.wordNumTitle", "Word Count")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.wordNum", "Words:")," "+(0===s?"":s+"/")+l)))))}}]),t}(d.Component),C=n(82),k=n(167),_=n(1583),O=n(247),D=n(14025),M=n.n(D),P=n(10073),L=n(512),S=n(3825),N=n(3969),T=n(3823),x=n(4296),B=n.n(x),I=n(9268),W=n(9269),R=(n(14026),n(227)),A=n(248),j=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleNotice=n.handleNotice.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(R.default.names.NOTICE,this.handleNotice)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(R.default.names.NOTICE,this.handleNotice)}},{key:"handleNotice",value:function(e){var t=e.detail,n=t.type,o=t.btnText,i=t.onBtnClick,a=t.onIconClick,r=t.msg,s=t.duration,l=this.renderContent(r,o,i,a),c=s||5;"info"===n?window.Notice.info(l,c,window.Toast.defaultTop):"warn"===n?window.Notice.warn(l,c,window.Toast.defaultTop):window.Notice.close()}},{key:"renderContent",value:function(e,t,n,o){var i="component-copy-notice-wrap";t||(i+=" no-icon");return h.a.createElement("div",{className:i},h.a.createElement("div",{className:"msg"},e),t&&h.a.createElement("div",{className:"btn-wrap"},h.a.createElement("span",{onClick:function(){n&&n(),window.Notice.close()}},t),o&&h.a.createElement(A.default,{type:A.default.types.size16.notice_ok_normal,onClick:function(){o&&(o(),window.Notice.close())}})))}},{key:"render",value:function(){return!1}}]),t}(d.PureComponent),z=n(144),V=n.n(z);function H(e){var t=e.className,n=Object(d.useState)((function(){return window.APP.workspace.getCurrentPageIndex()})),o=V()(n,2),i=o[0],a=o[1],r=Object(d.useState)((function(){return window.APP.workspace.getPageAmount()})),s=V()(r,2),l=s[0],c=s[1];return Object(d.useEffect)((function(){var e=window.utils.Lodash.throttle((function(){a(window.APP.workspace.getCurrentPageIndex())}),300);function t(){c(window.APP.workspace.getPageAmount())}return window.addEventListener(g.default.preview.ON_PAGE_APPENDED,t),window.addEventListener(g.default.names.DOC_WORKSPACE_SCROLL,e),function(){window.removeEventListener(g.default.names.DOC_WORKSPACE_SCROLL,e),window.removeEventListener(g.default.preview.ON_PAGE_APPENDED,t)}}),[]),h.a.createElement("div",{className:"word-stat-info clearfix "+t},h.a.createElement("div",{className:"items-group-left"},h.a.createElement("div",{className:"item page-number"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.pageNumberTitle", "Pages in the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.pageNumber", "Page:")," "+i))),h.a.createElement("div",{className:"item page-info"},h.a.createElement(w.a,{title:_i18n("applications.writer.components.CommandBars.StatusBar.pageInfoTitle", "Number of pages in the document")},h.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.StatusBar.pageInfo", "Page:")," "+i+"/"+l)))))}var F=["200%","100%","75%","wide","textwide","page"],U=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={viewZoom:100,viewZoomVisible:!window.APP.isAdaptMode()},n.handleZoomChangeWrapper=function(e){var t=e.detail.zoom;if(0===t){var o=window.APP.workspace.getPageFitValue();n.refViewZoom.handlePanelIndexChange(o.pagew(),"pagew",!0)}else n.handleZoomChange(t)},n.refViewZoom=null,n.handleOnShow=n.handleOnShow.bind(n),n.handleBestScale=n.handleBestScale.bind(n),n.handleZoomChange=n.handleZoomChange.bind(n),n.handleViewZoomVisible=n.handleViewZoomVisible.bind(n),n.doTrack=n.doTrack.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){!window.__CONFIG__.wps.isBestScale||window.__CONFIG__.wps.isAdaptWebView&&window.APP.isWebMode()||this.handleBestScale(),window.addEventListener(g.default.zoom.DOC_SCALE,this.handleZoomChangeWrapper),window.addEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,this.handleViewZoomVisible)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(g.default.zoom.DOC_SCALE,this.handleZoomChangeWrapper),window.removeEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,this.handleViewZoomVisible)}},{key:"init",value:function(){var e=this.getViewZoom();this.setState({viewZoom:e})}},{key:"getViewZoom",value:function(){return 100*_.a.getZoom()}},{key:"setViewZoom",value:function(e){window.APP.isAdaptMode()||window.APP.workspace.scale(e/100)}},{key:"handleOnShow",value:function(){window.collection("zoomoption","value","scalemenu")}},{key:"handleBestScale",value:function(){window.collection("zoomoption","value","widequick");var e=window.APP.workspace.getPageFitValue();this.refViewZoom.handlePanelIndexChange(e.pagew(),"pagew",!0)}},{key:"handleZoomChange",value:function(e,t){var n=window.APP.workspace,o=n.config.zoom,i=performance.now(),a=document.activeElement,r=!1;if(a){var s=a.parentElement;s&&s.className&&-1!==s.className.indexOf("view-zoom-input")&&(r=!0)}n.waterdrop&&n.waterdrop._cursor.hideCursorForTheMoment(),this.setState({viewZoom:e}),this.setViewZoom(e),!0===r&&a.focus(),g.default.dispatchEvent(g.default.zoom.ON_SCALING_CHANGE,{scale:e}),k.isPad&&t&&"gesturechange"===t.type&&(e/100>o?window.collection("experience",{event:"reading_zoom_in",times:Math.round(performance.now()-i)}):window.collection("experience",{event:"reading_zoom_out",times:Math.round(performance.now()-i)}))}},{key:"handleViewZoomVisible",value:function(){this.setState({viewZoomVisible:!window.APP.isAdaptMode()})}},{key:"doTrack",value:function(e){window.collection("zoomoption","value",F[e-1])}},{key:"render",value:function(){var e=this,t=this.state,n=t.viewZoom,o=t.viewZoomVisible,i=this.props,a=i.dispatch,r=i.fileInfo,s=i.connected,l=i.readOnly,c=i.user,u=i.app,d=window.__CONFIG__.brandMarkConfig&&window.__CONFIG__.brandMarkConfig.text;return u.isPreview?h.a.createElement("div",{className:"w-status-bar-container"},h.a.createElement("div",{className:"cmd-status-bar clearfix preview"},h.a.createElement("div",{className:"left"},h.a.createElement(H,{className:"status-bar-item item-1"})),h.a.createElement("div",{className:"right"},h.a.createElement(m.a,{ref:function(t){return e.refViewZoom=t},officeType:C.default.writer,index:n,max:400,outMax:300,visible:o,onShow:this.handleOnShow,onBestScale:this.handleBestScale,onChange:this.handleZoomChange,doTrack:this.doTrack}),h.a.createElement(S.a,null)))):h.a.createElement("div",{className:f()("cmd-status-bar","clearfix",{hide:!window.__CONFIG__.wps.isShowBottomStatusBar})},h.a.createElement("div",{className:"left"},window.__CONFIG__.wps.isShowDocMap&&h.a.createElement("div",{className:"item"},h.a.createElement(I.a,{fill:["rgba(13, 13, 13, 0.66)"],readOnly:l,disabled:!s})),h.a.createElement("div",{className:"item"},h.a.createElement(W.a,{fill:["rgba(13, 13, 13, 0.66)"],disabled:!s||l||this.showTXTDocument||this.isEnhancedTemplate})),h.a.createElement(L.default,null),h.a.createElement(E,{className:"status-bar-item item-1"}),this.showTXTDocument&&!l&&h.a.createElement("div",{className:"divider dark"}),this.showTXTDocument&&Object(O.default)(M.a,{className:"status-bar-item item-2",dispatch:a,fileInfo:r,connected:s,readOnly:l})),h.a.createElement("div",{className:"right"},d&&Object(O.default)(B.a),h.a.createElement("div",{className:"network-wrapper"},h.a.createElement(P.a,{className:"network-status",connected:s})),h.a.createElement(L.default,null),h.a.createElement(m.a,{ref:function(t){return e.refViewZoom=t},officeType:C.default.writer,index:n,max:400,outMax:300,visible:o,onShow:this.handleOnShow,onBestScale:this.handleBestScale,onChange:this.handleZoomChange,doTrack:this.doTrack}),h.a.createElement(S.a,null),h.a.createElement(T.a,{dispatch:a,file:r,user:c})),h.a.createElement(N.default,null),h.a.createElement(j,null))}},{key:"showTXTDocument",get:function(){return window.APP.data.doc.isTXTDocument}},{key:"isEnhancedTemplate",get:function(){return window.APP.data.doc.isEnhancedTemplate}}]),t}(d.PureComponent);t.default=U},1717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconTypes=void 0;var o=n(5),i=o.__importDefault(n(238)),a=o.__importDefault(n(248));t.IconTypes=a.default.types,n(9272),t.default=function(e){var t=e.icon,n=e.text;return t||n?i.default.createElement("div",{className:"w-dropdown-menu-item-content inline-flex"},t,n&&i.default.createElement("span",{className:"text"},n)):null}},1749:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var o=n(238),i=n.n(o),a=n(262);n(2320);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function l(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,d(o.key),o)}}function d(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(d,e);var t,n,o,r=p(d);function d(){var e;return c(this,d),(e=r.apply(this,arguments)).prefixCls="kd-divider",e}return t=d,(n=[{key:"render",value:function(){var e,t=this.props,n=t.className,o=t.style,r=t.type,c=void 0===r?"horizontal":r,u=t.orientation,d=void 0===u?"center":u,h=t.orientationMargin,p=t.children,f=t.dashed,m=v(t,["className","style","type","orientation","orientationMargin","children","dashed"]),w=d?"-".concat(d):d,g=!!p,b="left"===d&&null!==h,y="right"===d&&null!==h,E=Object(a.a)(this.prefixCls,n,"".concat(this.prefixCls,"-").concat(c),(l(e={},"".concat(this.prefixCls,"-with-text"),g),l(e,"".concat(this.prefixCls,"-with-text").concat(w),g),l(e,"".concat(this.prefixCls,"-dashed"),!!f),l(e,"".concat(this.prefixCls,"-no-default-orientation-margin-left"),b),l(e,"".concat(this.prefixCls,"-no-default-orientation-margin-right"),y),e)),C=Object.assign(Object.assign({},b&&{marginLeft:h}),y&&{marginRight:h});return i.a.createElement("div",s({className:E},m,{role:"separator",style:o}),p&&i.a.createElement("span",{className:"".concat(this.prefixCls,"-inner-text"),style:C},p))}}])&&u(t.prototype,n),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component)},1938:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("earth",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M14.75 8C14.75 11.7279 11.7279 14.75 8 14.75C4.27208 14.75 1.25 11.7279 1.25 8M14.75 8C14.75 4.27208 11.7279 1.25 8 1.25C4.27208 1.25 1.25 4.27208 1.25 8M14.75 8H1.25M7.55844 1.32533C4.32517 5.15507 4.31164 10.7831 7.51786 14.6279M8.48214 1.32533C11.7154 5.15507 11.7289 10.7831 8.52272 14.6279",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1939:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("earth_cross",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},i.a.createElement("path",{d:"M8 14.75C4.27208 14.75 1.25 11.7279 1.25 8M1.25 8C1.25 4.27208 4.27208 1.25 8 1.25C11.7279 1.25 14.75 4.27208 14.75 8H10.9173M1.25 8H10.9173M7.55844 1.32533C4.32517 5.15507 4.04378 10.8552 7.25 14.7M8.48214 1.32533C10.1054 3.24803 10.9171 5.62399 10.9173 8M10.9173 8C10.9173 8.67005 10.8915 8.79004 10.7625 9.44993",fill:"none",vectorEffect:"non-scaling-stroke"})),i.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#D83C3C",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#D83C3C"},i.a.createElement("path",{d:"M11.2715 11.2573L14.2715 14.2573M14.2715 11.2573L11.2715 14.2573",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1940:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("earth_tick",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},i.a.createElement("path",{d:"M8 14.75C4.27208 14.75 1.25 11.7279 1.25 8M1.25 8C1.25 4.27208 4.27208 1.25 8 1.25C11.7279 1.25 14.75 4.27208 14.75 8H10.9173M1.25 8H10.9173M7.55844 1.32533C4.32517 5.15507 4.04378 10.8552 7.25 14.7M8.48214 1.32533C10.1054 3.24803 10.9171 5.62399 10.9173 8M10.9173 8C10.9173 8.67005 10.8528 9.34011 10.7238 10",fill:"none",vectorEffect:"non-scaling-stroke"})),i.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147"},i.a.createElement("path",{d:"M10.75 12.733L12.0763 14.0593C12.0802 14.0632 12.0865 14.0632 12.0904 14.0593L14.75 11.3997",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1941:function(e,t,n){"use strict";var o=n(238),i=n.n(o),a=n(239);t.a=Object(a.a)("earth_warn",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},i.a.createElement("path",{d:"M1.25 8C1.25 11.7279 4.27208 14.75 8 14.75C9.4972 14.75 10.8805 14.2625 12 13.4377M1.25 8C1.25 4.27208 4.27208 1.25 8 1.25C11.4868 1.25 14.3561 3.89382 14.7127 7.28618M1.25 8H11M7.55844 1.32533C4.32517 5.15507 4.31164 10.7831 7.51786 14.6279M8.48214 1.32533C11.7154 5.15507 11.7289 10.7831 8.52272 14.6279",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})),i.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#DA520C",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#DA520C"},i.a.createElement("path",{d:"M15.0039 14.5C15.0039 15.0523 14.5562 15.5 14.0039 15.5C13.4516 15.5 13.0039 15.0523 13.0039 14.5C13.0039 13.9477 13.4516 13.5 14.0039 13.5C14.5562 13.5 15.0039 13.9477 15.0039 14.5Z",stroke:"none"}),i.a.createElement("path",{d:"M12.829 9.9643C12.662 9.21283 13.2337 8.5 14.0035 8.5C14.7733 8.5 15.3451 9.21283 15.1781 9.9643L14.612 12.5119C14.5486 12.7971 14.2956 13 14.0035 13C13.7114 13 13.4585 12.7971 13.3951 12.5119L12.829 9.9643Z",stroke:"none"})))}))},1973:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return _}));var o=n(80),i=n.n(o),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(144),u=n.n(c),d=n(81),h=n(956),p=n(1797),f=n(3268),m=n.n(f),v=null,w=null,g=null;function b(){if(!w){w={};var e=[];p.commandBars.forEach((function(t){t.iconClassName=function(e){if(e){var t=e.split(" "),n=u()(t,2),o=n[0];return"icons icons-"+o+" icons-"+o+"-"+n[1]}}(t.icon),w[t.id]=t,e.push({id:t.id,text:t.text})})),(v=new m.a).postMessage({type:"init",items:e})}}var y,E=function(){function e(){r()(this,e),this._prevResult={keyword:null,values:[]},this._keyword=null,b(),this._handleMessage=this._handleMessage.bind(this),v.addEventListener("message",this._handleMessage)}return l()(e,[{key:"destroy",value:function(){v.removeEventListener("message",this._handleMessage)}},{key:"_handleMessage",value:function(e){var t=e.data,n=t.keyword,o=t.items;if(n===this._keyword){var i={},a=[];o.forEach((function(e){e.content&&e.url?a.push(e):i[e.text]||(i[e.text]=!0,a.push(w[e.id]))})),this._prevResult={keyword:n,values:a},this.onResult({keyword:n,result:a})}}},{key:"search",value:function(e,t,n){this.onResult=n,e=e.trim(),this._keyword=e,e!==this._prevResult.keyword?e?v.postMessage({type:"search",data:t,keyword:e}):(this._prevResult={keyword:e,values:[]},this.onResult({keyword:e,result:this._prevResult.values})):this.onResult({keyword:e,result:this._prevResult.values})}}]),e}(),C=Object(d.throttle)((y=i()(regeneratorRuntime.mark((function e(t,n){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.trim()){e.next=3;break}return n(null),e.abrupt("return");case 3:return o=window.__WPSENV__.reduxDispatch,e.next=6,o(Object(h.a)(window.officeType,t));case 6:(i=e.sent).error||n(i.response.body);case 8:case"end":return e.stop()}}),e,void 0)}))),function(e,t){return y.apply(this,arguments)}),100);function k(e,t){C(e,(function(n){g||(g=new E),g.search(e,n,t)}))}function _(e){return b(),Object.values(w).filter((function(t){return t.text===e}))}},2021:function(e,t,n){},2320:function(e,t,n){},239:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var o=n(238),i=n.n(o),a=["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","className","spin"];function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function u(){return"icon-"+(4294967296*(1+Math.random())|0).toString(16).substring(1)}var d=Object(o.createContext)({size:"1em",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"miter",rtl:!1,theme:"outline",colors:{outline:{fill:"#333333",background:"transparent"}},prefix:"kd"});d.Provider;function h(e,t,n){return function(r){var l=r.size,h=r.strokeWidth,p=r.strokeLinecap,f=r.strokeLinejoin,m=r.theme,v=r.fill,w=r.className,g=r.spin,b=c(r,a),y=Object(o.useContext)(d),E=function(e,t,n){var o="";return t.fill&&(t.fill,o=t.fill),t.theme||n.theme,{size:t.size||n.size,strokeWidth:t.strokeWidth||n.strokeWidth,strokeLinecap:t.strokeLinecap||n.strokeLinecap,strokeLinejoin:t.strokeLinejoin||n.strokeLinejoin,colors:o,id:e}}(Object(o.useMemo)(u,[]),{size:l,strokeWidth:h,strokeLinecap:p,strokeLinejoin:f,theme:m,fill:v},y),C=["kd-icon"];return C.push("kd-icon-"+e),t&&y.rtl&&C.push("kd-icon-rtl"),g&&C.push("kd-icon-spin"),w&&C.push(w),i.a.createElement("i",s(s({},b),{},{className:C.join(" "),style:{lineHeight:0}}),n(E))}}},321:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(499),n(238)),h=n.n(d),p=n(244),f=n.n(p),m=n(167),v=n(227),w=n(372),g=n(30),b=n.n(g),y=(n(500),n(240)),E=n(246),C={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"},k=n(450),_=n(13),O=n.n(_);var D=function(e,t,n,o){n=function(e){var t=O()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var i=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case C.topCenter:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body.clientHeight,r=t.left+t.width/2-o/2,s=t.top-n,l=a-t.bottom-n,c=t.top-n-i,u=t.bottom+n;return{left:r,top:s>=i?c:l>=i?u:s>=50||s>=l?c:u}}(t,n,o);break;case C.topRight:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-o,d=t.left,h=void 0;h=l>=o?u:c>=o?d:l>=50||l>=c?u:d;var p=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-i;return{left:h,top:f>=i?v:p>=i||p>=50||p>=f?m:v}}(t,n,o);break;case C.topLeft:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-o,d=t.left,h=void 0;h=c>=o?d:l>=o||l>=50||l>=c?u:d;var p=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-i;return{left:h,top:f>=i?v:p>=i||p>=50||p>=f?m:v}}(t,n,o);break;case C.bottomLeft:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.left,c=t.right,u=t.left,d=t.right-o,h=void 0;h=l>=o?u:c>=o?d:l>=50||l>=c?u:d;var p=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-i;return{left:h,top:p>=i?m:f>=i?v:p>=50||p>=f?m:v}}(t,n,o);break;case C.bottomRight:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=t.right,c=r-t.left,u=t.right-o,d=t.left,h=void 0;h=l>=o?u:c>=o?d:l>=50||l>=c?u:d;var p=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-i;return{left:h,top:p>=i?m:f>=i?v:p>=50||p>=f?m:v}}(t,n,o);break;case C.rightBottom:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-o,h=void 0;h=l>=o?u:c>=o?d:l>=50||l>=c?u:d;var p=s-t.top,f=t.bottom,m=t.top,v=t.bottom-i;return{left:h,top:p>=i?m:f>=i?v:p>=50||p>=f?m:v}}(t,n,o);break;case C.leftBottom:i=function(e,t,n){var o=e.offsetWidth,i=e.offsetHeight,a=document.body,r=a.clientWidth,s=a.clientHeight,l=r-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-o,h=void 0;h=c>=o?d:l>=o||l>=50||l>=c?u:d;var p=s-t.top,f=t.bottom,m=t.top,v=t.bottom-i;return{left:h,top:p>=i?m:f>=i?v:p>=50||p>=f?m:v}}(t,n,o);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(i.right=document.body.clientWidth-i.left-t.offsetWidth,delete i.left),i},M=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,o=n.refPanel.current,i=n.props.triggerElement;!o||o.contains(t)||function(e,t){if(e){var n=e.getBoundingClientRect(),o=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,i=o.pageX,a=o.pageY;return i>=n.left&&i<=n.right&&a>=n.top&&a<=n.bottom}return!1}(i,e)||k.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=h.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,this.observer=new MutationObserver((function(){var n=t.clientWidth,o=t.clientHeight;e.panelW===n&&e.panelH===o||(e.panelW=n,e.panelH=o,e.origin=null,e.style=null,e.forceUpdate())})),this.observer.observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){this.props.autoClose&&this.props.onClose()}},{key:"handleWindowKeyDown",value:function(e){E.getKey(e)===E.Keys.Esc&&(k.b(this.level+1)||(Object(y.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){m.isPad&&window.performance.now()-this.timestamp<=300||this.handleClose(e)}},{key:"handleWindowResize",value:function(e){var t=(e.detail||{}).isClosePanel;(void 0===t?null:t)||(m.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose())}},{key:"bindEvents",value:function(){this.observerPanel(),v.default.dispatchEvent(v.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(v.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(v.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){v.default.dispatchEvent(v.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(v.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(v.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize),this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=function(e,t,n){var o=void 0;o=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var i=e.top+(e.height||t.offsetHeight)/2;return(o>=n.left+n.width/2?"right":"left")+"-"+(i>=n.top+n.height/2?"bottom":"top")}(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},b()(t,window.rightToLeft?"right":"left",0),b()(t,"top",0),t),o=this.props,i=o.placement,a=o.rect,r=o.distance,s=o.isAuto,l=o.triggerElement;if(l){var c=l.getBoundingClientRect(),u=c.top,d=c.bottom;a=Object.assign({},a,{top:u,bottom:d})}var h=D(i,e,a,r);return s&&(h=function(e,t){var n=e.left,o=e.right,i=e.top,a=t.offsetWidth,r=t.offsetHeight,s=document.body,l=s.clientWidth,c=s.clientHeight;return window.rightToLeft?(o+a+4>l&&(o=l-a-4),o=Math.max(4,o)):(n+a+4>l&&(n=l-a-4),n=Math.max(4,n)),i+r+4>c&&(i=c-r-4),i=Math.max(4,i),window.rightToLeft?{right:o,top:i}:{left:n,top:i}}(h,e)),Object.assign(n,h),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,o=(n={visibility:e?"":"hidden"},b()(n,window.rightToLeft?"right":"left",0),b()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,o.maxHeight=this.maxHeight,o}var i=this.props,a=i.distance,r=i.isSetHeight;if(i.forceUpdate||!this.style){this.style=this.createStyle(t),r&&(this.style.height=function(e,t,n){var o=document.body.clientHeight,i=o-e-n;return e<0&&(i=o-2*n),t.offsetHeight<i?void 0:i}(this.style.top,t,a));var s=t.getBoundingClientRect().height;Math.abs(s-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return h.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=k.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,o=e.onMouseLeave,i=e.className,a=this.state.visible,r=null;"function"==typeof t.type&&(r={isListenEvent:a});var s=h.a.cloneElement(t,r),l=this.getPanelStyle(),c=this.getAnimationOrigin(l),u=this.calcTransparentPlaceholder(c),d=k.c;return a&&(this.showAnimation&&(d+=" animation-fade-scaleY-in"),d+=" origin-"+c,i&&(d+=" "+i)),h.a.createElement("div",{ref:this.refPanel,className:d,style:l,"data-level":this.level,onMouseEnter:n,onMouseLeave:o},u,s)}}]),t}(d.PureComponent);M.placementTypes=C,M.defaultProps={placement:C.bottomLeft,distance:0,offsetX:0,isSetHeight:!1,forceUpdate:!1,autoClose:!0};var P=M,L=n(362),S={click:"click",hover:"hover"},N=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.mustHover?n.props.trigger===S.hover:n.props.trigger===S.hover&&!m.isTouchScreen},n.refDropDown=h.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,o=n.visible,i=n.destroyOnHide;!o&&e.visible&&!i&&void 0!==i&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||f.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,o=t.onClick,i=t.trigger;o?o(e):i===S.hover&&!m.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0]||document.getElementsByClassName("kd-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),o=n.left,i=n.right,a=n.top,r=n.bottom,s=e.pageX,l=e.pageY;if(s>=o&&s<=i&&l>=a&&l<=r)return}this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,o=t.panel,i=t.visible,a=t.placement,r=t.distance,s=t.panelClass,l=t.isAuto,c=t.offsetX,u=t.autoClose;return h.a.createElement(P,{ref:this.refDropDown,isAuto:l,className:s,triggerElement:this.btnDom,rect:e,offsetX:c,visible:i,placement:a,distance:r,isSetHeight:n,onClose:this.handleContentClose,autoClose:u,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},o)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,o=e.visible,i=e.destroyOnHide;t=t||n.props.disabled;var a=this.getRect();if(!t){var r=n.props.title;r&&o&&(r=null),n=h.a.cloneElement(n,{title:r,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return h.a.createElement(h.a.Fragment,null,n,!!a&&h.a.createElement(w.a,{visible:o,destroyOnHide:i},this.renderContent()))}}]),t}(d.PureComponent);N.placementTypes=P.placementTypes,N.DropdownPanel=L.default,N.triggerTypes=S,N.defaultProps={visible:!1,trigger:S.click,distance:4,offsetX:0,autoClose:!0};t.default=N},3267:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(244),i=n.n(o),a=n(1797),r=n(1973);function s(e,t){if("string"!=typeof e){var n=c(e);l([n]),t(n)}else!function(e,t){var n=Object(r.a)(e).map((function(e){return e.el})),o=l(n);o||(o=n.find((function(e){return document.body.contains(e)})))||(o=n[0]);t(o||null)}(e,t)}function l(e){var t=a.tabWraps.find((function(e){return e.isVisible()})),n=e.find((function(e){return t.contains(e)}));if(n)return t.location(n),n;for(var o=0;o<a.tabWraps.length;o++)for(var i=0;i<e.length;i++)if(a.tabWraps[o].contains(e[i]))return a.tabWraps[o].location(e[i]),e[i]}function c(e){if(!e)return null;var t=e.left,n=e.top;if(void 0!==t||void 0!==n){var o={left:t,top:n,width:0};return{getBoundingClientRect:function(){return o}}}return i.a.findDOMNode(e)}},3268:function(e,t,n){e.exports=function(){return new Worker(n.p+"workers/public/components/commandbars/CommandBarSearch/helpers/search.8594ab29.worker.js")}},329:function(e,t,n){"use strict";n.r(t),n.d(t,"iDefault",(function(){return i})),n.d(t,"smallSize",(function(){return o})),n.d(t,"defaultFill",(function(){return u})),n.d(t,"iGreen",(function(){return a})),n.d(t,"iRed",(function(){return r})),n.d(t,"iPurple",(function(){return l})),n.d(t,"iBlue",(function(){return s})),n.d(t,"iGrey",(function(){return c}));var o=16,i="#333333",a="#00A147",r="#F05B13",s="#0A6CFF",l="#D6DDF5",c="#757575",u=[i,s]},3608:function(e,t,n){},3609:function(e,t,n){},3610:function(e,t,n){e.exports=function(e,t){n.e(499).then(n.bind(null,6002)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},3611:function(e,t,n){},362:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(501),n(238)),h=n.n(d),p=n(167),f=n(227),m=n(240),v=n(248),w=n(467),g=n(491),b=n(246),y="right",E="down",C="rightDown",k=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){for(var e=n.refContent.current,t=function(t){var o=e.children[t];if(o.classList.contains("selected"))return n.timer=setTimeout((function(){o.scrollIntoViewIfNeeded(),clearTimeout(n.timer),window.__WPSENV__.altStatus&&window.postMessage(JSON.stringify({eventName:"alt_web_access",cmd:"refresh"}))}),500),"break"},o=0;o<e.childElementCount;o++){if("break"===t(o))break}},n.handleScroll=function(){var e=n.props,t=e.scrollEndBottom,o=e.onScroll;if(o){var i=n.refPanel.current,a=i.scrollTop;a+i.clientHeight+t>=i.scrollHeight&&o({scrollTop:a})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=h.a.createRef(),n.refContent=h.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(m.getPageOfficeType)(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,o=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),o!==e.visible&&o&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){p.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(e){p.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(e),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(e){if(this.props.onItemHover&&!p.isTouchScreen){var t=this.getHoverItem();this.props.onItemHover(t,!0)}window.__WPSENV__.altStatus&&f.default.dispatchEvent(f.default.names.EXIT_ALT_MODE,e)}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(m.stopBubble)(e);var o=e.clientX,i=e.clientY,a=e.target,r=e.currentTarget.getAttribute("data-orien");a.setCapture&&a.setCapture();var s=this.state,l=s.width,c=s.height,u=s.minWidth,d=s.minHeight;document.onmousemove=function(e){Object(m.stopBubble)(e);var n=e.clientX,a=e.clientY,s=Math.max(u,l+n-o),h=Math.max(d,c+a-i);r===y?h=c:r===E&&(s=l),t.setState({width:s,height:h},(function(){f.default.dispatchEvent(f.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(m.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,a.releaseCapture&&a.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus){var o=Object(b.getKey)(e);switch(o){case b.Keys.Enter:var i=this.getHoverItem();i&&(Object(m.stopBubble)(e),i.click());break;case b.Keys.ArrowUp:case b.Keys.ArrowDown:var a=o===b.Keys.ArrowUp;this.setPreSelectItem(a,e),this.props.isPreSelectCloseDropdown&&f.default.dispatchEvent(f.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(m.stopBubble)(t);var o=this.getHoverItem();o&&o.classList.remove("hover");var i=this.getPreSelectItem(e,n,o);i.classList.add("hover"),this.showPreSelectItem(i)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var o=-1,i=0;i<t.length;i++)if(t[i]===n){o=i;break}if(e){for(var a=o-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){o=a;break}}else for(var r=o+1;r<t.length;r++)if(-1===t[r].className.indexOf("disabled")){o=r;break}return t[Math.max(0,o)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,o=t.minWidth,i=t.maxWidth;if(n||o||i)return{width:n,minWidth:o,maxWidth:i}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,o=e.canResize,i=e.isAuto,a=e.selectable,r=e.altStartMode,s="wo-dropdown-panel";i&&(s+=" "+this.officeType),o&&(s+=" can-resize"),t&&(s+=" "+t),a&&(s+=" wo-dropdown-panel-selectable");var l=this.getPanelStyle();return h.a.createElement("div",{ref:this.refPanel,className:s,style:l,tabIndex:0,"alt-start-mode":r,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0,role:"listbox"},h.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),h.a.createElement("div",{className:"drag-hand rightBottom","data-orien":C,onMouseDown:this.handleDragMouseDown},h.a.createElement(v.default,{type:v.default.types.other.drag_right_bottom})),h.a.createElement("div",{className:"drag-hand right","data-orien":y,onMouseDown:this.handleDragMouseDown}),h.a.createElement("div",{className:"drag-hand bottom","data-orien":E,onMouseDown:this.handleDragMouseDown}))}}]),t}(d.PureComponent);k.Item=w.a,k.Divider=g.a,k.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=k},370:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("symbol_cross",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M1.75 8H14.25M8 14.25V1.75",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},372:function(e,t,n){"use strict";var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(238),h=n(244),p=n.n(h),f=function(e){function t(){var e,n,o,a;i()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=o=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.popup=null,o.container=null,a=n,l()(o,a)}return u()(t,e),r()(t,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.visible,n=e.destroyOnHide;this.popup&&!t&&n&&this.unmountPopoup()}},{key:"componentWillUnmount",value:function(){this.unmountPopoup()}},{key:"getPopup",value:function(){if(this.popup)this.props.getContainer&&(this.container=this.props.getContainer(),this.container.contains(this.popup)||this.container&&this.container.appendChild(this.popup));else{this.popup=document.createElement("div"),this.popup.style.position="absolute",this.popup.style.left=0,this.popup.style.top=0,this.popup.style.zIndex=1e3;var e="component-popup",t=this.props.className;t&&(e+=" "+t),this.popup.className=e,this.popup.id="util-popup",this.container=document.body,this.props.getContainer&&(this.container=this.props.getContainer(),this.popup.style.right=0,this.popup.style.bottom=0),this.props.fullViewport&&this.popup.setAttribute("data-fullviewport","true"),this.container&&this.container.appendChild(this.popup)}return this.props.fullViewport&&this.popup.setAttribute("data-fullviewport","true"),this.popup}},{key:"unmountPopoup",value:function(){this.popup&&(this.container&&this.container.removeChild(this.popup),this.popup=null)}},{key:"componentDidCatch",value:function(e,t){if("s"===window.officeType)try{if(e&&t){if(-1===e.stack.indexOf("cross-origin"))return;window.badJsFunc(!1,{error:new Error("Plugin Center et react debugger. [stack]: "+t.componentStack)})}}catch(e){window.badJsFunc(!1,{error:new Error("Plugin Center et react 【PopUp】")})}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.visible,o=e.destroyOnHide;if(!t||!n&&!this.popup)return!1;if(!n&&o)return!1;var i=this.getPopup();return i.style.display=n?"":"none",p.a.createPortal(t,i)}}]),t}(d.PureComponent);f.defaultProps={destroyOnHide:!0,fullViewport:!0},t.a=f},375:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("symbol_tick",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M2.5 7.38775L6.68824 11.2933C6.81053 11.401 6.99639 11.3913 7.10689 11.2716L13.4215 4.5",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},380:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("arrow_down_s",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},i.a.createElement("path",{d:"M4.25 6.49997L7.99327 9.9936C7.99711 9.99719 8.00307 9.99719 8.00691 9.9936L11.75 6.49997",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},3823:function(e,t,n){"use strict";var o,i=n(13),a=n.n(i),r=n(80),s=n.n(r),l=n(1),c=n.n(l),u=n(2),d=n.n(u),h=n(22),p=n.n(h),f=n(23),m=n.n(f),v=n(30),w=n.n(v),g=(n(3609),n(238)),b=n.n(g),y=n(227),E=n(14),C=n(351),k=n(1425),_=n(312),O=n(248),D=n(82),M=n(247),P=n(3610),L=n.n(P),S=_.default.iconTypes.size16,N=function(e){function t(){return c()(this,t),p()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.isMin,o=e.onLocation,i=e.onSizeChange;return b.a.createElement("div",{className:"component-helper-panel"},b.a.createElement("div",{className:"search-bar-wrap"},Object(M.default)(L.a,{onLocation:o,onClose:t})),window.officeType!==D.default.outline&&b.a.createElement("div",{className:"other-items-wrap"},b.a.createElement("div",{className:"helper-panel-item",onClick:i},b.a.createElement(O.default,{type:n?S.float_ok:S.float_cancel}),n?_i18n("applications.public.components.commandbars.CommandBarSearch.float_ok", "Fix Hovering"):_i18n("applications.public.components.commandbars.CommandBarSearch.float_cancel", "Cancel Hovering"))))}}]),t}(g.PureComponent),T=n(3267),x=(n(3611),n(244)),B=n.n(x),I=function(e){function t(e){c()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.getPosition=function(e){var t=e.getBoundingClientRect(),n=t.left,o=t.top;return o=o-24+3,{left:n=n+t.width/2-8,top:o=Math.max(0,o)}},n.showTimer=null,n.closeTimer=null;var o=null;return e.from&&(o=n.getPosition(e.from)),n.state={position:o},n}return m()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.startShow(),window.addEventListener("mousedown",this.props.onClose,!0)}},{key:"componentDidUpdate",value:function(e,t){e.to!==this.props.to&&this.startShow()}},{key:"componentWillUnmount",value:function(){clearInterval(this.showTimer),clearTimeout(this.closeTimer),window.removeEventListener("mousedown",this.props.onClose,!0)}},{key:"startShow",value:function(){var e=this;clearInterval(this.showTimer),clearTimeout(this.closeTimer),this.showTimer=setInterval((function(){var t=e.getPosition(e.props.to);e.setState({position:t})}),300),this.closeTimer=setTimeout(this.props.onClose,5e3)}},{key:"render",value:function(){var e=this.state.position;if(!e)return!1;var t=b.a.createElement("div",{style:e,className:"search-drawing-pin"},b.a.createElement("div",{className:"pin"}),b.a.createElement("div",{className:"pulse"}));return B.a.createPortal(t,document.body)}}]),t}(g.PureComponent),W=function(e){function t(){var e,n,o,i;c()(this,t);for(var a=arguments.length,r=Array(a),s=0;s<a;s++)r[s]=arguments[s];return n=o=p()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),o.state={from:null,to:null},o.location=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=T.a(t);T.b(e,(function(e){o.setState({from:n,to:e})}))},o.handleClose=function(){o.setState({from:null,to:null})},i=n,p()(o,i)}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.state,t=e.from,n=e.to;return!!n&&b.a.createElement(I,{from:t,to:n,onClose:this.handleClose})}}]),t}(g.PureComponent),R=n(1973),A=n(259),j=n.n(A),z="weboffice_search_status",V=_.default.iconTypes,H=V.other,F=V.size16,U=(o={},w()(o,window.rightToLeft?"left":"right",36),w()(o,"bottom",66),o),G=window.CommandBarComponent,Z=G.cmbIds.$public,K=window.__WPSPLUGIN__.loader,X={pluginType:"FloatQuickHelp"},Y=function(e){function t(e){c()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Z.FloatQuickHelp));return n._pluginInstance=null,n.handleBtnClick=function(e){e.preventDefault()},n.handleTaskPaneWidthChange=function(e){if(!n.state.isMin){var t=e.detail.width,o=n.refModal.current.element,i=document.body.clientWidth,a=o.getBoundingClientRect();t>0?i-a.right<t+U.right&&(o.style.left="",o.style.right=t+U.right+"px"):(o.style.left="",o.style.right=U.right+"px")}},n.handlePanelClose=function(e,t){n.setState({panelVisible:!1},t),window.collection("search","click",e)},n.handleModalDragMove=function(e,t){if(e)n.setState({showTips:!0});else{var o=n.state.panelVisible&&!t;n.setState({panelVisible:o,showTips:!1})}},n.handlePanelVisibleChange=function(e){n.setState({panelVisible:e})},n.handleSizeChange=function(){var e=n.state.isMin;window.collection("search","click",e?"max":"min"),localStorage.setItem(z,e?"max":"min"),e?n.setState({panelVisible:!1,isMin:!1}):n.setState({panelVisible:!1,showTmpBtn:!0},(function(){var e=n.refTmpBtn.current.getElement().getBoundingClientRect(),t=n.refModal.current.element,o=t.getBoundingClientRect();t.style.left=o.left+"px",t.style.top=o.top+"px",t.style.right="initial",t.style.bottom="initial",t.offsetWidth,t.style.left=e.left+"px",t.style.top=e.top+"px",setTimeout((function(){n.setState({isMin:!0,showTmpBtn:!1})}),500)}))},n.location=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.refLocation.current.location(e,t)},n.refTmpBtn=b.a.createRef(),n.refModal=b.a.createRef(),n.refLocation=b.a.createRef(),n.refBtn=b.a.createRef(),n.init(),n}var n;return m()(t,e),d()(t,[{key:"init",value:(n=s()(regeneratorRuntime.mark((function e(){var t,n,o,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[Object(E.hasQuery)("hidecmb"),Object(E.hasQuery)("review"),Object(E.hasQuery)("version"),Object(E.hasQuery)("simple")],n=t[0],o=t[1],i=t[2],r=t[3],this._showBtn=!(n||o||i||r),this._showBtn){e.next=4;break}return e.abrupt("return");case 4:if(!K.search(X)){e.next=10;break}return this._showBtn=!1,e.next=8,K.loadSingleInstance(X);case 8:this._pluginInstance=e.sent,this._pluginInstance.mountBody&&this._pluginInstance.mountBody();case 10:this.state={panelVisible:!1,position:a()({},U),showTips:!0,isMin:"min"===localStorage.getItem(z),showTmpBtn:!1};case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"componentDidMount",value:function(){this._showBtn&&(window.addEventListener(y.default.names.ON_TASK_PANE_WIDTH_CHANGE,this.handleTaskPaneWidthChange),this.refBtn.current&&this.refBtn.current.getElement().addEventListener("mousedown",this.handleBtnClick,{passive:!1}))}},{key:"componentWillUnmount",value:function(){this._pluginInstance&&this._pluginInstance.unmountBody&&this._pluginInstance.unmountBody(),window.removeEventListener(y.default.names.ON_TASK_PANE_WIDTH_CHANGE,this.handleTaskPaneWidthChange),this.refBtn.current&&this.refBtn.current.getElement().removeEventListener("mousedown",this.handleBtnClick,{passive:!1})}},{key:"search",value:function(e,t){R.b(e,t)}},{key:"getBtnIcon",value:function(){var e=this.state,t=e.isMin,n=e.showTmpBtn;return t||n?F.helper:H.helper}},{key:"renderBtn",value:function(){var e=this.state,t=e.panelVisible,n=e.showTips,o=e.isMin,i=this.getBtnIcon(),a=b.a.createElement(N,{isMin:o,onLocation:this.location,onClose:this.handlePanelClose,onSizeChange:this.handleSizeChange});return b.a.createElement(b.a.Fragment,null,b.a.createElement(C.default,{panel:a,visible:t,placement:C.default.placementTypes.topRight,onVisibleChange:this.handlePanelVisibleChange},b.a.createElement(_.default,{ref:this.refBtn,iconType:i,className:"cmb-search-btn",selected:t&&o,title:n?_i18n("applications.public.components.commandbars.CommandBarSearch.btnTips", "Help"):""})),b.a.createElement(W,{ref:this.refLocation}))}},{key:"render",value:function(){if(!this._showBtn)return b.a.createElement(b.a.Fragment,null,b.a.createElement("div",{id:Z.FloatQuickHelp}),b.a.createElement(W,{ref:this.refLocation}));if(this.props.isOnlyPlugin)return null;var e=this.state,t=e.position,n=e.isMin,o=e.showTmpBtn,i=this.renderBtn();return n?i:b.a.createElement(b.a.Fragment,null,b.a.createElement(k.a,{ref:this.refModal,isAllDrag:!0,isExclusive:!1,className:"component-helper"+(o?" tmp":""),position:t,retainSize:42,onDragMove:this.handleModalDragMove,onClose:Function.prototype},i),o&&b.a.createElement(_.default,{ref:this.refTmpBtn,iconType:F.helper,className:"cmb-search-btn visibility0"}))}}]),t}(G);Y.propTypes={isOnlyPlugin:j.a.bool};t.a=Y},3825:function(e,t,n){"use strict";var o,i,a,r=n(80),s=n.n(r),l=n(1),c=n.n(l),u=n(2),d=n.n(u),h=n(22),p=n.n(h),f=n(23),m=n.n(f),v=(n(3608),n(238)),w=n.n(v),g=n(312),b=n(167),y=n(240),E=n(14),C=n(227),k=n(1372),_=n.n(k),O=(o=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.__CONFIG__.isEnableFullScreen){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,_.a.isSupport();case 4:if(e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:if(!Object(E.hasQuery)("version")){e.next=9;break}return e.abrupt("return",!1);case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),D=(i=s()(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S||L,e.next=3,t.isFullScreen();case 3:e.sent?t.exitFullScreen():t.fullScreen();case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),M=(a=s()(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S||L,e.next=3,t.isFullScreen();case 3:e.sent&&t.exitFullScreen();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),P=function(){function e(t,n,o){var i,a=this;c()(this,e),this._handleChange=(i=s()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("fullscreen change",t),a.onChange(t);case 2:case"end":return e.stop()}}),e,a)}))),function(e){return i.apply(this,arguments)}),this._handleF11=function(e){(b.isMacOs?e.ctrlKey&&e.metaKey&&"f"===e.key:122===e.keyCode)&&(Object(y.stopBubble)(e),a.onF11())},this.win=t,this.doc=t.document,this.onChange=n,this.onF11=o,this.doc.addEventListener("keydown",this._handleF11),_.a.addEventListener(this._handleChange)}var t,n,o;return d()(e,[{key:"destroy",value:function(){this.doc.removeEventListener("keydown",this._handleF11),_.a.removeEventListener(this._handleChange)}},{key:"fullScreen",value:(o=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("进入全屏"),e.next=3,_.a.setFullScreen();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"exitFullScreen",value:(n=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("退出全屏"),e.next=3,_.a.exitFullscreen();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"isFullScreen",value:(t=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.isFullScreen();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),L=void 0,S=void 0;var N=n(1007),T=n(1060),x=n(243),B=n.n(x),I=g.default.iconTypes.size16,W=[],R=function(e){function t(e){c()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){D()},n.refBtn=w.a.createRef(),n.state={isFull:!1,visible:!1},n}return m()(t,e),d()(t,[{key:"componentDidMount",value:function(){var e=s()(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:if(t=e.sent,this.setState({visible:t},(function(){t&&window.__WPSENV__.commandbars.push({el:n.refBtn,text:_i18n("applications.public.components.commandbars.FullScreenBtn.full", "Full Screen"),icon:I.full_screen2})})),t){e.next=6;break}return e.abrupt("return");case 6:0===W.length&&(o=function(e){W.forEach((function(t){return t.setState({isFull:e})})),window.collection2("full_screen_"+!e)},L=new P(window,o,D),window._parent!==window&&(S=new P(window._parent,o,D)),window.addEventListener(C.default.names.EXIT_FULL_SCREEN,M)),W.push(this);case 8:case"end":return e.stop()}var o}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=this;0===(W=W.filter((function(t){return t!==e}))).length&&(L.destroy(),S&&S.destroy(),window.removeEventListener(C.default.names.EXIT_FULL_SCREEN,M),L=null,S=null)}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.isFull;if(!t)return!1;var o=this.props.showText,i=n?_i18n("applications.public.components.commandbars.FullScreenBtn.exits", "Exit Full Screen"):_i18n("applications.public.components.commandbars.FullScreenBtn.full", "Full Screen");if(o){var a=n?w.a.createElement(T.default,{size:16,fill:"var(--kd-color-icon-secondary)"}):w.a.createElement(N.default,{size:16,fill:"var(--kd-color-icon-secondary)"});return w.a.createElement(B.a,{size:"medium",className:"show-text-full-screen",ref:this.refBtn,prefixIcon:a,onClick:this.handleClick},i)}var r=n?w.a.createElement(T.default,{size:16,fill:"var(--kd-color-icon-secondary)"}):w.a.createElement(N.default,{size:16,fill:"var(--kd-color-icon-secondary)"});return w.a.createElement(B.a,{size:"medium",className:"wo-component-full-screen",ref:this.refBtn,title:i,icon:r,onClick:this.handleClick})}}]),t}(v.PureComponent);t.a=R},3969:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(4310),n(238)),h=n.n(d),p=n(241),f=n(227),m=n(343),v=n(1425),w=n(507),g=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={position:{right:24,top:44}},n.handleClose=n.handleClose.bind(n),n.handleLogin=n.handleLogin.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.collection2("message_center_login_show")}},{key:"handleClose",value:function(){var e=this.props.info,t=e.from,n=e.to;window.session.sendBroadcast({action:"inviteLoginFail",from:t,to:n}),this.props.onClose(),window.collection2("message_center_login_close")}},{key:"handleLogin",value:function(){var e=this.props.info,t=e.from,n=e.to,o=JSON.stringify({from:t,to:n});sessionStorage.setItem("weboffice_invite_login",o),this.props.onClose(),Object(m.gotoLogin)(!1),window.collection2("message_center_login_click")}},{key:"render",value:function(){var e=this.props.info,t=this.state.position,n=_i18n("applications.public.components.commandbars.MessageCenter.loginTips", "{0} invites you to log in and collaborate").replace("{0}",e.from.shortName);return h.a.createElement(v.a,{className:"component-message-center-login-modal",title:" ",showCloseBtn:!0,position:t,isExclusive:!1,onClose:this.handleClose},h.a.createElement("div",{className:"login-tips"},n),h.a.createElement("div",{className:"login-btn-wrap"},h.a.createElement(w.default,{isAuto:!0,onClick:this.handleLogin},_i18n("applications.public.components.commandbars.MessageCenter.login", "Login"))))}}]),t}(d.PureComponent),b=function(e){function t(){var e,n,o,a;i()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=o=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.timer=null,o.state={position:{right:24,bottom:50}},a=n,l()(o,a)}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.startTimer()}},{key:"componentDidUpdate",value:function(e,t){this.props.text!==e.text&&(clearTimeout(this.timer),this.startTimer())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"startTimer",value:function(){this.timer=setTimeout(this.props.onClose,3e3)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.onClose,o=this.state.position;return h.a.createElement(v.a,{className:"component-message-center-notice-modal",showCloseBtn:!0,title:t,isExclusive:!1,position:o,onClose:n})}}]),t}(d.PureComponent),y=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={inviteMeLogin:null,noticeText:null},n.handleMessage=n.handleMessage.bind(n),n.handleLoginClose=n.handleLoginClose.bind(n),n.handleNoticeClose=n.handleNoticeClose.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(f.default.names.cooper.ON_BROADCAST_MSG,this.handleMessage);var e="weboffice_invite_login",t=sessionStorage.getItem(e);if(t){sessionStorage.removeItem(e);var n=JSON.parse(t),o=n.from,i=n.to,a=this.props.me;a.isFake?window.session.sendBroadcast({action:"inviteLoginFail",from:o,to:i}):window.session.sendBroadcast({action:"inviteLoginSuccess",from:o,to:a})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.default.names.cooper.ON_BROADCAST_MSG,this.handleMessage)}},{key:"handleMessage",value:function(e){var t=this.props.me,n=e.detail.message,o=n.action,i=n.from,a=n.to;if("inviteLogin"!==o)if("inviteLoginSuccess"!==o){if("inviteLoginFail"===o){if(a.id===t.id)return void this.setState({inviteMeLogin:null});var r=_i18n("applications.public.components.commandbars.MessageCenter.inviteLoginFail", "{0} not logged in").replace("{0}",a.shortName);this.setState({noticeText:r})}}else{if(a.id===t.id)return void this.setState({inviteMeLogin:null});var s=_i18n("applications.public.components.commandbars.MessageCenter.inviteLoginSuccess", "{0} logged in").replace("{0}",a.shortName);this.setState({noticeText:s})}else{if(a.id===t.id)return void this.setState({inviteMeLogin:{from:i,to:a}});if(i.id!==t.id){var l=_i18n("applications.public.components.commandbars.MessageCenter.inviteOtherLogin", "{0} invited {1} for login").replace("{0}",i.shortName);l=l.replace("{1}",a.shortName),this.setState({noticeText:l})}}}},{key:"handleLoginClose",value:function(){this.setState({inviteMeLogin:null})}},{key:"handleNoticeClose",value:function(){this.setState({noticeText:null})}},{key:"render",value:function(){var e=this.state,t=e.inviteMeLogin,n=e.noticeText;return h.a.createElement(h.a.Fragment,null,!!t&&h.a.createElement(g,{info:t,onClose:this.handleLoginClose}),!!n&&h.a.createElement(b,{text:n,onClose:this.handleNoticeClose}))}}]),t}(d.PureComponent);t.default=Object(p.connect)((function(e){return{me:e.public.user}}))(y)},4296:function(e,t,n){e.exports=function(e,t){n.e(525).then(n.bind(null,6933)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4297:function(e,t,n){"use strict";var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(4298),n(238)),h=n.n(d),p=n(82),f=n(362),m=n(568),v=n(448),w=f.default.Item,g="pagew",b="wordw",y="totalpage",E={PAGE_WIDTH:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.pageW", "Page Width"),type:g,track:4},WORD_WIDTH:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.wordW", "Text Width"),type:b,track:5},TOTAL_PAGE:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.totalPage", "Whole Page"),type:y,track:6}},C=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={autoIndex:0,readOnly:!1},n.handleItemClick=n.handleItemClick.bind(n),n.handleResize=n.handleResize.bind(n),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.throttleResize=Object(v.a)(this.handleResize,1e3),window.addEventListener("resize",this.throttleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.throttleResize)}},{key:"handleResize",value:function(){var e=null;switch(this.props.type){case g:e=E.PAGE_WIDTH;break;case b:e=E.WORD_WIDTH;break;case y:e=E.TOTAL_PAGE}null!==e&&this.handleItemClick(e.type,e.text,e.track)}},{key:"handleItemClick",value:function(e,t,n){var o=this.props.officeType;if("number"!=typeof e){if(Object(p.isEtLike)(o)){var i=window.APP.getActiveSheetView().zoomToSelections();return this.setState({autoIndex:i}),this.props.onChange(i),void this.handleItemClick(i)}if(o===p.default.writer){t=window.APP.workspace.getPageFitValue()[e](),this.setState({value:t}),e!==this.props.index&&this.props.onChange(t,e,!0,n)}else{if(o===p.default.presentation){return this.setState({autoIndex:100}),this.props.onChange(100),void this.handleItemClick(100)}if(o===p.default.pdf){var a=Math.round(100*window.APP.getZoom());return window.APP.zoomTo(e,"center","center"),void(e!==this.props.index&&this.props.onChange(a,e,!0))}}}else if(e!==this.props.index){var r=void 0,s=void 0;o!==p.default.writer&&o!==p.default.pdf||(r=s=!1),this.props.onChange(e,s,r,n)}}},{key:"getItemValues",value:function(){var e=this.state.autoIndex,t=this.props.officeType;return Object(p.isEtLike)(t)?[{text:"400%",type:400,value:400},{text:"300%",type:300,value:300},{text:"200%",type:200,value:200},{text:"100%",type:100,value:100},{text:"75%",type:75,value:75},{text:"50%",type:50,value:50},{text:"25%",type:25,value:25},{text:"10%",type:10,value:10},{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.auto", "Fit Selection"),type:"auto",value:e,disabled:window.APP.getActiveSheet().isDashBoardSheet()}]:t===p.default.writer?window.APP.isWebMode()?[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"10%",type:10,value:10},E.PAGE_WIDTH,E.WORD_WIDTH]:[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"10%",type:10,value:10},E.PAGE_WIDTH,E.WORD_WIDTH,E.TOTAL_PAGE]:t===p.default.presentation?[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200},{text:"100%",type:100,value:100},{text:"66%",type:66,value:66},{text:"50%",type:50,value:50},{text:"33%",type:33,value:33},{text:"10%",type:10,value:10}]:t===p.default.pdf?[{text:"800%",type:800,value:800},{text:"600%",type:600,value:600},{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"125%",type:125,value:125},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"50%",type:50,value:50,track:4},{text:"10%",type:10,value:10},{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.pageW", "Page Width"),type:"pagew",track:6}]:void 0}},{key:"renderItems",value:function(){var e=this,t=this.props,n=t.index,o=t.type;return this.getItemValues().map((function(t){var i=!1;return i=o?o===t.type:t.value===n,h.a.createElement(w,{key:t.text,type:t.type,value:t.value,selected:i,disabled:t.disabled,onClick:e.handleItemClick.bind(e,t.type,t.value,t.track)},t.text)}))}},{key:"render",value:function(){var e=this.props,t=e.index,n=e.max,o=e.min,i=e.inputReadOnly,a=this.renderItems();return h.a.createElement(f.default,{className:"wo-component-view-zoom-panel",selectable:!0},h.a.createElement("div",{className:"panel-title"},_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.display", "Display Ratio")),a,h.a.createElement("div",{className:"panel-title panel-title-custom"},_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.userDefine", "Custom")),h.a.createElement("div",{className:"panel-input-wrap"},h.a.createElement(m.default,{size:"medium",className:"input-number view-zoom-input",isInt:!0,max:n,min:o,value:t,onChange:this.handleItemClick,disabled:i,unit:"%"})))}}]),t}(d.PureComponent);t.a=C},4298:function(e,t,n){},4310:function(e,t,n){},4466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3321),i=function(e){return{type:o.a.DOCMAP_SHOW,data:{show:e}}}},450:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var o="component-dropdown-popup",i=function(e){return parseInt(e.getAttribute("data-level"))},a=function(e){for(;e!==document.body;){var t=getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility)return!1;e=e.parentNode}return!0},r=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&e!==document.body;){if(e.classList)for(var t=0;t<e.classList.length;t++)if(e.classList[t]===o)return i(e);e=e.parentNode}return 0},s=function(e){for(var t=document.getElementsByClassName(o),n=0;n<t.length;n++)if(a(t[n])&&i(t[n])===e)return!0;return!1}},467:function(e,t,n){"use strict";var o=n(13),i=n.n(o),a=n(24),r=n.n(a),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(22),h=n.n(d),p=n(23),f=n.n(p),m=n(238),v=n.n(m),w=n(240),g=n(252),b=n.n(g),y=n(375),E=function(e){function t(e){l()(this,t);var n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=v.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return f()(t,e),u()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(w.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,o=e.className,i=e.children,a="panel-item",s=this.refDiv.current;s&&-1!==s.className.indexOf(" hover")&&(a+=" hover"),t&&(a+=" disabled"),n&&(a+=" selected");var l=void 0===i?"undefined":r()(i);return"string"!==l&&"number"!==l||(a+=" only-text"),o&&(a+=" "+o),a}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,o=e.value,a=e.children,r=e.getStyle,s=e.visible,l=e.dataKey,c=e.keepEdit,u=e.draggable,d=e.selected,h=e.onMouseEnter,p=e.onMouseLeave,f=e.onDragEnter,m=e.onDragStart,w=e.onDragEnd,g=e.altHintKeep,E=e.altRole;if(!s)return!1;var C=this.getClassName(),k=r?r(o):null,_={};return h&&(_.onMouseEnter=h),p&&(_.onMouseLeave=p),v.a.createElement(b.a,i()({title:n},_),v.a.createElement("div",i()({ref:this.refDiv,id:t,className:C,style:k,role:E,"data-key":l||void 0,"data-keep-edit":c||void 0,"alt-hint-keep":g,draggable:u,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:m,onDragEnter:f,onDragEnd:w},_),a,d&&v.a.createElement(y.default,{size:16,className:"panel-item-tick",strokeWidth:2,fill:"var(--kd-color-icon-public)"})))}}]),t}(m.PureComponent);E.defaultProps={visible:!0,altRole:"option"},t.a=E},472:function(e,t,n){"use strict";n.r(t),n.d(t,"base64ToArrayBuffer",(function(){return o})),n.d(t,"formatDecimal",(function(){return i})),n.d(t,"filterValid",(function(){return a})),n.d(t,"getStrLength",(function(){return r})),n.d(t,"isHighSurrogate",(function(){return s})),n.d(t,"isLowSurrogate",(function(){return l})),n.d(t,"isSurrogate",(function(){return c})),n.d(t,"replaceEmoji",(function(){return u})),n.d(t,"hasEmoji",(function(){return d}));var o=function(e){for(var t=window.atob(e),n=t.length,o=new Uint8Array(n),i=0;i<n;i++)o[i]=t.charCodeAt(i);return o.buffer},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(""===e)return e;var n=(e=e.toString()).indexOf(".");return n>-1&&e.length-n-1>t&&(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t)),e.toString()},a=function(e){var t=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]","g");return e.replace(t,"")},r=function(e){for(var t=e.length,n=0,o=0;o<t;o++)0!=(65280&e.charCodeAt(o))&&n++,n++;return n},s=function(e){return e>=55296&&e<=56319},l=function(e){return e>=56320&&e<=57343},c=function(e){return e>=55296&&e<=57343};function u(e){return e.replace(/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g,"")}function d(e){return/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g.test(e)}},480:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var o=n(238),i=n.n(o);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===a(r)?r:String(r)),o)}var i,r}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(u,e);var t,n,o,a=c(u);function u(){var e;return r(this,u),(e=a.apply(this,arguments)).prefixCls="kd-menu-divider",e}return t=u,(n=[{key:"render",value:function(){return i.a.createElement("div",{className:this.className(this.prefixCls)})}}])&&s(t.prototype,n),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),u}(n(303).a)},491:function(e,t,n){"use strict";var o=n(300),i=n.n(o),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),h=n.n(d),p=n(238),f=n.n(p),m=n(480),v=function(e){function t(){return r()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){var e=i()(this.props,[]);return f.a.createElement(m.default,e)}}]),t}(p.Component);t.a=v},499:function(e,t,n){},500:function(e,t,n){},501:function(e,t,n){},502:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("arrow_up_s",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},i.a.createElement("path",{d:"M4.25 9.49998L7.99327 6.00635C7.99711 6.00277 8.00307 6.00277 8.00691 6.00635L11.75 9.49998",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},512:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(703),n(238)),h=n.n(d),p=function(e){function t(){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.className,t="component-divider";return e&&(t+=" "+e),h.a.createElement("div",{className:t})}}]),t}(d.PureComponent);t.default=p},5360:function(e,t,n){"use strict";var o=n(1),i=n.n(o),a=n(2),r=n.n(a),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(5361),n(238)),h=n.n(d),p=n(240),f=n(167),m=n(321),v=n(252),w=n.n(v),g=n(4297),b=n(355),y=n(448),E=n(1228),C=n(227),k=n(82),_=n(243),O=n.n(_),D=n(883),M=n(370),P=n(1602),L=n(248),S=n(1749),N=L.default.types.size16,T=function(e){function t(e){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.delayTimeout=0,n.state={index:100,panelVisible:!1,inputReadOnly:!1,firstRender:!0,drag:!1},n.handleTouchStart=function(e){e.preventDefault(),e.target.click()},n.refReduce=h.a.createRef(),n.refIncrease=h.a.createRef(),n.refZoom=h.a.createRef(),n.handlePanelVisibleChange=n.handlePanelVisibleChange.bind(n),n.handleReduceBtnClick=n.handleReduceBtnClick.bind(n),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handlePanelIndexChange=n.handlePanelIndexChange.bind(n),n.handleWheelScroll=n.handleWheelScroll.bind(n),n.addGestureEvent=n.addGestureEvent.bind(n),n.handleGestureStart=n.handleGestureStart.bind(n),n.handleGestureChange=n.handleGestureChange.bind(n),n.handleGestureEnd=n.handleGestureEnd.bind(n),n.handleKeyBoardEvent=n.handleKeyBoardEvent.bind(n),n.wheelHandler=n.wheelHandler.bind(n),n.handleZoomValueWheel=n.handleZoomValueWheel.bind(n);var o=f.isPad?32:f.isSafari||f.isWpsClient?200:16;return n.throttleWheelEvent=Object(y.a)(n.wheelHandler,o,{trailing:!1}),n.debounceCollectZoom=Object(E.default)(n.collectZoom,5e3),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.visible,n=e.disableGesture,o=e.disableDoubleFinger;t&&(window.__WPSENV__.commandbars.push({el:this.refReduce.current.getElement(),text:_i18n("applications.public.components.commandbars.ViewZoom.zoomOut", "Zoom out"),icon:N.minus}),window.__WPSENV__.commandbars.push({el:this.refIncrease.current.getElement(),text:_i18n("applications.public.components.commandbars.ViewZoom.zoomIn", "Zoom in"),icon:N.add}),window.__WPSENV__.commandbars.push({el:this.refZoom,text:_i18n("applications.public.components.commandbars.ViewZoom.zoom", "Zoom Level")}),this.refZoom.current.addEventListener("touchstart",this.handleTouchStart,!0)),this.adjustUI(this.props.index),window.addEventListener("keydown",this.handleKeyBoardEvent),f.isIE||f.isWpsClient?window.addEventListener("wheel",this.handleWheelScroll):window.addEventListener("wheel",this.handleWheelScroll,{passive:!1}),o||(!0!==n?this.addGestureEvent():this.stopGestureEvent())}},{key:"componentDidUpdate",value:function(e,t){e.index!==this.props.index&&this.adjustUI(this.props.index)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.disableGesture,n=e.disableDoubleFinger;window.removeEventListener("keydown",this.handleKeyBoardEvent),window.removeEventListener("wheel",this.handleWheelScroll,{passive:!1}),this.props.visible&&this.refZoom.current.removeEventListener("touchstart",this.handleTouchStart,!0),n||(!0!==t?this.removeGestureEvent():this.enableGestureEvent())}},{key:"handleKeyBoardEvent",value:function(e){var t=this;if(!this.props.disabled&&Object(b.isCtrlOrCmd)(e)){var n=this.props.officeType,o=b.COMMON_CTRL_KEYCODE;switch(e.keyCode){case o.ADD:case o.NUMBER_ADD:case o.EQUAL:p.stopBubble(e),this.handleAddBtnClick();break;case o.MINUS:case o.NUMBER_MINUS:case o.CONNECT:p.stopBubble(e),this.handleReduceBtnClick();break;case o.ZERO:case o.NUMBER_ZERO:n===k.default.presentation?setTimeout((function(){return t.props.onBestScale()}),100):setTimeout((function(){return t.handlePanelIndexChange(100,!1,!1,!1)}))}}}},{key:"handleWheelScroll",value:function(e){if(!this.props.disabled){if(f.isSougou&&!0===e.ctrlKey&&e.preventDefault(),Object(b.isCtrlOrCmd)(e))return Date.now()-this.delayTimeout<1e3?void(f.isWindows&&e.preventDefault()):(p.stopBubble(e),void this.throttleWheelEvent(-e.deltaY,null,e));this.delayTimeout=Date.now(),!this.props.disableDoubleFinger&&Object(b.isTwoFingerZoom)(e)&&(p.stopBubble(e),this.throttleWheelEvent(e.wheelDeltaY,e.deltaY,e))}}},{key:"handleZoomValueWheel",value:function(e){this.throttleWheelEvent(-e.deltaY,null,e)}},{key:"addGestureEvent",value:function(){this.scale=1,document.documentElement.addEventListener("gesturestart",this.handleGestureStart),document.documentElement.addEventListener("gestureend",this.handleGestureEnd),document.documentElement.addEventListener("gesturechange",this.handleGestureChange)}},{key:"removeGestureEvent",value:function(){this.scale=null,document.documentElement.removeEventListener("gesturestart",this.handleGestureStart),document.documentElement.removeEventListener("gestureend",this.handleGestureEnd),document.documentElement.removeEventListener("gesturechange",this.handleGestureChange)}},{key:"stopGestureEvent",value:function(){document.documentElement.addEventListener("gesturestart",this.stopGesture),document.documentElement.addEventListener("gestureend",this.stopGesture),document.documentElement.addEventListener("gesturechange",this.stopGesture)}},{key:"enableGestureEvent",value:function(){document.documentElement.removeEventListener("gesturestart",this.stopGesture),document.documentElement.removeEventListener("gestureend",this.stopGesture),document.documentElement.removeEventListener("gesturechange",this.stopGesture)}},{key:"stopGesture",value:function(e){p.stopBubble(e)}},{key:"handleGestureStart",value:function(e){this.scale=1,this.startIndex=this.state.index,p.stopBubble(e)}},{key:"handleGestureChange",value:function(e){if(this.props.disabled)p.stopBubble(e);else{var t=e.scale,n=this.scale>t?-1:1;this.throttleWheelEvent(n,5,e),this.scale=t,p.stopBubble(e)}}},{key:"handleGestureEnd",value:function(e){this.scale=1,this.startIndex=this.state.index,p.stopBubble(e)}},{key:"wheelHandler",value:function(e,t,n){t&&Math.abs(t)<3||(e>0?this.handleAddBtnClick(n):e<0&&this.handleReduceBtnClick(n),C.default.dispatchEvent(C.default.names.CLOSE_DROPDOWN_PANEL))}},{key:"collectZoom",value:function(e){e<10?window.collection("zoom",{value:"size0"}):e<20?window.collection("zoom",{value:"size1"}):e<30?window.collection("zoom",{value:"size2"}):e<40?window.collection("zoom",{value:"size3"}):e<50?window.collection("zoom",{value:"size4"}):e<200?window.collection("zoom",{value:"size5"}):e<250?window.collection("zoom",{value:"size6"}):e<300?window.collection("zoom",{value:"size7"}):e<350?window.collection("zoom",{value:"size8"}):e<=400?window.collection("zoom",{value:"size9"}):e<=500&&window.collection("zoom",{value:"size10"})}},{key:"handlePanelVisibleChange",value:function(e){this.props.onShow&&e&&this.props.onShow(),this.setState({panelVisible:e}),C.default.dispatchEvent("viewZoomPanelChange",{visible:e})}},{key:"handleReduceBtnClick",value:function(e){this.btnClick(!1,e)}},{key:"handleAddBtnClick",value:function(e){this.btnClick(!0,e)}},{key:"handlePanelIndexChange",value:function(e,t,n,o){this.adjustUI(e),void 0!==t&&this.setState({type:t}),void 0!==n&&this.setState({inputReadOnly:n}),o&&this.props.doTrack&&this.props.doTrack(o)}},{key:"clearTypeReadOnly",value:function(){this.setState({type:void 0,inputReadOnly:void 0})}},{key:"btnClick",value:function(e,t){var n=t&&void 0!==t.initGestureEvent,o=this.state.index,i=this.props,a=i.outMax,r=i.outMin,s=i.stepLength;if(f.isPad&&n)o=Math.round(this.startIndex*t.scale);else{var l=o%s;0!==l?o=e?o+(s-l):o-l:o+=e?s:-s}o=Math.min(a,Math.max(o,r)),this.adjustUI(o,!0,t),this.clearTypeReadOnly()}},{key:"adjustUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments[1],o=arguments[2],i=this.props,a=i.max,r=i.min,s=i.outMax,l=i.outMin,c=this.state.index;if(!0===n){if(e>s&&e>c)return;if(e<l&&e<c)return}null!==e&&(c=e),c=Math.max(r,c),(c=Math.min(a,c))!==this.state.index&&this.setState({index:c,firstRender:null===this.state.index,inputReadOnly:!1},(function(){t.props.index!==c&&(t.props.onChange(c,o),t.debounceCollectZoom(c))}))}},{key:"getClassName",value:function(){var e=this.state,t=e.drag,n=e.firstRender,o="wo-component-view-zoom";return this.props.disabled&&(o+=" disabled"),t||n||(o+=" transition"),o}},{key:"render",value:function(){var e=this.props,t=e.max,n=e.min,o=e.outMax,i=e.outMin,a=e.officeType,r=e.onBestScale,s=e.visible,l=e.showLeftDivider,c=e.showRightDivider;if(!1===s)return null;var u=this.state,d=u.index,p=u.panelVisible,f=u.inputReadOnly,v=u.type;d=parseInt(d||0);var b=this.getClassName(),y=h.a.createElement(g.a,{officeType:a,max:t,min:n,index:d,type:v,inputReadOnly:f,visible:p,onChange:this.handlePanelIndexChange});return h.a.createElement("div",{className:b},l&&h.a.createElement(S.a,{type:"vertical"}),h.a.createElement(O.a,{size:"small",ref:this.refReduce,icon:h.a.createElement(D.default,{size:16,fill:"var(--kd-color-icon-secondary)"}),title:_i18n("applications.public.components.commandbars.ViewZoom.zoomOut", "Zoom out"),disabled:d<=i,onClick:this.handleReduceBtnClick}),h.a.createElement(m.default,{panel:y,destroyOnHide:!1,visible:p,onVisibleChange:this.handlePanelVisibleChange},h.a.createElement(w.a,{title:_i18n("applications.public.components.commandbars.ViewZoom.title", "Adjust Display Ratio")},h.a.createElement("div",{ref:this.refZoom,className:"zoom-value",onWheel:this.handleZoomValueWheel},h.a.createElement(O.a,{size:"middle",className:"index-button",active:p}," ",h.a.createElement("i",null,d,"%"))))),h.a.createElement(O.a,{type:"light",size:"small",ref:this.refIncrease,icon:h.a.createElement(M.default,{size:16,fill:"var(--kd-color-icon-secondary)"}),title:_i18n("applications.public.components.commandbars.ViewZoom.zoomIn", "Zoom in"),disabled:d>=o,onClick:this.handleAddBtnClick}),!!r&&h.a.createElement(O.a,{type:"light",size:"small",icon:h.a.createElement(P.a,{size:16,fill:"var(--kd-color-icon-secondary)"}),className:"zoom-best",title:_i18n("applications.public.components.commandbars.ViewZoom.zoomBest", "Best Display Ratio"),onClick:r}),c&&h.a.createElement(S.a,{type:"vertical"}))}}]),t}(d.PureComponent);T.defaultProps={max:400,min:10,outMax:300,outMin:50,middleIndex:100,stepLength:10,visible:!0,disableGesture:!1,disableDoubleFinger:!1,officeType:window.officeType},t.a=T},5361:function(e,t,n){},568:function(e,t,n){"use strict";n.r(t),n.d(t,"BtnType",(function(){return O}));var o=n(30),i=n.n(o),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),h=n.n(d),p=(n(778),n(238)),f=n.n(p),m=n(600),v=n(240),w=n(472),g=n(167),b=function(e,t){return t>=e.split(".")[1].length},y=function(e,t,n,o){var i=e,a=/^(-)?(0)+$/,r=a.test(i);return r&&(i=i.replace(a,"$10")),t&&!n?function(e){e=Number(e);return{valid:/^\d+$/.test(e),newStr:e}}(i):t&&n?function(e){var t=/^(-)?\d*$/.test(e);return/(-)?\d+$/.test(e)&&(e=Number(e)),{valid:t,newStr:e}}(i):t||n?!t&&n?function(e,t,n){var o=/^(-)?\d+\.\d+$/,i=/^(-)?\d*$/.test(e)||/^(-)?\d+\.$/.test(e)||o.test(e);o.test(e)&&!b(e,n)&&(i=!1);return/(-)?0+\d+$/.test(e)&&(e=Number(e)),{valid:i,newStr:e}}(i,0,o):void 0:function(e,t){var n=/^\d+$/,o=/^\d+\.\d+$/,i=n.test(e)||/^\d+\.$/.test(e)||o.test(e);return o.test(e)&&!b(e,t)&&(i=!1),n.test(e)&&(e=Number(e)),{valid:i,newStr:e}}(i,o)},E=n(246),C=n(322),k=n(380),_=n(502),O={add:"add",subtract:"subtract"},D=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleWheel=function(e){v.isMouseInElement(e,n.mianRef.current)&&v.stopBubble(e)},n.clickTimeout=null,n.clickInterval=null,n.refAdd=f.a.createRef(),n.refInput=f.a.createRef(),n.mianRef=f.a.createRef(),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handleMinusBtnClick=n.handleMinusBtnClick.bind(n),n.handleInputBlur=n.handleInputBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleInputKeyUp=n.handleInputKeyUp.bind(n),n.handleInputWheel=n.handleInputWheel.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleContainerClick=n.handleContainerClick.bind(n),n.handleInputFocus=n.handleInputFocus.bind(n),n.getValue=n.getValue.bind(n),n.recoverLastValidValue=n.recoverLastValidValue.bind(n);var o=n.props,i=o.value,a=o.defaultValue,s=o.step,l=o.debounceWait;return n.step=s||1,n.defaultValue=a||i,n.state={value:i},n._lockLazyChange=!0,n.debounceInputChange=Object(m.debounce)((function(e){n.inputChange(e)}),l),n}return h()(t,e),l()(t,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&(this.setState({value:this.props.value}),this._lockLazyChange=!0)}},{key:"componentDidMount",value:function(){document.addEventListener("wheel",this.handleWheel,g.getPassiveParam())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.lazyTimer),document.removeEventListener("wheel",this.handleWheel,g.getPassiveParam())}},{key:"getValue",value:function(){var e=this.props,t=e.value,n=e.isInt,o=e.min,i=e.max,a=this.refInput.current.value,r=n?parseInt(a):parseFloat(a);return r>i||r<o?Number(t):isNaN(r)?Number(this.defaultValue):Number(r)}},{key:"focus",value:function(){v.setInputFocus(this.refInput.current)}},{key:"select",value:function(){this.refInput.current.select()}},{key:"blur",value:function(){this.refInput.current.blur()}},{key:"getInnerValue",value:function(){return Number(this.refInput.current.value)}},{key:"recoverLastValidValue",value:function(){var e=this.props.value;this.setState({value:e})}},{key:"getInputText",value:function(){return this.refInput.current.value}},{key:"setValue",value:function(e){var t=this.props,n=t.onChange,o=t.isInt,i=t.max,a=t.min,r=t.places;return e=o?e:Object(w.formatDecimal)(e,r),e=(e=isNaN(e)?this.defaultValue:e)>i?i:e<a?a:e,this._lockLazyChange=e===this.props.value,this.setState({value:e}),n&&n(e),e}},{key:"setInvalidValue",value:function(e){var t=this.props.onOutOfRange;this.setState({value:e}),t&&t(e)}},{key:"inputChange",value:function(e){var t=this.props,n=t.max,o=t.min,i=t.isInt,a=t.isNegative,r=t.places,s=t.onOutOfRange,l=e.replace(/\s+/g,"");if(""!==l)if(l>n)s&&s(l);else{var c=y(l,i,a,r),u=c.valid,d=c.newStr;if(!(u&&d<o))return u&&isNaN(d)?(this.setState({value:d}),void(s&&s(e))):void(u&&"-0"===l?this.setState({value:l}):u?this.setValue(d):"-"===e&&s&&s(l));this.setInvalidValue(d)}else this.setInvalidValue(l)}},{key:"handleInputChange",value:function(e){v.stopBubble(e);var t=e.target.value;this.props.debounceWait?this.debounceInputChange(t):this.inputChange(t)}},{key:"handleInputBlur",value:function(e){v.stopBubble(e),this.handleLazyChange(this.state.value),this.props.onBlur&&this.props.onBlur(e),this.setState({isFocus:!1})}},{key:"handleInputFocus",value:function(e){this.setState({isFocus:!0}),this.props.onFocus&&this.props.onFocus(e)}},{key:"handleInputKeyDown",value:function(e){if(Object(E.isMatchShortCutKey)(e,[E.Keys.ArrowUp]))this.handleAddBtnClick(e);else if(Object(E.isMatchShortCutKey)(e,[E.Keys.ArrowDown]))this.handleMinusBtnClick(e);else{var t=this.props.onEnter;Object(E.isMatchShortCutKey)(e,[E.Keys.Enter])&&(v.stopBubble(e),t&&t(),this.handleLazyChange(this.state.value))}}},{key:"handleInputKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"handleInputWheel",value:function(e){if(this.props.readOnly)return!1;var t=parseFloat(this.state.value),n=this.props.step;e.deltaY>0||e.deltaX<0?t-=n:t+=n,this.handleLazyChange(this.setValue(t))}},{key:"handleAddBtnClick",value:function(e){this.btnClick(e,!0)}},{key:"handleMinusBtnClick",value:function(e){this.btnClick(e,!1)}},{key:"btnClick",value:function(e,t){v.stopBubble(e);var n=this.state.value,o=this.props.step,i=e.currentTarget.className;if(v.setInputFocus(this.refInput.current),-1===i.indexOf("disabled")&&-1===i.indexOf("readonly")){var a=parseFloat(n);a+=t?o:-o,this.handleLazyChange(this.setValue(a),t?O.add:O.subtract,!0)}}},{key:"handleMouseDown",value:function(e){var t=this,n=e.target===this.refAdd.current;clearTimeout(this.clickTimeout),clearInterval(this.clickInterval);var o={currentTarget:{className:e.currentTarget.className}};this.clickTimeout=setTimeout((function(){t.clickInterval=setInterval((function(){n?t.handleAddBtnClick(o):t.handleMinusBtnClick(o)}),100)}),500)}},{key:"handleMouseUp",value:function(){clearTimeout(this.clickTimeout),clearInterval(this.clickInterval)}},{key:"handleContainerClick",value:function(e){var t=this.props,n=t.stopbubble,o=t.onContainerClick;o&&o(e),n&&v.stopBubble(e)}},{key:"handleInputMouseDown",value:function(){v.stopOnceClick()}},{key:"handleLazyChange",value:function(e,t,n){var o=this.props.onLazyChange;o&&!this._lockLazyChange&&(clearTimeout(this.lazyTimer),this._lockLazyChange=!0,this.lazyTimer=setTimeout((function(){o(e,t)}),n?100:300))}},{key:"render",value:function(){var e,t=this.props,n=t.className,o=t.max,a=t.min,r=t.unit,s=t.readOnly,l=t.onPaste,c=t.showBtn,u=t.altScPosition,d=t.size,h=this.state,p=h.value,m=h.isFocus,v=f.a.classNames((e={"wo-component-input-number":1},i()(e,"wo-component-input-number--"+d,d),i()(e,"is-disabled",s),i()(e,"is-focus",m),e),n);return f.a.createElement("div",{className:v,ref:this.mianRef,onWheel:this.handleInputWheel,onClick:this.handleContainerClick},f.a.createElement("div",{className:"wo-component-input-number-wrap wo-component-input-number-input"},f.a.createElement("input",{ref:this.refInput,className:s?"readonly":"",value:p,maxLength:7,type:"text",tabIndex:-1,onFocus:this.handleInputFocus,onKeyUp:this.handleInputKeyUp,onKeyDown:this.handleInputKeyDown,onChange:this.handleInputChange,onBlur:this.handleInputBlur,readOnly:s,onPaste:l,unselectable:s?"on":null,disabled:s,onMouseDown:this.handleInputMouseDown,"alt-sc-position":u})),!!r&&f.a.createElement("div",{className:"wo-component-input-number-unit"},r),c&&!g.isTouchScreen&&f.a.createElement("div",{className:"wo-component-input-number-controls input-btns-wrap"+(s?"  readonly":"")},f.a.createElement(C.default,{ref:this.refAdd,className:"wo-component-input-number--increase add"+(p>=o||s?" disabled":""),onClick:this.handleAddBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp},f.a.createElement(_.default,{fill:"var(--kd-color-icon-secondary)",size:["medium","middle","small"].includes(d)?8:12})),f.a.createElement(C.default,{className:"wo-component-input-number--decrease minus"+(p<=a&&""!==p||s?" disabled":""),onClick:this.handleMinusBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp},f.a.createElement(k.default,{fill:"var(--kd-color-icon-secondary)",size:["medium","middle","small"].includes(d)?8:12}))))}}]),t}(p.PureComponent);D.defaultProps={max:999999,min:-999999,value:0,isInt:!1,isNegative:!1,places:2,stopbubble:!0,showBtn:!0,step:1,debounceWait:0,size:"large"};t.default=D},684:function(e,t,n){"use strict";n.r(t),n.d(t,"TYPO_MODE",(function(){return o}));var o={MODE_PC:0,MODE_MOBILE:1,MODE_WEB:2,MODE_PAGINATION:3}},703:function(e,t,n){},7438:function(e,t,n){"use strict";var o=n(30),i=n.n(o),a=n(13),r=n.n(a),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(22),h=n.n(d),p=n(23),f=n.n(p),m=(n(9270),n(238)),v=n.n(m),w=n(319),g=n(258),b=n.n(g),y=n(9271),E=n.n(y),C={top:"bottom",bottom:"top",left:"right",right:"left"},k=function(e){function t(e){l()(this,t);var n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={firstVisible:!1},n.showTimer=null,n.closeTimer=null,n.handleClose=n.handleClose.bind(n),n}return f()(t,e),u()(t,[{key:"handleClose",value:function(){clearTimeout(this.closeTimer)}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.top,o=e.left,a=e.bottom,s=e.right,l=e.triangleStyle,c=void 0===l?{left:"16px",top:"100%"}:l,u=e.triangleDirection,d=void 0===u?"bottom":u,h={top:n,left:o,bottom:a,right:s},p=C[d].charAt(0).toUpperCase()+C[d].slice(1),f=r()({},c,i()({},"border"+p,"6px solid #fff")),m=_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.WebModeGuide.webModeDesc", "The cross-page view prevents a paragraph, table, or picture from breaking across pages, "),g=_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.WebModeGuide.applicableScene", "which is suitable for list, schedule, and project plan documents.");return v.a.createElement(w.default,{visible:t},v.a.createElement("div",{className:b()("web-mode-guide"),style:h},v.a.createElement("div",{className:"web-mode-guide-content"},v.a.createElement("div",{className:"web-mode-guide-content-text"},m+g)),v.a.createElement("div",{className:"web-mode-guide-pic"},v.a.createElement("img",{src:E.a})),v.a.createElement("div",{className:"web-mode-guide-triangle",style:f})))}}]),t}(m.PureComponent);t.a=k},778:function(e,t,n){},883:function(e,t,n){"use strict";n.r(t);var o=n(238),i=n.n(o),a=n(239);t.default=Object(a.a)("symbol_horizontal_line",!1,(function(e){return i.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},i.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},i.a.createElement("path",{d:"M1.75 8H14.2533",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},9267:function(e,t,n){},9268:function(e,t,n){"use strict";var o=n(13),i=n.n(o),a=n(1),r=n.n(a),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),h=n.n(d),p=n(238),f=n.n(p),m=n(241),v=n(4466),w=n(243),g=n.n(w),b=n(1550),y=n(329),E=g.a.iconTypes.size16,C=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isShowDocMap=window.__CONFIG__.wps.isShowDocMap,n.handleClick=n.handleClick.bind(n),n}return h()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.isShowDocMap&&this.props.showText&&window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents"),icon:E.wps_structure})}},{key:"handleClick",value:function(){var e=this.props.show;e=!e,this.props.showText?window.collection("commandbar","click","page|structure_"+(e?"on":"off")):window.collection("commandbar","click","statusbar|structure_"+(e?"on":"off")),this.props.dispatch(v.a(e))}},{key:"render",value:function(){var e=this;if(!this.isShowDocMap)return null;var t=this.props,n=t.showText,o=t.show,a=t.disabled,r=t.fill,s={icon:f.a.createElement(b.default,{size:16,fill:r||[y.iDefault]}),disabled:a,selected:o,onClick:this.handleClick};return n?f.a.createElement(g.a,i()({size:"middle",ref:function(t){e.refBtn=t}},s),_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents")):f.a.createElement(g.a,i()({size:"middle",ref:function(t){e.refBtn=t}},s,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents")}))}}]),t}(p.PureComponent);t.a=Object(m.connect)((function(e){return{show:e.writer.docmap.show}}))(C)},9269:function(e,t,n){"use strict";var o,i,a=n(13),r=n.n(a),s=n(144),l=n.n(s),c=n(30),u=n.n(c),d=n(238),h=n.n(d),p=n(241),f=n(8215),m=n(321),v=n(243),w=n.n(v),g=n(260),b=n(560),y=n.n(b),E=n(684),C=n(7438),k=n(167),_=n(1717),O=n.n(_),D=n(1661),M=n(329),P=m.default.DropdownPanel.Item,L=(i={},u()(i,window.rightToLeft?"right":"left",44),u()(i,"bottom",40),u()(i,"triangleStyle",(o={},u()(o,window.rightToLeft?"right":"left","16px"),u()(o,"top","100%"),o)),u()(i,"triangleDirection","bottom"),i);t.a=Object(p.connect)((function(e){return{selected:e.writer.webMode.isWebMode}}))(Object(d.memo)((function(e){var t=e.fill,n=e.selected,o=e.disabled,i=e.showText,a=e.dispatch,s=e.onClick,c=void 0===s?Function.prototype:s,u=Object(d.useState)(!0),p=l()(u,2),m=p[0],v=p[1],b=Object(d.useState)(!1),_=l()(b,2),S=_[0],N=_[1],T=Object(d.useState)(!1),x=l()(T,2),B=x[0],I=x[1];Object(d.useEffect)((function(){return window.addEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,W),function(){window.removeEventListener(g.default.view.AFTER_VIEW_MODE_CHANGED,W)}}),[W]),y()(g.default.webMode.ON_WEBMODE_GUIDE,(function(){I(!0);var e=setTimeout((function(){I(!1),clearTimeout(e)}),5e3)})),y()(g.default.names.DOC_SELECTION_CHANGED,window.utils.Lodash.debounce((function(e){var t=window.APP.data.selection,n=t.selContext.isInComment(),o=t.selContext.isCommentEditable;v(!(n&&o))}),100));var W=Object(d.useCallback)((function(e){var t=e.detail.typoMode;a(f.b(t===E.TYPO_MODE.MODE_WEB))}),[a]),R=Object(d.useMemo)((function(){return{icon:i?"":h.a.createElement(D.a,{size:16,fill:t||[M.iDefault]}),disabled:o||!m,selected:n,onClick:window.utils.Lodash.throttle((function(){var e=n?E.TYPO_MODE.MODE_PC:E.TYPO_MODE.MODE_WEB;e===E.TYPO_MODE.MODE_WEB&&window.__CONFIG__.wps.isAdaptWebView&&1!==window.APP.workspace.config.zoom&&g.default.dispatchEvent(g.default.zoom.DOC_SCALE,{zoom:100}),window.APP.viewUIL.onViewModeChanged(e,!1),window.collection("commandbar","click",(i?"page|":"statusbar_")+"webmode_"+(n?"off":"on")),c(),I(!1),N(!1)}),800,{trailing:!1})}}),[o,m,n,t]),A=window.APP.isReadOnly();return i?h.a.createElement(P,R,h.a.createElement(O.a,{icon:h.a.createElement(D.a,{size:16}),text:_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.webModeTrigger", "Full Page Mode")})):h.a.createElement("div",{onMouseEnter:function(){k.isPad||N(!0)},onMouseLeave:function(){k.isPad||N(!1)}},h.a.createElement(w.a,r()({size:"middle",title:A?_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page"):""},R)),!A&&h.a.createElement(C.a,r()({visible:B||S},L)))})))},9270:function(e,t,n){},9271:function(e,t,n){e.exports=n.p+"images/doc_web_mode_tips.890f42fb.svg"},9272:function(e,t,n){},956:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(146),i=n(1373),a=function(e){return{types:[o.HTTP_REQUEST,i.a.LOAD_UPDATE_NOTICES_SUCCESS,o.HTTP_FAILURE],callAPI:function(t){return t.get("/api/v3/office/tip/type/"+e).end()}}},r=function(e){return{types:o.HTTP_TYPES,callAPI:function(t){return t.get("/api/v3/office/tip/name/"+e).end()}}},s=function(e){return{types:o.HTTP_TYPES,callAPI:function(t){return t.post("/api/v3/office/tip/"+e).end()}}},l=null,c=function(e,t){var n={content:t};return{types:o.HTTP_TYPES,callAPI:function(t){return l&&l.abort(),(l=t.post("/api/v3/office/search/func/"+e).send(n)).end()}}}}}]);