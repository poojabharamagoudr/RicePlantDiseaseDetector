(window.webpackJsonp=window.webpackJsonp||[]).push([[576],{10231:function(e,t,n){},10232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldMountLoginGuide=void 0;var i=n(486),o=n(14),r=n(1532),a=n(564),l=n(67);t.shouldMountLoginGuide=function(e,t){var n=!t.isLogin||!e.user_acl.update,s=window.__WPSPLUGIN__.helper.has(window.__WPSPLUGIN__.type.LoginGuide);return!(0,o.hasQuery)("hideguide")&&(!(0,l.isPublish)()&&(!!(0,a.isReadingMode)()||(!!(t.isLogin&&i.canRequestForAuthForSecurityDoc&&(0,i.isEditLimitedSecurityDoc)())||(!!(0,a.isReadingMode)()||!(!window.__CONFIG__.isLoginGuide||!s)&&((0,r.isSuperPreview)()?((0,r.isReadOnlyAfterReload)(),!0):n)))))}},10233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getParentPopupLevel=t.popupClassName=void 0;t.popupClassName="component-dropdown-popup",t.getParentPopupLevel=function(e){for(;e&&1===e.nodeType;){if(e.classList.contains("component-dropdown-popup"))return parseInt(e.getAttribute("data-level"));e=e.parentElement}return 0}},10234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importDefault(n(227)),r=[],a=[];function l(){0}function s(e){void 0===e&&(e=1);var t=a.find((function(t){return t.level===e}));t&&(t.close(),a=a.filter((function(e){return e!==t})))}function c(e){return a.some((function(t){return t.level===e}))}t.default={addDropdown:function(e){s(e.level),a.push(e),l(),o.default.dispatchEvent(o.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0})},removeDropdown:function(e){o.default.dispatchEvent(o.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),a.find((function(t){return t.level===e.level&&e===t}))&&(a=a.filter((function(t){return t.level<e.level})),l())},closeDropdown:s,isExistDropdownLevel:c,hasDropdown:function(){return c(1)},getDropdownMaxLevel:function(){var e=a.map((function(e){return e.level}));return Math.max.apply(Math,i.__spreadArray(i.__spreadArray([],e,!1),[0],!1))},addConfirm:function(e){r.push(e),o.default.dispatchEvent(o.default.names.ON_MODAL_VISIBLE_CHANGE,{visible:!0})},removeConfirm:function(e){var t=r.indexOf(e);r.splice(t,1),o.default.dispatchEvent(o.default.names.ON_MODAL_VISIBLE_CHANGE,{visible:!1})},hasConfirm:function(){return r.length>0},hasSubConfirm:function(e){return r.indexOf(e)<r.length-1},removeAllConfirm:function(){for(var e=0;e<r.length;e++)r[e].close();r.splice(0,r.length)}}},10235:function(e,t,n){},1054:function(e,t,n){"use strict";n.r(t),n.d(t,"linkTypes",(function(){return a})),n.d(t,"getUrlByPlugin",(function(){return l}));var i=n(80),o=n.n(i),r=n(357),a={RangePermission:"RangePermission",Calculate:"Calculate",CellHistory:"CellHistory",AboutWps:"AboutWps",CellPicture:"CellPicture",AboutLaTeX:"AboutLaTeX",AboutFileSlim:"AboutFileSlim",FeedbackForm:"FeedbackForm",UncertainSubtotal:"UncertainSubtotal",RecordPermission:"RecordPermission",CoverProduction:"CoverProduction",WpsAIService:"WpsAIService",EtWpsAIWoa:"EtWpsAIWoa"},l=function(e){return new Promise((t=o()(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.default.has(r.default.types.Links)){t.next=6;break}return t.next=3,r.default.exec(r.default.types.Links,{type:e});case 3:return i=t.sent,n(i),t.abrupt("return");case 6:n(null);case 7:case"end":return t.stop()}}),t,void 0)}))),function(e){return t.apply(this,arguments)}));var t}},1055:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(2715);var o=i.__importDefault(n(238)),r=n(241),a=n(81),l=n(706),s=i.__importDefault(n(227)),c=i.__importDefault(n(2940)),u=i.__importStar(n(167)),d=i.__importDefault(n(2717)),f=i.__importDefault(n(322)),p=i.__importDefault(n(1210)),h=i.__importDefault(n(826)),m=function(e){function t(t){var n=e.call(this,t,t.tabKey)||this;return n.helper=null,n.state={showBtn:!1,enabledLeftBtn:!1,enabledRightBtn:!1},n.handleWindowResize=function(){n.props.visible&&n.adjustUI(!1,!1)},n.panelW=void 0,n.getItemsWidth=function(){var e=n.refWrap.current,t=n.refItemsWrap.current,i=e.clientWidth,o=Array.from(n.refItems.current.childNodes),r=n.helper.sum(o),a=t.scrollLeft;return{wrapWidth:i,allItemWidth:r,offsetWidth:t.offsetWidth,items:o,scrollLeft:a,wrap:e,itemsWrap:t,locationElement:n.locationElement}},n.adjustUI=(0,a.throttle)((function(e,t){if(!n.unmounted){var i=n.state,o=i.enabledLeftBtn,r=i.enabledRightBtn,a=n.helper.getBtnStatus({isLeft:e,isRight:t,enabledLeftBtn:o,enabledRightBtn:r,getItemsWidth:n.getItemsWidth}),l=a.showBtn,s=a.enabledLeftBtn,c=a.enabledRightBtn;n.setState({showBtn:l,enabledLeftBtn:s,enabledRightBtn:c})}}),100),n.handleLeftBtnClick=function(){n.state.enabledLeftBtn&&(n.adjustUI(!0,!1),s.default.dispatchEvent(s.default.names.CLOSE_DROPDOWN_PANEL))},n.handleRightBtnClick=function(){n.state.enabledRightBtn&&(n.adjustUI(!1,!0),s.default.dispatchEvent(s.default.names.CLOSE_DROPDOWN_PANEL))},n.touchTime=null,n.handleWheel=function(e){if(n.state.showBtn&&e.currentTarget.contains(e.target)){if(void 0!==e.wheelDelta&&e.wheelDelta%120!=0){var t=(new Date).getTime();if(t-n.touchTime<150)return;n.touchTime=t}e.deltaY>0||e.deltaX>0?n.handleRightBtnClick():(e.deltaY<0||e.deltaX<0)&&n.handleLeftBtnClick()}},n.handleScroll=function(e){n.refDiv.current.contains(e.target)&&(s.default.dispatchEvent(s.default.names.CLOSE_DROPDOWN_PANEL),n.throttleScroll())},n.throttleScroll=(0,a.throttle)((function(){if(!n.unmounted){var e=n.getItemsWidth(),t=e.allItemWidth,i=e.offsetWidth,o=e.scrollLeft,r=e.items,a=o>0,l=t-o>i+1;u.isIPad&&n.helper.setLeftItems(r,o),window.rightToLeft&&(a=t+o>i+1,l=o<0),n.setState({enabledLeftBtn:a,enabledRightBtn:l})}}),100),n.isVisible=function(){return n.props.visible},n.contains=function(e){var t;return null===(t=n.refWrap.current)||void 0===t?void 0:t.contains(e)},n.locationElement=null,n.location=function(e){if(n.locationElement=e,n.props.visible)n.adjustUI(!1,!1);else{var t={tabKey:n.props.tabKey};s.default.dispatchEvent(s.default.names.SWITCH_COMMANDBAR_TAB,t)}},n.add=function(e){var t=e.id,i=e.controlType,o=void 0===i?l.controlTypes.button:i,r=e.icon,a=void 0===r?null:r,s=e.caption,c=void 0===s?null:s,u=e.tooltip,d=void 0===u?null:u;return n.refCustom.current.add({id:t,icon:a,caption:c,tooltip:d,controlType:o})},n.remove=function(e){return n.refCustom.current.remove(e)},n.refDiv=o.default.createRef(),n.refItems=o.default.createRef(),n.refWrap=o.default.createRef(),n.refItemsWrap=o.default.createRef(),n.refCustom=o.default.createRef(),n.refBtn=o.default.createRef(),n.helper=new d.default,n}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.__WPSENV__.tabwraps.push(this),this.props.isAppReady&&this.initEvents()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize),this.refDiv.current.removeEventListener("wheel",this.handleWheel),this.refItemsWrap.current.removeEventListener("scroll",this.handleScroll),this.unmounted=!0},t.prototype.componentDidUpdate=function(e,t){var n=this.props,i=n.visible;n.isAppReady&&!e.isAppReady?this.initEvents():i&&!e.visible&&this.handleWindowResize()},t.prototype.initEvents=function(){this.handleWindowResize(),this.observerPanel(),window.addEventListener("resize",this.handleWindowResize),this.refDiv.current.addEventListener("wheel",this.handleWheel),this.refItemsWrap.current.addEventListener("scroll",this.handleScroll)},t.prototype.observerPanel=function(){var e=this,t=this.refItems.current;this.panelW=t.clientWidth,new MutationObserver((function(){var n=t.clientWidth;e.panelW!==n&&(e.panelW=n,e.handleWindowResize())})).observe(t,{childList:!0,subtree:!0})},t.prototype.render=function(){var e=this.props,t=e.visible,n=e.leftWrap,i=e.rightWrap,r=e.className,a=e.children,l=this.state,s=l.showBtn,u=l.enabledLeftBtn,d=l.enabledRightBtn,m=o.default.classNames({"kd-cmb-tab-wrap":!0,"show-roll-btn":s,hidden:!t},r),v=o.default.classNames({"items-container":1,disabled:window.__WPSENV__.cache_preview&&window.__WPSENV__.publish});return o.default.createElement("div",{ref:this.refDiv,className:m},o.default.createElement("div",{ref:this.refWrap,className:"tab-wrap"},o.default.createElement("div",{ref:this.refItemsWrap,className:"items-wrap"},o.default.createElement("div",{ref:this.refItems,className:v},n,a,o.default.createElement(c.default,{ref:this.refCustom}),i))),o.default.createElement(f.default,{ref:this.refBtn,size:"small",className:"roll-btn left-btn",disabled:!u,onClick:this.handleLeftBtnClick,icon:o.default.createElement(p.default,{size:16})}),o.default.createElement(f.default,{size:"small",className:"roll-btn right-btn",disabled:!d,onClick:this.handleRightBtnClick,icon:o.default.createElement(h.default,{size:16})}))},t.defaultProps={isAppReady:!0,leftWrap:null,rightWrap:null,className:"wo-cmb-tab"},t}(window.CommandBarComponent);t.default=(0,r.connect)((function(e){return{isAppReady:e.public.network.isAppReady}}),null,null,{forwardRef:!0})(m)},1056:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var i=n(238),o=n.n(i),r=n(262),a=(n(1173),n(488));function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===l(r)?r:String(r)),i)}var o,r}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p={WIDTH:42,MAX_WIDTH:58,PADDING:3,TRANSLATE:21},h={WIDTH:28,MAX_WIDTH:44,PADDING:2,TRANSLATE:14},m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,i,l=u(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this,e)).inputRef=o.a.createRef(),t.coreRef=o.a.createRef(),t.state={value:e.checked||!1,coreWidth:e.width||0,buttonStyle:{transform:""},isMount:!1},t}return t=d,(n=[{key:"componentDidMount",value:function(){var e=this;if(0===this.props.width){var t=p.WIDTH;return"small"===this.props.size&&(t=h.WIDTH),void this.setState({coreWidth:t},(function(){e.updateSwitch(),e.setState({isMount:!0})}))}this.updateSwitch(),this.setState({isMount:!0})}},{key:"componentDidUpdate",value:function(e){var t=this;e.checked!==this.props.checked&&this.setState({value:this.props.checked},(function(){t.updateSwitch()})),e.width!==this.props.width&&this.setState({coreWidth:this.props.width})}},{key:"updateSwitch",value:function(){this.handleButtonTransform(),(this.props.onColor||this.props.offColor)&&this.setBackgroundColor()}},{key:"setBackgroundColor",value:function(){var e=this.state.value===this.props.onValue?this.props.onColor:this.props.offColor;this.coreRef.current&&(this.coreRef.current.style.borderColor=e,this.coreRef.current.style.backgroundColor=e)}},{key:"handleChange",value:function(e){var t=this;this.setState({value:e.target.checked?this.props.onValue:this.props.offValue},(function(){t.updateSwitch(),t.props.onChange&&t.props.onChange(t.state.value)}))}},{key:"getTranslate",value:function(){var e=this.state.coreWidth,t=p.TRANSLATE,n=p.PADDING;return"small"===this.props.size&&(t=h.TRANSLATE,n=h.PADDING),{on:"translate(".concat(e-t,"px, ").concat(n,"px)"),off:"translate(".concat(n,"px, ").concat(n,"px)")}}},{key:"handleButtonTransform",value:function(){var e=this.state,t=e.value,n=e.buttonStyle,i=e.isMount,o=this.getTranslate();n.transform=t===this.props.onValue?o.on:o.off,n.transition=i?"transform .3s":"",this.setState({buttonStyle:n})}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.className,i=e.style,l=e.disabled,s=e.onValue,c=e.size,u=e.loading,d=this.state,f=d.value,p=d.coreWidth,h=d.buttonStyle,m=Object(r.a)("kd-switch",c&&"kd-switch--".concat(c),l&&"is-disabled",u&&"is-loading",f===s&&"is-checked",n),v="small"===c?"12":"18";return o.a.createElement("label",{className:m,style:i},o.a.createElement("input",{className:"kd-switch-input",type:"checkbox",checked:f===s,name:t,ref:this.inputRef,disabled:l||u,onChange:this.handleChange.bind(this)}),o.a.createElement("span",{className:"kd-switch-core",ref:this.coreRef,style:{width:p+"px"}},o.a.createElement("span",{className:"kd-switch-button",style:Object.assign({},h)},u&&o.a.createElement(a.a,{size:v,strokeWidth:"1"}))))}}])&&s(t.prototype,n),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.Component);m.defaultProps={checked:!1,disabled:!1,width:0,size:"",onValue:!0,offValue:!1,onColor:"",offColor:"",name:""}},11502:function(e,t,n){},11503:function(e,t,n){},11504:function(e,t,n){e.exports=function(e,t){n.e(578).then(n.bind(null,16673)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11505:function(e,t,n){e.exports=function(e,t){n.e(579).then(n.bind(null,13109)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11506:function(e,t,n){},11507:function(e,t,n){},11508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=window.__WPSPLUGIN__,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getAuthMarkerPlugin=function(){return i.__awaiter(t,void 0,void 0,(function(){var e,t,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e=this,[4,r.loader.loadSingleInstance({pluginType:"CompanyAuthMarker"})];case 1:return e.pluginInstance=i.sent(),t=this.pluginInstance.mount,n=document.querySelector("#container_company_sign"),console.log("container",n),this.cleanup=t(n),[2]}}))}))},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.hasPlugin=r.helper.has("CompanyAuthMarker"),this.hasPlugin&&this.getAuthMarkerPlugin()},t.prototype.componentWillUnmount=function(){this.hasPlugin&&this.pluginInstance&&this.cleanup()},t.prototype.render=function(){return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"container_company_sign",id:"container_company_sign"}))},t}(o.PureComponent);t.default=a},11509:function(e,t,n){},11510:function(e,t,n){},11511:function(e,t,n){},11512:function(e,t,n){},11513:function(e,t,n){},11514:function(e,t,n){},11515:function(e,t,n){},11516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initLangGuidePlugin=t.pluginVisible=void 0;var i=n(5),o=window.__WPSPLUGIN__.loader;t.pluginVisible=o.search({pluginType:"LocaleI18n"}),t.initLangGuidePlugin=function(e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a;return i.__generator(this,(function(i){switch(i.label){case 0:return t.pluginVisible?[4,o.load({pluginType:"LocaleI18n"})]:[2];case 1:return n=i.sent(),[4,new n({initParams:r={containerEle:e}}).plugin];case 2:return(a=i.sent()).init&&a.init(r),[2]}}))}))}},11517:function(e,t,n){e.exports=function(e,t){n.e(587).then(n.bind(null,13112)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importDefault(n(238)),r=i.__importDefault(n(244)),a=i.__importDefault(n(82));n(11519);var l=i.__importDefault(n(312)),s=i.__importDefault(n(243)),c=i.__importDefault(n(1723)),u=i.__importDefault(n(362)),d=n(14),f=i.__importDefault(n(5852)),p=i.__importDefault(n(351)),h=n(81),m=i.__importDefault(n(227)),v=n(1202),b=u.default.Item,g=l.default.iconTypes.size16,y=window.__WPSPLUGIN__,w=window.CommandBarComponent,_=w.cmbIds.$public,E=function(e){function t(t){var n=e.call(this,t,_.ShareLink)||this;return n.handleConnected=function(){n.setState({isOffline:!1})},n.handleDisconnected=function(){n.setState({isOffline:!0})},n.handleChangeShareState=function(e){"switch"===e.detail.from&&!0===e.detail.coopSwitch?(n.setState({dropdownVisible:!0}),n.setState({isSupportCollaborationSwitch:!0}),n.handleBtnClick()):"switch"===e.detail.from&&!1===e.detail.coopSwitch&&(n.setState({isSupportCollaborationSwitch:!1}),n.handleDropdownVisible(!1))},n.loadSelfPlugin=function(){return i.__awaiter(n,void 0,void 0,(function(){var e,t,n=this;return i.__generator(this,(function(i){switch(i.label){case 0:return e=y.loader,t=y.type,[4,e.loadSingleInstance({pluginType:t.ShareFile}).then((function(e){n.setState({pluginLoaded:!0}),n.setPlugin(e),e.isSupportShareFileV2&&e.isSupportShareFileV2()&&n.handleEnableShareBtnWithStatus()})).catch((function(e){return n.setState({pluginLoaded:!1}),e}))];case 1:return i.sent(),[2]}}))}))},n.setPlugin=function(e){return i.__awaiter(n,void 0,void 0,(function(){var t;return i.__generator(this,(function(n){switch(n.label){case 0:return t=[],e.show?[4,e.show()]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=this.oldPluginPolyfill(e),n.label=3;case 3:return this.setState({items:t},this.setCmdBar),this.openShare(t),[2]}}))}))},n.openShare=function(e){if((0,d.hasQuery)(f.default.openshare)){if((0,d.removeQuery)(f.default.openshare),0===e.length)return;n.handleItemClick(e[0])}},n.setCmdBar=function(){var e=r.default.findDOMNode(n);window.__WPSENV__.commandbars.push({el:e,text:n.shareVisible?_i18n("applications.public.components.commandbars.Header.ShareLink.share", "Share"):_i18n("applications.public.components.commandbars.Header.ShareLink.invite", "Invite to Edit")})},n.handleVisible=function(e){n.setState({visible:e})},n.handleDropdownVisible=(0,h.throttle)((function(e){n.state.pluginLoaded&&0!==n.state.items.length?(n.setState({dropdownVisible:e},(function(){e&&n.handleBtnClick()})),window.collection("share_btn_click",{location:"toolbar",phase:2,state:n.state.isOpenShare?"after":"before",entrance:"preview"})):console.log("ShareFile Plugin Not Ready")}),1e3),n.handleBtnClick=function(){var e=n.state.items;0!==e.length&&n.handleItemClick(e[0])},n.handleItemClick=function(e){var t=n.props.file,i={fid:t.id,source:"weboffice",fname:t.name+t.ext,currentTimeStamp:(new Date).getTime(),eventFrom:"click"};(n.state.isEnableShareBtnWithStatus||(0,v.isShowCollaborationSwitch)())&&(i.shareEl=document.querySelector(".share-dropdown-panel"),i.onClose=function(){n.setState({dropdownVisible:!1})},i.onShareStateChange=function(e){e&&n.setState({isOpenShare:!!e.isShared})}),n.state.isSupportCollaborationSwitch&&(i.sharePage="KShareV3"),console.log("11111 shareParam::",i),n.setState({visible:!1}),e.click(i),window.collection2("header_share"),window.collectionOnce(),n.setState({isSupportCollaborationSwitch:!1})},n.renderPanel=function(){var e=n.state.items.map((function(e,t){return o.default.createElement(b,{key:t,value:e,onClick:n.handleItemClick},e.btnName)}));return o.default.createElement(u.default,{className:"share-dropdown-list-panel"},e)},n.renderBtns=function(){var e=n.state.items;return n.state.isEnableShareBtnWithStatus||(0,v.isShowCollaborationSwitch)()?n.renderDropdown():e.length<=1?n.renderTextBtn():n.renderDropdownGroup()},n.shareVisible=y.helper.has(y.type.ShareFile),n.state={items:[],visible:!1,dropdownVisible:!1,isOpenShare:!1,isEnableShareBtnWithStatus:!1,pluginLoaded:!1,isOffline:!1,isSupportCollaborationSwitch:!1},n}return i.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.user,n=e.file,i=e.isAppReady;this.shareVisible&&i&&(this.loadSelfPlugin(),this.setState({isOpenShare:!!n.link_url}));var o=n.office_type===a.default.pdf;window.__CONFIG__.isShowHeaderInviteBtn&&!o&&n.user_acl.share&&t.isLogin&&this.setCmdBar(),window.addEventListener(m.default.names.network.ON_CONNECTED,this.handleConnected),window.addEventListener(m.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener(m.default.names.KDOCS_SHARE_STATUS_CHANGED,this.handleChangeShareState)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.isAppReady,i=t.file;e.isAppReady!==n&&n&&this.shareVisible&&(this.loadSelfPlugin(),this.setState({isOpenShare:!!i.link_url}))},t.prototype.componentWillUnmount=function(){window.removeEventListener(m.default.names.network.ON_CONNECTED,this.handleConnected),window.removeEventListener(m.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener(m.default.names.KDOCS_SHARE_STATUS_CHANGED,this.handleChangeShareState)},t.prototype.oldPluginPolyfill=function(e){return[{btnName:_i18n("applications.public.components.commandbars.Header.ShareLink.share", "Share"),click:e.shareFile.bind(e)}]},t.prototype.handleInviteClick=function(){window.openEditInvite()},t.prototype.handleEnableShareBtnWithStatus=function(){var e=window.__CONFIG__.shareLinkDisableCompanyUser;if(window.__WPSENV__.file_info.user.company_id&&e)return this.setState({isEnableShareBtnWithStatus:!1}),void this.setCache(!1);var t=this.getCache();if("boolean"!=typeof t){var n=window.__CONFIG__.shareLinkProbability,i=function(e,t){return!!t&&t-1>=parseInt(e.slice(-2))}(this.props.user.id,n);this.setState({isEnableShareBtnWithStatus:i}),this.setCache(i)}else this.setState({isEnableShareBtnWithStatus:t})},t.prototype.getCache=function(){try{var e=JSON.parse(localStorage.getItem("SHOW_SHARE_V2_".concat(this.props.user.id)));return e&&Date.now()<e.expire?!!e.value:null}catch(e){return null}},t.prototype.setCache=function(e){e&&localStorage.setItem("SHOW_SHARE_V2_".concat(this.props.user.id),JSON.stringify({expire:Date.now()+864e5,value:e?1:0}))},t.prototype.renderDropdown=function(){var e=this.state,t=e.dropdownVisible,n=e.isOffline,i="share-dropdown-panel";(this.state.isSupportCollaborationSwitch||(0,v.isSupportCollaborationSwitch)())&&(i+=" share-dropdown-panel-ksharev3");var r=o.default.createElement("div",{className:i}),a=this.renderDropdownBtn();return o.default.createElement(p.default,{disabled:n,isSetHeight:!0,panel:r,visible:t,onVisibleChange:this.handleDropdownVisible},a)},t.prototype.renderDropdownBtn=function(){var e=this.state.isOffline;return o.default.createElement(s.default,{size:"medium",disabled:e,theme:!0,type:"primary","alt-hint-keep":"true"},_i18n("applications.public.components.commandbars.Header.ShareLink.share", "Share"))},t.prototype.renderTextBtn=function(){var e=this.state.isOffline;return o.default.createElement(s.default,{size:"medium",disabled:e,style:{width:"54px"},theme:!0,type:"primary","alt-hint-keep":"true",onClick:this.handleBtnClick}," ",_i18n("applications.public.components.commandbars.Header.ShareLink.share", "Share"))},t.prototype.renderDropdownGroup=function(){var e=this.state,t=e.items,n=e.isOffline,i=e.visible;return o.default.createElement(c.default,{disabled:n,type:"primary",className:"share-dropdown-group",iconContent:t[0].btnName,isAuto:!0,onIconClick:this.handleBtnClick,visible:i,onVisibleChange:this.handleVisible},this.renderPanel())},t.prototype.render=function(){var e=this.props,t=e.user,n=e.file,i=n.office_type===a.default.pdf;return this.shareVisible?o.default.createElement("div",{className:"share-btn"},this.renderBtns()):!(!window.__CONFIG__.isShowHeaderInviteBtn||i||!n.user_acl.share||!t.isLogin)&&o.default.createElement(l.default,{ref:this.refEdit,showBorder:!0,title:_i18n("applications.public.components.commandbars.Header.ShareLink.invite", "Invite to Edit"),iconType:g.invite_share,onClick:this.handleInviteClick})},t}(w);t.default=E},11519:function(e,t,n){},11520:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(10231);var o=i.__importDefault(n(238)),r=i.__importDefault(n(243)),a=i.__importDefault(n(227)),l=n(10232);t.default=function(e){var t=e.inSubMenu,n=e.file,i=e.user,s=i.isLogin,c=function(){a.default.dispatchEvent(a.default.names.ON_EDIT),t&&a.default.dispatchEvent(a.default.names.CLOSE_DROPDOWN_PANEL)};return(0,l.shouldMountLoginGuide)(n,i)?o.default.createElement("div",{className:"login-guid-btn"},o.default.createElement(r.default,{size:"medium",type:"secondary",highlight:!0,onClick:c,theme:!0},s?_i18n("applications.public.components.commandbars.Header.HeaderRight.edit", "Apply for Editing Permissions"):_i18n("applications.public.components.commandbars.Header.HeaderRight.login", "Login"))):null}},11521:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11522);var o=i.__importStar(n(238)),r=i.__importDefault(n(227)),a=i.__importDefault(n(321)),l=i.__importDefault(n(362)),s=i.__importDefault(n(243)),c=i.__importDefault(n(82)),u=i.__importDefault(n(385)),d=i.__importDefault(n(616)),f=n(1914),p=window.__WPSPLUGIN__.helper,h=window.__WPSPLUGIN__.loader,m=p.has(p.types.OpenWps),v=l.default.Item,b=window.officeType===c.default.spreadsheet||window.officeType===c.default.writer||window.officeType===c.default.pdf||window.officeType===c.default.presentation;t.default=o.default.memo((function(e){var t=this,n=e.user,c=e.openSuccess,g=e.isAppReady,y=e.inSubMenu,w=(0,o.useState)(!1),_=w[0],E=w[1],C=(0,o.useState)([]),S=C[0],k=C[1],O=(0,o.useRef)();(0,o.useEffect)((function(){g&&m&&h.loadSingleInstance({pluginType:p.types.OpenWps}).then((function(e){return i.__awaiter(t,void 0,void 0,(function(){var t;return i.__generator(this,(function(n){switch(n.label){case 0:return O.current=e,[4,O.current.show()];case 1:return(t=n.sent()).length>0&&(k(t),window.collection2("header_openwps_show_".concat(t.length))),[2]}}))}))}))}),[g]);var P=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,n;return i.__generator(this,(function(i){switch(i.label){case 0:return console.time("openWPS click"),t={},[4,(0,f.geneLocalIndexInfo)()];case 1:return(n=i.sent())&&(t.pageIdxInfo=n),O.current.click(e,t),console.timeEnd("openWPS click"),y?r.default.dispatchEvent(r.default.names.CLOSE_DROPDOWN_PANEL):E(!1),window.collection2("header_openwpsmore_".concat(e)),[2]}}))}))},M=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t;return i.__generator(this,(function(n){switch(n.label){case 0:return console.time("openWPS click"),e={},[4,(0,f.geneLocalIndexInfo)()];case 1:return(t=n.sent())&&(e.pageIdxInfo=t),O.current.click(S[0].id,e),console.timeEnd("openWPS click"),E(!1),window.collection2("header_openwps"),[2]}}))}))},T=function(e){E(e),e&&window.collection2("header_openwpsmore")},I=function(){var e=o.default.createElement(l.default,null,S.map((function(e){return o.default.createElement(v,{key:e.id,value:e.id,onClick:P},e.btnName)})));return o.default.createElement(a.default,{panel:e,className:"wps-open-group",visible:_,onVisibleChange:T},o.default.createElement(s.default,{className:"wps-open-btn",size:"medium",active:_,type:"secondary",isDropdown:!0},S[0].btnName))},D=function(){return S.map((function(e){var t=e.id,n=e.btnName;return o.default.createElement(u.default,{key:t,value:t,onClick:P},n)}))};return m&&n.isLogin&&c&&b&&g&&S.length>0?y?1===S.length?o.default.createElement(o.default.Fragment,null,D()):o.default.createElement(d.default,{title:S[0].btnName},D()):1===S.length?o.default.createElement(s.default,{className:"wps-open-btn",size:"medium",type:"secondary",onClick:M,altHintKeep:"true"},S[0].btnName):I():null}))},11522:function(e,t,n){},11523:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11524);var o=i.__importStar(n(238)),r=i.__importDefault(n(243)),a=i.__importDefault(n(227)),l=i.__importDefault(n(11525)),s=n(667);t.default=function(e){var t=e.isAppReady,n=e.inSubMenu,i=(0,o.useState)(!1),c=i[0],u=i[1],d=(0,o.useState)(!0),f=d[0],p=d[1],h=function(){n&&a.default.dispatchEvent(a.default.names.CLOSE_DROPDOWN_PANEL)},m=function(){a.default.dispatchEvent(a.default.names.file.ON_TOGGLE_DRAFT,{enable:!1}),h()},v=function(){a.default.dispatchEvent(a.default.names.file.ON_SAVE_DRAFT),h()};(0,s.useWindowEvent)(a.default.names.file.ON_SAVE_VERSION,(function(){u(!0)}));var b=function(){p(!1),u(!1)};(0,o.useEffect)((function(){return t&&(p(!0),window.addEventListener("click",b),window.addEventListener("touchstart",b)),function(){window.removeEventListener("click",b),window.removeEventListener("touchstart",b)}}),[t]);return o.default.createElement("div",{className:"header-right-draft-btn",onClick:b,onTouchStart:b},o.default.createElement(l.default,{text:_i18n("applications.public.components.commandbars.Header.HeaderRight.Draft.exitTip", "Trial calculation mode has been entered"),show:f},o.default.createElement(r.default,{size:"medium",type:"primary",onClick:m,className:"exit-draft-btn"},_i18n("applications.public.components.commandbars.Header.HeaderRight.Draft.exitDraft", "Exit trial calculation mode"))),o.default.createElement(l.default,{text:_i18n("applications.public.components.commandbars.Header.HeaderRight.Draft.saveTip", "To save back to the original document, click this button"),show:c},o.default.createElement(r.default,{className:"save-btn",size:"medium",type:"secondary",onClick:v},_i18n("applications.public.components.commandbars.Header.HeaderRight.Draft.saveDraft", "saving..."))))}},11524:function(e,t,n){},11525:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11526);var o=i.__importStar(n(238)),r=i.__importDefault(n(248)),a=(0,o.memo)((function(e){var t=e.text,n=e.show,i=void 0===n||n,a=e.children;return o.default.createElement("div",{className:"notice-tip-wrap"},a,o.default.createElement("div",{className:"notice-tip "+(i?"show":"")},o.default.createElement(r.default,{type:"16 tip"}),o.default.createElement("div",{className:"notice-tip-content"},t)))}));t.default=a},11526:function(e,t,n){},11527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=i.__importDefault(n(227)),a=i.__importDefault(n(5023)),l=n(7835);n(11528);var s=i.__importDefault(n(82)),c=i.__importDefault(n(243)),u=n(11529),d=window.officeType!==s.default.image,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={count:0},t.setCount=function(e){var n=parseInt(e.toString())||0;t.setState({count:n})},t.handleClick=function(){t.props.inSubMenu&&r.default.dispatchEvent(r.default.names.CLOSE_DROPDOWN_PANEL),l.AtMessageBtnplugin&&l.AtMessageBtnplugin.click()},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){if(l.AtMessageBtnplugin&&(l.AtMessageBtnplugin.setCountFunction&&l.AtMessageBtnplugin.setCountFunction(this.setCount),l.AtMessageBtnplugin.getCount)){var e=l.AtMessageBtnplugin.getCount();this.setCount(e||0)}},t.prototype.render=function(){if(!d)return!1;var e=this.props,t=e.inSubMenu,n=e.user;if(!l.pluginVisible||!n.isLogin)return null;var i=this.state.count,r=i>99?"···":i,s=o.default.classNames({"component-badge-at-inbox":1,"component-badge-more":i>99});return t?o.default.createElement(u.Item,{onClick:this.handleClick},_i18n("applications.public.components.commandbars.Header.HeaderRight.AtBtn.title", "Mention")):o.default.createElement(a.default,{content:r,show:i>0,className:s,color:"#417FF9"},o.default.createElement(c.default,{type:"secondary",icon:!0,title:_i18n("applications.public.components.commandbars.Header.HeaderRight.AtBtn.title", "Mention"),onClick:this.handleClick}))},t}(o.PureComponent);t.default=f},11528:function(e,t,n){},11529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubMenu=t.PanelSize=t.Divider=t.Searcher=t.Item=t.Footer=t.Header=void 0;var i=n(5);n(11530);var o=i.__importStar(n(238)),r=n(272),a=i.__importDefault(n(11531)),l=i.__importDefault(n(7257)),s=i.__importDefault(n(3425)),c=i.__importDefault(n(11533));t.Header=c.default;var u=i.__importDefault(n(11535));t.Footer=u.default;var d=i.__importDefault(n(7836));t.Item=d.default;var f=i.__importDefault(n(11536));t.SubMenu=f.default;var p=i.__importDefault(n(11538));t.Searcher=p.default;var h=i.__importDefault(n(11539)),m=i.__importDefault(n(7258));t.Divider=m.default;var v,b=i.__importStar(n(273)),g=n(240),y=i.__importDefault(n(227));!function(e){e.auto="auto",e.small="240",e.middle="340",e.large="480"}(v||(v={})),t.PanelSize=v;var w="right",_="down",E="rightDown",C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={width:null,height:null,minWidth:null,minHeight:null},t.shortcutKey=null,t.selectFirstItem=function(){var e;null===(e=t.refDiv.current)||void 0===e||e.preSelectFirst()},t.handleEsc=function(e){t.props.onEsc&&t.props.onEsc(e)},t.handleEnter=function(e){t.props.onEnter&&t.props.onEnter(e)},t.handleScroll=function(){var e=t.props,n=e.scrollEndBottom,i=e.onScroll;if(i){var o=t.getContainer(),r=o.scrollTop;r+o.clientHeight+n>=o.scrollHeight&&i({scrollTop:r})}},t.handleItemHover=function(e,n){void 0===n&&(n=!1),t.props.onItemHover&&t.props.onItemHover(null==e?void 0:e.parentElement,n,t)},t.handleDragMouseDown=function(e){var n=document.activeElement;(0,g.stopBubble)(e);var i=e.clientX,o=e.clientY,r=e.target,a=e.currentTarget.getAttribute("data-orien");r.setCapture&&r.setCapture();var l=t.state,s=l.width,c=l.height,u=l.minWidth,d=l.minHeight;document.onmousemove=function(e){(0,g.stopBubble)(e);var n=e.clientX,r=e.clientY,l=Math.max(u,s+n-i),f=Math.max(d,c+r-o);a===w?f=c:a===_&&(l=s),t.setState({width:l,height:f},(function(){y.default.dispatchEvent(y.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.getContainer()})}))},document.onmouseup=function(e){(0,g.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,r.releaseCapture&&r.releaseCapture(),n.focus()}},t.getContainer=function(){var e;return null===(e=t.refDiv.current)||void 0===e?void 0:e.getElement()},t.getPanelStyle=function(){if(t.props.canResize){var e=t.state;return{width:e.width,height:e.height}}return t.props.style},t.refDiv=o.default.createRef(),t.refContent=o.default.createRef(),t}return i.__extends(t,e),t.prototype.componentDidMount=function(){if(this.shortcutKey=new a.default(this.getContainer(),this.handleEsc,this.handleEnter),this.props.canResize){var e=this.getContainer();if(e){var t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}}},t.prototype.componentWillUnmount=function(){this.shortcutKey.destructor()},t.prototype.scrollToEnd=function(){var e=this.refContent.current;setTimeout((function(){var t=e.scrollTop,n=e.scrollHeight-e.clientHeight;(0,r.run)({element:e,start:t,end:n,keepEnd:!0,useFrame:!0,setValue:function(t){e.scrollTop=t}})}))},t.prototype.getClassNames=function(){var e,t=this.props,n=t.className,i=t.allPrefix,r=t.size,a=t.isVirtualColor;return o.default.classNames(((e={})[l.default.panelCs]=!0,e["is-virtual"]=a,e["all-prefix-icon"]=i,e["panel-size-".concat(r)]=r!==v.auto,e),n)},t.prototype.renderContent=function(){var e=this.props,t=e.children,n=e.showSearch,i=e.onFilter,r=e.isEmpty,a=null,l=null,s=o.default.Children.map(t,(function(e){if(!e)return e;if(e.type===c.default)a=e;else{if(e.type!==u.default)return e;l=e}})),d=i&&{display:"block"};return o.default.createElement(o.default.Fragment,null,a,n&&o.default.createElement(p.default,null),i&&o.default.createElement(h.default,{onChange:i}),o.default.createElement("div",{ref:this.refContent,className:"kd-component-public-panel-content",onScroll:this.handleScroll},s,(n||i&&r)&&o.default.createElement("div",{className:"panel-search-empty",style:d},_i18n("applications.ksheet.components.general.KSPanel.empty", "No matched data"))),l)},t.prototype.render=function(){var e=this.props,t=e.loadingVisible,n=e.onMouseEnter,r=e.onMouseLeave,a=e.selectable,l=e.checkable,c=e.canResize,u=e.isListenEvent,d=e.altStartMode,f=i.__rest(e,["loadingVisible","onMouseEnter","onMouseLeave","selectable","checkable","canResize","isListenEvent","altStartMode"]),p=this.getPanelStyle(),h=this.getClassNames();return o.default.createElement(s.default,i.__assign({ref:this.refDiv,className:h,style:p,"data-keep-edit":!0,isListenEvent:u,"alt-start-mode":d,"alt-hint-keep":!0,selectable:a,checkable:l,onItemHover:this.handleItemHover,onMouseEnter:n,onMouseLeave:r},f),!t&&this.renderContent(),c&&o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"drag-hand rightBottom","data-orien":E,onMouseDown:this.handleDragMouseDown},o.default.createElement(b.default,{iconType:b.other.drag_right_bottom})),o.default.createElement("div",{className:"drag-hand right","data-orien":w,onMouseDown:this.handleDragMouseDown}),o.default.createElement("div",{className:"drag-hand bottom","data-orien":_,onMouseDown:this.handleDragMouseDown})))},t.Item=d.default,t.defaultProps={size:v.auto,enabledHotKey:!0,scrollEndBottom:10,selectable:!1,checkable:!1,triggerSubMenuAction:"hover"},t}(o.PureComponent);t.default=C},11530:function(e,t,n){},11531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(246)),r=n(240),a=n(10233),l=n(11532),s=i.__importDefault(n(10234)),c=i.__importDefault(n(7257)),u=function(){function e(e,t,n){var i=this;this.handleKeyDown=function(e){if(!s.default.isExistDropdownLevel(i.popupLevel+1)&&!(0,l.tabSwitchFocs)(i.panel,e)){var t,n=o.default.getKey(e),a=e.target,u=(0,r.isInput)(a),d=(0,r.isMultiLineInput)(a),f=a.hasAttribute("data-keep-wsad");if(n!==o.Keys.Esc)if(n!==o.Keys.Enter){if(n!==o.Keys.ArrowLeft)if(n!==o.Keys.ArrowRight);else u&&!f||(t=i.getSelectItem())&&t.classList.contains("kd-component-public-sub-menu")&&t.click();else if((!u||f)&&i.popupLevel>1){var p="".concat(c.default.panelCs,'[data-level="').concat(i.popupLevel-1,'"]'),h=document.body.querySelector(p);if(h)h.querySelector(".kd-component-public-sub-menu.selected")&&s.default.closeDropdown(i.popupLevel)}}else d&&!f||((t=i.getSelectItem())&&((0,r.stopBubble)(e),t.click()),i.onEnter(e));else i.onEsc(e)}},this.isInPanel=c.default.isInPanel(e),this.isInPanel||(this.panel=e,this.onEsc=t,this.onEnter=n,setTimeout((function(){i.popupLevel=(0,a.getParentPopupLevel)(e),i.popupLevel>0&&window.addEventListener("keydown",i.handleKeyDown)})))}return e.prototype.destructor=function(){!this.isInPanel&&this.popupLevel>0&&window.removeEventListener("keydown",this.handleKeyDown)},e.prototype.getSelectItem=function(){var e=this.panel.querySelector(".kd-menu-item.hover");return e&&c.default.isEnabledElement(e)?e:null},e}();t.default=u},11532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tabSwitchFocs=t.findCanFocusElements=void 0;var i=n(5),o=i.__importStar(n(240)),r=i.__importStar(n(246));function a(e){if(1!==e.nodeType)return!1;if(!function(e){var t=e;return t.offsetHeight>0&&t.offsetWidth>0}(e))return!1;var t=e.hasAttribute("tabindex")?parseInt(e.getAttribute("tabindex")):-1;return!(!o.isInput(e)&&t<0)&&"none"!==window.getComputedStyle(e).pointerEvents}function l(e){"INPUT"===e.tagName||"TEXTAREA"===e.tagName?o.setInputFocus(e):e.focus()}function s(e){for(var t=[],n=e.querySelectorAll("*"),i=0;i<n.length;i++){var o=n[i];a(o)&&t.push(o)}return t}t.findCanFocusElements=s,t.tabSwitchFocs=function(e,t){var n=r.default.isMatchKey(t,r.Keys.Tab),i=r.default.isMatchShortCutKey(t,[r.Keys.Shift,r.Keys.Tab]);if(!n&&!i)return!1;t.preventDefault();var o=s(e);if(0===o.length)return!0;var c=o.indexOf(document.activeElement);if(-1===c){var u=function(e){var t=e.querySelector(".focus");if(!t)return null;if(a(t))return t;var n=s(t);return n.length?n[0]:null}(e);return l(u=u||o[0]),!0}return n&&c<o.length-1?(l(o[c+1]),!0):!!(i&&c>0)&&(l(o[c-1]),!0)}},11533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=i.__importDefault(n(7258)),a=i.__importDefault(n(7836));t.default=o.default.memo((function(e){var t=e.className,n=e.divider,i=e.children,l=(0,o.useMemo)((function(){return o.default.classNames({"kd-component-public-panel-header":1,"has-panel-item":i.type===a.default},t)}),[t,i]);return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:l},i),n&&o.default.createElement(r.default,null))}))},11534:function(e,t,n){},11535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=i.__importDefault(n(7258)),a=i.__importDefault(n(7836));t.default=o.default.memo((function(e){var t=e.className,n=e.divider,i=e.children,l=(0,o.useMemo)((function(){return o.default.classNames({"kd-component-public-panel-footer":1,"has-panel-item":i.type===a.default},t)}),[t,i]);return o.default.createElement(o.default.Fragment,null,n&&o.default.createElement(r.default,null),o.default.createElement("div",{className:l},i))}))},11536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11537);var o=i.__importStar(n(238)),r=i.__importDefault(n(2941)),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.children,a=i.__rest(e,["title","children"]);return o.default.createElement(r.default,i.__assign({label:t},a),n)},t}(o.PureComponent);t.default=a},11537:function(e,t,n){},11538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(10235);var o=i.__importStar(n(238)),r=n(81),a=i.__importStar(n(295)),l=i.__importDefault(n(7257)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyword="",t.handleInputChange=(0,r.debounce)((function(){if(t.refInput.current){var e=t.refInput.current.getInput();if(e&&!t.refInput.current.isChineseInputting){var n=t.getContentElement();if(n){var i=e.value.trim(),o=i.toLowerCase(),r=t.props,a=r.flexHeight,s=r.onChange;a||(o?t.keyword||(n.style.height="".concat(n.offsetHeight,"px")):n.style.height=""),t.keyword=i;for(var c,u=[],d=n.getElementsByClassName("kd-menu-item"),f=0;f<d.length;f++){var p=d[f],h=p.innerText.trim(),m=-1!==h.toLowerCase().indexOf(o);m&&u.push(h),p.style.display=m?"":"none",!c&&m&&(c=p)}var v=n.querySelector(".kd-component-public-search-empty");if(v&&(v.style.display=c?"":"block"),o&&c)l.default.addHoverItem(c);else{var b=n.querySelector(".kd-menu-item.hover");b&&l.default.removeHoverItem(b)}s&&s(t.keyword,u)}else console.debug("搜索框必须在panel/panel-header内才支持搜索")}}}),100),t.refDiv=o.default.createRef(),t.refInput=o.default.createRef(),t}return i.__extends(t,e),t.prototype.focus=function(){this.refInput.current.focus()},t.prototype.clearSearch=function(){this.refInput.current.getInput().value="",this.handleInputChange()},t.prototype.getContentElement=function(){var e=this.refDiv.current.parentElement;return e.classList.contains("kd-component-public-panel-header")&&(e=e.parentElement),e.querySelector(".kd-component-public-panel-content")},t.prototype.render=function(){var e=this.props.className,t=o.default.classNames({"kd-component-public-panel-searcher":!0},e);return o.default.createElement("div",{ref:this.refDiv,className:t},o.default.createElement(a.default,{ref:this.refInput,showClean:!1,autoFocus:!0,maxLength:500,placeholder:this.props.placeholder,iconType:a.size16.search,onChange:this.handleInputChange}))},t}(o.PureComponent);t.default=s},11539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(10235);var o=i.__importStar(n(238)),r=n(81),a=i.__importDefault(n(295)),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyword="",t.handleInputChange=(0,r.debounce)((function(){if(t.refInput.current&&!t.refInput.current.isChineseInputting){var e=t.refInput.current.getInput(),n=t.getContentElement();if(n){var i=e.value.trim(),o=i.toLowerCase(),r=t.props,a=r.flexHeight,l=r.onChange;a||(o?t.keyword||(n.style.height="".concat(n.offsetHeight,"px")):n.style.height=""),t.keyword=i,l&&l(t.keyword)}else console.debug("搜索框必须在panel/panel-header内才支持搜索")}}),100),t.refDiv=o.default.createRef(),t.refInput=o.default.createRef(),t}return i.__extends(t,e),t.prototype.getContentElement=function(){var e=this.refDiv.current.parentElement;return e.classList.contains("kd-component-public-panel-header")&&(e=e.parentElement),e.querySelector(".kd-component-public-panel-content")},t.prototype.render=function(){return o.default.createElement("div",{ref:this.refDiv,className:"kd-component-public-panel-searcher"},o.default.createElement(a.default,{ref:this.refInput,autoFocus:!0,maxLength:500,onChange:this.handleInputChange}))},t}(o.PureComponent);t.default=l},11540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(241),r=i.__importStar(n(238)),a=i.__importDefault(n(629)),l=n(11541),s=n(1202),c=i.__importDefault(n(84)),u=i.__importDefault(n(227)),d=i.__importDefault(n(4517)),f=i.__importDefault(n(6285)),p=i.__importDefault(n(879));n(11542);var h=window.__WPSPLUGIN__.helper.has(window.__WPSPLUGIN__.type.CollaborationSwitch);t.default=(0,o.connect)((function(e){var t=e.public;return{connected:t.network.connected,isLogin:t.user.isLogin,isAppReady:t.network.isAppReady}}),null,null,{forwardRef:!0})(r.default.forwardRef((function(e,t){var n=e.isAppReady,i=(0,c.default)()?(0,r.useState)(!0):(0,r.useState)(!1),o=i[0],m=i[1],v=(0,r.useState)(!1),b=v[0],g=v[1],y=(0,r.useState)(!1),w=y[0],_=y[1],E=(0,r.useRef)(),C=!!window.__WPSENV__.file_info.file.user_acl.share,S=window.__WPSENV__.file_info.file.creator.id===window.__WPSENV__.file_info.user.id,k=function(e){window.__WPSENV__.file_info.file.collaboration_switch_status=e?"open":"close",m(e)},O=function(){setTimeout((function(){window.__WPSENV__.groupFile&&window.__WPSENV__.groupFile.isGroupFile?window.__WPSENV__.groupFile.isGroupMember?g(!C):g(!0):g(!S)}),300)},P=(0,r.useCallback)((function(e){m(!e),g(!0),(0,l.changeCollaborationSwitch)(e,O)}),[]),M=r.default.createElement("span",null,_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.team_text", "Team Member"),_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.open_switch", "Collaboration enabled.")," ",r.default.createElement("i",{style:{color:"#0063F4",cursor:"pointer",marginLeft:"8px"},onClick:function(){d.default.close(),_(!0)}},_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.learn_more", "Learn More"))),T=(0,r.useCallback)((function(e){if(e.detail){var t=e.detail,n=t.collaboration_switch_status;t.is_team_doc&&d.default.info({showClose:!0,message:"open"===n?M:"".concat(_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.team_text", "Team Member")).concat(_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.close_switch", "Collaboration disabled.")," ").concat(_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.close_switch_tip", "Only team members can continue to access this document."))})}}),[]),I=function(){b&&window.__WPSENV__.groupFile&&window.__WPSENV__.groupFile.isGroupFile&&window.Toast.warn(_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.no_permission", "Apply for the sharing permissions from the administrator first."))};(0,r.useEffect)((function(){var e=!!(0,c.default)();return n&&("open"===window.__WPSENV__.file_info.file.collaboration_switch_status?(m(!0),e=!0):(m(!1),e=!1),(0,s.changeSupportCollaborationSwitch)(!0),(0,l.initCollaborationSwitch)(E.current,e,k,O),window.addEventListener(u.default.names.file.ON_COOP_SWITCH_STATUS_CHANGE,T)),function(){window.removeEventListener(u.default.names.file.ON_COOP_SWITCH_STATUS_CHANGE,T)}}),[n]);return h&&r.default.createElement("div",{className:"header-right-cooper-btn",ref:E,onClick:I},r.default.createElement("div",{className:"cooper-btn-title"},_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.title", "Collaboration")),r.default.createElement(a.default,{checked:o,onChange:P,disabled:b}),r.default.createElement(f.default,{className:"cooper-modal",visible:w,mask:!0,okText:_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.confirm", "I know"),closable:!0,title:_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.learn_more", "Learn More"),draggable:!1,cancelText:null,onCancel:function(){return _(!1)},onOk:function(){return _(!1)}},r.default.createElement("p",{className:"cooper-btn-content cooper-btn-subTitle"},_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.learn_more_title", "The current document is managed by the team in a unified manner. If \"Collaboration\" is enabled:")),r.default.createElement("p",{className:"cooper-btn-content"},r.default.createElement(p.default,{className:"cooper-btn-icon"})," ",_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.learn_more_p1", "You can control the persons who can view the document, including but not limited to the team members.")),r.default.createElement("p",{className:"cooper-btn-content"},r.default.createElement(p.default,{className:"cooper-btn-icon"})," ",_i18n("applications.public.components.commandbars.Header.HeaderRight.CollaborationSwitch.learn_more_p2", "All team members can edit the document online in a unified manner and save the edits in real time, which can prevent conflicts."))))})))},11541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollaborationSwitchPluginExist=t.UseCollaborationSwitchPlugin=t.CollaborationSwitchPlugin=t.changeCollaborationSwitch=t.initCollaborationSwitch=void 0;var i=n(5),o={pluginType:window.__WPSPLUGIN__.type.CollaborationSwitch},r=window.__WPSPLUGIN__.pluginMgr.hasPlugin(o);t.CollaborationSwitchPluginExist=r;var a=null;t.CollaborationSwitchPlugin=a;var l=null;t.UseCollaborationSwitchPlugin=l,t.initCollaborationSwitch=function(e,n,s,c){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){switch(i.label){case 0:return!r||l?[3,2]:[4,window.__WPSPLUGIN__.pluginMgr.getPlugin(o)];case 1:if(t.CollaborationSwitchPlugin=a=i.sent(),a)try{t.UseCollaborationSwitchPlugin=l=a.useCollaborationSwitch({el:e,value:n,onChange:s})}catch(e){console.log("初始化插件报错:e:",e),c()}c(),i.label=2;case 2:return[2]}}))}))},t.changeCollaborationSwitch=function(e,t){if(l){try{l.handleChange(e)}catch(e){console.log("调用插件方法报错:e:",e),t()}t()}}},11542:function(e,t,n){},11543:function(e,t,n){},11544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTextChatPlugin=t.initTextChatPlugin=t.textChatEnabled=void 0;var i,o=window.__WPSPLUGIN__.helper,r=o.types.Chat,a={pluginType:r};t.textChatEnabled=o.has(r),t.initTextChatPlugin=function(e){t.textChatEnabled&&(i=function(e){return new Promise((function(t){window.__WPSPLUGIN__.loader.load(a).then((function(n){var i=window.fileInfo,o=new n({layout:{getPluginContainer:function(){return e}},initParams:{fileInfo:{group_id:i.group_id,file_id:i.id,link_id:window.urlFileId,officeType:window.officeType}}});t(o.plugin)}))}))}(e))},t.getTextChatPlugin=function(){return t.textChatEnabled?i||Promise.reject("[".concat(r,"] is not inited.")):Promise.reject("[".concat(r,"] is disabled."))}},11545:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVoiceChatPlugin=t.initVoiceChatPlugin=t.voiceChatEnabled=void 0;var i,o=window.__WPSPLUGIN__.helper,r=o.types.VoiceChatFull,a={pluginType:r};t.voiceChatEnabled=o.has(r),t.initVoiceChatPlugin=function(e){i=null,t.voiceChatEnabled&&(i=function(e){return new Promise((function(t){var n={getWrapper:function(){return e}};window.__WPSPLUGIN__.loader.load(a).then((function(e){var i=new e({layout:n});t(i.plugin)}))}))}(e)).then((function(e){e.init()}))},t.getVoiceChatPlugin=function(){return t.voiceChatEnabled?i||Promise.reject("[".concat(r,"] is not inited.")):Promise.reject("[".concat(r,"] is disabled."))}},11546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11547);var o=i.__importStar(n(238)),r=i.__importDefault(n(227)),a=i.__importDefault(n(82)),l=i.__importDefault(n(243)),s=i.__importDefault(n(1818)),c=i.__importDefault(n(3524)),u=n(67),d=i.__importDefault(n(11548));t.default=(0,o.memo)((function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];(0,o.useEffect)((function(){a.default.ksheet===window.officeType&&window.__CONFIG__.ksheet.isEnableAiChat&&!(0,u.isPublish)()&&c.default.getByName("ai").then((function(e){var t=e.enable;n(t)}))}),[]);var i=(0,o.useCallback)((function(){var e=function(){window.APP.getActiveSheet().isDBSheet()?window.Toast.warn(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.notSupportBD", "The datasheet does not currently support this function")):window.__WPSENV__.file_info.file.user_acl.excel_protection?window.Toast.warn(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.protectedFile", "WPS AI is not available for this document because it contains editing restricted areas specified by the author.")):r.default.dispatchEvent("ET_CHAT_AI_PANEL_VISIBLE",{visible:!0})};localStorage.getItem("chat_ai_permission")?e():window.Confirm({title:_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTitle", "WPS AI Instructions"),text:o.default.createElement(d.default,null),onOk:function(){e(),localStorage.setItem("chat_ai_permission","1")},onCancel:function(){return Function.prototype},className:"chat-ai-permission",size:640,okBtnText:_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.sure", "Agree"),cancelBtnText:_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.exit", "Exit")})}),[]);return t?o.default.createElement(l.default,{className:"ai-header-btn",type:"light",icon:o.default.createElement(s.default,null),size:"medium",onClick:i},_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.title", "WPS AI")):null}))},11547:function(e,t,n){},11548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11549);var o=i.__importStar(n(238)),r=n(1054),a=function(e){var t=e.text,n=e.type;return o.default.createElement("span",{className:"link",onClick:function(){return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return[4,(0,r.getUrlByPlugin)(n)];case 1:return(e=t.sent())?(window.open(e),[2]):[2]}}))}))}},t)},l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderBoldText=function(e,t){for(var n=[],i=e.split("${0}"),r=0;r<i.length;r++){n.push(o.default.createElement("span",null,i[r]));var a=t.shift();a&&n.push(o.default.createElement("span",{className:"bold"},a))}return n},t.renderLink=function(e,t){for(var n=[],i=e.split("${0}"),r=0;r<i.length;r++){n.push(o.default.createElement("span",null,i[r]));var l=t.shift();l&&n.push(o.default.createElement(a,{type:l.type,text:l.text}))}return n},t}return i.__extends(t,e),t.prototype.render=function(){return o.default.createElement("div",{className:"chat-ai-confirm"},o.default.createElement("div",{className:"confirm-text"},_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTips", "Welcome to use WPS AI. Before you use the service, make sure that you acknowledge and agree to the following content:")),o.default.createElement("div",{className:"confirm-step"},o.default.createElement("div",{className:"confirm-step-number"},"1."),o.default.createElement("div",{className:"confirm-step-text"},this.renderBoldText(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTips1", "We will collect feedback with likes or dislikes, as well as the full conversation in the feedback. The conversation content may include ${0} that helps improve the quality of the AI model."),[_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.boldText1", "Your question and the related spreadsheet data")]))),o.default.createElement("div",{className:"confirm-step"},o.default.createElement("div",{className:"confirm-step-number"},"2."),o.default.createElement("div",{className:"confirm-step-text"},this.renderBoldText(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTips2", "Our AI model will process file data to help handle your work more efficiently. We recommend that you ${0} to prevent data loss or change caused by misoperations."),[_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.boldText2", "Try using copies for important files")]))),window.__CONFIG__.ksheet.aiSupportFeature.WoaLink&&o.default.createElement("div",{className:"confirm-step"},o.default.createElement("div",{className:"confirm-step-number"},"3."),o.default.createElement("div",{className:"confirm-step-text"},this.renderLink(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTips3", "WPS AI is still being improved under the technical testing phase. It may cause issues in experience and usage. Welcome to join ${0} and feel free to contact us at any time."),[{text:_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.link1", "\"Table AI Pathfinder Alliance\""),type:r.linkTypes.EtWpsAIWoa}]))),o.default.createElement("div",{className:"confirm-text"},this.renderLink(_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.confirmTips4", "For more information, see ${0}."),[{text:_i18n("applications.public.components.commandbars.Header.HeaderRight.AiBtn.link2", "WPS AI Service Agreement"),type:r.linkTypes.WpsAIService}])))},t}(o.PureComponent);t.default=l},11549:function(e,t,n){},11550:function(e,t,n){},11551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(11552);var o=i.__importStar(n(238)),r=n(241),a=i.__importDefault(n(227)),l=i.__importDefault(n(284)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClose=function(){t.refFail.current&&window.Notice.close()},t.handleFail=function(){t.props.connected&&window.Notice.show({icon:l.default.size16.warning_red,content:t.renderFail()})},t.handleReloadCdn=function(){var e=window.__WPSENV__.reloadCdnHref;e?(window.location.href=e,window.collection2("load_error_change_cdn")):window.location.reload()},t.refFail=o.default.createRef(),t}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener(a.default.names.file.ON_LOAD_FILE_FAIL,this.handleFail),window.addEventListener(a.default.names.network.ON_DISCONNECTED,this.handleClose)},t.prototype.componentWillUnmount=function(){window.removeEventListener(a.default.names.file.ON_LOAD_FILE_FAIL,this.handleFail),window.removeEventListener(a.default.names.network.ON_DISCONNECTED,this.handleClose)},t.prototype.renderFail=function(){return o.default.createElement("div",{className:"load-file-fail",ref:this.refFail},_i18n("applications.public.components.commandbars.Header.ErrorLoad.text", "An error occurred while loading some of the features. Please try again."),o.default.createElement("span",{className:"load-file-retry",onClick:this.handleReloadCdn},_i18n("applications.public.components.commandbars.Header.ErrorLoad.btn", "Refresh page")))},t.prototype.render=function(){return!1},t}(o.PureComponent);t.default=(0,r.connect)((function(e){return{connected:e.public.network.connected}}))(s)},11552:function(e,t,n){},11553:function(e,t,n){e.exports=function(e,t){n.e(580).then(n.bind(null,16822)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11554:function(e,t,n){e.exports=function(e,t){n.e(586).then(n.bind(null,13120)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},11555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=i.__importDefault(n(662)),a=window.screen.width,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showConfirm:!1},t.handleOrientation=function(){clearTimeout(t.delayTimer),t.delayTimer=window.setTimeout((function(){var e=Math.abs(window.orientation),n=document.body.clientHeight;90===e&&n>a?t.setState({showConfirm:!0}):t.setState({showConfirm:!1})}),200)},t.handleOk=function(){window.location.reload()},t.handleCancel=function(){t.setState({showConfirm:!1})},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("orientationchange",this.handleOrientation)},t.prototype.componentWillUnmount=function(){clearTimeout(this.delayTimer),window.removeEventListener("orientationchange",this.handleOrientation)},t.prototype.render=function(){return!!this.state.showConfirm&&o.default.createElement(r.default,{onOk:this.handleOk,onCancel:this.handleCancel,okBtnText:_i18n("applications.public.components.commandbars.Header.HeaderOthers.IpadWeixinReload.confirmText", "Refresh now")},_i18n("applications.public.components.commandbars.Header.HeaderOthers.IpadWeixinReload.content", "The page layout is wrong due to the browser. Please refresh the page."))},t}(o.PureComponent);t.default=l},1172:function(e,t,n){},1173:function(e,t,n){},1202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeSupportCollaborationSwitch=t.isSupportCollaborationSwitch=t.isShowCollaborationSwitch=void 0;var i=n(5).__importDefault(n(82)),o=n(167),r=[i.default.pdf,i.default.image,i.default.whiteboard,i.default.unknown];t.isShowCollaborationSwitch=function(e){return void 0===e&&(e=!0),window.__WPSENV__.file_info&&window.__WPSENV__.file_info.file&&window.__WPSENV__.file_info.file.collaboration_switch_status&&window.__CONFIG__.isCollaborationSwitchGroupType?r.includes(window.officeType)?null:window.__CONFIG__.isShowCollaborationSwitch?-1===document.cookie.indexOf("wps_endcloud=1")?null:o.isMobile?(window.__WPSENV__.isSupportCollaborationSwitch=!0,!0):e&&!window.__WPSENV__.isNewUI?null:!(!e&&window.officeType!==i.default.dbsheet)||null:null:null};t.isSupportCollaborationSwitch=function(){return window.__WPSENV__.isSupportCollaborationSwitch},t.changeSupportCollaborationSwitch=function(e){window.__WPSENV__.isSupportCollaborationSwitch=e}},1210:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("arrow_triangle_left",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},o.a.createElement("path",{d:"M9.97612 4.60262C10.4224 4.32371 11 4.64617 11 5.17425L11 10.8261C11 11.346 10.4377 11.6694 9.99104 11.4068C8.29358 10.4089 7.03806 9.67075 5.33181 8.66766C4.89652 8.41176 4.88772 7.78244 5.31598 7.51481L9.97612 4.60262Z",stroke:"none"})))}))},1326:function(e,t,n){"use strict";n.r(t),n.d(t,"Size",(function(){return C}));var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=n(259),h=n.n(p),m=n(240),v=n(321),b=n(273),g=n.n(b),y=n(252),w=n.n(y),_=n(1491),E=n(380),C={small:"small",middle:"middle",medium:"medium",large:"large",xLarge:"x-large"},S=function(e){function t(){var e,n,i,r;o()(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return n=i=s()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.handleIconClick=function(e){Object(m.stopBubble)(e),i.props.visible&&i.props.onVisibleChange(!1),i.props.onIconClick(e)},r=n,s()(i,r)}return u()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.iconContent,o=e.disabled,r=e.altForceDirection,a=e.title,l=e.iconType,s=e.visible,c=e.onVisibleChange,u=e.icon,d=e.size,p=void 0===d?C.middle:d,h=e.autoClose,m=e.showBorder,b=o?void 0:this.handleIconClick,y=this.getClassName();switch(m&&(y+=" show-border"),p){case C.small:y+=" button-s";break;case C.middle:case C.medium:y+=" button-m";break;case C.large:y+=" button-l";break;case C.xLarge:y+=" button-x"}return f.a.createElement(v.default,{visible:s,panel:n,disabled:o,onVisibleChange:c,autoClose:h},f.a.createElement(w.a,{title:a},f.a.createElement("div",{ref:this.refWrap,id:t,className:y,role:"combobox","alt-force-direction":r},f.a.createElement("div",{className:"left-btn",onClick:b},u&&u,!u&&l&&f.a.createElement(g.a,{type:l}),i),f.a.createElement("div",{className:"right-btn"},f.a.createElement(E.default,{size:12})))))}}]),t}(_.a);S.propTypes={id:h.a.string,visible:h.a.bool.isRequired,className:h.a.string,disabled:h.a.bool,title:h.a.oneOfType([h.a.object,h.a.string]),iconType:h.a.string,iconContent:h.a.oneOfType([h.a.object,h.a.string]),onIconClick:h.a.func,iconSelected:h.a.bool,altForceDirection:h.a.string,onVisibleChange:h.a.func.isRequired,size:h.a.string,autoClose:h.a.bool},S.defaultProps={autoClose:!0,showBorder:!0},t.default=S},1489:function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=n(706),h=n(243),m=n.n(h),v=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.state.enable&&n._action&&n._action()},n.state={id:e.id,icon:e.icon,caption:e.caption,tooltip:e.tooltip,enable:!0,visible:!0,iconStyle:Object(p.getIconStyle)(e.icon)},n}return u()(t,e),a()(t,[{key:"renderContent",value:function(e,t){var n=this.state,i=n.icon,o=n.caption,r=n.tooltip,a=n.iconStyle;return r&&t&&(r=null),i&&!o?f.a.createElement(m.a,{size:"medium",title:r,isDropdown:e,selected:t,onClick:this.handleClick,icon:f.a.createElement("div",{className:"icons icons-16",style:a})}):o&&!i?f.a.createElement(m.a,{size:"medium",isDropdown:e,selected:t,className:"kd-component-text-btn",title:r,onClick:this.handleClick},o):o&&i?f.a.createElement(m.a,{size:"medium",title:r,isDropdown:e,selected:t,onClick:this.handleClick,icon:f.a.createElement("div",{className:"icons icons-16",style:a})},o):null}},{key:"renderBtn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state,i=n.visible,o=n.enable,r=f.a.classNames({"kd-component-custom-cmb-btn":!0,disabled:!o,hidden:!i});return f.a.createElement("div",{className:r},this.renderContent(e,t))}},{key:"id",get:function(){return this.state.id}},{key:"icon",set:function(e){this.setState({icon:e,iconStyle:Object(p.getIconStyle)(e)})},get:function(){return this.state.icon}},{key:"caption",set:function(e){this.setState({caption:e})},get:function(){return this.state.caption}},{key:"tooltip",set:function(e){this.setState({tooltip:e})},get:function(){return this.state.tooltip}},{key:"action",set:function(e){this._action=e},get:function(){return this._action}},{key:"enable",set:function(e){this.setState({enable:e})},get:function(){return this.state.enable}},{key:"visible",set:function(e){this.setState({visible:e})},get:function(){return this.state.visible}}]),t}(d.PureComponent);t.a=v},1490:function(e,t,n){"use strict";n.r(t),n.d(t,"changeTaskPaneWidth",(function(){return l})),n.d(t,"changeGuideWidth",(function(){return s})),n.d(t,"getTaskPaneWidth",(function(){return c})),n.d(t,"changeLoginGuidVisible",(function(){return u})),n.d(t,"changeHeaderVisible",(function(){return d}));var i=n(227),o=n(1373),r=0,a=0,l=function(e,t){r=e;var n=e+a;i.default.dispatchEvent(i.default.names.ON_TASK_PANE_WIDTH_CHANGE,{width:n}),!0!==t&&i.default.cooper.onContainerResize()},s=function(e){a=e},c=function(){return r},u=function(e){return function(t){t({type:o.a.LOGIN_GUIDE_VISIBLE,visible:e})}},d=function(e){return function(t){t({type:o.a.HEADER_VISIBLE,visible:e})}}},1491:function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=n(321),h=n(273),m=n.n(h),v=function(e){function t(){var e,n,i,r;o()(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return n=i=s()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.refWrap=f.a.createRef(),r=n,s()(i,r)}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.visible,i=e.iconSelected,o=e.iconContent,r=e.className;return f.a.classNames({"wo-component-dropdown-group":1,disabled:t,selected:n,"icon-selected":i,"icon-text":"string"==typeof o},r)}},{key:"getElement",value:function(){return this.refWrap.current}}]),t}(d.PureComponent);v.iconTypes=m.a.types,v.DropdownPanel=p.default.DropdownPanel,t.a=v},16684:function(e,t,n){"use strict";n.r(t);var i=n(13),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(23),f=n.n(d),p=(n(11502),n(238)),h=n.n(p),m=n(241),v=n(82),b=n(14),g=n(8),y=n.n(g),w=n(80),_=n.n(w),E=(n(11503),n(259)),C=n.n(E),S=n(30),k=n.n(S),O=n(321),P=n(6283),M=n(227),T=n(247),I=n(11504),D=n.n(I),N=n(11505),L=n.n(N),R=n(243),x=n.n(R),H=n(2192),j=n(6284),W=window.CommandBarComponent,A=W.cmbIds.$public,B=k()({},P.c.SaveAsCopy,L.a),V=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,A.MoreMenus));return n.state={visible:!1,subPanel:null,isShortOfflineMode:window.__WPSENV__.offlineCenter&&window.__WPSENV__.offlineCenter.isShortOfflineMode(),guideMessage:null},n.handleEnterShortOffline=function(){n.setState({isShortOfflineMode:!0})},n.handleExitShortOffline=function(){n.setState({isShortOfflineMode:!1})},n.handleDisconnected=function(){window.__WPSENV__.isSupportOfflineMode&&window.RPCClient._isSupportOfflineApp||n.setState({visible:!1})},n.handleConnected=function(){window.__WPSENV__.isSupportOfflineMode&&window.RPCClient._isSupportOfflineApp||n.setState({visible:!1})},n.handleHeaderEvents=function(e){switch(e.detail.action){case"OPEN_FILE_PANEL":n.setState({visible:!1});break;default:return}},n.handleVisibleChange=function(e){window.collection2("click_moremenus"),n.state.isShortOfflineMode||n.setState({visible:e},(function(){M.default.dispatchEvent(M.default.names.HEADER_EVENT_NOTIFY,{action:"OPEN_MORE_MENU",data:{open:e}})}))},n.handleClose=function(e,t,i){var o=!1===t?null:B[e];switch(n.setState({visible:i||!1,subPanel:o}),e&&window.collection2("HeaderMoreMenu_"+e),window.collectionOnce(),e){case"ExportPdf":window.collection("exportpdfonline",{value:"export_pdf"});break;case"exportPdfToLocal":window.collection("exportpdfonline",{value:"export_pdf_local"});break;case"exportPdfToCloud":window.collection("exportpdfonline",{value:"export_pdf_online"})}},n.handleCloseSubPanel=function(){n.setState({subPanel:null})},n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(M.default.names.network.ON_ENTER_SHORT_OFFLINE_MODE,this.handleEnterShortOffline),window.addEventListener(M.default.names.network.ON_ENTER_LONG_OFFLINE_MODE,this.handleExitShortOffline),window.addEventListener(M.default.names.network.ON_ENTER_ONLINE_MODE,this.handleExitShortOffline),window.addEventListener(M.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener(M.default.names.network.ON_CONNECTED,this.handleConnected),this.dom=null,window.addEventListener(M.default.names.ON_SHOW_MORE_MENU_GUIDE,this.handleShowMoreMenuGuide),window.addEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(M.default.names.network.ON_ENTER_SHORT_OFFLINE_MODE,this.handleEnterShortOffline),window.removeEventListener(M.default.names.network.ON_ENTER_LONG_OFFLINE_MODE,this.handleExitShortOffline),window.removeEventListener(M.default.names.network.ON_ENTER_ONLINE_MODE,this.handleExitShortOffline),window.removeEventListener(M.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener(M.default.names.network.ON_CONNECTED,this.handleConnected),window.removeEventListener(M.default.names.ON_SHOW_MORE_MENU_GUIDE,this.handleShowMoreMenuGuide),window.removeEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"componentDidUpdate",value:function(e){e.isAppReady!==this.props.isAppReady&&Object(T.default)(D.a)}},{key:"renderPanel",value:function(){if(this.state.visible)return Object(T.default)(D.a,{connected:this.props.connected,onClose:this.handleClose,panelClassName:this.props.panelClassName,isShortOfflineMode:this.state.isShortOfflineMode})}},{key:"renderSubPanel",value:function(){var e=this.state.subPanel;if(e)return Object(T.default)(e,{onClose:this.handleCloseSubPanel})}},{key:"renderButton",value:function(){var e=this.state,t=e.visible,n=e.isShortOfflineMode,i=this.props.title,o="string"==typeof i?i:_i18n("applications.public.components.commandbars.Header.MoreBtn.more", "File Operations"),r="header-more-btn";return n&&(o=_i18n("applications.public.components.commandbars.NetworkStatus.offlineDisabled", "This feature is currently unavailable because the network is disconnected."),r+=" disable"),h.a.createElement(x.a,{size:"medium",icon:h.a.createElement(H.a,null),className:r,selected:t,title:o,"alt-hint-keep":"true","alt-render-delay":"400"})}},{key:"render",value:function(){var e=this.renderPanel(),t=this.state,n=t.visible,i=t.isShortOfflineMode;return h.a.createElement(j.default,{className:"headerLeft-more-menu-badge",uiType:"WOAChat",isMustDot:!0},h.a.createElement(O.default,{isSetHeight:!0,panel:e,visible:n,autoClose:!i,onVisibleChange:this.handleVisibleChange},this.renderButton()),this.renderSubPanel())}}]),t}(W);V.propTypes={iconType:C.a.string,panelClassName:C.a.string,title:C.a.string};var F=Object(m.connect)((function(e){var t=e.public.network;return{connected:t.connected,isAppReady:t.isAppReady}}))(V),z=n(2520),U=n(2519),G=(n(11506),n(11507),n(240)),K=n(167),X=n(613),q=n(332),Y=n(362),Z=n(246),J=window.__WPSPLUGIN__,Q=300,$=function(e){function t(e){var n=this;a()(this,t);var i,o=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.submiting=!1,o.state={onLine:!0,name:"",isEditing:!1,panelVisible:!1,readOnly:!1,readOnlyAndDisable:!1,fileInfoPanelVisible:!1,moreMenuStatus:!1,showAuthMarker:!1},o.handleHeaderEvents=function(e){switch(e.detail.action){case"OPEN_MORE_MENU":o.setState({moreMenuStatus:e.detail.data.open},(function(){Q=e.detail.data.open?600:300}))}},o.isShowPanel=!1,o.triggerFileInfoPanel=(i=_()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.state.isEditing&&J.helper.has("FileInfoPanel")){e.next=3;break}return e.abrupt("return");case 3:if(!t||o.FileInfoPluginInstance){e.next=15;break}return e.prev=4,o.isShowPanel=!0,e.next=8,J.loader.loadSingleInstance({pluginType:"FileInfoPanel"});case 8:o.FileInfoPluginInstance=e.sent,e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(4),o.isShowPanel=!1,e.abrupt("return");case 15:o.setState({fileInfoPanelVisible:t},(function(){t?(o.showFileInfoPanel(),o.isShowPanel=!0):(clearTimeout(o.showPanelTimer),o.FileInfoPanelCleanUp&&o.FileInfoPanelCleanUp(),o.isShowPanel=!1)}));case 16:case"end":return e.stop()}}),e,n,[[4,11]])}))),function(e){return i.apply(this,arguments)}),o.isDBClickFile=!1,o.fileOperationTimer=null,o.showFileInfoPanel=function(){o.showPanelTimer=setTimeout((function(){var e=o.FileInfoPluginInstance.showPanel;o.FileInfoPanelCleanUp=e({reference:o.fileNameWrap.current,container:document.getElementById("FileInfoPanel_container"),onClose:function(){K.isPad&&(o.isDBClickFile=!0,o.fileOperationTimer=setTimeout((function(){o.isDBClickFile=!1}),500)),o.triggerFileInfoPanel(!1)}}),Q=300,M.default.dispatchEvent(M.default.names.HEADER_EVENT_NOTIFY,{action:"OPEN_FILE_PANEL",data:{open:!0}})}),Q)},o.delayTimer=null,o.handleMouseLeave=function(){clearTimeout(o.delayTimer)},o.refInput=h.a.createRef(),o.fileNameWrap=h.a.createRef(),o.showPanelTimer=null,o.onVisibleChange=function(e){K.isPad&&o.isDBClickFile||e&&o.isShowPanel||o.triggerFileInfoPanel(e)},o.handleFilenameClick=o.handleFilenameClick.bind(o),o.handleInputChange=o.handleInputChange.bind(o),o.handleInputKeyDown=o.handleInputKeyDown.bind(o),o.setInputFocus=o.setInputFocus.bind(o),o.handleWindowClick=o.handleWindowClick.bind(o),o.handleOnline=o.handleOnline.bind(o),o.handleOffline=o.handleOffline.bind(o),o.handleHoverVisible=o.handleHoverVisible.bind(o),o.handleHoverClose=o.handleHoverClose.bind(o),o}var n;return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(M.default.names.file.ON_RENAME,this.handleFilenameClick),window.addEventListener("offline",this.handleOffline),window.addEventListener("online",this.handleOnline),window.addEventListener("mousedown",this.handleWindowClick,!0),window.addEventListener("touchend",this.handleWindowClick,!0),window.addEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(M.default.names.file.ON_RENAME,this.handleFilenameClick),window.removeEventListener("offline",this.handleOffline),window.removeEventListener("online",this.handleOnline),window.removeEventListener("mousedown",this.handleWindowClick,!0),window.removeEventListener("touchend",this.handleWindowClick,!0),clearTimeout(this.delayTimer),clearTimeout(this.showPanelTimer),window.removeEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"handleOffline",value:function(){this.setState({onLine:!1,isEditing:!1,name:""})}},{key:"handleOnline",value:function(){this.setState({onLine:!0})}},{key:"handleWindowClick",value:function(e){var t=this.refInput.current;this.state.isEditing&&!t.contains(e.target)&&(this.submitFileName()||G.stopBubble(e))}},{key:"setInputFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.refInput.current;t.focus(),e&&t.select()}},{key:"handleFilenameClick",value:function(e){var t=this;if(e&&e.preventDefault(),K.isPad&&!this.isDBClickFile){if(!this.isDBClickFile)return;clearTimeout(this.fileOperationTimer)}if(!K.isPad&&K.isTouchScreen){if(!this.state.fileInfoPanelVisible)return;this.setState({fileInfoPanelVisible:!1})}var n=this.props.file,i=this.state,o=i.onLine,r=i.isEditing,a=i.readOnly,l=i.readOnlyAndDisable;r||window.__WPSENV__.draft||l||(a&&(window.Toast.info(_i18n("applications.public.components.commandbars.Header.FileInfo.FileName.tips1", "You do not have permission to rename")),this.triggerFileInfoPanel(!1)),o?(this.setState({isEditing:!0,name:n.name,readOnly:a,fileInfoPanelVisible:!1},(function(){t.setInputFocus(!K.isPad)})),this.triggerFileInfoPanel(!1),window.collection2("header_filename_edit")):window.Toast.error(_i18n("applications.public.components.commandbars.Header.FileInfo.FileName.tips2", "Network disconnected. Check the network configuration")))}},{key:"handleInputChange",value:function(e){this.setState({name:e.target.value})}},{key:"handleInputKeyDown",value:function(e){Object(Z.isMatchShortCutKey)(e,[Z.Keys.Esc])?this.setState({isEditing:!1,name:"",panelVisible:!1}):Object(Z.isMatchShortCutKey)(e,[Z.Keys.Enter])&&(G.stopBubble(e),this.submitFileName())}},{key:"handleHoverVisible",value:function(e){var t=this;window.__WPSENV__.draft||this.state.readOnlyAndDisable||(clearTimeout(this.delayTimer),e?this.delayTimer=setTimeout((function(){t.setState({panelVisible:!0})}),500):this.setState({panelVisible:!1}))}},{key:"handleHoverClose",value:function(){clearTimeout(this.delayTimer),this.setState({panelVisible:!1})}},{key:"submitFileName",value:function(){var e=this.state.name.trim();return this.props.file.name!==e&&e?/[\\\/\:\*\?\"\<\>\|]/.test(e)?(window.Toast.error(_i18n("applications.public.components.commandbars.Header.FileInfo.FileName.fileNameError", "File name can\'t contain any of following characters:")+'\n\\ / " : * ? " < > |'),!1):(this.doSubmit(),!0):(this.setState({isEditing:!1,panelVisible:!1}),!0)}},{key:"doSubmit",value:(n=_()(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.submiting){e.next=2;break}return e.abrupt("return");case 2:return this.submiting=!0,t=this.props,n=t.dispatch,i=t.file,o=t.readonly,r=this.state.name,a=""+r.trim()+i.ext,e.next=8,n(q.changeFilename(window.urlFileId,a));case 8:(l=e.sent).error?"fileNameConflict"===l.result?this.setState({isEditing:!1,panelVisible:!1}):this.setInputFocus(!K.isPad):(o&&window.Toast.success(_i18n("applications.public.components.commandbars.Header.FileInfo.FileName.renameSuccess", "Rename succeeded")),M.default.dispatchEvent(M.default.names.cooper.ON_DOCUMENT_SAVEING),this.setState({isEditing:!1,panelVisible:!1}),M.default.dispatchEvent(M.default.names.cooper.ON_DOCUMENT_SAVE_SUCCESS),Object(X.refreshFileList)()),this.submiting=!1,window.collection2("header_filename_submit");case 12:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.file,t=this.state,n=t.isEditing,i=t.name,o=t.readOnly,r=t.readOnlyAndDisable,a=t.fileInfoPanelVisible,l=h.a.classNames({"no-permission":r},"filename"),s=h.a.createElement(Y.default,null,h.a.createElement("div",{id:"FileInfoPanel_container"})),c=h.a.classNames({"show-border":a||n},"filename-wrap");return h.a.createElement(h.a.Fragment,null,h.a.createElement(O.default,{mustHover:!0,trigger:K.isPad||K.isTouchScreen?"click":"hover",distance:-3,panelClass:"file-info-dropdown",isSetHeight:!0,panel:s,visible:a,onVisibleChange:this.onVisibleChange},h.a.createElement("div",{ref:this.fileNameWrap,className:c},!n&&h.a.createElement("div",{id:"filename",className:l,ref:this.fileNameRef,onClick:this.handleFilenameClick},e.name),n&&h.a.createElement("div",{className:"input-wrap"},h.a.createElement("input",{ref:this.refInput,maxLength:240,value:i,onChange:this.handleInputChange,readOnly:o,onKeyDown:this.handleInputKeyDown}),h.a.createElement("div",{className:"content-hidden"},i)))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=!e.file.user_acl.rename;return t.readOnly!==n?{readOnly:n,readOnlyAndDisable:n&&!window.__CONFIG__.isShowNoPermissionComponent}:null}}]),t}(p.PureComponent),ee=n(7834),te=n.n(ee),ne=n(11508),ie=n.n(ne),oe=window.__WPSPLUGIN__.helper,re=window.CommandBarComponentFragment,ae=window.CommandBarComponent.cmbIds.$public,le=oe.has("CloudStorage"),se=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isInited=!1,n.plugin=null,n.CloudStorageBox=h.a.createRef(),n}var n;return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){le&&this.props.isAppReady&&(this.HeaderLeftInsertPlugin=this.loadCloudStoragePlugin(),this.setCloudTextStatus())}},{key:"componentDidUpdate",value:function(){le&&this.props.isAppReady&&(this.HeaderLeftInsertPlugin=this.loadCloudStoragePlugin(),this.setCloudTextStatus())}},{key:"setCloudTextStatus",value:function(){var e=this.props.showEleConfig;this.plugin&&(e.showCloudText?this.plugin.unCollapse&&this.plugin.unCollapse():this.plugin.collapse&&this.plugin.collapse())}},{key:"loadCloudStoragePlugin",value:(n=_()(regeneratorRuntime.mark((function e(){var t,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.file,i=t.contentReadonly,o=i||!n.user_acl.update,le&&!this.isInited){e.next=4;break}return e.abrupt("return");case 4:return this.isInited=!0,e.prev=5,e.next=8,window.__WPSPLUGIN__.loader.load({pluginType:"CloudStorage"});case 8:return this.PluginHandler=e.sent,e.next=11,(new this.PluginHandler).plugin;case 11:this.plugin=e.sent,this.plugin.mount(this.CloudStorageBox.current,{contentReadonly:o}),e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,15]])}))),function(){return n.apply(this,arguments)})},{key:"renderFileStatus",value:function(){var e=this.props,t=e.file,n=e.user,i=e.dispatch,o=e.contentReadonly,r=e.connected,a=e.whiteBg,l=e.isAppReady,s=o||!t.user_acl.update;return h.a.createElement("div",{className:"file-status-box"},le?h.a.createElement("div",{id:"CloudStorage_container",className:"cloud-storage",ref:this.CloudStorageBox}):Object(T.default)(te.a,{dispatch:i,file:t,user:n,readonly:s,connected:r,isAppReady:l,whiteBg:a}))}},{key:"renderName",value:function(){var e=this.props,t=e.file,n=e.dispatch,i=e.contentReadonly,o=i||!t.user_acl.update;return h.a.createElement(re,{cmbId:ae.FileName},h.a.createElement("div",{className:"file-name"},h.a.createElement($,{dispatch:n,file:t,readonly:o}),h.a.createElement(ie.a,null),!window.__WPSENV__.draft&&this.renderFileStatus()))}},{key:"render",value:function(){return!this.props.file.user_acl.isDefault&&h.a.createElement("div",{className:"component-header-file-info"},this.renderName())}}]),t}(p.PureComponent),ce=(n(11509),n(250)),ue=n.n(ce),de="button";function fe(e){return e?{backgroundImage:"url("+e+")"}:null}var pe=0;function he(){return(++pe).toString()}var me=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){return this.renderBtn()}}]),t}(function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.state.enable&&n.action&&n.action()},n.state={id:e.id,icon:e.icon,caption:e.caption,tooltip:e.tooltip,enable:!0,visible:!0,iconStyle:fe(e.icon),action:e.action,className:e.className},n}return f()(t,e),s()(t,[{key:"getClassName",value:function(){var e=this.state,t=e.icon,n=e.caption,i=e.enable,o=e.visible,r=e.className;return h.a.classNames({"component-custom-header-btn":1,"component-icon-text-btn":t&&n,"component-icon-btn":t&&!n,"component-text-btn":!t&&n,disabled:!i,hidden:!o},r)}},{key:"renderBtn",value:function(){var e=this.state,t=e.icon,n=e.caption,i=e.tooltip,o=e.iconStyle;return h.a.createElement(ue.a,{title:i},h.a.createElement("div",{className:this.getClassName(),onClick:this.handleClick,role:"button"},!!t&&h.a.createElement("div",{className:"icons icons-16",style:o}),!!n&&h.a.createElement("div",{className:"btn-text"},n)))}},{key:"id",get:function(){return this.state.id}},{key:"icon",set:function(e){this.setState({icon:e,iconStyle:fe(e)})},get:function(){return this.state.icon}},{key:"caption",set:function(e){this.setState({caption:e})},get:function(){return this.state.caption}},{key:"tooltip",set:function(e){this.setState({tooltip:e})},get:function(){return this.state.tooltip}},{key:"action",set:function(e){this.setState({action:e})},get:function(){return this.state.action}},{key:"enable",set:function(e){this.setState({enable:e})},get:function(){return this.state.enable}},{key:"visible",set:function(e){this.setState({visible:e})},get:function(){return this.state.visible}}]),t}(p.PureComponent));me.propTypes={id:C.a.oneOfType([C.a.string,C.a.number]).isRequired,icon:C.a.string,caption:C.a.string,tooltip:C.a.string,action:C.a.func,className:C.a.string};var ve=me,be=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){var e=this.props;return h.a.createElement(h.a.Fragment,{key:e.id},e.controlType===de&&h.a.createElement(ve,o()({ref:e._ref},e)))}}]),t}(p.PureComponent),ge=n(81),ye=n(84),we=n.n(ye),_e=window.CommandBarComponent,Ee=_e.cmbIds.$public,Ce=window.__WPSPLUGIN__.helper,Se=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Ee.HeaderLeft));n.backPlugin={pluginType:Ce.types.Back},n.timer=null,n.handleClickSideBarBtn=Object(ge.debounce)((function(){M.default.dispatchEvent(M.default.names.CLICK_HEADER_SIDEBAR,{})}),200),n.handleSwitchSideBarBtn=function(e){var t=e.detail.visible;n.setState({showSideBarBtn:t})},n.refBtn=h.a.createRef(),n.handleBack1=n.handleBack.bind(n,0),n.handleBack2=n.handleBack.bind(n,1);var i=n.getLogoTitle(),o=i.logoTitle,r=i.logoClick,l=window.__CONFIG__.header.isShowBrand;return n.state={showBrand:l,showFileInfo:!l,showBrandText:!1,logoTitle:o,logoClick:r,customItems:[],normalItems:[{index:0,id:"SideBarBtn",component:n.renderSideBarBtn},{index:10,id:"HomeBtn",component:n.renderHomeBtn},{index:20,id:"MoreBtn",component:n.renderMoreBtn},{index:30,id:"LogoAndFile",component:n.renderLogoAndFile}],showSideBarBtn:!1},n}var n;return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this;this.state.logoClick&&this.backPlugin&&!we()()&&window.__WPSENV__.commandbars.push({el:this.refBtn,text:this.state.logoTitle}),this.props.openSuccess&&this.startTimer(),window.__WPSPLUGIN__.pluginMgr.helper.CommandBars.HeaderLeft={add:function(t){return e._add(t)},remove:function(t){return e._remove(t)},visible:function(t){return e._visible(t)}},window.addEventListener(M.default.names.SHOW_HEADER_SIDEBAR_BTN,this.handleSwitchSideBarBtn)}},{key:"componentDidUpdate",value:function(e,t){e.openSuccess!==this.props.openSuccess&&this.startTimer()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),window.removeEventListener(M.default.names.SHOW_HEADER_SIDEBAR_BTN,this.handleSwitchSideBarBtn)}},{key:"startTimer",value:function(){var e=this;this.state.showFileInfo||(this.setState({showBrandText:!0}),this.timer=setTimeout((function(){e.timer=null,e.setState({showFileInfo:!0,showBrandText:!1})}),2e3))}},{key:"handleBack",value:(n=_()(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.__WPSPLUGIN__.loader,e.next=3,n.loadSingleInstance(this.backPlugin);case 3:e.sent.tap({number:t}),window.collection2("header_logo");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getLogoTitle",value:function(){var e=void 0,t=void 0;return window.__WPSPLUGIN__.loader.search(this.backPlugin)&&this.backPlugin&&(e=_i18n("applications.public.components.commandbars.Header.logoTitle", "{productTitle} Home"),t=this.handleBack2),{logoTitle:e,logoClick:t}}},{key:"renderSideBarBtn",value:function(){var e=this.props,t=e.isOpenSideApp,n=e.sideBarShowTitle,i=e.sideBarHideTitle,o=t?i:n;return h.a.createElement(x.a,{size:"medium",title:o,active:t,theme:!0,icon:h.a.createElement(U.a,null),className:"side-bar-btn",onClick:this.handleClickSideBarBtn})}},{key:"renderHomeBtn",value:function(){if(we()())return null;var e=this.state,t=e.logoTitle;return e.logoClick&&h.a.createElement(x.a,{size:"medium",icon:h.a.createElement(z.a,null),ref:this.refBtn,title:t,className:"home-btn",onClick:this.handleBack1})}},{key:"renderMoreBtn",value:function(){return window.__CONFIG__.header.headerLeft.disableMoreBtn?null:h.a.createElement(F,{panelClassName:"file-more-panel"})}},{key:"renderLogoAndFile",value:function(){if(window.__CONFIG__.header.headerLeft.disableLogoAndFileInfo)return null;var e=this.props,t=e.dispatch,n=e.contentReadonly,i=e.connected,o=e.user,r=e.file,a=e.whiteBg,l=e.isAppReady,s=e.showEleConfig;return this.state.showFileInfo?h.a.createElement(h.a.Fragment,null,h.a.createElement(se,{dispatch:t,contentReadonly:n,file:r,user:o,connected:i,isAppReady:l,whiteBg:a,showEleConfig:s})):h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"brand-wrap"},h.a.createElement("div",{className:"brand-name"},_i18n("applications.public.components.commandbars.Header.brandName", "{productTitle}"))))}},{key:"getCustomItem",value:function(e){return h.a.createElement(be,e)}},{key:"_add",value:function(e){var t=this,n=e.index,i=void 0===n?0:n,o=e.controlType,r=void 0===o?de:o,a=e.icon,l=void 0===a?null:a,s=e.caption,c=void 0===s?null:s,u=e.tooltip,d=void 0===u?null:u,f=e.action,p=void 0===f?null:f,h=e.className,m=void 0===h?null:h,v=he();return this.setState((function(e){var n={index:i,id:v,controlType:r,icon:l,caption:c,tooltip:d,action:p,className:m,component:t.getCustomItem};return{customItems:[].concat(y()(e.customItems),[n])}})),v}},{key:"_remove",value:function(e){return this.setState((function(t){return{customItems:t.customItems.filter((function(t){return t.id!==e}))}})),!0}},{key:"_visible",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.setState((function(n){return{customItems:n.customItems.map((function(n){return n.id===e?o()({},n,{visible:t}):n}))}})),!0}},{key:"render",value:function(){var e=this,t=this.props,n=t.style,i=t.isOpenSideApp,o=this.state,r=o.showBrand,a=o.showSideBarBtn,l="component-header-left";r&&(l+=" show-brand"),i&&(l+=" open-side-app");var s=this.state,c=s.normalItems,u=s.customItems,d=[].concat(y()(c),y()(u)).filter((function(e){return!1!==e.visible})).sort((function(e,t){return e.index-t.index}));return h.a.createElement("div",{className:l,style:n,id:"component-header-left"},d.map((function(t){return"SideBarBtn"!==t.id||a?h.a.createElement(h.a.Fragment,{key:t.id},t.component.call(e,t)):null})))}},{key:"__visible",set:function(e){this.baseVisible=e,this.findDOMNode().style.visibility=e?"":"hidden"},get:function(){return this.baseVisible}}]),t}(_e);Se.propTypes={style:C.a.object,contentReadonly:C.a.bool.isRequired,whiteBg:C.a.bool,isOpenSideApp:C.a.bool,sideBarShowTitle:C.a.string,sideBarHideTitle:C.a.string,showEleConfig:C.a.object};var ke,Oe=Object(m.connect)((function(e){var t=e.public;return{user:t.user,file:t.file,connected:t.network.connected,openSuccess:t.network.openSuccess,isAppReady:t.network.isAppReady}}),null,null,{forwardRef:!0})(Se),Pe=(n(11510),window.CommandBarComponent.cmbIds),Me=[{tabKey:Pe.et.StartTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et1", "Start")},{tabKey:Pe.et.InsertTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et2", "Insert")},{tabKey:Pe.et.DataTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et3", "Data")},{tabKey:Pe.et.FormulaTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et4", "Formulas")},{tabKey:Pe.et.CooperationTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et5", "Collaboration")},{tabKey:Pe.et.ViewTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et6", "View")},{tabKey:Pe.et.ToolsTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.et7", "Special Function")}],Te=(ke={},k()(ke,v.default.spreadsheet,Me),k()(ke,v.default.ksheet,Me),k()(ke,v.default.writer,[{tabKey:Pe.wps.StartTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wps1", "Start")},{tabKey:Pe.wps.InsertTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wps2", "Insert")},{tabKey:Pe.wps.ReviewTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wps3", "Review"),commandBarId:Pe.wps.TabReviewWord},{tabKey:Pe.wps.PageTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wps4", "Page")},{tabKey:Pe.wps.ToolsTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wps5", "Special Function")}]),k()(ke,v.default.presentation,[{tabKey:Pe.wpp.InsertTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wpp1", "Insert")},{tabKey:Pe.wpp.ReviewTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wpp2", "Review")},{tabKey:Pe.wpp.ViewTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wpp3", "View")},{tabKey:Pe.wpp.PlayTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wpp4", "Play")},{tabKey:Pe.wpp.ToolsTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.wpp5", "Special Function")}]),k()(ke,v.default.pdf,[{tabKey:Pe.pdf.StartTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.pdf1", "Start")},{tabKey:Pe.pdf.AnnoTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.pdf2", "Annotation")},{tabKey:Pe.pdf.ToolsTab,text:_i18n("applications.public.components.commandbars.Header.HeaderMiddle.types.pdf3", "Special Function")}]),k()(ke,v.default.outline,[]),ke);var Ie=n(1055),De=n.n(Ie),Ne=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.commandBarId||"Tab"+e.info.tabKey));return n.handleClick=n.handleClick.bind(n),n}return f()(t,e),s()(t,[{key:"handleClick",value:function(){var e=this.props,t=e.selected,n=e.info;t||(this.props.onActive(n),window.collection2("header_tab_"+n.tabKey))}},{key:"render",value:function(){var e=this.props,t=e.selected,n=e.info,i=e.onImgLoad,o=-1!==n.text.indexOf("//"),r="tab-btn";return t&&(r+=" selected"),o&&(r+=" img-tab"),h.a.createElement("div",{id:n.tabKey,className:r,onClick:this.handleClick,role:"button","alt-hint-keep":"true"},o&&h.a.createElement("img",{src:n.text,alt:"",onLoad:i}),!o&&n.text)}}]),t}(window.CommandBarComponent);Ne.propTypes={info:C.a.shape({tabKey:C.a.string.isRequired,text:C.a.string.isRequired}).isRequired,selected:C.a.bool.isRequired,onActive:C.a.func.isRequired,onImgLoad:C.a.func.isRequired,commandBarId:C.a.string};var Le=Ne,Re=window.CommandBarComponent,xe=Re.cmbIds.$public,He=window.CommandBarComponent.cmbIds.$public.HeaderTab,je=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,xe.HeaderMiddle));n.handleInnerVisible=function(e){var t=e.detail.visible;n.setState({innerVisible:t})},n.refDiv=h.a.createRef(),n.handleItemActive=n.handleItemActive.bind(n),n.handleSwitchTab=n.handleSwitchTab.bind(n);var i=G.getPageOfficeType(),o=function(e){return Te[e]||[]}(i);return n.state={officeType:i,items:o,activeItem:o.length?o[0]:null,visible:!0,innerVisible:window.officeType!==v.default.ksheet},n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(M.default.names.SWITCH_COMMANDBAR_TAB,this.handleSwitchTab),window.addEventListener(M.default.names.SWITCH_HEADER_INNER_VISIBLE,this.handleInnerVisible)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(M.default.names.SWITCH_COMMANDBAR_TAB,this.handleSwitchTab),window.removeEventListener(M.default.names.SWITCH_HEADER_INNER_VISIBLE,this.handleInnerVisible)}},{key:"handleSwitchTab",value:function(e){var t=e.detail.tabKey,n=this.state.items.find((function(e){return e.tabKey===t}));this.setState({activeItem:n})}},{key:"handleItemActive",value:function(e){this.setState({activeItem:e});var t={tabKey:e.tabKey};M.default.dispatchEvent(M.default.names.SWITCH_COMMANDBAR_TAB,t)}},{key:"getWidth",value:function(){return this.refDiv.current?this.refDiv.current.clientWidth:0}},{key:"render",value:function(){var e=this;if(window.__CONFIG__.header.headerMiddle.disable)return null;var t=this.props,n=t.onImgLoad,i=t.style,o=this.state,r=o.officeType,a=o.items,l=o.activeItem,s=o.visible,c=o.innerVisible,u=a.map((function(t,i){return h.a.createElement(Le,{key:t.tabKey,commandBarId:t.commandBarId||"Tab"+t.tabKey,info:t,selected:t===l,onActive:e.handleItemActive,onImgLoad:n})})),d="component-header-middle "+r;return 0!==u.length&&s&&c?h.a.createElement("div",{className:d,style:i,ref:this.refDiv},h.a.createElement(De.a,{visible:s,className:"wo-cmb-level1",tabKey:He,register:!1},u)):null}},{key:"__visible",get:function(){return this.state.visible},set:function(e){this.setState({visible:e})}}]),t}(Re);je.propTypes={visible:C.a.bool.isRequired,onImgLoad:C.a.func.isRequired,style:C.a.object};var We=je,Ae=(n(11511),n(11512),n(351)),Be=(n(11513),n(681)),Ve=(n(11514),n(625)),Fe=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"renderTitle",value:function(){var e=this.props,t=e.owner,n=e.me,i=e.member,o=i.shortName;return n.id===i.id?t.id===i.id?o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.meOwnerTips", "(Me, Owner)"):o?o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.meTips", "(Me)"):_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.me", "Me"):t.id===i.id?o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.ownerTips", "(Owner)"):i.isLogin?i.canWrite?o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.writeTips", "(Editable)"):"comment"===i.permission?o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.commentTips", "(Can Comment)"):o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.readonlyTips", "(Read-only)"):o+_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.notLoginTips", "(Not logged in)")}},{key:"render",value:function(){var e=this.props,t=e.children;if(e.disabled)return t;var n=this.renderTitle();return h.a.createElement(Ve.default,{title:n},t)}}]),t}(p.PureComponent),ze=Object(G.getPageOfficeType)(),Ue=Object(v.isEtLike)(ze)||ze===v.default.writer,Ge=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return f()(t,e),s()(t,[{key:"handleClick",value:function(){Ue&&this.props.onClick(this.props.member)}},{key:"renderName",value:function(){var e=this.props,t=e.me,n=e.member;if(!e.showName)return!1;var i=n.name;return t.id===n.id&&(i+=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.meTips", "(Me)")),h.a.createElement("div",{className:"member-name"},i)}},{key:"renderStatus",value:function(){var e=this.props,t=e.showName,n=e.online,i=e.owner,o=e.member;if(!t||i.id===o.id&&n)return!1;var r=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.readonly", "Read only");return i.id===o.id?r=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.offline", "Offline"):o.canWrite?r=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.canEdit", "Editable"):o.isLogin?"comment"===o.permission&&(r=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.canComment", "Can Comment")):r=_i18n("applications.public.components.commandbars.Header.Cooperation.CooperAvatar.notLogin", "Not logged in"),h.a.createElement("div",{className:"member-status"},r)}},{key:"render",value:function(){var e=this.props,t=e.owner,n=e.member,i=e.showName,o=e.online,r=e.me,a=null;i&&n.id!==t.id&&(a=n._color);var l="component-cooper-avatar";return i&&(l+=" show-name"),o||(l+=" disabled"),h.a.createElement("div",{className:l,onClick:this.handleClick},h.a.createElement("div",{className:"avatar-wrap"},h.a.createElement(Fe,{member:n,me:r,owner:t,disabled:!o},h.a.createElement("div",{className:"avatar-box"},h.a.createElement(Be.default,{size:"small",src:n.avatar,strokeColor:a}),this.renderName()))),this.renderStatus())}}]),t}(p.PureComponent);Ge.defaultProps={online:!0,showName:!1};var Ke=Ge,Xe=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return n=i=u()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.refDiv=h.a.createRef(),o=n,u()(i,o)}return f()(t,e),s()(t,[{key:"getWidth",value:function(){return this.refDiv.current.clientWidth}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.owner,i=e.members,o=e.onClick,r=e.disabled,a=i.map((function(e){return h.a.createElement(Ke,{key:e.id,owner:n,me:t,member:e,onClick:o})}));return h.a.createElement("div",{ref:this.refDiv,className:"cooper-avatars"+(r?" disabled":"")},a)}}]),t}(p.PureComponent),qe=(n(11515),n(393)),Ye=qe.default.Divider,Ze=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.owner,n=e.me,i=e.members,o=e.onClick;t=i.find((function(e){return e.id===t.id}))||t;var r=n.id===t.id||i.some((function(e){return e.id===t.id}));i=i.filter((function(e){return e.id!==t.id})),n.id!==t.id&&(i=i.filter((function(e){return e.id!==n.id}))).unshift(n);var a=i.map((function(e){return h.a.createElement(Ke,{key:e.id,showName:!0,owner:t,me:n,member:e,onClick:o})}));return h.a.createElement(qe.default,{className:"cooper-members-panel"},h.a.createElement("div",{className:"title"},_i18n("applications.public.components.commandbars.Header.Cooperation.MemberPanel.owner", "Owner")),h.a.createElement(Ke,{showName:!0,online:r,owner:t,me:n,member:t,onClick:o}),h.a.createElement(Ye,null),h.a.createElement("div",{className:"title"},_i18n("applications.public.components.commandbars.Header.Cooperation.MemberPanel.cooperMembers", "Member in collaboration")),h.a.createElement("div",{className:"cooper-members"},a))}}]),t}(p.PureComponent),Je=n(11516),Qe=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.refWrap=h.a.createRef(),n.refAvatar=h.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClick=n.handleClick.bind(n);var i=e.user;return n.state={visible:!1,me:i,showMembers:[i]},n}return f()(t,e),s()(t,[{key:"updateMembers",value:function(){var e=this.props,t=e.members,n=e.user,i=e.file;if(0!==t.length){var o=t.find((function(e){return e.id===i.creator.id})),r=t.find((function(e){return e.id===n.id||!e.id}));r=r||n;var a=t.filter((function(e){return e.id!==r.id&&(!o||e.id!==o.id)}));o&&a.unshift(o),o&&r.id===o.id||a.unshift(r);var l=this.refWrap.current.clientWidth-2,s=parseInt(l/this.avatarWidth);s=Math.max(2,s),s=Math.min(6,s),a.length>s&&(s-=1),a=a.filter((function(e,t){return t<s})),this.setState({me:r,showMembers:a})}}},{key:"observerPanel",value:function(){var e=this,t=0;new MutationObserver((function(){var n=e.refWrap.current.clientWidth;t!==n&&(t=n,e.updateMembers())})).observe(this.refWrap.current.parentNode,{attributes:!0,childList:!0,subtree:!0})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.avatarWidth=this.refAvatar.current.getWidth(),this.updateMembers(),this.observerPanel(),Object(Je.initLangGuidePlugin)(this.refWrap)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize)}},{key:"componentDidUpdate",value:function(e,t){this.props.members!==e.members&&this.updateMembers()}},{key:"handleWindowResize",value:function(){this.updateMembers()}},{key:"handleVisibleChange",value:function(e){this.setState({visible:e}),window.collection2("header_users_more")}},{key:"handleClick",value:function(e){switch(this.setState({visible:!1}),Object(G.getPageOfficeType)()){case v.default.spreadsheet:case v.default.ksheet:var t=window.APP.getUilCmdTool();t&&t.followCooperator(e.id);break;case v.default.writer:window.APP.data.selection.selCoop.jumpToUser(e.id);break;case v.default.presentation:window.APP.shell.doc.jumpToUser(e.id);break;case v.default.pdf:}window.collection2("cooper_avatar_location")}},{key:"render",value:function(){var e=this.props,t=e.file,n=e.members,i=t.creator,o=this.state,r=o.visible,a=o.me,l=o.showMembers,s=h.a.createElement(Ze,{me:a,members:n,owner:i,onClick:this.handleClick});return h.a.createElement("div",{ref:this.refWrap,className:"cooperation-wrap"},n.length>l.length&&h.a.createElement(Ae.default,{title:_i18n("applications.public.components.commandbars.Header.Cooperation.showMembers", "View All Members"),panel:s,visible:r,onVisibleChange:this.handleVisibleChange},h.a.createElement(ue.a,{title:_i18n("applications.public.components.commandbars.Header.Cooperation.showMembers", "View All Members")},h.a.createElement("div",{className:"members-more-btn"+(r?" selected":"")},n.length))),h.a.createElement(Xe,{ref:this.refAvatar,me:a,owner:i,disabled:r,members:l,onClick:this.handleClick}))}}]),t}(p.PureComponent),$e=Object(m.connect)((function(e){var t=e.public;return{user:t.user,file:t.file,members:t.cooperation.members}}))(Qe),et="PLUGIN_UPDATE_MEMBERS",tt="UPDATE_CONNECTED",nt="INVITE_LOGIN",it="LAYOUT_BLUR",ot="LAYOUT_FOCUS",rt="POSITIONING_MEMBER",at="MEMBER_PERMISSION_CHANGE",lt=window.CommandBarComponent,st=lt.cmbIds.$public,ct=function(e){function t(e){var n=this;a()(this,t);var i,o,r=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,st.CooperationWrap));return r.cooperationPlugin=void 0,r.onCooperationMembersPush=(i=_()(regeneratorRuntime.mark((function e(t){var i,o,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cooperationPlugin;case 2:i=e.sent,o=r.getRealIdByUser(t),a=o.members,l=o.user,i.messageGet({detail:{members:a,user:l},pluginEvent:et,pluginType:r.cooperMemberAvatarsType,total:t.total});case 5:case"end":return e.stop()}}),e,n)}))),function(e){return i.apply(this,arguments)}),r.onCooperationConnectPush=(o=_()(regeneratorRuntime.mark((function e(t){var i=t.connected;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cooperationPlugin;case 2:e.sent.messageGet({detail:{connected:i},pluginEvent:tt,pluginType:r.cooperMemberAvatarsType});case 4:case"end":return e.stop()}}),e,n)}))),function(e){return o.apply(this,arguments)}),r.onCooperationPluginGet=function(e){var t=e.detail,n=e.pluginEvent,i=t.me,o=t.member;switch(n){case nt:window.session.sendBroadcast({action:"inviteLogin",from:i,to:o});break;case it:case ot:break;case rt:r.handleAvatarClick(o);break;case at:r.handleMemberPermissionChange(t)}},r.handleAvatarClick=function(e){var t=r.props.members.find((function(t){return t.real_userid===e.id})),n=t&&t.id||e.id;switch(window.officeType){case v.default.spreadsheet:case v.default.ksheet:var i=window.APP.getUilCmdTool();i&&i.followCooperator(n);break;case v.default.writer:window.APP.data.selection.selCoop.jumpToUser(n);break;case v.default.presentation:window.APP.shell.doc.jumpToUser(n);break;case v.default.pdf:break;case v.default.outline:window.APP.OTL.uilproxy.jumpToUser(n)}window.collection2("cooper_avatar_location")},r.handleMemberPermissionChange=function(e){var t=e.command,n=e.member,i=r.props,o=i.file,a=i.user,l=i.members,s=l;"update"===t?s.forEach((function(e){e.id!==n.id||(e.permission=n.permission)})):"remove"===t&&(s=l.filter((function(e){return e&&e.id!==n.id}))),r.onCooperationMembersPush({members:s,user:a,file:o,total:s.length})},r.hanlePluginRef=function(e){r.refCooperMemberAvatarsPluginRef=e},r.cooperMemberAvatarsType="CooperMemberAvatars",r.CooperationPluginConfig=window.__WPSPLUGIN__.loader.search({pluginType:r.cooperMemberAvatarsType}),r}var n;return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.isAppReady&&this.CooperationPluginConfig&&(this.cooperationPlugin=this.loadCooperationPlugin())}},{key:"componentDidUpdate",value:function(e,t){!this.cooperationPlugin&&this.CooperationPluginConfig&&e.isAppReady!==this.props.isAppReady&&(this.cooperationPlugin=this.loadCooperationPlugin()),this.cooperationPlugin&&(this.props.members===e.members&&this.props.total===e.total||this.onCooperationMembersPush(this.props),this.props.connected!==e.connected&&this.onCooperationConnectPush(this.props))}},{key:"getRealIdByUser",value:function(e){var t=e.members.map((function(e){return o()({},e,{id:e.real_userid})})),n=o()({},e.user,{id:e.user.attrs.real_userid});if(e&&e.file){var i=o()({},e.file);if(e.file.creator&&e.file.creator.attrs&&e.file.creator.attrs.real_userid){var r=o()({},e.file.creator,{id:e.file.creator.attrs.real_userid});Object.assign(i,{creator:r})}if(e.file.modifier&&e.file.modifier.attrs&&e.file.modifier.attrs.real_userid){var a=o()({},e.file.modifier,{id:e.file.modifier.attrs.real_userid});Object.assign(i,{modifier:a})}return{members:t,user:n,file:i}}return{members:t,user:n}}},{key:"loadCooperationPlugin",value:(n=_()(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,l,s,c,u,d,f,p,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.CooperationPluginConfig){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,window.__WPSPLUGIN__.loader.load({pluginType:this.cooperMemberAvatarsType});case 4:return t=e.sent,n=this.props,i=n.file,o=n.user,r=n.members,a=n.connected,l=n.total,s=this.getRealIdByUser({user:o,members:r,file:i}),c=s.members,u=s.user,d=s.file,f={file:d,user:u,members:c||[],connected:a,zIndex:1e3,isPdf:i.office_type===v.default.pdf,readOnlyComment:window.APP.isReadOnlyComment(),supportReadOnlyComment:window.APP.supportReadOnlyComment(),total:l},p=this.refCooperMemberAvatarsPluginRef,h=new t({layout:{getPluginContainer:function(){return p}},messagePush:this.onCooperationPluginGet,initParams:f}),e.next=12,h.plugin;case 12:return(m=e.sent).init&&m.init(f),e.abrupt("return",m);case 15:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){return!!this.props.isAppReady&&h.a.createElement(h.a.Fragment,null,this.CooperationPluginConfig?h.a.createElement("div",{id:this.cooperMemberAvatarsType+"_container",ref:this.hanlePluginRef,className:"cooperation-wrap"}):h.a.createElement($e,null))}}]),t}(lt),ut=Object(m.connect)((function(e){var t=e.public;return{user:t.user,file:t.file,members:t.cooperation.members,total:t.cooperation.total,connected:t.network.connected,isAppReady:t.network.isAppReady}}))(ct),dt=(n(10231),n(343)),ft=n(272),pt=n(1490),ht=n(319),mt=n(312),vt=n(11517),bt=n.n(vt),gt=n(10232),yt=n(1532),wt=n(564),_t=n(486),Et=n(70),Ct=n.n(Et),St=n(687),kt=mt.default.iconTypes.size16,Ot=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.autoCloseTimer=null,n.refBtn=h.a.createRef(),n.refPanel=h.a.createRef(),n.refShadow=h.a.createRef(),n.refModal=h.a.createRef(),n.handleBtn=n.handleBtn.bind(n),n.handlePanelBtn=n.handlePanelBtn.bind(n),n.handleClose=n.handleClose.bind(n),n.handleShowPanel=n.handleShowPanel.bind(n),n.handleSetRefModal=n.handleSetRefModal.bind(n),Object(yt.isSuperPreview)()&&(n.isSuperpreview=!0,n.props.dispatch(Object(pt.changeLoginGuidVisible)(!1))),Object(wt.isReadingMode)()&&n.props.dispatch(Object(pt.changeLoginGuidVisible)(!1)),Object(wt.isReadingMode)()&&n.props.dispatch(Object(pt.changeLoginGuidVisible)(!1)),n.state={isLogin:!1,canEdit:!1,visible:!1,panelText:"",showPanel:!1,isFromExternal:!1},n}var n,i;return f()(t,e),s()(t,[{key:"componentDidMount",value:(i=_()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initState();case 2:if(this.state.visible){e.next=5;break}return this.props.dispatch(Object(pt.changeLoginGuidVisible)(!1)),e.abrupt("return");case 5:this.waitToShow||this.hasUnSyncFileInfo||(this.startAutoClose(),this.sendCollection("show")),window.addEventListener(M.default.names.cooper.ON_SHOW_LOGIN_GUIDE,this.handleShowPanel),window.addEventListener(M.default.names.cooper.ON_CLOSE_LOGIN_GUIDE,this.handleClose),window.addEventListener(M.default.names.ON_EDIT,this.handleBtn);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){window.removeEventListener(M.default.names.cooper.ON_SHOW_LOGIN_GUIDE,this.handleShowPanel),window.removeEventListener(M.default.names.cooper.ON_CLOSE_LOGIN_GUIDE,this.handleClose),window.removeEventListener(M.default.names.ON_EDIT,this.handleBtn)}},{key:"componentDidUpdate",value:function(e){this.waitToShow&&this.props.isAppReady&&!e.isAppReady&&(this.handleShowReadOnlyComment(),this.waitToShow=!1)}},{key:"initState",value:(n=_()(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,l,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.file,i=t.user,o=t.isAppReady,r=i.isLogin,a=n.user_acl.update,l=Object(gt.shouldMountLoginGuide)(n,i),s=!0,c=_i18n("applications.public.components.commandbars.Header.HeaderRight.text1", "You can only view documents without signing in. Sign in to use more features."),r&&(c=_i18n("applications.public.components.commandbars.Header.HeaderRight.text2", "Read-only document. Enable editing")),i.attrs&&"0"===i.attrs.certification&&(c=_i18n("applications.public.components.commandbars.Header.HeaderRight.text3", " Verify the mobile phone number to enable document editing")),window.APP.isReadOnly()&&n.user_acl.comment&&(o?window.APP.isReadOnlyComment()&&(c=_i18n("applications.public.components.commandbars.Header.HeaderRight.text4", "The current permission is \"Can Comment\". You can apply to enable the edit permission.")):(this.waitToShow=!0,s=!1)),!this.props.user.isLogin||!window.APP.isReadOnly()){e.next=14;break}return e.next=12,Ct.a.info.checkUnSyncFileInfo();case 12:this.hasUnSyncFileInfo=e.sent,this.hasUnSyncFileInfo&&(c=window.APP.isReadOnlyComment()?_i18n("applications.public.components.commandbars.Header.HeaderRight.text6", "Comments are allowed. Offline content can be synchronized after you are granted editing permissions."):_i18n("applications.public.components.commandbars.Header.HeaderRight.text5", "Read-only. Offline content can be synchronized after you are granted editing permissions."));case 14:this.setState({isLogin:r,canEdit:a,visible:l,panelText:c,showPanel:s});case 15:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"handleShowReadOnlyComment",value:function(){var e=window.APP.isReadOnlyComment()?_i18n("applications.public.components.commandbars.Header.HeaderRight.text4", "The current permission is \"Can Comment\". You can apply to enable the edit permission."):this.state.panelText;this.setState({showPanel:!0,panelText:e}),this.startAutoClose()}},{key:"handleShowPanel",value:function(e){var t=this,n=e.detail.text;this.setState({panelText:n,showPanel:!0,isFromExternal:!0},(function(){t.sendCollection("show"),t.startAutoClose(e)}))}},{key:"startAutoClose",value:function(e){var t=this;(!this.props.file.user_acl.isLinkWrite||_t.canRequestForAuthForSecurityDoc&&Object(_t.isEditLimitedSecurityDoc)())&&(clearTimeout(this.autoCloseTimer),this.autoCloseTimer=setTimeout((function(){t.doClose(),t.sendCollection("autoclose"),window.__WPSENV__.altStatus&&M.default.dispatchEvent(M.default.names.EXIT_ALT_MODE,e)}),5e3))}},{key:"doClose",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;clearTimeout(this.autoCloseTimer);var n=this.refPanel.current||this.refModal.current,i=function(){e.setState({showPanel:!1,isAnimationOut:!1},t),e.props.dispatch(Object(pt.changeLoginGuidVisible)(!1))};n&&Object(ft.runOpacity)({element:n,keepEnd:!0,start:1,end:0,onDone:i}),this.refShadow.current&&Object(ft.runOpacity)({element:this.refShadow.current,keepEnd:!0,start:1,end:0})}},{key:"handleBtn",value:function(){this.sendCollection("edit");var e=this.props.file.user_acl.update;switch(!0){case!this.state.isLogin:Object(dt.gotoLogin)(!1);break;case Object(yt.isSuperPreview)():M.default.dispatchEvent(M.default.names.SHOW_SUPERPREVIEW_TOAST);break;case Object(wt.isReadingMode)():Object(wt.closeReadingMode)();break;case!e:Object(dt.gotoEdit)();break;case _t.canRequestForAuthForSecurityDoc&&Object(_t.isEditLimitedSecurityDoc)():Object(_t.requestForAuth)({type:_t.AUTH_TYPES.EDIT})}}},{key:"handlePanelBtn",value:function(){var e=this;this.doClose((function(){e.sendCollection("click");var t=e.props.file.user_acl.update;switch(!0){case!e.state.isLogin:Object(dt.gotoLogin)(!1);break;case!t:Object(dt.gotoEdit)();break;case _t.canRequestForAuthForSecurityDoc&&Object(_t.isEditLimitedSecurityDoc)():Object(_t.requestForAuth)({type:_t.AUTH_TYPES.EDIT})}}))}},{key:"handleClose",value:function(){this.doClose(),this.sendCollection("close")}},{key:"sendCollection",value:function(e){var t=this.state,n=t.isLogin,i=t.canEdit,o=t.showPanel,r=t.isFromExternal;n=n?"login":"nologin",i=i?"edit":"read";var a=o||"click"===e?"max":"min",l=this.props.file.user_acl.isLinkWrite?"modal":"banner";window.collection2("loginguid_"+a+"_"+e+"_"+n+"_"+i+"_"+r+"_"+l)}},{key:"handleSetRefModal",value:function(e){e&&(this.refModal=e.refModal,this.refShadow=e.refShadow)}},{key:"render",value:function(){if(!this.state.visible)return!1;if(Object(b.hasQuery)("hide_public_popups"))return!1;var e=this.state,t=e.showPanel,n=e.panelText,i=this.props,o=i.file,r=i.user,a=o.user_acl.isLinkWrite&&!r.isLogin,l=r.attrs&&"0"===r.attrs.certification?_i18n("applications.public.components.commandbars.Header.HeaderRight.verify", "Verify Now"):_i18n("applications.public.components.commandbars.Header.HeaderRight.applyEdit", "Apply for Editing Permissions");return h.a.createElement(h.a.Fragment,null,t&&!a&&!this.isSuperpreview&&!Object(wt.isReadingMode)()&&h.a.createElement(ht.default,{visible:!0},h.a.createElement("div",{ref:this.refPanel,className:"login-guid-bar"},h.a.createElement("div",{className:"content"},h.a.createElement(St.default,{size:16,fill:["var(--kd-color-icon-info)","var(--kd-color-text-white)"]}),h.a.createElement("div",{className:"text"},n),h.a.createElement(x.a,{type:"primary",className:"edit-btn",onClick:this.handlePanelBtn},r.isLogin?l:_i18n("applications.public.components.commandbars.Header.HeaderRight.loginImmediately", "Sign in Now")),h.a.createElement(x.a,{className:"close-btn",iconType:kt.close,onClick:this.handleClose})))),t&&a&&Object(T.default)(bt.a,{ref:this.handleSetRefModal,file:o,onClose:this.handleClose,onClick:this.handlePanelBtn}))}}]),t}(p.PureComponent),Pt=n(11518),Mt=n.n(Pt),Tt=n(11520),It=n.n(Tt),Dt=n(11521),Nt=n.n(Dt),Lt=n(11523),Rt=n.n(Lt),xt=n(11527),Ht=n.n(xt),jt=n(1202),Wt=n(11540),At=n.n(Wt),Bt=(n(11543),window.CommandBarComponent),Vt=Bt.cmbIds.$public,Ft=function(e){function t(e){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Vt.HeaderRightInsert))}return f()(t,e),s()(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"header-right-insert"})}}]),t}(Bt),zt=n(11544),Ut=n(11545),Gt=n(7837),Kt=n(7835),Xt=n(11546),qt=n.n(Xt),Yt=window.CommandBarComponent,Zt=Yt.cmbIds.$public,Jt=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Zt.HeaderRight));n.handleVisibleChange=function(e){n.setState({visible:e})},n.subMenuOnClose=function(){},n.atInboxRef=h.a.createRef(),n.renderAiBtn=function(){return n.props.isAppReady&&h.a.createElement(qt.a,null)},n.containerRef=h.a.createRef();var i=G.getPageOfficeType();return n.state={officeType:i,visible:!1,customItems:[],normalItems:[{index:110,id:"WPSOpen",component:n.getWPSOpen},{index:105,id:"CollaborationSwitch",component:n.getCollaborationSwitch},{index:100,id:"ShareLink",component:n.getShareLink},{index:80,id:"Edit",component:n.getEdit},{index:90,id:"Draft",component:n.getDraft}],narrowItems:[]},n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.isAppReady&&this.initPluginsAfterReady(),window.__WPSPLUGIN__.pluginMgr.helper.CommandBars.HeaderRight={add:function(t){return e._add(t)},remove:function(t){return e._remove(t)},visible:function(t){return e._visible(t)}}}},{key:"componentDidUpdate",value:function(e){!e.isAppReady&&this.props.isAppReady&&this.initPluginsAfterReady()}},{key:"initPluginsAfterReady",value:function(){Object(zt.initTextChatPlugin)(this.containerRef.current),Object(Ut.initVoiceChatPlugin)(this.containerRef.current),Object(Gt.initWOAChatPlugin)(),Object(Kt.initAtMessageBtnPlugin)(this.atInboxRef.current)}},{key:"getDraft",value:function(){if(window.__CONFIG__.header.headerRight.disableDraft)return null;if(!window.__WPSENV__.draft)return null;var e=this.props,t=e.isAppReady,n=e.file,i=e.dispatch,o=e.isNarrowMode;return h.a.createElement(h.a.Fragment,null,h.a.createElement(Rt.a,{file:n,dispatch:i,isAppReady:t,inSubMenu:o}))}},{key:"getShareLink",value:function(){var e=this.props,t=e.isAppReady,n=e.file,i=e.user,o=e.isNarrowMode;return h.a.createElement(Mt.a,{user:i,file:n,isAppReady:t,inSubMenu:o})}},{key:"getWPSOpen",value:function(){if(window.__CONFIG__.header.headerRight.disableWPSOpen||Object(jt.isShowCollaborationSwitch)())return null;var e=this.props,t=e.isAppReady,n=e.openSuccess,i=e.user,o=e.isNarrowMode;return h.a.createElement(Nt.a,{user:i,isAppReady:t,openSuccess:n,inSubMenu:o})}},{key:"getEdit",value:function(){if(window.__CONFIG__.header.headerRight.disableEdit)return null;var e=this.props,t=e.file,n=e.openSuccess,i=e.isNarrowMode,o=e.user,r=e.showEleConfig;return t&&t.id&&n&&r.showRightEditBtn?h.a.createElement(It.a,{inSubMenu:i,file:t,user:o}):null}},{key:"getCooperation",value:function(){return window.__CONFIG__.outline.disableUserInfo||window.__CONFIG__.header.headerRight.disableCooperation?null:!!this.props.user.id&&h.a.createElement(ut,null)}},{key:"getLoginGuide",value:function(){var e=this.props,t=e.file,n=e.openSuccess,i=e.dispatch,o=e.user,r=e.contentReadonly,a=e.isAppReady;return!!t.id&&n&&h.a.createElement(Ot,{dispatch:i,user:o,file:t,contentReadonly:r,isAppReady:a})}},{key:"getAtInBox",value:function(){if(window.__CONFIG__.header.headerRight.disableAtMessage)return null;var e=this.props,t=e.isNarrowMode,n=e.user;return h.a.createElement(Ht.a,{inSubMenu:t,user:n,ref:this.atInboxRef})}},{key:"getCollaborationSwitch",value:function(){if(!Object(jt.isShowCollaborationSwitch)())return null;var e=this.props.user;return h.a.createElement(At.a,{user:e})}},{key:"getCustomItem",value:function(e){return h.a.createElement(be,e)}},{key:"_add",value:function(e){var t=this,n=e.index,i=void 0===n?0:n,o=e.controlType,r=void 0===o?de:o,a=e.icon,l=void 0===a?null:a,s=e.caption,c=void 0===s?null:s,u=e.tooltip,d=void 0===u?null:u,f=e.action,p=void 0===f?null:f,h=e.className,m=void 0===h?null:h,v=he();return this.setState((function(e){var n={index:i,id:v,controlType:r,icon:l,caption:c,tooltip:d,action:p,className:m,component:t.getCustomItem};return{customItems:[].concat(y()(e.customItems),[n])}})),v}},{key:"_remove",value:function(e){return this.setState((function(t){return{customItems:t.customItems.filter((function(t){return t.id!==e}))}})),!0}},{key:"_visible",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.setState((function(n){return{customItems:n.customItems.map((function(n){return n.id===e?o()({},n,{visible:t}):n}))}})),!0}},{key:"renderNormalLayout",value:function(){var e=this,t=this.state,n=t.normalItems,i=t.customItems,o=[].concat(y()(n),y()(i)).filter((function(e){return!1!==e.visible})).sort((function(e,t){return t.index-e.index}));return h.a.createElement(h.a.Fragment,null,o.map((function(t){return h.a.createElement(h.a.Fragment,{key:t.id},t.component.call(e,t))})))}},{key:"render",value:function(){var e=this.state.officeType,t=this.props.style,n="component-header-right "+e;return h.a.createElement("div",{className:n,style:t,ref:this.containerRef},this.getCooperation(),this.renderAiBtn(),this.getLoginGuide(),this.renderNormalLayout(),h.a.createElement(Ft,null))}},{key:"__visible",set:function(e){this.baseVisible=e,this.findDOMNode().style.visibility=e?"":"hidden"},get:function(){return this.baseVisible}}]),t}(Yt);Jt.propTypes={style:C.a.object,contentReadonly:C.a.bool.isRequired,isNarrowMode:C.a.bool,showEleConfig:C.a.object};var Qt=Object(m.connect)((function(e){var t=e.public;return{user:t.user,file:t.file,openSuccess:t.network.openSuccess,connected:t.network.connected,isAppReady:t.network.isAppReady}}),null,null,{forwardRef:!0})(Jt),$t=(n(11550),n(3531)),en=n(284),tn=_i18n("applications.public.components.commandbars.Header.SaveVersion.saveSuccess", "Saved successfully. You can view it in {historyLink}.");(window.officeType===v.default.whiteboard||window.officeType===v.default.dbsheet||window.__IN_SANDBOX__&&Object(v.isEtLike)(window.officeType)||!window.__CONFIG__.showHistoryLinkInSavingToast)&&(tn=_i18n("applications.public.components.commandbars.Header.SaveVersion.saveOk", "Current editing has been successfully saved"));var nn={ok:tn,nochange:_i18n("applications.public.components.commandbars.Header.SaveVersion.noChange", "No need to save. There\'re no changes made to the document."),SavedEmptyFile:_i18n("applications.public.components.commandbars.Header.SaveVersion.savedEmptyFile", "Saving empty files not supported"),SpaceFull:_i18n("applications.public.components.commandbars.Header.SaveVersion.spaceFull", "The space is full and documents cannot be saved. Contact the customer service."),QueneFull:_i18n("applications.public.components.commandbars.Header.SaveVersion.queneFull", "Do not operate frequently while saving the document"),fail:_i18n("applications.public.components.commandbars.Header.SaveVersion.saveFail", "Save failed. Please try again later"),fileNotExists:_i18n("applications.public.components.commandbars.Header.SaveVersion.fileNotExists", "File (folder) doesn\'t exist")},on=Object($t.a)(nn,en.size16.warning_red),rn=n(11551),an=n.n(rn),ln=n(147),sn=n(2315),cn=n(3351),un=n(956),dn=n(11553),fn=n.n(dn),pn=n(11554),hn=n.n(pn),mn=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,versionInfo:null,redPoints:[],funcGuides:[],specialFileSaveAs:!1},n.handleClose=n.handleClose.bind(n),n.handleCloseSaveAs=n.handleCloseSaveAs.bind(n),n}var n;return f()(t,e),s()(t,[{key:"componentDidMount",value:(n=_()(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,l,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkLanguage()){e.next=2;break}return e.abrupt("return");case 2:if(t=this.props.file,n=t.ext.toLowerCase(),!t.user_acl.update||".csv"!==n&&".rtf"!==n&&".log"!==n){e.next=7;break}return this.setState({specialFileSaveAs:!0,visible:!0}),e.abrupt("return");case 7:if(window.__CONFIG__.isShowUpdateNotice){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.props.dispatch(Object(un.c)(window.officeType));case 11:if(!(i=e.sent).error){e.next=14;break}return e.abrupt("return");case 14:o=i.response.body,r=o.red_point_tips,a=o.guide_tips,l=o.version,r=r||[],a=a||[],s=this.filterRedPoints(r),c=this.filterFuncGuide(a,l),(s.length>0||c.length>0||l)&&this.setState({visible:!0,funcGuides:c,redPoints:s,versionInfo:l});case 20:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"checkLanguage",value:function(){if(window.__CONFIG__.product!==ln.default.dingtalk)return!0;var e=Object(b.getQuery)("lang");if(e&&e!==window.langName){var t="lang_mismatching_"+e;if(!localStorage.getItem(t))return window.Toast.info(window.__CONFIG__.checkLanguageToastMap[e]||window.__CONFIG__.checkLanguageToastMap["en-US"]),localStorage.setItem(t,"1"),!1}return!0}},{key:"filterRedPoints",value:function(e){var t=Object.values(cn.a.pc);return e.filter((function(e){return!!t.includes(e.name)||(console.error("不支持的红点："+e.name),!1)}))}},{key:"filterFuncGuide",value:function(e,t){var n=Object.values(sn.a.pc);return e=e.filter((function(e){return!!n.includes(e.name)||(console.error("不支持的功能引导："+e.name),!1)})),t?[]:e}},{key:"handleClose",value:function(){this.setState({visible:!1})}},{key:"handleCloseSaveAs",value:function(){this.setState({specialFileSaveAs:!1,visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.file,i=this.state,o=i.visible,r=i.funcGuides,a=i.redPoints,l=i.versionInfo,s=i.specialFileSaveAs;return!!o&&(s?Object(T.default)(hn.a,{file:n,onClose:this.handleCloseSaveAs}):Object(T.default)(fn.a,{dispatch:t,funcGuides:r,redPoints:a,versionInfo:l,onClose:this.handleClose}))}}]),t}(p.PureComponent),vn=n(11555),bn=n.n(vn),gn=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.isAppReady,i=e.contentReadonly,o=e.connected,r=e.file;if(!n)return!1;var a=i||!r.user_acl.update;return h.a.createElement(h.a.Fragment,null,!a&&h.a.createElement(on,{dispatch:t,connected:o}),!r.user_acl.isDefault&&window.officeType!==v.default.outline&&h.a.createElement(mn,{dispatch:t,file:r}),K.isPad&&K.isInWeixin&&h.a.createElement(bn.a,null),h.a.createElement(an.a,null))}}]),t}(p.PureComponent),yn=Object(m.connect)((function(e){var t=e.public;return{file:t.file,isAppReady:t.network.isAppReady,connected:t.network.connected}}))(gn),wn=n(7838),_n=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleWindowResize=function(){var e=n.state.isOpenSideApp;Object(wn.onResize)(n.refDiv.current,n.handleResize,e)},n.adjustUI=function(){if(n.refMiddle.current){var e=n.refMiddle.current.getWidth(),t=e-n.refDiv.current.getBoundingClientRect().width;if(Math.abs(t)<3)setTimeout(n.adjustUI,1e3);else{var i="calc(50% - "+e/2+"px)";n.state.style&&n.state.style.width===i||n.setState({style:{width:i},showMiddle:!0})}}},n.handleResize=function(e){var t=e.leftStyle,i=e.rightStyle,o=e.middleStyle;n.updateHeaderWidthLimit(),n.setState({leftStyle:t,rightStyle:i,middleStyle:o,showRight:!0})},n.handleHeaderEvents=function(e){var t=e.detail,i=t.action,o=t.data;switch(i){case"OPEN_SIDE_APP":n.setState({isOpenSideApp:o.OPEN_SIDE_APP,sideBarShowTitle:o.SIDE_BAR_SHOW_TITLE,sideBarHideTitle:o.SIDE_BAR_HIDE_TITLE},(function(){n.handleWindowResize(),Object(wn.setLeftPadding)(o.OPEN_SIDE_APP)}));break;default:return}},n.refDiv=h.a.createRef(),n.refMiddle=h.a.createRef(),n.state={contentReadonly:!1,leftStyle:null,rightStyle:null,middleStyle:null,isHistoryPlay:Object(b.hasQuery)("review"),showMiddle:!1,isNarrowMode:!1,showRight:!0,isOpenSideApp:!1,sideBarShowTitle:"",sideBarHideTitle:"",showEleConfig:{showCloudText:!0,showRightEditBtn:!0}},n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.openSuccess&&this.setContentReadonly(),this.adjustUI(),Object(wn.observerContainer)(this.refDiv.current,this.handleResize),window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize(),window.addEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"componentDidUpdate",value:function(e,t){this.props.openSuccess&&!e.openSuccess&&this.setContentReadonly(),this.props.file.user_acl.update&&!e.file.user_acl.update&&(this.adjustUI(),this.handleWindowResize())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener(M.default.names.HEADER_EVENT_NOTIFY,this.handleHeaderEvents)}},{key:"setContentReadonly",value:function(){var e=window.APP.isReadOnly();this.setState({contentReadonly:e})}},{key:"updateHeaderWidthLimit",value:function(){if(this.refDiv.current){var e=this.refDiv.current.offsetWidth,t=!0,n=!0;e<980&&(t=!1),e<570&&(n=!1);var i={showCloudText:t,showRightEditBtn:n};this.setState({showEleConfig:o()({},i)})}}},{key:"render",value:function(){var e=this.props.isAppReady,t=this.state,n=t.leftStyle,i=t.middleStyle,o=t.rightStyle,r=t.contentReadonly,a=t.isHistoryPlay,l=t.isNarrowMode,s=t.showRight,c=t.isOpenSideApp,u=t.sideBarShowTitle,d=t.sideBarHideTitle,f=t.showEleConfig,p=window.officeType,m=window.fileInfo.user_acl.isDefault,b=p===v.default.dbsheet||p===v.default.whiteboard,g=h.a.classNames({"component-header":1,"file-opening":!e,disabled:a,"white-bg":b}),y=window.officeType===v.default.outline;return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"common-header"},h.a.createElement("div",{className:g,ref:this.refDiv,onClick:G.stopBubble,id:"wo-common-header"},h.a.createElement(Oe,{isOpenSideApp:c,sideBarShowTitle:u,sideBarHideTitle:d,whiteBg:b,style:n,contentReadonly:r,showEleConfig:f}),!y&&h.a.createElement(We,{ref:this.refMiddle,visible:!!i,style:i,onImgLoad:this.adjustUI}),!m&&s&&h.a.createElement(Qt,{style:o,contentReadonly:r,isNarrowMode:l,showEleConfig:f})),h.a.createElement(yn,{contentReadonly:r})))}}]),t}(p.PureComponent);t.default=Object(m.connect)((function(e){var t=e.public;return{file:t.file,openSuccess:t.network.openSuccess,isAppReady:t.network.isAppReady}}))(_n)},1723:function(e,t,n){"use strict";n.r(t);n(2314);var i=n(167),o=n(1),r=n.n(o),a=n(2),l=n.n(a),s=n(22),c=n.n(s),u=n(23),d=n.n(u),f=n(238),p=n.n(f),h=n(259),m=n.n(h),v=n(321),b=n(248),g=n(1491),y=n(1326),w=n(380),_=function(e){function t(){return r()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),l()(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.iconContent,o=e.disabled,r=e.altForceDirection,a=e.iconType,l=e.visible,s=e.onVisibleChange,c=e.size,u=void 0===c?y.Size.middle:c,d=e.icon,f=e.autoClose,h=e.showBorder,m=this.getClassName();switch(h&&(m+=" show-border"),u){case y.Size.small:m+=" button-s";break;case y.Size.middle:case y.Size.medium:m+=" button-m";break;case y.Size.large:m+=" button-l";break;case y.Size.xLarge:m+=" button-x"}return p.a.createElement(v.default,{visible:l,panel:n,disabled:o,onVisibleChange:s,autoClose:f},p.a.createElement("div",{ref:this.refWrap,id:t,className:m,role:"combobox","alt-force-direction":r},p.a.createElement("div",{className:"left-btn"},d&&d,!d&&a&&p.a.createElement(b.default,{type:a}),i),p.a.createElement("div",{className:"right-btn"},p.a.createElement(w.default,{size:12}))))}}]),t}(g.a);_.propTypes={id:m.a.string,visible:m.a.bool.isRequired,className:m.a.string,disabled:m.a.bool,title:m.a.oneOfType([m.a.object,m.a.string]),iconType:m.a.string,iconContent:m.a.oneOfType([m.a.object,m.a.string]),onIconClick:m.a.func,iconSelected:m.a.bool,altForceDirection:m.a.string,onVisibleChange:m.a.func.isRequired,size:m.a.string,type:m.a.string,autoClose:m.a.bool,showBorder:m.a.bool},_.defaultProps={autoClose:!0,showBorder:!0};var E=_,C=i.isPad?E:y.default;t.default=C},1817:function(e,t,n){},1818:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("logo_ai",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none"},o.a.createElement("g",{clipPath:"url(#clip0_10734_28119)"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37255 5.37258 -3.05176e-05 12 -3.05176e-05C18.6274 -3.05176e-05 24 5.37255 24 12ZM22.7812 12C22.7812 17.9543 17.9543 22.7812 12 22.7812C6.04568 22.7812 1.21875 17.9543 1.21875 12C1.21875 6.04565 6.04568 1.21872 12 1.21872C17.9543 1.21872 22.7812 6.04565 22.7812 12Z",fill:"url(#paint0_linear_10734_28119)"}),o.a.createElement("path",{d:"M10.0861 5.22927C10.4492 4.53709 11.1861 4.06348 12.0361 4.06348C12.9751 4.06348 13.7806 4.64017 14.0921 5.45232C15.4309 8.29382 14.5641 12.0751 11.9409 14.6984C9.4738 17.1655 6.29268 17.7918 3.61963 16.4641L10.0861 5.22927Z",fill:"url(#paint1_linear_10734_28119)"}),o.a.createElement("path",{d:"M13.9974 5.22932C13.6343 4.53713 12.8974 4.06352 12.0474 4.06352C11.1084 4.06352 10.3029 4.64022 9.99137 5.45236C8.65257 8.29387 9.51935 12.0752 12.1426 14.6985C14.6097 17.1655 17.7908 17.7918 20.4639 16.4642L13.9974 5.22932Z",fill:"url(#paint2_linear_10734_28119)"}),o.a.createElement("path",{d:"M12.0418 4.06348C12.9782 4.06593 13.781 4.6419 14.0918 5.45231C15.4132 8.25694 14.586 11.9771 12.0418 14.5957C9.49767 11.9771 8.67039 8.25694 9.99181 5.45231C10.3027 4.6419 11.1054 4.06593 12.0418 4.06348Z",fill:"url(#paint3_linear_10734_28119)"})),o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"paint0_linear_10734_28119",x1:"23.4437",y1:"9.93374",x2:"-1.3881e-07",y2:"13.0331",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#E83FEC"}),o.a.createElement("stop",{offset:"1",stopColor:"#51B6FF"})),o.a.createElement("linearGradient",{id:"paint1_linear_10734_28119",x1:"11.0455",y1:"5.91278",x2:"4.7809",y2:"17.3361",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#1170FF"}),o.a.createElement("stop",{offset:"1",stopColor:"#76E5FF"})),o.a.createElement("linearGradient",{id:"paint2_linear_10734_28119",x1:"15.7814",y1:"6.92154",x2:"10.7504",y2:"15.9923",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#DE09F8"}),o.a.createElement("stop",{offset:"1",stopColor:"#FFAAA5"})),o.a.createElement("linearGradient",{id:"paint3_linear_10734_28119",x1:"12.0418",y1:"4.9878",x2:"12.0418",y2:"14.5957",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#0009D9"}),o.a.createElement("stop",{offset:"1",stopColor:"#4642F5"})),o.a.createElement("clipPath",{id:"clip0_10734_28119"},o.a.createElement("rect",{width:"24",height:"24",fill:"white"}))))}))},1914:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geneLocalIndexInfo=t.getQueryIndexInfo=void 0;var i=n(5),o=n(2290),r=n(14),a=i.__importDefault(n(82));t.getQueryIndexInfo=function(){var e=(0,r.getQuery)("pageIdxInfo");if(e)try{return(0,o.convertIndexInfo)((0,o.decodeIndexInfo)(e))}catch(e){}return null},t.geneLocalIndexInfo=function(){return i.__awaiter(this,void 0,Promise,(function(){var e,t;return i.__generator(this,(function(n){switch(n.label){case 0:return e=window.officeType,t=null,e!==a.default.writer?[3,2]:[4,(0,o.geneWPSIndexInfo)()];case 1:return t=n.sent(),[3,8];case 2:return e!==a.default.spreadsheet?[3,4]:[4,(0,o.geneETIndexInfo)()];case 3:return t=n.sent(),[3,8];case 4:return e!==a.default.presentation?[3,6]:[4,(0,o.geneWPPIndexInfo)()];case 5:return t=n.sent(),[3,8];case 6:return e!==a.default.pdf?[3,8]:[4,(0,o.genePDFIndexInfo)()];case 7:t=n.sent(),n.label=8;case 8:return t?[2,(0,o.encodeIndexInfo)(t)]:[2,null]}}))}))}},2192:function(e,t,n){"use strict";var i=n(238),o=n.n(i),r=n(239);t.a=Object(r.a)("menu",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M2.5 3H13.5M2.5 8H13.5M2.5 13H13.5",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.genePDFIndexInfo=t.geneWPPIndexInfo=t.geneETIndexInfo=t.geneWPSIndexInfo=t.convertIndexInfo=t.decodeIndexInfo=t.encodeIndexInfo=void 0;var i=n(5),o=i.__importDefault(n(452));function r(e){return Number(e)||0}t.encodeIndexInfo=function(e){return encodeURIComponent(o.default.encode(JSON.stringify(e)))},t.decodeIndexInfo=function(e){return JSON.parse(o.default.decode(decodeURIComponent(e)))},t.convertIndexInfo=function(e){var t=e.pageIndex,n=e.cell,i=e.cursor,o={pageIndex:r(t)};if(n){var a=n.rowFrom,l=n.rowTo,s=n.colFrom,c=n.colTo;o.cell={rowFrom:r(a),rowTo:r(l),colFrom:r(s),colTo:r(c)}}if(i){var u=i.startGcp,d=i.endGcp;o.cursor={startGcp:r(u),endGcp:r(d)}}return o},t.geneWPSIndexInfo=function(){return i.__awaiter(this,void 0,Promise,(function(){var e,t,n,o,r;return i.__generator(this,(function(i){switch(i.label){case 0:e=window.WPSOpenApi.Application,i.label=1;case 1:return i.trys.push([1,6,,7]),[4,e.ActiveDocument.ActiveWindow.Selection];case 2:return[4,(t=i.sent()).Information(e.Enum.WdInformation.wdActiveEndPageNumber)];case 3:return n=i.sent(),[4,t.Range.Start];case 4:return o=i.sent(),[4,t.Range.End];case 5:return r=i.sent(),[2,{pageIndex:n,cursor:{startGcp:o,endGcp:r}}];case 6:return i.sent(),[2,null];case 7:return[2]}}))}))},t.geneETIndexInfo=function(){return i.__awaiter(this,void 0,Promise,(function(){var e,t,n,o,r,a,l;return i.__generator(this,(function(i){switch(i.label){case 0:e=window.WPSOpenApi.Application,i.label=1;case 1:return i.trys.push([1,8,,9]),[4,e.ActiveWorkbook.ActiveSheet.Index];case 2:return t=i.sent(),[4,e.Selection];case 3:return[4,(n=i.sent()).Row];case 4:return o=i.sent(),[4,n.RowEnd];case 5:return r=i.sent(),[4,n.Column];case 6:return a=i.sent(),[4,n.ColumnEnd];case 7:return l=i.sent(),[2,{pageIndex:t,cell:{rowFrom:o,rowTo:r,colFrom:a,colTo:l}}];case 8:return i.sent(),[2,null];case 9:return[2]}}))}))},t.geneWPPIndexInfo=function(){return i.__awaiter(this,void 0,Promise,(function(){var e,t;return i.__generator(this,(function(n){switch(n.label){case 0:e=window.WPSOpenApi.Application,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.ActivePresentation.SlideShowWindow.View.Slide.SlideIndex];case 2:return t=n.sent(),[2,{pageIndex:t}];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},t.genePDFIndexInfo=function(){return i.__awaiter(this,void 0,Promise,(function(){var e,t;return i.__generator(this,(function(n){switch(n.label){case 0:e=window.WPSOpenApi.Application,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.ActivePDF.CurrentPage];case 2:return t=n.sent(),[2,{pageIndex:t}];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))}},2313:function(e,t,n){"use strict";var i=n(13),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(145),f=n.n(d),p=n(23),h=n.n(p),m=n(238),v=n.n(m),b=n(259),g=n.n(b),y=n(1489),w=n(321),_=n(580),E=n(385),C=n(706),S=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelect=function(e){e.action(),n.setState({panelVisible:!1})},n.handleVisibleChange=function(e){n.setState({panelVisible:e})},n.state=o()({},n.state,{panelItems:[],panelVisible:!1,selectable:e.selectable,isAuto:e.isAuto}),n}return h()(t,e),s()(t,[{key:"renderItems",value:function(){var e=this;return this.state.panelItems.map((function(t){return v.a.createElement(E.default,{selectable:!1,className:t.disabled?"disabled":"",key:t.key,value:t,selected:t.selected,onClick:e.handleSelect},!!t.icon&&v.a.createElement("div",{className:"icons icons-16",style:Object(C.getIconStyle)(t.icon)}),t.caption)}))}},{key:"getClassName",value:function(){var e=f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this),n=this.state.panelVisible;return v.a.classNames({dropdown:1,selected:n},e)}},{key:"render",value:function(){var e=this.state,t=e.panelVisible,n=e.selectable,i=e.isAuto,o=this.renderItems(),r=v.a.createElement(_.default,{selectable:n,isAuto:i},o);return v.a.createElement(w.default,{panel:r,visible:t,onVisibleChange:this.handleVisibleChange},this.renderBtn(!0,t))}},{key:"panelItems",set:function(e){this.setState({panelItems:e})},get:function(){return this.state.panelItems}},{key:"selectable",set:function(e){this.setState({selectable:e})},get:function(){return this.state.selectable}},{key:"isAuto",set:function(e){this.setState({isAuto:e})},get:function(){return this.state.isAuto}}]),t}(y.a);S.propTypes={id:g.a.oneOfType([g.a.string,g.a.number]).isRequired,icon:g.a.string,caption:g.a.string,tooltip:g.a.string},t.a=S},2314:function(e,t,n){},2315:function(e,t,n){"use strict";t.a={pc:{wechatTips:"wechat-tips",summaryConstruct:"summary_construct",webMode:"web_mode",inviteCooper:"invite_cooper"},pcClick:{summaryGuideAssist:"frontend_summary_guide_assist"},mobile:{},mobileClick:{guideCard:"frontend_guide-card"}}},239:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(238),o=n.n(i),r=["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","className","spin"];function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(){return"icon-"+(4294967296*(1+Math.random())|0).toString(16).substring(1)}var d=Object(i.createContext)({size:"1em",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"miter",rtl:!1,theme:"outline",colors:{outline:{fill:"#333333",background:"transparent"}},prefix:"kd"});d.Provider;function f(e,t,n){return function(a){var s=a.size,f=a.strokeWidth,p=a.strokeLinecap,h=a.strokeLinejoin,m=a.theme,v=a.fill,b=a.className,g=a.spin,y=c(a,r),w=Object(i.useContext)(d),_=function(e,t,n){var i="";return t.fill&&(t.fill,i=t.fill),t.theme||n.theme,{size:t.size||n.size,strokeWidth:t.strokeWidth||n.strokeWidth,strokeLinecap:t.strokeLinecap||n.strokeLinecap,strokeLinejoin:t.strokeLinejoin||n.strokeLinejoin,colors:i,id:e}}(Object(i.useMemo)(u,[]),{size:s,strokeWidth:f,strokeLinecap:p,strokeLinejoin:h,theme:m,fill:v},w),E=["kd-icon"];return E.push("kd-icon-"+e),t&&w.rtl&&E.push("kd-icon-rtl"),g&&E.push("kd-icon-spin"),b&&E.push(b),o.a.createElement("i",l(l({},y),{},{className:E.join(" "),style:{lineHeight:0}}),n(_))}}},2519:function(e,t,n){"use strict";var i=n(238),o=n.n(i),r=n(239);t.a=Object(r.a)("sidebar_right",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M8.24309 13.751H2.9455C2.28275 13.751 1.7455 13.2138 1.7455 12.551L1.74551 3.44805C1.74551 2.78531 2.28277 2.24805 2.94551 2.24805H8.24311M8.24309 13.751H13.048C13.7108 13.751 14.248 13.2138 14.248 12.551L14.248 3.44805C14.248 2.78531 13.7108 2.24805 13.048 2.24805H8.24311M8.24309 13.751L8.24311 2.24805M12.248 5.25142H10.248M12.248 7.99985H10.248M12.248 10.748H10.248",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2520:function(e,t,n){"use strict";var i=n(238),o=n.n(i),r=n(239);t.a=Object(r.a)("home",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M13.6576 5.04955L8.90762 1.43955C8.37121 1.03187 7.62879 1.03187 7.09238 1.43955L2.34238 5.04955C1.96915 5.33319 1.75 5.77501 1.75 6.24379V13.9498C1.75 14.1154 1.88431 14.2498 2.05 14.2498H5.96698C6.12329 14.2498 6.25 14.123 6.25 13.9667V10.9998C6.25 10.0333 7.0335 9.24975 8 9.24975C8.9665 9.24975 9.75 10.0333 9.75 10.9998V13.9667C9.75 14.123 9.87671 14.2498 10.033 14.2498H13.95C14.1157 14.2498 14.25 14.1154 14.25 13.9498V6.24379C14.25 5.77501 14.0308 5.33319 13.6576 5.04955Z",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},258:function(e,t,n){var i;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var r=typeof i;if("string"===r||"number"===r)e.push(i);else if(Array.isArray(i)){if(i.length){var a=o.apply(null,i);a&&e.push(a)}}else if("object"===r){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var l in i)n.call(i,l)&&i[l]&&e.push(l)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(i=function(){return o}.apply(t,[]))||(e.exports=i)}()},2715:function(e,t,n){},2716:function(e,t,n){},2717:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(272),s=function(){function e(){var t=this;o()(this,e),this.leftItems=[],this.setLeftItems=function(e,n){var i=0;t.leftItems=[];for(var o=0;o<e.length&&(i+=e[o].offsetWidth,t.leftItems.push(e[o]),!(i>=n));o++);}}return a()(e,[{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t.offsetWidth}),0)}},{key:"findElementIndex",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].contains(t))return n;return-1}},{key:"adjustOffsetItems",value:function(e,t,n,i,o,r){var a=this;if(t)this.leftItems.pop();else if(n)this.leftItems=r.filter((function(e,t){return t<a.leftItems.length+1}));else{for(;this.leftItems.length>0;){if(!(o-this.sum(this.leftItems)+this.leftItems[this.leftItems.length-1].offsetWidth<=i))break;this.leftItems.pop()}if(e){var l=e;e=null;var s=this.findElementIndex(this.leftItems,l);if(-1===s){for(var c=0,u=this.leftItems.length;u<r.length&&(c+=r[u].offsetWidth)<=i;u++)if(r[u].contains(l))return;s=this.findElementIndex(r,l);var d=r.filter((function(e,t){return t<=s})),f=this.sum(d);this.leftItems=[];for(var p=0;p<s;p++)if(this.leftItems.push(r[p]),(f-=r[p].offsetWidth)<=i)return}else this.leftItems=this.leftItems.filter((function(e,t){return t<s}))}}}},{key:"getBtnStatus",value:function(e){var t=e.enabledLeftBtn,n=e.enabledRightBtn,i=e.isLeft,o=e.isRight,r=e.getItemsWidth;if(window.rightToLeft){var a=i;i=o,o=a}var s=r(),c=s.wrapWidth,u=s.allItemWidth,d=s.items,f=s.itemsWrap,p=s.locationElement,h=s.scrollLeft,m=s.offsetWidth;if(c>=u)return this.leftItems=[],{showBtn:!1,enabledLeftBtn:t,enabledRightBtn:n};this.adjustOffsetItems(p,i,o,c,u,d);var v=this.sum(this.leftItems);return t=h>0,n=u-h>m+1,window.rightToLeft&&(t=u+h>m+1,n=h<0,v=-v),(i||o||p)&&Object(l.runScrollLeft)({element:f,start:h,end:v,keepEnd:!0}),{showBtn:!0,enabledLeftBtn:t,enabledRightBtn:n}}}]),e}();t.default=s},272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runScrollLeft=t.runOpacity=t.runTranslateY=t.runTranslateX=t.runRotate=t.runHeight=t.runStyle=t.run=t.StyleNames=t.defaultTransition=t.IRunOption=void 0;var i=n(5),o=n(430);function r(e){e.start,e.end,e.element}Object.defineProperty(t,"IRunOption",{enumerable:!0,get:function(){return o.IRunOption}}),Object.defineProperty(t,"StyleNames",{enumerable:!0,get:function(){return o.StyleNames}});function a(e){var t=e.setValue,n=e.start,i=e.end,o=e.keepEnd,a=e.onDone;a=a||Function.prototype,r(e);var l=!1,s=null,c=function(){window.cancelAnimationFrame(s),l=!0};if(n===i)return a(),c;var u=window.performance.now(),d=u,f=n,p=0;return t(f),s=window.requestAnimationFrame((function e(){l?a():(f=function(e,t,n,i,o){var r=window.performance.now(),a=(180-r+e)/Math.max(15,r-t);return a=Math.ceil(a),a=Math.min(10-n,a),i=(i+=(o-i)/(a=Math.max(4-n,a,1)))>o?Math.max(o,i):Math.min(o,i)}(u,d,p++,f,i),d=window.performance.now(),f===i&&(l=!0,f=o?i:""),t(f),window.requestAnimationFrame(e))})),c}t.defaultTransition="all 0.2s ease-in-out";var l=null,s=[];function c(e){return e.useFrame?a(e):function(e){var t=e.element,n=e.setValue,i=e.start,o=e.end,a=e.keepEnd,c=e.onDone,u=e.transition;if(c=c||Function.prototype,u=u||"all 0.2s ease-in-out",r(e),i.toFixed(2)===o.toFixed(2))return c(),null;n(i);var d=null;clearTimeout(l),s.push((function(){t.style.transition=u,n(o);var e=u.split(" ")[1],i=e.includes("ms")?parseFloat(e):1e3*parseFloat(e);d=setTimeout((function(){p()}),i+=100)})),l=setTimeout((function(){for(;s.length;){s.shift()()}}),10);var f=!1,p=function e(){f||(f=!0,t.removeEventListener("transitionend",e),t.style.transition="",n(a?o:""),c(),clearTimeout(d),d=null)};return t.addEventListener("transitionend",p),p}(e)}function u(e,t){return c(i.__assign(i.__assign({},t),{setValue:function(n){var i=e,r="".concat(n,"px");switch(e){case o.StyleNames.translateX:case o.StyleNames.translateY:n&&window.rightToLeft&&(n=-n),i="transform",r="".concat(e,"(").concat(n,"%)");break;case o.StyleNames.rotate:i="transform",r="rotate(".concat(n,"deg)");break;case o.StyleNames.opacity:r=n}t.element.style[i]=""===n?"":r}}))}t.run=c,t.runStyle=u,t.runHeight=function(e){return u(o.StyleNames.height,e)},t.runTranslateX=function(e){return u(o.StyleNames.translateX,e)},t.runTranslateY=function(e){return u(o.StyleNames.translateY,e)},t.runRotate=function(e){return u(o.StyleNames.rotate,e)},t.runOpacity=function(e){return u(o.StyleNames.opacity,e)},t.runScrollLeft=function(e){return c(i.__assign(i.__assign({},e),{useFrame:!0,setValue:function(t){e.element.scrollLeft=t}}))}},2940:function(e,t,n){"use strict";n.r(t);var i=n(13),o=n.n(i),r=n(8),a=n.n(r),l=n(1),s=n.n(l),c=n(2),u=n.n(c),d=n(22),f=n.n(d),p=n(23),h=n.n(p),m=(n(2716),n(238)),v=n.n(m),b=n(259),g=n.n(b),y=function(e){function t(){return s()(this,t),f()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h()(t,e),u()(t,[{key:"render",value:function(){return this.renderBtn()}}]),t}(n(1489).a);y.propTypes={id:g.a.oneOfType([g.a.string,g.a.number]).isRequired,icon:g.a.string,caption:g.a.string,tooltip:g.a.string};var w=y,_=n(2313),E=n(706),C=function(e){function t(){var e,n,i,o;s()(this,t);for(var r=arguments.length,a=Array(r),l=0;l<r;l++)a[l]=arguments[l];return n=i=f()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),i.state={items:[]},o=n,f()(i,o)}return h()(t,e),u()(t,[{key:"add",value:function(e){var t=this,n=e.id,i=e.controlType,o=void 0===i?E.controlTypes.button:i,r=e.icon,l=void 0===r?null:r,s=e.caption,c=void 0===s?null:s,u=e.tooltip,d=void 0===u?null:u,f=e.selectable,p=void 0!==f&&f,h=e.isAuto,m=void 0!==h&&h;if(this.state.items.find((function(e){return e.id===n})))throw new Error("该控件ID已存在："+n);var v=[].concat(a()(this.state.items));return v.push({id:n,icon:l,caption:c,tooltip:d,controlType:o,selectable:p,isAuto:m}),new Promise((function(e){t.setState({items:v},(function(){return e(t._refMap[n].el)}))}))}},{key:"remove",value:function(e){var t=this.state.items.filter((function(t){return t.id!==e}));return this.setState({items:t}),!0}},{key:"_ref",value:function(e){var t=this;return this._refMap=this._refMap||{},this._refMap[e]||(this._refMap[e]={cb:function(n){return t._refMap[e].el=n}}),this._refMap[e]}},{key:"render",value:function(){var e=this;return this.state.items.map((function(t){return v.a.createElement("div",{key:t.id},t.controlType===E.controlTypes.dropdown&&v.a.createElement(_.a,o()({ref:e._ref(t.id).cb},t)),t.controlType===E.controlTypes.button&&v.a.createElement(w,o()({ref:e._ref(t.id).cb},t)))}))}}]),t}(m.PureComponent);t.default=C},2941:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var i=n(238),o=n.n(i),r=n(425),a=Object(r.a)("arrow-right",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none"},o.a.createElement("path",{d:"M6 3.24991L10.5 8L6 12.7499",stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,vectorEffect:"non-scaling-stroke"}))})),l=n(404),s=n(455),c=n(262),u=n(824),d=n(705),f=n(2976);function p(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,b(i.key),i)}}function b(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==h(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_(e);if(t){var o=_(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return w(this,n)}}function w(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(s,e);var t,n,i,r=y(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=r.call(this,e)).prefixCls="kd-menu-item",t.refMenuItem=o.a.createRef(),t.openSubMenu=function(){t.state.open||t.setState({open:!0},(function(){var e,n;null===(n=(e=t.props).onOpenChange)||void 0===n||n.call(e,!0)}))},t.closeSubMenu=function(){t.setState({open:!1},(function(){var e,n;null===(n=(e=t.props).onOpenChange)||void 0===n||n.call(e,!1)}))},t.renderSubMenu=function(){var e=t.props.children,n=t.context,i=(n.refMenu,E(n,["refMenu"]));return o.a.createElement(f.a,m({className:"kd-menu-submenu"},i),e)},t.handleVisibleChange=function(e){var n,i;t.setState({open:e}),null===(i=(n=t.props).onOpenChange)||void 0===i||i.call(n,e)},t.state={open:!1},t}return t=s,(n=[{key:"componentDidMount",value:function(){this.props.open&&this.openSubMenu()}},{key:"getElement",value:function(){return this.refMenuItem.current}},{key:"render",value:function(){var e,t=this.props,n=t.className,i=t.panelClassName,r=t.label,s=t.icon,f=t.tabIndex,v=void 0===f?-1:f,b=t.disabled,g=(t.children,E(t,["className","panelClassName","label","icon","tabIndex","disabled","children"])),y=this.state.open,w=this.context.triggerSubMenuAction,_=h(r),C=Object(c.a)(this.prefixCls,n,"kd-menu-submenu-item",(p(e={},"".concat(this.prefixCls,"-open"),y),p(e,"".concat(this.prefixCls,"-disabled"),b),p(e,"only-text","string"===_||"number"===_),e)),S=Object(l.a)(g,["open","onMouseLeave","onOpenChange"]);return o.a.createElement(u.a,{panel:this.renderSubMenu(),className:i,visible:y,visibleArrow:!1,placement:d.a["right-start"],trigger:w,onVisibleChange:this.handleVisibleChange,delayShow:0,offset:{y:-13}},o.a.createElement("li",m({className:C,role:"menuitem",ref:this.refMenuItem,tabIndex:v},S),o.a.isValidElement(s)&&o.a.cloneElement(s,{className:"".concat(this.prefixCls,"-icon")}),"string"==typeof r?o.a.createElement("span",{className:"".concat(this.prefixCls,"-content")},r):r,o.a.createElement(a,{className:"".concat(this.prefixCls,"-suffixicon ").concat(this.prefixCls,"-arrow"),size:"16",strokeWidth:1.5})))}}])&&v(t.prototype,n),i&&v(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.Component);C.defaultProps={},C.contextType=s.a},295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.size16=t.iconTypes=void 0;var i=n(5);n(548);var o=i.__importStar(n(238)),r=i.__importDefault(n(246)),a=n(167),l=i.__importStar(n(284));t.iconTypes=l.default,Object.defineProperty(t,"size16",{enumerable:!0,get:function(){return l.size16}});var s=i.__importDefault(n(459)),c=i.__importDefault(n(252)),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isChineseInputting=!1,t.handleInputChange=function(e){t.props.onChange&&t.props.onChange(e,t.getInput().value,t.isChineseInputting)},t.handleCompositionStart=function(){t.isChineseInputting=!0},t.handleCompositionEnd=function(e){t.isChineseInputting=!1,t.handleInputChange(e)},t.handleKeyDown=function(e){var n=t.props,i=n.onEnter,o=n.onEsc,a=n.onKeyDown;a&&a(e);var l=r.default.getKey(e);i&&l===r.default.Keys.Enter?i():o&&l===r.default.Keys.Esc&&o()},t.refInput=o.default.createRef(),t}return i.__extends(t,e),t.prototype.getInput=function(){var e;return null===(e=this.refInput.current)||void 0===e?void 0:e.getElement()},t.prototype.getValue=function(){var e;return null===(e=this.getInput())||void 0===e?void 0:e.value},t.prototype.focus=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var n=this.getInput();if(n){n.focus();var i=n.value;e&&i.length>0?n.select():t&&(n.value=i+" ",n.value=i)}},t.prototype.componentDidMount=function(){var e,t;this.props.autoFocus&&!a.isTouchScreen&&(null===(e=this.refInput.current)||void 0===e||e.focus()),this.props.autoSelect&&!a.isTouchScreen&&(null===(t=this.refInput.current)||void 0===t||t.select())},t.prototype.componentWillUnmount=function(){this.getInput().blur()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.whiteTheme,r=e.iconType,a=e.prefixIcon,l=e.suffixIcon,u=e.suffixIconType,d=e.errorText,f=e.errorToolTip,p=e.onSuffixIconClick,h=e.onIconClick,m=i.__rest(e,["className","whiteTheme","iconType","prefixIcon","suffixIcon","suffixIconType","errorText","errorToolTip","onSuffixIconClick","onIconClick"]);if(!m.hasOwnProperty("value")||null!==m.value&&void 0!==m.value||(m.value=""),!a&&r){var v=r.split(" "),b=v[0];g=(g=v[1]).toLowerCase(),a="icons icons-".concat(b," icons-").concat(b,"-").concat(g)}if(!l&&u){var g,y=u.split(" ");b=y[0];g=(g=y[1]).toLowerCase(),l="icons icons-".concat(b," icons-").concat(b,"-").concat(g)}d&&(m.status="error",m.helpText=d),delete m.autoFocus,delete m.onEnter,delete m.onEsc,delete m.autoSelect;var w=o.default.classNames({"wo-input":1,"input-white":n},t);return o.default.createElement(c.default,{title:f,visible:!!f},o.default.createElement("div",{className:w},o.default.createElement(s.default,i.__assign({ref:this.refInput,type:"text",suffixIcon:l,prefixIcon:a},m,{onPrefixIconClick:h,onSuffixIconClick:p,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd}))))},t.defaultProps={maxLength:1024,size:"medium"},t}(o.PureComponent);t.default=u},2976:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n(238),o=n.n(i),r=(n(4147),n(262)),a=n(2941),l=n(404),s=n(455),c=n(3122);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function f(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function m(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(u,e);var t,n,i,a=b(u);function u(){var e;return p(this,u),(e=a.apply(this,arguments)).prefixCls="kd-menu",e.refMenu=o.a.createRef(),e.state={prevItem:null},e.getHoverItem=function(){var t;return null===(t=e.refMenu.current)||void 0===t?void 0:t.getElementsByClassName("hover")[0]},e.handleMouseMove=function(){var t,n,i=e.refMenu.current,o=e.getHoverItem();o&&o!==e.prevItem&&(e.prevItem=o,null===(n=(t=e.props).onItemHover)||void 0===n||n.call(t,o,!0,i))},e.getElement=function(){return e.refMenu.current},e}return t=u,(n=[{key:"render",value:function(){var e,t=this.props,n=t.className,i=t.selectable,a=t.checkable,u=t.tabIndex,p=t.triggerSubMenuAction,h=t.children,m=w(t,["className","selectable","checkable","tabIndex","triggerSubMenuAction","children"]),v=Object(l.a)(m,[]),b=Object(r.a)(this.prefixCls,n,(f(e={},"".concat(this.prefixCls,"-checkable"),a),f(e,"".concat(this.prefixCls,"-selectable"),i),e));return o.a.createElement(s.a.Provider,{value:{refMenu:this.refMenu,selectable:i,checkable:a,triggerSubMenuAction:p}},o.a.createElement("div",d({},v,{ref:this.refMenu,className:b,role:"menu",tabIndex:u,onMouseMove:this.handleMouseMove}),o.a.createElement(c.a,null,o.a.createElement("ul",null,h))))}}])&&h(t.prototype,n),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component);_.SubMenu=a.default,_.defaultProps={tabIndex:0}},2977:function(e,t,n){var i=n(4152),o=n(4153),r={float:"cssFloat"},a=n(4156);function l(e,t,n){var l=r[t];if(void 0===l&&(l=function(e){var t=o(e),n=i(t);return r[t]=r[e]=r[n]=n,n}(t)),l){if(void 0===n)return e.style[l];e.style[l]=a(l,n)}}function s(e,t){for(var n in t)t.hasOwnProperty(n)&&l(e,n,t[n])}function c(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:s(arguments[0],arguments[1]):l(arguments[0],arguments[1],arguments[2])}e.exports=c,e.exports.set=c,e.exports.get=function(e,t){return Array.isArray(t)?t.reduce((function(t,n){return t[n]=l(e,n||""),t}),{}):l(e,t||"")}},3122:function(e,t,n){"use strict";var i=n(238),o=n.n(i),r=n(4148);n(4164);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===a(r)?r:String(r)),i)}var o,r}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,i,a=d(f);function f(){var e;return s(this,f),(e=a.apply(this,arguments)).prefixCls="kd-scrollbar",e.renderTrackVertical=function(t){return o.a.createElement("div",l({},t,{className:"".concat(e.prefixCls,"-track-vertical")}))},e.renderThumbVertical=function(t){return o.a.createElement("div",l({},t,{className:"".concat(e.prefixCls,"-thumb-vertical")}))},e.renderTrackHorizontal=function(t){return o.a.createElement("div",l({},t,{className:"".concat(e.prefixCls,"-track-horizontal")}))},e.renderThumbHorizontal=function(t){return o.a.createElement("div",l({},t,{className:"".concat(e.prefixCls,"-thumb-horizontal")}))},e.renderView=function(t){return o.a.createElement("div",l({},t,{className:"".concat(e.prefixCls,"-view")}))},e}return t=f,(n=[{key:"render",value:function(){var e=this.props,t=e.children,n=h(e,["children"]);return o.a.createElement(r.Scrollbars,l({className:"kd-scrollbar-container"},n,{autoHeight:!0,renderTrackVertical:this.renderTrackVertical,renderThumbVertical:this.renderThumbVertical,renderTrackHorizontal:this.renderTrackHorizontal,renderThumbHorizontal:this.renderThumbHorizontal,renderView:this.renderView}),t)}}])&&c(t.prototype,n),i&&c(t,i),Object.defineProperty(t,"prototype",{writable:!1}),f}(i.Component);t.a=m},321:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=(n(499),n(238)),f=n.n(d),p=n(244),h=n.n(p),m=n(167),v=n(227),b=n(372),g=n(30),y=n.n(g),w=(n(500),n(240)),_=n(246),E={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"},C=n(450),S=n(13),k=n.n(S);var O=function(e,t,n,i){n=function(e){var t=k()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var o=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case E.topCenter:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body.clientHeight,a=t.left+t.width/2-i/2,l=t.top-n,s=r-t.bottom-n,c=t.top-n-o,u=t.bottom+n;return{left:a,top:l>=o?c:s>=o?u:l>=50||l>=s?c:u}}(t,n,i);break;case E.topRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:h>=o?v:p>=o||p>=50||p>=h?m:v}}(t,n,i);break;case E.topLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=c>=i?d:s>=i||s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:h>=o?v:p>=o||p>=50||p>=h?m:v}}(t,n,i);break;case E.bottomLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.left,c=t.right,u=t.left,d=t.right-i,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case E.bottomRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case E.rightBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.top,h=t.bottom,m=t.top,v=t.bottom-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case E.leftBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,f=void 0;f=c>=i?d:s>=i||s>=50||s>=c?u:d;var p=l-t.top,h=t.bottom,m=t.top,v=t.bottom-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(o.right=document.body.clientWidth-o.left-t.offsetWidth,delete o.left),o},P=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,o=n.props.triggerElement;!i||i.contains(t)||function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,o=i.pageX,r=i.pageY;return o>=n.left&&o<=n.right&&r>=n.top&&r<=n.bottom}return!1}(o,e)||C.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=f.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,this.observer=new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})),this.observer.observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){this.props.autoClose&&this.props.onClose()}},{key:"handleWindowKeyDown",value:function(e){_.getKey(e)===_.Keys.Esc&&(C.b(this.level+1)||(Object(w.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){m.isPad&&window.performance.now()-this.timestamp<=300||this.handleClose(e)}},{key:"handleWindowResize",value:function(e){var t=(e.detail||{}).isClosePanel;(void 0===t?null:t)||(m.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose())}},{key:"bindEvents",value:function(){this.observerPanel(),v.default.dispatchEvent(v.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(v.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(v.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){v.default.dispatchEvent(v.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(v.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(v.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize),this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var o=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(o>=n.top+n.height/2?"bottom":"top")}(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},y()(t,window.rightToLeft?"right":"left",0),y()(t,"top",0),t),i=this.props,o=i.placement,r=i.rect,a=i.distance,l=i.isAuto,s=i.triggerElement;if(s){var c=s.getBoundingClientRect(),u=c.top,d=c.bottom;r=Object.assign({},r,{top:u,bottom:d})}var f=O(o,e,r,a);return l&&(f=function(e,t){var n=e.left,i=e.right,o=e.top,r=t.offsetWidth,a=t.offsetHeight,l=document.body,s=l.clientWidth,c=l.clientHeight;return window.rightToLeft?(i+r+4>s&&(i=s-r-4),i=Math.max(4,i)):(n+r+4>s&&(n=s-r-4),n=Math.max(4,n)),o+a+4>c&&(o=c-a-4),o=Math.max(4,o),window.rightToLeft?{right:i,top:o}:{left:n,top:o}}(f,e)),Object.assign(n,f),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},y()(n,window.rightToLeft?"right":"left",0),y()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var o=this.props,r=o.distance,a=o.isSetHeight;if(o.forceUpdate||!this.style){this.style=this.createStyle(t),a&&(this.style.height=function(e,t,n){var i=document.body.clientHeight,o=i-e-n;return e<0&&(o=i-2*n),t.offsetHeight<o?void 0:o}(this.style.top,t,r));var l=t.getBoundingClientRect().height;Math.abs(l-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return f.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=C.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,o=e.className,r=this.state.visible,a=null;"function"==typeof t.type&&(a={isListenEvent:r});var l=f.a.cloneElement(t,a),s=this.getPanelStyle(),c=this.getAnimationOrigin(s),u=this.calcTransparentPlaceholder(c),d=C.c;return r&&(this.showAnimation&&(d+=" animation-fade-scaleY-in"),d+=" origin-"+c,o&&(d+=" "+o)),f.a.createElement("div",{ref:this.refPanel,className:d,style:s,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},u,l)}}]),t}(d.PureComponent);P.placementTypes=E,P.defaultProps={placement:E.bottomLeft,distance:0,offsetX:0,isSetHeight:!1,forceUpdate:!1,autoClose:!0};var M=P,T=n(362),I={click:"click",hover:"hover"},D=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.mustHover?n.props.trigger===I.hover:n.props.trigger===I.hover&&!m.isTouchScreen},n.refDropDown=f.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,o=n.destroyOnHide;!i&&e.visible&&!o&&void 0!==o&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||h.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,o=t.trigger;i?i(e):o===I.hover&&!m.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0]||document.getElementsByClassName("kd-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,o=n.right,r=n.top,a=n.bottom,l=e.pageX,s=e.pageY;if(l>=i&&l<=o&&s>=r&&s<=a)return}this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,o=t.visible,r=t.placement,a=t.distance,l=t.panelClass,s=t.isAuto,c=t.offsetX,u=t.autoClose;return f.a.createElement(M,{ref:this.refDropDown,isAuto:s,className:l,triggerElement:this.btnDom,rect:e,offsetX:c,visible:o,placement:r,distance:a,isSetHeight:n,onClose:this.handleContentClose,autoClose:u,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,o=e.destroyOnHide;t=t||n.props.disabled;var r=this.getRect();if(!t){var a=n.props.title;a&&i&&(a=null),n=f.a.cloneElement(n,{title:a,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return f.a.createElement(f.a.Fragment,null,n,!!r&&f.a.createElement(b.a,{visible:i,destroyOnHide:o},this.renderContent()))}}]),t}(d.PureComponent);D.placementTypes=M.placementTypes,D.DropdownPanel=T.default,D.triggerTypes=I,D.defaultProps={visible:!1,trigger:I.click,distance:4,offsetX:0,autoClose:!0};t.default=D},3351:function(e,t,n){"use strict";t.a={pc:{headerMoreBtn:"header-more-btn",versionUpdateMenu:"version-update-menu",headerHistoryBtn:"header-history-btn",headerHistoryFileUpdateMenu:"header-history-file-update-menu",etInsertTab:"commandbar-tab1",etDataTab:"commandbar-tab2",etInsertCheckbox:"et-insert-checkbox",etInsertDate:"et-insert-date",etSmartFill:"et-smart-fill"},mobile:{headerMoreBtn:"m-more-btn",versionUpdateMenu:"version-update-menu"}}},3425:function(e,t,n){"use strict";n.r(t);var i=n(2976),o=n(3890),r=n(2941),a=n(480),l=n(238),s=n.n(l),c=n(262);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===u(r)?r:String(r)),i)}var o,r}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return v(this,n)}}function v(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(r,e);var t,n,i,o=m(r);function r(){var e;return f(this,r),(e=o.apply(this,arguments)).prefixCls="kd-menu-group-title",e}return t=r,(n=[{key:"render",value:function(){var e=this.props,t=e.label,n=e.className,i=e.children,o=g(e,["label","className","children"]),r=Object(c.a)(this.prefixCls,n);return s.a.createElement(s.a.Fragment,null,s.a.createElement("li",d({className:r},o),t),i)}}])&&p(t.prototype,n),i&&p(t,i),Object.defineProperty(t,"prototype",{writable:!1}),r}(l.PureComponent);i.a.Item=o.default,i.a.SubMenu=r.default,i.a.Divider=a.default,i.a.Group=y;t.default=i.a},351:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=(n(650),n(238)),f=n.n(d),p=n(244),h=n.n(p),m=n(167),v=n(227),b=n(319),g=n(510),y=n(393),w={click:"click",hover:"hover"},_=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.trigger===w.hover&&!m.isTouchScreen},n.refDropDown=f.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,o=n.destroyOnHide;!i&&e.visible&&!o&&void 0!==o&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||h.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,o=t.trigger;i?i(e):o===w.hover&&!m.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,o=n.right,r=n.top,a=n.bottom,l=e.pageX,s=e.pageY;if(l>=i&&l<=o&&s>=r&&s<=a)return}this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,o=t.visible,r=t.placement,a=t.distance,l=t.panelClass,s=t.isAuto,c=t.offsetX,u=t.autoClose;return f.a.createElement(g.a,{ref:this.refDropDown,isAuto:s,className:l,triggerElement:this.btnDom,rect:e,offsetX:c,visible:o,placement:r,distance:a,isSetHeight:n,onClose:this.handleContentClose,autoClose:u,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,o=e.destroyOnHide;t=t||n.props.disabled;var r=this.getRect();if(!t){var a=n.props.title;a&&i&&(a=null),n=f.a.cloneElement(n,{title:a,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return f.a.createElement(f.a.Fragment,null,n,!!r&&f.a.createElement(b.default,{visible:i,destroyOnHide:o},this.renderContent()))}}]),t}(d.PureComponent);_.placementTypes=g.a.placementTypes,_.DropdownPanel=y.default,_.triggerTypes=w,_.defaultProps={visible:!1,trigger:w.click,distance:4,offsetX:0,autoClose:!0},t.default=_},3524:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(1909),r=function(){function e(){this.cache={}}return e.prototype.hasCache=function(e){return this.cache.hasOwnProperty(e)},e.prototype.getCache=function(e){return this.cache[e]},e.prototype.getByName=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(n){switch(n.label){case 0:return this.hasCache(e)?[2,this.cache[e]]:[4,(0,window.__WPSENV__.store.dispatch)((0,o.getSingleFeatureInfo)(e))];case 1:if((t=n.sent())&&t.response&&t.response[e])return this.cache[e]=t.response[e],[2,this.cache[e]];throw new Error("Get Feature Error, ".concat(t&&t.result))}}))}))},e.prototype.getByNames=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,n,r,a,l;return i.__generator(this,(function(i){switch(i.label){case 0:for(t={},n=[],a=0;a<e.length;a++)l=e[a],this.hasCache(l)?t[l]=this.cache[l]:n.push(l);return n.length?[4,(0,window.__WPSENV__.store.dispatch)((0,o.getFeaturesInfo)(n))]:[3,2];case 1:if((r=i.sent())&&r.response)for(a=0;a<n.length;a++)l=n[a],this.cache[l]=r.response[l],t[l]=r.response[l];i.label=2;case 2:return[2,t]}}))}))},e}();t.default=new r},3531:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i=n(80),o=n.n(i),r=n(13),a=n.n(r),l=n(1),s=n.n(l),c=n(2),u=n.n(c),d=n(22),f=n.n(d),p=n(23),h=n.n(p),m=n(238),v=n.n(m),b=n(332),g=n(227),y=n(167),w=n(240),_={groupNotExist:_i18n("applications.public.helpers.saveDocVersion.groupNotExist", "The team does not exist."),permissionDenied:_i18n("applications.public.helpers.saveDocVersion.permissionDenied", "Insufficient permissions"),userNotLogin:_i18n("applications.public.helpers.saveDocVersion.userNotLogin", "The user is not signed in."),ServerError:_i18n("applications.public.helpers.saveDocVersion.serverError", "server error"),SessionIDNotExist:_i18n("applications.public.helpers.saveDocVersion.sessionIDNotExist", "session does not exist"),fileNameLengthExceed:_i18n("applications.public.helpers.saveDocVersion.fileNameLengthExceed", "The filename length exceeds the limit."),illegalFname:_i18n("applications.public.helpers.saveDocVersion.illegalFname", "Invalid filename."),Unknown:_i18n("applications.public.helpers.saveDocVersion.unknown", "Unknown error"),InvalidArgument:_i18n("applications.public.helpers.saveDocVersion.invalidArgument", "invalid parameter"),Canceled:_i18n("applications.public.helpers.saveDocVersion.canceled", "Cancelled"),fileNotExists:_i18n("applications.public.helpers.saveDocVersion.fileNotExists", "File does not exist"),fileNotUploaded:_i18n("applications.public.helpers.saveDocVersion.fileNotUploaded", "File not uploaded."),InternalError:_i18n("applications.public.helpers.saveDocVersion.internalError", "internal error")},E=function(e,t){return function(n){function i(){var n,r,l,c,u=this;s()(this,i);for(var d=arguments.length,p=Array(d),h=0;h<d;h++)p[h]=arguments[h];return r=l=f()(this,(n=i.__proto__||Object.getPrototypeOf(i)).call.apply(n,[this].concat(p))),l.isSaveFail=!1,l.handleAutoSave=function(e){e.error^l.isSaveFail&&l.handleSaveResult(a()({},e,{isAuto:!0}))},l.timer=null,l.showTimestamp=0,l.showLong=6,l.loading=!1,l.handleSave=function(t){t.detail.triggerSave&&(l.loading||(l.props.connected?(l.isSaveFail&&window.Notice.close(),l.loading=!0,!y.isMobile&&window.__WPSENV__.draft||window.Toast.success(_i18n("applications.public.helpers.saveDocVersion.saving", "Saving"),void 0,0,void 0,"16 loading"),window.RPCClient.saveVersion(!0,l.handleSaveResult,"OnSaveFile")):window.Toast.error(e.fail)))},l.handleSaveResult=function(n){l.loading=!1;var i=n.error?n.reason:n.result;if(g.default.dispatchEvent(g.default.names.file.ON_SAVE_VERSION,{result:i,size:n.size,error:n.error}),window.collection2("versionnotice_"+i),y.isMobile||!window.__WPSENV__.draft)if(window.Toast.close(),(y.isMobile||l.isSaveFail)&&window.Notice.close(),l.isSaveFail=!1,["ok","nochange"].includes(i)&&window.Notice.close(),"ok"!==i){var o=e[i];if(o){var r="nochange"===i?1:void 0;window.Toast.info(o,null,r)}else if(l.isSaveFail=!0,!window.__WPSENV__.isNewUI||y.isMobile){var a={icon:t,content:l.renderFail(n)};!y.isMobile&&(a.top=144),window.Notice.show(a)}else{var s=l.renderFail(n);window.Message.error({message:s})}}else{var c=e.ok.includes("{historyLink}"),u=y.isMobile?e.ok:l.renderSaveHistoryLink();if(window.__WPSENV__.isNewUI){var d={message:u};c&&window.__CONFIG__.showHistoryLinkInSavingToast&&Object.assign(d,{buttonText:_i18n("applications.public.helpers.saveDocVersion.view", "View"),onButtonClick:l.handleDetailsClick}),window.Message.success(d)}else window.Toast.success(u)}},l.handleRetry=function(){l.loading||(l.loading=!0,window.Notice.close(),window.Toast.success(_i18n("applications.public.helpers.saveDocVersion.saving", "Saving"),void 0,0,void 0,"16 loading"),window.RPCClient.saveVersion(!0,l.handleSaveResult,"OnSaveFile"))},l.handleDetailsClick=o()(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,s,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.props.dispatch(Object(b.loadFileInfo)(window.urlFileId));case 2:t=window.location,n=t.origin,i=t.pathname,o=t.search,r=window.fileInfo,a=r.version,s=r.history_id,c=""+n+i,d=(d=o.substr(1).split("&").filter((function(e){return e}))).filter((function(e){return!/^version=/i.test(e)&&!/^history_id=/i.test(e)})),null!==a&&d.push("version="+a),null!==s&&d.push("history_id="+s),d.length&&(c+="?"+d.join("&")),window.open(c,"_self"),window.collectionOnce(),window.collection("revisions_detailview");case 13:case"end":return e.stop()}}),e,u)}))),l.renderSaveHistoryLink=function(){if(e.ok.indexOf("{historyLink}")>=0){if(window.__WPSENV__.isNewUI)return e.ok.replace("{historyLink}",_i18n("applications.public.helpers.saveDocVersion.enterHistoryLink", "Version History"));var t=e.ok.split(/[{}]/).map((function(e){return"historyLink"===e?v.a.createElement("a",{onClick:l.handleDetailsClick,className:"save-version-history-link "+window.officeType},_i18n("applications.public.helpers.saveDocVersion.enterHistoryLink", "Version History")):e}));return v.a.createElement("span",null,t)}return e.ok},c=r,f()(l,c)}return h()(i,n),u()(i,[{key:"componentDidMount",value:function(){window.RPCClient.on("file.autosave",this.handleAutoSave),window.addEventListener(g.default.names.file.ON_SAVE_VERSION,this.handleSave)}},{key:"componentWillUnmount",value:function(){window.RPCClient.off("file.autosave",this.handleAutoSave),window.removeEventListener(g.default.names.file.ON_SAVE_VERSION,this.handleSave),y.isMobile&&this.stopTimer()}},{key:"componentDidUpdate",value:function(e){var t=this.props.connected,n=e.connected;y.isMobile?w.isSupportOfflineEditing&&n!==t&&(t?(this.stopTimer(),this.isSaveFail&&g.default.dispatchEvent(g.default.names.file.ON_SAVE_VERSION,{triggerSave:!0})):this.startTimer()):t!==n&&t&&this.isSaveFail&&g.default.dispatchEvent(g.default.names.file.ON_SAVE_VERSION,{triggerSave:!0})}},{key:"startTimer",value:function(){var e=this;this.timer=setTimeout((function(){e.showTimestamp=window.performance.now(),window.Toast.error(_i18n("applications.public.helpers.saveDocVersion.disconnectTips", "Disconnected from server, reconnecting ..."),null,e.showLong)}),6e3)}},{key:"stopTimer",value:function(){clearTimeout(this.timer),window.performance.now()-this.showTimestamp<1e3*this.showLong&&window.Toast.close(),this.showTimestamp=0}},{key:"renderFail",value:function(e){var t=window.__CONFIG__.isShowErrorCode&&e.errno,n=void 0;return e.message?n=e.message:e.reason&&(n=_[e.reason]),n||(n=_i18n("applications.public.helpers.saveDocVersion.unknown", "Unknown error")),n=e.isAuto?_i18n("applications.public.helpers.saveDocVersion.autoSaveFail", "{0}, auto save failed").replace("{0}",n):_i18n("applications.public.helpers.saveDocVersion.saveFail", "{0}. Save failed.").replace("{0}",n),v.a.createElement("div",{className:"save-version-fail "+window.officeType},n+" "+(t?"（Error Code: "+e.errno+"）":""),v.a.createElement("span",{className:"save-version-retry",onClick:this.handleRetry},_i18n("applications.public.helpers.saveDocVersion.retry", "Retry")))}},{key:"render",value:function(){return!1}}]),i}(m.PureComponent)}},362:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=(n(501),n(238)),f=n.n(d),p=n(167),h=n(227),m=n(240),v=n(248),b=n(467),g=n(491),y=n(246),w="right",_="down",E="rightDown",C=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer),window.__WPSENV__.altStatus&&window.postMessage(JSON.stringify({eventName:"alt_web_access",cmd:"refresh"}))}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var o=n.refPanel.current,r=o.scrollTop;r+o.clientHeight+t>=o.scrollHeight&&i({scrollTop:r})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=f.a.createRef(),n.refContent=f.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(m.getPageOfficeType)(),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){p.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(e){p.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(e),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(e){if(this.props.onItemHover&&!p.isTouchScreen){var t=this.getHoverItem();this.props.onItemHover(t,!0)}window.__WPSENV__.altStatus&&h.default.dispatchEvent(h.default.names.EXIT_ALT_MODE,e)}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(m.stopBubble)(e);var i=e.clientX,o=e.clientY,r=e.target,a=e.currentTarget.getAttribute("data-orien");r.setCapture&&r.setCapture();var l=this.state,s=l.width,c=l.height,u=l.minWidth,d=l.minHeight;document.onmousemove=function(e){Object(m.stopBubble)(e);var n=e.clientX,r=e.clientY,l=Math.max(u,s+n-i),f=Math.max(d,c+r-o);a===w?f=c:a===_&&(l=s),t.setState({width:l,height:f},(function(){h.default.dispatchEvent(h.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(m.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,r.releaseCapture&&r.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus){var i=Object(y.getKey)(e);switch(i){case y.Keys.Enter:var o=this.getHoverItem();o&&(Object(m.stopBubble)(e),o.click());break;case y.Keys.ArrowUp:case y.Keys.ArrowDown:var r=i===y.Keys.ArrowUp;this.setPreSelectItem(r,e),this.props.isPreSelectCloseDropdown&&h.default.dispatchEvent(h.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(m.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);o.classList.add("hover"),this.showPreSelectItem(o)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var r=i-1;r>=0;r--)if(-1===t[r].className.indexOf("disabled")){i=r;break}}else for(var a=i+1;a<t.length;a++)if(-1===t[a].className.indexOf("disabled")){i=a;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,o=t.maxWidth;if(n||i||o)return{width:n,minWidth:i,maxWidth:o}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,o=e.isAuto,r=e.selectable,a=e.altStartMode,l="wo-dropdown-panel";o&&(l+=" "+this.officeType),i&&(l+=" can-resize"),t&&(l+=" "+t),r&&(l+=" wo-dropdown-panel-selectable");var s=this.getPanelStyle();return f.a.createElement("div",{ref:this.refPanel,className:l,style:s,tabIndex:0,"alt-start-mode":a,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0,role:"listbox"},f.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),f.a.createElement("div",{className:"drag-hand rightBottom","data-orien":E,onMouseDown:this.handleDragMouseDown},f.a.createElement(v.default,{type:v.default.types.other.drag_right_bottom})),f.a.createElement("div",{className:"drag-hand right","data-orien":w,onMouseDown:this.handleDragMouseDown}),f.a.createElement("div",{className:"drag-hand bottom","data-orien":_,onMouseDown:this.handleDragMouseDown}))}}]),t}(d.PureComponent);C.Item=b.a,C.Divider=g.a,C.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=C},372:function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n(244),p=n.n(f),h=function(e){function t(){var e,n,i,r;o()(this,t);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return n=i=s()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.popup=null,i.container=null,r=n,s()(i,r)}return u()(t,e),a()(t,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.visible,n=e.destroyOnHide;this.popup&&!t&&n&&this.unmountPopoup()}},{key:"componentWillUnmount",value:function(){this.unmountPopoup()}},{key:"getPopup",value:function(){if(this.popup)this.props.getContainer&&(this.container=this.props.getContainer(),this.container.contains(this.popup)||this.container&&this.container.appendChild(this.popup));else{this.popup=document.createElement("div"),this.popup.style.position="absolute",this.popup.style.left=0,this.popup.style.top=0,this.popup.style.zIndex=1e3;var e="component-popup",t=this.props.className;t&&(e+=" "+t),this.popup.className=e,this.popup.id="util-popup",this.container=document.body,this.props.getContainer&&(this.container=this.props.getContainer(),this.popup.style.right=0,this.popup.style.bottom=0),this.props.fullViewport&&this.popup.setAttribute("data-fullviewport","true"),this.container&&this.container.appendChild(this.popup)}return this.props.fullViewport&&this.popup.setAttribute("data-fullviewport","true"),this.popup}},{key:"unmountPopoup",value:function(){this.popup&&(this.container&&this.container.removeChild(this.popup),this.popup=null)}},{key:"componentDidCatch",value:function(e,t){if("s"===window.officeType)try{if(e&&t){if(-1===e.stack.indexOf("cross-origin"))return;window.badJsFunc(!1,{error:new Error("Plugin Center et react debugger. [stack]: "+t.componentStack)})}}catch(e){window.badJsFunc(!1,{error:new Error("Plugin Center et react 【PopUp】")})}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.visible,i=e.destroyOnHide;if(!t||!n&&!this.popup)return!1;if(!n&&i)return!1;var o=this.getPopup();return o.style.display=n?"":"none",p.a.createPortal(t,o)}}]),t}(d.PureComponent);h.defaultProps={destroyOnHide:!0,fullViewport:!0},t.a=h},375:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("symbol_tick",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},o.a.createElement("path",{d:"M2.5 7.38775L6.68824 11.2933C6.81053 11.401 6.99639 11.3913 7.10689 11.2716L13.4215 4.5",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},380:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("arrow_down_s",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},o.a.createElement("path",{d:"M4.25 6.49997L7.99327 9.9936C7.99711 9.99719 8.00307 9.99719 8.00691 9.9936L11.75 6.49997",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},385:function(e,t,n){"use strict";n.r(t);var i=n(24),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(23),f=n.n(d),p=n(238),h=n.n(p),m=n(240),v=n(252),b=n.n(v),g=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refDiv=h.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n}return f()(t,e),s()(t,[{key:"handleClick",value:function(e){this.props.onClick&&!this.props.disabled&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(m.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"handleMouseLeave",value:function(){this.props.useMouseLeaveHover&&this.refDiv.current.classList.remove("hover")}},{key:"getClassName",value:function(){var e=this.props,t=e.selected,n=e.disabled,i=e.disabledTag,r=e.children,a=e.className,l="component-menu-item",s=this.refDiv.current;s&&-1!==s.className.indexOf(" hover")&&(l+=" hover"),t&&(l+=" selected"),n&&(l+=" disabled"),i&&(l+=" disabled-tag"),a&&(l+=" "+a);var c=void 0===r?"undefined":o()(r);return"string"!==c&&"number"!==c||(l+=" only-text"),a&&(l+=" "+a),l}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.keepEdit,o=e.dataKey,r=e.title,a=e.placement,l=e.draggable,s=e.onDragStart,c=e.onDragEnd,u=e.altHintKeep,d=e.altRenderDelay,f=e.altForceDirection,p=e.altRole,m=e.altCustom,v=e.padMustShowTooltip,g=this.getClassName();return h.a.createElement(b.a,{title:r,placement:a,padMustShow:v},h.a.createElement("div",{ref:this.refDiv,id:t,className:g,role:p,"alt-hint-keep":u,"alt-render-delay":d,"alt-force-direction":f,"alt-custom":m,"data-keep-edit":i||void 0,"data-key":o||void 0,draggable:l,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onMouseLeave:this.handleMouseLeave,onDragStart:s,onDragEnd:c},n))}}]),t}(p.PureComponent);g.defaultProps={altRole:"option",padMustShowTooltip:!1},t.default=g},3890:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var i=n(238),o=n.n(i),r=n(688),a=n(404),l=n(455),s=n(521),c=n(262),u=n(513);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function f(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function m(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==p(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(m,e);var t,n,i,l=b(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=l.call(this,e)).prefixCls="kd-menu-item",t.handleMouseOver=function(e){for(var n,i,o,r,a,l=null===(n=t.context.refMenu)||void 0===n?void 0:n.current,s=t.refMenuItem.current,c=(null==l?void 0:l.getElementsByClassName("hover"))||[],u=0;u<c.length;u++){var d=c[u];if(d===s)return;d.classList.remove("hover")}(null==s?void 0:s.contains(e.target))&&(null==s||s.classList.add("hover")),null===(o=(i=t.props).onItemHover)||void 0===o||o.call(i),null===(a=(r=t.props).onMouseOver)||void 0===a||a.call(r,e)},t.handleMouseOut=function(e){var n,i,o;Object(s.a)(e,t.refMenuItem.current)||null===(n=t.refMenuItem.current)||void 0===n||n.classList.remove("hover"),null===(o=(i=t.props).onMouseOut)||void 0===o||o.call(i,e)},t.getElement=function(){return t.refMenuItem.current},t.handleClick=function(e){var n,i;if(!t.props.disabled){var o=t.state,r=o.checked,a=o.value;t.context.checkable&&t.setState({checked:!r});var l=a;null===(i=(n=t.props).onClick)||void 0===i||i.call(n,e,l)}},t.refMenuItem=o.a.createRef(),t.state={value:e.value,checked:!!t.props.checked},t}return t=m,(n=[{key:"render",value:function(){var e,t=this.props,n=t.className,i=t.tabIndex,l=void 0===i?-1:i,s=t.children,h=t.icon,m=t.selected,v=t.disabled,b=w(t,["className","tabIndex","children","icon","selected","disabled"]),g=this.state.checked,y=p(s),_=Object(c.a)(this.prefixCls,n,(f(e={},"".concat(this.prefixCls,"-selected"),m),f(e,"".concat(this.prefixCls,"-disabled"),v),f(e,"only-text","string"===y||"number"===y),e)),E=Object(a.a)(b,["value","checked","readOnly"]),C=this.context,S=C.selectable,k=C.checkable;return o.a.createElement("li",d({},E,{ref:this.refMenuItem,className:_,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleClick,tabIndex:l,role:"menuitem"}),S&&m&&o.a.createElement(r.a,{className:"kd-menu-item-tick",strokeWidth:2}),k&&o.a.createElement(u.default,{checked:g}),o.a.isValidElement(h)&&o.a.cloneElement(h,{className:"".concat(this.prefixCls,"-icon")}),"string"==typeof s?o.a.createElement("span",{className:"".concat(this.prefixCls,"-content")},s):s)}}])&&h(t.prototype,n),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),m}(i.PureComponent);_.defaultProps={},_.contextType=l.a},393:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=(n(432),n(238)),f=n.n(d),p=n(167),h=n(227),m=n(240),v=n(248),b=n(565),g=n(608),y=n(246),w="right",_="down",E="rightDown",C=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){if(!n.props.disabledScrollSelectedChildren)for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer),window.__WPSENV__.altStatus&&window.postMessage(JSON.stringify({eventName:"alt_web_access",cmd:"refresh"}))}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var o=n.refPanel.current,r=o.scrollTop;r+o.clientHeight+t>=o.scrollHeight&&i({scrollTop:r})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=f.a.createRef(),n.refContent=f.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(m.getPageOfficeType)(),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){p.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(e){p.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(e),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(e){if(this.props.onItemHover&&!p.isTouchScreen){var t=this.getHoverItem();this.props.onItemHover(t,!0)}window.__WPSENV__.altStatus&&h.default.dispatchEvent(h.default.names.EXIT_ALT_MODE,e)}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(m.stopBubble)(e);var i=e.clientX,o=e.clientY,r=e.target,a=e.currentTarget.getAttribute("data-orien");r.setCapture&&r.setCapture();var l=this.state,s=l.width,c=l.height,u=l.minWidth,d=l.minHeight;document.onmousemove=function(e){Object(m.stopBubble)(e);var n=e.clientX,r=e.clientY,l=Math.max(u,s+n-i),f=Math.max(d,c+r-o);a===w?f=c:a===_&&(l=s),t.setState({width:l,height:f},(function(){h.default.dispatchEvent(h.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(m.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,r.releaseCapture&&r.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus){var i=Object(y.getKey)(e);switch(i){case y.Keys.Enter:var o=this.getHoverItem();o&&(Object(m.stopBubble)(e),o.click());break;case y.Keys.ArrowUp:case y.Keys.ArrowDown:var r=i===y.Keys.ArrowUp;this.setPreSelectItem(r,e),this.props.isPreSelectCloseDropdown&&h.default.dispatchEvent(h.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(m.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);o.classList.add("hover"),this.showPreSelectItem(o)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var r=i-1;r>=0;r--)if(-1===t[r].className.indexOf("disabled")){i=r;break}}else for(var a=i+1;a<t.length;a++)if(-1===t[a].className.indexOf("disabled")){i=a;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,o=t.maxWidth,r=t.maxHeight;if(n||i||o||r)return{width:n,minWidth:i,maxWidth:o,maxHeight:r}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,o=e.isAuto,r=e.altStartMode,a="dropdown-panel";o&&(a+=" "+this.officeType),i&&(a+=" can-resize"),t&&(a+=" "+t);var l=this.getPanelStyle();return f.a.createElement("div",{ref:this.refPanel,className:a,style:l,tabIndex:0,"alt-start-mode":r,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0,role:"listbox"},f.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),f.a.createElement("div",{className:"drag-hand rightBottom","data-orien":E,onMouseDown:this.handleDragMouseDown},f.a.createElement(v.default,{type:v.default.types.other.drag_right_bottom})),f.a.createElement("div",{className:"drag-hand right","data-orien":w,onMouseDown:this.handleDragMouseDown}),f.a.createElement("div",{className:"drag-hand bottom","data-orien":_,onMouseDown:this.handleDragMouseDown}))}}]),t}(d.PureComponent);C.Item=b.default,C.Divider=g.a,C.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=C},4147:function(e,t,n){},4148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scrollbars=void 0;var i,o=n(4149),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,t.Scrollbars=r.default},4149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(4150),a=b(r),l=b(n(2977)),s=n(238),c=b(n(259)),u=b(n(4157)),d=b(n(4158)),f=b(n(4159)),p=b(n(4160)),h=b(n(4161)),m=n(4162),v=n(4163);function b(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e){function t(e){var n;g(this,t);for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];var a=y(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this,e].concat(o)));return a.getScrollLeft=a.getScrollLeft.bind(a),a.getScrollTop=a.getScrollTop.bind(a),a.getScrollWidth=a.getScrollWidth.bind(a),a.getScrollHeight=a.getScrollHeight.bind(a),a.getClientWidth=a.getClientWidth.bind(a),a.getClientHeight=a.getClientHeight.bind(a),a.getValues=a.getValues.bind(a),a.getThumbHorizontalWidth=a.getThumbHorizontalWidth.bind(a),a.getThumbVerticalHeight=a.getThumbVerticalHeight.bind(a),a.getScrollLeftForOffset=a.getScrollLeftForOffset.bind(a),a.getScrollTopForOffset=a.getScrollTopForOffset.bind(a),a.scrollLeft=a.scrollLeft.bind(a),a.scrollTop=a.scrollTop.bind(a),a.scrollToLeft=a.scrollToLeft.bind(a),a.scrollToTop=a.scrollToTop.bind(a),a.scrollToRight=a.scrollToRight.bind(a),a.scrollToBottom=a.scrollToBottom.bind(a),a.handleTrackMouseEnter=a.handleTrackMouseEnter.bind(a),a.handleTrackMouseLeave=a.handleTrackMouseLeave.bind(a),a.handleHorizontalTrackMouseDown=a.handleHorizontalTrackMouseDown.bind(a),a.handleVerticalTrackMouseDown=a.handleVerticalTrackMouseDown.bind(a),a.handleHorizontalThumbMouseDown=a.handleHorizontalThumbMouseDown.bind(a),a.handleVerticalThumbMouseDown=a.handleVerticalThumbMouseDown.bind(a),a.handleWindowResize=a.handleWindowResize.bind(a),a.handleScroll=a.handleScroll.bind(a),a.handleDrag=a.handleDrag.bind(a),a.handleDragEnd=a.handleDragEnd.bind(a),a.state={didMountUniversal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){this.props.universal&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,r.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var e=this.view||{},t=e.scrollLeft,n=void 0===t?0:t,i=e.scrollTop,o=void 0===i?0:i,r=e.scrollWidth,a=void 0===r?0:r,l=e.scrollHeight,s=void 0===l?0:l,c=e.clientWidth,u=void 0===c?0:c,d=e.clientHeight,f=void 0===d?0:d;return{left:n/(a-u)||0,top:o/(s-f)||0,scrollLeft:n,scrollTop:o,scrollWidth:a,scrollHeight:s,clientWidth:u,clientHeight:f}}},{key:"getThumbHorizontalWidth",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,i=this.view,o=i.scrollWidth,r=i.clientWidth,a=(0,p.default)(this.trackHorizontal),l=Math.ceil(r/o*a);return a===l?0:t||Math.max(l,n)}},{key:"getThumbVerticalHeight",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,i=this.view,o=i.scrollHeight,r=i.clientHeight,a=(0,h.default)(this.trackVertical),l=Math.ceil(r/o*a);return a===l?0:t||Math.max(l,n)}},{key:"getScrollLeftForOffset",value:function(e){var t=this.view,n=t.scrollWidth,i=t.clientWidth;return e/((0,p.default)(this.trackHorizontal)-this.getThumbHorizontalWidth())*(n-i)}},{key:"getScrollTopForOffset",value:function(e){var t=this.view,n=t.scrollHeight,i=t.clientHeight;return e/((0,h.default)(this.trackVertical)-this.getThumbVerticalHeight())*(n-i)}},{key:"scrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollLeft=e)}},{key:"scrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollTop=e)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,i=this.thumbHorizontal,o=this.thumbVertical;e.addEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.addEventListener("mouseenter",this.handleTrackMouseEnter),t.addEventListener("mouseleave",this.handleTrackMouseLeave),t.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.addEventListener("mouseenter",this.handleTrackMouseEnter),n.addEventListener("mouseleave",this.handleTrackMouseLeave),n.addEventListener("mousedown",this.handleVerticalTrackMouseDown),i.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),o.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,i=this.thumbHorizontal,o=this.thumbVertical;e.removeEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.removeEventListener("mouseenter",this.handleTrackMouseEnter),t.removeEventListener("mouseleave",this.handleTrackMouseLeave),t.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.removeEventListener("mouseenter",this.handleTrackMouseEnter),n.removeEventListener("mouseleave",this.handleTrackMouseLeave),n.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),i.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),o.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(e){var t=this,n=this.props,i=n.onScroll,o=n.onScrollFrame;i&&i(e),this.update((function(e){var n=e.scrollLeft,i=e.scrollTop;t.viewScrollLeft=n,t.viewScrollTop=i,o&&o(e)})),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var e=this.props.onScrollStart;e&&e(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleScrollStop",value:function(){var e=this.props.onScrollStop;e&&e(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleWindowResize",value:function(){this.update()}},{key:"handleHorizontalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientX,i=t.getBoundingClientRect().left,o=this.getThumbHorizontalWidth(),r=Math.abs(i-n)-o/2;this.view.scrollLeft=this.getScrollLeftForOffset(r)}},{key:"handleVerticalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientY,i=t.getBoundingClientRect().top,o=this.getThumbVerticalHeight(),r=Math.abs(i-n)-o/2;this.view.scrollTop=this.getScrollTopForOffset(r)}},{key:"handleHorizontalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientX,i=t.offsetWidth,o=t.getBoundingClientRect().left;this.prevPageX=i-(n-o)}},{key:"handleVerticalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientY,i=t.offsetHeight,o=t.getBoundingClientRect().top;this.prevPageY=i-(n-o)}},{key:"setupDragging",value:function(){(0,l.default)(document.body,m.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=f.default}},{key:"teardownDragging",value:function(){(0,l.default)(document.body,m.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(e){this.dragging=!0,e.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(e){if(this.prevPageX){var t=e.clientX,n=-this.trackHorizontal.getBoundingClientRect().left+t-(this.getThumbHorizontalWidth()-this.prevPageX);this.view.scrollLeft=this.getScrollLeftForOffset(n)}if(this.prevPageY){var i=e.clientY,o=-this.trackVertical.getBoundingClientRect().top+i-(this.getThumbVerticalHeight()-this.prevPageY);this.view.scrollTop=this.getScrollTopForOffset(o)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,l.default)(this.trackHorizontal,{opacity:1}),(0,l.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var e=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var t=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout((function(){(0,l.default)(e.trackHorizontal,{opacity:0}),(0,l.default)(e.trackVertical,{opacity:0})}),t)}}},{key:"detectScrolling",value:function(){var e=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval((function(){e.lastViewScrollLeft===e.viewScrollLeft&&e.lastViewScrollTop===e.viewScrollTop&&(clearInterval(e.detectScrollingInterval),e.scrolling=!1,e.handleScrollStop()),e.lastViewScrollLeft=e.viewScrollLeft,e.lastViewScrollTop=e.viewScrollTop}),100))}},{key:"raf",value:function(e){var t=this;this.requestFrame&&a.default.cancel(this.requestFrame),this.requestFrame=(0,a.default)((function(){t.requestFrame=void 0,e()}))}},{key:"update",value:function(e){var t=this;this.raf((function(){return t._update(e)}))}},{key:"_update",value:function(e){var t=this.props,n=t.onUpdate,i=t.hideTracksWhenNotNeeded,o=this.getValues();if((0,d.default)()){var r=o.scrollLeft,a=o.clientWidth,s=o.scrollWidth,c=(0,p.default)(this.trackHorizontal),u=this.getThumbHorizontalWidth(),f={width:u,transform:"translateX("+r/(s-a)*(c-u)+"px)"},m=o.scrollTop,v=o.clientHeight,b=o.scrollHeight,g=(0,h.default)(this.trackVertical),y=this.getThumbVerticalHeight(),w={height:y,transform:"translateY("+m/(b-v)*(g-y)+"px)"};if(i){var _={visibility:s>a?"visible":"hidden"},E={visibility:b>v?"visible":"hidden"};(0,l.default)(this.trackHorizontal,_),(0,l.default)(this.trackVertical,E)}(0,l.default)(this.thumbHorizontal,f),(0,l.default)(this.thumbVertical,w)}n&&n(o),"function"==typeof e&&e(o)}},{key:"render",value:function(){var e=this,t=(0,d.default)(),n=this.props,o=(n.onScroll,n.onScrollFrame,n.onScrollStart,n.onScrollStop,n.onUpdate,n.renderView),r=n.renderTrackHorizontal,a=n.renderTrackVertical,l=n.renderThumbHorizontal,c=n.renderThumbVertical,f=n.tagName,p=(n.hideTracksWhenNotNeeded,n.autoHide),h=(n.autoHideTimeout,n.autoHideDuration),v=(n.thumbSize,n.thumbMinSize,n.universal),b=n.autoHeight,g=n.autoHeightMin,y=n.autoHeightMax,w=n.style,_=n.children,E=function(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}(n,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),C=this.state.didMountUniversal,S=i({},m.containerStyleDefault,b&&i({},m.containerStyleAutoHeight,{minHeight:g,maxHeight:y}),w),k=i({},m.viewStyleDefault,{marginRight:t?-t:0,marginBottom:t?-t:0},b&&i({},m.viewStyleAutoHeight,{minHeight:(0,u.default)(g)?"calc("+g+" + "+t+"px)":g+t,maxHeight:(0,u.default)(y)?"calc("+y+" + "+t+"px)":y+t}),b&&v&&!C&&{minHeight:g,maxHeight:y},v&&!C&&m.viewStyleUniversalInitial),O={transition:"opacity "+h+"ms",opacity:0},P=i({},m.trackHorizontalStyleDefault,p&&O,(!t||v&&!C)&&{display:"none"}),M=i({},m.trackVerticalStyleDefault,p&&O,(!t||v&&!C)&&{display:"none"});return(0,s.createElement)(f,i({},E,{style:S,ref:function(t){e.container=t}}),[(0,s.cloneElement)(o({style:k}),{key:"view",ref:function(t){e.view=t}},_),(0,s.cloneElement)(r({style:P}),{key:"trackHorizontal",ref:function(t){e.trackHorizontal=t}},(0,s.cloneElement)(l({style:m.thumbHorizontalStyleDefault}),{ref:function(t){e.thumbHorizontal=t}})),(0,s.cloneElement)(a({style:M}),{key:"trackVertical",ref:function(t){e.trackVertical=t}},(0,s.cloneElement)(c({style:m.thumbVerticalStyleDefault}),{ref:function(t){e.thumbVertical=t}}))])}}]),t}(s.Component);t.default=w,w.propTypes={onScroll:c.default.func,onScrollFrame:c.default.func,onScrollStart:c.default.func,onScrollStop:c.default.func,onUpdate:c.default.func,renderView:c.default.func,renderTrackHorizontal:c.default.func,renderTrackVertical:c.default.func,renderThumbHorizontal:c.default.func,renderThumbVertical:c.default.func,tagName:c.default.string,thumbSize:c.default.number,thumbMinSize:c.default.number,hideTracksWhenNotNeeded:c.default.bool,autoHide:c.default.bool,autoHideTimeout:c.default.number,autoHideDuration:c.default.number,autoHeight:c.default.bool,autoHeightMin:c.default.oneOfType([c.default.number,c.default.string]),autoHeightMax:c.default.oneOfType([c.default.number,c.default.string]),universal:c.default.bool,style:c.default.object,children:c.default.node},w.defaultProps={renderView:v.renderViewDefault,renderTrackHorizontal:v.renderTrackHorizontalDefault,renderTrackVertical:v.renderTrackVerticalDefault,renderThumbHorizontal:v.renderThumbHorizontalDefault,renderThumbVertical:v.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}},4150:function(e,t,n){(function(t){for(var i=n(4151),o="undefined"==typeof window?t:window,r=["moz","webkit"],a="AnimationFrame",l=o["request"+a],s=o["cancel"+a]||o["cancelRequest"+a],c=0;!l&&c<r.length;c++)l=o[r[c]+"Request"+a],s=o[r[c]+"Cancel"+a]||o[r[c]+"CancelRequest"+a];if(!l||!s){var u=0,d=0,f=[];l=function(e){if(0===f.length){var t=i(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout((function(){var e=f.slice(0);f.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return f.push({handle:++d,callback:e,cancelled:!1}),d},s=function(e){for(var t=0;t<f.length;t++)f[t].handle===e&&(f[t].cancelled=!0)}}e.exports=function(e){return l.call(o,e)},e.exports.cancel=function(){s.apply(o,arguments)},e.exports.polyfill=function(e){e||(e=o),e.requestAnimationFrame=l,e.cancelAnimationFrame=s}}).call(this,n(83))},4151:function(e,t,n){(function(t){(function(){var n,i,o,r,a,l;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},i=t.hrtime,r=(n=function(){var e;return 1e9*(e=i())[0]+e[1]})(),l=1e9*t.uptime(),a=r-l):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n(835))},4152:function(e,t){var n=null,i=["Webkit","Moz","O","ms"];e.exports=function(e){n||(n=document.createElement("div"));var t=n.style;if(e in t)return e;for(var o=e.charAt(0).toUpperCase()+e.slice(1),r=i.length;r>=0;r--){var a=i[r]+o;if(a in t)return a}return!1}},4153:function(e,t,n){var i=n(4154);e.exports=function(e){return i(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))}},4154:function(e,t,n){var i=n(4155);e.exports=function(e){return i(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}},4155:function(e,t){e.exports=function(e){return n.test(e)?e.toLowerCase():i.test(e)?(function(e){return e.replace(r,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():o.test(e)?function(e){return e.replace(a,(function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()};var n=/\s/,i=/(_|-|\.|:)/,o=/([a-z][A-Z]|[A-Z][a-z])/;var r=/[\W_]+(.|$)/g;var a=/(.)([A-Z]+)/g},4156:function(e,t){var n={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};e.exports=function(e,t){return"number"!=typeof t||n[e]?t:t+"px"}},4157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e}},4158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!1!==a)return a;if("undefined"!=typeof document){var e=document.createElement("div");(0,r.default)(e,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(e),a=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else a=0;return a||0};var i,o=n(2977),r=(i=o)&&i.__esModule?i:{default:i};var a=!1},4159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!1}},4160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientWidth,n=getComputedStyle(e),i=n.paddingLeft,o=n.paddingRight;return t-parseFloat(i)-parseFloat(o)}},4161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientHeight,n=getComputedStyle(e),i=n.paddingTop,o=n.paddingBottom;return t-parseFloat(i)-parseFloat(o)}},4162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"},t.containerStyleAutoHeight={height:"auto"},t.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"},t.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0},t.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0},t.trackHorizontalStyleDefault={position:"absolute",height:6},t.trackVerticalStyleDefault={position:"absolute",width:6},t.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"},t.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"},t.disableSelectStyle={userSelect:"none"},t.disableSelectStyleReset={userSelect:""}},4163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.renderViewDefault=function(e){return a.default.createElement("div",e)},t.renderTrackHorizontalDefault=function(e){var t=e.style,n=l(e,["style"]),o=i({},t,{right:2,bottom:2,left:2,borderRadius:3});return a.default.createElement("div",i({style:o},n))},t.renderTrackVerticalDefault=function(e){var t=e.style,n=l(e,["style"]),o=i({},t,{right:2,bottom:2,top:2,borderRadius:3});return a.default.createElement("div",i({style:o},n))},t.renderThumbHorizontalDefault=function(e){var t=e.style,n=l(e,["style"]),o=i({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",i({style:o},n))},t.renderThumbVerticalDefault=function(e){var t=e.style,n=l(e,["style"]),o=i({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",i({style:o},n))};var o,r=n(238),a=(o=r)&&o.__esModule?o:{default:o};function l(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}},4164:function(e,t,n){},428:function(e,t,n){"use strict";n.r(t),t.default={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"}},430:function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.StyleNames=void 0,function(e){e.width="width",e.height="height",e.left="left",e.top="top",e.marginLeft="marginLeft",e.marginTop="marginTop",e.translateX="translateX",e.translateY="translateY",e.rotate="rotate",e.opacity="opacity"}(i||(i={})),t.StyleNames=i},432:function(e,t,n){},450:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var i="component-dropdown-popup",o=function(e){return parseInt(e.getAttribute("data-level"))},r=function(e){for(;e!==document.body;){var t=getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility)return!1;e=e.parentNode}return!0},a=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&e!==document.body;){if(e.classList)for(var t=0;t<e.classList.length;t++)if(e.classList[t]===i)return o(e);e=e.parentNode}return 0},l=function(e){for(var t=document.getElementsByClassName(i),n=0;n<t.length;n++)if(r(t[n])&&o(t[n])===e)return!0;return!1}},455:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(238),o=n.n(i).a.createContext({})},459:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var i=n(238),o=n.n(i),r=n(262),a=n(322),l=n(644),s=(n(511),n(488));function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===u(r)?r:String(r)),i)}var o,r}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=m(e);if(t){var o=m(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(m,e);var t,n,i,h=p(m);function m(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=h.call(this,e)).inputRef=o.a.createRef();var n=t.handleMaxLength(t.props.maxLength);return t.state={isShowClean:!(!t.props.showClean||!t.fixControlledValue(t.props.value)||t.props.disabled||t.props.readOnly),isFocus:!1,isShowCount:!!t.props.showCount&&!!n.length,count:t.fixControlledValue(t.props.value).length,status:t.props.status},t}return t=m,(n=[{key:"componentDidUpdate",value:function(e){this.props.status!==e.status&&this.setState({status:this.props.status})}},{key:"select",value:function(){var e;return null===(e=this.inputRef.current)||void 0===e?void 0:e.select()}},{key:"getElement",value:function(){return this.inputRef.current}},{key:"focus",value:function(){var e;return null===(e=this.inputRef.current)||void 0===e?void 0:e.focus()}},{key:"blur",value:function(){var e;return null===(e=this.inputRef.current)||void 0===e?void 0:e.blur()}},{key:"fixControlledValue",value:function(e){return null==e?"":e}},{key:"handleMaxLength",value:function(e){var t=void 0,n=!1;return e&&("object"===u(e)?(t=e.length,n=!!e.countOnly):t=e),{length:t,countOnly:n}}},{key:"fakeEvent",value:function(e,t){var n,i,o=null!==(i=null===(n=this.inputRef.current)||void 0===n?void 0:n.cloneNode(!0))&&void 0!==i?i:{},r=Object.create(e,{target:{value:o},currentTarget:{value:o}});return o.value=t,r}},{key:"validBeforeOnChange",value:function(e){var t,n,i,o,r=this.props.trim,a=e.target.value||"",l=r?a.trim():a,s=this.handleMaxLength(this.props.maxLength);if(s.countOnly&&void 0!==s.length){this.props.autoValid&&s.length&&this.setState({status:l.length>s.length?"error":void 0});var c=l.slice(0,s.length);null===(n=null===(t=this.props)||void 0===t?void 0:t.onChange)||void 0===n||n.call(t,this.fakeEvent(e,c),c)}else null===(o=null===(i=this.props)||void 0===i?void 0:i.onChange)||void 0===o||o.call(i,e,l)}},{key:"handleChange",value:function(e){var t=e.target.value;this.validBeforeOnChange(e),this.setState({isShowClean:!(!this.props.showClean||!t||this.props.disabled||this.props.readOnly),count:t.length})}},{key:"handleClean",value:function(e){this.props.disabled||(this.inputRef.current&&(this.inputRef.current.value=""),this.handleChange(this.fakeEvent(e,"")),this.focus())}},{key:"handleFocus",value:function(e){var t,n;return this.setState({isFocus:!0}),null===(n=null===(t=this.props)||void 0===t?void 0:t.onFocus)||void 0===n?void 0:n.call(t,e)}},{key:"handleBlur",value:function(e){var t,n;return this.setState({isFocus:!1}),null===(n=null===(t=this.props)||void 0===t?void 0:t.onBlur)||void 0===n?void 0:n.call(t,e)}},{key:"handleKeyDown",value:function(e){var t,n;return null===(n=null===(t=this.props)||void 0===t?void 0:t.onKeyDown)||void 0===n?void 0:n.call(t,e)}},{key:"handleSuffixIconClick",value:function(e){!this.props.onSuffixIconClick||this.props.suffixIconDisabled||this.props.disabled||this.props.onSuffixIconClick(e)}},{key:"handlePrefixIconClick",value:function(e){!this.props.onPrefixIconClick||this.props.prefixIconDisabled||this.props.disabled||this.props.onPrefixIconClick(e)}},{key:"handleCompositionStart",value:function(e){var t,n;return null===(n=null===(t=this.props)||void 0===t?void 0:t.onCompositionStart)||void 0===n?void 0:n.call(t,e)}},{key:"handleCompositionEnd",value:function(e){var t,n;return null===(n=null===(t=this.props)||void 0===t?void 0:t.onCompositionEnd)||void 0===n?void 0:n.call(t,e)}},{key:"genIcon",value:function(e,t,n,i){if(!t)return!1;var a="string"==typeof t,l=Object(r.a)(a&&"".concat(t),{"is-disabled":n},e);return o.a.createElement("i",{className:l,onClick:i.bind(this)},!a&&t)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.type,i=e.size,u=e.prepend,d=e.append,f=e.disabled,p=e.textAlign,h=e.suffixIcon,m=e.prefixIcon,b=e.suffixIconDisabled,g=e.prefixIconDisabled,y=e.autoComplete,w=e.loading,_=e.onMouseEnter,E=e.onMouseLeave,C=e.style,S=e.helpText,k=e.maxLength,O=(e.trim,v(e,["className","type","size","prepend","append","disabled","textAlign","suffixIcon","prefixIcon","suffixIconDisabled","prefixIconDisabled","autoComplete","loading","onMouseEnter","onMouseLeave","style","helpText","maxLength","trim"])),P=this.state,M=P.isShowClean,T=P.isFocus,I=P.isShowCount,D=P.count,N=P.status,L=Object(r.a)("kd-input",i&&"kd-input-".concat(i),N&&"kd-input-status-".concat(N),{"is-disabled":f,"is-focus":T},t),R=Object(r.a)("kd-input-group",{"with-append":!!d,"with-prepend":!!u});"value"in this.props&&(O.value=this.fixControlledValue(this.props.value)),delete O.onSuffixIconClick,delete O.onPrefixIconClick,delete O.showClean;var x=this.genIcon("kd-input-prefix-icon kd-input-icon",m,g,this.handlePrefixIconClick),H=this.genIcon("kd-input-suffix-icon kd-input-icon",h,b,this.handleSuffixIconClick),j={textAlign:p};delete O.autoValid,delete O.status,delete O.showCount;var W=this.handleMaxLength(k);return o.a.createElement("div",{className:L,onMouseEnter:_,onMouseLeave:E,style:C},o.a.createElement("div",{className:R},u&&o.a.createElement("div",{className:"kd-input-group-prepend"},u),o.a.createElement("div",{className:"kd-input-wrap"},x,o.a.createElement("input",c({},O,{ref:this.inputRef,disabled:f,type:n,style:j,maxLength:W.countOnly?void 0:W.length,className:"kd-input-inner",autoComplete:y,onChange:this.handleChange.bind(this),onFocus:this.handleFocus.bind(this),onBlur:this.handleBlur.bind(this),onCompositionStart:this.handleCompositionStart.bind(this),onCompositionEnd:this.handleCompositionEnd.bind(this),onKeyDown:this.handleKeyDown.bind(this)})),M&&o.a.createElement(a.default,{size:"small",className:"kd-input-icon kd-input-clean",icon:o.a.createElement(l.a,null),onClick:this.handleClean.bind(this)}),I&&o.a.createElement("div",{className:"kd-input-count"},D,"/",W.length),w&&o.a.createElement(s.a,{className:"kd-input-icon kd-input-loading"}),H),d&&o.a.createElement("div",{className:"kd-input-group-append"},d)),S&&o.a.createElement("div",{className:"kd-input-help"},S))}}])&&d(t.prototype,n),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),m}(i.Component);b.defaultProps={type:"text",textAlign:"left",size:"medium",trim:!0,showClean:!0,spellCheck:!1}},467:function(e,t,n){"use strict";var i=n(13),o=n.n(i),r=n(24),a=n.n(r),l=n(1),s=n.n(l),c=n(2),u=n.n(c),d=n(22),f=n.n(d),p=n(23),h=n.n(p),m=n(238),v=n.n(m),b=n(240),g=n(252),y=n.n(g),w=n(375),_=function(e){function t(e){s()(this,t);var n=f()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=v.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return h()(t,e),u()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(b.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,o=e.children,r="panel-item",l=this.refDiv.current;l&&-1!==l.className.indexOf(" hover")&&(r+=" hover"),t&&(r+=" disabled"),n&&(r+=" selected");var s=void 0===o?"undefined":a()(o);return"string"!==s&&"number"!==s||(r+=" only-text"),i&&(r+=" "+i),r}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,r=e.children,a=e.getStyle,l=e.visible,s=e.dataKey,c=e.keepEdit,u=e.draggable,d=e.selected,f=e.onMouseEnter,p=e.onMouseLeave,h=e.onDragEnter,m=e.onDragStart,b=e.onDragEnd,g=e.altHintKeep,_=e.altRole;if(!l)return!1;var E=this.getClassName(),C=a?a(i):null,S={};return f&&(S.onMouseEnter=f),p&&(S.onMouseLeave=p),v.a.createElement(y.a,o()({title:n},S),v.a.createElement("div",o()({ref:this.refDiv,id:t,className:E,style:C,role:_,"data-key":s||void 0,"data-keep-edit":c||void 0,"alt-hint-keep":g,draggable:u,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:m,onDragEnter:h,onDragEnd:b},S),r,d&&v.a.createElement(w.default,{size:16,className:"panel-item-tick",strokeWidth:2,fill:"var(--kd-color-icon-public)"})))}}]),t}(m.PureComponent);_.defaultProps={visible:!0,altRole:"option"},t.a=_},480:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var i=n(238),o=n.n(i);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===r(a)?a:String(a)),i)}var o,a}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var t,n,i,r=c(u);function u(){var e;return a(this,u),(e=r.apply(this,arguments)).prefixCls="kd-menu-divider",e}return t=u,(n=[{key:"render",value:function(){return o.a.createElement("div",{className:this.className(this.prefixCls)})}}])&&l(t.prototype,n),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(n(303).a)},486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canRequestForAuthForSecurityDoc=t.requestForAuth=t.isPrintLimitedSecurityDoc=t.isCopyLimitedSecurityDoc=t.isEditLimitedSecurityDoc=t.isSupportSecurityDoc=t.AUTH_TYPES=void 0;var i=n(5).__importDefault(n(82)),o={EDIT:"edit",COPY:"copy",PRINT:"print",SAVE_AS:"saveAs"};t.AUTH_TYPES=o;var r={pluginType:window.__WPSPLUGIN__.helper.types.SecureDocApplyAuth};var a=[i.default.writer,i.default.spreadsheet,i.default.presentation].includes(window.officeType);function l(){return window.APP.getSecurityDocPermission()||{}}function s(){return 1===l().doctype}t.isSupportSecurityDoc=a,t.isEditLimitedSecurityDoc=function(){return s()&&!(!0===l().edit)},t.isCopyLimitedSecurityDoc=function(){return s()&&!(!0===l().copy)},t.isPrintLimitedSecurityDoc=function(){return s()&&!(!0===l().print)},t.requestForAuth=function(e){return void 0===e&&(e={type:o.EDIT}),window.__WPSPLUGIN__.loader.loadSingleInstance(r).then((function(t){return t.show(e.type)}))};var c=a&&!!window.__WPSPLUGIN__.loader.search(r);t.canRequestForAuthForSecurityDoc=c},491:function(e,t,n){"use strict";var i=n(300),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(23),f=n.n(d),p=n(238),h=n.n(p),m=n(480),v=function(e){function t(){return a()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){var e=o()(this.props,[]);return h.a.createElement(m.default,e)}}]),t}(p.Component);t.a=v},499:function(e,t,n){},500:function(e,t,n){},501:function(e,t,n){},5023:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(5),r=o.__importDefault(n(238)),a=o.__importDefault(n(258));n(7833),function(e){e.Dot="dot",e.Count="count",e.Custom="custom"}(i||(i={})),t.default=function(e){var t,n,o=e.className,l=e.show,s=void 0!==l&&l,c=e.color,u=void 0===c?"#ff4d4f":c,d=e.dot,f=e.count,p=e.content,h=e.children,m={backgroundColor:u},v=s;switch(!0){case d:t=i.Dot,n="";break;case void 0!==f:t=i.Count,n=f.toString();break;case void 0!==p:t=i.Custom,n=p;break;default:v=!1}var b=n;return o.includes("plugin-badge-layout")&&(b=r.default.createElement("span",null,n)),r.default.createElement("div",{className:"component-badge-wrapper"},h,r.default.createElement("sup",{className:(0,a.default)("component-badge",t,o,{"is-visible":v}),style:m},b))}},5024:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resize=t.getCursor=t.CursorType=void 0,t.CursorType={left:"ew-resize",right:"ew-resize",top:"ns-resize",bottom:"ns-resize",left_top:"nwse-resize",left_bottom:"nesw-resize",right_top:"nesw-resize",right_bottom:"nwse-resize"};t.getCursor=function(e,n){var i=n.left,o=n.top,r=n.right,a=n.bottom,l=e.x,s=e.y,c=null;if(l>=i-5&&l<=r+5&&s>=o-5&&s<=a+5){var u=l<=i+5?"left":"",d=l>=r-5?"right":"",f=s<=o+5?"top":"",p=s>=a-5?"bottom":"";u||d?(f=s<=o+10?"top":"",p=s>=a-10?"bottom":""):(f||p)&&(u=l<=i+10?"left":"",d=l>=r-10?"right":""),c=[u,d,f,p].filter(Boolean).join("_")}return t.CursorType[c]?c:null};var i=function(e,t){return e<=1?t*e:e||t};t.resize=function(e,t,n,o,r,a,l){void 0===l&&(l={minWidth:300,minHeight:280,maxWidth:1,maxHeight:1});var s,c,u,d,f=e.x-t.x,p=e.y-t.y,h=o.width,m=o.height,v=i(l.minWidth,o.width),b=i(l.minHeight,o.height),g=i(l.maxWidth,o.width),y=i(l.maxHeight,o.height),w=n.width,_=n.height;r.includes("left")&&(c=h-n.left-n.width,w=Math.min(h-c,w-f)),r.includes("right")&&(s=n.left,w=Math.min(h-s,w+f)),r.includes("top")&&(d=m-n.top-n.height,_=Math.min(m-d,_-p)),r.includes("bottom")&&(u=n.top,_=Math.min(m-u,_+p)),w=Math.max(v,w),_=Math.max(b,_),v<g&&w>g&&(w=g),b<y&&_>y&&(_=y),void 0===s&&void 0===c&&(s=n.left),void 0===u&&void 0===d&&(u=n.top),a({left:s,top:u,right:c,bottom:d,width:w,height:_})}},510:function(e,t,n){"use strict";var i=n(30),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(23),f=n.n(d),p=(n(651),n(238)),h=n.n(p),m=n(167),v=n(240),b=n(246),g=n(227),y=n(428),w=n(571),_=n(628),E=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,o=n.props.triggerElement;!i||i.contains(t)||_.inTriggerElement(o,e)||w.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=h.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,this.observer=new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})),this.observer.observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){var e=this;setTimeout((function(){e.props.autoClose&&e.props.onClose()}))}},{key:"handleWindowKeyDown",value:function(e){b.getKey(e)===b.Keys.Esc&&(w.b(this.level+1)||(Object(v.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){m.isPad&&window.performance.now()-this.timestamp<=300||this.handleClose(e)}},{key:"handleWindowResize",value:function(e){var t=(e.detail||{}).isClosePanel;(void 0===t?null:t)||(m.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose())}},{key:"bindEvents",value:function(){this.observerPanel(),g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize),this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=_.getShowOrigin(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},o()(t,window.rightToLeft?"right":"left",0),o()(t,"top",0),t),i=this.props,r=i.placement,a=i.rect,l=i.distance,s=i.isAuto,c=i.triggerElement;if(c){var u=c.getBoundingClientRect(),d=u.top,f=u.bottom;a=Object.assign({},a,{top:d,bottom:f})}var p=_.getPositionStyle(r,e,a,l);return s&&(p=_.showFullPanel(p,e)),Object.assign(n,p),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},o()(n,window.rightToLeft?"right":"left",0),o()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var r=this.props,a=r.distance,l=r.isSetHeight;if(r.forceUpdate||!this.style){this.style=this.createStyle(t),l&&(this.style.height=_.getHeight(this.style.top,t,a));var s=t.getBoundingClientRect().height;Math.abs(s-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return h.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=w.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,o=e.className,r=this.state.visible,a=null;"function"==typeof t.type&&(a={isListenEvent:r});var l=h.a.cloneElement(t,a),s=this.getPanelStyle(),c=this.getAnimationOrigin(s),u=this.calcTransparentPlaceholder(c),d=w.c;return r&&(this.showAnimation&&(d+=" animation-fade-scaleY-in"),d+=" origin-"+c,o&&(d+=" "+o)),h.a.createElement("div",{ref:this.refPanel,className:d,style:s,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},u,l)}}]),t}(p.PureComponent);E.placementTypes=y.default,E.defaultProps={placement:y.default.bottomLeft,distance:0,offsetX:0,isSetHeight:!1,forceUpdate:!1,autoClose:!0},t.a=E},511:function(e,t,n){},513:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(262);n(589);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===a(r)?r:String(r)),i)}var o,r}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,i,a=u(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=a.call(this,e)).state={checked:e.checked,focus:!!e.focus,label:e.label},t}return t=d,(n=[{key:"componentDidUpdate",value:function(e){this.props.checked===e.checked&&this.props.focus===e.focus||this.setState({checked:this.props.checked,focus:this.props.focus})}},{key:"onFocus",value:function(){this.setState({focus:!0})}},{key:"onBlur",value:function(){this.setState({focus:!1})}},{key:"onChange",value:function(e){var t=this;if(e.target instanceof HTMLInputElement){var n=e.target.checked;this.setState({checked:n},(function(){t.props.onChange&&t.props.onChange(n,e)}))}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.indeterminate,a=e.style,s=e.alt,c=e.children,u=this.state,d=u.checked,f=u.focus,p=u.label,h=Object(r.a)("kd-checkbox",t),m=Object(r.a)("kd-checkbox-input",{"is-disabled":n,"is-checked":d,"is-indeterminate":i,"is-focus":f});return o.a.createElement("label",l({className:h,role:"checkbox"},s,{"aria-checked":this.state.checked,style:a}),o.a.createElement("span",{className:m},o.a.createElement("span",{className:"kd-checkbox-inner"}),o.a.createElement("input",{className:"kd-checkbox-original",type:"checkbox",checked:d,disabled:n,onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onChange:this.onChange.bind(this)})),o.a.createElement("span",{className:"kd-checkbox-label"},c||p))}}])&&s(t.prototype,n),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.Component);p.elementType="Checkbox",p.defaultProps={checked:!1,focus:!1};n(590);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==h(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===h(r)?r:String(r)),i)}var o,r}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(l,e);var t,n,i,a=b(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={options:t.props.value||[]},t}return t=l,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({options:e.value})}},{key:"onChange",value:function(e,t){var n=this.state.options.indexOf(e);t?-1===n&&this.state.options.push(e):this.state.options.splice(n,1),this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.options)}},{key:"render",value:function(){var e=this,t=this.state.options,n=o.a.Children.map(this.props.children,(function(n,i){if(!n)return null;var r=n.type.elementType;return"Checkbox"!==r&&"CheckboxButton"!==r?null:o.a.cloneElement(n,Object.assign({},n.props,{key:i,checked:n.props.checked||t.indexOf(n.props.value)>=0||t.indexOf(n.props.label)>=0,onChange:e.onChange.bind(e,n.props.value?n.props.value:0===n.props.value?0:n.props.label)}))})),i=Object(r.a)("kd-checkbox-group","kd-checkbox-group-".concat(this.props.layout),this.props.className);return o.a.createElement("div",{className:i,style:this.props.style},n)}}])&&m(t.prototype,n),i&&m(t,i),Object.defineProperty(t,"prototype",{writable:!1}),l}(i.Component);w.defaultProps={layout:"horizontal"},p.Group=w;t.default=p},548:function(e,t,n){},564:function(e,t,n){"use strict";var i,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getEditModeQueryPair=t.isNewFile=t.isEditEnterMode=t.closeReadingMode=t.isReadingMode=void 0;var a=n(5).__importStar(n(167)),l=n(14),s=!!(null===(r=null===(o=null===(i=window.__WPSENV__)||void 0===i?void 0:i.file_info)||void 0===o?void 0:o.file)||void 0===r?void 0:r.corp_id),c=a.isMobile;t.isReadingMode=function(){var e,t,n;return(null===(t=null===(e=window.APP)||void 0===e?void 0:e.isReadOnly)||void 0===t?void 0:t.call(e))&&"read"===(null===(n=window.__WPSENV__)||void 0===n?void 0:n.enterMode)&&s&&!c},t.closeReadingMode=function(){(0,l.setQuery)("enterMode","edit"),location.reload()},t.isEditEnterMode=function(){return"edit"===(0,l.getQuery)("enterMode")},t.isNewFile=function(){return"true"===(0,l.getQuery)("newFile")},t.getEditModeQueryPair=function(){return{enterMode:"edit"}}},565:function(e,t,n){"use strict";n.r(t);var i=n(13),o=n.n(i),r=n(24),a=n.n(r),l=n(1),s=n.n(l),c=n(2),u=n.n(c),d=n(22),f=n.n(d),p=n(23),h=n.n(p),m=n(238),v=n.n(m),b=n(240),g=n(250),y=n.n(g),w=function(e){function t(e){s()(this,t);var n=f()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=v.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return h()(t,e),u()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(b.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,o=e.children,r="panel-item",l=this.refDiv.current;l&&-1!==l.className.indexOf(" hover")&&(r+=" hover"),t&&(r+=" disabled"),n&&(r+=" selected");var s=void 0===o?"undefined":a()(o);return"string"!==s&&"number"!==s||(r+=" only-text"),i&&(r+=" "+i),r}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,r=e.children,a=e.getStyle,l=e.visible,s=e.dataKey,c=e.keepEdit,u=e.draggable,d=e.onMouseEnter,f=e.onMouseLeave,p=e.onDragEnter,h=e.onDragStart,m=e.onDragEnd,b=e.altHintKeep,g=e.altRole;if(!l)return!1;var w=this.getClassName(),_=a?a(i):null,E={};return d&&(E.onMouseEnter=d),f&&(E.onMouseLeave=f),v.a.createElement(y.a,o()({title:n},E),v.a.createElement("div",o()({ref:this.refDiv,id:t,className:w,style:_,role:g,"data-key":s||void 0,"data-keep-edit":c||void 0,"alt-hint-keep":b,draggable:u,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:h,onDragEnter:p,onDragEnd:m},E),r))}}]),t}(m.PureComponent);w.defaultProps={visible:!0,altRole:"option"},t.default=w},580:function(e,t,n){"use strict";n.r(t);var i=n(13),o=n.n(i),r=n(1),a=n.n(r),l=n(2),s=n.n(l),c=n(22),u=n.n(c),d=n(23),f=n.n(d),p=(n(937),n(238)),h=n.n(p),m=n(227),v=n(240),b=n(666),g=n(167),y=n(840),w=n(385),_=(n(938),n(248)),E=n(81),C=n(939),S=_.default.types.size16,k=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return n=i=u()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.state={isEmpty:!1,isFocus:!1},i.handleInputChange=function(){if(!i.isChineseInputting){var e=i.refInput.current.value;!!i.props.data?i.customChange(e):i.defaultChange(e)}},i.keyword="",i.defaultChange=Object(E.debounce)((function(e){if(i.refInput.current){var t=i.getContentElement();if(t){var n=i.props,o=n.flexHeight,r=n.onChange,a=e.toLowerCase();o||(a?i.keyword||(t.style.height=t.offsetHeight+"px"):t.style.height="");for(var l=[],s=t.querySelectorAll(".component-menu-item"),c=void 0,u=0;u<s.length;u++){var d=s[u],f=d.innerText.trim(),p=-1!==f.toLowerCase().indexOf(a),h="";p?(l.push(f),Object(b.removeClass)(d,"disabled")):(Object(b.addClass)(d,"disabled"),h="none"),d.style.display=h,!c&&p&&(c=d)}if(i.setState({isEmpty:!l.length}),a&&c)Object(b.addHoverItem)(c);else{var m=t.querySelector(".component-menu-item.hover");m&&Object(b.removeHoverItem)(m)}i.keyword=e,r(e,l)}else console.error("搜索框必须在panel/panel-header内才支持搜索")}}),100),i.customChange=Object(E.debounce)((function(e){var t=Object(C.search)(e,i.props.data);i.setState({isEmpty:!t.length}),i.props.onChange(e,t)}),100),i.isChineseInputting=!1,i.handleCompositionStart=function(){i.isChineseInputting=!0},i.handleCompositionEnd=function(){i.isChineseInputting=!1,i.handleInputChange()},i.handleFocus=function(){i.setState({isFocus:!0})},i.handleBlur=function(){i.setState({isFocus:!1})},i.refDiv=h.a.createRef(),i.refInput=h.a.createRef(),o=n,u()(i,o)}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.focus()}},{key:"focus",value:function(){this.refInput.current.focus()}},{key:"getContentElement",value:function(){return this.refDiv.current.parentElement}},{key:"render",value:function(){var e=this.state,t=e.isEmpty,n=e.isFocus,i=Object(p.classNames)({"component-menu-search":1,focus:n});return h.a.createElement("div",{className:"menu-search",ref:this.refDiv},h.a.createElement("div",{className:i},h.a.createElement(_.default,{type:S.menu_search}),h.a.createElement("input",{ref:this.refInput,type:"text",maxLength:500,"data-keep-wsad":!0,placeholder:this.props.placeholder,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onChange:this.handleInputChange,onFocus:this.handleFocus,onBlur:this.handleBlur})),t&&h.a.createElement("div",{className:"component-menu-empty"},h.a.createElement("div",{className:"empty-content"},_i18n("applications.public.components.general.Menu.MenuSearch.empty", "No search results yet"))))}}]),t}(p.PureComponent);k.defaultProps={placeholder:_i18n("applications.public.components.general.Menu.MenuSearch.placeholder", "Search worksheet"),onChange:function(){}};var O=k,P=function(e){function t(e){a()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isEmpty:!1,height:null},n.setPanelHeight=function(){var e=n.props,t=e.showSearch,i=e.autoHeight;if(Object(b.checkCanSetSize)(t,i)){var o=n.refPanel.current.offsetHeight;n.setState({height:o})}},n.scrollSelectedChildren=function(){var e=n.refContent.current;if(e)for(var t=0;t<e.childElementCount;t++){var i=e.children[t];if(i.classList.contains("selected")){i.scrollIntoViewIfNeeded();break}}},n.handleSearch=function(e,t){var i=n.props.onSearch,o=void 0===i?function(){}:i;n.setState({isEmpty:!t.length}),o(e,t),n.setPreSelectItem(!0,null)},n.focus=function(){n.props.showSearch&&n.refSearch.current&&!g.isPad?n.refSearch.current.focus():n.refPanel.current.focus()},n.getStyle=function(){var e=n.props,t=e.showSearch,i=e.autoHeight,r=e.style,a=n.state.height,l={};return r&&(l=r),Object(b.checkCanSetSize)(t,i)?o()({},r,{height:a}):l},n.refPanel=h.a.createRef(),n.refSearch=h.a.createRef(),n.refContent=h.a.createRef(),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.officeType=Object(v.getPageOfficeType)(),n}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.refPanel.current&&(e.focus(),e.scrollSelectedChildren(),e.setPanelHeight())}),10)}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"handleKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if((!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))&&!window.__WPSENV__.altStatus)switch(e.keyCode){case 13:var i=this.getHoverItem();i&&(Object(v.stopBubble)(e),i.click());break;case 38:case 40:var o=38===e.keyCode;this.setPreSelectItem(o,e);break;case 9:case 39:var r=this.getHoverItem();if(r){Object(v.stopBubble)(e);var a={visible:!0,element:r,parent:this.refPanel.current};m.default.dispatchEvent(m.default.names.SUB_MENU_VISIBLE_CHANGE,a)}break;case 37:Object(v.stopBubble)(e),this.props.onLeftArrow&&this.props.onLeftArrow()}}}},{key:"handleMouseMove",value:function(e){var t=this.refPanel.current;if(!t.contains(document.activeElement)&&t.contains(e.target)&&t.focus(),this.props.onItemHover){var n=this.getHoverItem();this.props.onItemHover(n,t)}window.__WPSENV__.altStatus&&m.default.dispatchEvent(m.default.names.EXIT_ALT_MODE,e)}},{key:"handleMouseOut",value:function(){if(this.props.onItemHover){var e=this.getHoverItem();this.props.onItemHover(e,this.refPanel.current)}}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("component-menu-item");if(n.length){Object(v.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);if(o.classList.add("hover"),o.scrollIntoViewIfNeeded(),i!==o){var r={visible:!1,element:i,parent:this.refPanel.current};m.default.dispatchEvent(m.default.names.SUB_MENU_VISIBLE_CHANGE,r)}this.props.onItemHover&&this.props.onItemHover(o,this.refPanel.current)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var r=i-1;r>=0;r--)if(-1===t[r].className.indexOf("disabled")){i=r;break}}else for(var a=i+1;a<t.length;a++)if(-1===t[a].className.indexOf("disabled")){i=a;break}return t[Math.max(0,i)]}},{key:"preSelectFirst",value:function(){this.setPreSelectItem(!0,null),this.refPanel.current.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.isAuto,i=e.children,o=e.onScroll,r=e.onMouseEnter,a=e.showSearch,l=e.data,s=e.selectable,c=this.state.isEmpty,u=Object(p.classNames)({"wo-component-menu":1,"show-empty":c,selectable:s});n&&(u+=" "+this.officeType),t&&(u+=" "+t);var d=this.getStyle();return h.a.createElement("div",{ref:this.refPanel,className:u,tabIndex:0,style:d,onKeyDown:this.handleKeyDown,onScroll:o,onMouseMove:this.handleMouseMove,onMouseEnter:r,onMouseOut:this.handleMouseOut},a&&h.a.createElement(O,{ref:this.refSearch,data:l,onChange:this.handleSearch}),h.a.createElement("div",{ref:this.refContent,className:"menu-content"},i))}}]),t}(p.PureComponent);P.Divider=y.a,P.Item=w.default,P.Search=O,P.defaultProps={isAuto:!0,enabledHotKey:!0};t.default=P},5852:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={openshare:"openshare"}},589:function(e,t,n){},590:function(e,t,n){},608:function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=(n(432),n(238)),f=n.n(d),p=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"render",value:function(){return f.a.createElement("div",{className:"divider-line"})}}]),t}(d.PureComponent);t.a=p},616:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=n(227),h=n(240),m=n(450),v=n(321),b=n(580),g=v.default.triggerTypes,y=function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.isUnmount=!1,n.preSelectFirst=!1,n.delayShowSubMenuTimer=null,n.isMouseOut=!1,n.refDiv=f.a.createRef(),n.refMenu=f.a.createRef(),n.refDropDownBtn=f.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.onMouseLeaveDropBtn=n.onMouseLeaveDropBtn.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleSubMenuVisible=n.handleSubMenuVisible.bind(n),n.handleSubMenuLeftArrow=n.handleSubMenuLeftArrow.bind(n),n.startDelayVisibleChange=n.startDelayVisibleChange.bind(n),n.clearDelayShowSubMenu=n.clearDelayShowSubMenu.bind(n),n.onMouseEnterMenu=n.onMouseEnterMenu.bind(n),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){window.addEventListener(p.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.addEventListener(p.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.removeEventListener(p.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.removeEventListener(p.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"handleSubMenuVisible",value:function(e){var t=e.detail,n=t.visible,i=t.element,o=t.parent;i===this.refDiv.current&&(n?(this.isMouseOut=!1,this.state.visible?this.refMenu.current.preSelectFirst():(this.preSelectFirst=!0,this.parentNode=o,this.refDiv.current.click())):this.state.visible&&(this.setState({visible:!1}),this.parentNode&&this.parentNode.focus()))}},{key:"startDelayVisibleChange",value:function(e){var t=this;e?(p.default.dispatchEvent(p.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.props.disableDelayShow?this.handleVisibleChange(!0):this.delayShowSubMenuTimer=setTimeout((function(){t.handleVisibleChange(!0)}),250)):this.handleVisibleChange(!1)}},{key:"clearDelayShowSubMenu",value:function(){clearTimeout(this.delayShowSubMenuTimer)}},{key:"handleVisibleChange",value:function(e){var t=this;if(!this.isUnmount){if(!e&&this.state.visible){var n=Object(m.a)(this.refDiv.current);if(Object(m.b)(n+2))return;this.props.onItemHover&&this.props.onItemHover(null,null)}this.setState({visible:e},(function(){e&&t.preSelectFirst&&(t.preSelectFirst=!1,t.refMenu.current.preSelectFirst()),e||t.isMouseOut&&t.refDiv.current.classList.remove("hover"),t.props.onVisibleChange&&t.props.onVisibleChange(e)}))}}},{key:"handleMouseMove",value:function(){this.isMouseOut=!1,this.activateSubMenuHover()}},{key:"onMouseLeaveDropBtn",value:function(){this.clearDelayShowSubMenu(),this.props.useMouseLeaveHover&&(this.isMouseOut=!0,this.state.visible||this.refDiv.current.classList.remove("hover"))}},{key:"activateSubMenuHover",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"onMouseEnterMenu",value:function(){p.default.dispatchEvent(p.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.activateSubMenuHover()}},{key:"handleMouseOut",value:function(e){this.isMouseOut=!0,this.state.visible||Object(h.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"handleSubMenuLeftArrow",value:function(){var e=this;this.props.onItemHover&&this.props.onItemHover(null,null),this.setState({visible:!1},(function(){e.refDiv.current.focus()}))}},{key:"getClassName",value:function(){var e=this.props,t=e.visible,n=e.selected,i=e.disabled,o=e.className,r="component-menu-item sub-menu-item";o&&(r+=" "+o);var a=this.refDiv.current;return(t||a&&-1!==a.className.indexOf(" hover"))&&(r+=" hover"),n&&(r+=" selected"),this.state.visible&&(r+=" sub-visible"),i&&(r+=" disabled"),r}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.subClassName,o=e.destroyOnHide,r=e.trigger,a=e.onItemHover,l=e.showScrollBar,s=e.offsetX,c=e.disableContentMouseLeave,u=e.placement,d=e.enabledHotKey,p=e.altHintKeep,h=e.altForceDirection,m=e.altRole,g=e.selectable,y=e.panelClass,w=e.onMouseEnterBtn,_=e.isAuto,E=this.state.visible,C=this.getClassName(),S=f.a.createElement(b.default,{selectable:g,ref:this.refMenu,className:i,isAuto:_,showScrollBar:l,onItemHover:a,onMouseEnter:this.onMouseEnterMenu,onLeftArrow:this.handleSubMenuLeftArrow,enabledHotKey:d},t);return f.a.createElement(v.default,{isAuto:!0,panel:S,visible:E,distance:0,offsetX:s,trigger:r,destroyOnHide:o,onVisibleChange:this.startDelayVisibleChange,onMouseLeaveDropBtn:this.onMouseLeaveDropBtn,placement:u,disableContentMouseLeave:c,panelClass:y,onMouseEnter:w,ref:this.refDropDownBtn},f.a.createElement("div",{ref:this.refDiv,className:C,tabIndex:0,role:m,"alt-hint-keep":p||"true","alt-force-direction":h,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut},n))}}]),t}(d.PureComponent);y.triggerTypes=g,y.defaultProps={trigger:g.hover,offsetX:8,placement:v.default.placementTypes.rightBottom,altRole:"option"},t.default=y},628:function(e,t,n){"use strict";n.r(t),n.d(t,"getPositionStyle",(function(){return a})),n.d(t,"showFullPanel",(function(){return l})),n.d(t,"getHeight",(function(){return s})),n.d(t,"getShowOrigin",(function(){return c})),n.d(t,"inTriggerElement",(function(){return u}));var i=n(13),o=n.n(i),r=n(428);var a=function(e,t,n,i){n=function(e){var t=o()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var a=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case r.default.topCenter:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body.clientHeight,a=t.left+t.width/2-i/2,l=t.top-n,s=r-t.bottom-n,c=t.top-n-o,u=t.bottom+n;return{left:a,top:l>=o?c:s>=o?u:l>=50||l>=s?c:u}}(t,n,i);break;case r.default.topRight:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:h>=o?v:p>=o||p>=50||p>=h?m:v}}(t,n,i);break;case r.default.topLeft:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=c>=i?d:s>=i||s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:h>=o?v:p>=o||p>=50||p>=h?m:v}}(t,n,i);break;case r.default.bottomLeft:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.left,c=t.right,u=t.left,d=t.right-i,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case r.default.bottomRight:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=t.right,c=a-t.left,u=t.right-i,d=t.left,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.bottom-n,h=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case r.default.rightBottom:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,f=void 0;f=s>=i?u:c>=i?d:s>=50||s>=c?u:d;var p=l-t.top,h=t.bottom,m=t.top,v=t.bottom-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;case r.default.leftBottom:a=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,r=document.body,a=r.clientWidth,l=r.clientHeight,s=a-t.right-n,c=t.left-n,u=t.right+n,d=t.left-n-i,f=void 0;f=c>=i?d:s>=i||s>=50||s>=c?u:d;var p=l-t.top,h=t.bottom,m=t.top,v=t.bottom-o;return{left:f,top:p>=o?m:h>=o?v:p>=50||p>=h?m:v}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(a.right=document.body.clientWidth-a.left-t.offsetWidth,delete a.left),a},l=function(e,t){var n=e.left,i=e.right,o=e.top,r=t.offsetWidth,a=t.offsetHeight,l=document.body,s=l.clientWidth,c=l.clientHeight;return window.rightToLeft?(i+r+4>s&&(i=s-r-4),i=Math.max(4,i)):(n+r+4>s&&(n=s-r-4),n=Math.max(4,n)),o+a+4>c&&(o=c-a-4),o=Math.max(4,o),window.rightToLeft?{right:i,top:o}:{left:n,top:o}},s=function(e,t,n){var i=document.body.clientHeight,o=i-e-n;return e<0&&(o=i-2*n),t.offsetHeight<o?void 0:o},c=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var o=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(o>=n.top+n.height/2?"bottom":"top")},u=function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,o=i.pageX,r=i.pageY;return o>=n.left&&o<=n.right&&r>=n.top&&r<=n.bottom}return!1}},6283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),t.c={ExportImg:"ExportImg",ExportPdf:"ExportPdf",exportPdfToCloud:"exportPdfToCloud",exportPdfToLocal:"exportPdfToLocal",ExportOfd:"ExportOfd",ExportDoc:"ExportDoc",FileRename:"FileRename",FileSlim:"FileSlim",HistoryRecord:"HistoryRecord",HistoryVersion:"HistoryVersion",Print:"Print",SaveAsCopy:"SaveAsCopy",SaveVersion:"SaveVersion",ImmersionMode:"ImmersionMode",OnlineMode:"OnlineMode",EnterDraft:"EnterDraft",ExitDraft:"ExitDraft",ExportAsSheet:"ExportAsSheet",AtMessageBtnItem:"AtMessageBtnItem",PlayMode:"PlayMode",PlayModeCurrentItem:"PlayModeCurrentItem",PlayModeFirstItem:"PlayModeFirstItem",PlayModeAutoItem:"PlayModeAutoItem",PlayModeExplainItem:"PlayModeExplainItem",WOAChatItem:"WOAChatItem",MeetingItem:"MeetingItem",MessageItem:"Message",Blame:"Blame",HistoryComment:"HistoryComment",FullWidth:"FullWidth",Publish:"Publish",Proofread:"Proofread",SaveAsKsheet:"SaveAsKsheet",PersonPreference:"PersonPreference",RecentChange:"RecentChange",LatestChange:"LatestChange",Trace:"Trace",Cell:"Cell",Today:"Today",ThreeDay:"ThreeDay",SevenDay:"SevenDay",UpgradeKsheet:"UpgradeKsheet"};var i=["Share","TemplateShare","Publish","SendPhone","ShareForPicture","ExportPdf","FileInfo","FileSlim"],o=["PlayMode","FullWidth","FileInfo"]},6284:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=n(965),h=n(5023),m=n.n(h),v=(n(1817),function(e){function t(e){o()(this,t);var n=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={badgeConfig:{isShowBadge:!1,isNoDisturbing:!1,msgCount:""}},n.uiType=n.props.uiType||"",n.msgManager=null,n.updateCallback=n.updateCallback.bind(n),n}return u()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"init",value:function(){this.msgManager=p.a.getInstance({updateCallback:this.updateCallback,uiType:this.uiType});var e=this.msgManager.getBadgeDataByUIType(this.uiType);this.setState({badgeConfig:e})}},{key:"updateCallback",value:function(){var e=this.msgManager.getBadgeDataByUIType(this.uiType);this.setState({badgeConfig:e})}},{key:"renderBadgeLayout",value:function(e,t,n){var i=this.props.isMustDot,o=e.isShowBadge,r=e.msgCount,a=e.isNoDisturbing,l=r>99?"99+":r,s="";o&&r>0?a||i||(s=r<10?"circle-digit-layout":r>9&&r<100?"double-digit-layout":"double-digit-layout max-digit-layout"):(o=!1,r="");var c="plugin-badge-layout "+s+" "+t;return f.a.createElement(m.a,{show:o,dot:a||i,count:l,className:c,color:"#EB5451"},n)}},{key:"renderPureBadgeLayout",value:function(e,t){var n=this.props,i=n.visible,o=n.isMustDot,r="plugin-badge-layout "+e;return f.a.createElement(m.a,{show:i,dot:o,className:r},t)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,i=void 0===n?"":n,o=e.visible,r=this.state.badgeConfig;return o?this.renderPureBadgeLayout(i,t):r?this.renderBadgeLayout(r,i,t):t}}]),t}(d.PureComponent));t.default=v},6285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Size=t.IAnimation=void 0;var i=n(5);n(6286);var o,r,a=i.__importStar(n(238)),l=i.__importDefault(n(893)),s=n(6287),c=n(240),u=n(167),d=n(656);!function(e){e[e.small=360]="small",e[e.medium=480]="medium",e[e.large=720]="large"}(o||(o={})),t.Size=o,function(e){e.fadeIn="fade",e.bounceIn="bounce"}(r||(r={})),t.IAnimation=r;var f=(0,s.getResizeConfig)(u.isPad?20:10,u.isPad?24:16,u.isPad?-15:-5),p=function(e){function t(t){var n=e.call(this,t)||this;return n.onResizeStart=function(e,t,i){var o,r=n.props,a=r.getContainer,l=r.resizeLimit;t&&(i=i.touches[0]);var u={x:i.clientX,y:i.clientY},d=null===(o=n.getElement())||void 0===o?void 0:o.getBoundingClientRect(),f=((null==a?void 0:a())||document.body).getBoundingClientRect(),p=!1,h=function(i){(0,c.stopBubble)(i),t&&(i=i.touches[0]);var o={x:i.clientX,y:i.clientY};p=p||Math.abs(o.x-u.x)>5||Math.abs(o.x-u.y)>5;(0,s.resize)(o,u,d,f,e,(function(e){n.setState({style:e},(function(){var e,t;null===(t=(e=n.props).onResize)||void 0===t||t.call(e,!1,p)}))}),l)},m=function(e){var i,o;(0,c.stopBubble)(e),null===(o=(i=n.props).onResize)||void 0===o||o.call(i,!0,p),t?(document.ontouchmove=null,document.ontouchend=null):(document.onmousemove=null,document.onmouseup=null)};t?(document.ontouchmove=h,document.ontouchend=m):(document.onmousemove=h,document.onmouseup=m)},n.refModal=a.default.createRef(),n.state={style:t.style},n}return i.__extends(t,e),t.prototype.componentDidUpdate=function(e){(0,d.checkObjEqual)(e.style,this.props.style)||this.setState({style:this.props.style})},t.prototype.getElement=function(){var e;return null===(e=this.refModal.current)||void 0===e?void 0:e.getElement()},t.prototype.render=function(){var e=this,t=this.props,n=t.title,i=t.children,o=t.resize,r=t.visible,s=t.mask,c=t.draggable,u=t.footer,d=t.closable,p=t.needUpdateStyle,h=t.className,m=t.size,v=t.okDisabled,b=t.zIndex,g=t.cancelText,y=t.maskClosable,w=t.destroyOnClose,_=t.animation,E=t.alignCenter,C=t.okText,S=t.okBtnText,k=t.cancelDisabled,O=t.tabIndex,P=t.okButtonProps,M=t.cancelButtonProps,T=t.getContainer,I=t.onOk,D=t.onClose,N=t.onEnter,L=t.onCancel,R=t.onDragMove,x=this.state.style,H=a.default.classNames({"wo-modal":1,resize:o},h),j=Object.assign({},P,{disabled:v}),W=Object.assign({},M,{disabled:k});return a.default.createElement(l.default,{ref:this.refModal,className:H,title:n,style:x,position:x,visible:r,mask:s,size:m,animation:_,draggable:c,footer:u,closable:d,zIndex:b,alignCenter:E,cancelText:g,okText:S||C,tabIndex:O,okButtonProps:j,cancelButtonProps:W,destroyOnClose:w,maskClosable:y,onOk:I,onClose:D,onEnter:N,onPressEsc:D,onCancel:L,onDragMove:R,needUpdateStyle:p,getContainer:T},i,o&&f.map((function(t){return a.default.createElement("div",{key:t.type,className:"resize-hand ".concat(t.type),style:t.style,onTouchStart:e.onResizeStart.bind(e,t.type,!0),onMouseDown:e.onResizeStart.bind(e,t.type,!1)})})))},t.defaultProps={draggable:!0,needUpdateStyle:!0},t}(a.PureComponent);t.default=p},6286:function(e,t,n){},6287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resize=t.getResizeConfig=void 0;var i=n(5024);Object.defineProperty(t,"resize",{enumerable:!0,get:function(){return i.resize}});t.getResizeConfig=function(e,t,n){void 0===e&&(e=10),void 0===t&&(t=16),void 0===n&&(n=-5);var i=t+n;return[{type:"left",style:{left:n,top:i,bottom:i,width:e}},{type:"right",style:{right:n,top:i,bottom:i,width:e}},{type:"top",style:{top:n,left:i,right:i,height:e}},{type:"bottom",style:{bottom:n,left:i,right:i,height:e}},{type:"left-top",style:{left:n,top:n,width:t,height:t}},{type:"left-bottom",style:{left:n,bottom:n,width:t,height:t}},{type:"right-top",style:{right:n,top:n,width:t,height:t}},{type:"right-bottom",style:{right:n,bottom:n,width:t,height:t}}]}},629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Size=void 0;var i=n(5);n(1172);var o,r=i.__importStar(n(238)),a=i.__importDefault(n(1056)),l=i.__importDefault(n(252));!function(e){e.small="small",e.middle="middle"}(o||(o={})),t.Size=o;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refWrap=r.default.createRef(),t.refSwitch=r.default.createRef(),t.handleClick=function(e){e.preventDefault();var n=t.props,i=n.checked,o=n.onChange;!n.disabled&&o&&(t.refWrap.current.scrollIntoViewIfNeeded(),o(!i))},t}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,n=e.disabled,o=e.title,s=e.tabIndex,c=e.children,u=e.size,d=e.altRole,f=e.altScPosition,p=i.__rest(e,["checked","disabled","title","tabIndex","children","size","altRole","altScPosition"]),h=r.default.classNames({"wo-switch":1}),m=n?null:o;return r.default.createElement(l.default,{title:m},r.default.createElement("div",{ref:this.refWrap,className:h,tabIndex:s,role:d,"alt-sc-position":f,onClick:this.handleClick},r.default.createElement(a.default,i.__assign({ref:this.refSwitch,className:"switch-button",checked:t,size:u,disabled:n},p)),c&&r.default.createElement("div",{className:"switch-content"},c)))},t.defaultProps={size:o.small,allowFocus:!1,onFocus:Function.prototype,onBlur:Function.prototype},t}(r.PureComponent);t.default=s},650:function(e,t,n){},651:function(e,t,n){},656:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkObjEqual=void 0,t.checkObjEqual=function(e,t){if(null==e||null==t)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(e.constructor!==t.constructor)return!1;if(e instanceof Function)return!1;if(e instanceof RegExp)return!1;if(e instanceof Date)return!1;if(Array.isArray(e))return e.length===t.length&&e.every((function(e,n){return e===t[n]}));if(!(e instanceof Object&&t instanceof Object))return!1;var n=Object.keys(e),i=Object.keys(t);return n.length===i.length&&i.every((function(n){return e[n]===t[n]}))}},666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkCanSetSize=t.removeHoverItem=t.addHoverItem=t.removeClass=t.addClass=void 0;var i=null;t.addClass=function(e,t){e.classList.add(t)};t.removeClass=function(e,t){e.classList.remove(t)};t.addHoverItem=function(e){i!==e&&(i&&(0,t.removeClass)(i,"hover"),i=e,(0,t.addClass)(e,"hover"))};t.removeHoverItem=function(e){i===e&&((0,t.removeClass)(i,"hover"),i=null)};t.checkCanSetSize=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),e&&!t}},667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSafeState=t.useAsyncHttpRequest=t.useUnload=t.useWindowEvent=t.useEventCallback=void 0;var i=n(5),o=n(238);t.useEventCallback=function(e,t){void 0===t&&(t=[]);var n=(0,o.useRef)((function(e){console.log("Cannot call an event handler while rendering.",e)}));return(0,o.useEffect)((function(){n.current=e}),i.__spreadArray([e],t,!0)),(0,o.useCallback)((function(e){return(0,n.current)(e)}),[n])};t.useWindowEvent=function(e,n,i){var r=(0,t.useEventCallback)(n);(0,o.useEffect)((function(){return window.addEventListener(e,r,i),function(){window.removeEventListener(e,r,i)}}))};t.useUnload=function(e){var t=(0,o.useRef)(!1),n=(0,o.useRef)(!1);return(0,o.useEffect)((function(){return n.current=!0,function(){t.current=!0,e&&"function"==typeof e&&e()}}),[]),{mount:function(){return n.current},unload:function(){return t.current}}},t.useAsyncHttpRequest=function(e){var n=e.onLoad,i=e.onError,r=e.onProcess,a=e.options,l=(0,o.useRef)(window.__WPSENV__.asyncRequest(a)),s=(0,o.useCallback)((function(){l.current.abort()}),[]);return(0,t.useUnload)(s),(0,o.useEffect)((function(){var e=l.current;i&&(e.onerror=i),r&&(e.onprogress=r),n&&(e.onload=n)}),[]),l.current};t.useSafeState=function(e){var t=(0,o.useState)(e),n=t[0],i=t[1],r=(0,o.useRef)(!0);return(0,o.useEffect)((function(){return function(){r.current=!1}}),[]),[n,(0,o.useCallback)((function(e){r.current&&i(e)}),[])]}},681:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(603),a=n(262);n(857);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function c(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,f(i.key),i)}}function f(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===l(t)?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},g=Object(r.a)("small","medium","large","x-large"),y=Object(r.a)("circle","square"),w={small:"sm",medium:"md",large:"lg","x-large":"xl"},_={medium:24,small:20,large:36,"x-large":48},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(l,e);var t,n,i,r=h(l);function l(){var e;return u(this,l),(e=r.apply(this,arguments)).prefixCls="kd-avatar",e}return t=l,(n=[{key:"render",value:function(){var e,t,n=this.props,i=n.className,r=n.size,l=n.shape,u=n.src,d=n.alt,f=n.icon,p=n.active,h=n.strokeWidth,m=void 0===h?2:h,v=n.strokeColor,E=void 0===v?"transparent":v,C=(n.isGroup,n.children),S=b(n,["className","size","shape","src","alt","icon","active","strokeWidth","strokeColor","isGroup","children"]),k=y.includes(l)?l:"circle",O=g.includes(r)?r:"medium",P="".concat(this.prefixCls,"-").concat(w[O]),M=Object(a.a)("".concat(this.prefixCls),i,P,(c(e={},"".concat(this.prefixCls,"-").concat(k),!!k),c(e,"".concat(this.prefixCls,"-image"),!!u),c(e,"".concat(this.prefixCls,"-icon"),!!f),c(e,"".concat(this.prefixCls,"-active"),p),e)),T=_[O];return t=u?o.a.createElement("img",{src:u,alt:d}):f||C,o.a.createElement("div",s({className:M},S),p&&"circle"===k&&o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",className:"kd-avatar-stroke",style:{width:T+8,height:T+8},viewBox:"0 0 ".concat(T+10," ").concat(T+10)},o.a.createElement("circle",{cx:(T+10)/2,cy:(T+10)/2,r:(T+8)/2,strokeWidth:m,stroke:E,fill:"#fff"})),o.a.createElement("div",{className:"".concat(this.prefixCls,"-wrap")},o.a.createElement("div",{className:"kd-avatar-content"},t)))}}])&&d(t.prototype,n),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),l}(i.Component);E.defaultProps={shape:"circle",size:"medium"};var C=E,S=n(303),k=n(425),O=Object(k.a)("more",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 8C1 7.30964 1.55964 6.75 2.25 6.75C2.94036 6.75 3.5 7.30964 3.5 8C3.5 8.69036 2.94036 9.25 2.25 9.25C1.55964 9.25 1 8.69036 1 8ZM6.75 8C6.75 7.30964 7.30964 6.75 8 6.75C8.69036 6.75 9.25 7.30964 9.25 8C9.25 8.69036 8.69036 9.25 8 9.25C7.30964 9.25 6.75 8.69036 6.75 8ZM13.75 6.75C13.0596 6.75 12.5 7.30964 12.5 8C12.5 8.69036 13.0596 9.25 13.75 9.25C14.4404 9.25 15 8.69036 15 8C15 7.30964 14.4404 6.75 13.75 6.75Z",fill:e.colors[0],vectorEffect:"non-scaling-stroke"}))}));function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,r=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==P(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===P(r)?r:String(r)),i)}var o,r}function I(e,t){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=L(e);if(t){var o=L(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return N(this,n)}}function N(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R={small:12,medium:16,large:20,"x-large":24},x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(a,e);var t,n,i,r=D(a);function a(){return M(this,a),r.apply(this,arguments)}return t=a,(n=[{key:"renderContent",value:function(){var e=this.props,t=e.shape,n=e.maxCount,i=e.size,r=e.showCount,a=e.children,l=Array.prototype.slice.call(a).map((function(e,n){return o.a.cloneElement(e,{key:"avatar-key-".concat(n),size:i,shape:t,isGroup:!0})})),s=l.length,c=l.slice(0,n);if(n&&n<s){var u=l.slice(n,s);if(r)c.push(o.a.createElement(C,{className:"kd-avatar-count",shape:t,size:i,key:"avatar-count"},u.length));else{var d=R[i]||16;c.push(o.a.createElement(C,{className:"kd-avatar-ellipsis",shape:t,size:i,key:"avatar-ellipsis"},o.a.createElement(O,{size:d})))}}return c}},{key:"render",value:function(){return o.a.createElement("div",{style:this.style(),className:this.className("kd-avatar-group")},this.renderContent())}}])&&T(t.prototype,n),i&&T(t,i),Object.defineProperty(t,"prototype",{writable:!1}),a}(S.a);x.defaultProps={size:"medium",maxCount:4},C.Group=x;t.default=C},687:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("info_normal",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},o.a.createElement("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",stroke:"none"})),o.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"white",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"white"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 13C8.55228 13 9 12.5523 9 12V7C9 6.44772 8.55228 6 8 6C7.44772 6 7 6.44772 7 7V12C7 12.5523 7.44772 13 8 13ZM7 4C7 4.55228 7.44772 5 8 5V5C8.55228 5 9 4.55228 9 4V4C9 3.44772 8.55228 3 8 3V3C7.44772 3 7 3.44772 7 4V4Z",stroke:"none"})))}))},688:function(e,t,n){"use strict";var i=n(238),o=n.n(i),r=n(425);t.a=Object(r.a)("tick",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none"},o.a.createElement("path",{d:"M3 7.97889L7 11.4997L13 4.99973",stroke:e.colors[0],strokeWidth:e.strokeWidth,strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,vectorEffect:"non-scaling-stroke"}))}))},706:function(e,t,n){"use strict";n.r(t),n.d(t,"controlTypes",(function(){return i})),n.d(t,"getIconStyle",(function(){return o}));var i={button:"button",dropdown:"dropdown"};function o(e){return e?{backgroundImage:"url("+e+")"}:null}},7257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5).__importDefault(n(10234)),o=n(10233),r=["kd-component-public-input-number","kd-component-public-icon-btn","kd-component-public-icon-text-btn","kd-component-public-text-btn","kd-component-public-input"];function a(e){return"INPUT"===e.tagName||function(e){return"TEXTAREA"===e.tagName||"true"===e.contentEditable}(e)}var l=null;t.default={panelCs:"kd-component-panel",isInput:a,isObject:function(e){var t=e+""===e,n=Number.parseFloat(e)===e;return!t&&!n},isInPanel:function(e){for(var t=e.parentElement;t&&1===t.nodeType;){if(t.classList.contains("kd-component-panel"))return!0;t=t.parentElement}return!1},closeCurrentDropdown:function(e){var t=(0,o.getParentPopupLevel)(e);t>0&&!function e(t){if(!t||t===document.body)return!1;if(a(t))return!0;var n=t.classList;return!!n&&(!!r.some((function(e){return n.contains(e)}))||e(t.parentElement))}(e)&&i.default.closeDropdown(t)},getParentPopupLevel:o.getParentPopupLevel,isEnabledElement:function(e){var t=e;return t.offsetHeight>0&&t.offsetWidth>0&&"none"!==window.getComputedStyle(t).pointerEvents},addHoverItem:function(e){l!==e&&(l&&l.classList.remove("hover"),l=e,e.classList.add("hover"))},removeHoverItem:function(e){l===e&&(l.classList.remove("hover"),l=null)}}},7258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=i.__importStar(n(238)),r=i.__importDefault(n(480)),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=i.__rest(this.props,[]);return o.default.createElement(r.default,i.__assign({},e))},t}(o.Component);t.default=a},7833:function(e,t,n){},7834:function(e,t,n){e.exports=function(e,t){n.e(577).then(n.bind(null,10462)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},7835:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AtMessageBtnplugin=t.initAtMessageBtnPlugin=t.pluginVisible=void 0;var i=window.__WPSPLUGIN__.helper,o=i.types.AtInBox,r=null;t.AtMessageBtnplugin=r,t.pluginVisible=i.has(o),t.initAtMessageBtnPlugin=function(e){t.pluginVisible&&window.__WPSPLUGIN__.loader.loadSingleInstance({pluginType:o}).then((function(n){t.AtMessageBtnplugin=r=n;var i=function(){};e&&(i=e.setCount),n.init({setCount:i})}))}},7836:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iconTypes=t.size16=void 0;var i=n(5);n(11534);var o=i.__importStar(n(238)),r=i.__importDefault(n(7257)),a=i.__importDefault(n(252)),l=i.__importDefault(n(3890)),s=i.__importStar(n(273));Object.defineProperty(t,"size16",{enumerable:!0,get:function(){return s.size16}}),Object.defineProperty(t,"iconTypes",{enumerable:!0,get:function(){return s.iconTypes}});var c=i.__importDefault(n(7258)),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=t.props,a=o.value,l=o.onClick;if(l){var s=n.find((function(e){return e&&e.preventDefault}));l(a,s),s.isDefaultPrevented()||r.default.closeCurrentDropdown(s.target),null===(e=t.getElement())||void 0===e||e.scrollIntoViewIfNeeded()}},t.refDiv=o.default.createRef(),t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.scrollIntoView()},t.prototype.componentDidUpdate=function(e){!e.selected&&this.props.selected&&this.scrollIntoView()},t.prototype.getElement=function(){return this.refDiv.current},t.prototype.scrollIntoView=function(){var e=this;this.props.selected&&this.props.needScrollIntoView&&setTimeout((function(){var t;e.refDiv.current&&(null===(t=e.getElement())||void 0===t||t.scrollIntoViewIfNeeded())}))},t.prototype.renderContent=function(){for(var e=this.props.children,t=o.default.Children.map(e,(function(e){return e})).filter((function(e){return 0===e||!!e})),n=[],i=[],a=[],l=0;l<t.length;l++){var s=t[l];r.default.isObject(s)?0===i.length?n.push(s):a.push(s):0===a.length?i.push(s):a.push(s)}var c="panel-item-content";return a.some((function(e){return!r.default.isObject(e)}))?o.default.createElement("div",{className:c},e):o.default.createElement("div",{className:c},n.length?n:null,!!i.length&&o.default.createElement("span",{className:"item-ellipse-text"},i),a.length?a:null)},t.prototype.render=function(){var e=this.props,t=e.iconType,n=e.selected,i=e.checked,r=e.icon,u=e.title,d=e.divider,f=e.disabled,p=e.className,h=e.id,m=e.getStyle,v=e.keepEdit,b=e.altHintKeep,g=e.dataKey,y=e.altRole,w=e.visible,_=e.value,E=e.onMouseEnter,C=e.onMouseLeave,S=e.onMouseDown;if(!w)return null;var k=o.default.classNames({"has-item-prefix":t},p),O=m?m(_):null;return o.default.createElement(o.default.Fragment,null,o.default.createElement(a.default,{title:u},o.default.createElement("div",{ref:this.refDiv,className:k,"data-key":g||void 0,"data-keep-edit":v||void 0,role:y,id:h,style:O,"alt-hint-keep":b,onMouseEnter:E,onMouseLeave:C,onMouseDown:S},o.default.createElement(l.default,{selected:n,disabled:f,checked:i,icon:r,onClick:this.handleClick},!!t&&o.default.createElement(s.default,{className:"item-prefix-icon",iconType:t}),this.renderContent()))),d&&o.default.createElement(c.default,null))},t.defaultProps={visible:!0,altRole:"option",needScrollIntoView:!0},t}(o.PureComponent);t.default=u},7837:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WOAChatPlugin=t.isWOAChatLoadSuccess=t.getBadgeVisible=t.getWOAChatPlugin=t.initWOAChatPlugin=t.WOAChatPluginEnabled=void 0;var i=window.__WPSPLUGIN__.type.WOAChat,o={pluginType:i},r=window.__WPSPLUGIN__.helper.has(i);t.WOAChatPluginEnabled=r;var a=null;t.WOAChatPlugin=a;var l;t.getBadgeVisible=function(){return!1};var s=!1;function c(){r&&!l&&(l=new Promise((function(e){window.__WPSPLUGIN__.loader.load(o).then((function(t){var n=new t({utils:{}});e(n.plugin)}))}))).then((function(e){t.isWOAChatLoadSuccess=s=!0,e.init(),t.WOAChatPlugin=a=e}))}t.isWOAChatLoadSuccess=s,t.initWOAChatPlugin=c,t.getWOAChatPlugin=function(){return r?l||(c(),l):Promise.reject("[".concat(i,"] is disabled."))}},7838:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLeftPadding=t.updateLeftMinWidth=t.observerContainer=t.onResize=t.MIDDLE_MIN_WIDTH=t.RIGHT_MIN_WIDTH=t.LEFT_MIN_WIDTH=void 0;var i=n(5).__importDefault(n(82)),o={k:420,s:420,o:0,w:350,f:280,p:350}[window.officeType];t.MIDDLE_MIN_WIDTH=o;t.RIGHT_MIN_WIDTH=200;var r=window.officeType===i.default.ksheet?220:190;t.LEFT_MIN_WIDTH=r;function a(e,t,n){var i=e.getBoundingClientRect().width;n&&(i-=265);var a=i<o+200+r?i-200-r:o,l={width:a},s=(i-o)/2,c={width:s=Math.max(s,200)},u=i-a-s<200?i-a-s:s;t({leftStyle:{width:u=Math.max(u,r)},middleStyle:l,rightStyle:c})}t.onResize=a,t.observerContainer=function(e,t){new MutationObserver((function(){a(e,t)})).observe(e,{childList:!0,subtree:!0})},t.updateLeftMinWidth=function(e){e&&(t.LEFT_MIN_WIDTH=r=324);var n=document.getElementById("kd-public-header-file-info");if(n){var i=n.getBoundingClientRect().width;t.LEFT_MIN_WIDTH=r=i+40+40}},t.setLeftPadding=function(e){var t=document.getElementById("wo-common-header");t&&(t.style.paddingLeft=e?"".concat(265,"px"):"0px")}},826:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("arrow_triangle_right",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},o.a.createElement("path",{d:"M6.02388 11.3974C5.57757 11.6763 5 11.3538 5 10.8257L5 5.1739C5 4.65395 5.5623 4.33063 6.00896 4.59322C7.70642 5.59114 8.96194 6.32925 10.6682 7.33234C11.1035 7.58824 11.1123 8.21756 10.684 8.48519L6.02388 11.3974Z",stroke:"none"})))}))},835:function(e,t){var n,i,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var s,c=[],u=!1,d=-1;function f(){u&&s&&(u=!1,s.length?c=s.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=l(f);u=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||l(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},840:function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),l=n(22),s=n.n(l),c=n(23),u=n.n(c),d=n(238),f=n.n(d),p=function(e){function t(){return o()(this,t),s()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),a()(t,[{key:"render",value:function(){var e=this.props.className,t="component-menu-divider";return e&&(t+=" "+e),f.a.createElement("div",{className:t})}}]),t}(d.PureComponent);t.a=p},857:function(e,t,n){},879:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),r=n(239);t.default=Object(r.a)("success_normal",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#00A147",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#00A147"},o.a.createElement("path",{d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",stroke:"none"})),o.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"white",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"white"},o.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.6011 5.19891C12.933 5.53086 12.933 6.06905 12.6011 6.40099L7.78121 11.2208C7.44926 11.5528 6.91107 11.5528 6.57913 11.2208L3.89898 8.5407C3.56704 8.20876 3.56704 7.67057 3.89898 7.33862C4.23093 7.00668 4.76912 7.00668 5.10107 7.33862L7.18017 9.41772L11.399 5.19891C11.7309 4.86696 12.2691 4.86696 12.6011 5.19891Z",stroke:"none"})))}))},937:function(e,t,n){},938:function(e,t,n){},939:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.search=void 0;var i=n(5);t.search=function(e,t){if(!e)return t.map((function(e){return e.value}));for(var n=[],o=[],r=[],a=e.toLowerCase(),l=0;l<t.length;l++){var s=t[l],c=s.name.toLowerCase();if(c!==a){var u=c.indexOf(a);0===u?o.push(s.value):-1!==u&&r.push(s.value)}else n.push(s.value)}return i.__spreadArray(i.__spreadArray(i.__spreadArray([],n,!0),o,!0),r,!0)}},956:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return c}));var i=n(146),o=n(1373),r=function(e){return{types:[i.HTTP_REQUEST,o.a.LOAD_UPDATE_NOTICES_SUCCESS,i.HTTP_FAILURE],callAPI:function(t){return t.get("/api/v3/office/tip/type/"+e).end()}}},a=function(e){return{types:i.HTTP_TYPES,callAPI:function(t){return t.get("/api/v3/office/tip/name/"+e).end()}}},l=function(e){return{types:i.HTTP_TYPES,callAPI:function(t){return t.post("/api/v3/office/tip/"+e).end()}}},s=null,c=function(e,t){var n={content:t};return{types:i.HTTP_TYPES,callAPI:function(t){return s&&s.abort(),(s=t.post("/api/v3/office/search/func/"+e).send(n)).end()}}}},965:function(e,t,n){"use strict";var i,o=n(24),r=n.n(o),a=n(1),l=n.n(a),s=n(2),c=n.n(s),u=function(){function e(){l()(this,e),this.badgeMap={},this.uiBadgeMap={},this.updateCallbackMap={}}return c()(e,[{key:"updatePluginMsg",value:function(e){var t=this;if(!this.checkMsgArgs(e))return!1;this.badgeMap[e.pluginId]=e,this.uiBadgeMap={},Object.values(this.badgeMap).map((function(e){t.uiBadgeMap[e.uiType]=e}));var n=this.updateCallbackMap[e.uiType];return Array.isArray(n)&&n.length&&n.forEach((function(e){"function"==typeof e&&e()})),!0}},{key:"checkMsgArgs",value:function(e){if(!e||"object"!==(void 0===e?"undefined":r()(e)))return console.warn("参数错误，消息数据类型应为Object"),!1;var t="Object{pluginId: string, uiType: string, isShowBadge: boolean, isNoDisturbing: boolean, msgCount: number}";return["pluginId","uiType","isShowBadge","isNoDisturbing","msgCount"].every((function(t){return![void 0,null,""].includes(e[t])}))?"string"==typeof e.pluginId&&"string"==typeof e.uiType&&"boolean"==typeof e.isShowBadge&&"boolean"==typeof e.isNoDisturbing&&"number"==typeof e.msgCount?!!/(^[0-9]\d*$)/.test(e.msgCount)||(console.warn("参数错误，msgCount应为大于等于0的整数，且不能超过20位"),!1):(console.warn("参数值类型错误，应为"+t),!1):(console.warn("缺少必须参数或参数值无效，应为"+t),!1)}},{key:"getBadgeDataByUIType",value:function(e){return this.uiBadgeMap[e]||null}},{key:"deletePluginMsg",value:function(e){delete this.badgeMap[e]}}]),e}();t.a=u,u.getInstance=(i=void 0,function(e){if(i||(i=new u),e&&e.updateCallback){var t=i.updateCallbackMap;Array.isArray(t[e.uiType])||(t[e.uiType]=[]),t[e.uiType].push(e.updateCallback)}return i})}}]);