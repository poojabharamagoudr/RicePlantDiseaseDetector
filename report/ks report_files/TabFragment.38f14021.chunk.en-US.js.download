(window.webpackJsonp=window.webpackJsonp||[]).push([[800,544,596],{1054:function(e,t,n){"use strict";n.r(t),n.d(t,"linkTypes",(function(){return r})),n.d(t,"getUrlByPlugin",(function(){return s}));var i=n(80),a=n.n(i),o=n(357),r={RangePermission:"RangePermission",Calculate:"Calculate",CellHistory:"CellHistory",AboutWps:"AboutWps",CellPicture:"CellPicture",AboutLaTeX:"AboutLaTeX",AboutFileSlim:"AboutFileSlim",FeedbackForm:"FeedbackForm",UncertainSubtotal:"UncertainSubtotal",RecordPermission:"RecordPermission",CoverProduction:"CoverProduction",WpsAIService:"WpsAIService",EtWpsAIWoa:"EtWpsAIWoa"},s=function(e){return new Promise((t=a()(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.default.has(o.default.types.Links)){t.next=6;break}return t.next=3,o.default.exec(o.default.types.Links,{type:e});case 3:return i=t.sent,n(i),t.abrupt("return");case 6:n(null);case 7:case"end":return t.stop()}}),t,void 0)}))),function(e){return t.apply(this,arguments)}));var t}},1056:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var i=n(238),a=n.n(i),o=n(262),r=(n(1173),n(488));function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,o=void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===s(o)?o:String(o)),i)}var a,o}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var a=p(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m={WIDTH:42,MAX_WIDTH:58,PADDING:3,TRANSLATE:21},f={WIDTH:28,MAX_WIDTH:44,PADDING:2,TRANSLATE:14},h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(u,e);var t,n,i,s=d(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).inputRef=a.a.createRef(),t.coreRef=a.a.createRef(),t.state={value:e.checked||!1,coreWidth:e.width||0,buttonStyle:{transform:""},isMount:!1},t}return t=u,(n=[{key:"componentDidMount",value:function(){var e=this;if(0===this.props.width){var t=m.WIDTH;return"small"===this.props.size&&(t=f.WIDTH),void this.setState({coreWidth:t},(function(){e.updateSwitch(),e.setState({isMount:!0})}))}this.updateSwitch(),this.setState({isMount:!0})}},{key:"componentDidUpdate",value:function(e){var t=this;e.checked!==this.props.checked&&this.setState({value:this.props.checked},(function(){t.updateSwitch()})),e.width!==this.props.width&&this.setState({coreWidth:this.props.width})}},{key:"updateSwitch",value:function(){this.handleButtonTransform(),(this.props.onColor||this.props.offColor)&&this.setBackgroundColor()}},{key:"setBackgroundColor",value:function(){var e=this.state.value===this.props.onValue?this.props.onColor:this.props.offColor;this.coreRef.current&&(this.coreRef.current.style.borderColor=e,this.coreRef.current.style.backgroundColor=e)}},{key:"handleChange",value:function(e){var t=this;this.setState({value:e.target.checked?this.props.onValue:this.props.offValue},(function(){t.updateSwitch(),t.props.onChange&&t.props.onChange(t.state.value)}))}},{key:"getTranslate",value:function(){var e=this.state.coreWidth,t=m.TRANSLATE,n=m.PADDING;return"small"===this.props.size&&(t=f.TRANSLATE,n=f.PADDING),{on:"translate(".concat(e-t,"px, ").concat(n,"px)"),off:"translate(".concat(n,"px, ").concat(n,"px)")}}},{key:"handleButtonTransform",value:function(){var e=this.state,t=e.value,n=e.buttonStyle,i=e.isMount,a=this.getTranslate();n.transform=t===this.props.onValue?a.on:a.off,n.transition=i?"transform .3s":"",this.setState({buttonStyle:n})}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.className,i=e.style,s=e.disabled,l=e.onValue,c=e.size,d=e.loading,u=this.state,p=u.value,m=u.coreWidth,f=u.buttonStyle,h=Object(o.a)("kd-switch",c&&"kd-switch--".concat(c),s&&"is-disabled",d&&"is-loading",p===l&&"is-checked",n),g="small"===c?"12":"18";return a.a.createElement("label",{className:h,style:i},a.a.createElement("input",{className:"kd-switch-input",type:"checkbox",checked:p===l,name:t,ref:this.inputRef,disabled:s||d,onChange:this.handleChange.bind(this)}),a.a.createElement("span",{className:"kd-switch-core",ref:this.coreRef,style:{width:m+"px"}},a.a.createElement("span",{className:"kd-switch-button",style:Object.assign({},f)},d&&a.a.createElement(r.a,{size:g,strokeWidth:"1"}))))}}])&&l(t.prototype,n),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component);h.defaultProps={checked:!1,disabled:!1,width:0,size:"",onValue:!0,offValue:!1,onColor:"",offColor:"",name:""}},1059:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("change_to_pic",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M1.81641 10.5706C3.23498 9.64808 3.97475 9.16094 5.39333 8.23847C5.93038 7.88923 6.64748 7.92724 7.14035 8.33105L9.28597 10.0126",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M7 14.25H3.25C2.42157 14.25 1.75 13.5784 1.75 12.75V3.25C1.75 2.42157 2.42157 1.75 3.25 1.75H12.75C13.5784 1.75 14.25 2.42157 14.25 3.25V9.00018",fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M12 5.25012C12 5.94048 11.4404 6.50012 10.75 6.50012C10.0596 6.50012 9.5 5.94048 9.5 5.25012C9.5 4.55977 10.0596 4.00012 10.75 4.00012C11.4404 4.00012 12 4.55977 12 5.25012Z",stroke:"none"})),a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M9.75 12.9998H14.25M14.25 12.9998L12.25 11.25M14.25 12.9998L12.25 14.75",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},10808:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(22),l=n.n(s),c=n(23),d=n.n(c),u=n(238),p=n.n(u),m=n(243),f=n.n(m),h=n(344),g=n(329),w=(n(16064),function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.onOk,n=e.onCancel,i=e.title,a=e.warnText;return p.a.createElement("div",{className:"component-modal-wrap dp-outofrange-warn"},p.a.createElement("div",{className:"component-modal dp-outofrange-warn-modal"},p.a.createElement("div",{className:"modal-body"},p.a.createElement("div",{className:"dialog-header dp-outofrange-warn-title "},p.a.createElement("div",{className:"header-title"},i),p.a.createElement(f.a,{size:"small",className:"close-btn",icon:p.a.createElement(h.default,{size:g.smallSize,fill:g.iGrey}),onClick:n})),p.a.createElement("div",{className:"dialog-content"},p.a.createElement("p",{className:"dp-outofrange-warn-content"},a)),p.a.createElement("div",{className:"dialog-foot"},p.a.createElement(f.a,{type:"primary",size:"large",isAuto:!0,onClick:t},_i18n("applications.writer.components.CommandBars.RbTab.Home.Dialog.confirm", "OK"))))))}}]),t}(u.PureComponent));t.a=w},10809:function(e,t,n){},1172:function(e,t,n){},1173:function(e,t,n){},1431:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("bubble_eye",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M14.25 7.49988V3.24988C14.25 2.42145 13.5784 1.74988 12.75 1.74988H3.25C2.42157 1.74988 1.75 2.42145 1.75 3.24988V14.1669C1.75 14.4109 2.02581 14.5529 2.22437 14.411L5.25 12.2499H6",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.61893 11.9999C8.83069 12.2792 9.18461 12.7036 9.63058 13.083C10.1883 13.5575 10.8173 13.8999 11.4442 13.8999C12.0712 13.8999 12.7002 13.5575 13.2579 13.083C13.7039 12.7036 14.0578 12.2792 14.2695 11.9999C14.0578 11.7207 13.7039 11.2963 13.2579 10.9169C12.7002 10.4424 12.0712 10.0999 11.4442 10.0999C10.8173 10.0999 10.1883 10.4424 9.63058 10.9169C9.18461 11.2963 8.83069 11.7207 8.61893 11.9999ZM8.91779 10.0791C9.55304 9.53861 10.4318 8.99994 11.4442 8.99994C12.4567 8.99994 13.3354 9.53861 13.9707 10.0791C14.616 10.6281 15.0854 11.2433 15.2884 11.529C15.4895 11.8123 15.4895 12.1876 15.2884 12.4708C15.0854 12.7566 14.616 13.3717 13.9707 13.9208C13.3354 14.4613 12.4567 14.9999 11.4442 14.9999C10.4318 14.9999 9.55304 14.4613 8.91779 13.9208C8.27243 13.3717 7.80306 12.7566 7.60008 12.4708C7.39893 12.1876 7.39893 11.8123 7.60008 11.529C7.80306 11.2433 8.27243 10.6281 8.91779 10.0791Z",stroke:"none"}),a.a.createElement("circle",{cx:"11.5",cy:"11.9999",r:"1",stroke:"none"})))}))},1470:function(e,t,n){"use strict";n.r(t),n.d(t,"UnitType",(function(){return l})),n.d(t,"UnitName",(function(){return c})),n.d(t,"UnitCNName",(function(){return d})),n.d(t,"UnitI18nName",(function(){return u}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(240),l={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},c=["pt","inc","cm","mm","ref","ti"],d=["磅","英寸","厘米","毫米","?","缇"],u=function(e,t){switch(e.toUpperCase()){case"EN-US":return["pt","inc","cm","mm","ref","ti"][t];case"AR":return["الرطل","بوصة","سم","مم","الصفوف","ti"][t];case"TH":return["ปอนด์","นิ้ว","ซม.","มม.","แถว","สีส้มอมแดง"][t];default:return["磅","英寸","厘米","毫米","?","缇"][t]}},p=function(){function e(t,n){a()(this,e),this.val=t,this.unit=n}return r()(e,[{key:"ti",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_ti])}},{key:"pt",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_pt])}},{key:"inc",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_inc])}},{key:"cm",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_cm])}},{key:"mm",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_mm])}}],[{key:"init",value:function(t,n){return new e(t,n)}}]),e}();t.default=p},16062:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageMarginSettingDialog=void 0;var i=n(5),a=i.__importStar(n(238)),o=i.__importDefault(n(1283)),r=n(7501),s=i.__importDefault(n(16926)),l=n(9932),c=i.__importDefault(n(260)),d=i.__importDefault(n(1276)),u=n(684),p=i.__importDefault(n(16066)),m=i.__importDefault(n(591)),f=i.__importStar(n(1470));n(16067);var h=0,g=1,w=2,v=3,b=4,C=[{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.allDOc", "Entire Document"),value:b,disabled:!1},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.afterCursor", "This Point Forward"),value:g,disabled:!1},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.currentSection", "This Section"),value:h,disabled:!1},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.selectedSection", "Selected Section"),value:w,disabled:!1},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.selectedText", "Selected Text"),value:v,disabled:!1}],E={t:f.default.init(Number.POSITIVE_INFINITY,f.UnitType.Unit_pt),l:f.default.init(Number.POSITIVE_INFINITY,f.UnitType.Unit_pt),r:f.default.init(Number.POSITIVE_INFINITY,f.UnitType.Unit_pt),b:f.default.init(Number.POSITIVE_INFINITY,f.UnitType.Unit_pt)},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={margins:r.DOC_PAGE_MARGIN_SIZE[r.DOC_PAGE_MARGIN_TYPE.Normal],mode:r.DOC_PAGE_MARGIN_TYPE.Normal,direct:l.DOC_PAPER_DIRECTION.Vertical,applyRangeValue:h,setMarginArgs:null,limit:null,limitWarn:-1},t.handlePageMarginSettingInWebMode=function(){return!!t.props.isWebMode&&(c.default.dispatchEvent(c.default.pcDialogs.WPS_SHOW_ALERT,{type:d.default.SwitchWebMode,data:{typoMode:u.TYPO_MODE.MODE_PC,funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.funcName", "Margins")}}),t.props.hasRangeSettings?t.props.closeDetailSetting():t.props.closeFunc(),!0)},t.onSelectionChanged=function(){var e=window.APP.data.selection.selInfo.getMaxMargin();t.setState({limit:e})},t.getKeyByPosType=function(e){switch(e){case r.DOC_PAGE_MARGIN_POS.TOP:return"t";case r.DOC_PAGE_MARGIN_POS.BOTTOM:return"b";case r.DOC_PAGE_MARGIN_POS.LEFT:return"l";case r.DOC_PAGE_MARGIN_POS.RIGHT:return"r";default:return""}},t.onCustomSize=function(e){var n=e.position,i=e.margin;if(!window.APP.coreDataInvalid()&&!t.handlePageMarginSettingInWebMode()){var a={};a[t.getKeyByPosType(n)]=i,a=t.getLegalUnsetMargin(Object.assign({},t.state.margins,a));var o=p.default.getMarginsWithUnit(a,f.UnitType.Unit_pt),s=1;if(t.props.hasRangeSettings?t.setState({setMarginArgs:o}):s=window.APP.editor.setSectionMargins(o,t.state.applyRangeValue),1===s){var l=r.DOC_PAGE_MARGIN_TYPE.Custom,c=p.default.getMarginMode(a);r.DOC_PAGE_MARGIN_TYPE.Custom!==c&&(l=c),t.setState({margins:a,mode:l})}t.updateLimit()}},t.handleSelected=function(e){if(e!==t.state.mode&&!t.handlePageMarginSettingInWebMode()){if(r.DOC_PAGE_MARGIN_TYPE.Custom!==e){var n=p.default.getStdMargin(e,f.UnitType.Unit_pt);t.props.hasRangeSettings?t.setState({setMarginArgs:n}):window.APP.editor.setSectionMargins(n,t.state.applyRangeValue),t.setState({mode:e,margins:r.DOC_PAGE_MARGIN_SIZE[e]}),window.collection("commandbar","click","page|margin_".concat(e+1))}t.props.closeFunc&&t.props.closeFunc(),t.updateLimit()}},t.onApplyRangeSelected=function(e){t.setState({applyRangeValue:e})},t.applySettings=function(){t.handlePageMarginSettingInWebMode()||t.isInvalidMargin()||(window.APP.editor.setSectionMargins(t.state.setMarginArgs,t.state.applyRangeValue),t.applyRangeCollection(),t.props.closeDetailSetting())},t.isInvalidMargin=function(){var e=t.state.setMarginArgs,n=window.APP.data.selection.selInfo.getMaxMargin({top:f.default.init(e.top,e.unit).ti,bottom:f.default.init(e.bottom,e.unit).ti,left:f.default.init(e.left,e.unit).ti,right:f.default.init(e.right,e.unit).ti});return e.top>n.t.val?(t.setState({limitWarn:r.DOC_PAGE_MARGIN_POS.TOP}),!0):e.bottom>n.b.val?(t.setState({limitWarn:r.DOC_PAGE_MARGIN_POS.BOTTOM}),!0):e.left>n.l.val?(t.setState({limitWarn:r.DOC_PAGE_MARGIN_POS.LEFT}),!0):e.right>n.r.val&&(t.setState({limitWarn:r.DOC_PAGE_MARGIN_POS.RIGHT}),!0)},t.handleLimitWarnClose=function(){t.setState({limitWarn:-1})},t.applyRangeCollection=function(){var e;switch(t.state.applyRangeValue){case b:e="page|margin_range_1";break;case h:e="page|margin_range_2";break;case g:e="page|margin_range_3";break;case w:e="page|margin_range_4";break;case v:e="page|margin_range_5"}window.collection("commandbar","click",e)},t.updateLimit=function(){if(!window.APP.coreDataInvalid()){var e=window.APP.data.selection.selInfo.getMaxMargin();t.setState({limit:e})}},t.getLegalUnsetMargin=function(e){if(t.props.hasRangeSettings)return e;var n=t.state.limit;return{t:e.t.pt>n.t.pt?n.t:e.t,l:e.l.pt>n.l.pt?n.l:e.l,b:e.b.pt>n.b.pt?n.b:e.b,r:e.r.pt>n.r.pt?n.r:e.r}},t.hasSelection=function(){var e=window.APP.data.selection,t=e.begin,n=e.end;return t.position!==n.position},t.isOnlyOneSection=function(){return window.APP.data.doc.sections.isOnlyOneSection()},t.configOptions=function(){var e=t.isInHeaderFooter(),n=t.hasSelection(),i=t.isOnlyOneSection(),a=[b],o=b;return i&&!n?e||a.push(g):i||n?i&&n?e||a.push(v):(e||a.push(v),a.push(w),o=w):(e||a.push(g),a.push(h),o=h),C.map((function(e){return e.disabled=!a.includes(e.value),e})),o},t.renderItem=function(e){var n=r.DOC_PAGE_MARGIN_TYPE[e],i=t.state.mode===n;return a.default.createElement(s.default,{className:"page-margin",key:e,mode:n,margins:t.state.margins,direct:t.state.direct,selected:i,limit:t.props.hasRangeSettings?E:t.state.limit,limitWarn:t.state.limitWarn,limitWarnCallback:t.handleLimitWarnClose,clickHandler:t.handleSelected,customSizeHandler:t.onCustomSize})},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener(c.default.names.DOC_SELECTION_CHANGED,this.onSelectionChanged),this.initData()},t.prototype.initData=function(){this.updateLimit();var e=window.APP.data.selection.selInfo.getSectionMargins(),t=p.default.getMarginMode(e),n=window.APP.data.selection.selInfo.getPageOrientation(),i=p.default.getMarginsWithUnit(e,f.UnitType.Unit_pt),a=this.configOptions();this.setState({margins:e,mode:t,direct:n,applyRangeValue:a,setMarginArgs:i})},t.prototype.componentWillUnmount=function(){window.removeEventListener(c.default.names.DOC_SELECTION_CHANGED,this.onSelectionChanged)},t.prototype.isInHeaderFooter=function(){return window.APP.data.selection.selContext.isInHeaderFooter},t.prototype.render=function(){for(var e=this.props.hasRangeSettings,t=Object.keys(r.DOC_PAGE_MARGIN_TYPE),n=[],i=this.renderItem(t[t.length-1]),o=0;o<t.length-1;o++)n.push(this.renderItem(t[o]));return a.default.createElement("div",{className:"page-margin-panel-container ".concat(l.DOC_PAPER_DIRECTION_NAME[this.state.direct])},a.default.createElement("div",{className:"standard-items"},n),a.default.createElement("div",{className:"divider"}),a.default.createElement("div",{className:"custom-items"}," ",i," "),e&&a.default.createElement("div",{className:"range-setting-items"},a.default.createElement("div",{className:"ranges-setting-title"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.applyRange", "Application Scope")),a.default.createElement(m.default,{options:C,value:this.state.applyRangeValue,onChange:this.onApplyRangeSelected})))},t}(a.PureComponent);t.default=y,t.PageMarginSettingDialog=function(e){var t=e.onCancel,n=e.isWebMode,i=(0,a.useRef)(null);return a.default.createElement(o.default,{className:"page-margin-setting-dialog",title:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.pageMarginSettingTitle", "Margin Settings"),showFooter:!0,onOk:function(){i.current.applySettings()},onCancel:t},a.default.createElement(y,{ref:i,hasRangeSettings:!0,isWebMode:n,closeDetailSetting:t,closeFunc:null}))}},16063:function(e,t,n){},16064:function(e,t,n){},16065:function(e,t,n){},16066:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(7501),l=n(1470),c=function(){function e(){a()(this,e)}return r()(e,null,[{key:"getMarginMode",value:function(t){var n=t.l,i=t.b,a=t.t,o=t.r;return e._isBelongToType(a,i,n,o,s.DOC_PAGE_MARGIN_TYPE.Normal)?s.DOC_PAGE_MARGIN_TYPE.Normal:e._isBelongToType(a,i,n,o,s.DOC_PAGE_MARGIN_TYPE.Compact)?s.DOC_PAGE_MARGIN_TYPE.Compact:e._isBelongToType(a,i,n,o,s.DOC_PAGE_MARGIN_TYPE.Moderate)?s.DOC_PAGE_MARGIN_TYPE.Moderate:e._isBelongToType(a,i,n,o,s.DOC_PAGE_MARGIN_TYPE.Wide)?s.DOC_PAGE_MARGIN_TYPE.Wide:s.DOC_PAGE_MARGIN_TYPE.Custom}},{key:"_isBelongToType",value:function(e,t,n,i,a){var o=s.DOC_PAGE_MARGIN_SIZE[a];return o.t.cm.toFixed(2)===e.cm.toFixed(2)&&o.b.cm.toFixed(2)===t.cm.toFixed(2)&&o.l.cm.toFixed(2)===n.cm.toFixed(2)&&o.r.cm.toFixed(2)===i.cm.toFixed(2)}},{key:"getStdMargin",value:function(t,n){var i=s.DOC_PAGE_MARGIN_SIZE[t];return e.getMarginsWithUnit(i,n)}},{key:"getMarginsWithUnit",value:function(e,t){var n=l.UnitName[t];return{unit:t,top:e.t[n],bottom:e.b[n],left:e.l[n],right:e.r[n]}}}]),e}();t.default=c},16067:function(e,t,n){},16068:function(e,t,n){},16069:function(e,t,n){},16070:function(e,t,n){},16071:function(e,t,n){},16072:function(e,t,n){},16073:function(e,t,n){},16074:function(e,t,n){e.exports=function(e,t){n.e(781).then(n.bind(null,16599)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},16075:function(e,t,n){e.exports=function(e,t){n.e(782).then(n.bind(null,16601)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},16076:function(e,t,n){},16077:function(e,t,n){},16078:function(e,t,n){},16079:function(e,t,n){},16080:function(e,t,n){e.exports=function(e,t){n.e(524).then(n.bind(null,16603)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},1661:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("page_pagination",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M13.25 14.25V10.05C13.25 9.88431 13.1157 9.75 12.95 9.75H3.05C2.88431 9.75 2.75 9.88431 2.75 10.05V14.25M13.25 1.75V5.95C13.25 6.11569 13.1157 6.25 12.95 6.25H3.05C2.88431 6.25 2.75 6.11569 2.75 5.95V1.75",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},16676:function(e,t,n){"use strict";n.r(t);var i=n(13),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(22),d=n.n(c),u=n(23),p=n.n(u),m=n(238),f=n.n(m),h=n(1055),g=n.n(h),w=n(10630),v=n(10632),b=n(10633),C=n(10926),E=n(1792),y=n(10927),_=n(10928),k=n(10634),P=n(10883),S=n(10915),T=n(10929),M=n(10636),O=n(10638),R=n(10635),I=n(10640),N=n(10639),D=n(10641),A=n(10642),B=n(10930),L=window.CommandBarComponent.cmbIds.wps,H=window.CommandBarComponentFragment,F=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getItems=n.getItems.bind(n),n}return p()(t,e),l()(t,[{key:"getItems",value:function(){var e=this;return Object.keys(this.refMap).map((function(t){return e.refMap[t].el}))}},{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.connected,i=e.dispatch,a=e.user,o=e.visible,r=e.readOnly,s=e.file,l=e.table,c=e.hyperLink,d=e.separatorLine,u=e.isInHeaderFooter,p=e.allowInsertHyperlink,m=e.disableInsertDatetime,h=e.disableInsertBreak,F=e.onlySupportLineBreak,W=e.disableInsertPic,U=e.disableInsertSheet,x=e.disableInsertSplit,V=e.disableInsertSymbol,j=e.disableInsertProcess,z=e.disableControls,G=e.disablePictureControls,K=e.disablePureTextControls,Y=e.disableRepeatSecControls,X=e.disableOtherControls,Z=e.disableInsertCatalog,Q=e.disableWaterMark,$=e.inRestrictEditMode,J=e.isTemplate,q=e.disableBookmark,ee=e.isParagraphSetting,te=e.isInReadonlyProtectMode,ne=e.isInCommentProtectMode,ie=e.disableFootnoteEndnoteInsert,ae=e.disableFootnoteSetting,oe=e.disableEndnoteSetting,re=e.disableInsertGeomerty,se=!n||r||!!ee,le=window.__CONFIG__.wps,ce=le.enableDocumentField,de=le.isCatalogEnabled,ue=window.__CONFIG__,pe=ue.isEnableSignature,me=ue.enableLaTeX,fe="zh-CN"===window.langName,he=window.APP&&window.APP.isWebMode(),ge=se||$||ne||te;return f.a.createElement(g.a,{tabKey:t,visible:o,getItems:this.getItems},f.a.createElement("div",null,f.a.createElement(_.a,{showText:!0,isFromInsertTab:!0,table:l,disabled:U||se,collectType:"insert"}),f.a.createElement(w.a,{showText:!0,isFromInsertTab:!0,disabled:W||se,collectType:"insert"}),f.a.createElement(B.a,{showText:!0,isFromInsertTab:!0,disabled:re||se||window.APP.isWebMode(),collectType:"insert"}),de&&f.a.createElement(v.a,{isWebMode:he,showText:!0,isFromInsertTab:!0,disabled:Z||se,collectType:"insert"}),f.a.createElement(b.a,{showText:!0,isFromInsertTab:!0,hyperLink:c,dispatch:i,connected:n,disabled:!p||se,collectType:"insert"}),f.a.createElement(N.a,{disabled:ge,isWebMode:he,collectType:"insert",isTemplate:J,isInReadonlyProtectMode:te})),f.a.createElement("div",null,E.isProcessOnAvailable&&f.a.createElement(C.a,{isFromInsertTab:!0,inRestrictEditMode:$,disabled:j||se,user:a,collectType:"insert",connected:n,readOnly:r})),f.a.createElement("div",null,pe&&f.a.createElement(R.a,{disabled:W||se,connected:n})),f.a.createElement("div",null,me&&f.a.createElement(D.a,{disabled:W||se,connected:n,collectType:"insert"})),f.a.createElement("div",null,f.a.createElement(y.a,{showText:!0,isFromInsertTab:!0,disabled:V||se,collectType:"insert"})),f.a.createElement("div",null,f.a.createElement(S.a,{showText:!0,isFromInsertTab:!0,separatorLine:d,disabled:x||se,collectType:"insert"})),f.a.createElement("div",null,fe&&f.a.createElement(P.a,{showText:!0,isFromInsertTab:!0,dispatch:i,user:a,disabledTag:!1,isWebMode:he,disabled:se||Q,connected:n,collectType:"insert"})),f.a.createElement("div",null,f.a.createElement(T.a,{showText:!0,isFromInsertTab:!0,disabled:m||se,collectType:"insert"})),f.a.createElement("div",null,f.a.createElement(k.a,{showText:!0,isFromInsertTab:!0,table:l,isInHeaderFooter:u,disabledTag:!1,isWebMode:he,disabled:h||se,onlySupportLineBreak:F,collectType:"insert",disabledSectionBreak:te||ne})),f.a.createElement("div",null,f.a.createElement(H,{cmbId:L.ContentControl},f.a.createElement(M.a,{showText:!0,isFromInsertTab:!0,table:l,isInHeaderFooter:u,disabled:se,controlDisabled:z,disablePictureControls:G,disablePureTextControls:K,disableRepeatSecControls:Y,disableOtherControls:X,file:s,inRestrictEditMode:$,isTemplate:J}))),f.a.createElement("div",null,f.a.createElement(O.a,{showText:!0,isFromInsertTab:!0,cmbId:L.BookMark,table:l,isInHeaderFooter:u,disabled:q||se,controlDisabled:z,file:s,inRestrictEditMode:$,isTemplate:J,collectType:"insert"})),f.a.createElement("div",null,ce&&f.a.createElement(I.a,{isFromInsertTab:!0,disabled:se})),f.a.createElement("div",null,f.a.createElement(A.a,{isFromInsertTab:!0,collectType:"insert",isWebMode:he,disableInsert:ie||se,disableEndnoteSetting:oe||se,disableFootnoteSetting:ae||se,disabled:r})))}}]),t}(m.PureComponent),W=n(9268),U=n(321),x=n(243),V=n.n(x),j=n(2556),z=n(1830),G=n(16062),K=n.n(G),Y=n(329),X=(n(16068),U.default.DropdownPanel),Z=V.a.iconTypes.size16,Q=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,moreSettingVisible:!1},n.onVisibleChange=n._onVisibleChange.bind(n),n.clickMoreSetting=n._clickMoreSetting.bind(n),n.onCancelDialog=n._onCancelDialog.bind(n),n.closeDropdownPanel=n._closeDropdownPanel.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.onVisibleChange(this.props.visible),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.pageMargin", "Margins"),icon:Z.page_margin})}},{key:"_onVisibleChange",value:function(e){window.APP.coreDataInvalid()||(this.setState({visible:e}),e&&window.collection("commandbar","click","page|margin"))}},{key:"_closeDropdownPanel",value:function(){this.refDropdownBtn.close(),this.setState({visible:!1})}},{key:"_clickMoreSetting",value:function(){this.setState({moreSettingVisible:!0}),window.collection("commandbar","click","page|margin_setting")}},{key:"_onCancelDialog",value:function(){this.setState({moreSettingVisible:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,i=t.isWebMode,a=this.state,o=a.visible,r=a.moreSettingVisible,s=f.a.createElement(X,{className:"page-margin",offsetX:-1},f.a.createElement(K.a,{hasRangeSettings:!1,closeFunc:this.closeDropdownPanel,visible:o,isWebMode:i}),f.a.createElement(V.a,{size:"medium",className:"page-margin-more-setting",altHintKeep:"true",altRenderDelay:"300",onClick:this.clickMoreSetting,icon:f.a.createElement(z.a,{size:16,fill:Y.defaultFill})},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.pageMarginMoreSetting", "More Settings")));return f.a.createElement(m.Fragment,null,r&&f.a.createElement(G.PageMarginSettingDialog,{isWebMode:i,onCancel:this.onCancelDialog}),f.a.createElement(U.default,{ref:function(t){e.refDropdownBtn=t},panel:s,className:"prevent-focus-in-ipad",visible:o,onVisibleChange:this.onVisibleChange,isSetHeight:!0},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},isDropdown:!0,icon:f.a.createElement(j.a,{size:16,fill:Y.defaultFill}),selected:o,disabled:n},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.pageMargin", "Margins"))))}}]),t}(m.PureComponent),$=n(9932),J=n(2551),q=n(2222),ee=n(2223),te=n(260),ne=n(1276),ie=n(684),ae=n(1717),oe=n.n(ae),re=(n(16069),U.default.DropdownPanel),se=re.Item,le=V.a.iconTypes.size16,ce=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={select:$.DOC_PAPER_DIRECTION.Vertical,visible:!1},n.handleSelected=n._handleSelected.bind(n),n.onVisibleChange=n._onVisibleChange.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.onVisibleChange(this.props.visible),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperDirection.paperDirection", "Paper direction"),icon:le.paper_direct,items:[{icon:le.paper_vertical_direct,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperDirection.paperDirection", "Paper direction")+"-"+$.DOC_PAPER_DIRECTION_CN_NAME[0]},{icon:le.paper_horizontal_direct,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperDirection.paperDirection", "Paper direction")+"-"+$.DOC_PAPER_DIRECTION_CN_NAME[1]}]})}},{key:"componentWillUnmount",value:function(){}},{key:"_onVisibleChange",value:function(e){if(!window.APP.coreDataInvalid()&&(this.setState({visible:e}),e)){var t=window.APP.data.selection.selInfo.getPageOrientation();this.setState({select:t}),window.collection("commandbar","click","page|orientation")}}},{key:"_handleSelected",value:function(e){window.APP.coreDataInvalid()||(window.collection("commandbar","click","page|orientation_"+(e+1)),this.state.select!==e?this.props.isWebMode?te.default.dispatchEvent(te.default.pcDialogs.WPS_SHOW_ALERT,{type:ne.default.SwitchWebMode,data:{typoMode:ie.TYPO_MODE.MODE_PC,funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperDirection.funcName", "Paper direction")}}):(window.APP.editor.setPageOrientation(e),this.setState({select:e,visible:!1})):this.setState({visible:!1}))}},{key:"_renderItem",value:function(e){var t=$.DOC_PAPER_DIRECTION[e],n=this.state.select===t,i=$.DOC_PAPER_DIRECTION_CN_NAME[t],a="Vertical"===e?f.a.createElement(ee.a,{size:16,fill:Y.defaultFill}):f.a.createElement(q.a,{size:16,fill:Y.defaultFill});return f.a.createElement(se,{className:"paper-direct-item",key:t,value:t,selected:n,onClick:this.handleSelected},f.a.createElement(oe.a,{icon:a,text:i}))}},{key:"render",value:function(){var e=this,t=this.props.disabled,n=this.state.visible,i=[];Object.keys($.DOC_PAPER_DIRECTION).forEach((function(t){i.push(e._renderItem(t))}));var a=f.a.createElement(re,{selectable:!0,className:"paper-direct",offsetX:-1},i);return f.a.createElement(U.default,{panel:a,className:"prevent-focus-in-ipad",visible:n,onVisibleChange:this.onVisibleChange},f.a.createElement(V.a,{ref:function(t){e.refBtn=t},isDropdown:!0,size:"middle",icon:f.a.createElement(J.a,{size:16,fill:Y.defaultFill}),selected:n,disabled:t},_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperDirection.paperDirection", "Paper direction")))}}]),t}(m.PureComponent),de=n(2009),ue=n(2553),pe=(n(16070),V.a.iconTypes.size16),me=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasEnterHeaderFooterMode:!1},n.handleClick=n.handleClick.bind(n),n.handleSwitchHFMode=n.handleSwitchHFMode.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener(de.a.HEADER_FOOTER.SWITCH_MODE,this.handleSwitchHFMode),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.FontStyle.HeaderFooter.headerFooter", "Header and Footer"),icon:pe.enter_header_footer})}},{key:"componentWillUnmount",value:function(){window.removeEventListener(de.a.HEADER_FOOTER.SWITCH_MODE,this.handleSwitchHFMode)}},{key:"handleSwitchHFMode",value:function(e){var t=e.detail;this.setState({hasEnterHeaderFooterMode:t})}},{key:"handleClick",value:function(){if(!window.APP.coreDataInvalid())if(this.props.isWebMode)te.default.dispatchEvent(te.default.pcDialogs.WPS_SHOW_ALERT,{type:ne.default.SwitchWebMode,data:{typoMode:ie.TYPO_MODE.MODE_PC,funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.FontStyle.HeaderFooter.funcName", "Header and Footer")}});else{var e=this.state.hasEnterHeaderFooterMode,t=window.APP.editor;window.collection("commandbar","click","page|headerfooter_"+(e?"off":"on")),e?t.leaveCurrentHeaderFooter():t.enterCurrentHeader(),this.setState({hasEnterHeaderFooterMode:!e})}}},{key:"render",value:function(){var e=this,t=this.props.disabled,n=this.state.hasEnterHeaderFooterMode,i=n?_i18n("applications.writer.components.CommandBars.RbTab.Home.FontStyle.HeaderFooter.exitHeaderFooter", "Exit Header and Footer"):_i18n("applications.writer.components.CommandBars.RbTab.Home.FontStyle.HeaderFooter.headerFooter", "Header and Footer"),a=f.a.createElement(ue.a,{size:16,fill:Y.defaultFill});return f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},title:_i18n("applications.writer.components.CommandBars.RbTab.Home.FontStyle.HeaderFooter.headerFooterTip", "Set Header and Footer in Document"),icon:a,onClick:this.handleClick,selected:n,disabled:t},i)}}]),t}(m.PureComponent),fe=n(144),he=n.n(fe),ge=n(241),we=n(2558),ve=U.default.DropdownPanel.Item;var be=Object(ge.connect)((function(e){return{isWebMode:e.writer.webMode.isWebMode,selected:e.writer.webMode.isFilenameVisible}}))(Object(m.memo)((function(e){var t=e.selected,n=e.disabled,i=e.isWebMode,a=e.onClick,o=Object(m.useMemo)((function(){return{disabled:n,selected:t&&i,altHintKeep:i?"":"true",onClick:window.utils.Lodash.throttle((function(){var e=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a(),window.collection("commandbar","click","page|webmode_title"+(e?"off":"on")),te.default.dispatchEvent(te.default.webMode.ON_FILENAME_SETTING_CHANGE,{isVisible:e,shouldAdjustOffset:t})};if(i)e(!t);else{var n=void 0!==window.APP.data.doc.docInfo.woTemplateFileNameVisible;te.default.dispatchEvent(te.default.pcDialogs.WPS_SHOW_ALERT,{type:ne.default.SwitchWebMode,data:{typoMode:ie.TYPO_MODE.MODE_WEB,options:{isMakeSureCursorVisible:!1},funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.Filename.funcName", "File Name Column"),onOk:function(){return setTimeout((function(){return e(!0,n)}),250)}}})}}),800,{trailing:!1})}}),[t,n,i]);return f.a.createElement(ve,o,f.a.createElement(oe.a,{icon:f.a.createElement(we.a,{size:16,fill:Y.defaultFill}),text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Filename.title", "File Name Column")}))}))),Ce=n(9269),Ee=n(7438),ye=n(1661),_e=n(167),ke=(n(16071),U.default.DropdownPanel),Pe=V.a.iconTypes.size16;function Se(e){var t=e.disabled,n=Object(m.useState)(!1),i=he()(n,2),o=i[0],r=i[1],s=Object(m.useState)(!1),l=he()(s,2),c=l[0],d=l[1],u=Object(m.useState)({}),p=he()(u,2),h=p[0],g=p[1],w=Object(m.useRef)(null),v=Object(m.useRef)(null);Object(m.useEffect)((function(){window.__WPSENV__.commandbars.push({el:w.current,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page"),icon:Pe.web_mode,items:[{icon:Pe.web_mode,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page")+"-"+_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.webModeTrigger", "Full Page Mode")},{icon:Pe.filename,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page")+"-"+_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.filename", "File Name Column")}]})}),[]);var b=function(){r(!1),d(!1)},C=window.APP.isReadOnly(),E=f.a.createElement(ke,{selectable:!0,className:"wps-webMode-setting-panel"},f.a.createElement(Ce.a,{showText:!0,disabled:t,onClick:b}),f.a.createElement(be,{disabled:t,onClick:b}));return f.a.createElement("div",{onMouseEnter:function(){d(!0);var e={left:v.current.getBoundingClientRect().left-99,top:v.current.getBoundingClientRect().bottom+10,triangleStyle:{left:"50%",marginLeft:"0px",bottom:"100%"},triangleDirection:"top"};g(e)},onMouseLeave:function(){d(!1)},ref:v},f.a.createElement(U.default,{className:"prevent-focus-in-ipad",panel:E,visible:o,onVisibleChange:function(e){r(e),c&&d(!1)}},f.a.createElement(V.a,{size:"middle",isDropdown:!0,title:C?_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page"):"",icon:f.a.createElement(ye.a,{size:16}),selected:o,disabled:t,ref:w},_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page"))),!C&&!_e.isPad&&f.a.createElement(Ee.a,a()({visible:!o&&c},h)))}var Te=n(248),Me=n(7374),Oe=n(30),Re=n.n(Oe),Ie=n(4459),Ne=n(568),De=n(1470),Ae=n(240),Be=n(10808),Le=(n(10809),[{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.pt", "Pound"),value:0},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.inch", "Inch"),value:1},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.cm", "cm"),value:2},{content:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.mm", "mm"),value:3}]),He=["paperHeightValue","paperWidthValue"],Fe=["paperHeightUnit","paperWidthUnit"],We={height:0,width:1},Ue=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setPaperValue=n.setPaperValue.bind(n),n.setPaperUnit=n.setPaperUnit.bind(n),n.updatePaperSizeLimit=n.updatePaperSizeLimit.bind(n),n.customSizeHandler=n.customSizeHandler.bind(n),n.onEnter=n.onEnter.bind(n),n.isInvalidValue=n.isInvalidValue.bind(n),n.sendData=n.sendData.bind(n),n.updatePaperMinValue=n.updatePaperMinValue.bind(n),n.updateWarnText=n.updateWarnText.bind(n),n.onCloseWarn=n.onCloseWarn.bind(n),n.state={paperHeightValue:e.size.height.val,paperHeightUnit:e.size.height.unit,paperWidthValue:e.size.width.val,paperWidthUnit:e.size.width.unit,paperHeightValueMin:.26,paperHeightValueMax:55.88,paperHeightValueStep:.1,paperWidthValueMin:.26,paperWidthValueMax:55.88,paperWidthValueStep:.1,warnText:"",isShowWarn:!1},n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this.updatePaperMinValue(We.height),t=this.updatePaperMinValue(We.width);this.setState({paperHeightValueMin:e,paperWidthValueMin:t})}},{key:"componentWillUnmount",value:function(){this.sendData()}},{key:"sendData",value:function(){var e=this;Object.values(We).some((function(t){var n=parseFloat(e[He[t]].getInputText());if(""!==n&&n!==e.state[He[t]]){if(e.isInvalidValue(n,t))return void e.updateWarnText(t);var i=e.state,a=i.paperHeightValue,o=i.paperHeightUnit,r=i.paperWidthValue,s=i.paperWidthUnit;return e.props.customSizeHandler({paperHeightValue:"paperHeightValue"===He[t]?n:a,paperWidthValue:"paperWidthValue"===He[t]?n:r,paperHeightUnit:o,paperWidthUnit:s}),!0}}))}},{key:"updatePaperSizeLimit",value:function(e,t){var n,i=Me.a[t],a=i.max,o=i.step,r=this.updatePaperMinValue(e,t);return this.setState((n={},Re()(n,He[e]+"Min",r),Re()(n,He[e]+"Max",a),Re()(n,He[e]+"Step",o),n)),{max:a,min:r}}},{key:"customSizeHandler",value:function(){var e=this.state,t=e.paperHeightValue,n=e.paperHeightUnit,i=e.paperWidthValue,a=e.paperWidthUnit;this.props.customSizeHandler({paperHeightValue:t,paperHeightUnit:n,paperWidthValue:i,paperWidthUnit:a})}},{key:"updatePaperMinValue",value:function(e,t){var n=void 0===t?this.state[Fe[e]]:t,i=window.APP.data.selection.selInfo.getSectionMargins(),a=void 0;e===We.height?a=parseFloat(i.t[De.UnitName[De.UnitType.Unit_pt]]+i.b[De.UnitName[De.UnitType.Unit_pt]])+.1:a=parseFloat(i.l[De.UnitName[De.UnitType.Unit_pt]]+i.r[De.UnitName[De.UnitType.Unit_pt]])+36;return parseFloat(Object(Ae.convertUnit)(a,De.UnitName[De.UnitType.Unit_pt],De.UnitName[n]).toFixed(2))}},{key:"isInvalidValue",value:function(e,t){return""!==e&&(e<this.state[He[t]+"Min"]||e>this.state[He[t]+"Max"])}},{key:"updateWarnText",value:function(e){var t=_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.warnPopup", "{0} must be between {1}{2} and {3}{2}, please reset.").replace("{0}",e===We.height?_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.height", "Height"):_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.width", "Width")).replace("{1}",this.state[He[e]+"Min"]).replace(/\{2\}/g,Le[this.state[Fe[e]]].content).replace("{3}",this.state[He[e]+"Max"]);this.setState({warnText:t,isShowWarn:!0})}},{key:"setPaperValue",value:function(e,t){var n=parseFloat(e||0);this.isInvalidValue(n,t)||this.setState(Re()({},He[t],n),this.customSizeHandler)}},{key:"setPaperUnit",value:function(e,t){var n,i=this.state,a=i[Fe[e]],o=i[He[e]];if(a!==t){var r=this.updatePaperSizeLimit(e,t).max,s=parseFloat(Object(Ae.convertUnit)(o,De.UnitName[a],De.UnitName[t]).toFixed(2));s>r&&(s=r),this.setState((n={},Re()(n,He[e],s),Re()(n,Fe[e],t),n))}}},{key:"onEnter",value:function(e){var t=He[e],n=this[t].getInputText();if(this.isInvalidValue(n,e))this.updateWarnText(e);else if(""===n){var i=parseFloat(Number(this.state[t]).toFixed(2));this[t].setState({value:i}),n=i}}},{key:"onCloseWarn",value:function(){this.setState({isShowWarn:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.paperHeightUnit,i=t.paperWidthUnit,a=t.warnText,o=t.isShowWarn,r=t.paperHeightValueMin,s=t.paperHeightValueMax,l=t.paperHeightValueStep,c=t.paperWidthValueMin,d=t.paperWidthValueMax,u=t.paperWidthValueStep,p=this.state,m=p.paperHeightValue,h=p.paperWidthValue;return""!==m&&(m=parseFloat(m.toFixed(2))),""!==h&&(h=parseFloat(h.toFixed(2))),f.a.createElement("div",{className:"custom-panel",ref:function(t){return e.panelElement=t}},f.a.createElement("div",{className:"width size-unit"},f.a.createElement("span",{className:"size"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.widthTitle", "Width")),f.a.createElement(Ne.default,{className:"normal-frame value-input",ref:function(t){return e.paperWidthValue=t},min:c,max:d,step:u,value:h,onLazyChange:function(t){e.setPaperValue(t,We.width)},onEnter:function(){e.onEnter(We.width)},onBlur:function(){e.onEnter(We.width)}}),f.a.createElement(Ie.a,{className:"real-unit",onChange:function(t){e.setPaperUnit(We.width,t)},altScPosition:"right",content:Le[i].content,value:i,groups:[Le]})),f.a.createElement("div",{className:"height size-unit"},f.a.createElement("span",{className:"size"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.heightTitle", "Height")),f.a.createElement(Ne.default,{className:"normal-frame value-input",ref:function(t){return e.paperHeightValue=t},min:r,max:s,step:l,value:m,onLazyChange:function(t){e.setPaperValue(t,We.height)},onEnter:function(){e.onEnter(We.height)},onBlur:function(){e.onEnter(We.height)}}),f.a.createElement(Ie.a,{className:"real-unit",onChange:function(t){e.setPaperUnit(We.height,t)},content:Le[n].content,altScPosition:"right",value:n,groups:[Le]})),o&&f.a.createElement(Be.a,{onOk:this.onCloseWarn,onCancel:this.onCloseWarn,warnText:a,title:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.pageSizeSetting", "Set size")}))}}]),t}(m.PureComponent),xe=n(491),Ve=n(2610),je=U.default.DropdownPanel,ze=je.Item,Ge=V.a.iconTypes.size16,Ke=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={size:Me.d[Me.b.A4],mode:Me.b.A4,visible:!1,customPanelVisible:!1,isCustomSize:!1},n.handlePageSizeSettingInWebMode=function(){return!!n.props.isWebMode&&(te.default.dispatchEvent(te.default.pcDialogs.WPS_SHOW_ALERT,{type:ne.default.SwitchWebMode,data:{typoMode:ie.TYPO_MODE.MODE_PC,funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.funcName", "Paper size")}}),n.setState({visible:!1}),!0)},n.onCustomSize=n.onCustomSize.bind(n),n.onVisibleChange=n.onVisibleChange.bind(n),n.handleSelected=n.handleSelected.bind(n),n.setPageSizeMode=n.setPageSizeMode.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.onVisibleChange(this.props.visible),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.paperSize", "Paper Size"),icon:Ge.wps_paper_size})}},{key:"componentWillUnmount",value:function(){}},{key:"setPageSizeMode",value:function(e){var t=e.height,n=e.width,i=t[De.UnitName[De.UnitType.Unit_cm]],a=n[De.UnitName[De.UnitType.Unit_cm]],o=Me.d.findIndex((function(e){var t=Math.abs(e.height.val+.05-i).toFixed(2)<=.35&&Math.abs(e.width.val+.05-a).toFixed(2)<=.35,n=Math.abs(e.height.val+.05-a).toFixed(2)<=.35&&Math.abs(e.width.val+.05-i).toFixed(2)<=.35;return t||n})),r=void 0;return r=-1!==o?o:Me.b.customSize,this.setState({mode:r}),r}},{key:"onCustomSize",value:function(e){if(!window.APP.coreDataInvalid()&&!this.handlePageSizeSettingInWebMode()){var t=e.paperHeightValue,n=e.paperHeightUnit,i=e.paperWidthValue,a=e.paperWidthUnit,o=De.default.init(t,n),r=De.default.init(i,a);this.setPageSizeMode({height:o,width:r}),this.setState({size:{height:o,width:r},isCustomSize:!0},this.setPageSize)}}},{key:"onVisibleChange",value:function(e){if(!window.APP.coreDataInvalid()&&(this.setState({visible:e}),e)){var t=window.APP.data.selection.selInfo.getPageSize(),n=t.heightValue,i=t.widthValue,a=De.default.init(n,De.UnitType.Unit_cm),o=De.default.init(i,De.UnitType.Unit_cm);this.setState({size:{height:a,width:o}}),this.setPageSizeMode({height:a,width:o})===Me.b.customSize?this.setState({customPanelVisible:!0}):this.setState({customPanelVisible:!1})}}},{key:"handleSelected",value:function(e,t){if(this.state.mode===e||this.handlePageSizeSettingInWebMode())t.preventDefault();else{if(e===Me.b.customSize)return t.preventDefault(),this.setState({customPanelVisible:!0},this.renderCustomItem),void window.collection("commandbar","click","page|specification_custom");this.setState({mode:e,size:Me.d[e],visible:!1,isCustomSize:!1},this.setPageSize),window.collection("commandbar","click","page|specification_"+(e+1))}}},{key:"setPageSize",value:function(){var e=this.state.size,t=e.height,n=e.width,i=parseFloat(t[De.UnitName[De.UnitType.Unit_pt]].toFixed(2)),a=parseFloat(n[De.UnitName[De.UnitType.Unit_pt]].toFixed(2)),o={unit:De.UnitType.Unit_pt,height:i,width:a,isCustomSize:this.state.isCustomSize};window.APP.editor.setPageSize(o)}},{key:"renderCustomItem",value:function(){var e=this.state.customPanelVisible,t="page-size-custom-title "+(e?"radioSelected":"");return f.a.createElement("div",{className:"page-size-item custom"},f.a.createElement("div",{className:"custom-wrapper"},f.a.createElement(ze,{altHintKeep:"true",className:t,value:Me.b.customSize,onClick:this.handleSelected},e&&f.a.createElement(Te.default,{type:Ge.wps_circle_checkbox_checked,className:"page-size-custom-item-button"}),!e&&f.a.createElement(Te.default,{type:Ge.wps_circle_checkbox,className:"page-size-custom-item-button"}),f.a.createElement("span",null,Me.c[Me.b.customSize]))),e&&f.a.createElement(Ue,{className:"paper-size-item",size:this.state.size,customSizeHandler:this.onCustomSize}))}},{key:"renderItems",value:function(){var e=this,t=this.renderCustomItem(),n=Me.c.map((function(t,n){if(!(n>=Me.c.length-1)){var i=e.state.mode===n;return f.a.createElement(ze,{className:"paper-size-item",key:n,value:n,selected:i,onClick:e.handleSelected},f.a.createElement("div",{className:"item-name"},t),f.a.createElement("div",{className:"item-size"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.size", "{0} × {1} (cm)").replace("{0}",Me.d[n].width.val).replace("{1}",Me.d[n].height.val)))}}));return f.a.createElement("div",{className:"wps-page-size-panel-container"},f.a.createElement("div",{className:"standard-items"},n),f.a.createElement(xe.a,null),f.a.createElement("div",{className:"custom-item"}," ",t," "))}},{key:"render",value:function(){var e=this,t=this.props.disabled,n=this.state.visible,i=this.renderItems(),a=f.a.createElement(je,{selectable:!0,className:"paper-size",offsetX:-1},i);return f.a.createElement(U.default,{panel:a,className:"prevent-focus-in-ipad",visible:n,onVisibleChange:this.onVisibleChange},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},isDropdown:!0,icon:f.a.createElement(Ve.a,{size:16,fill:Y.defaultFill}),selected:n,disabled:t},_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.paperSize", "Paper Size")))}}]),t}(m.PureComponent),Ye=n(1501),Xe=(n(16072),n(5298)),Ze=V.a.iconTypes.size16,Qe=[{key:"none",param:null,name:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.lineNumberingNone", "None"),collection:"page|line number off"},{key:"continue",param:{restart:Xe.a},name:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.lineNumberingRestartContinue", "Continuous Line Numbers"),collection:"page|line number1"},{key:"new_page",param:{restart:Xe.b},name:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.lineNumberingRestartNewPage", "Restart Each Page"),collection:"page|line number2"},{key:"new_section",param:{restart:Xe.c},name:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.lineNumberingRestartNewSection", "Restart Each Section"),collection:"page|line number3"}];var $e,Je=($e={},Qe.forEach((function(e){$e[e.key]=e})),$e),qe=U.default.DropdownPanel,et=qe.Item,tt=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={select:Qe[0].key,visible:!1},n.handleSelected=n._handleSelected.bind(n),n.onVisibleChange=n._onVisibleChange.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.onVisibleChange(this.props.visible),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number"),icon:Ze.enter_line_numbering,items:[{text:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number")+"-"+Qe[0].name},{text:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number")+"-"+Qe[1].name},{text:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number")+"-"+Qe[2].name},{text:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number")+"-"+Qe[3].name}]})}},{key:"componentWillUnmount",value:function(){}},{key:"_onVisibleChange",value:function(e){if(!window.APP.coreDataInvalid()&&(this.setState({visible:e}),e)){var t=window.APP.data.selection.selInfo.getLineNumbering(),n="none";if(t&&0!==t.step){var i=this.props.isWebMode?Xe.a:t.restart||Xe.b,a=Qe.find((function(e){return e.param&&i===e.param.restart}));a&&(n=a.key)}this.setState({select:n}),window.collection("commandbar","click","page|line number")}}},{key:"_handleSelected",value:function(e){if(!window.APP.coreDataInvalid()){var t=Je[e];t&&(window.collection("commandbar","click",t.collection),this.state.select!==e?!this.props.isWebMode||"new_page"!==e&&"new_section"!==e?(window.APP.editor.setLineNumbering(t.param),this.setState({select:e,visible:!1})):te.default.dispatchEvent(te.default.pcDialogs.WPS_SHOW_ALERT,{type:ne.default.SwitchWebMode,data:{typoMode:ie.TYPO_MODE.MODE_PC,funcName:_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.funcName", "Show Line Number")}}):this.setState({visible:!1}))}}},{key:"_renderItem",value:function(e){var t=e.key,n=this.state.select===t;return f.a.createElement(et,{className:"line-numbering-item",key:t,value:t,selected:n,onClick:this.handleSelected},f.a.createElement("span",{className:"item-name"},e.name))}},{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,i=t.isWebMode,a=this.state.visible,o=Qe.map((function(t){return e._renderItem(t)})),r=f.a.createElement(qe,{selectable:!0,className:"line-numbering",offsetX:-1},o);return f.a.createElement(U.default,{panel:r,className:"prevent-focus-in-ipad",visible:a,onVisibleChange:this.onVisibleChange},f.a.createElement(V.a,{ref:function(t){e.refBtn=t},isDropdown:!0,size:"middle",title:i?_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumberingInWebMode", "Display Row No. (available in page break view)"):_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number"),icon:f.a.createElement(Ye.a,{size:16}),selected:a,disabled:n},_i18n("applications.writer.components.CommandBars.RbTab.Home.LineNumbering.displayLineNumbering", "Show Line Number")))}}]),t}(m.PureComponent),nt=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getItems=n.getItems.bind(n),n}return p()(t,e),l()(t,[{key:"getItems",value:function(){var e=this;return Object.keys(this.refMap).map((function(t){return e.refMap[t].el}))}},{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.connected,i=e.visible,a=e.readOnly,o=e.isTemplate,r=e.inRestrictEditMode,s=e.isParagraphSetting,l=e.disableLineNumber,c=e.disablePageMarginSetting,d=!n||a,u=!n,p=window.APP&&window.APP.isWebMode(),m=window.APP.data&&window.APP.data.doc||{},h=m.isEnhancedTemplate,w=m.isTXTDocument,v=window.APP.restrictEditHandler,b=v.isInReadonlyProtectMode,C=v.isInCommentProtectMode,E=d||o||r||b||C,y=window.__CONFIG__.wps.enableLineNumbering,_=d||r||s||l||C;return f.a.createElement(g.a,{tabKey:t,visible:i,getItems:this.getItems},f.a.createElement("div",null,f.a.createElement(W.a,{showText:!0,disabled:u})),f.a.createElement("div",null,f.a.createElement(Se,{disabled:d||w||h})),f.a.createElement("div",null,f.a.createElement(Q,{isWebMode:p,disabled:E||c})),f.a.createElement("div",null,f.a.createElement(Ke,{isWebMode:p,disabled:E})),f.a.createElement("div",null,f.a.createElement(ce,{isWebMode:p,disabled:E})),f.a.createElement("div",null,f.a.createElement(me,{isWebMode:p,disabled:d||r||s})),y&&f.a.createElement("div",null,f.a.createElement(tt,{isWebMode:p,disabled:_})))}}]),t}(m.PureComponent),it=(n(16073),n(537)),at=n(252),ot=n.n(at),rt=n(6452),st=n(564),lt=n(881),ct=n(1431),dt=n(2552),ut=U.default.DropdownPanel,pt=ut.Item,mt=V.a.iconTypes.size16,ft=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(n.state={visible:!1,insertCommentDisabled:!0,showComment:!1,showCommentPanel:!1},n.setCommentOrCommentPanelChecked=function(e){n.setState(a()({},e.detail))},n.cancleSelectCommentPanel=function(){n.setState({showCommentPanel:!1}),window.APP.appApi.setCommentShowStatus({commentPanel:!1}),te.default.dispatchEvent(te.default.comments.DRAW_CONTENT_BY_COMMENT,{commentPanel:!1})},n.selectCommentPanel=function(){var e=n.state.showCommentPanel;n.onVisibleChange(!1),n.setState({showComment:e,showCommentPanel:!e}),window.APP.appApi.showComments({checked:e}),window.APP.appApi.setCommentShowStatus({commentBubble:e,commentPanel:!e}),e?(te.default.dispatchEvent(te.default.taskPane.CLOSE_TASK_PANEL),te.default.dispatchEvent(te.default.taskPane.KILL_COMMENT_PANEL)):te.default.dispatchEvent(te.default.taskPane.OPEN_COMMENT_PANEL),te.default.dispatchEvent(te.default.revision.SHOW_REVISION_BUBBLE,{visible:e}),window.collection("commandbar","click",e?"review|comment panel open":"review|comment panel off")},n.insertComment=n.insertComment.bind(n),n.selectComment=n.selectComment.bind(n),n.onVisibleChange=n.onVisibleChange.bind(n),n.handleShowCommentsTips=n.handleShowCommentsTips.bind(n),window.APP&&window.APP.appApi&&window.APP.appApi.getCommentShowStatus){var i=window.APP.appApi.getCommentShowStatus(),o=i.commentBubble,s=i.commentPanel;n.state=a()({},n.state,{showComment:o,showCommentPanel:s})}return n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.bindEvent(),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.comment", "Comment"),icon:mt.insert_comment,items:[{icon:mt.insert_comment,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.insertComment", "Add Comment"),shortcut:"Ctrl+Alt+M"},{icon:mt.display_comment,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.displayCommentBubble", "Show Comment Box")},{icon:mt.wps_comment_panel,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.displayCommentPanel", "Show Comment Panel")}]})}},{key:"componentWillUnmount",value:function(){this.unbindEvent()}},{key:"onVisibleChange",value:function(e){this.setState({visible:e}),e&&window.collection("commandbar","click","review|comment")}},{key:"insertComment",value:function(){if(Object(st.isReadingMode)())return Object(st.closeReadingMode)(),!1;this.onVisibleChange(!1),this.props.inRestrictEditMode||(te.default.dispatchEvent(te.default.comments.OPEN_COMMENTS_DIALOG_BY_BTN),window.collection("commandbar","click","review|comment_insert"))}},{key:"bindEvent",value:function(){window.addEventListener(te.default.comments.CHECKED_COMMENTS_DROPDOWN,this.handleShowCommentsTips),window.addEventListener(te.default.comments.CANCEL_SELECT_COMMENT_PANEL,this.cancleSelectCommentPanel),window.addEventListener(te.default.comments.SET_COMMENT_OR_COMMENT_PANEL_CHECKED,this.setCommentOrCommentPanelChecked),te.default.dispatchEvent(te.default.comments.COMMENTS_LOADED)}},{key:"unbindEvent",value:function(){window.removeEventListener(te.default.comments.CHECKED_COMMENTS_DROPDOWN,this.handleShowCommentsTips),window.removeEventListener(te.default.comments.CANCEL_SELECT_COMMENT_PANEL,this.cancleSelectCommentPanel),window.removeEventListener(te.default.comments.SET_COMMENT_OR_COMMENT_PANEL_CHECKED,this.setCommentOrCommentPanelChecked)}},{key:"handleShowCommentsTips",value:function(e){this.state.showComment!==e.detail.checked&&this.setState({showComment:e.detail.checked})}},{key:"selectComment",value:function(){var e=this.state,t=e.showComment,n=e.showCommentPanel;this.onVisibleChange(!1),this.setState({showComment:t,showCommentPanel:!1}),window.APP.appApi.showComments({checked:!t}),window.APP.appApi.setCommentShowStatus({commentBubble:!t,commentPanel:!1}),t||te.default.dispatchEvent(te.default.revision.SHOW_REVISION_BUBBLE,{visible:!0}),window.collection("commandbar","click","review|comment_"+(t?"off":"on")),!t&&n&&(te.default.dispatchEvent(te.default.taskPane.CLOSE_TASK_PANEL),te.default.dispatchEvent(te.default.taskPane.KILL_COMMENT_PANEL))}},{key:"handleCloseCommentPanel",value:function(){te.default.dispatchEvent(te.default.taskPane.CLOSE_TASK_PANEL),te.default.dispatchEvent(te.default.taskPane.KILL_COMMENT_PANEL)}},{key:"renderDropdownPanel",value:function(){var e=this.props.connected,t=!e||window.APP.functionStatus.comment.entryInReviewTab.disabled;return f.a.createElement(ut,{selectable:!0,offsetX:-1},f.a.createElement(ot.a,{title:""+Object(_e.convertCtrl)("Ctrl+Alt+M")},f.a.createElement("div",null,f.a.createElement(pt,{className:"revision-item",key:"insert_comment",value:"insert_comment",disabled:t,onClick:this.insertComment},f.a.createElement(lt.default,{size:16}),f.a.createElement("span",{className:"item-name"},_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.insertComment", "Add Comment"))))),f.a.createElement(pt,{className:"revision-item",key:"display_comment",value:"display_comment",selected:this.state.showComment,disabled:!e,onClick:this.selectComment},f.a.createElement(ct.a,{size:16,fill:Y.defaultFill}),f.a.createElement("span",{className:"item-name"},_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.displayCommentBubble", "Show Comment Box"))),f.a.createElement(pt,{className:"revision-item",key:"display_comment_panel",value:"display_comment_panel",altHintKeep:"true",selected:this.state.showCommentPanel,disabled:!e,onClick:this.selectCommentPanel},f.a.createElement(dt.a,{size:16,fill:Y.defaultFill}),f.a.createElement("span",{className:"item-name"},_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.displayCommentPanel", "Show Comment Panel"))))}},{key:"render",value:function(){var e=this,t=this.props.connected,n=this.state.visible,i=this.renderDropdownPanel();return f.a.createElement(U.default,{className:"comment-group prevent-focus-in-ipad",panel:i,visible:n,onVisibleChange:this.onVisibleChange},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},isDropdown:!0,icon:f.a.createElement(lt.default,{size:16}),disabled:!t,selected:n},_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.comment", "Comment")))}}]),t}(m.PureComponent),ht=Object(ge.connect)((function(e){return e}),(function(e){return{actions:Object(it.bindActionCreators)(a()({},rt),e)}}))(ft),gt=n(247),wt=n(16074),vt=n.n(wt),bt=n(16075),Ct=n.n(bt),Et=n(2555),yt=V.a.iconTypes.size16,_t=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showOpenDialog:!1,showCloseDialog:!1},n.handleClick=n.handleClick.bind(n),n.handleDialogClose=n.handleDialogClose.bind(n),n.handleContextMenuClick=n.handleContextMenuClick.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener(te.default.restrictEdit.SHOW_RESTRICT_OPEN_DIALOG,this.handleContextMenuClick),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.restrictEdit", "Restrict Editing"),icon:yt.restrict_edit})}},{key:"componentWillUnmount",value:function(){window.removeEventListener(te.default.restrictEdit.SHOW_RESTRICT_OPEN_DIALOG,this.handleContextMenuClick)}},{key:"handleContextMenuClick",value:function(){this.handleClick()}},{key:"handleClick",value:function(){var e=this.props.inRestrictEditMode;this.setState({showOpenDialog:!e,showCloseDialog:e}),window.collection("commandbar","click","review_start_limit")}},{key:"handleDialogClose",value:function(){var e=window.APP;e.workspace.switchIndicatorVisibility(!0),this.setState({showOpenDialog:!1,showCloseDialog:!1}),e.formatContentController.isRestrictEditMode&&!e.formatContentController.checkIsInContentControl()||e.workspace.focusWithoutScroll()}},{key:"render",value:function(){var e=this,t=this.props,n=t.inRestrictEditMode,i=t.disableControls,a=t.file,o=this.state,r=o.showOpenDialog,s=o.showCloseDialog,l=this.props.disabled,c=!0,d=n&&_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.closeRestrictEdit", "Stop Editing Restriction")||_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.openRestrictEdit", "Enable Editing Restriction"),u=null,p=!1;window.APP&&(c=(u=window.APP.restrictEditHandler)&&u.isRestrictProtectOn,l=l||c&&!n||window.APP.data.doc.isTXTDocument,!n&&window.APP.functionStatus.altMode.isInAltMode&&(window.APP.formatContentController.getAllOuterMostControls().length>0||(p="true")));return f.a.createElement("div",{className:"restrict-edit"},f.a.createElement(V.a,{size:"middle","alt-hint-keep":p?"true":"false","alt-render-delay":"300",ref:function(t){e.refBtn=t},icon:f.a.createElement(Et.a,{size:16,fill:[Y.iDefault,Y.iGreen]}),disabled:l,selected:!1,onClick:this.handleClick},d),u&&n&&s&&Object(gt.default)(vt.a,{disabled:l,onClose:this.handleDialogClose}),u&&!c&&r&&Object(gt.default)(Ct.a,{disabled:l,onClose:this.handleDialogClose,disableControls:i,file:a}))}}]),t}(m.Component),kt=n(299),Pt=n(1385),St=V.a.iconTypes.size16,Tt=window.CommandBarComponentFragment,Mt=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={checked:!1},n.handleClick=n.handleClick.bind(n),n.changeCooperationHandle=n.changeCooperationHandle.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.highlightCooperation", "Highlight Collaboration Content"),icon:St.highlight_cooperation}),window.addEventListener(te.default.cooperation.CHANGE_COOPERATION_STATUS,this.changeCooperationHandle)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(te.default.cooperation.CHANGE_COOPERATION_STATUS,this.changeCooperationHandle)}},{key:"handleClick",value:function(){var e=this.state.checked;this.setState({checked:!e}),window.APP.appApi.switchToCooperationMode(!e),window.collection("commandbar","click","review|content_highlight_"+(e?"off":"on"))}},{key:"changeCooperationHandle",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.connected,n=this.state.checked;return f.a.createElement(Tt,{cmbId:kt.wps.HighlightCooperation},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},icon:f.a.createElement(Pt.a,{size:16}),disabled:!t,selected:n,onClick:this.handleClick},_i18n("applications.writer.components.CommandBars.RbTab.Home.Revision.highlightCooperation", "Highlight Collaboration Content")))}}]),t}(m.PureComponent),Ot=(n(16076),n(259)),Rt=n.n(Ot),It=n(1764),Nt=V.a.iconTypes.size16,Dt=window.CommandBarComponent,At=Dt.cmbIds.wps,Bt=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,At.ReviewTrackChanges));return n.changeTrackChanges=function(e){var t=e?"revision":"edit",i=n.state.list.map((function(e){return n.app.data.doc&&0===n.app.data.doc.getProtType()&&"edit"===e.name&&(e.disabled=!0),"revision"===t&&"revision"===e.name&&te.default.dispatchEvent(te.default.cooperation.CHANGE_COOPERATION_STATUS,{disabled:!0,checked:!1}),e.checked=e.name===t,e}));n.setState({list:i,visible:!1})},n.handleClick=function(){var e=Number(!n.curr),t=n.state.list,i=t[e];if(i.disabled)return n.app.workspace.showToast("error",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.protectRevision", "Client revision protection turned on")),n.setState({visible:!1}),!1;var a=t.map((function(e){return e.checked=e.name===i.name,e}));n["select"+i.name.replace(/( |^)[a-z]/g,(function(e){return e.toUpperCase()}))](),n.setState({list:a,visible:!1}),window.APP.workspace.focusWithoutScroll()},n.trackChange=n.trackChange.bind(n),n.state={list:[{name:"edit",title:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revision", "Revision"),subTitle:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.editTip", "Inline Editing"),shortTitle:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.edit", "Edit"),checked:!0,disabled:!1},{name:"revision",title:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revision", "Revision"),subTitle:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revisionTip", "Record changes to the document"),shortTitle:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revision", "Revision"),checked:!1,disabled:!1}],available:!1,visible:!1},n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.changeTrackChanges(this.app.data.doc.textStream.getRevisionTextStream().isTrackingChanges),window.addEventListener(te.default.comments.CHECKED_COMMENTS_DROPDOWN,this.cancelAllChoses),window.addEventListener(te.default.revision.REVISION_TRACK_CHANGE,this.trackChange),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revision", "Revision"),icon:Nt.revision_modify})}},{key:"componentWillUnmount",value:function(){window.removeEventListener(te.default.comments.CHECKED_COMMENTS_DROPDOWN,this.cancelAllChoses),window.removeEventListener(te.default.revision.REVISION_TRACK_CHANGE,this.trackChange)}},{key:"trackChange",value:function(e){var t=e.detail,n=t.isTrackingChanges,i=t.initiatorUserID;if(this.props.public.user&&this.props.public.user.id&&i&&i!==this.props.public.user.id){var a=this.app.data.selection.selCoop.onLineCooperators.get(i);this.app.workspace.showToast("warn",""+a.name+(n?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.openRevision", "Track Changes: On"):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.closeRevision", "Track Changes: Off")))}this.changeTrackChanges(n)}},{key:"selectEdit",value:function(){te.default.dispatchEvent(te.default.cooperation.CHANGE_COOPERATION_STATUS,{disabled:!1,checked:!1}),te.default.dispatchEvent(te.default.revision.ENABLE_REVISION,{enable:!1}),window.collection("commandbar","click",this.props.resource&&"home"===this.props.resource?"home|state_closed":"review|state_closed")}},{key:"selectRevision",value:function(){te.default.dispatchEvent(te.default.cooperation.CHANGE_COOPERATION_STATUS,{disabled:!0,checked:!1}),te.default.dispatchEvent(te.default.revision.ENABLE_REVISION,{enable:!0}),window.collection("commandbar","click",this.props.resource&&"home"===this.props.resource?"home|state_opend":"review|state_opend")}},{key:"selectView",value:function(){}},{key:"cancelAllChoses",value:function(){}},{key:"renderTooltip",value:function(e){return"cooperation"===e?f.a.createElement("div",{className:"revision-tip-wrap"},f.a.createElement("div",{className:"revision-tip-title"}),f.a.createElement("div",{className:"revision-tip-detail"})):null}},{key:"render",value:function(){var e=this,t=this.props.disabled,n=this.state.list;n.forEach((function(t,n){t.checked&&(e.curr=n)}));var i=n&&n[this.curr]?n[this.curr].title:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.revision", "Revision"),a=1===this.curr,o=a?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.exitRevision", "Close revision"):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionModify.startRevision", "Open revision");return f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},title:o,icon:f.a.createElement(It.default,{size:16,fill:Y.defaultFill}),disabled:t,selected:a,onClick:this.handleClick},i)}},{key:"app",get:function(){return window.APP}}]),t}(Dt);Bt.propTypes={disabled:Rt.a.bool,inRestrictEditMode:Rt.a.bool};var Lt=Object(ge.connect)((function(e){return e}),(function(e){return{actions:Object(it.bindActionCreators)(a()({},rt),e)}}))(Bt),Ht=n(80),Ft=n.n(Ht),Wt=n(580),Ut=n(8),xt=n.n(Ut),Vt=n(616),jt=n(385),zt=n(258),Gt=n.n(zt),Kt=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelect=function(e){e.action(),n.props.handleVisibleChange(!1)},n.handleClick=function(){n.state.enable&&n._action&&n._action(),n.props.handleVisibleChange(!1)},n.state={id:e.id,caption:e.caption,enable:!0,visible:!0,panelItems:[]},n}return p()(t,e),l()(t,[{key:"renderItems",value:function(){var e=this,t=this.props.disabled,n=this.state.panelItems,i=jt.default,a=t||window.APP.data.doc.isTXTDocument;return n.map((function(t){return f.a.createElement(i,{key:t.key,onClick:e.handleSelect.bind(e,t),disabled:a},f.a.createElement("span",null,t.caption))}))}},{key:"render",value:function(){var e=this.props.hideSubMenu,t=this.state,n=t.caption,i=t.panelItems,a=t.enable,o=this.renderItems(),r=f.a.createElement("div",null,n);return 0!==i.length?f.a.createElement(Vt.default,{subClassName:Gt()({"wps-hide":e}),title:r},o):f.a.createElement(Wt.default.Item,{disabled:!a,disabledTag:!1,onClick:this.handleClick,className:"panel-item"},f.a.createElement("span",null,r))}},{key:"caption",set:function(e){this.setState({caption:e})},get:function(){return this.state.caption}},{key:"panelItems",set:function(e){this.setState({panelItems:e})},get:function(){return this.state.panelItems}},{key:"id",get:function(){return this.state.id}},{key:"action",set:function(e){this._action=e},get:function(){return this._action}},{key:"enable",set:function(e){this.setState({enable:e})},get:function(){return this.state.enable}},{key:"visible",set:function(e){this.setState({visible:e})},get:function(){return this.state.visible}}]),t}(m.PureComponent),Yt=function(e){function t(){var e,n,i,a;r()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={items:[]},a=n,d()(i,a)}return p()(t,e),l()(t,[{key:"add",value:function(e){var t=this,n=e.id,i=e.caption,a=void 0===i?null:i;if(this.state.items.find((function(e){return e.id===n})))throw new Error("该控件ID已存在："+n);var o=[].concat(xt()(this.state.items));return o.push({id:n,caption:a}),new Promise((function(e){t.setState({items:o},(function(){return e(t._refMap[n].el)}))}))}},{key:"remove",value:function(e){var t=this.state.items.filter((function(t){return t.id!==e}));return this.setState({items:t}),!0}},{key:"_ref",value:function(e){var t=this;return this._refMap=this._refMap||{},this._refMap[e]||(this._refMap[e]={cb:function(n){return t._refMap[e].el=n}}),this._refMap[e]}},{key:"render",value:function(){var e=this,t=this.state.items;return 0===t.length?null:t.map((function(t,n){return f.a.createElement(Kt,a()({key:t.id,ref:e._ref(t.id).cb},t,{handleVisibleChange:e.props.handleVisibleChange}))}))}}]),t}(m.PureComponent);n(16077);function Xt(e){var t=e.disabled,n=e.hideSubMenu,i=e.handleVisibleChange;var a,o={keepEdit:!0,name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.acceptRevision", "Accept revision"),disabled:t},r=(a=t||window.APP.data.doc.isTXTDocument,Object.values(Zt).map((function(e){var t=function(e){var t=window.APP.editor.acceptAllRevisions(e);e?window.collection("commandbar","click","review|accept format revisions"):window.collection("commandbar","click","review|accept revisions"),t&&window.APP.focusInput(),i(!1)},n=void 0;switch(e.name){case Zt.acceptAllRevision.name:n=function(){return t(!1)};break;case Zt.acceptAllFormatRevision.name:n=function(){return t(!0)}}return f.a.createElement(jt.default,{key:e.name,title:e.tip,onClick:n,disabled:a},f.a.createElement("span",null,e.name))}))),s=f.a.createElement("div",null,o.name);return f.a.createElement(Vt.default,{subClassName:Gt()({"wps-hide":n}),title:s,disabled:t},r)}var Zt={acceptAllRevision:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.acceptAllRevision", "Accept all revisions")},acceptAllFormatRevision:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.acceptAllFormatRevision", "Accept all format revisions")}};function Qt(e){var t=e.disabled,n=e.hideSubMenu,i=e.handleVisibleChange;var a,o,r={keepEdit:!0,name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.rejectRevision", "Refuse to amend"),disabled:t},s=(a=t||window.APP.data.doc.isTXTDocument,o=function(e){var t=window.APP.editor.rejectAllRevisions(e);e?window.collection("commandbar","click","review|reject format revisions"):window.collection("commandbar","click","review|reject revisions"),t&&window.APP.focusInput(),i(!1)},Object.values($t).map((function(e){var t=void 0;switch(e.name){case $t.rejectAllRevision.name:t=function(){return o(!1)};break;case $t.rejectAllFormatRevision.name:t=function(){return o(!0)}}return f.a.createElement(jt.default,{key:e.name,title:e.tip,onClick:t,disabled:a},f.a.createElement("span",null,e.name))}))),l=f.a.createElement("div",null,r.name);return f.a.createElement(Vt.default,{subClassName:Gt()({"wps-hide":n}),title:l,disabled:t},s)}var $t={rejectAllRevision:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.rejectAllRevision", "Reject all revisions")},rejectAllFormatRevision:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.rejectAllFormatRevision", "Reject all format revisions")}},Jt=n(629),qt=n.n(Jt),en=n(1283),tn=n(515),nn=n.n(tn);n(16078);function an(){return f.a.createElement("div",{className:"revision-setting-tips"},f.a.createElement("p",{className:"revision-setting-tips-name"},_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.syncRevisionTips", "After opening, you can synchronize your reading view to the current collaborator.")),f.a.createElement(nn.a,{border:!1,config:nn.a.Config.wps.SyncRevisionsStauts}))}var on=function(){return nn.a.preload(nn.a.Config.wps.SyncRevisionsStauts)},rn=n(250),sn=n.n(rn),ln=n(911);function cn(e){var t=e.disabled,n=e.hideSubMenu,i=e.handleVisibleChange,a=e.getCoopUsers,o=Object(m.useRef)(null),r=Object(m.useState)(0),s=he()(r,2)[1],l=Object(m.useState)(!1),c=he()(l,2),d=c[0],u=c[1],p=Object(m.useState)(!1),h=he()(p,2),g=h[0],w=h[1];Object(m.useEffect)((function(){on()}),[]);var v,b,C,E,y,_={keepEdit:!0,name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.revisionStatus", "Revision Status"),disabled:t},k=(v=jt.default,b=t||window.APP.data.doc.isTXTDocument,C=function(e,t){window.APP.editor.viewSettings.changeRevisionsStatus(e,t),e?t?window.collection("commandbar","click","review|final state of mark"):window.collection("commandbar","click","review|final state"):t?window.collection("commandbar","click","review|original state of mark"):window.collection("commandbar","click","review|original state"),window.APP.focusInput(),i(!1)},E=window.APP.data.doc.viewSettings,y=function(){E.getRevisionsSettingsSyncCoop()?(window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!1),s(Date.now()),window.collection("commandbar","click","review|turn off sync")):(a().length>0?u(!0):(window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!0),s(Date.now())),window.collection("commandbar","click","review|turn on sync"))},Object.values(dn).map((function(e){var t=void 0,n=!1;switch(e.name){case dn.showFinalStatus.name:t=function(){return C(!0,!0)},n=E.isRevisionsFinalView()&&E.getRevisionsShowMarkup();break;case dn.finalStatus.name:t=function(){return C(!0,!1)},n=E.isRevisionsFinalView()&&!E.getRevisionsShowMarkup();break;case dn.showInitalStatus.name:t=function(){return C(!1,!0)},n=!E.isRevisionsFinalView()&&E.getRevisionsShowMarkup();break;case dn.initalStatus.name:t=function(){return C(!1,!1)},n=!E.isRevisionsFinalView()&&!E.getRevisionsShowMarkup();break;case dn.syncTeamworker.name:return n=E.getRevisionsSettingsSyncCoop(),f.a.createElement(v,{className:"revision-setting-item",key:e.name,title:e.tip,onClick:t,disabled:b},f.a.createElement("span",{className:"revision-switch-content"},e.name),f.a.createElement(sn.a,{title:f.a.createElement(an,null),onMouseLeave:function(){return w(!1)},onMouseEnter:function(){return w(!0)},visible:_e.isPad?g:void 0,getElement:function(){return o.current}},f.a.createElement("span",{className:"revision-question",ref:function(e){return o.current=e},onClick:_e.isPad?function(){return w(!g)}:void 0},f.a.createElement(ln.default,{size:16,fill:["#757575"]}))),f.a.createElement(qt.a,{checked:n,onChange:y}))}return f.a.createElement(v,{key:e.name,title:e.tip,onClick:t,disabled:b,selected:n},f.a.createElement("span",null,e.name))}))),P=f.a.createElement("div",null,_.name);return f.a.createElement(f.a.Fragment,null,f.a.createElement(Vt.default,{selectable:!0,onVisibleChange:function(e){e||w(!1)},subClassName:Gt()({"wps-hide":n}),title:P,disabled:t||window.APP.data.doc.useCoreTypo},k),d&&f.a.createElement(en.default,{className:"revision-setting-sync-modal",onOk:function(){window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!0),u(!1)},onCancel:function(){u(!1)}},_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.syncTeamworkerText", "{0} and others are using the document, enabling synchronization may affect the reading interface of others").replace("{0}",a()&&a()[0].name)))}var dn={syncTeamworker:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.syncTeamworker", "Sync to collaborators")},showFinalStatus:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showFinalStatus", "Show the final state of the mark")},finalStatus:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.finalStatus", "Final state")},showInitalStatus:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showInitalStatus", "Show the original state of the mark")},initalStatus:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.initalStatus", "Original state")}};function un(e){var t=e.disabled,n=e.hideSubMenu,i=e.handleVisibleChange,a=e.getCoopUsers,o=Object(m.useRef)(null),r=Object(m.useState)(0),s=he()(r,2)[1],l=Object(m.useState)(!1),c=he()(l,2),d=c[0],u=c[1],p=Object(m.useState)(!1),h=he()(p,2),g=h[0],w=h[1];Object(m.useEffect)((function(){on()}),[]);var v,b,C,E,y,_={keepEdit:!0,name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.revisionModal", "Revision box"),disabled:t},k=(v=jt.default,b=t||window.APP.data.doc.isTXTDocument,C=function(e){window.APP.editor.viewSettings.changeShowRevisionsFrame(e),window.APP.focusInput(),e?window.collection("commandbar","click","review|show revision box"):window.collection("commandbar","click","review|hide revision box"),i(!1)},E=window.APP.data.doc.viewSettings,y=function(){E.getRevisionsSettingsSyncCoop()?(window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!1),s(Date.now()),window.collection("commandbar","click","review|turn off sync")):(a().length>0?u(!0):(window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!0),s(Date.now())),window.collection("commandbar","click","review|turn on sync"))},Object.values(pn).map((function(e){var t=void 0,n=!1;switch(e.name){case pn.showRevisionModal.name:t=function(){return C(!0)},n=E.getRevisionsFrameShow();break;case pn.hideRevisionModal.name:t=function(){return C(!1)},n=!E.getRevisionsFrameShow();break;case pn.syncTeamworker.name:return n=E.getRevisionsSettingsSyncCoop(),f.a.createElement(v,{className:"revision-setting-item",key:e.name,title:e.tip,onClick:t,disabled:b},f.a.createElement("span",{className:"revision-switch-content"},e.name),f.a.createElement(sn.a,{className:"sync_revision_setting_tips",title:f.a.createElement(an,null),onMouseLeave:function(){return w(!1)},onMouseEnter:function(){return w(!0)},visible:g,getElement:function(){return o.current}},f.a.createElement("span",{className:"revision-question",ref:function(e){return o.current=e},onClick:_e.isPad?function(){return w(!g)}:void 0},f.a.createElement(ln.default,{size:16,fill:["#757575"]}))),f.a.createElement(qt.a,{checked:n,onChange:y}))}return f.a.createElement(v,{key:e.name,title:e.tip,onClick:t,disabled:b,selected:n},f.a.createElement("span",null,e.name))}))),P=f.a.createElement("div",null,_.name),S=t;return f.a.createElement(f.a.Fragment,null,f.a.createElement(Vt.default,{selectable:!0,onVisibleChange:function(e){e||w(!1)},subClassName:Gt()({"wps-hide":n}),title:P,disabled:S},k),d&&f.a.createElement(en.default,{className:"revision-setting-sync-modal",onOk:function(){window.APP.editor.viewSettings.switchSyncCoopRevisionsSettings(!0),window.collection("commandbar","click","review|turn on sync"),u(!1)},onCancel:function(){u(!1)}},_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.syncTeamworkerText", "{0} and others are using the document, enabling synchronization may affect the reading interface of others").replace("{0}",a()&&a()[0].name)))}var pn={syncTeamworker:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.syncTeamworker", "Sync to collaborators")},showRevisionModal:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showRevisionModal", "Show revision box")},hideRevisionModal:{name:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.hideRevisionModal", "Hide revision box")}},mn=n(227),fn=V.a.iconTypes.size16,hn=function(){var e=[];return window.APP.data.selection.selCoop.coopInfo.cooperCenter._users.forEach((function(t){t.id!==window.APP.info.userid&&e.push(t)})),e},gn=window.CommandBarComponent,wn=gn.cmbIds.wps,vn=function(e){function t(e){var n=this;r()(this,t);var i,a=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,wn.RevisionSetting));return a.state={visible:!1,isShowModal:!1},a.update=function(){a.forceUpdate()},a.refCustom=f.a.createRef(),a.addChild=(i=Ft()(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mn.default.dispatchEvent(mn.default.names.SWITCH_COMMANDBAR_TAB,{tabKey:"ReviewTab"}),e.abrupt("return",new Promise((function(e){a.setState({visible:!0},Ft()(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.refCustom.current.add({id:t,caption:i});case 2:r=n.sent,e(r);case 4:case"end":return n.stop()}}),o,n)}))))})));case 2:case"end":return e.stop()}}),e,n)}))),function(e,t){return i.apply(this,arguments)}),a.remove=function(e){return a.refCustom.current.remove(e)},a.handleVisibleChange=a.handleVisibleChange.bind(a),a.forceUpdate=a.forceUpdate.bind(a),a}var n;return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.revisionSetting", "Revision settings"),icon:fn.revision_status_setting}),window.addEventListener(te.default.revision.REVISION_SETTINGS_CHANGE,this.update),window.addEventListener(te.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,this.update)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(te.default.revision.REVISION_SETTINGS_CHANGE,this.update),window.removeEventListener(te.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,this.update)}},{key:"handleVisibleChange",value:function(e){var t="boolean"==typeof e?e:!this.state.visible;this.setState({visible:t}),e&&window.collection("commandbar","click","review|revision settings")}},{key:"add",value:(n=Ft()(regeneratorRuntime.mark((function e(t){var n,i=t.id,a=t.caption,o=void 0===a?null:a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.addChild(i,o);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"renderPanel",value:function(){var e=this,t=window.APP.data.selection.selContext.isParagraphSetting,n=window.APP.formatContentController.isRestrictEditMode,i=window.APP.restrictEditHandler,a=i.isInReadonlyProtectMode,o=i.isInCommentProtectMode,r=window.APP.data.doc.viewSettings.getRevisionsShowMarkup(),s=window.APP.isCooperationMode,l=this.props.disabled,c=a||o||l||t||n,d=window.APP.appApi.getCommentShowStatus().commentPanel,u=window.APP.workspace.revisionComment.isShowRevisionBtn;return f.a.createElement(Wt.default,{triggerSubMenuAction:"hover",className:"wps-dropdown-submenu",ref:function(t){return e.Child=t},handleVisibleChange:this.handleVisibleChange},u&&f.a.createElement(Xt,{disabled:c,handleVisibleChange:this.handleVisibleChange}),u&&f.a.createElement(Qt,{disabled:c,handleVisibleChange:this.handleVisibleChange}),f.a.createElement(cn,{disabled:l||s,handleVisibleChange:this.handleVisibleChange,getCoopUsers:hn}),f.a.createElement(un,{disabled:l||!r||s||d,handleVisibleChange:this.handleVisibleChange,getCoopUsers:hn}),f.a.createElement(Yt,{ref:this.refCustom,handleVisibleChange:this.handleVisibleChange}))}},{key:"render",value:function(){var e=this,t=this.renderPanel(),n=this.state.visible,i=this.props.disabled;return f.a.createElement(U.default,{panel:t,className:"prevent-focus-in-ipad",visible:n,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},isDropdown:!0,icon:f.a.createElement(z.a,{size:16}),disabled:i,selected:n},_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.revisionSetting", "Revision settings")))}}]),t}(gn);vn.propTypes={isSubMenu:Rt.a.bool,showText:Rt.a.bool,disabled:Rt.a.bool,hideSubMenu:Rt.a.bool,isFromInsertTab:Rt.a.bool};var bn=vn,Cn=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getItems=n.getItems.bind(n),n}return p()(t,e),l()(t,[{key:"getItems",value:function(){var e=this;return Object.keys(this.refMap).map((function(t){return e.refMap[t].el}))}},{key:"componentDidMount",value:function(){window.addEventListener(te.default.revision.REVISION_SETTINGS_CHANGE,this.revisionSettingsChange)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(te.default.revision.REVISION_SETTINGS_CHANGE,this.revisionSettingsChange)}},{key:"revisionSettingsChange",value:function(e){var t=e.detail;if(0!==Object.keys(t).length&&t.userId!==window.APP.info.userid){var n=window.APP.data.selection.selCoop.coopInfo.coopInfos.filter((function(e){return e.userid===t.userId}))[0],i=n&&n.username||"",a="";t.hasOwnProperty("syncCoopRevisionsSettings")?a=t.syncCoopRevisionsSettings?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.openSyncRevisionSettings", "{0} Revision setting synchronization is turned on").replace("{0}",i):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.closeSyncRevisionSettings", "{0} Turn off synchronization of revision settings").replace("{0}",i):void 0!==t.revisionsView||void 0!==t.showMark?a=t.showMark?t.revisionsView?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionStatus", "{0} set the revision status to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showInitalStatus", "Show the original state of the mark")):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionStatus", "{0} set the revision status to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showFinalStatus", "Show the final state of the mark")):t.revisionsView?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionStatus", "{0} set the revision status to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.initalStatus", "Original state")):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionStatus", "{0} set the revision status to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.finalStatus", "Final state")):void 0!==t.showRevisionsFrame&&(a=t.showRevisionsFrame?_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionModal", "{0} The revision box status is set to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.showRevisionModal", "Show revision box")):_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.settingRevisionModal", "{0} The revision box status is set to {1}").replace("{0}",i).replace("{1}",_i18n("applications.writer.components.CommandBars.RbTab.Home.RevisionSetting.hideRevisionModal", "Hide revision box"))),a&&window.Toast.info(a)}}},{key:"render",value:function(){var e,t=this.props,n=t.tabKey,i=t.readOnly,a=t.visible,o=t.connected,r=t.inRestrictEditMode,s=t.isTemplate,l=t.user,c=t.disableControls,d=t.file,u=t.selectionInfo,p=t.isParagraphSetting,m=u.isInReadonlyDocumentField,h=!o||i,w=l&&l.isLogin,v=!0,b=window.__CONFIG__.wps,C=b.useLowPerformanceMode,E=b.disableRevisionComment,y=!0;if(e=y=!C&&!E,window.APP){var _=window.APP.restrictEditHandler;v=_&&_.isRestrictProtectOn,window.APP.functionStatus.comment.entryInReviewTab.visible||(y=!1)}var k=!window.APP.coreDataInvalid()&&!window.APP.data.doc.revisions.empty();return f.a.createElement(g.a,{tabKey:n,visible:a,getItems:this.getItems},f.a.createElement("div",null,y&&f.a.createElement(ht,{connected:o,readOnly:i,inRestrictEditMode:r,isInReadonlyDocumentField:m}),f.a.createElement(Mt,{connected:o}),e&&f.a.createElement(Lt,{disabled:h||v||!w,inRestrictEditMode:r}),f.a.createElement(bn,{disabled:h||!k,showText:!0}),f.a.createElement(_t,{disabled:h||s||!!p,inRestrictEditMode:r,disableControls:c,file:d})))}}]),t}(m.PureComponent),En=(n(16079),n(2698)),yn=n(2618);var _n=f.a.memo((function(e){var t=e.disabled,n=Object(m.useState)(!1),i=he()(n,2),a=i[0],o=i[1],r=Object(m.useState)(!1),s=he()(r,2),l=s[0],c=s[1],d=window.APP.workspace.spellCheckManager.spellCheckSwitch.isAutoOpen,u=Object(m.useRef)(null);Object(m.useEffect)((function(){window.__WPSENV__.commandbars.push({el:u.current,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.spellCheck", "Spell Check"),icon:V.a.iconTypes.size16.spell_check_enabled})}),[]);var p=f.a.createElement(Wt.default,{selectable:!0,className:"spell-check-panel"},f.a.createElement(Wt.default.Item,{selected:d,disabled:t,className:"spell-check-switcher panel-item",onClick:function(){if(d){var e=window.APP.workspace.spellCheckManager.checkCore,t=window.APP.data.doc.concernRanges.reduce((function(t,n){return t+e.spellingMarks.collect(n.pos,n.len).length}),0),n=Object(En.a)(),i=e.spellingCheckAcceptWords;window.collection("commandbar","click","review|checkspelling_off"),window.collection("checkspelling",{language:"en-us",mistake:t,neglect:e.spellingCheckIgnoreWords.ignoreWordCount(),accept:i.acceptWordsCount,fileid:n})}else window.collection("commandbar","click","review|checkspelling_on");window.APP.workspace.spellCheckManager.spellCheckSwitch.autoOpen(!d),o(!1)}},f.a.createElement("div",{className:"item-content"},f.a.createElement("div",{className:"title vertical-center"},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.spellCheck", "Spell Check")),f.a.createElement("div",{className:"notice vertical-center"},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.spellCheckNotice", "*For the time being, only English (U.S.) automatic detection is supported*")))),f.a.createElement(Wt.default.Item,{disabled:t||!d,onClick:function(){d?c(!0):window.Toast.info(_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.spellCheckNotEnabled", "Spell check is not turned on")),o(!1)},className:"panel-item"},f.a.createElement("span",null,_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.clearAllIgnoredWords", "Clear ignored words")))),h=f.a.createElement(yn.a,{size:16});return f.a.createElement(f.a.Fragment,null,f.a.createElement(U.default,{className:"wps-spell-check-entry",panel:p,visible:a,onVisibleChange:function(e){o(e)}},f.a.createElement(V.a,{size:"middle",ref:u,disabled:t,isDropdown:!0,icon:h,selected:a},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.spellCheck", "Spell Check"))),l&&f.a.createElement(en.default,{onOk:function(){window.APP.workspace.spellCheckManager.checkCore.spellingCheckIgnoreWords.clearAll(),c(!1),window.Toast.success(_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.clearSuccess", "Cleanup complete"))},onCancel:function(){return c(!1)}},f.a.createElement("div",null,_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.deleteIgnoreTable", "Are you sure to clear the spelling of ignored words?"))))})),kn=n(1755),Pn=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.exportPdf", "Export as PDF")})}},{key:"handleClick",value:function(){mn.default.dispatchEvent(mn.default.names.file.ON_EXPORT_PDF),window.collection("commandbar","click","tools_export_pdf")}},{key:"render",value:function(){var e=this,t=this.props.disabled;return f.a.createElement("div",{className:"restrict-edit"},f.a.createElement(V.a,{size:"middle",altHintKeep:"true",ref:function(t){e.refBtn=t},icon:f.a.createElement(kn.a,{size:16,fill:Y.defaultFill}),disabled:t,selected:!1,onClick:this.handleClick},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.exportPdf", "Export as PDF")))}}]),t}(m.Component),Sn=n(1059),Tn=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.exportImg", "Export as image")})}},{key:"handleClick",value:function(){mn.default.dispatchEvent(mn.default.names.file.ON_EXPORT_IMG),window.collection("commandbar","click","tools_export_img")}},{key:"render",value:function(){var e=this,t=this.props.disabled;return f.a.createElement("div",{className:"restrict-edit"},f.a.createElement(V.a,{size:"middle",altHintKeep:"true",ref:function(t){e.refBtn=t},icon:f.a.createElement(Sn.a,{size:16,fill:Y.defaultFill}),disabled:t,selected:!1,onClick:this.handleClick},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.exportImg", "Export as image")))}}]),t}(m.Component),Mn=n(4750),On=n(2616),Rn=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.intellFormatArrange", "Intelligent format arrangement")})}},{key:"handleClick",value:function(){window.APP.editor.cmdExecutor.wordToolCmdExec.executeCMD(Mn.f),window.collection("commandbar","click","tools_start_intell_format_arrange")}},{key:"render",value:function(){var e=this,t=this.props.disabled;return f.a.createElement("div",{className:"restrict-edit"},f.a.createElement(V.a,{size:"middle",ref:function(t){e.refBtn=t},title:_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.intellFormatArrangeTips", "Deletes blank spaces at the start of paragraph and blank paragraphs, and indents with 2 characters at the first line of the paragraph"),icon:f.a.createElement(On.a,{size:16,fill:[Y.iDefault,Y.iRed]}),disabled:t,selected:!1,onClick:this.handleClick},_i18n("applications.writer.components.CommandBars.RbTab.Home.ToolsTab.intellFormatArrange", "Intelligent format arrangement")))}}]),t}(m.Component),In=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getItems=n.getItems.bind(n),n}return p()(t,e),l()(t,[{key:"getItems",value:function(){var e=this;return Object.keys(this.refMap).map((function(t){return e.refMap[t].el}))}},{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.visible,i=e.inRestrictEditMode,a=e.connected,o=e.readOnly,r=e.isSubdocEmpty,s=!a||o,l=window.__CONFIG__.disableFeature.Export||!window.APP.canDownload();return f.a.createElement(g.a,{tabKey:t,visible:n,getItems:this.getItems},f.a.createElement("div",null,f.a.createElement(Pn,{disabled:l}),f.a.createElement(Tn,{disabled:l}),f.a.createElement(Rn,{disabled:s||i||r}),f.a.createElement(_n,{disabled:s||i})))}}]),t}(m.PureComponent),Nn=n(504),Dn=n(3804),An=n.n(Dn),Bn=n(4305),Ln=n.n(Bn),Hn=n(2807),Fn=n(333);var Wn=f.a.memo((function(e){var t=e.file,n=t?t.length:0;if(0===t.length)return null;var i=e.onCancel,a=void 0===i?Function.prototype:i,o=e.onComplete,r=void 0===o?Function.prototype:o,s=e.onError,l=void 0===s?Function.prototype:s,c=Object(m.useState)(null),d=he()(c,2),u=d[0],p=d[1],h=Object(m.useState)(""),g=he()(h,2),w=g[0],v=g[1],b=Object(m.useState)(!1),C=he()(b,2),E=C[0],y=C[1],_=Object(m.useState)(0),k=he()(_,2),P=k[0],S=k[1];if(Object(m.useEffect)((function(){window.APP.data.api.postObjectURL().then((function(e){var n=window.navigator.userAgent.toLowerCase(),i=/QQ\/.+ QBWebViewType/gi.test(n);if(_e.isIPad&&i){var a=new FileReader;a.onload=function(){T(e,Object(Ae.dataURLToBlob)(a.result))},a.readAsDataURL(new Blob([t]))}else T(e,t)})).catch((function(e){return console.error(e),window.Toast.error(_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.uploadError", "Error in image upload ")),p(null),y(!1),null}))}),[e.file]),!u)return null;function T(e,t){var n=new FormData;n.append("object",t),y(!0),v(e),p(n)}function M(){p(null),y(!1),v(""),S(0)}return f.a.createElement(m.Fragment,null,f.a.createElement(An.a,{files:t,url:w,getFormData:function(e){var t=new FormData;return t.append("object",e),t},onSuccess:function(e){S(P+1)},onError:function(e){l(),window.Toast.error(Object(Fn.getError)(e,_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.uploadError", "Error in image upload ")))},onComplete:function(e){if(!window.APP.coreDataInvalid()){for(var n=[],i=function(i){var a=JSON.parse(e[i].response.target.response);if(!a.uploadid)return"continue";n.push(a.uploadid),Hn.a.imagePreview(t[i],(function(o){if(a.uploadid){if(!window.APP.editor.picture.selection.inOMath&&!window.APP.editor.picture.selection.hasOMath){if(!o.info.width||!o.info.height){var r=window.APP.editor.picture.getImageSize(o.url);Object.assign(o.info,r)}if("image/gif"===t[i].type&&1===e.length)window.APP.data.shapeManager.addPicCache(n,o)}}else console.error("uploadIds undefined")})),window.APP.data.selection.selContext.isInHeaderFooter&&window.collection("doc_insert_target_in_header_footer","shape")},a=0;a<e.length;a++)i(a);var o=window.APP.editor.picture.selection.getNormalRange(),s=o.pos,l=o.len,c=window.APP.editor.picture.selection.selShapes;c&&(c.length>1||!c[0].isEmbedShape)&&(l=0);var d={pos:s,len:l,mimeDataIDs:n},u={name:"insertPicture",param:d,cb:function(e){!0===e.success&&window.APP.workspace.scrollToPos(window.APP.data.selection.begin.pos),te.default.dispatchEvent(te.default.shape.AFTER_IMAGE_INSERT,e)}};d.mimeDataIDs&&0!==d.mimeDataIDs.length&&window.APP.editor.picture.docCmdExec.exec(u),M(),r()}}}),f.a.createElement(Ln.a,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.uploadPicture", "Upload Picture"),visible:E,progress:P?P/n*100:0,uploadTips:_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.insertingPictures", "Insert image..."),hideDotting:!1,onCancel:function(){M(),a&&a()}}))})),Un=n(767),xn=(n(10631),["gif","jpg","jpeg","png","bmp"]);function Vn(e){var t=e.disabled,n=Object(m.useState)([]),i=he()(n,2),a=i[0],o=i[1],r=Object(m.useRef)(null),s=Object(m.useCallback)((function(e){var t=[],n=!1,i=!1,a={};if(xn.map((function(e){return a[e.toLowerCase()]=!0})),e.length>10)return window.Toast.info(_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.exceedErr", "You can only select {0} pieces at most at a time").replace(/\{0\}/g,String(10))),void o([]);for(var r=0;r<e.length;r++){var s=e[r],l=s.name,c=s.size,d=s.type;if(c>20971520)n=!0;else{var u=-1,p="";void 0!==l?p=-1!==(u=l.lastIndexOf("."))?l.substr(u+1):"":void 0!==d&&(p=-1!==(u=d.lastIndexOf("/"))?d.substr(u+1):""),a[p.toLowerCase()]?t.push(s):i=!0}}!function(e,t){if(!e&&!t)return;if(e&&t)return void window.Toast.info(_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.fileMoreErrorTypeOrSize", "Some files are larger than {0}M or the suffix is not supported").replace("{0}",parseInt(20,10)));e?window.Toast.info(_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.sizeError", "Please upload a file smaller than {0} MB.").replace("{0}",parseInt(20,10))):window.Toast.info(_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.extensionError", "Some file extensions are not supported"))}(n,i),o(t)}),[]);Object(m.useEffect)((function(){function e(e){var t=e.detail.file;s(t)}function t(){r.current.triggerClick()}return window.addEventListener(te.default.shape.ON_IMAGE_UPLOAD_REQUEST,e),window.addEventListener(te.default.shape.ON_IMAGE_INSERT,t),function(){window.removeEventListener(te.default.shape.ON_IMAGE_UPLOAD_REQUEST,e),window.removeEventListener(te.default.shape.ON_IMAGE_INSERT,t)}}),[]);var l=window.utils.Lodash.throttle((function(e){var t={pageX:e.x,pageY:e.y},n=window.APP.uilManager.hit({event:t}).position;window.APP.data.selection.setPosition(n)}),150);return f.a.createElement("div",{className:Gt()("inline-flex picture-insert-handler")},f.a.createElement(Nn.default,{extension:xn,maxSize:20480,ref:r,multiple:!0,needCheck:!1,onChange:s}),f.a.createElement(Wn,{file:a}),f.a.createElement(Un.default,{multiple:!0,disabled:t,onChange:function(e,t){var n=t.x,i=t.y;l({x:n,y:i}),s(e)},onDragOver:l,maxSize:20480,extension:xn,needCheck:!1}))}var jn=n(560),zn=n.n(jn),Gn=n(16080),Kn=n.n(Gn),Yn=n(3037);var Xn=function(){var e=Object(m.useState)(!1),t=he()(e,2),n=t[0],i=t[1],a=Object(m.useState)(""),o=he()(a,2),r=o[0],s=o[1];return zn()(jn.DOCCustomEvents.names.ON_SIGNATURE_PANEL_SHOW,(function(e){s(e.detail.entryType),i(!0)})),n?Object(gt.default)(Kn.a,{onCancel:function(){i(!1),window.collection("commandbar","click",r+"|signature_cancel")},onFileChange:function(e){var t=e.file;window.collection("commandbar","click",r+"|signature_insert"),i(!1),Object(Yn.addWhiteBottomColor)(t).then((function(e){jn.DOCCustomEvents.dispatchEvent(jn.DOCCustomEvents.shape.ON_IMAGE_UPLOAD_REQUEST,{file:[e]})}))}}):null},Zn=n(9933),Qn=n.n(Zn),$n=n(336),Jn=n(2295);function qn(){var e=window.APP.data.selection,t=void 0;if(e.activeShape){var n=e.activeShape.anchor.shapeData;t={isShape:!0,pos:e.activeShape.pos,shapeId:n.shapeId,shapeTreeType:n.shapeTreeType,isLatexMath:n.extData&&n.extData.isLatexMath}}else t={pos:e.begin.position};return t}var ei=function(e){var t=Object(m.useState)(!1),n=he()(t,2),i=n[0],a=n[1],o=Object(m.useState)(""),r=he()(o,2),s=r[0],l=r[1],c=Object(m.useState)(""),d=he()(c,2),u=d[0],p=d[1];return zn()(jn.DOCCustomEvents.names.ON_LATEX_MATH_PANEL_SHOW,(function(e){var t=e.detail,n=t.id,i=t.latexStr;n&&n.length&&l(n),i&&i.length&&p(i),a(!0)})),f.a.createElement(Qn.a,{visible:i,id:s,latexStr:u,onCancel:function(){l(""),p(""),a(!1)},onCommit:function(e){e.id;var t=e.latexStr,n=e.svgData,i=e.width,o=e.height,r=e.positionInfo;l(""),p(""),a(!1);var s=r?Object(Jn.getInsertRangeOnRestoring)(r):window.APP.data.selection.getNormalRange(),c={width:Object($n.Px2Ti)(i),height:Object($n.Px2Ti)(o),svgData:n,latexStr:t,isEdit:!1,pos:s.pos,len:s.len};window.APP.editor.picture.insertPic4LatexMath(c)},disabled:e.disabled,connected:e.connected,getPositionInfo:qn,userId:window.APP.info.userid,readOnly:e.readOnly})},ti=window.CommandBarComponent.cmbIds.wps,ni=function(e){function t(){return r()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),l()(t,[{key:"render",value:function(){var e=this.props,t=e.activeTab,n=e.readOnly,i=e.connected,o=e.dispatch,r=e.user,s=e.file,l=e.isTemplate,c=e.inRestrictEditMode,d=e.disableCommandBar,u=e.extraProps,p=e.selectionInfo;return f.a.createElement(f.a.Fragment,null,f.a.createElement(F,a()({tabKey:ti.InsertTab},u,{visible:t===ti.InsertTab,readOnly:n,disableCommandBar:d,connected:i,dispatch:o,user:r,file:s})),f.a.createElement(Cn,a()({tabKey:ti.ReviewTab},u,{visible:t===ti.ReviewTab,readOnly:n,disableCommandBar:d,selectionInfo:p,connected:i,dispatch:o,user:r,file:s})),f.a.createElement(nt,a()({tabKey:ti.PageTab},u,{visible:t===ti.PageTab,readOnly:n,disableCommandBar:d,connected:i,dispatch:o,user:r,isTemplate:l})),f.a.createElement(In,a()({tabKey:ti.ToolsTab},u,{visible:t===ti.ToolsTab,readOnly:n,connected:i,disableCommandBar:d,file:s})),f.a.createElement(Vn,{disabled:n||!i||c||d}),f.a.createElement(Xn,null),f.a.createElement(ei,{disabled:n||!i,connected:i,readOnly:n}))}}]),t}(m.PureComponent);t.default=ni},16926:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var i=n(238),a=n.n(i),o=n(393),r=n(1),s=n.n(r),l=n(2),c=n.n(l),d=n(22),u=n.n(d),p=n(23),m=n.n(p),f=n(1470),h=(n(16063),n(7501)),g=n(568),w=n(4459),v=n(10808),b=n(7436),C=[{content:b.d[b.a.pt].name,value:b.a.pt},{content:b.d[b.a.inc].name,value:b.a.inc},{content:b.d[b.a.cm].name,value:b.a.cm},{content:b.d[b.a.mm].name,value:b.a.mm}],E=function(e){function t(e){s()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={unit:f.UnitType.Unit_cm,margin:f.default.init(0,f.UnitType.Unit_cm),value:0,position:h.DOC_PAGE_MARGIN_POS.TOP,isShowWarn:!1},n.onSelectUnit=n._onSelectUnit.bind(n),n.onInputChange=n._onInputChange.bind(n),n.lazyApplyEditorPageMargin=window.utils.Lodash.debounce(n._applyEditorPageMargin.bind(n),500),n.onOutOfRange=n._onOutOfRange.bind(n),n.onCloseWarn=n._onCloseWarn.bind(n),n.onInputKeyUp=n._onInputKeyUp.bind(n),n.refInputNumber=null,n}return m()(t,e),c()(t,[{key:"componentDidMount",value:function(){this._refreshState(this.props)}},{key:"_onInputChange",value:function(e){this.setState({value:e}),this.lazyApplyEditorPageMargin()}},{key:"_onOutOfRange",value:function(e){var t=this;""===e||this.setState({isShowWarn:!0},(function(){t.refInputNumber.blur()}));var n=this.state.value;this.setState({value:n})}},{key:"_onCloseWarn",value:function(){var e=this;this.props.limitWarnCallback&&this.props.limitWarnCallback(),this.setState({isShowWarn:!1},(function(){e.props.limitWarnCallback||e.refInputNumber.focus()}))}},{key:"_applyEditorPageMargin",value:function(){var e=parseFloat(this.state.value),t=f.default.init(e,this.state.unit);this.props.sizeChangeHandler({position:this.state.position,margin:t})}},{key:"_onSelectUnit",value:function(e){var t=this.state.margin,n=parseFloat(e),i=this._floorFloat(t[f.UnitName[n]]);this.setState({unit:n,value:i})}},{key:"_onInputKeyUp",value:function(e){var t=parseFloat(this.state.value);if("ArrowUp"===e.key){var n=this._getMax();t=t>n?n:t,t=this._roundFloat(t),this.setState({value:t}),this.lazyApplyEditorPageMargin()}else"ArrowDown"===e.key?(t=t<0?0:t,t=this._roundFloat(t),this.setState({value:t}),this.lazyApplyEditorPageMargin()):e.key}},{key:"_refreshState",value:function(e){var t=e.position,n=e.margin,i=this._roundFloat(n[f.UnitName[this.state.unit]]);this.setState({margin:n,position:t,value:i})}},{key:"_floorFloat",value:function(e){var t=parseFloat(e);return Math.floor(100*t)/100}},{key:"_roundFloat",value:function(e){var t=parseFloat(e);return Math.round(100*t)/100}},{key:"_getMax",value:function(){var e=f.UnitName[this.state.unit],t=this.props.limit?this.props.limit[e]:0;return t=this._floorFloat(t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.value,i=t.unit,o=t.position,r=h.DOC_PAGE_MARGIN_POS_NAME[o],s=this._getMax(),l=o===h.DOC_PAGE_MARGIN_POS.TOP||o===h.DOC_PAGE_MARGIN_POS.BOTTOM?_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.marginOfTopOrBottom", "In some sections, the top/bottom margins are too large relative to the width of the paper."):_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.marginOfLeftOrRight", "In some sections, the left/right margins are too large relative to the width of the paper.");return a.a.createElement("div",{className:"custom-panel-item "+h.DOC_PAGE_MARGIN_POS_EN_NAME[o]},a.a.createElement("div",{className:"label"},r),a.a.createElement(g.default,{ref:function(t){return e.refInputNumber=t},className:"input",step:.1,max:s,min:0,value:n,onKeyUp:this.onInputKeyUp,onChange:this.onInputChange,onOutOfRange:this.onOutOfRange}),a.a.createElement(w.a,{selectable:!0,className:"page-margin-unit-select",value:i,content:b.d[i].name,onChange:this.onSelectUnit,options:C}),this.state.isShowWarn&&a.a.createElement(v.a,{onOk:this.onCloseWarn,onCancel:this.onCloseWarn,warnText:l,title:_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.pageMarginSetting", "Setup Margins")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.position,i=e.margin,a=e.limitWarn,o=void 0,r={margin:i,position:n},s=i[f.UnitName[t.unit]];if(s!==t.margin[f.UnitName[t.unit]]){var l=Math.round(100*parseFloat(s))/100;isNaN(l)||(r.value=l,o=!0)}return a===n&&(r.isShowWarn=!0,o=!0),o?r:null}}]),t}(i.PureComponent),y=n(9932),_=(n(16065),o.default.Item);function k(e){return e.mode===h.DOC_PAGE_MARGIN_TYPE.Custom?a.a.createElement(S,{margins:e.margins,limit:e.limit,limitWarn:e.limitWarn,limitWarnCallback:e.limitWarnCallback,onSizeChange:e.customSizeHandler}):a.a.createElement(P,{direct:e.direct,mode:e.mode,selected:e.selected,className:e.className,onClick:e.clickHandler})}function P(e){var t=e.direct,n=e.mode,i=e.selected,o=e.className,r=e.onClick,s=y.DOC_PAPER_DIRECTION_NAME[t],l=h.DOC_PAGE_MARGIN_SIZE[n],c=h.DOC_PAGE_MARGIN_CN_NAME[n],d=l.t.cm.toFixed(2),u=l.l.cm.toFixed(2);return a.a.createElement(_,{className:"page-margin-item "+h.DOC_PAGE_MARGIN_NAME[n],selected:i,onClick:r,value:n},a.a.createElement("div",{className:"page-margin-item-wrapper "+s+" "+h.DOC_PAGE_MARGIN_NAME[n]+" "+o},a.a.createElement("div",{className:"page-margin-wrapper"},a.a.createElement("div",{className:"page-margin-icon"},a.a.createElement("div",{className:"page-margin-icon-bg"})),a.a.createElement("div",{className:"page-margin-text"},c)),a.a.createElement("div",{className:"page-margin-params top-bottom"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.topBottom", "Top or Bottom"),"：",d,"cm"),a.a.createElement("div",{className:"page-margin-params left-right"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.leftRight", "Left or Right"),"：",u,"cm")))}function S(e){var t=e.margins,n=e.limit,i=e.limitWarn,o=e.limitWarnCallback;return a.a.createElement("div",{className:"custom-wrapper"},a.a.createElement("div",{className:"custom-title"},_i18n("applications.writer.components.CommandBars.RbTab.Home.PageMargin.customMargin", "Custom Page Margins")),n&&a.a.createElement("div",{className:"custom-panel"},a.a.createElement("div",{className:"custom-panel-line"},a.a.createElement(E,{position:h.DOC_PAGE_MARGIN_POS.TOP,margin:t.t,limitWarn:i,limitWarnCallback:o,sizeChangeHandler:e.onSizeChange,limit:n.t}),a.a.createElement(E,{position:h.DOC_PAGE_MARGIN_POS.LEFT,margin:t.l,limitWarn:i,limitWarnCallback:o,sizeChangeHandler:e.onSizeChange,limit:n.l})),a.a.createElement("div",{className:"custom-panel-line custom-panel-line-bottom"},a.a.createElement(E,{position:h.DOC_PAGE_MARGIN_POS.BOTTOM,margin:t.b,limitWarn:i,limitWarnCallback:o,sizeChangeHandler:e.onSizeChange,limit:n.b}),a.a.createElement(E,{position:h.DOC_PAGE_MARGIN_POS.RIGHT,margin:t.r,limitWarn:i,limitWarnCallback:o,sizeChangeHandler:e.onSizeChange,limit:n.r}))))}},1764:function(e,t,n){"use strict";n.r(t);var i=n(238),a=n.n(i),o=n(239);t.default=Object(o.a)("doc_pen",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75 4.75H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M6 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H11.75C12.5784 1.75 13.25 2.42157 13.25 3.25V5.5",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M12.2879 7.21214L8.14645 11.3536C8.05268 11.4473 8 11.5745 8 11.7071V13.7C8 13.8657 8.13431 14 8.3 14H10.2929C10.4255 14 10.5527 13.9473 10.6464 13.8536L14.7879 9.71214C14.905 9.59498 14.905 9.40503 14.7879 9.28787L12.7121 7.21214C12.595 7.09498 12.405 7.09498 12.2879 7.21214Z",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1830:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_setup",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M13.5389 11.7674C13.5389 11.7234 13.5373 11.6797 13.5341 11.6365L14.0993 10.9183L13.7083 10.241L12.8378 10.3665C12.7309 10.2863 12.6146 10.2181 12.4907 10.1639L12.1652 9.3501H11.3833L11.0513 10.18C10.939 10.2323 10.8332 10.2961 10.7354 10.37L9.84021 10.241L9.44922 10.9182L10.0415 11.6709C10.0398 11.7029 10.0389 11.7351 10.0389 11.7674M13.5389 11.7674C13.5389 11.8369 13.5349 11.9054 13.527 11.9728L14.0993 12.7001L13.7083 13.3773L12.7386 13.2376C12.6725 13.2804 12.6034 13.3188 12.5316 13.3525L12.1653 14.2683H11.3833L11.01 13.335C10.9492 13.3047 10.8905 13.271 10.834 13.2342L9.84022 13.3773L9.44923 12.7001L10.0473 11.94C10.0418 11.8833 10.0389 11.8257 10.0389 11.7674M13.5389 11.7674C13.5389 12.7339 12.7556 13.5175 11.7891 13.5175C10.8226 13.5175 10.0389 12.7339 10.0389 11.7674M13.5389 11.7674C13.5389 10.801 12.7556 10.0175 11.7891 10.0175C10.8226 10.0175 10.0389 10.801 10.0389 11.7674",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75 4.74976H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M7 14.2498H4.25C3.42157 14.2498 2.75 13.5782 2.75 12.7498V3.24976C2.75 2.42133 3.42157 1.74976 4.25 1.74976H11.75C12.5784 1.74976 13.25 2.42133 13.25 3.24976V6.49976",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},1980:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){var t=e.extData&&e.extData.isLatexMath,n=e.isOle&&e.controlObj&&e.controlObj.progId&&e.controlObj.progId.match(/Visio.Drawing/);return!(75!==e.shapeType||e.group||e.hasArtWord||e.isOle&&!n||t)}},2009:function(e,t,n){"use strict";var i={HEADER_FOOTER:{SWITCH_MODE:"SWITCH_MODE",EDITOR_MODE:"EDITOR_MODE",READER_MODE:"READER_MODE",SHOW_HIT_TIP:"SHOW_HIT_TIP"},HIGHLIGHT:{BLINK:"BLINK"}};t.a=i},2222:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_direction_horizontal",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M14 8L11 8M9.5 8H6.5M5 8H2",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M12.75 13.25C13.5784 13.25 14.25 12.5784 14.25 11.75V6.12132C14.25 5.7235 14.092 5.34196 13.8107 5.06066L11.9393 3.18934C11.658 2.90804 11.2765 2.75 10.8787 2.75L3.25 2.75C2.42157 2.75 1.75 3.42157 1.75 4.25L1.75 11.75C1.75 12.5784 2.42157 13.25 3.25 13.25H12.75Z",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2223:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_direction_vertical",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M8 2V5M8 14V11M8 6.5V9.5",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M2.75 3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H9.87868C10.2765 1.75 10.658 1.90804 10.9393 2.18934L12.8107 4.06066C13.092 4.34196 13.25 4.7235 13.25 5.12132V12.75C13.25 13.5784 12.5784 14.25 11.75 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25Z",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2551:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("direction",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M6.77 14.25C6.20667 14.25 5.75 13.8023 5.75 13.25V8.25C5.75 7.69772 6.20667 7.25 6.77 7.25H13.23C13.7933 7.25 14.25 7.69772 14.25 8.25V13.25C14.25 13.8023 13.7933 14.25 13.23 14.25H6.77Z",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M8.75 5.00003V2.77C8.75 2.20667 8.30228 1.75 7.75 1.75H2.75C2.19772 1.75 1.75 2.20667 1.75 2.77V9.23C1.75 9.79333 2.19772 10.25 2.75 10.25H3.5",fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2552:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_eye",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M15.3408 11.8476C15.4065 11.9401 15.4065 12.06 15.3408 12.1525C14.9605 12.6878 13.5844 14.45 11.945 14.45C10.3056 14.45 8.92951 12.6878 8.54927 12.1525C8.48358 12.06 8.48358 11.9401 8.54927 11.8476C8.92951 11.3123 10.3056 9.55005 11.945 9.55005C13.5844 9.55005 14.9605 11.3123 15.3408 11.8476Z",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("circle",{cx:"12",cy:"12",r:"1",stroke:"none"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75 4.74976H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M5.75 7.74976H7.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M7 14.2498H4.25C3.42157 14.2498 2.75 13.5782 2.75 12.7498V3.24976C2.75 2.42133 3.42157 1.74976 4.25 1.74976H11.75C12.5784 1.74976 13.25 2.42133 13.25 3.24976V7.49976",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2553:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_header_footer",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M5.75 4.75H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M5.75 11.25H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M2.75 3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H11.75C12.5784 1.75 13.25 2.42157 13.25 3.25V12.75C13.25 13.5784 12.5784 14.25 11.75 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25Z",fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2555:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_lock",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147"},a.a.createElement("path",{d:"M8.75 11.45C8.75 11.0634 9.10178 10.75 9.53571 10.75H9.75H13.15H13.4643C13.8982 10.75 14.25 11.0634 14.25 11.45V13.55C14.25 13.9366 13.8982 14.25 13.4643 14.25H9.53571C9.10178 14.25 8.75 13.9366 8.75 13.55V11.45Z",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M9.75 10.75V9.375C9.75 8.47754 10.5335 7.75 11.5 7.75C12.4665 7.75 13.25 8.47754 13.25 9.375V10.75",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75 4.75H10.25",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M13.25 5.50003V3.25C13.25 2.42157 12.5784 1.75 11.75 1.75H4.25C3.42157 1.75 2.75 2.42157 2.75 3.25V12.75C2.75 13.5784 3.42157 14.25 4.25 14.25H6.5",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2556:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_margins",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M10.25 2V14",fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M3 11.25H13",fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M5.75 2V14",fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M3 4.75H13",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M2.75 3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H11.75C12.5784 1.75 13.25 2.42157 13.25 3.25V12.75C13.25 13.5784 12.5784 14.25 11.75 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25Z",fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2558:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("doc_name",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M6.25 4.75L9.75 4.75",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M8 5.00024V8.25957",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M2.75 3.25C2.75 2.42157 3.42157 1.75 4.25 1.75H9.87868C10.2765 1.75 10.658 1.90804 10.9393 2.18934L12.8107 4.06066C13.092 4.34196 13.25 4.7235 13.25 5.12132V12.75C13.25 13.5784 12.5784 14.25 11.75 14.25H4.25C3.42157 14.25 2.75 13.5784 2.75 12.75V3.25Z",strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("path",{d:"M5.75 10.7588H10.25",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2610:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("scale_size",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75 6.05C5.75 5.88431 5.88431 5.75 6.05 5.75H13.95C14.1157 5.75 14.25 5.88431 14.25 6.05V13.95C14.25 14.1157 14.1157 14.25 13.95 14.25H6.05C5.88431 14.25 5.75 14.1157 5.75 13.95V6.05Z",fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#0A6CFF"},a.a.createElement("path",{d:"M1.25 5.75H2.44967C2.61536 5.75 2.74967 5.88431 2.74967 6.05V13.95C2.74967 14.1157 2.61536 14.25 2.44967 14.25H1.25M14.25 1.25V2.44999C14.25 2.61568 14.1157 2.74999 13.95 2.74999L6.05 2.74999C5.88431 2.74999 5.75 2.61568 5.75 2.44999V1.25",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},2618:function(e,t,n){"use strict";var i=n(238),a=n.n(i),o=n(239);t.a=Object(o.a)("spell_check",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-1",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147",fill:e.colors&&"string"!=typeof e.colors&&e.colors[1]||"string"==typeof e.colors&&e.colors||"#00A147"},a.a.createElement("path",{d:"M4.25 11.5L6.90817 14.0538C7.02229 14.1634 7.20194 14.1655 7.31864 14.0587L11.75 10",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})),a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.99917 2.27C8.99917 1.57026 9.56508 1 10.2669 1H12.1807C13.2789 1 14.1662 1.89261 14.1662 2.99C14.1662 3.46503 13.9999 3.90169 13.7223 4.24419C14.2793 4.62414 14.6446 5.26487 14.6446 5.99C14.6446 7.15366 13.7038 8.1 12.5396 8.1H10.2669C9.56508 8.1 8.99917 7.52974 8.99917 6.83V2.27ZM10.0992 4.98V6.83C10.0992 6.92555 10.1759 7 10.2669 7H12.5396C13.093 7 13.5446 6.54947 13.5446 5.99C13.5446 5.43053 13.093 4.98 12.5396 4.98H10.0992ZM10.0992 3.88H12.1807C12.6681 3.88 13.0662 3.48319 13.0662 2.99C13.0662 2.49681 12.6681 2.1 12.1807 2.1H10.2669C10.1759 2.1 10.0992 2.17445 10.0992 2.27V3.88ZM4.24937 2.78092L3.27255 5.22296H5.22618L4.24937 2.78092ZM5.66618 6.32296L6.2387 7.75427C6.35151 8.0363 6.6716 8.17348 6.95363 8.06066C7.23566 7.94785 7.37284 7.62777 7.26003 7.34574L4.89849 1.44189C4.66282 0.852706 3.83592 0.852703 3.60024 1.44189L1.2387 7.34574C1.12589 7.62777 1.26307 7.94785 1.5451 8.06066C1.82713 8.17348 2.14721 8.0363 2.26003 7.75427L2.83255 6.32296H5.66618Z",stroke:"none"})))}))},2807:function(e,t,n){"use strict";var i=n(167),a="webOffice_",o="position: fixed; left: 0; top: 0; z-index: -1; display: none;",r=function(e,t){var n=new FileReader;n.onload=function(e){var n=new DataView(e.target.result);if(65496!==n.getUint16(0,!1))return t(-2);for(var i=n.byteLength,a=2;a<i;){if(n.getUint16(a+2,!1)<=8)return t(-1);var o=n.getUint16(a,!1);if(a+=2,65505===o){if(1165519206!==n.getUint32(a+=2,!1))return t(-1);var r=18761===n.getUint16(a+=6,!1);a+=n.getUint32(a+4,r);var s=n.getUint16(a,r);a+=2;for(var l=0;l<s;l++)if(274===n.getUint16(a+12*l,r))return t(n.getUint16(a+12*l+8,r))}else{if(65280!=(65280&o))break;a+=n.getUint16(a,!1)}}return t(-1)},n.readAsArrayBuffer(e)};t.a={localDownload:function(e){var t=e.href,n=e.name;if(t){var i=(void 0===n?a:n)+(new Date).getTime(),r=document.createElement("a");if("download"in r){r.setAttribute("download",i+".png"),r.href=t;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),r.dispatchEvent(s),s=null}else{var l=document.createElement("iframe");l.setAttribute("style",o),l.setAttribute("name",i),document.body.appendChild(l),window.frames[i].document.execCommand("SaveAs"),document.body.removeChild(l)}}else console.warn("pulic/**/imageEdit.js; the 'href' of option is empty.")},getPictureOrientation:r,imageWithRotation:function(e,t,n){r(e,(function(e){var i=Math.min(2*window.screen.width/t.width,1),a=t.width*i,o=t.height*i,r=document.createElement("canvas"),s=r.getContext("2d");switch(r.width=a,r.height=o,e){case 6:r.height=a,r.width=o,s.rotate(Math.PI/2),s.translate(0,-o);break;case 3:s.rotate(Math.PI),s.translate(-a,-o);break;case 8:r.height=a,r.width=o,s.rotate(-Math.PI/2),s.translate(-o,0)}s.scale(i,i),s.drawImage(t,0,0);var l=r.toDataURL("Image/jpeg",1);n&&n(l)}))},imagePreview:function(e,t){var n=[],i={info:{}},a=void 0;return"image/jpg"!==e.type&&"image/jpeg"!==e.type||(a=new Promise((function(t,n){var a=new FileReader;a.onload=function(e){Object.assign(i.info,function(e){var t={},n=new DataView(e);if(255!==n.getUint8(0)||216!==n.getUint8(1))return t;var i=2,a=function(){if(255!==n.getUint8(i))return"break";if(225!==n.getUint8(i+1))return i+=2+n.getUint16(i+2),"continue";var e=i+4;if(1165519206!==n.getUint32(e,!1))return"break";var a=void 0,o=e+6;if(18761===n.getUint16(o))a=!1;else{if(19789!==n.getUint16(o))return"break";a=!0}if(42!==n.getUint16(o+2,!a))return"break";var r=n.getUint32(o+4,!a);if(r<8)return"break";var s=-1,l=function(e,i){for(var o=n.getUint16(i,!a),r=0;r<o;r++){var l=i+12*r+2,c=n.getUint16(l,!a);274===c?t.orientation=n.getUint16(l+8,!a):256===c||40962===c?t.width=n.getUint32(l+8,!a):257===c||40963===c?t.height=n.getUint32(l+8,!a):34665===c&&(s=n.getUint32(l+8,!a))}};return l(0,o+r),s>0&&l(0,o+s),"break"};e:for(;i<e.byteLength;){switch(a()){case"break":break e;case"continue":continue}}return t}(e.target.result)),t(i)},a.readAsArrayBuffer(e)})),n.push(a)),a=new Promise((function(t,n){var a=new Image;a.onload=function(){Object.assign(i.info,{width:a.width,height:a.height}),window.URL.revokeObjectURL(a.src),t(i)},a.onerror=function(){},a.src=window.URL.createObjectURL(e)})),n.push(a),a=new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){i.url=a.result,t(i)}})),n.push(a),Promise.all(n).then((function(){t&&t(i)}))},imageTransform:function(e,t){var n=e.width,a=e.height,o=e.orientation,r={width:n,height:a,transform:""};(Math.abs(n-t.width)>1||Math.abs(a-t.height)>1)&&(r.transform="scale("+t.width/n+", "+t.height/a+")");var s=i.isMobileIos&&i.iosVersion<13;if(i.isIE||i.isQQBrowser||i.isWps2019||i.isPCWxMiniProgram||i.isAndroid&&(i.isMobileQQBrowser||i.isInQQMiniProgram||i.isInWeixin||i.isInWxMiniProgram)||s&&(i.isMobileQQBrowser||i.isInQQMiniProgram||i.isInWeixin||i.isInWxMiniProgram||i.isWpsClient||i.isSafari)){var l=function(e){return Math.round(1e5*e)/1e5};switch(o){case 3:r.transform="scale("+l(t.height/a)+" "+l(t.width/n)+") rotate(180) translate(-"+n+" -"+a+")",r.rotate=!0;break;case 6:r.transform="scale("+l(t.height/n)+" "+l(t.width/a)+") rotate(90) translate(0 -"+a+")",r.rotate=!0;break;case 8:r.transform="scale("+l(t.height/n)+" "+l(t.width/a)+") rotate(-90) translate(-"+n+" 0)",r.rotate=!0}}else switch(o){case 6:case 8:r.width=a,r.height=n,(Math.abs(r.width-t.width)>1||Math.abs(r.height-t.height)>1)&&(r.transform="scale("+t.width/r.width+", "+t.height/r.height+")")}return r}}},3037:function(e,t,n){"use strict";n.r(t),n.d(t,"addWhiteBottomColor",(function(){return c})),n.d(t,"ImageType",(function(){return d})),n.d(t,"getImageType",(function(){return u})),n.d(t,"ImageSrcStatus",(function(){return p})),n.d(t,"getImageList",(function(){return f})),n.d(t,"getImageSize",(function(){return h}));var i=n(8),a=n.n(i),o=n(24),r=n.n(o),s=n(309),l=n(1980);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blob";return new Promise((function(n,i){var a=document.createElement("canvas"),o="object"===(void 0===e?"undefined":r()(e)),s=e;o&&(s=URL.createObjectURL(e));var l=new Image;l.onload=function(e){var i=l.naturalHeight,r=l.naturalWidth;a.width=r,a.height=i;var c=a.getContext("2d");c.fillStyle="#ffffff",c.fillRect(0,0,a.width,a.height),c.drawImage(e.target,0,0),o&&URL.revokeObjectURL(s),"blob"===t?a.toBlob((function(e){return n(e)})):"base64"===t&&n(a.toDataURL())},l.onerror=function(){i("promise reject: add white bottom color: load image error")},l.src=s}))}var d={PNG:"png",JPEG:"jpeg",GIF:"gif",BMP:"bmp",TIFF:"tiff",SVG:"svg",WEBP:"webp",EMF:"emf",WMF:"wmf",UNDEFINED:"undefined"};function u(e){return new Promise((function(t,n){var i=new FileReader;i.onload=function(e){try{var i=new DataView(e.target.result).getUint32(0,!1),a=Number(i).toString(16).toUpperCase();switch(a){case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFED":case"FFD8FFE8":case"FFD8FFDB":t(d.JPEG);break;case"89504E47":t(d.PNG);break;case"3C3F786D":t(d.SVG);break;case"52494646":t(d.WEBP);break;case"47494638":t(d.GIF);break;case"424D0E68":t(d.BMP);break;case"4D4D002A":case"4D4D002B":case"49492A00":t(d.TIFF);break;case"01000000":t(d.EMF);break;case"01000900":case"D7CDC69A":t(d.WMF);break;default:return 0===a.indexOf("424D")?t(d.BMP):0===a.indexOf("492049")?t(d.TIFF):t("UNDEFINED")}}catch(e){console.log(e),n("unsupported file type")}},i.readAsArrayBuffer(e)}))}var p={UNLOAD:"unload",LOADING:"loading",LOADED:"loaded",FAILED:"failed"};function m(e,t){var n=e.pos,i=e.len,o=[];function r(e){var n=e.shapeData,i=n.shapeType,r=n.shapeTreeType,s=n.textRange,c=n.shapeId,d=n.extData,u=n.picture;if(Object(l.a)(e.shapeData)){var f={shapeId:c,shapeTreeType:r,shapeType:i,comparePos:e.pos,pos:e.pos,originalSrcStatus:p.UNLOAD,srcStatus:p.UNLOAD,key:r+"-"+c,url:"",isProcesson:!!d&&d.isProcessOn,fileId:d&&d.isProcessOn&&d.fileId};void 0!==t&&(f.comparePos=t),u&&u.blip&&u.blip.blipAtom&&(f.imageWidth=u.blip.blipAtom.imageWidth||0,f.imageHeight=u.blip.blipAtom.imageHeight||0),o.push(f)}else s&&!window.APP.isMobileMode()&&o.push.apply(o,a()(m(s,e.pos)))}var s=window.APP.data.doc.inlineAnchors.rangeClass.collectRanges(n,i),c=window.APP.data.doc.anchors.rangeClass.collectRanges(n,i);return s.forEach(r),c.forEach(r),o}function f(e){var t=void 0;t=window.APP.data.selection.selContext.isInHeaderFooter?s.HeaderFooter:s.MainText;var n=window.APP.data.doc.getSubDocRange(t),i=m({pos:n.pos,len:n.len});if(t===s.MainText){var a=window.APP.data.doc.getSubDocRange(s.Footnote);i=i.concat(m(a));var o=window.APP.data.doc.getSubDocRange(s.Endnote);i=i.concat(m(o))}return i.sort((function(e,t){return e.comparePos-t.comparePos})),i}function h(e){return new Promise((function(t,n){var i=new Image;i.src=e,i.onload=function(){t({width:i.width,height:i.height})},i.onerror=n}))}},309:function(e,t,n){"use strict";n.r(t),n.d(t,"MainText",(function(){return i})),n.d(t,"Footnote",(function(){return a})),n.d(t,"HeaderFooter",(function(){return o})),n.d(t,"Macro",(function(){return r})),n.d(t,"Comment",(function(){return s})),n.d(t,"Endnote",(function(){return l})),n.d(t,"Textbox",(function(){return c})),n.d(t,"TextboxInHF",(function(){return d}));var i=0,a=1,o=2,r=3,s=4,l=5,c=6,d=7},3804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOffline=function(){t.abort(),t.props.onError&&t.props.onError({body:{result:"offline"}})},t.init=function(e){var n;void 0===e&&(e=!1);var a=t.props.files;e?(n=t.waitList).push.apply(n,a):(t.fileMap=new Map,t.waitList=i.__spreadArray([],a,!0),t.processingList=[]),a.forEach((function(e,n){t.fileMap.set(e,{index:n,isSuccess:!1,isCancel:!1,isError:!1})})),t.startUpload()},t.startUpload=function(){var e,n=t.props.concurrentCount;if(t.waitList.length>0&&t.processingList.length<n){var i=Math.min(t.waitList.length,n-t.processingList.length),a=t.waitList.splice(0,i);(e=t.processingList).push.apply(e,a),t.uploadFiles(a)}},t.uploadFiles=function(e){var n=t.props,i=n.getFormData,a=n.onUploadXhr,o=n.getUrl;e.forEach((function(e){var n=i(e);if(n instanceof FormData){var r=t.props.url||(null==o?void 0:o(e)),s=window.__WPSENV__.request({method:"POST",url:r,body:n});s.onprogress=function(n){return t.onUploadProgress(n,e)},s.end().then((function(n){t.onUploadSuccess(e,n)})).catch((function(n){t.onUploadError(e,n)})),t.fileMap.get(e).xhr=s,a&&a(n,s)}else t.onUploadCancel(e)}))},t.onUploadProgress=function(e,n){if(t.props.onProgress){var i=t.fileMap.get(n);i&&t.props.onProgress(e,n,i.index)}},t.onUploadSuccess=function(e,n){var i=t.fileMap.get(e);i&&(i.isSuccess=!0,i.response=n,i.xhr=null,t.props.onSuccess&&t.props.onSuccess(n,e,i.index)),t.onUploadDone(e)},t.onUploadError=function(e,n){var i=t.fileMap.get(e);i&&(i.isError=!0,i.response=n,i.xhr=null,t.props.onError&&t.props.onError(n,e,i.index)),t.onUploadDone(e)},t.onUploadCancel=function(e,n){var i;void 0===n&&(n=!1);var a=t.fileMap.get(e);a&&(null===(i=a.xhr)||void 0===i||i.abort(),a.isCancel=!0,a.xhr=null),n||t.onUploadDone(e)},t.onUploadDone=function(e){var n=t.processingList.indexOf(e);if(n>-1&&t.processingList.splice(n,1),t.waitList.length||t.processingList.length)t.startUpload();else if(t.props.onComplete){var i=[];t.fileMap.forEach((function(e,t){var n=e.isError,a=e.isCancel,o=e.response;i.push({file:t,isError:n,isCancel:a,response:o})})),t.fileMap.clear(),t.props.onComplete(i)}},t.abort=function(){t.processingList.forEach((function(e){return t.onUploadCancel(e,!0)})),t.waitList.forEach((function(e){return t.onUploadCancel(e,!0)}))},t.destroy=function(){t.props.autoAbort&&(t.fileMap.forEach((function(e){var t;return null===(t=e.xhr)||void 0===t?void 0:t.abort()})),delete t.waitList,delete t.processingList,delete t.fileMap)},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.init(),window.addEventListener("offline",this.handleOffline)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.isIncremental,i=t.files;!n||!i.length||i.length===e.files.length&&this.fileMap.get(i[0])||this.init(!0)},t.prototype.componentWillUnmount=function(){this.destroy(),window.removeEventListener("offline",this.handleOffline)},t.prototype.render=function(){return null},t.defaultProps={concurrentCount:10,isIncremental:!1,autoAbort:!0},t}(n(238).PureComponent);t.default=a},4305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(4306);var a=i.__importStar(n(238)),o=n(240),r=i.__importDefault(n(243)),s=i.__importDefault(n(893)),l=function(e){function t(t){var n=e.call(this,t)||this;return n.handleWindowKeyDown=function(e){var t="F5"===e.code||116===e.keyCode,n="F12"===e.code||123===e.keyCode;t||n||(0,o.stopBubble)(e)},n.renderTitle=function(){var e=n.props.title;return e?a.default.createElement("div",{className:"uploader-header"},a.default.createElement("div",{className:"uploader-header-text"},e)):null},n.renderContent=function(){var e=n.props,t=e.children,i=e.uploadTips,o=e.hideDotting;return t||a.default.createElement("div",{className:"progress-tips"},a.default.createElement("span",null,i),!o&&a.default.createElement("i",{className:"dotting"}))},n.state={officeType:(0,o.getPageOfficeType)()},n}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)},t.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.handleWindowKeyDown,!0)},t.prototype.renderButton=function(){var e=this.props,t=e.onCancel,n=e.cancelBtnText;return a.default.createElement(r.default,{className:"cancel-btn",onClick:t,type:"secondary"},n||_i18n("applications.public.components.upload.FileUploader.cancel", "Cancel"))},t.prototype.render=function(){var e=this.state.officeType,t=this.props,n=t.progress,i=t.visible,o=t.className,r=t.maskTransparency,l=a.default.classNames({"wo-component-uploader":1},o);return a.default.createElement(s.default,{className:l,mask:r,closable:this.props.closable,visible:i,title:this.renderTitle(),footer:this.renderButton()},a.default.createElement("div",{className:"uploader-content"},a.default.createElement("div",{className:"progress-wrap"},a.default.createElement("div",{className:"progress-bar ".concat(e),style:{width:"".concat(n,"%")}})),this.renderContent()))},t.defaultProps={visible:!0,maskTransparency:!0,closable:!1},t}(a.PureComponent);t.default=l},4306:function(e,t,n){},4466:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(3321),a=function(e){return{type:i.a.DOCMAP_SHOW,data:{show:e}}}},472:function(e,t,n){"use strict";n.r(t),n.d(t,"base64ToArrayBuffer",(function(){return i})),n.d(t,"formatDecimal",(function(){return a})),n.d(t,"filterValid",(function(){return o})),n.d(t,"getStrLength",(function(){return r})),n.d(t,"isHighSurrogate",(function(){return s})),n.d(t,"isLowSurrogate",(function(){return l})),n.d(t,"isSurrogate",(function(){return c})),n.d(t,"replaceEmoji",(function(){return d})),n.d(t,"hasEmoji",(function(){return u}));var i=function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=t.charCodeAt(a);return i.buffer},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(""===e)return e;var n=(e=e.toString()).indexOf(".");return n>-1&&e.length-n-1>t&&(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t)),e.toString()},o=function(e){var t=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]","g");return e.replace(t,"")},r=function(e){for(var t=e.length,n=0,i=0;i<t;i++)0!=(65280&e.charCodeAt(i))&&n++,n++;return n},s=function(e){return e>=55296&&e<=56319},l=function(e){return e>=56320&&e<=57343},c=function(e){return e>=55296&&e<=57343};function d(e){return e.replace(/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g,"")}function u(e){return/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g.test(e)}},502:function(e,t,n){"use strict";n.r(t);var i=n(238),a=n.n(i),o=n(239);t.default=Object(o.a)("arrow_up_s",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},a.a.createElement("path",{d:"M4.25 9.49998L7.99327 6.00635C7.99711 6.00277 8.00307 6.00277 8.00691 6.00635L11.75 9.49998",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},5298:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var i=0,a=1,o=2},564:function(e,t,n){"use strict";var i,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getEditModeQueryPair=t.isNewFile=t.isEditEnterMode=t.closeReadingMode=t.isReadingMode=void 0;var r=n(5).__importStar(n(167)),s=n(14),l=!!(null===(o=null===(a=null===(i=window.__WPSENV__)||void 0===i?void 0:i.file_info)||void 0===a?void 0:a.file)||void 0===o?void 0:o.corp_id),c=r.isMobile;t.isReadingMode=function(){var e,t,n;return(null===(t=null===(e=window.APP)||void 0===e?void 0:e.isReadOnly)||void 0===t?void 0:t.call(e))&&"read"===(null===(n=window.__WPSENV__)||void 0===n?void 0:n.enterMode)&&l&&!c},t.closeReadingMode=function(){(0,s.setQuery)("enterMode","edit"),location.reload()},t.isEditEnterMode=function(){return"edit"===(0,s.getQuery)("enterMode")},t.isNewFile=function(){return"true"===(0,s.getQuery)("newFile")},t.getEditModeQueryPair=function(){return{enterMode:"edit"}}},5656:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBackupUnexpired=t.storeBackupData=t.deleteBackupData=t.getBackupData=t.getBackupKey=void 0;var i,a=n(5).__importDefault(n(1402));function o(){var e=window.fileInfo,t=e.office_type,n=e.id,i="lateXbc-".concat(t,"-").concat(n);return{dataKey:i,timeKey:"time-"+i}}function r(){var e=a.default.getInstance(),t=o(),n=t.dataKey,i=t.timeKey;e.delete(n),e.delete(i)}function s(){var e=a.default.getInstance(),t=o().timeKey;return new Promise((function(n,a){e.read(t,(function(e,t){if(e)a(e);else{var o=parseInt(window.localStorage.getItem("LateXBackupExistenceTime"),10)||86400;Date.now()-t<=1e3*o?n(i.AVAILABLE):(r(),a(i.EXPIRED))}}))}))}!function(e){e.EXPIRED="lateX backup expired",e.AVAILABLE="available"}(i||(i={})),t.getBackupKey=o,t.getBackupData=function(e){var t=o().dataKey,n=a.default.getInstance();return s().then((function(){return new Promise((function(i,a){n.read(t,(function(t,n){if(!t){var o=JSON.parse(n);o.userId!==e?(r(),a()):i(o)}a(t)}))}))}))},t.deleteBackupData=r,t.storeBackupData=function(e,t,n){var i=a.default.getInstance(),r=o(),s=r.dataKey,l=r.timeKey;i.write(s,JSON.stringify({userId:t,data:e,positionInfo:n})),i.write(l,Date.now())},t.isBackupUnexpired=s},568:function(e,t,n){"use strict";n.r(t),n.d(t,"BtnType",(function(){return P}));var i=n(30),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(22),d=n.n(c),u=n(23),p=n.n(u),m=(n(778),n(238)),f=n.n(m),h=n(600),g=n(240),w=n(472),v=n(167),b=function(e,t){return t>=e.split(".")[1].length},C=function(e,t,n,i){var a=e,o=/^(-)?(0)+$/,r=o.test(a);return r&&(a=a.replace(o,"$10")),t&&!n?function(e){e=Number(e);return{valid:/^\d+$/.test(e),newStr:e}}(a):t&&n?function(e){var t=/^(-)?\d*$/.test(e);return/(-)?\d+$/.test(e)&&(e=Number(e)),{valid:t,newStr:e}}(a):t||n?!t&&n?function(e,t,n){var i=/^(-)?\d+\.\d+$/,a=/^(-)?\d*$/.test(e)||/^(-)?\d+\.$/.test(e)||i.test(e);i.test(e)&&!b(e,n)&&(a=!1);return/(-)?0+\d+$/.test(e)&&(e=Number(e)),{valid:a,newStr:e}}(a,0,i):void 0:function(e,t){var n=/^\d+$/,i=/^\d+\.\d+$/,a=n.test(e)||/^\d+\.$/.test(e)||i.test(e);return i.test(e)&&!b(e,t)&&(a=!1),n.test(e)&&(e=Number(e)),{valid:a,newStr:e}}(a,i)},E=n(246),y=n(322),_=n(380),k=n(502),P={add:"add",subtract:"subtract"},S=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleWheel=function(e){g.isMouseInElement(e,n.mianRef.current)&&g.stopBubble(e)},n.clickTimeout=null,n.clickInterval=null,n.refAdd=f.a.createRef(),n.refInput=f.a.createRef(),n.mianRef=f.a.createRef(),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handleMinusBtnClick=n.handleMinusBtnClick.bind(n),n.handleInputBlur=n.handleInputBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleInputKeyUp=n.handleInputKeyUp.bind(n),n.handleInputWheel=n.handleInputWheel.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleContainerClick=n.handleContainerClick.bind(n),n.handleInputFocus=n.handleInputFocus.bind(n),n.getValue=n.getValue.bind(n),n.recoverLastValidValue=n.recoverLastValidValue.bind(n);var i=n.props,a=i.value,o=i.defaultValue,s=i.step,l=i.debounceWait;return n.step=s||1,n.defaultValue=o||a,n.state={value:a},n._lockLazyChange=!0,n.debounceInputChange=Object(h.debounce)((function(e){n.inputChange(e)}),l),n}return p()(t,e),l()(t,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&(this.setState({value:this.props.value}),this._lockLazyChange=!0)}},{key:"componentDidMount",value:function(){document.addEventListener("wheel",this.handleWheel,v.getPassiveParam())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.lazyTimer),document.removeEventListener("wheel",this.handleWheel,v.getPassiveParam())}},{key:"getValue",value:function(){var e=this.props,t=e.value,n=e.isInt,i=e.min,a=e.max,o=this.refInput.current.value,r=n?parseInt(o):parseFloat(o);return r>a||r<i?Number(t):isNaN(r)?Number(this.defaultValue):Number(r)}},{key:"focus",value:function(){g.setInputFocus(this.refInput.current)}},{key:"select",value:function(){this.refInput.current.select()}},{key:"blur",value:function(){this.refInput.current.blur()}},{key:"getInnerValue",value:function(){return Number(this.refInput.current.value)}},{key:"recoverLastValidValue",value:function(){var e=this.props.value;this.setState({value:e})}},{key:"getInputText",value:function(){return this.refInput.current.value}},{key:"setValue",value:function(e){var t=this.props,n=t.onChange,i=t.isInt,a=t.max,o=t.min,r=t.places;return e=i?e:Object(w.formatDecimal)(e,r),e=(e=isNaN(e)?this.defaultValue:e)>a?a:e<o?o:e,this._lockLazyChange=e===this.props.value,this.setState({value:e}),n&&n(e),e}},{key:"setInvalidValue",value:function(e){var t=this.props.onOutOfRange;this.setState({value:e}),t&&t(e)}},{key:"inputChange",value:function(e){var t=this.props,n=t.max,i=t.min,a=t.isInt,o=t.isNegative,r=t.places,s=t.onOutOfRange,l=e.replace(/\s+/g,"");if(""!==l)if(l>n)s&&s(l);else{var c=C(l,a,o,r),d=c.valid,u=c.newStr;if(!(d&&u<i))return d&&isNaN(u)?(this.setState({value:u}),void(s&&s(e))):void(d&&"-0"===l?this.setState({value:l}):d?this.setValue(u):"-"===e&&s&&s(l));this.setInvalidValue(u)}else this.setInvalidValue(l)}},{key:"handleInputChange",value:function(e){g.stopBubble(e);var t=e.target.value;this.props.debounceWait?this.debounceInputChange(t):this.inputChange(t)}},{key:"handleInputBlur",value:function(e){g.stopBubble(e),this.handleLazyChange(this.state.value),this.props.onBlur&&this.props.onBlur(e),this.setState({isFocus:!1})}},{key:"handleInputFocus",value:function(e){this.setState({isFocus:!0}),this.props.onFocus&&this.props.onFocus(e)}},{key:"handleInputKeyDown",value:function(e){if(Object(E.isMatchShortCutKey)(e,[E.Keys.ArrowUp]))this.handleAddBtnClick(e);else if(Object(E.isMatchShortCutKey)(e,[E.Keys.ArrowDown]))this.handleMinusBtnClick(e);else{var t=this.props.onEnter;Object(E.isMatchShortCutKey)(e,[E.Keys.Enter])&&(g.stopBubble(e),t&&t(),this.handleLazyChange(this.state.value))}}},{key:"handleInputKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"handleInputWheel",value:function(e){if(this.props.readOnly)return!1;var t=parseFloat(this.state.value),n=this.props.step;e.deltaY>0||e.deltaX<0?t-=n:t+=n,this.handleLazyChange(this.setValue(t))}},{key:"handleAddBtnClick",value:function(e){this.btnClick(e,!0)}},{key:"handleMinusBtnClick",value:function(e){this.btnClick(e,!1)}},{key:"btnClick",value:function(e,t){g.stopBubble(e);var n=this.state.value,i=this.props.step,a=e.currentTarget.className;if(g.setInputFocus(this.refInput.current),-1===a.indexOf("disabled")&&-1===a.indexOf("readonly")){var o=parseFloat(n);o+=t?i:-i,this.handleLazyChange(this.setValue(o),t?P.add:P.subtract,!0)}}},{key:"handleMouseDown",value:function(e){var t=this,n=e.target===this.refAdd.current;clearTimeout(this.clickTimeout),clearInterval(this.clickInterval);var i={currentTarget:{className:e.currentTarget.className}};this.clickTimeout=setTimeout((function(){t.clickInterval=setInterval((function(){n?t.handleAddBtnClick(i):t.handleMinusBtnClick(i)}),100)}),500)}},{key:"handleMouseUp",value:function(){clearTimeout(this.clickTimeout),clearInterval(this.clickInterval)}},{key:"handleContainerClick",value:function(e){var t=this.props,n=t.stopbubble,i=t.onContainerClick;i&&i(e),n&&g.stopBubble(e)}},{key:"handleInputMouseDown",value:function(){g.stopOnceClick()}},{key:"handleLazyChange",value:function(e,t,n){var i=this.props.onLazyChange;i&&!this._lockLazyChange&&(clearTimeout(this.lazyTimer),this._lockLazyChange=!0,this.lazyTimer=setTimeout((function(){i(e,t)}),n?100:300))}},{key:"render",value:function(){var e,t=this.props,n=t.className,i=t.max,o=t.min,r=t.unit,s=t.readOnly,l=t.onPaste,c=t.showBtn,d=t.altScPosition,u=t.size,p=this.state,m=p.value,h=p.isFocus,g=f.a.classNames((e={"wo-component-input-number":1},a()(e,"wo-component-input-number--"+u,u),a()(e,"is-disabled",s),a()(e,"is-focus",h),e),n);return f.a.createElement("div",{className:g,ref:this.mianRef,onWheel:this.handleInputWheel,onClick:this.handleContainerClick},f.a.createElement("div",{className:"wo-component-input-number-wrap wo-component-input-number-input"},f.a.createElement("input",{ref:this.refInput,className:s?"readonly":"",value:m,maxLength:7,type:"text",tabIndex:-1,onFocus:this.handleInputFocus,onKeyUp:this.handleInputKeyUp,onKeyDown:this.handleInputKeyDown,onChange:this.handleInputChange,onBlur:this.handleInputBlur,readOnly:s,onPaste:l,unselectable:s?"on":null,disabled:s,onMouseDown:this.handleInputMouseDown,"alt-sc-position":d})),!!r&&f.a.createElement("div",{className:"wo-component-input-number-unit"},r),c&&!v.isTouchScreen&&f.a.createElement("div",{className:"wo-component-input-number-controls input-btns-wrap"+(s?"  readonly":"")},f.a.createElement(y.default,{ref:this.refAdd,className:"wo-component-input-number--increase add"+(m>=i||s?" disabled":""),onClick:this.handleAddBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp},f.a.createElement(k.default,{fill:"var(--kd-color-icon-secondary)",size:["medium","middle","small"].includes(u)?8:12})),f.a.createElement(y.default,{className:"wo-component-input-number--decrease minus"+(m<=o&&""!==m||s?" disabled":""),onClick:this.handleMinusBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp},f.a.createElement(_.default,{fill:"var(--kd-color-icon-secondary)",size:["medium","middle","small"].includes(u)?8:12}))))}}]),t}(m.PureComponent);S.defaultProps={max:999999,min:-999999,value:0,isInt:!1,isNegative:!1,places:2,stopbubble:!0,showBtn:!0,step:1,debounceWait:0,size:"large"};t.default=S},591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(866);var a=i.__importStar(n(238)),o=i.__importDefault(n(702)),r=function(e){function t(t){var n=e.call(this,t)||this;n.handleChange=function(e){n.setState({value:e}),n.props.onChange&&n.props.onChange(e)},n.refRadios=[];var i=t.value,a=t.defaultValue,o=t.options,r=void 0===a?i:a;return r=void 0===r?o[0].value:r,n.state={value:r},n}return i.__extends(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.value;return void 0!==n&&n!==t.value?{value:n}:null},t.prototype.getCheckedValue=function(){return this.state.value},t.prototype.renderItems=function(){var e=this,t=this.props,n=t.options,r=t.tabIndex,s=this.state.value;return n.map((function(t,n){return a.default.createElement(o.default,i.__assign({key:n,ref:function(t){return e.refRadios[n]=t}},t,{tabIndex:r,checked:t.value===s,value:t.value,onChange:e.handleChange}),t.content)}))},t.prototype.render=function(){var e=this.props.className,t=a.default.classNames({"wo-radio-group":1},e);return a.default.createElement("div",{className:t},this.renderItems())},t}(a.PureComponent);t.default=r},629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Size=void 0;var i=n(5);n(1172);var a,o=i.__importStar(n(238)),r=i.__importDefault(n(1056)),s=i.__importDefault(n(252));!function(e){e.small="small",e.middle="middle"}(a||(a={})),t.Size=a;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refWrap=o.default.createRef(),t.refSwitch=o.default.createRef(),t.handleClick=function(e){e.preventDefault();var n=t.props,i=n.checked,a=n.onChange;!n.disabled&&a&&(t.refWrap.current.scrollIntoViewIfNeeded(),a(!i))},t}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,n=e.disabled,a=e.title,l=e.tabIndex,c=e.children,d=e.size,u=e.altRole,p=e.altScPosition,m=i.__rest(e,["checked","disabled","title","tabIndex","children","size","altRole","altScPosition"]),f=o.default.classNames({"wo-switch":1}),h=n?null:a;return o.default.createElement(s.default,{title:h},o.default.createElement("div",{ref:this.refWrap,className:f,tabIndex:l,role:u,"alt-sc-position":p,onClick:this.handleClick},o.default.createElement(r.default,i.__assign({ref:this.refSwitch,className:"switch-button",checked:t,size:d,disabled:n},m)),c&&o.default.createElement("div",{className:"switch-content"},c)))},t.defaultProps={size:a.small,allowFocus:!1,onFocus:Function.prototype,onBlur:Function.prototype},t}(o.PureComponent);t.default=l},642:function(e,t,n){"use strict";n.r(t);var i=n(238),a=n.n(i),o=n(262);n(669);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,o=void 0,o=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===r(o)?o:String(o)),i)}var a,o}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var a=u(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,n,i,r=c(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=r.call(this,e)).handleKeyDown=function(e){t.state.checked||32===e.keyCode&&(e.preventDefault(),t.setState({checked:!0}),t.props.onChange&&t.props.onChange(t.props.value))},t.state={checked:t.getChecked(e),focus:!1},t}return t=d,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.checked!==e.checked){var t=this.getChecked(this.props);this.state.checked!==t&&this.setState({checked:t})}}},{key:"onChange",value:function(e){var t=e.target.checked;t&&this.props.onChange&&this.props.onChange(this.props.value),this.setState({checked:t})}},{key:"onFocus",value:function(){this.setState({focus:!0})}},{key:"onBlur",value:function(){this.setState({focus:!1})}},{key:"getChecked",value:function(e){return Boolean(e.checked)}},{key:"render",value:function(){var e=this.state,t=e.checked,n=e.focus,i=this.props,r=i.className,s=i.disabled,l=i.value,c=i.children,d=i.tabIndex;return a.a.createElement("label",{className:Object(o.a)("kd-radio",r),tabIndex:s?-1:d||0,onKeyDown:this.handleKeyDown},a.a.createElement("span",{className:Object(o.a)({"kd-radio-input":!0,"is-checked":t,"is-disabled":s,"is-focus":n})},a.a.createElement("span",{className:"kd-radio-inner"}),a.a.createElement("input",{type:"radio",className:"kd-radio-original",checked:t,disabled:s,onChange:this.onChange.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),tabIndex:-1})),a.a.createElement("span",{className:"kd-radio-label"},c||l))}}])&&s(t.prototype,n),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),d}(i.Component);p.elementType="Radio";n(670);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,o=void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==m(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===m(o)?o:String(o)),i)}var a,o}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var a=v(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return w(this,n)}}function w(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(s,e);var t,n,i,r=g(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=r.call(this,e);var n=e.value,i=e.defaultValue;return t.state={value:void 0===i?n:i},t}return t=s,i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.value;return void 0!==n&&n!==t.value?{value:n}:null}}],(n=[{key:"onChange",value:function(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this,t=Object(o.a)("kd-radio-group","kd-radio-group-".concat(this.props.layout),this.props.className);return a.a.createElement("div",{className:t,style:this.props.style},a.a.Children.map(this.props.children,(function(t){if(!t)return null;var n=t.type.elementType;return"Radio"!==n&&"RadioButton"!==n?null:a.a.cloneElement(t,Object.assign({},t.props,{onChange:e.onChange.bind(e),checked:t.props.value==e.state.value,disabled:e.props.disabled}))})))}}])&&f(t.prototype,n),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.Component);b.defaultProps={layout:"horizontal"},p.Group=b;t.default=p},669:function(e,t,n){},670:function(e,t,n){},702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(728);var a=i.__importStar(n(238)),o=i.__importDefault(n(642)),r=i.__importDefault(n(252)),s=function(e){function t(t){var n=e.call(this,t)||this;n.handleClick=function(){n.refWrap.current.scrollIntoViewIfNeeded();var e=n.props,t=e.onChange,i=e.value;void 0===e.checked&&n.setState({checked:!0}),t&&t(i)},n.refWrap=a.default.createRef(),n.refRadio=a.default.createRef();var i=t.checked,o=t.defaultChecked,r=void 0===o?!!i:o;return n.state={checked:r},n}return i.__extends(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.checked;return void 0!==n&&n!==t.checked?{checked:n}:null},t.prototype.getChecked=function(){return this.state.checked},t.prototype.focus=function(){this.refRadio.current.onFocus()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.disabled,i=e.title,s=e.children,l=e.tabIndex,c=e.value,d=this.state.checked,u=n?null:i,p=a.default.classNames({"wo-radio":1},t);return a.default.createElement(r.default,{title:u},a.default.createElement("div",{ref:this.refWrap,className:p,tabIndex:l},a.default.createElement(o.default,{ref:this.refRadio,disabled:n,checked:d,value:c,onChange:this.handleClick},s)))},t.Group=o.default.Group,t.elementType="Radio",t}(a.PureComponent);t.default=s},728:function(e,t,n){},7374:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return u}));var i,a=n(30),o=n.n(a),r=n(1470),s=[_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.A4", "A4"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.envelope5", "Envelope No. 5"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.envelope6", "Envelope No. 6"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.envelope7", "Envelope No. 7"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.envelope9", "Envelope No. 9"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.lawPaper", "Legal paper"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.letter", "Letter paper"),_i18n("applications.writer.components.CommandBars.RbTab.Home.PaperSize.customSize", "Custom Paper Size")],l={A4:0,envelope5:1,envelope6:2,envelope7:3,envelope9:4,lawPaper:5,letter:6,customSize:7};function c(e){return r.default.init(e,r.UnitType.Unit_cm)}var d=[{width:c(21),height:c(29.7)},{width:c(10.9),height:c(12.9)},{width:c(11.9),height:c(22.9)},{width:c(16.1),height:c(22.8)},{width:c(22.8),height:c(32.3)},{width:c(21.5),height:c(33.5)},{width:c(21.5),height:c(27.9)}],u=(i={},o()(i,r.UnitType.Unit_pt,{max:1584,step:1}),o()(i,r.UnitType.Unit_inc,{max:22,step:.1}),o()(i,r.UnitType.Unit_cm,{max:55.88,step:.1}),o()(i,r.UnitType.Unit_mm,{max:558.5,step:1}),i)},7436:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return u}));var i,a,o,r=n(30),s=n.n(r),l={pt:0,inc:1,cm:2,mm:3,ref:4},c=[{content:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.pt", "Pound"),unit:"pt",value:l.pt},{content:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.inch", "Inch"),unit:"inc",value:l.inc},{content:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.cm", "cm"),unit:"cm",value:l.cm},{content:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.mm", "mm"),unit:"mm",value:l.mm},{content:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.character", "Char"),unit:"ref",value:l.ref}],d=(i={},s()(i,l.pt,{name:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.pt", "Pound"),code:"pt"}),s()(i,l.inc,{name:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.inch", "Inch"),code:"inc"}),s()(i,l.cm,{name:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.cm", "cm"),code:"cm"}),s()(i,l.mm,{name:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.mm", "mm"),code:"mm"}),s()(i,l.ref,{name:_i18n("applications.writer.components.CommandBars.TaskPane.FontPropertyPanel.character", "Char"),code:"ref"}),i),u={paragraphIndent:(a={},s()(a,l.pt,1584),s()(a,l.inc,22),s()(a,l.cm,55.88),s()(a,l.mm,558.8),s()(a,l.ref,316.8),a),paragraphSpacing:(o={},s()(o,l.pt,1584),s()(o,l.inc,22),s()(o,l.cm,55.88),s()(o,l.mm,558.8),s()(o,l.ref,316.8),o)}},7438:function(e,t,n){"use strict";var i=n(30),a=n.n(i),o=n(13),r=n.n(o),s=n(1),l=n.n(s),c=n(2),d=n.n(c),u=n(22),p=n.n(u),m=n(23),f=n.n(m),h=(n(9270),n(238)),g=n.n(h),w=n(319),v=n(258),b=n.n(v),C=n(9271),E=n.n(C),y={top:"bottom",bottom:"top",left:"right",right:"left"},_=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={firstVisible:!1},n.showTimer=null,n.closeTimer=null,n.handleClose=n.handleClose.bind(n),n}return f()(t,e),d()(t,[{key:"handleClose",value:function(){clearTimeout(this.closeTimer)}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.top,i=e.left,o=e.bottom,s=e.right,l=e.triangleStyle,c=void 0===l?{left:"16px",top:"100%"}:l,d=e.triangleDirection,u=void 0===d?"bottom":d,p={top:n,left:i,bottom:o,right:s},m=y[u].charAt(0).toUpperCase()+y[u].slice(1),f=r()({},c,a()({},"border"+m,"6px solid #fff")),h=_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.WebModeGuide.webModeDesc", "The cross-page view prevents a paragraph, table, or picture from breaking across pages, "),v=_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.WebModeGuide.applicableScene", "which is suitable for list, schedule, and project plan documents.");return g.a.createElement(w.default,{visible:t},g.a.createElement("div",{className:b()("web-mode-guide"),style:p},g.a.createElement("div",{className:"web-mode-guide-content"},g.a.createElement("div",{className:"web-mode-guide-content-text"},h+v)),g.a.createElement("div",{className:"web-mode-guide-pic"},g.a.createElement("img",{src:E.a})),g.a.createElement("div",{className:"web-mode-guide-triangle",style:f})))}}]),t}(h.PureComponent);t.a=_},7501:function(e,t,n){"use strict";n.r(t),n.d(t,"DOC_PAGE_MARGIN_POS",(function(){return a})),n.d(t,"DOC_PAGE_MARGIN_POS_NAME",(function(){return o})),n.d(t,"DOC_PAGE_MARGIN_POS_EN_NAME",(function(){return r})),n.d(t,"DOC_PAGE_MARGIN_TYPE",(function(){return s})),n.d(t,"DOC_PAGE_MARGIN_NAME",(function(){return l})),n.d(t,"DOC_PAGE_MARGIN_CN_NAME",(function(){return c})),n.d(t,"DOC_PAGE_MARGIN_SIZE",(function(){return d})),n.d(t,"DOC_PAGE_MARGIN_SIZE_TORRENCE",(function(){return u})),n.d(t,"DOC_PAGE_MARGIN_LIMIT_SIZES",(function(){return p}));var i=n(1470),a={TOP:0,LEFT:1,BOTTOM:2,RIGHT:3},o=[_i18n("applications.writer.components.core.app.uil.marginPos.top", "Top"),_i18n("applications.writer.components.core.app.uil.marginPos.left", "Left"),_i18n("applications.writer.components.core.app.uil.marginPos.bottom", "Bottom"),_i18n("applications.writer.components.core.app.uil.marginPos.right", "Right")],r=["top","left","bottom","right"],s={Normal:0,Compact:1,Moderate:2,Wide:3,Custom:4},l=["Normal","Compact","Moderate","Wide","Custom"],c=[_i18n("applications.writer.components.core.app.uil.margin.normal", "Normal"),_i18n("applications.writer.components.core.app.uil.margin.compact", "Narrow"),_i18n("applications.writer.components.core.app.uil.margin.moderate", "Moderate"),_i18n("applications.writer.components.core.app.uil.margin.wide", "Wide"),_i18n("applications.writer.components.core.app.uil.margin.custom", "Custom Page Margins")],d=[{t:i.default.init(72,i.UnitType.Unit_pt),b:i.default.init(72,i.UnitType.Unit_pt),l:i.default.init(90,i.UnitType.Unit_pt),r:i.default.init(90,i.UnitType.Unit_pt)},{t:i.default.init(36,i.UnitType.Unit_pt),b:i.default.init(36,i.UnitType.Unit_pt),l:i.default.init(36,i.UnitType.Unit_pt),r:i.default.init(36,i.UnitType.Unit_pt)},{t:i.default.init(72,i.UnitType.Unit_pt),b:i.default.init(72,i.UnitType.Unit_pt),l:i.default.init(54,i.UnitType.Unit_pt),r:i.default.init(54,i.UnitType.Unit_pt)},{t:i.default.init(72,i.UnitType.Unit_pt),b:i.default.init(72,i.UnitType.Unit_pt),l:i.default.init(144,i.UnitType.Unit_pt),r:i.default.init(144,i.UnitType.Unit_pt)}],u=i.default.init(.01,i.UnitType.Unit_cm),p={TopBottomMax:i.default.init(792,i.UnitType.Unit_pt),TopBottomMin:i.default.init(-792,i.UnitType.Unit_pt),LeftRightMax:i.default.init(792,i.UnitType.Unit_pt),LeftRightMin:i.default.init(0,i.UnitType.Unit_pt)}},767:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(22),l=n.n(s),c=n(23),d=n.n(c),u=(n(872),n(238)),p=n(240),m=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={online:!0},n.isEnter=!1,n.markElement=null,n.enterElement=null,n.position=null,n.addMask=function(){var e=n.props,t=e.showMask,i=e.maskText;n.isEnter&&t&&!n.markElement&&(n.markElement=document.createElement("div"),n.markElement.className="drag-selector-mask",n.markElement.textContent=i||_i18n("applications.public.components.upload.maskText", "Release the mouse to insert the file into the document"),n.getElement().appendChild(n.markElement))},n.removeMask=function(e,t){if(n.markElement){var i=n.getElement();!e&&Object(p.isMouseInElement)(t,i)||(i.removeChild(n.markElement),n.markElement=null)}},n.handleDragEnter=n.handleDragEnter.bind(n),n.handleDragLeave=n.handleDragLeave.bind(n),n.handleDragOver=n.handleDragOver.bind(n),n.handleDrop=n.handleDrop.bind(n),n.handleOnline=n.handleOnline.bind(n),n.handleOffline=n.handleOffline.bind(n),n}return d()(t,e),r()(t,[{key:"getElement",value:function(){return this.props.element||document.body}},{key:"componentDidMount",value:function(){var e=this.getElement();e.addEventListener("dragenter",this.handleDragEnter),e.addEventListener("dragover",this.handleDragOver),e.addEventListener("dragleave",this.handleDragLeave),e.addEventListener("drop",this.handleDrop),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline)}},{key:"componentWillUnmount",value:function(){var e=this.getElement();e.removeEventListener("dragenter",this.handleDragEnter),e.removeEventListener("dragover",this.handleDragOver),e.removeEventListener("dragleave",this.handleDragLeave),e.removeEventListener("drop",this.handleDrop),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline)}},{key:"handleOnline",value:function(){this.setState({online:!0})}},{key:"handleOffline",value:function(){this.setState({online:!1})}},{key:"handleDragEnter",value:function(e){for(var t=e.dataTransfer.types,n=0;n<t.length;n++)if(-1!==t[n].toLowerCase().indexOf("file")){Object(p.stopBubble)(e),this.isEnter=!0;break}this.enterElement=e.target,this.addMask()}},{key:"handleDragOver",value:function(e){if(this.isEnter){Object(p.stopBubble)(e);var t=e.pageX,n=e.pageY;this.position={x:t,y:n},this.props.onDragOver&&this.props.onDragOver(this.position),this.addMask()}}},{key:"handleDragLeave",value:function(e){if(this.isEnter){if(this.enterElement!==e.target)return;Object(p.stopBubble)(e),this.removeMask(!1,e),this.props.onDragLeave&&this.props.onDragLeave()}}},{key:"handleDrop",value:function(e){if(this.isEnter){this.removeMask(!0),this.isEnter=!1,Object(p.stopBubble)(e);var t=this.props,n=t.disabled,i=t.extension,a=t.maxSize,o=t.onChange,r=t.multiple,s=t.needCheck,l=t.onErrorChange;if(!(n||!this.state.online||document.getElementsByClassName("component-uploader").length>0)){var c={};i.map((function(e){return c[e.toLowerCase()]=!0}));var d=e.dataTransfer.files;if(s){for(var u=[],m=0;m<d.length;m++){var f=d[m],h=f.type,g=f.name,w=f.size;if(h){var v=g.lastIndexOf("."),b=-1!==v?g.substr(v+1):"";if(c[b.toLowerCase()]){if(a>0&&w>1024*a)return void window.Toast.info(_i18n("applications.public.components.upload.fileSizeError", "Please upload a file smaller than {0}M").replace("{0}",parseInt(a/1024,10)));u.push(d[m])}}}if(u.length)o(r?u:u[0],this.position);else l()}else o(d,this.position)}}}},{key:"render",value:function(){return!1}}]),t}(u.PureComponent);m.defaultProps={extension:[],multiple:!1,maxSize:0,needCheck:!0,onErrorChange:function(){}},t.default=m},778:function(e,t,n){},866:function(e,t,n){},872:function(e,t,n){},881:function(e,t,n){"use strict";n.r(t);var i=n(238),a=n.n(i),o=n(239);t.default=Object(o.a)("bubble",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("path",{d:"M5.75024 5.24991H10.2502M5.75 8.24991H8.25M3.25 12.2631C2.42157 12.2631 1.75 11.5915 1.75 10.7631L1.75024 3.24991C1.75024 2.42148 2.42181 1.74991 3.25024 1.74991H12.7502C13.5787 1.74991 14.2502 2.42148 14.2502 3.24991L14.25 10.7631C14.25 11.5915 13.5784 12.2631 12.75 12.2631H8.7822L6.26073 14.817C6.0723 15.0078 5.74725 14.8744 5.74725 14.6062V12.2631H3.25Z",strokeLinecap:e.strokeLinecap,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},911:function(e,t,n){"use strict";n.r(t);var i=n(238),a=n.n(i),o=n(239);t.default=Object(o.a)("question",!1,(function(e){return a.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},a.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#333333"},a.a.createElement("circle",{cx:"8.00024",cy:"12.0002",r:"0.894775",stroke:"none"}),a.a.createElement("path",{d:"M8.00965 9.32672V9.01691C8.00965 8.87948 8.03286 8.78701 8.1517 8.66928C8.1517 8.66928 8.13971 8.68523 9.17476 7.65018C10.2098 6.61513 10.1427 5.3452 9.27286 4.54429C8.71146 4.0274 7.59496 3.94243 6.94395 4.34059C6.17419 4.81138 5.99805 5.37027 5.99805 6.12238",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"}),a.a.createElement("circle",{cx:"8",cy:"8",r:"6.75",fill:"none",vectorEffect:"non-scaling-stroke"})))}))},9268:function(e,t,n){"use strict";var i=n(13),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(22),d=n.n(c),u=n(23),p=n.n(u),m=n(238),f=n.n(m),h=n(241),g=n(4466),w=n(243),v=n.n(w),b=n(1550),C=n(329),E=v.a.iconTypes.size16,y=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isShowDocMap=window.__CONFIG__.wps.isShowDocMap,n.handleClick=n.handleClick.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.isShowDocMap&&this.props.showText&&window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents"),icon:E.wps_structure})}},{key:"handleClick",value:function(){var e=this.props.show;e=!e,this.props.showText?window.collection("commandbar","click","page|structure_"+(e?"on":"off")):window.collection("commandbar","click","statusbar|structure_"+(e?"on":"off")),this.props.dispatch(g.a(e))}},{key:"render",value:function(){var e=this;if(!this.isShowDocMap)return null;var t=this.props,n=t.showText,i=t.show,o=t.disabled,r=t.fill,s={icon:f.a.createElement(b.default,{size:16,fill:r||[C.iDefault]}),disabled:o,selected:i,onClick:this.handleClick};return n?f.a.createElement(v.a,a()({size:"middle",ref:function(t){e.refBtn=t}},s),_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents")):f.a.createElement(v.a,a()({size:"middle",ref:function(t){e.refBtn=t}},s,{title:_i18n("applications.writer.components.CommandBars.RbTab.Home.DocMap.docMap", "Contents")}))}}]),t}(m.PureComponent);t.a=Object(h.connect)((function(e){return{show:e.writer.docmap.show}}))(y)},9269:function(e,t,n){"use strict";var i,a,o=n(13),r=n.n(o),s=n(144),l=n.n(s),c=n(30),d=n.n(c),u=n(238),p=n.n(u),m=n(241),f=n(8215),h=n(321),g=n(243),w=n.n(g),v=n(260),b=n(560),C=n.n(b),E=n(684),y=n(7438),_=n(167),k=n(1717),P=n.n(k),S=n(1661),T=n(329),M=h.default.DropdownPanel.Item,O=(a={},d()(a,window.rightToLeft?"right":"left",44),d()(a,"bottom",40),d()(a,"triangleStyle",(i={},d()(i,window.rightToLeft?"right":"left","16px"),d()(i,"top","100%"),i)),d()(a,"triangleDirection","bottom"),a);t.a=Object(m.connect)((function(e){return{selected:e.writer.webMode.isWebMode}}))(Object(u.memo)((function(e){var t=e.fill,n=e.selected,i=e.disabled,a=e.showText,o=e.dispatch,s=e.onClick,c=void 0===s?Function.prototype:s,d=Object(u.useState)(!0),m=l()(d,2),h=m[0],g=m[1],b=Object(u.useState)(!1),k=l()(b,2),R=k[0],I=k[1],N=Object(u.useState)(!1),D=l()(N,2),A=D[0],B=D[1];Object(u.useEffect)((function(){return window.addEventListener(v.default.view.AFTER_VIEW_MODE_CHANGED,L),function(){window.removeEventListener(v.default.view.AFTER_VIEW_MODE_CHANGED,L)}}),[L]),C()(v.default.webMode.ON_WEBMODE_GUIDE,(function(){B(!0);var e=setTimeout((function(){B(!1),clearTimeout(e)}),5e3)})),C()(v.default.names.DOC_SELECTION_CHANGED,window.utils.Lodash.debounce((function(e){var t=window.APP.data.selection,n=t.selContext.isInComment(),i=t.selContext.isCommentEditable;g(!(n&&i))}),100));var L=Object(u.useCallback)((function(e){var t=e.detail.typoMode;o(f.b(t===E.TYPO_MODE.MODE_WEB))}),[o]),H=Object(u.useMemo)((function(){return{icon:a?"":p.a.createElement(S.a,{size:16,fill:t||[T.iDefault]}),disabled:i||!h,selected:n,onClick:window.utils.Lodash.throttle((function(){var e=n?E.TYPO_MODE.MODE_PC:E.TYPO_MODE.MODE_WEB;e===E.TYPO_MODE.MODE_WEB&&window.__CONFIG__.wps.isAdaptWebView&&1!==window.APP.workspace.config.zoom&&v.default.dispatchEvent(v.default.zoom.DOC_SCALE,{zoom:100}),window.APP.viewUIL.onViewModeChanged(e,!1),window.collection("commandbar","click",(a?"page|":"statusbar_")+"webmode_"+(n?"off":"on")),c(),B(!1),I(!1)}),800,{trailing:!1})}}),[i,h,n,t]),F=window.APP.isReadOnly();return a?p.a.createElement(M,H,p.a.createElement(P.a,{icon:p.a.createElement(S.a,{size:16}),text:_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.webModeTrigger", "Full Page Mode")})):p.a.createElement("div",{onMouseEnter:function(){_.isPad||I(!0)},onMouseLeave:function(){_.isPad||I(!1)}},p.a.createElement(w.a,r()({size:"middle",title:F?_i18n("applications.writer.components.CommandBars.RbTab.Home.WebMode.title", "full page"):""},H)),!F&&p.a.createElement(y.a,r()({visible:A||R},O)))})))},9270:function(e,t,n){},9271:function(e,t,n){e.exports=n.p+"images/doc_web_mode_tips.890f42fb.svg"},9932:function(e,t,n){"use strict";n.r(t),n.d(t,"DOC_PAPER_DIRECTION",(function(){return i})),n.d(t,"DOC_PAPER_DIRECTION_NAME",(function(){return a})),n.d(t,"DOC_PAPER_DIRECTION_CN_NAME",(function(){return o}));var i={Vertical:0,Horizontal:1},a=["Vertical","Horizontal"],o=[_i18n("applications.writer.components.core.app.uil.direction.vertical", "Vertical"),_i18n("applications.writer.components.core.app.uil.direction.horizontal", "horizontal")]},9933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),a=i.__importStar(n(238)),o=n(5656),r=i.__importDefault(n(662)),s=i.__importDefault(n(9934)),l=i.__importDefault(n(247)),c=n(1054);t.default=function(e){var t=(0,a.useState)(!1),n=t[0],d=t[1],u=(0,a.useState)(""),p=u[0],m=u[1],f=(0,a.useState)(!1),h=f[0],g=f[1],w=h||e.visible;return(0,a.useEffect)((function(){e.readOnly||(0,o.getBackupData)(e.userId).then((function(e){d(!0)})).catch((function(e){d(!1)})),(0,c.getUrlByPlugin)(c.linkTypes.AboutLaTeX).then((function(e){e&&m(e)}))}),[]),n&&!e.disableBackup?a.default.createElement(r.default,{onOk:function(){g(!0),d(!1)},onCancel:function(){(0,o.deleteBackupData)(),d(!1)},drag:!1},a.default.createElement("div",null,_i18n("applications.public.latexMath.errorNoticeOfLateX", "It is detected that the formula you edited has exited abnormally. Do you want to restore the data?"))):w?(0,l.default)(s.default,i.__assign(i.__assign({},e),{onCancel:function(){e.onCancel(),g(!1)},onCommit:function(t){e.onCommit(t),g(!1)},documentationLink:p})):null}},9934:function(e,t,n){e.exports=function(e,t){n.e(597).then(n.t.bind(null,10845,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}}}]);