(window.webpackJsonp=window.webpackJsonp||[]).push([[884,526,881],{10028:function(e,t,n){"use strict";var i=n(13),a=n.n(i),o=n(8),r=n.n(o),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(947),h=n(5717),p=n(3081),f=n(309),g=n(22),v=n.n(g),y=n(23),m=n.n(y),_=n(1142),x=n(405),w=n(406),k=n(6067),b=function(){function e(t){l()(this,e),this.doc_array=[],this.doc_map=k.a.init(),this.init(t)}return u()(e,[{key:"init",value:function(e){var t=this;e&&(this.doc_array=e,Object(w.a)(this.doc_array,(function(e){var n=e.key,i=e.value;t.doc_map.set(n,i)})))}},{key:"enqueue",value:function(e){this.doc_array.push(e);var t=e.key,n=e.value;this.doc_map.set(t,n)}},{key:"dequeue",value:function(){var e=this.doc_array.shift(),t=e.key;return this.doc_map.delete(t),e}},{key:"removeByKey",value:function(e){var t=this.findIndexByKey(e);this.isLegalIndex(t)&&this.removeByIndex(t)}},{key:"removeByIndex",value:function(e){var t=this.doc_array[e];this.doc_map.delete(t.key),this.doc_array.splice(e,1)}},{key:"isLegalIndex",value:function(e){return e>=0&&e<this.length}},{key:"findIndexByKey",value:function(e){return Object(x.a)(this.doc_array,(function(t,n){return e===t.key}))}},{key:"isEmpty",value:function(){return this.length<=0}},{key:"isExist",value:function(e){return this.doc_map.has(e)}},{key:"getValue",value:function(e){return this.doc_map.get(e)}},{key:"length",get:function(){return this.doc_array.length}},{key:"lastItem",get:function(){var e=this.length;return e<=0?null:this.doc_array[e-1]}}]),e}(),T=n(676),C="SHAPE",S=function(){function e(){var t=this;l()(this,e),this.container=Object(T.createElement)({type:"div",id:"offscreen-canvas-container",parent:document.body,style:"position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; flex-direction: column;max-width: 1000px; flex-wrap: wrap;background: rgba(0, 0, 0, .5);z-index: -1; opacity: 0;overflow: auto;"}),this.container.onClick=function(){t.hide()},this.caches={}}return u()(e,[{key:"single_reset",value:function(){}},{key:"createCache",value:function(e,t){return this.caches[e]={item:new b,maxSize:t},this.caches[e]}},{key:"getCache",value:function(e){return this.caches[e]}},{key:"setCache",value:function(e,t,n,i){var a=this.caches[e],o=a.item,r=a.maxSize;if(o.getValue(t))return{isCached:!0,canvas:o.getValue(t)};o.length>=r&&o.dequeue();var s=Object(T.createElement)({type:"canvas",class:"offscreen-canvas",style:"width:"+n+"px; height:"+i+"px;",parent:this.container});return s.style.width=n+"px",s.style.height=i+"px",s.width=n,s.height=i,o.enqueue({key:t,value:s}),{isCached:!1,canvas:s}}},{key:"removeCache",value:function(e){var t=(this.caches[e]||{}).item;if(t&&t instanceof b){for(;t.length>0;){var n=t.dequeue().value;n&&n instanceof HTMLCanvasElement&&this.container.removeChild(n)}delete this.caches[e]}}},{key:"show",value:function(){this.container.style.zIndex=999,this.container.style.opacity=1}},{key:"hide",value:function(){this.container.style.zIndex=-1,this.container.style.opacity=0}}]),e}(),E=S;_.a.buildInstance(S);var P=function(e){function t(){return l()(this,t),v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,C,20))}return m()(t,e),u()(t,[{key:"single_reset",value:function(){}},{key:"renderCache",value:function(e,t,n,i,a){t.drawImage(n,0,0,i,a)}}]),t}(function(){function e(t,n){l()(this,e),this.type=t,this.maxSize=n,this.manager=new E,this.cache=this.manager.createCache(this.type,this.maxSize).item}return u()(e,[{key:"renderCache",value:function(e,t,n,i,a){}},{key:"getCachedCanvas",value:function(e){return this.cache.getValue(e)}},{key:"setCachedCanvas",value:function(e,t,n,i){var a=isNaN(n)?t.width:n,o=isNaN(i)?t.height:i,r=this.manager.setCache(this.type,e,a,o),s=r.isCached,l=r.canvas;if(!s){var c=l.getContext("2d");this.renderCache(l,c,t,a,o)}return l}},{key:"removeCachedCanvas",value:function(e){var t=this.getCachedCanvas(e);t&&(this.cache.removeByKey(e),this.manager.container.removeChild(t))}},{key:"length",get:function(){return this.cache.length}}]),e}()),L=P;_.a.buildInstance(P);var A=n(400),I=n(260),R=n(1804),O=n(167),M=n(1252),D=n(3334),N=[d.a.SHAPE_RESIZE_TL,d.a.SHAPE_RESIZE_TM,d.a.SHAPE_RESIZE_TR,d.a.SHAPE_RESIZE_RM,d.a.SHAPE_RESIZE_BR,d.a.SHAPE_RESIZE_BM,d.a.SHAPE_RESIZE_BL,d.a.SHAPE_RESIZE_LM,d.a.SHAPE_ADJUSTHANDLER_1,d.a.SHAPE_ADJUSTHANDLER_2,d.a.SHAPE_ADJUSTHANDLER_3,d.a.SHAPE_ADJUSTHANDLER_4,d.a.SHAPE_ADJUSTHANDLER_5,d.a.SHAPE_ADJUSTHANDLER_6,d.a.SHAPE_ADJUSTHANDLER_7,d.a.SHAPE_ADJUSTHANDLER_8,d.a.SHAPE_ADJUSTHANDLER_9];function B(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}function j(e){if(e.textbox&&e.line.parent.parent===e.textbox)return!0;return!1}var F=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(t,n,i,a){if(a&&!a.isInRepeatHeaderRow&&!e.hitAnchors(i,a,n))if(e.hitDrawing(i,a,n,!0))j(a)&&e.hitEmbed(i,a,n);else if(!e.hitEmbed(i,a,n)){var o={left:a.line.rect.left,top:a.line.rect.top,right:a.line.textWidth+5,bottom:a.line.rect.bottom};A.a.pointInRect(a.innerPos,o)||!e.hitDrawing(i,a,n,!1)?a.shapeInfo={isHitOnShape:!1}:j(a)&&e.hitEmbed(i,a,n)}}},{key:"hitEmbed",value:function(t,n,i){var a=n.innerPos,o=n.coorPos2View,r=n.glyphGroupInfo,s=n.shapeForMath,l=n.offsetOfGlyphGroupInfo;if(r&&r.shape||s){var c=r.shape||s,u=c.id,h=c.rect,p=c.anchor,f=A.a.copy(h);if(a.x>=f.left&&a.x<=f.right&&a.y>=f.top&&a.y<=f.bottom){if(f.left+=o.x,f.top+=o.y,f.right+=o.x,f.bottom+=o.y,c.isGroup){var g=a.x-h.left,v=a.y-h.top,y=e.hitGroupShape(c,g,v,n),m=y.hitChild;if(y.hitTextbox||m)return!0}var _=r.beginOffset+n.line.range.pos+(l||0),x=c.shapeIdxPath,w=c.shape_tree_type;return n.shapeInfo={isHitOnShape:!0,gcp:_,id:u,rect:f,shape:c,shapeIdxPath:x,shapeTreeType:w,isEmbedding:!0,shapeData:p.shapeData},n.isWebshape=c&&c.isWebshape&&!O.isMacOs&&!O.isIos,n.webExtension=!O.isMacOs&&!O.isIos&&c&&c.webExtension,n.type=d.a.SHAPE,e.fireShapeHit(n,i),!0}}}},{key:"hitDrawing",value:function(t,n,i,a){var o=void 0;return n.type==d.a.TEXTBOX_PAGE&&(o=e.hitDrawingInTextbox(t,n,i,a)),o||(o=window.APP.isWebMode()?e.hitDrawingInMobilePage(t,n,i):e.hitDrawingInMainPage(t,n,i,a)),o}},{key:"hitGroupShape",value:function(t,n,i,a){var o=t.layoutRect,r=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.isCanvasShape&&n.push(t),t.childShapes.forEach((function(t){t.isGroup?e(t,n):n.push(t)})),n}(t).reverse();if(a.textbox){var s=r.indexOf(a.textbox);s>=0&&r.splice(s+1,r.length-s-1)}var l=window.APP.drawingTools,c=r.find((function(e){var t=e.innerBoundary,a=e.visualTransform2D,o=void 0===a?{rotation:0,horizontalFlipped:!1,verticalFlipped:!1}:a,r=e.drawingLayout.layoutRect,s=e.rect2TopShape;if(!s&&e.isTopShape){var c=e.rect;s={top:0,left:0,width:c.width,height:c.height}}var u=t?{x:s.left+t.left,y:s.top+t.top,width:t.width,height:t.height}:r,d=e.isRotateText&&e.hasEnterTextbox()?0:o.rotation;if(e.isPresetDrawing&&!e.isCanvasShape){if(n>=u.x&&n<u.x+u.width&&i>=u.y&&i<=u.y+u.height){if(d||o.horizontalFlipped||o.verticalFlipped){var h=new window.QMatrix;h.translate(s.width/2,s.height/2),(o.horizontalFlipped||o.verticalFlipped)&&h.scale(o.horizontalFlipped?-1:1,o.verticalFlipped?-1:1),h.rotate(-d),h.translate(-s.width/2,-s.height/2);var p=h.map_point(new window.Point(n-s.left,i-s.top));return l.hitTest(e.drawingLayout,new window.Point(p.x(),p.y()),5)}return l.hitTest(e.drawingLayout,new window.Point(n-s.left,i-s.top),5)}}else if(Object(D.a)({x:n,y:i},{left:s.left,top:s.top,width:s.width,height:s.height},d))return!0}));if(!c)return{hitGroup:!1};if(c===a.textbox)return{hitGroup:!0,hitTextbox:!0};var u=window.APP.data.selection.selShapes||[],h=[];if(u.forEach((function(e){e.isChildShape&&h.push(e.topShape)})),u.includes(t)||h.includes(t)){var p=window.APP.data.typoinfo.getLayoutPageCache(a.layoutIndex),f=A.a.getRectByRectAndOffset(o,{x:p.outer_rect.left,y:p.outer_rect.top}),g=c.drawingLayout.layoutRect;f.offset(g.x,g.y),f.updateBySize(g.width,g.height);var v=c.shapeIdxPath,y=c.shape_tree_type;return a.shapeInfo={id:c.id,isHitOnShape:!0,gcp:t.begin,shapeIdxPath:v,shapeTreeType:y,rect:f,shape:c,isEmbedding:!1,isInk:c.isInk},a.type=d.a.SHAPE,e.fireShapeHit(a,window.APP.data),{hitGroup:!0,hitChild:!0}}return{hitGroup:!0}}},{key:"hitDrawingInMainPage",value:function(t,n,i,o){var s=i.typoinfo.getLayoutPageCache(n.layoutIndex);if(!s.layers)return!1;var l=o?s.layers.getTopShapeCards():s.layers.getBottomShapeCards();if(s.decorativePage){var c=o?s.decorativePage.layers.getTopShapeCards():s.decorativePage.layers.getBottomShapeCards();l=[].concat(r()(l),r()(c))}var u=n.subDocType,h=a()({},n.layoutPos);if(void 0===u)console.log("不应该没点击的子文档类型"),u=f.MainText;else if(u===f.Footnote||u===f.Endnote){u=f.MainText;for(var p=n.line.parent;p&&(h.x+=p.rect.left,h.y+=p.rect.top,p.layoutType!==M.c.MainPage);)p=p.parent}if(o){var g=s.decorativePage&&s.decorativePage.layers;g&&g.childLayers&&g.childLayers.forEach((function(e){var t=e.getTopShapeCards();t.length&&(l=[].concat(r()(t),r()(l)))})),(g=s.layers)&&g.childLayers&&g.childLayers.forEach((function(e){var t=e.getTopShapeCards();t.length&&(l=[].concat(r()(t),r()(l)))}))}for(var v=window.APP.drawingTools,y=l.length-1;y>=0;--y){var m=l[y],_=m.id,x=m.subdoc_type,w=m.coor_pos2view,k=m.innerBoundary,b=m.layoutRect,T=k?A.a.initByOriginAndSize({x:m.rect.left+k.left,y:m.rect.top+k.top},{width:k.width,height:k.height}):A.a.initByRawRect(b),C=m.pos,S=!1;if(u==f.Textbox&&n.textbox.viewPage===m.viewPage&&(m.anchor.zorder>n.zorder||n.textbox&&n.textbox.topShape.isEmbedShape||m.isGroup&&n.textbox&&n.textbox.topShape===m)&&(S=!0),x===u||S){if(!o&&n.type===d.a.TABLE_TEXT){var E=n.tableInfos.cellPage.range;if(C<E.pos||C>=E.pos+E.len)continue}if(S&&(h.x=t.x-s.outer_rect.left,h.y=t.y-s.outer_rect.top),w&&(b=A.a.getRectByRectAndOffset(b,w),T=A.a.getRectByRectAndOffset(T,w)),h.x>=T.left-5&&h.x<=T.right+5&&h.y>=T.top-5&&h.y<=T.bottom+5){var P=m.isRotateText&&m.hasEnterTextbox()?0:m.rotation,L=h.x-m.rect.left-(w?w.x:0),I=h.y-m.rect.top-(w?w.y:0);if(m.isGroup){var R=e.hitGroupShape(m,L,I,n),O=R.hitGroup,N=R.hitChild;if(R.hitTextbox||N)return!0;if(!O)continue}else if(m.isPresetDrawing){if(0!==P||m.horizontalFlipped||m.verticalFlipped){var B=w?A.a.getRectByRectAndOffset(m.rect,w):m.rect,j=new window.QMatrix;j.translate(B.width/2,B.height/2),(m.horizontalFlipped||m.verticalFlipped)&&j.scale(m.horizontalFlipped?-1:1,m.verticalFlipped?-1:1),j.rotate(-P),j.translate(-B.width/2,-B.height/2);var F=j.map_point(new window.Point(h.x-B.left,h.y-B.top));L=F.x(),I=F.y()}if(!v.hitTest(m.drawingLayout,new window.Point(L,I),5))continue}else if(0!==P&&!Object(D.a)(h,w?A.a.getRectByRectAndOffset(m.rect,w):m.rect,P))continue;var H=m.begin;console.assert(void 0!==H);var G=A.a.getRectByRectAndOffset(b,{x:s.outer_rect.left,y:s.outer_rect.top});return n.shapeInfo={isHitOnShape:!0,gcp:H,id:_,rect:G,shape:m,isEmbedding:!1,isInk:m.isInk},n.type=d.a.SHAPE,e.fireShapeHit(n,i),!0}}}return!1}},{key:"hitDrawingInMobilePage",value:function(t,n,i){var a=n.line,o=a.viewPage,r=a.view,s=o.layers?o.layers.getShapeCards():[];if(!s||!s.length)return!1;var l=i.shapeManager._shapeRenderInfo;return s.some((function(a){var s=a.id,c=l[s],u=c.rect,h=c.isLoaded,p=c.sha1,f=c.coor,g=o.rect.left+f.x+r._viewOffset.x,v=o.rect.top+f.y+r._viewOffset.y,y=A.a.initByOriginAndSize({x:u.left+g,y:u.top+v},{width:u.width,height:u.height});if(t.x>=y.left&&t.x<=y.right&&t.y>=y.top&&t.y<=y.bottom){var m=a.anchor,_=m.pos,x=m.shapeData,w=i.shapeManager.getSourceUrl(a.shape_tree_type,s);return n.type=d.a.SHAPE,n.shapeInfo={gcp:_,id:s,src:w,shape:a,isLoaded:h,sha1:p,shapeData:x,shapeTreeType:R.d,rect:y,isHitOnShape:!0,isEmbedding:!1},e.fireShapeHit(n,i),!0}return!1}))}},{key:"hitDrawingInTextbox",value:function(t,n,i,a){var o=i.typoinfo.getLayoutPageCache(n.layoutIndex);if(!o.layers)return!1;var s=a?o.layers.getTopShapeCards():o.layers.getBottomShapeCards();if(o.decorativePage){var l=a?o.decorativePage.layers.getTopShapeCards():o.decorativePage.layers.getBottomShapeCards();s=[].concat(r()(s),r()(l))}var c=n.subDocType;void 0===c&&(console.log("不应该没点击的子文档类型"),c=f.Textbox);for(var u=n.layoutPos,h=s.length-1;h>=0;--h){var p=s[h],g=p.id,v=p.rect;if(p.subdoc_type===c&&(u.x>=v.left&&u.x<=v.right&&u.y>=v.top&&u.y<=v.bottom)){if(e.isHitOnTransparentPoint(i,s[h],n))continue;var y=s[h].textbox_page.range;if(!y)return console.log("不应该拿不到pageRg"),!1;var m=i.doc.anchors.getAnchorPos(g,y.pos,y.len);console.assert(void 0!==m);var _=A.a.getRectByRectAndOffset(v,{x:o.outer_rect.left,y:o.outer_rect.top});return n.shapeInfo={isHitOnShape:!0,gcp:m,id:g,rect:_,shape:s[h],isEmbedding:!1},n.type=d.a.SHAPE,e.fireShapeHit(n,i),!0}}return!1}},{key:"hitAnchors",value:function(t,n,i){var a=i.selection.selShapes;if(!a||a.length>1)return!1;var o=a[0],r=o instanceof h.a,s=p.u,l=2*s,c=o.viewRect,u=o.viewPage.outer_rect,f=O.isPad?p.u:0,g=s+f,v={left:c.left+u.left,top:c.top+u.top,right:c.right+u.left,bottom:c.bottom+u.top,width:c.width,height:c.height},y=o.isGroup?p.n:0,m=v.left-g-y,_=v.top-g-y,x=v.right-g+y,w=v.bottom-g+y,k=Math.round((m+x)/2),b=Math.round((_+w)/2),T=o.shapeData;if(T){var C=0===T.getShapeGroup()?[{x:m,y:_},null,null,null,{x:x,y:w},null,null,null]:[{x:m,y:_},{x:k,y:_},{x:x,y:_},{x:x,y:b},{x:x,y:w},{x:k,y:w},{x:m,y:w},{x:m,y:b}],S=o.adjustHandles,E=o.drawingLayout;if(S){var P=E.ratio||1;S.forEach((function(e){var t=m+e.x*P/635,n=_+e.y*P/635;C.push({x:t,y:n})}))}var L=function(e,t){var n=t.x,i=t.y,a=n+l+f,o=i+l+f;return!(e.x<n||e.x>a||e.y<i||e.y>o)},A={x:t.x-i.typoinfo.viewOffset.x,y:t.y-i.typoinfo.viewOffset.y},I=o.visualTransform2D,R=void 0===I?{rotation:0,horizontalFlipped:!1,verticalFlipped:!1}:I,M=o.isRotateText,D=o.hasEnterTextbox()&&M?0:R.rotation;if(D||R.horizontalFlipped||R.verticalFlipped){var j=new window.QMatrix;j.translate(k,b),D&&j.rotate(D),(R.horizontalFlipped||R.verticalFlipped)&&j.scale(R.horizontalFlipped?-1:1,R.verticalFlipped?-1:1),j.translate(-k,-b),C.forEach((function(e){if(e){var t=j.map_point(new window.Point(e.x,e.y));e.x=t.x(),e.y=t.y()}}))}for(var F=C.length-1;F>=0;--F)if(C[F]&&L(A,C[F])){if(n.shapeInfo={isHitOnShape:!0,gcp:o.topShape.pos,id:o.id,shape:o,rect:v,isEmbedding:r},n.type=N[F],F>=0&&F<8){var H=D;R.horizontalFlipped&&F%2==0&&(H=(H+90)%360),R.verticalFlipped&&F%2==0&&(H=(H+90)%360),F=Math.floor((F+(H+22)/45)%8),n.shapeResizeType=N[F]}return console.info("Hit on "+n.type),e.fireShapeHit(n,i),!0}if(o.isGroup){var G=!1,U=s+y;if(0===o.rotation)A.x>=m-s&&A.x<x+2*s&&A.y>=_-s&&A.y<w+2*s&&!(A.x>=m+U&&A.x<x-U&&A.y>=_+U&&A.y<w-U)&&(G=!0);else{var W=[{pt1:C[0],pt2:C[2]},{pt1:C[2],pt2:C[4]},{pt1:C[4],pt2:C[6]},{pt1:C[6],pt2:C[0]}],Y=Math.pow(s,2);W.some((function(e){var t=e.pt1,n=e.pt2;return G=function(e,t,n){var i=B(e,t),a=B(e,n),o=B(t,n);if(i>o&&a<o)return a;if(a>o&&i<o)return i;var r=(t.y-n.y)/(t.x-n.x),s=t.y-r*t.x,l=-r,c=e.y-l*e.x;return B({x:(c-s)/(r-l),y:(c-s)/(r-l)*r+s},e)}(A,t,n)<Y}))}if(G)return n.shapeInfo={isHitOnShape:!0,gcp:o.topShape.pos,id:o.id,shape:o,rect:v,isEmbedding:r},n.type=d.a.SHAPE,console.info("Hit on group shape border"),e.fireShapeHit(n,i),!0}return!1}}},{key:"isHitOnTransparentPoint",value:function(e,t,n){var i=e.shapeManager.shapeMap.getSha1(t.shape_tree_type,t.id);if(!i)return!1;var a=L.getInstance().getCachedCanvas(i);if(!a)return!1;var o=a.getContext("2d"),r=n.layoutPos.x-t.pic_rect.left,s=n.layoutPos.y-t.pic_rect.top;return 0===o.getImageData(r,s,1,1).data[3]}},{key:"fireShapeHit",value:function(e,t){var n=e.layoutIndex,i=e.shapeInfo,a=t.typoinfo.getLayoutPageCache(n).outer_rect,o={x:a.left,y:a.top},r={absolute_rect:A.a.addDeepOffset(i.rect,o),shapeInfo:i};I.default.dispatchEvent(I.default.shape.HIT_ON_SHAPE,r)}}]),e}();t.a=F},10857:function(e,t,n){"use strict";n.r(t);var i=n(13),a=n.n(i),o=n(8),r=n.n(o),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(22),h=n.n(d),p=n(145),f=n.n(p),g=n(23),v=n.n(g),y=n(7134),m=n(2495),_=n(167),x=n(3933),w=n(144),k=n.n(w),b=n(947),T=n(772),C=n(908),S=n(1232),E=n(1291),P=n(1733),L=n(411),A=n(309),I=n(310),R=n(336),O=function(){function e(){l()(this,e)}return u()(e,null,[{key:"_getHotSpots",value:function(e,t){var n=e.left,i=e.right,a=e.top,o=e.bottom,r={left:{key:"left",left:n,right:n+S.TABLE_HOTSPOT_UNIT.BORDER,top:a,bottom:o},right:{key:"right",left:i-S.TABLE_HOTSPOT_UNIT.BORDER,right:i,top:a,bottom:o},top:{key:"top",left:n,right:i,top:a,bottom:a+S.TABLE_HOTSPOT_UNIT.BORDER},bottom:{key:"bottom",left:n,right:i,top:o-S.TABLE_HOTSPOT_UNIT.BORDER,bottom:o}};return{borderHotSpots:r,paddingHotSpots:{left:{top:a,bottom:o,left:r.left.right,right:r.left.right+t.cellPage.rect.left-S.TABLE_HOTSPOT_UNIT.BORDER}},marginHotSpots:{left:{top:a,bottom:o,left:n-S.TABLE_HOTSPOT_UNIT.MARGIN,right:n}}}}},{key:"_isInHotSpot",value:function(e,t,n){return n&&e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}},{key:"_matchHotSpots",value:function(t,n,i,a,o){var r=n.x,s=n.y,l=i.left,c=i.right,u=i.top,d=i.bottom,h=a.borderHotSpots,p=a.paddingHotSpots,f=a.marginHotSpots,g=o.isCellInFirstTableLine,v=o.isHeaderRow,y=p.left,m=h.left,_=h.right,x=h.top,w=h.bottom,k=f.left,T=void 0,C=t;if(r>=l&&r<=c&&s>=u&&s<=d)switch(!0){case e._isInHotSpot(r,s,m):T=m,C=b.a.TABLE_COLUMN_RESIZE;break;case e._isInHotSpot(r,s,_):T=_,C=b.a.TABLE_COLUMN_RESIZE;break;case e._isInHotSpot(r,s,x):T=x,C=g||v?b.a.TABLE_COLUMN_SELECT:b.a.TABLE_ROW_RESIZE;break;case e._isInHotSpot(r,s,w):T=w,C=b.a.TABLE_ROW_RESIZE;break;case e._isInHotSpot(r,s,y):T=y,C=b.a.TABLE_CELL_SELECT}else e._isInHotSpot(r,s,k)?(T=k,C=b.a.TABLE_ROW_SELECT):C=b.a.TEXT;return{hitResultType:C,hotSpot:T}}},{key:"_getHitResultType",value:function(t,n,i){var a=n.rect.cellRect,o=n.cellPage,r=n.isCellInFirstTableLine,s=n.tableLine,l=e._getHotSpots(a,{cellPage:o});return e._matchHotSpots(i,t,a,l,{isCellInFirstTableLine:r,isHeaderRow:s&&s.isHeaderRow})}},{key:"_getColumnResizeInteractInfo",value:function(e,t){var n=t.pos,i=t.table,a=t.tableLine,o=t.tableCell,r=t.tableCells,s=t.tableProps,l=t.tableRange,c=t.rect,u=t.hotSpot,d=t.outerRect,h=c.tableRect,p=c.cellRect,f=window.APP.isWebMode(),g={};if(g.interactPosition=n,g.columnLineIndex=o.index,g.rowIndex=i.currentPageTableLines.findIndex((function(e){return e===a})),g.resizeHighlightLength=h.size.height,g.tableLineRange=a.range,"top"===u.key){var v=i.currentPageTableLines,y=v.findIndex((function(e){return e===a}))-1;if(~y){var m=v[y];g.tableLineRange=m.range}}var _=e.doc.getSubDocType(l.begin),x=e.typoinfo.tableLineRanges.mapInRange(l.begin,l.end,(function(e){return e._node.line}),I.IT.strictIntersectTest);_===A.HeaderFooter&&(x=x.filter((function(e){return e.viewPage===o.viewPage})));var w=s.find((function(e){return e.begin<=n&&e.end>n})),b=void 0;"right"===u.key?(g.columnLineIndex=o.index+1,b=o.rect.right):(0!==o.index&&(g.interactPosition=r[o.index-1].begin),b=o.rect.left);var T=w.prop.table_row.rgdxa[g.columnLineIndex],C=void 0,E=void 0,P={};s.forEach((function(e,t){var n=e.prop.table_row.rgdxa,i=n.indexOf(T);-1!==i&&(C=void 0!==n[i-1]?C?Math.max(n[i-1],C):n[i-1]:C,E=void 0!==n[i+1]?E?Math.min(n[i+1],E):n[i+1]:E),n.forEach((function(e,n){return P[e]=[t,n]}))})),delete P[T];var L=Object.keys(P).sort((function(e,t){return e-t})),O=void 0===C?L[0]:C,M=void 0===E?L[L.length-1]:E;for(var D in P)O<D&&D<M||delete P[D];switch(!0){case"right"!==u.key&&0===o.index:g.tcOffsetXRange={min:d.left-p.left,max:Object(R.Ti2Px)(E-T)-S.TABLE_COLUMN_MIN_WIDTH};break;case"right"===u.key&&o.index===r.length-1:g.tcOffsetXRange={min:Object(R.Ti2Px)(C-T)+S.TABLE_COLUMN_MIN_WIDTH,max:f?d.left+e.typoinfo.typoWidth-p.right:d.right-p.right};break;default:g.tcOffsetXRange={min:Object(R.Ti2Px)(C-T)+S.TABLE_COLUMN_MIN_WIDTH,max:Object(R.Ti2Px)(E-T)-S.TABLE_COLUMN_MIN_WIDTH}}for(var N in g.validTCOffsetXList=[],P){var B=k()(P[N],2),j=B[0],F=B[1],H=x[j]&&x[j].tablecells[F];H?g.validTCOffsetXList.push(H.rect.left-b):g.validTCOffsetXList.push(Object(R.Ti2Px)(N-T))}return g}},{key:"_getRowResizeInteractInfo",value:function(e,t){var n=t.table,i=t.tableLine,a=t.lastMergedTableLine,o=t.hotSpot,r=t.outerRect,s=window.APP.isWebMode(),l={};if(l.resizeHighlightLength=i.rect.size.width,"top"===o.key){var c=n.currentPageTableLines.findIndex((function(e){return e===i})),u=0===c,d=n.currentPageTableLines[u?0:c-1],h=d.rect;if(u)l.trOffsetYRange={min:0};else{var p=d.tablecells,f=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;p.some((function(e){var t=e.cell_page;if(!t||e.merge_type===T.e.FIRST)return!1;f=Math.min(f,t.rect.top),g=Math.max(g,t.rect.bottom)})),l.trOffsetYRange=f>g?{min:-h.size.height}:{min:g-f-h.size.height}}var v=s?C.a.transvertPositionFromNode2Target(d,d.viewPage):C.a.getPosition2view(d);l.rowRect={left:v.x+r.left,right:v.x+r.left+h.width,top:v.y+r.top,bottom:v.y+r.top+h.height},l.resizeHighlightLength=h.size.width,l.interactPosition=d.range.pos}else{var y=a||i,m=s?C.a.transvertPositionFromNode2Target(y,y.viewPage):C.a.getPosition2view(y),_=y.rect,x=y.tablecells,w=Number.MAX_SAFE_INTEGER,k=Number.MIN_SAFE_INTEGER;x.some((function(e){var t=e.cell_page;return!(!t||e.merge_type===T.e.FIRST)&&((!t.textflow||"TRANSPOSE"!=t.textflow.chardirect)&&(w=Math.min(w,t.rect.top),void(k=Math.max(k,t.rect.bottom))))})),l.trOffsetYRange=w>k?{min:-y.rect.height}:{min:k-w-y.rect.height},l.interactPosition=y.range.pos,l.rowRect={left:m.x+r.left,right:m.x+r.left+_.width,top:m.y+r.top,bottom:m.y+r.top+_.height}}return l}},{key:"_getInteractInfo",value:function(t,n){var i=n.data,o=n.pos,r=n.hitResultType,s=n.hotSpot,l=t.table,c=t.tableCell,u=t.tableLine,d=t.tableCells,h=t.tableProps,p=t.tableRange,f=t.lastMergedTableLine,g=t.rect,v=g.tableRect,y=g.outerRect,m=window.APP.isWebMode(),_={};switch(r){case b.a.TABLE_COLUMN_RESIZE:_=e._getColumnResizeInteractInfo(i,{pos:o,table:l,tableLine:u,tableCell:c,tableCells:d,tableProps:h,tableRange:p,rect:g,hotSpot:s,outerRect:y});break;case b.a.TABLE_ROW_RESIZE:_=e._getRowResizeInteractInfo(i,{pos:o,table:l,tableLine:u,lastMergedTableLine:f,hotSpot:s,outerRect:y})}return(_=a()({},t,_)).rect.rowRect=_.rowRect,_.tOffsetXRange={min:v.left-v.right,max:m?y.left+i.typoinfo.typoWidth-v.right:y.right-v.right-1},_}},{key:"_getTableElements",value:function(e){var t=e instanceof E.a?e.parent.parent:e.parent,n=t.parent,i=n.parent,a=i.tablecells;return{line:e,textPage:i.parent,cellPage:t,tableCell:n,tableCells:a,tableLine:i}}},{key:"_getTopLevelTableElements",value:function(e){var t={},n=e.line.viewPage;if(e.textPage.parent===n)return t=e;for(var i,a=e.textPage.parent,o=[];a&&!a.isScene();)o.push(a),a=(i=a).parent?i.parent:i.isScene()?i.outer.parent:null;for(var r=-1,s=0;s<o.length;++s)o[s].layoutType==L.DOCLayoutType.TableLine&&(r=s);if(-1==r)return t=e;var l=o[r];t.line=l;for(var c=o[0],u=0;c.layoutType!=L.DOCLayoutType.Cell&&u<r;)c=o[++u];t.tableCell=c,t.cellPage=c.cell_page||c.diagCell&&c.diagCell.pages[0],t.tableLine=l,t.tableCells=l.tablecells;for(var d=o[r+(u=1)];d.layoutType!=L.DOCLayoutType.MainPage&&d.layoutType!=L.DOCLayoutType.TextPage&&u<o.length;)d=o[r+ ++u];return t.textPage=d,t}},{key:"_getTable",value:function(e){var t=e.data,n=e.range,i=e.textPage,a=e.layer,o=void 0===a?1:a,r=e.layoutIndex,s=e.outerRect,l={wholeTableLines:[],currentPageTableLines:[],currentPageTableRect:{},currentPageIndex:r,currentTextPage:i,isBeginPartOfTable:!1,isEndPartOfTable:!1},c=t.typoinfo.tableLineRanges,u=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,h=window.APP.isWebMode(),p=window.APP.data.selection.selContext;if(c.forEachHintInRange(n.begin,n.end,(function(e){var t=e&&e._node&&e._node.line;if(t&&(t.layer||t.papx)&&(t.layer||t.papx.getProp("nest_level").val||1)===o){l.wholeTableLines.push(t);var n=t.viewPage.layout_index,a=t.parent;h?t.viewPage.svgNode&&l.currentPageTableLines.push(t):n===r&&a===i&&l.currentPageTableLines.push(t),u=Math.min(u,n),d=Math.max(d,n)}}),I.IT.strictIntersectTest),l.isBeginPartOfTable=r===u&&i.range.pos<=n.begin,l.isEndPartOfTable=r===d&&i.range.pos+i.range.len>=n.end,p&&p.isInHeaderFooter&&(l.isEndPartOfTable=!0),h&&d>r){var f=t.typoinfo.layout_pages[d];if(f.svgNode){var g=f.page&&f.page.range;g&&g.pos+g.len>=n.end&&(l.isEndPartOfTable=!0)}}var v=l.currentPageTableRect;return(h?l.wholeTableLines:l.currentPageTableLines).forEach((function(e){var t=e.rect.size,n=t.width,i=t.height,a=C.a.getPosition2view(e),o=a.x,r=o+n,s=a.y,l=s+i;v.left=isNaN(v.left)?o:Math.min(v.left,o),v.right=isNaN(v.right)?r:Math.max(v.right,r),v.top=isNaN(v.top)?s:Math.min(v.top,s),v.bottom=isNaN(v.bottom)?l:Math.max(v.bottom,l)})),window.APP.isPCMode()&&(v.left+=s.left,v.right+=s.left,v.top+=s.top,v.bottom+=s.top),v.size={width:v.right-v.left,height:v.bottom-v.top},l}},{key:"_getTableInfos",value:function(t,n){var i=n.line;if(i.host.host.isTextFrame){var o=i.getWholePath(),r=o.length>1&&o[o.length-2]||[],s=r.length;if(s>0&&r[0].isTextFrame||r[s-2]&&r[s-2].isInTable)return void(n.type=b.a.TEXT)}var l=e._getTopLevelTableElements(e._getTableElements(i)),c=l.tableCell,u=l.tableLine,d=l.textPage,h=Object(P.collectTable)(t.doc,n.position,1);if(!h)return null;var p=h.tapxs,f=h.range,g=u.viewPage,v=u.view,y=g.outer_rect,m=g.layout_index,_=e._getTable({data:t,range:f,textPage:d,layer:1,layoutIndex:m,outerRect:y});if(0===_.wholeTableLines.length)return null;var x={outerRect:y,tableRect:_.currentPageTableRect,viewOffset:v.viewOffset},w=window.APP.isWebMode(),S=y.left,E=y.top,L=c.rect,A=w?C.a.transvertPositionFromNode2Target(c,g):C.a.getPosition2view(c),I=A.x,R=A.y,O=L.height;if(c.merge_type===T.e.FIRST){var M=d.lines,D=M.findIndex((function(e){return e===u}));if(~D)for(var N=!1,B=function(e,t){var n=M[e],i=n.tablecells;if(N)return"break";i.some((function(e){var t=e.rect;if(!(Math.floor(t.right)<=Math.floor(L.left)||Math.floor(t.left)>=Math.floor(L.right)))return e.merge_type===T.e.LAST&&(N=!0),O+=t.height,l.lastMergedTableLine=n,!0}))},j=D+1,F=M.length;j<F;j++){if("break"===B(j))break}}x.cellRect={left:I+S,right:I+S+L.width,top:R+E,bottom:R+E+O,width:L.width,height:O};var H=(w?_.wholeTableLines:_.currentPageTableLines).reduce((function(e,t,n){var i=t.rect,o=k()(t.tablecells,1)[0],r=t.viewPage,s=i.width,l=i.height,c=w?C.a.transvertPositionFromNode2Target(t,r):C.a.getPosition2view(t),d=c.x,h=c.y,p=r.outer_rect,f=p.left,g=p.top,v={left:d+f,right:d+f+s,top:h+g,bottom:h+g+l,width:s,height:l};if(o.merge_type===T.e.MIDDLE||o.merge_type===T.e.LAST){var y=e[e.length-1];y?(y.right=Math.max(y.right,v.right),y.bottom+=v.height,y.height+=v.height):e.push(v)}else e.push(v);return u===t&&(x.tableLineRect=a()({},v)),e}),[]),G=!1,U=_.wholeTableLines[0].tablecells.map((function(e){var t=e.viewPage.outer_rect,n=t.left,i=t.top,a=e.rect,o=a.width,r=a.height,s=w?C.a.transvertPositionFromNode2Target(e,e.viewPage):C.a.getPosition2view(e),c=s.x,u=s.y;return e===l.tableCell&&(G=!0),{left:c+n,right:c+n+o,top:u+i,bottom:u+i+r,width:o,height:r}}));return x.columnRects=U,x.rowRects=H,a()({},l,{table:_,tableRange:f,tableProps:p,isCellInFirstTableLine:G,rect:x,isBeginPartOfTable:_.isBeginPartOfTable,isEndPartOfTable:_.isEndPartOfTable})}},{key:"hit",value:function(t,n,i,a){if(a){var o=a.line,r=window.APP.isWebMode();a.pos=i,a.isInTable=!1;var s=a.type===b.a.HYPERLINK,l=a.type===b.a.TASK_LIST;if(s)n.selection.selInfo.getSelectionInfo().wholeCellSelected&&(s=!1);if(o.isInTable){var c=e._getTableInfos(n,a);if(!c)return;var u=i;r&&(u={x:u.x-c.rect.viewOffset.x,y:u.y-c.rect.viewOffset.y});var d=s?b.a.TABLE_HYPERLINK:b.a.TABLE_TEXT,h=e._getHitResultType(u,c,d),p=h.hitResultType,f=h.hotSpot;if(p===b.a.TEXT)return;c=e._getInteractInfo(c,{data:n,pos:a.position,hitResultType:p,hotSpot:f}),a.type=l?b.a.TASK_LIST:p,a.hotSpot=f,a.isInTable=!0,a.tableInfos=c}}}}]),e}(),M=n(2939),D=n(1285);function N(e,t){for(var n=0,i=t.length-1;n<=i;){var a=n+i>>1,o=t[a];if(e<o.beginOffset)i=a-1;else{if(!(e>=o.endOffset))return o.offsetX;n=a+1}}return 0}var B,j=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(e,t,n,i){if(window.APP.isCooperationMode){if(i){var a=t.typoinfo,o=i.line,r=i.halfOfRight?i.position-1:i.position;i.type=i.type||b.a.TEXT,i.isInCoopSel=!1;var s=void 0;r>-1&&(s=t.doc.getDataLogic("final").getChpx(r).prop);var l=s&&s.getPropVal("wo_user_id");if(l){var c=M.a.coopInfos.find((function(e){return e.tagid==l}));if(c&&c.userid!==window.APP.info.userid)try{var u=c.username,d=void 0===u?"":u,h=c.color,p=t.doc.getUserRelativeRanges(r),f=t.doc.getSubDocType(p.begin);if(-1===f)return;var g=p.end-1,v=t.selection.selContext.isInHeaderFooter;if(f===A.MainText){var y=a.layout_pages[a.pageCount-1],m=y.range||y.page.range,_={begin:0,end:m.pos+m.len};g=Math.min(g,_.end-1),p.end>_.end&&(g=_.end-1)}else if(f===A.HeaderFooter||f===A.TextboxInHF){t.selection.selContext.setInHeaderFooterPurely(!0);var x=t.doc.getSubDocRange(f);g>=x.pos+x.len-1&&(g=x.pos+x.len-2)}else{if(f!==A.Textbox)return;var w=t.doc.getSubDocRange(f);g>=w.pos+w.len-1&&(g=w.pos+w.len-2)}var k=D.b.locate(t,g,!1,t.typoinfo);t.selection.selContext.setInHeaderFooterPurely(v),o=k.line;var T=Math.max(p.begin,o.range.pos),S=window.APP.isPCMode()?C.a.getPosition2view(o):C.a.transvertPositionFromNode2Target(o,o.viewPage),E=o.viewPage.outer_rect,P=window.APP.isWebMode()?t.typoinfo.viewOffset.x:0,L={x:N(T-o.range.pos,o.glyphGroupInfos)+S.x+E.left+P,y:S.y+o.rect.size.height+E.top};i.pos2layoutpage=L,i.color=h,i.username=d,i.isInCoopSel=!i.isFuzzyHit,i.isFuzzyHit||(i.type===b.a.SHAPE?i.type=b.a.COOPER_SELECTION_SHAPE:i.type!==b.a.HYPERLINK&&(i.type=b.a.COOPER_SELECTION))}catch(e){console.error("Hover Hit Error:",e)}}}}else i.type=i.type||b.a.TEXT}}]),e}(),F=n(10028),H=n(5747),G=n(1252),U=function(){function e(){l()(this,e)}return u()(e,null,[{key:"getTextpage",value:function(e){for(var t=e;t&&t.layoutType!==G.c.TextPage&&t.layoutType!==G.c.MainPage&&t.layoutType!==G.c.CellPage;)t=t.parent;return t}},{key:"splitRectIntoPoints",value:function(e){var t=e.left,n=e.right,i=e.top,a=e.bottom;return[{x:t-=.5,y:i-=.5},{x:n+=.5,y:i},{x:n,y:a+=.5},{x:t,y:a}]}},{key:"collectPointsFromRects",value:function(t){for(var n=t.length,i=new Array(4*n+1),a=0;a<n;a++){var o=e.splitRectIntoPoints(t[a]);0===a&&(i[0]=o[0]),i[2*a+1]=o[1],i[2*a+2]=o[2],i[4*n-2*a-1]=o[3],i[4*n-2*a]=o[0]}return[i]}},{key:"getRect",value:function(t,n){var i=t.viewPage.outer_rect,a=n?C.a.getPosition2view(t):C.a.transvertPositionFromNode2Target(t,t.viewPage),o=a.x,r=a.y,s=e.getTextpage(t),l=void 0,c=void 0,u=void 0,d=void 0;return"L2R"===s.textflow.corX&&(l=Math.ceil(o-(t.before_indent||0)),c=Math.ceil(o+t.rect.width),u=Math.ceil(r),d=Math.ceil(u+t.rect.height)),"R2L"===s.textflow.corX&&(c=Math.ceil(i.width-o-(t.before_indent||0)),l=Math.ceil(c-t.rect.width),u=Math.ceil(r),d=Math.ceil(u+t.rect.height)),"R2L"===s.textflow.corY&&(u=Math.ceil(o-(t.before_indent||0)),d=Math.ceil(o+t.rect.width),l=Math.ceil(i.width-r),c=Math.ceil(i.width-r+t.rect.height)),"L2R"===s.textflow.corY&&(u=Math.ceil(o-(t.before_indent||0)),d=Math.ceil(o+t.rect.width),l=Math.ceil(r-t.rect.height),c=Math.ceil(r)),{innerLeft:l,innerRight:c,innerTop:u,innerBottom:d,left:Math.ceil(l+i.left),right:Math.ceil(c+i.left),top:Math.ceil(u+i.top),bottom:Math.ceil(d+i.top)}}},{key:"collectCatalogBlock",value:function(t){var n=t.range,i=t.data,o=t.options,r=n.pos,s=n.len,l=window.APP.isPCMode(),c=[];i.typoinfo.textLineRanges.forEachHintInRange(r,r+s,(function(t){var n=t._node.line;n.isInTable&&r<n.parent.range.pos&&(n=n.parent.parent.parent);var i=n.viewPage.layout_index,a=e.getRect(n,l),o=a.innerLeft,s=a.innerRight,u=a.innerTop,d=a.innerBottom,h=a.left,p=a.right,f=a.top,g=a.bottom;c[i]=c[i]||new Map;var v=e.getTextpage(n);c[i].has(v)||c[i].set(v,[]),c[i].get(v).push({left:h,right:p,top:f,bottom:g,innerLeft:o,innerRight:s,innerTop:u,innerBottom:d})}),I.IT.strictIntersectTest);var u={},d={},h={left:Number.MAX_SAFE_INTEGER,right:Number.MIN_SAFE_INTEGER,top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER};return Object.keys(c).forEach((function(t){for(var n=c[t].entries(),i=n.next(),r=function(){var r=i.value[0],s=i.value[1],l=a()({},h),c=a()({},h);s.forEach((function(e){l.left=Math.min(l.left,e.left),l.right=Math.max(l.right,e.right),l.top=Math.min(l.top,e.top),l.bottom=Math.max(l.bottom,e.bottom),c.left=Math.min(c.left,e.innerLeft),c.right=Math.max(c.right,e.innerRight),c.top=Math.min(c.top,e.innerTop),c.bottom=Math.max(c.bottom,e.innerBottom)}));var p=o.horizontalPadding,f=o.verticalPadding;l.left-=p,l.right+=p,l.top-=f,l.bottom+=f,l.size={width:l.right-l.left,height:l.bottom-l.top},u[t]=u[t]||new Map,u[t].has(r)||u[t].set(r,l),c.left-=p,c.right+=p,c.top-=f,c.bottom+=f,c.size=l.size,d[t]=d[t]||new Map,d[t].set(r,e.collectPointsFromRects([c])),i=n.next()};!i.done;)r()})),{rects:u,pointsMap:d}}},{key:"getData",value:function(t,n,i){var o={pos:n.pos,len:n.len},r=e.collectCatalogBlock({range:o,options:{horizontalPadding:1,verticalPadding:0},data:t});i.push(a()({},n,r))}},{key:"hit",value:function(t,n,i,a){if(a){var o=e.getCatalogs(n,a);if(!o)return!1;var r=a.catalogInfos=[];o.forEach((function(t){e.getData(n,t,r)}))}}},{key:"getCatalogs",value:function(t,n){var i=n.isInTextbox;if(n.subDocType===A.HeaderFooter||i)return!1;var a=e.getCatalogCtrls(t,n);return a.length<1&&(a=e.getCatalogFields(t,n)),!(a.length<1)&&a}},{key:"getCatalogFields",value:function(e,t){var n=t.position,i=t.isFuzzyHit,a=[];return e.doc.fields.getFields({begin:n,end:n}).some((function(e){if("TOC"===e._node.type&&!i){var t=e._node,n={pos:t.pos,len:t.len,begin:t.begin,end:t.end,data:e._node.data,isInContentControl:!1};return a.push(n),!0}})),a}},{key:"getCatalogCtrls",value:function(e,t){var n=t.position,i=t.isFuzzyHit,a=[],o=e.doc.contentControls.collect(n,1)||[],r=t.line&&t.line.glyphGroupInfos;return r&&r.length&&(o=o.filter((function(e){if(e.begin<t.line.range.begin||e.begin>=t.line.range.end)return!0;var n=e.begin-t.line.range.begin,i=r.find((function(e){return e.beginOffset<=n&&n<e.endOffset}));return!i||!i.isRevisionHidden()}))),o.length?(o.sort((function(e,t){return e.len-t.len})),o.forEach((function(e){if(e.isCatalog&&!i){var t=e.pos,n=e.len,o={pos:t,len:n,begin:t,end:t+n,data:e.data,isInContentControl:!0};a.push(o)}})),a):a}}]),e}(),W=n(4813),Y=n(4745),z=n(7375),X=n(400),V=n(1032),q=n(2503),K=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(e,t,n,i){if(i){var a=i.innerPos,o=i.line,r=o.auto_num;if(r){for(var s=o.rect,l=o.baseline,c=o.parent,u=o.sublines,d=o.papx||u&&u[0].papx,h=c;h&&!(h instanceof V.d);)h=h.parent;var p=h.textflow.corX,f=d&&d.vertical_align_mode||("T2B"===p||"B2T"===p?q.middle:q.alphabetic),g=r.line.rect,v=z.a.getImageSize(),y=o.auto_num_pos.x,m=void 0;switch(f){case q.top:m=l-1;break;case q.middle:m=l-v.height/2-1;break;case q.bottom:m=l-v.height-1;break;default:m=l-v.height}var _={};_.right=y+g.size.width,_.left=y,_.top=g.top+s.top+m,_.bottom=_.top+v.height,X.a.pointInRect(a,_)&&(i.taskListInfo=r.getTaskOrBulletListInfo(),i.taskListInfo&&i.taskListInfo.isTaskList&&(i.type=b.a.TASK_LIST))}}}}]),e}(),Q=n(6744),J=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(e,t,n,i,a){if(a){var o=void 0;a.touches&&a.touches.length?o=a.touches[0]:a.changedTouches&&a.changedTouches.length?o=a.changedTouches[0]:isNaN(a.pageX)||isNaN(a.pageY)||(o={pageX:a.pageX,pageY:a.pageY});var r=e.workspace.element.cacheDOMAttr,s=r.clientWidth,l=r.clientHeight,c=r.rect.y;(o.pageX>=s||o.pageY-c>=l)&&(i.type=b.a.SCROLLBAR)}}}]),e}(),Z=n(30),$=n.n(Z),ee=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(e,t,n,i){if(i){var a=i.glyphGroupInfo;if(!a)return;var o=a.chpx,r=a.beginOffset+i.line.range.pos;if(i.isHitOnBox){i.type=b.a.TICKCHAR,i.tickCharInfo={},i.tickCharInfo.isInTickChar=!0,i.tickCharInfo.gcp=r;var s=void 0;if(i.isTickCharSymbol)s=o&&o.getPropVal("symbol_char"),i.tickCharInfo.isTextSymbol=!0;else s=t.doc.textStream.getText(r,1).charCodeAt(0),i.tickCharInfo.isTextSymbol=!1;i.tickCharInfo.uCode=s}}}}]),e}();ee.tickCharTypeMap=(B={},$()(B,"£",b.a.TICKCHAR_TICK),$()(B,"R",b.a.TICKCHAR_UNTICK),B);var te=ee,ne=n(7215),ie=function(){function e(){l()(this,e)}return u()(e,null,[{key:"hit",value:function(e,t,n,i,a){i.pos=n,void 0===i.type&&(i.type=x.b.TEXT),t.selection.selContext.isInComment()||(K.hit(e,t,n,i),O.hit(e,t,n,i),H.a.hit(e,t,n,i),U.hit(e,t,n,i),F.a.hit(e,t,n,i),j.hit(e,t,n,i),_.isPad&&Q.a.hit(e,t,n,i,a),J.hit(e,t,n,i,a),te.hit(e,t,n,i,a))}},{key:"hitHeaderFooterInfo",value:function(e,t){if(window.APP.isWebMode())return!1;for(var n=0,i=null;n<t.typoinfo.pageCount;++n){var a=t.typoinfo.getLayoutPageCache(n);if((i=W.a.hit(e,a)).where!==Y.a.None)break}var o=i,r=o.where,s=o.layout;return r!==Y.a.None&&{isInFooter:r===Y.a.Hit_On_Footer,layout:s,layoutIndex:n}}},{key:"hitInSpecific",value:function(e){var t=e.type,n=e.app,i=e.data,a=e.pos,o=e.hitResult;e.event;switch(t){case ne.a.CONTENT_CONTROLS:H.a.hit(n,i,a,o);break;case ne.a.TABLE:O.hit(n,i,a,o)}return o}}]),e}(),ae=n(812),oe=n(1477),re=n(677),se=n(6745),le=n(874),ce=n(260),ue=n(547),de=n(805),he=1,pe=-1,fe=0,ge=function(e,t,n){var i=Object(de.bSearchUpperBound)(t,0,t.length,e,(function(e,t,n){return t[e].range.pos>=n.range.pos}));if(~i)return n?i++:i--,t[i]},ve=function(e,t){var n=e.parent,i=n.parent,a=i.layoutType!==L.DOCLayoutType.MobilePage?i.mainpages:[n],o=i.parent,r=o&&o.layout_pages,s=n.lines,l=void 0;if(e.parent.parent.layoutType==L.DOCLayoutType.SnippetScene){var c=e.parent;if(!(l=ge(e,c.lines,t)))if(t){var u=c.next;u&&(l=u.lines[0])}else{var d=c.prev;d&&(l=d.lines[d.lines.length-1])}return l}return(l=ge(e,s,t))?(l.isSnippetLine&&(l=ye(l,t)),l):n.footer_type?void 0:(l=function(e,t,n){var i=Object(de.bSearchUpperBound)(t,0,t.length,e,(function(e,t,n){return t[e].range.pos>=n.range.pos})),a=void 0;if(~i&&(n?(i++,a=0):a=t[--i]&&t[i].lines.length-1,t[i]))return t[i].lines[a]}(n,a,t))||(l=function(e,t,n){var i=Object(de.bSearchUpperBound)(t,0,t.length,e,(function(e,t,n){return t[e].layout_index>=n.layout_index})),a=e.layoutType===L.DOCLayoutType.MobilePage,o=void 0,r=void 0;if(~i){if(n){if(i++,!a)for(;i[i]&&!t[i].mainpages.length;)i++;o=0,r=0}else if(i--,a)o=0,r=t[i]&&t[i].page.lines.length-1;else{for(;t[i]&&!t[i].mainpages.length;)i--;o=t[i]&&t[i].mainpages.length-1,r=t[i]&&t[i].mainpages[o].lines.length-1}if(t[i])return a?t[i].page.lines[r]:t[i].mainpages[o].lines[r]}}(i,r,t))?(l.isSnippetLine&&(l=ye(l,t)),l):void 0},ye=function(e,t){var n=e.viewPage,i=e;return n.shapes&&n.shapes.textframes&&n.shapes.textframes.forEach((function(n){if(n.snippetLine===e){var a=n.snippetPack.lines;i=t?a[0]:a[a.length-1]}})),i},me=function(e,t,n){var i=e,a=!1,o=void 0,r=void 0;do{switch(i&&n(i),r=t(i,o),o&&o!=r&&(a=!0,i=e),o=r,r){case pe:i=ve(i,!1);continue;case he:i=ve(i,!0);continue}}while((i||!a)&&r!==fe)},_e=n(2011);function xe(e,t,n){return e.pos>=n||e.len&&e.pos+e.len===t||e.pos+e.len<t}function we(e,t,n,i,o){var s=o.ranges,l=o.cellSelected,c=o.columnSelected,u=t.wholeTableLines,d=t.currentPageIndex,h=t.currentTextPage,p=u[0].tablecells.map((function(e){return e.rect})),f=n.map((function(e){return a()({},e,{isActive:!1})})),g=i.map((function(e){return a()({},e,{isActive:!1})})),v={left:Number.MAX_SAFE_INTEGER,right:Number.MIN_SAFE_INTEGER,top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER},y=window.APP.isWebMode(),m=ke(e.app.data.selection,t,!1),_=ke(e.app.data.selection,t,!0);[].concat(r()(s)).sort((function(e,t){return e.pos-t.pos})).forEach((function(e,t){var n=-1,i=0,a=void 0;u.forEach((function(o){var r=xe(e,o.range.begin,o.range.end),l=!y&&(d!==o.viewPage.layout_index||h!==o.parent),u=o.tablecells,p=k()(u,1)[0];if(-1!==n&&p.merge_type&&p.merge_type!==T.e.FIRST||l||n++,t===s.length-1){var g=u.find((function(t){return t.range&&t.range.pos===e.pos}));!a&&g&&g.merge_type===T.e.FIRST&&(a=g)}if(!l){var _=a&&(a.merge_type===T.e.MIDDLE||a.merge_type===T.e.LAST);r&&!_||(a&&(a=a.nextMergedCell),v.top=Math.min(v.top,i),v.bottom=Math.max(v.bottom,i+o.rect.height),f[n]&&(f[n].isActive=c||m.includes(n))),i+=o.rect.height}r||u.forEach((function(t){var n=t.range;n&&!xe(e,n.pos,n.pos+n.len)&&(v.left=Math.min(Math.floor(t.rect.left),v.left),v.right=Math.max(Math.floor(t.rect.right),v.right))}))}))})),p.forEach((function(e,t){g[t].isActive=c?_.includes(t):!(v.left>=Math.floor(e.right)||v.right<=Math.floor(e.left))}));var x={rowRects:f,columnRects:g.sort((function(e,t){return e.left-t.left}))};if(l){var w=t.currentPageTableRect,b=w.left,C=w.top,S=e.config.zoom,E=e.getZoomDiff()-(y?e.horizontalCenterOffset:0);v.left=(v.left+b)*S+E,v.right=(v.right+b)*S+E,v.top=(v.top+C)*S,v.bottom=(v.bottom+C)*S,x.activeTableAreaRect=v}return x}var ke=function(e,t,n){var i=e.getNormalRanges(),a=t.wholeTableLines,o=t.currentPageIndex,r=t.currentTextPage,s=window.APP.isWebMode(),l=[];if(n){var c=a[0].tablecells;i.forEach((function(e){c.forEach((function(t,n){var i=t.cell_page&&t.cell_page.range;i&&!xe(e,i.pos,i.pos+i.len)&&-1===l.indexOf(n)&&l.push(n)}))}))}else i.forEach((function(e){var t=-1;a.forEach((function(n){var i=xe(e,n.range.begin,n.range.end),a=!s&&(o!==n.viewPage.layout_index||r!==n.parent),c=n.tablecells,u=k()(c,1)[0];-1!==t&&u.merge_type&&u.merge_type!==T.e.FIRST||a||t++,a||i||-1===l.indexOf(t)&&l.push(t)}))}));return l.sort((function(e,t){return e-t}))},be=function(e){for(var t=e.rect.left,n=e.rect.right,i=e.parent,a=i.parent.lines,o=e,r=a.indexOf(i)+1,s=a.length;r<s;++r){var l=a[r];if(!(l instanceof _e.a))break;for(var c=l.tablecells,u=!1,d=0,h=c.length;d<h;++d){var p=c[d];if(!(p.rect.right<=t||p.rect.left>=n)&&(p.merge_type&&p.merge_type!==T.e.NONE)){p.merge_type===T.e.LAST&&(u=!0),o=p;break}}if(u)break}return o},Te=function(e,t){var n=e.rect,i=n.top,a=n.left,o=n.height;if(i+=t.rect.top,a+=t.rect.left,e.merge_type===T.e.FIRST){var r=be(e);if(r&&r.parent)o=r.parent.rect.bottom-t.rect.top}return{top:i,left:a,width:e.rect.width,height:o}},Ce=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.wholeTableLines,a=t.currentPageIndex,o=t.currentTextPage,r=window.APP.isWebMode(),s=null;return i.some((function(t){var i=xe(e,t.range.begin,t.range.end),l=!r&&(a!==t.viewPage.layout_index||o!==t.parent);if(!(n&&l||i))return s=t,!0})),s},Se=function(e,t){var n=t>e,i=n?[e,t]:[t,e],a=k()(i,2),o=a[0],r=a[1],s=Array.from(new Array(r+1).keys()).slice(o);return n?s:s.reverse()},Ee=n(1320),Pe=n(822),Le=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a._onMouseUpOutside=a._onMouseUpOutside.bind(a),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"resetState",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resetState",this).call(this),this.selection.clearCache(),this.workspace.scrollerHelper&&this.workspace.scrollerHelper.clear()}},{key:"_calcContextState",value:function(e){var t=e.type,n=e.tableInfos,i=e.position,o=e.hotSpot,r=n.rect,s=n.columnLineIndex,l=n.interactPosition,c=n.rowIndex,u=n.tOffsetXRange,d=n.tcOffsetXRange,h=n.validTCOffsetXList,p=n.trOffsetYRange,f=n.table,g=n.tableRange,v=r.tableRect,y=r.cellRect,m=r.rowRect,_=r.columnRects,x=r.rowRects,w=this.workspace.config.zoom,k={width:this.data.typoinfo.width,height:this.data.typoinfo.height*this.workspace.config.zoom},b={left:v.left,top:v.top,width:v.size.width,height:v.size.height},T=this.app.isWebMode()?{top:0,bottom:k.height,left:0,right:this.data.typoinfo.width*w}:r.outerRect,C=this.selection.getNormalRange(),S=g&&C.pos>=g.begin&&C.pos+C.len<=g.end;this.state=a()({},this.state,{type:t,table:f,hotSpot:o,columnLineIndex:s,rowIndex:c,rowRect:m,outerRect:k,layoutRect:T,cellRect:y,tableRect:v,operationBoxPos:b,columnRects:_,rowRects:x,tOffsetXRange:u,tcOffsetXRange:d,trOffsetYRange:p,validTCOffsetXList:h,position:isNaN(l)?i:l,size:v.size,isSelInTable:S})}},{key:"beginResizing",value:function(e){var t=e.hitResult;e.detail;if(this.state.uilState=re.a.BLOCK,this.state.isResizing=!0,this.manager.startOperation("resizeTable"),t){this._calcContextState(t);var n=void 0,i=void 0,o=void 0,r=void 0,s=this.state,l=s.type,c=s.hotSpot,u=s.tableRect,d=s.rowRect,h=s.operationBoxPos,p=s.rowRects,f=s.columnRects,g=s.table,v=s.isSelInTable,y=s.tOffsetXRange,m=s.tcOffsetXRange,_=s.trOffsetYRange,x=s.validTCOffsetXList,w=s.outerRect,k=s.layoutRect,T=s.size,C=this.app.isWebMode()?this.workspace.config.zoom:1,E=c.key;switch(l){case b.a.TABLE_COLUMN_RESIZE:this.state.resizeType=i=S.TABLE_HIGHLIGHT_TYPE.COLUMN,n={left:c[E]||c.left,top:u.top},o=T.height,r=(k.bottom-k.top)/C,this.workspace.toggleContainerPointerStyle(ue.cursorTypes.col_resize);break;case b.a.TABLE_ROW_RESIZE:this.state.resizeType=i=S.TABLE_HIGHLIGHT_TYPE.ROW,n={left:d.left,top:c[E]},o=d.right-d.left,r=(k.right-k.left)/C,this.workspace.toggleContainerPointerStyle(ue.cursorTypes.row_resize)}var P=this.selection.selInfo.getSelectionInfo()||{},L=P.columnSelected,A=void 0!==L&&L,I=P.rowSelected,R=void 0!==I&&I,O=P.tableSelected,M=void 0!==O&&O,D=P.wholeCellSelected,N=void 0!==D&&D,B={ranges:this.selection.getNormalRanges(),rowSelected:R,columnSelected:A,tableSelected:M,cellSelected:N||R||A},j=we(this.workspace,g,p,f,B);this.workspace.tableFloatMenus.update(a()({},j,{isSelInTable:v,operationBoxPos:h,outerRect:w,size:T,tOffsetXRange:y,tcOffsetXRange:m,trOffsetYRange:_,validTCOffsetXList:x,isResizeLine:!0,showOperationBox:!0,highlightState:{showResizeHighlight:!1,resizeHighlightPos:n,resizeHighlightType:i,resizeHighlightLength:o,positionHighlightLength:r},selContext:B}),!0)}}},{key:"endResizing",value:function(e,t){var n=this;this.state.isResizing=!1,this.manager.finishOperation("resizeTable");var i=e.offsetX,a=e.offsetY,o=!1;switch(this.state.resizeType){case S.TABLE_HIGHLIGHT_TYPE.COLUMN:if(i){var r=this.state,s=r.position,l=r.columnLineIndex,c=r.rowIndex;this.manager.editHandler.adjustColumn(s,c,l,i),o=!0}break;case S.TABLE_HIGHLIGHT_TYPE.ROW:var u=this.state.rowRect||this.state.cellRect;if(a){var d=u.bottom-u.top+a;this.manager.editHandler.adjustRow(this.state.position,d),o=!0}}o&&setTimeout((function(){n.workspace.focusWithoutScroll()}),100)}},{key:"_getFirstTableLine",value:function(e){var t=e,n=e.parent,i=n.lines,a=void 0,o=void 0;if(this.isWebTypoMode)return i[i.length-1];var r=i.indexOf(e);if(~r){for(var s=r-1;s>=0;s--){if(i[s].layoutType!==L.DOCLayoutType.TableLine){if(s>0)return t;break}t=i[s]}if(e.host.layoutType===L.DOCLayoutType.SnippetScene){var l=n;do{(l=l.prev)&&l.lines&&(t=l.lines[0])}while(l)}else if(o=(a=n.parent).layoutType===L.DOCLayoutType.Cell?null:a.parent.layout_pages)for(var c=o.indexOf(a)-1;c>=0;c--)for(var u=o[c].mainpages,d=u.length-1;d>=0;d--){var h=u[d];if(h)for(var p=h.lines,f=p.length-1;f>=0&&p[f].layoutType===L.DOCLayoutType.TableLine;f--)t=p[f]}}return t}},{key:"_collectRestLayout",value:function(e,t){var n=e.parent.layout_pages,i=n.indexOf(e);if(-1!==i)for(var a=i+1;a<n.length;++a)for(var o=n[a].mainpages,r=0;r<o.length;++r)for(var s=o[r].lines,l=0;l<s.length;++l){if(s[l].layoutType!==L.DOCLayoutType.TableLine)return;t.push(s[l])}}},{key:"_collectBrokenCell",value:function(e){for(var t=e[e.length-1],n=t.range.pos+t.range.len,i=this.data.doc.textStream.getPapxTbl(),a=i.findNodeContainPos(n-1).prop.getPropVal("nest_level"),o=D.b.locate(this.data,n,!1,this.data.typoinfo).line;o&&(o.layoutType!==L.DOCLayoutType.TableLinet||i.findNodeContainPos(o.range.pos+o.range.len-1).prop.getPropVal("nest_level")!==a);)o=o.parent;var r=o;if(r){e.push(r);var s=!1,l=r.parent,c=l.lines,u=c.indexOf(r);if(-1!==u)for(var d=u+1;d<c.length;++d){if(c[d].layoutType!==L.DOCLayoutType.TableLine){s=!0;break}e.push(c[d])}!s&&l.parent.isBrokenAfter&&this._collectBrokenCell(e)}}},{key:"_collectCellInTextFrame",value:function(e,t){var n=e.next;if(n)for(var i=n.lines,a=0;a<i.length;++a)i[a].layoutType===L.DOCLayoutType.TableLine&&t.push(i[a])}},{key:"_collectTableLines",value:function(e,t,n){var i=[],a=t.lines;if(this.isWebTypoMode)return a;var o=a.indexOf(e);if(-1===o)return i;i.push(e);for(var r=o+1;r<a.length;++r){if(a[r].layoutType!==L.DOCLayoutType.TableLine)return i;i.push(a[r])}var s=t.parent;return s.layoutType===L.DOCLayoutType.LayoutPage&&n===A.MainText?this._collectRestLayout(s,i):s.layoutType===L.DOCLayoutType.Cell&&s.parent.isBrokenAfter?this._collectBrokenCell(i):s.layoutType==L.DOCLayoutType.SnippetScene&&this._collectCellInTextFrame(t,i),i}},{key:"_collectCells",value:function(e,t,n,i,a,o){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;e.forEach((function(e){a.push([]),o.push([]);for(var s=void 0,l=void 0,c=0;c<e.tablecells.length;++c){var u=e.tablecells[c];if(u.rect.right>t+r&&u.rect.left<n-r){var d=u.range;d&&(void 0===s?(s=d.pos,l=d.pos+d.len):l=d.pos+d.len,a[a.length-1].push({begin:d.pos,end:l}),o[o.length-1].push(c))}else if(u.rect.left>n-r)break}void 0!==s&&void 0!==l&&i.push({begin:s,end:l,bSelAllCell:!1})}))}},{key:"_trace2Top",value:function(e){for(var t=e.getScenePath(),n=void 0,i=0;i<t.length;++i)if(L.DOCLayoutType.Cell===t[i].layoutType){n=i;break}return t[n]}},{key:"_getCollectComparator",value:function(e,t){var n=this,i=e,a=t,o={top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER};return function(e,t){if(e){var r=e.viewPage.outer_rect,s=n.isWebTypoMode?C.a.transvertPositionFromNode2Target(e,e.viewPage):C.a.getPosition2view(e),l=e.rect.height,c=s.y+r.top,u=c+l;o.top=Math.min(o.top,c),o.bottom=Math.max(o.bottom,u)}else i=t===pe?o.top:i,a=t===he?o.bottom:a;return i<o.top?pe:a>o.bottom?he:fe}}},{key:"_getCollectOperator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){if(!t||n.layoutType===L.DOCLayoutType.TableLine){var i=n.range;e.begin=Math.min(e.begin,i.begin),e.end=Math.max(e.end,i.end)}}}},{key:"_getRowsRange",value:function(e){var t=this.state.cachedSelInfo.beginY,n=this.state.cachedSelInfo.beginLine,i=e.pos.y,a=t>=i?[i,t]:[t,i],o=k()(a,2);t=o[0],i=o[1];var r=e.line;r=this.getTopLevelTableLine(r);var s={begin:Number.MAX_SAFE_INTEGER,end:Number.MIN_SAFE_INTEGER},l=this._getCollectComparator(t,i),c=this._getCollectOperator(s,!0);return r.isSubLine&&(r=r.parent),me(r,l,c),t>i?(s.end=n.range.end,s.begin>n.range.begin&&(s.begin=n.range.begin)):(s.begin=n.range.begin,s.end<n.range.end&&(s.end=n.range.end)),{pos:s.begin,len:s.end-s.begin}}},{key:"selectColumn",value:function(e){this.state.uilState=re.a.BLOCK;var t=e.tableInfos.rect.cellRect,n=this._trace2Top(e.line.parent.parent).parent,i=Object(P.collectColumns)(this.data.doc,e.position,e.position,1).ranges;this.data.selection.setRanges(i,{isSend:!0,applyFormat:!0}),this.state.selectMode=S.TABLE_SELECT_MODE.COLUMN,this.state.isInFooter=e.isInFooter,this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{beginPosition:e.position,beginLine:n,beginX:e.pos.x,beginY:e.pos.y,rect:t})}},{key:"selectColumns",value:function(e){if(e.isInTable){var t=e.tableInfos.rect.cellRect,n=this.state.cachedSelInfo,i=n.rect,o=n.beginPosition,r=e.pos.x;if(!(i&&i.left<=r&&i.right>=r)){var s=Object(P.collectColumns)(this.data.doc,o,e.position).ranges;s&&this.data.selection.setRanges(s,{isSend:!0,applyFormat:!0,preventScroll:!0,isClick:!0}),this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{isTableSelLocked:!1,rect:t})}}}},{key:"selectRow",value:function(e){this.state.uilState=re.a.BLOCK;var t=e.tableInfos.rect,n=t.cellRect,i=t.tableLineRect,o=this._trace2Top(e.line.parent.parent),r=o.parent,s=r.range,l={};l.begin=s.pos,l.end=l.begin+s.len,l.inTable=!0,l.rowSelected=!0,l.cellsSelected=!0,l.columnSelected=!1,l.rowCnt=1,l.columnCnt=r.tablecells.length,l.leftRects=[];var c=[],u=[];r.tablecells.forEach((function(e,t){var n=e.range;n&&(u.push(t),c.push(n?{begin:n.pos,end:n.pos+n.len}:{}))}));var d=this.data.doc.textStream.getPapxTbl().findNodeContainPos(l.end-1).prop;l.cells=[c],l.idxs=[u],l.rows=[d];var h={left:n.left,top:i.top,width:o.rect.width,height:o.rect.height};l.leftRects.push(h),this.data.selection.setPosition(l.begin,l.end,{isSend:!0,applyFormat:!0,isClick:!0},l),this.state.selectMode=S.TABLE_SELECT_MODE.ROW,this.state.isInFooter=e.isInFooter,this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{rect:i,beginY:e.pos.y,beginLine:r})}},{key:"getTopLevelTableLine",value:function(e){for(var t=e.parent,n=[];t&&t.layoutType!==L.DOCLayoutType.LayoutPage&&t.layoutType!==L.DOCLayoutType.MobilePage;)n.push(t),t=t.parent;for(var i=-1,a=0;a<n.length;++a)n[a].layoutType==L.DOCLayoutType.TableLine&&(i=a);return-1!=i?n[i]:e}},{key:"selectLines",value:function(e){var t=this.state.cachedSelInfo.beginY,n=this.state.cachedSelInfo,i=n.rect,o=n.beginLine,r=e.pos.y;if(!(i.top<=r&&i.bottom>=r)){var s=r>t,l=s?[t,r]:[r,t],c=k()(l,2);t=c[0],r=c[1];var u=e.line,d=(u=this.getTopLevelTableLine(u)).viewPage.outer_rect,h=this.isWebTypoMode?C.a.transvertPositionFromNode2Target(u,u.viewPage):C.a.getPosition2view(u),p={left:h.x+d.left,right:h.x+d.left+u.rect.width,top:h.y+d.top,bottom:h.y+d.top+u.rect.height,width:u.rect.width,height:u.rect.height},f={begin:Number.MAX_SAFE_INTEGER,end:Number.MIN_SAFE_INTEGER},g=this._getCollectComparator(t,r),v=this._getCollectOperator(f);u.isSubLine&&(u=u.parent),me(u,g,v),s?f.begin=o.range.begin:f.end=o.range.end;this.data.selection.setPosition(f.begin,f.end,{isSend:!0,applyFormat:!0,preventScroll:!0,isClick:!0});var y=this.selection.begin.position,m=this.selection.end.position-y;this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{rect:p,range:{pos:y,len:m}})}}},{key:"selectCell",value:function(e){this.state.uilState=re.a.BLOCK;var t=e.position,n=e.tableInfos.rect,i=n.cellRect,o=n.viewOffset,r=this._trace2Top(e.line),s=r.index,l=this.data.doc.getDataLogic("final").specTable.getTapx(t,I.IT.Include,1);if(l&&l.prop){var c=l.cellDatas[s];this.data.selection.setPosition(c.begin,c.end,{isSend:!0,applyFormat:!0,isClick:!0}),this.data.selection.clearActiveCtrls();var u=r.parent,d=e.pos.x,h=e.pos.y;o&&(d-=o.x,h-=o.y),this.state.selectMode=S.TABLE_SELECT_MODE.CELL,this.state.isInFooter=e.isInFooter,this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{rect:i,beginX:d,beginY:h,beginLine:u})}}},{key:"selectCells",value:function(e){var t=this;if(e.isInTable){var n=e.tableInfos.rect,i=n.cellRect,o=n.tableLineRect,r=n.viewOffset,s=this.state.cachedSelInfo,l=s.beginX,c=s.beginY,u=this.state.cachedSelInfo.rect,d=e.pos.x,h=e.pos.y;if(r&&(d-=r.x,h-=r.y),!(u&&u.top<=h&&u.bottom>=h&&u.left<=d&&u.right>=d)){var p=this._trace2Top(e.line.parent.parent).parent,f=l>=d?[d,l]:[l,d],g=k()(f,2);l=g[0],d=g[1];var v=c>=h?[h,c]:[c,h],y=k()(v,2);c=y[0],h=y[1];var m=this._getFirstTableLine(p),_=m.parent,x=this._collectTableLines(m,_,e.subDocType).filter((function(e){var n=e.viewPage.outer_rect,i=t.isWebTypoMode?C.a.transvertPositionFromNode2Target(e,e.viewPage):C.a.getPosition2view(e),a=e.rect.height,o=i.y+n.top;return!(o+a<=c||o>=h)})),w=[];this._collectCells(x,l-o.left,d-o.left,w,[],[],0),w.length&&this.data.selection.setRanges(w,{isSend:!0,applyFormat:!0,preventScroll:!0,isClick:!0}),this.state.cachedSelInfo=a()({},this.state.cachedSelInfo,{isTableSelLocked:!1,rect:i})}}}},{key:"_hitOnSameTable",value:function(e){var t=this.state.cachedSelInfo.selectedRowsRange;return!t||e.position>=t.pos&&e.position<t.pos+t.len&&(this.state.cachedSelInfo.selectedRowsRange=null,!0)}},{key:"selectOutsideTable",value:function(e){var t=this.state.cachedSelInfo,n=t.rect,i=t.selectedRowsRange,a=e.position;n&&(this.state.cachedSelInfo.rect=null);var o=this._getRowsRange(e);i||(this.state.cachedSelInfo.selectedRowsRange=o);var r=Math.min(a,o.pos),s=Math.max(a,o.pos+o.len);this.data.selection.setPosition(r,s,{isSend:!0,applyFormat:!0,preventScroll:!0,isClick:!0})}},{key:"splitCells",value:function(){this.manager.editHandler.splitTableCells()}},{key:"handleColumnInsertLimited",value:function(){this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.localUil.columnInsertLimit", "The column width is too small and the content cannot be added"))}},{key:"handleScrollIntoView",value:function(e){this.state.resizeType!==S.TABLE_HIGHLIGHT_TYPE.COLUMN&&this.state.resizeType!==S.TABLE_HIGHLIGHT_TYPE.ROW||this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(e.event)}},{key:"doInRowSelectMode",value:function(e){this.state.isInFooter^e.isInFooter||this.selectLines(e)}},{key:"doInColumnSelectMode",value:function(e){this.state.isInFooter^e.isInFooter||(e.line.isInTable&&this._hitOnSameTable(e)?this.selectColumns(e):this.selectOutsideTable(e))}},{key:"doInCellSelectMode",value:function(e){this.state.isInFooter^e.isInFooter||(e.line.isInTable&&this._hitOnSameTable(e)?this.selectCells(e):this.selectOutsideTable(e))}},{key:"_onMouseUpOutside",value:function(e){this.workspace.container.contains(e.target)||this.onEnd(),document.removeEventListener("mouseup",this._onMouseUpOutside)}},{key:"_attachMouseUpListener",value:function(){document.addEventListener("mouseup",this._onMouseUpOutside)}},{key:"_onLeftButtonClick",value:function(e){switch(e.type){case b.a.TABLE_COLUMN_RESIZE:case b.a.TABLE_ROW_RESIZE:this.beginResizing({hitResult:e});break;case b.a.TABLE_CELL_SELECT:this.selectCell(e);break;case b.a.TABLE_COLUMN_SELECT:this.selectColumn(e);break;case b.a.TABLE_ROW_SELECT:this.selectRow(e);break;default:this.state.uilState=re.a.DONE}}},{key:"onStart",value:function(e,t){var n=e.button;if(this.isRestrictEditMode&&!window.APP.formatContentController.checkIsInContentControl(t.position))return this.state.uilState=re.a.DONE;switch(n){case oe.b.LEFT:this._onLeftButtonClick(t)}this._attachMouseUpListener()}},{key:"onMove",value:function(e,t){if(t){if(this.isRestrictEditMode&&!window.APP.formatContentController.checkIsInContentControl(t.position))return this.state.uilState=re.a.DONE;switch(this.state.selectMode){case S.TABLE_SELECT_MODE.ROW:this.doInRowSelectMode(t);break;case S.TABLE_SELECT_MODE.COLUMN:this.doInColumnSelectMode(t);break;case S.TABLE_SELECT_MODE.CELL:this.doInCellSelectMode(t);break;case S.TABLE_SELECT_MODE.NONE:default:return}this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(e)}}},{key:"onEnd",value:function(e,t){var n=this;this.state.selectMode!==S.TABLE_SELECT_MODE.NONE&&(this.state.selectMode=S.TABLE_SELECT_MODE.NONE,this.resetState()),setTimeout((function(){n.workspace.focusWithoutScroll()}))}},{key:"onGestureEvent",value:function(e,t){var n=e.event,i=e.type;if(t&&this.isRestrictEditMode){if(!this.checkIsInContentControl(t.position))return;if(t.isInTable){var a=t.tableInfos.tableRange,o=t.ctrlInfos[0],r=o.begin,s=o.end;if(r>=a.begin&&s<a.end)return}}switch(i){case ae.a.START:this.onStart(n,t);break;case ae.a.MOVE:this.onMove(n,t);break;case ae.a.END:this.onEnd(n,t)}return this.state.uilState}},{key:"onKeyboardEvent",value:function(e,t){var n=e.type,i=e.keyCode;if("keydown"===n)switch(i){case oe.a.ESC:this.state.isResizing&&(this.manager.finishOperation("resizeTable"),this.state.isResizing=!1,this.state.highlightState=a()({},this.state.highlightState,{showResizeHighlight:!1}),this.workspace.tableFloatMenus.update({showOperationBox:!0,isResizeLine:!1,highlightState:this.state.highlightState})),this.state.uilState=re.a.DONE;break;case oe.a.SPACE:case oe.a.PAGEUP:case oe.a.PAGEDOWN:this.state.isResizing&&e.preventDefault()}return this.state.uilState}},{key:"onCustomEvent",value:function(e,t){var n=e.type,i=e.detail;if(t&&this.isRestrictEditMode&&!window.APP.formatContentController.checkIsInContentControl(t.position))return this.state.uilState=re.a.DONE;switch(n){case ce.default.table.ON_TABLE_BEGIN_RESIZING:this.beginResizing({detail:i});break;case ce.default.table.ON_TABLE_END_RESIZING:this.endResizing(i,t),this.state.uilState=re.a.DONE;break;case ce.default.names.DOC_SCROLL_INTO_VIEW:this.handleScrollIntoView(i),this.state.uilState=re.a.BLOCK}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.DONE,isTemplate:this.data.doc.isTemplate,selectMode:S.TABLE_SELECT_MODE.NONE,isInFooter:!1,cachedSelInfo:{}}}},{key:"isWebTypoMode",get:function(){return this.app.isWebMode()}},{key:"isRestrictEditMode",get:function(){return window.APP.formatContentController.isRestrictEditMode}}],[{key:"matchTriggerConditions",value:function(e,t,n){if(e.isReadOnly())return!1;var i=t.type,a=n&&n.type;return i===ae.a.START&&(a===b.a.TABLE_CELL_SELECT||a===b.a.TABLE_ROW_SELECT||a===b.a.TABLE_COLUMN_SELECT||a===b.a.TABLE_ROW_RESIZE||a===b.a.TABLE_COLUMN_RESIZE)}}]),t}(le.a);Le.type=Ee.a.TABLE,Le.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.MOVE,target:Pe.a.view,flag:Pe.b.gesture,options:{throttleParams:[16,{trailing:!1}]}},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:"keydown",target:Pe.a.input,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SPLIT_CELLS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_BEGIN_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_END_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_SCROLL_INTO_VIEW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.cooperation.ON_CONVENE_INITIATE,target:Pe.a.window,flag:Pe.b.native}];var Ae=Le,Ie=n(14),Re=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"_onLeftButtonClick",value:function(e,t){if(this.selection.setPosition(t,t,{isSend:!0}),this.isRestrictEditMode&&!window.APP.formatContentController.checkIsInContentControl(t.position))return this.state.uilState=re.a.DONE;var n=t.hyperLink,i={isInCatalogs:!!t.catalogInfos};!Object(oe.c)(e)&&!this.app.isReadOnly()||n.isKWProtocolAddress()||this.manager.editHandler.navigateByHyperlink(n,i),this.state.uilState=re.a.DONE}},{key:"onGestureEvent",value:function(e,t){var n=e.type,i=e.event;return n!==ae.a.START||i.button!==oe.b.LEFT&&"touchstart"!==i.type||("touchstart"===i.type&&i.preventDefault(),this._onLeftButtonClick(i,t)),this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.BLOCK}}}],[{key:"matchTriggerConditions",value:function(e,t,n){if(Object(Ie.hasQuery)("template"))return!1;var i=t instanceof Event?t:t.event,a=t.type,o=i.button,r=(n||{}).type;return(r===b.a.HYPERLINK||r===b.a.TABLE_HYPERLINK)&&(!(!n||!n.hyperLink)&&!(a!==ae.a.START||!(o===oe.b.LEFT||_.isPad&&"touchstart"===t.event.type)||!e.isReadOnly()&&!Object(oe.c)(i)))}}]),t}(le.a);Re.type=Ee.a.HYPERLINK,Re.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture}];var Oe=Re,Me=n(1980),De=n(4108),Ne=n(5301),Be=function(e){var t={src:e.src||window.APP.data.shapeManager.shapeMap.getShapeInfo(e.shapeTreeType,e.id,!0).latestAvailableSourceUrl,gcp:e.gcp,getSvgContentFunc:e.shape.isWebshape?void 0:e.getSvgContentFunc,sha1:e.sha1,isEmbedding:e.isEmbedding,rect:Object.assign({},e.rect),shapeTreeType:e.shapeTreeType,innerBoundary:e.shape.innerBoundary,id:e.id};return t.rect.width=e.rect.width,t.rect.height=e.rect.height,t};var je=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.selectShapeOnEnd=null,a._onMouseUpOutside=function(){a.selectShapeOnEnd=null;var e=a.state,t=e._backupHitResult,n=e._backupMove;t&&n&&n.length&&(a.state.uilState=re.a.DONE,a._onCancelTap.apply(a,[t].concat(r()(n)))),document.removeEventListener("mouseup",a._onMouseUpOutside)},a._attachMouseUpListener=function(){document.addEventListener("mouseup",a._onMouseUpOutside)},a._useOffset=!(_.agent.indexOf("compatible")>-1&&_.agent.indexOf("msie")>-1),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"execute",value:function(e,n){var i=e.type;return n&&this.isRestrictEditMode&&!this.checkIsInContentControl(n.position)?i===ae.a.DOUBLE_TAP?f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n):this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"resetState",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resetState",this).call(this),this.workspace.scrollerHelper&&this.workspace.scrollerHelper.clear()}},{key:"isSupportShapeOperation",value:function(e){var t=this.app.data.selection.selShapes;return!(t&&t.length>1)&&!(this.app.isWebMode()&&!e.isEmbedding)}},{key:"getSrc",value:function(e,t){return this.data.shapeManager.getShapeUrl(e,t)}},{key:"_getShapeByPos",value:function(e){var t=this,n=e.shapeInfo,i=n.isHitOnShape,a=n.id,o=n.gcp,r=n.rect,s=n.shape,l=n.isEmbedding,c=n.shapeIdxPath,u=e.textbox;if(!(i&&s||u))return null;!s&&u&&(a=u.id,o=u.anchor?u.anchor.pos:u.topShape.anchor.pos,l=u.isEmbedShape,r=u.rect,c=u.shapeIdxPath);var d=s||u,h=d.shape_tree_type,p=d.isExclusive,f=d.anchor?d.anchor.shapeData:d.shapeData,g=d.viewRect;c||(c=d.shapeIdxPath);return{id:a,gcp:o,rect:r,getSrc:function(){return t.getSrc(h,a)},shapeTreeType:h,isEmbedding:l,isExclusive:p,shapeData:f,viewRect:g,shape:d,shapeIdxPath:c}}},{key:"_getShapeByTopShape",value:function(e){var t=this,n=e.id,i=e.shape_tree_type,a=e.isExclusive,o=e.shapeIdxPath,r=e.isEmbedShape,s=e.viewRect,l=e.rect,c=e.anchor?e.anchor.shapeData:e.shapeData,u=e.anchor.pos;return{id:n,gcp:u,rect:l,getSrc:function(){return t.getSrc(i,n)},shapeTreeType:i,isEmbedding:r,isExclusive:a,shapeData:c,viewRect:s,shape:e,shapeIdxPath:o}}},{key:"_prepareShapeInfoIfNeeded",value:function(e,t){if(e){if(e.src)t&&t(e);else if(e.getSvgContentFunc)t&&t(e);else if(e.shape.renderInfo&&e.shape.renderInfo.svgNode){var n=e.shape.renderInfo.svgNode,i=e.shape.innerBoundary;e.getSvgContentFunc=function(t){var a=Object(Ne.b)(n);return a.setAttribute("transform","translate("+-i.left+", "+-i.top+")"),(1!==t||e.shape.renderScale)&&(a=Object(Ne.c)(a,t*(e.shape.renderScale||1))),a},t&&t(e)}}else t&&t(null)}},{key:"_showImageView",value:function(e){!0===this._isDuringRigthMenu()||this.data.doc.textboxs.getTextboxAnchor(e.gcp)||Object(Me.a)(e.shapeData)&&ce.default.dispatchEvent(ce.default.shape.ON_SHOW_IMAGE_VIEWER,{id:e.id,shapeTreeType:e.shapeTreeType})}},{key:"_showLatexMathEditView",value:function(e){if(window.__CONFIG__.enableLaTeX){var t=this.app.formatContentController.checkIsInContentControl(e.gcp);if(!(this.app.data.selection.selInfo.info.isSelectionRangeNonEditable||this.app.restrictEditHandler.isInRestrictEditMode&&!t)){var n=e.shapeData;ce.default.dispatchEvent(ce.default.names.ON_LATEX_MATH_PANEL_SHOW,{id:n.shapeId,latexStr:n.extData.latexStr,isEdit:!0})}}}},{key:"_getPos",value:function(e){var t=void 0;return e.touches&&e.touches.length?t=e.touches[0]:e.changedTouches&&e.changedTouches.length?t=e.changedTouches[0]:isNaN(e.pageX)||isNaN(e.pageY)||(t={pageX:e.pageX,pageY:e.pageY}),t}},{key:"_showDragView",value:function(e,t){var n=this;!0!==this._isDuringRigthMenu()&&this._prepareShapeInfoIfNeeded(e,(function(e){n.state.isDragging&&e&&ce.default.dispatchEvent(ce.default.shape.ON_IMAGE_MOVING_EDIT_MODE,{shapeInfo:Be(e),offset:n._useOffset?n.state.hitOffset:void 0,zoom:n.workspace.getScaleValue(),position:n._getPos(t)})}))}},{key:"_moveDragView",value:function(e){this.state.shape&&(this.state.shape.src||this.state.shape.getSvgContentFunc)&&ce.default.dispatchEvent(ce.default.shape.ON_IMAGE_MOVING_EDIT_MODE,{shapeInfo:Be(this.state.shape),offset:this._useOffset?this.state.hitOffset:void 0,zoom:this.workspace.getScaleValue(),position:this._getPos(e)})}},{key:"_hideDragView",value:function(){ce.default.dispatchEvent(ce.default.shape.ON_IMAGE_MOVING_EDIT_MODE_END)}},{key:"cancelDragImage",value:function(){this.state.isDragging&&(this._hideDragView(),this.manager.finishOperation("dragShape")),this.data.selection.drapingShape=void 0,this.state.shape&&this.state.isDragging&&(this.state.isDragging=!1)}},{key:"_onDoubleTap",value:function(e){if(this.state.uilState=re.a.DONE,window.APP.data.selection.selShapes){var t=e.shapeData,n=e.shape,i=t.extData&&t.extData.isLatexMath,a=n&&n.isWebshape;if(i)this._showLatexMathEditView(e);else{if(a)return;this._showImageView(e),n.isPresetDrawing&&ce.default.dispatchEvent(ce.default.taskPane.OPEN_SHAPE_ATTR)}}}},{key:"_onLongTap",value:function(e,t){!0!==this._isDuringRigthMenu()&&this.isSupportShapeOperation(e)&&(this.state.uilState=re.a.BLOCK,this.state.shape=e,this.state.isDragging=!0,this._showDragView(e,t),this.manager.startOperation("dragShape"))}},{key:"_onDrag",value:function(e,t){if(this.state.shape){if(!0===this._isDuringRigthMenu()||!this.isSupportShapeOperation(this.state.shape))return;var n=this.selection.activeShape&&this.selection.activeShape.id;if(!this.state.isDragging&&n===this.state.shape.id)return this.state.isDragging=!0,this._showDragView(this.state.shape,t),void(this.state.uilState=re.a.BLOCK);if(this.state.isDragging)this._moveDragView(t);else{if(_.isPad)return void(this.state.uilState=re.a.DONE);var i={};_.isPad?(i.preventScroll=!1,i.preventFocus=!0):i.preventScroll=!0,this.selection.selAlter.selectShape(this.state.shape,i),this.state.isDragging=!0,this._showDragView(this.state.shape,t)}if("mousemove"===t.type&&_.isPad&&this.workspace.disableScroll(),this.state.shape.isEmbedding){var a=e;if(this.state.shape.isExclusive){var o=void 0;if(e.innerPos.y<(e.line.rect.top+e.line.rect.bottom)/2)o=e.line.range.begin;else if(o=e.line.range.end,e.line.isInTable){var r=e.line.parent.range;o>=r.pos+r.len&&--o}a=D.b.locate(this.app.data,o,!1,this.data.typoinfo),this.data.selection.drapingShape=!0}this.data.selection.setPosition(a,null,{updateOnly:!0})}this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(t),this.state.uilState=re.a.BLOCK}else this.state.uilState=re.a.DONE;this.state._backupHitResult=e}},{key:"_onCancelTap",value:function(e,t,n,i){this.state.isDragging&&(this._hideDragView(),this.manager.finishOperation("dragShape")),["mouseup","mousemove","touchend"].includes(i.type)&&_.isPad&&this.workspace.enableScroll(),this.data.selection.drapingShape=void 0;var a=t||0,o=n||0;if(this.state.shape&&this.state.isDragging){this.state.isDragging=!1;var r=this.data.selection.selInfo.isHitOnCtrl(),s=r.isHitOnDatetime,l=r.isHitOnDropList,c=r.isPureText,u=r.isPicture,d=r.isComboBox,h=r.isCheckBox;if(s||l||c||u||d||h)this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.localUil.picCanNotDragIntoCurrentCtrl", "The control does not support inserting pictures"));else if(0!==a&&0!==o){var p=this.state.shape,f=this.getShapeGcp(p.isEmbedding,p.shapeTreeType,p.id);if(-1!==f&&(p.gcp=f),p.isEmbedding){var g=e.position;if(p.isExclusive)if(e.innerPos.y<(e.line.rect.top+e.line.rect.bottom)/2)g=e.line.range.begin;else{g=e.line.range.end;var v=this.data.doc.getSubDocType(p.gcp),y=e.line.isInTable?e.line.parent.range:this.data.doc.getSubDocRange(v),m=y.pos+y.len;g>=m&&(g=m-1)}var x=window.APP.restrictEditHandler;if(!(x.checkIsRangeNonEditable({pos:g,len:0})||x.checkIsRangeNonEditable({pos:p.gcp,len:1})||this.data.doc.textboxs.getTextboxAnchor(p.gcp)&&this.data.doc.textboxs.isInTextbox(g))){var w=(this.state||{}).currPicControl;if(w&&w.isPicture)window.APP.formatContentController.moveContentController2NewPosByController(w.ctrl,g)||window.APP.data.selection.setPosition(w.begin,w.end);else this.manager.editHandler.picture.move(g,p.gcp,p.shape.isWebshape)}}else{var k=this.workspace.getScaleValue(),b=this.workspace.element.scrollTop,T=this.workspace.element.scrollLeft,C=parseInt((a+T-this.state.scrollPos.x)/k,10),S=parseInt((o+b-this.state.scrollPos.y)/k,10);this._useOffset||(C+=parseInt(this.state.hitOffset.x,10),S+=parseInt(this.state.hitOffset.y,10)),window.APP.editor.picture.moveShape(p.gcp,p.id,p.shapeTreeType,Object(R.Px2Ti)(C),Object(R.Px2Ti)(S),p.shapeIdxPath)}}else if(this.state.shape.isEmbedding&&e.shapeInfo){var E={};_.isPad&&(E.preventScroll=!1,E.preventFocus=!0),this.selection.selAlter.selectShape(e.shapeInfo,E)}this.state.shape=null}else if(this.state.shape){if("function"==typeof this.selectShapeOnEnd)try{this.selectShapeOnEnd(i.shiftKey||i.ctrlKey)}catch(e){console.error(e)}this.selectShapeOnEnd=null,this.state.shape=null}_.isPad||i.button!==oe.b.LEFT||window.APP.workspace.focusWithoutScroll(),this.state.uilState=re.a.DONE,this.resetState()}},{key:"_onStart",value:function(e,t){var n=this;if(this.state.uilState=re.a.BLOCK,e.type.startsWith("SHAPE_RESIZE_")||e.type.startsWith("SHAPE_ADJUSTHANDLER_")){var i=this._getShapeByPos(e),a=e.shapeInfo.shape;if(a.isRotateText&&a.visualRotation&&a.hasEnterTextbox()){var o={preventScroll:!0,layoutIndex:e.layoutIndex};return this.selection.selAlter.selectShape(i,o),void window.APP.workspace.toggleContainerPointerStyle(ue.cursorTypes.default)}}if(!this.state.shape){var r={preventScroll:!0,layoutIndex:e.layoutIndex};_.isPad&&(r.preventScroll=!1,r.preventFocus=!0);var s=this._getShapeByPos(e),l=window.APP.data.selection.selShapes;if(s.shape.isChildShape&&l&&l[0].isTopShape?this.state.shape=this._getShapeByTopShape(s.shape.topShape):this.state.shape=s,this.selectShapeOnEnd=function(e){s.shapeIdxPath&&!function(e,t,n){for(var i=window.APP.data.doc.layer.getShapeTree(e),a=0,o=t.length;a<o;++a){var r=t[a],s=i.childs;if(r>=s.getLength())return!1;i=s.at(r)}return i.shapeId===n}(s.shapeTreeType,s.shapeIdxPath,s.id)&&(delete s.shapeIdxPath,console.error("No Corrlect Shape shapeIdxPath")),e&&(r.isSelShapes=!0),n.selection.selAlter.selectShape(s,r)},this.state.shape&&!this.state.shape.isEmbedding){var c=window.APP.uilManager.getPosByEvent(t),u={x:c.x-this.state.shape.shape.viewPage.outer_rect.left-this.state.shape.viewRect.left,y:c.y-this.state.shape.shape.viewPage.outer_rect.top-this.state.shape.viewRect.top};this.state.hitOffset=u}this.state.scrollPos={x:this.workspace.element.scrollLeft,y:this.workspace.element.scrollTop};var d=e.ctrlInfos||[],h=k()(d,1)[0];this.state.currPicControl=h}}},{key:"onGestureEvent",value:function(e,t){var n=e.type,i=e.event,a=e.diffX,o=e.diffY,r=e.context;if((this.app.isReadOnly()||!this.app.api.isConnected())&&![ae.a.START,ae.a.END,ae.a.DOUBLE_TAP].includes(n))return this.state.uilState;var s=void 0;switch(s=this.state.shape?this.state.shape:this._getShapeByPos(t),n){case ae.a.DOUBLE_TAP:s&&this._onDoubleTap(s);break;case ae.a.START:if((this.app.isReadOnly()||!this.app.api.isConnected())&&i.button===oe.b.RIGHT)return this.state.uilState;this._attachMouseUpListener(),this._onStart(t,i);break;case ae.a.LONG_TAP:this.selectShapeOnEnd=null,s&&this._onLongTap(s,i);break;case ae.a.MOVE:if(this.state._backupMove=[a,o,i],!(Math.abs(a)>3||Math.abs(o)>3))break;this._onDrag(t,i),_.isPad&&this.state.isDragging&&i.cancelable&&i.preventDefault(),this.selectShapeOnEnd=null;break;case ae.a.END:_.isPad&&!r.isMoved&&i.preventDefault(),this._onCancelTap(t,a,o,i);break;case ae.a.LEAVE:break;default:this.state.uilState=re.a.DONE}return this.state.uilState}},{key:"onKeyboardEvent",value:function(e,t){if("keydown"===e.type&&this.state.shape)switch(e.keyCode){case oe.a.ESC:this.cancelDragImage(),this.state.uilState=re.a.DONE;break;default:this.state.uilState=re.a.BLOCK,e.preventDefault()}return this.state.uilState}},{key:"_isDuringRigthMenu",value:function(){return this.app.isRightContextMenu}},{key:"getShapeGcp",value:function(e,t,n){var i=e?this.data.doc.inlineAnchors:this.data.doc.anchors,a=-1;return i.rangeClass.forEachNode((function(e){if(-1===a&&e.shapeData){var i=e.shapeData;i.shapeId===n&&i.shapeTreeType===t&&(a=e.pos)}})),a}},{key:"initialState",get:function(){return{uilState:re.a.DONE,shape:null,hitOffset:{x:0,y:0},scrollPos:{x:0,y:0}}}}],[{key:"matchTriggerConditions",value:function(e,n,i){var a=n.type,o=n instanceof Event?n:n.event;if(Object(Ie.hasQuery)("template"))return!1;if(e.editor.picture.getPreInsertShapeData())return!1;if(i&&i.type&&i.type===x.b.TEXTBOX_PAGE&&(o.shiftKey||o.ctrlKey)&&(a===ae.a.START||a===ae.a.END)&&i.textbox&&!i.textbox.isEmbedding){var r=e.data.selection,s=r.selAlter.getAdaptedSelShapes(),l=r.activeShape;if(s&&s.length>1||l&&!l.isEmbedding||r.selContext.shapeIdxPathOfTextbox&&!Object(De.b)(r.selContext.shapeIdxPathOfTextbox,i.shapeIdxPathOfTextbox))return!0;if(!s)return!0}if(i&&i.type&&i.type===x.b.WATER_DROP)return!1;if(a===ae.a.START&&(i.type.startsWith("SHAPE_RESIZE_")||i.type.startsWith("SHAPE_ADJUSTHANDLER_"))){var c=i.shapeInfo.shape;if(c.isRotateText&&c.visualRotation&&c.hasEnterTextbox())return!0}if(!i||!i.shapeInfo||!i.shapeInfo.isHitOnShape)return!1;if((e.isReadOnly()||!e.api.isConnected())&&a===ae.a.START)return!0;var u=window.APP.formatContentController;return e.isReadOnly()||!e.api.isConnected()||u.isRestrictEditMode&&!u.checkIsInContentControl(i.position)?!(a!==ae.a.DOUBLE_TAP||!t.isShapeType(i)):o.button!==oe.b.RIGHT&&!(a!==ae.a.START&&a!==ae.a.DOUBLE_TAP||!t.isShapeType(i))}},{key:"isShapeType",value:function(e){if(e.type===x.b.SHAPE||e.type===x.b.COOPER_SELECTION_SHAPE)return!0}}]),t}(le.a);je.type=Ee.a.SHAPE,je.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.MOVE,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.LONG_TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.DOUBLE_TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.LEAVE,target:Pe.a.view,flag:Pe.b.gesture},{type:"keydown",target:Pe.a.input,flag:Pe.b.native}];var Fe=je,He=n(964),Ge=n(7509),Ue=n(4107),We=n(7208),Ye=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"isSupportShapeOperation",value:function(e){return!(this.app.isWebMode()&&!e.isEmbedding)}},{key:"onGestureEvent",value:function(e,t){if(!this.isSupportShapeOperation(t.shapeInfo))return this.state.uilState;var n=e.type,i=e.event;switch(n){case ae.a.START:return this.onStart(i,t);case ae.a.END:return this.onEnd(i,t)}return this.state.uilState=re.a.BLOCK,this.state.uilState}},{key:"onKeyboardEvent",value:function(e,t){if("keydown"===e.type&&this.state.isResizing)switch(e.keyCode){case oe.a.ESC:this.endResizing(t),this.state.uilState=re.a.DONE;break;default:this.state.uilState=re.a.BLOCK,e.preventDefault()}return this.state.uilState}},{key:"onCustomEvent",value:function(e){switch(e.type){case ce.default.shape.ON_SHAPE_BEGIN_RESIZING:this.state.uilState=re.a.BLOCK,this.beginResizing(e);break;case ce.default.shape.ON_SHAPE_END_RESIZING:this.endResizing(e.detail),this.state.uilState=re.a.DONE;break;case ce.default.names.DOC_SCROLL_INTO_VIEW:this.state.uilState=re.a.BLOCK,this._handleScrollIntoView(e.detail)}return this.state.uilState}},{key:"onStart",value:function(e,t){return this.state.uilState=re.a.BLOCK,this.state.pos=t.pos,this.state.shapeInfo||(this.state.shapeInfo=t.shapeInfo,this.state.resizeType=t.type),this.beginResizing(e),this.state.uilState}},{key:"onEnd",value:function(e,t){var n=t.pos;return"mouseup"===e.type&&_.isPad&&this.workspace.enableScroll(),this.state.pos.x===n.x&&this.state.pos.y===n.y&&(this.workspace.drawingResizer.update({showResizer:!1}),this.state.uilState=re.a.DONE),this.state.uilState}},{key:"_handleScrollIntoView",value:function(e){}},{key:"_resizeShape",value:function(e,t,n,i,a,o){var r=e,s=t,l=n;this.state.shapeInfo.isEmbedding&&(r=s=0);var c=this.state.shapeInfo.shape;if(this.app.isWebMode()){var u=c.textpage;l=Math.min(l,u.rect.width)}var d={pos:this.state.shapeInfo.gcp,shapeId:c.id,shapeTreeType:c.shape_tree_type,xOffset:r,yOffset:s,width:l,height:i,shapeIdxPath:c.shapeIdxPath};a!==c.horizontalFlipped&&(d.horizontalFlipped=c.horizontalFlipped===c.visualTransform2D.horizontalFlipped?a:!a),o!==c.verticalFlipped&&(d.verticalFlipped=c.verticalFlipped===c.visualTransform2D.verticalFlipped?o:!o),window.APP.editor.picture.resizeShape(d)}},{key:"_prepareShapeInfoIfNeeded",value:function(e,t){if(e)if(e.src)t&&t(e);else{if(!e.resizeShapeInfoFunc){var n=e.shape.shapeData,i=e.shape.parent,o=i&&i.drawingLayout,r=e.shape.rect,s=r.width,l=r.height;e.resizeShapeInfoFunc=function(e,t,r,c){var u=a()({},n.private);if(u.transform2D=Object(He.d)(u.transform2D),i){var d=i.shapeData.private.childExtents;u.transform2D.width=Math.round(e*d.width/i.rect.width),u.transform2D.height=Math.round(t*d.height/i.rect.height)}else u.transform2D.width=Object(Ge.Px2Emu)(e),u.transform2D.height=Object(Ge.Px2Emu)(t);u.transform2D.horizontalFlipped=r,u.transform2D.verticalFlipped=c;var h=window.APP.drawingTools.createShape(u);i&&(h.parent=i.shapeData);var p=window.APP.drawingTools.layout({shapeData:h,scale:Object(Ue.d)(1),isLocalShape:!0,parentLayout:o}),f=void 0,g=void 0;if(h.isGroupShape()){var v=Number.MAX_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER,x=h.getTransform2D(),w=x.rotation,k=x.horizontalFlipped,b=x.verticalFlipped,T=void 0;if(w||k||b){T=new window.QMatrix;var C=p.layoutRect;T.translate(C.width/2,C.height/2),T.rotate(w),T.scale(k?-1:1,b?-1:1),T.translate(-C.width/2,-C.height/2)}g={};!function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=n;if(a||(a=window.APP.drawingTools.layout({shapeData:t,scale:Object(Ue.d)(1),isLocalShape:!0,parentLayout:i})),t.isGroupShape())t.getChilds().forEach((function(t){e(t,null,a)}));else{var o=a,r=o.layoutRect,s=o.exactRect,l=void 0,c=void 0;if(T){var u=T.map_point(new window.Point(r.x+r.width/2,r.y+r.height/2));l=u.x()-r.width/2,c=u.y()-r.height/2}else l=r.x,c=r.y;var d={left:l,top:c,width:r.width,height:r.height},h=s.x-r.x,p=s.y-r.y;v=Math.min(v,l+h),y=Math.max(y,l+h+s.width),m=Math.min(m,c+p),_=Math.max(_,c+p+s.height),g[t.getId()]={layout:a,rect2TopShape:d}}}(h,p),f=X.a.initByOriginAndSize({x:v,y:m},{width:y-v,height:_-m})}else{var S=p.exactRect,E=S.x,P=S.y,L=S.width,A=S.height,I=p.layoutRect;f=X.a.initByOriginAndSize({x:E-I.x,y:P-I.y},{width:L,height:A})}return{shapeData:h,layout:p,innerBoundary:f,childsInfo:g,xScale:e/s,yScale:t/l}},e.renderResizeShapeFunc=function(t,n,i){var a=t.shapeData,o=t.layout,r=t.childsInfo,s=t.xScale,l=t.yScale;i.save(),i.translate(n.left,n.top),function t(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n.isGroupShape())n.getChilds().forEach((function(e){t(e,null)}));else{var o=a;if(o||(o=r[n.getId()].layout),!a){i.save();var c=r[n.getId()].rect2TopShape;i.translate(c.left,c.top)}if(Object(We.a)(n))window.APP.drawingTools.render(i,n,o);else if(Object(We.b)(n)){var u=n.private,d=u.shapeTreeType,h=u.shapeId,p=window.APP.data.shapeManager.getShapeFromMap(d,h),f=p&&p.latestAvailableOrgSourceInfo;if(f){var g=n.visual.getRealTransform2D(),v=g.rotation,y=g.horizontalFlipped,m=g.verticalFlipped,_=o.layoutRect,x=f.size,w=_.width/x.width,k=_.height/x.height,b=!1;(0!==v||y||m)&&(i.translate(_.width/2,_.height/2),0!==v&&i.rotate(v/180*Math.PI,0,0),(y||m)&&i.scale(y?-1:1,m?-1:1),i.translate(-_.width/2,-_.height/2),i.save(),b=!0),i.scale(w,k),i.addImageNode(f.base64Data,0,0,Math.round(x.width),Math.round(x.height)),b&&i.restore()}}else{var T=n.private,C=T.shapeTreeType,S=T.shapeId,E=window.APP.data.shapeManager.getShapeFromMap(C,S),P=E&&E.latestAvailableSourceInfo,L=window.APP.data.typoinfo.getTypoShapeInfo(e.shape),A=L&&L.visualInnerBounding;if(P&&A){var I=A.left,R=A.top,O=A.right,M=A.bottom;i.translate(Object(Ue.d)(I)*s,Object(Ue.d)(R)*l),i.scale(s,l),i.addImageNode(P.base64Data,0,0,Math.round(Object(Ue.d)(O-I)),Math.round(Object(Ue.d)(M-R)))}}a||i.restore()}}(a,o),i.restore()}}t&&t(e)}else t&&t(null)}},{key:"beginResizing",value:function(e){var t=this,n=window.APP.data.selection.activeShape;n&&n.isWebshape&&(n.renderInfo.svgNode.getElementsByTagName("foreignObject")[0].style.pointerEvents="none"),this.manager.startOperation("resizeShape"),this.state.isResizing=!0,"mousedown"===e.type&&_.isPad&&this.workspace.disableScroll(),this._prepareShapeInfoIfNeeded(this.state.shapeInfo,(function(e){t.workspace.drawingResizer.update({showResizer:!0,shapeInfo:e,resizeType:t.state.resizeType})}))}},{key:"endResizing",value:function(e){var t=this,n=window.APP.data.selection.activeShape;if((n&&n.isWebshape&&(n.renderInfo.svgNode.getElementsByTagName("foreignObject")[0].style.pointerEvents="auto"),this.manager.finishOperation("resizeShape"),this.state.isResizing=!1,_.isPad&&this.workspace.enableScroll(),e)&&!window.APP.restrictEditHandler.checkIsRangeNonEditable({pos:this.state.shapeInfo.gcp,len:1})){var i=e.xOffset,a=e.yOffset,o=e.width,r=e.height,s=e.horizontalFlipped,l=e.verticalFlipped;this._resizeShape(i,a,o,r,s,l)}setTimeout((function(){t.workspace.drawingResizer.update({showResizer:!1}),_.isPad&&!_.isIPad||t.workspace.focusWithoutScroll()}),0)}},{key:"initialState",get:function(){return{uilState:re.a.DONE,shapeInfo:null,resizeType:null,isResizing:!1}}}],[{key:"matchTriggerConditions",value:function(e,t,n){if(e.editor.picture.getPreInsertShapeData())return!1;var i=t.type;if(n&&n.type&&(n.type===x.b.TEXTBOX_PAGE||n.type===x.b.WATER_DROP))return!1;if(!n||!n.shapeInfo||!n.shapeInfo.isHitOnShape)return!1;var a=window.APP.formatContentController;return!(e.isReadOnly()||!e.api.isConnected()||a.isRestrictEditMode&&!a.checkIsInContentControl(n.position))&&(!(i!==ae.a.START||!n.type.startsWith("SHAPE_RESIZE_"))||void 0)}}]),t}(le.a);Ye.type=Ee.a.SHAPE_RESIZE,Ye.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:"keydown",target:Pe.a.input,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_BEGIN_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_END_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_SCROLL_INTO_VIEW,target:Pe.a.window,flag:Pe.b.native}];var ze=Ye,Xe=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a._onKeyDown=function(e){e.keyCode===oe.a.ESC&&a._doCancleInsert()},a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"onMouseEvent",value:function(e,t){return"mousemove"!==e.type||this.state.needClosePreive?"mouseup"===e.type&&window.APP.workspace.toggleContainerPointerStyle(ue.cursorTypes.default):window.APP.workspace.toggleContainerPointerStyle("cursor-select"),this.state.uilState}},{key:"onGestureEvent",value:function(e,t){var n=e.type,i=e.event;switch(n){case ae.a.START:return this.onStart(i,t);case ae.a.END:return this.onEnd(i,t)}return this.state.uilState=re.a.BLOCK,this.state.uilState}},{key:"onCustomEvent",value:function(e){var t=this;switch(e.type){case ce.default.shape.ON_SHAPE_BEGIN_PREVIEW:this.state.uilState=re.a.BLOCK,this.beginPreview(e);break;case ce.default.shape.ON_SHAPE_END_PREVIEW:this.endPreview(e.detail),window.APP.workspace.toggleContainerPointerStyle(ue.cursorTypes.default);break;case ce.default.canvas.ON_AFTER_REFRESH_CANVAS:this.state.needClosePreive&&(this.workspace.drawingPreviewer.update({showPreviewer:!1}),_.isPad&&!_.isIPad||setTimeout((function(){t.workspace.focusWithoutScroll()})),this.state.needClosePreive=!1,this.state.uilState=re.a.DONE,this.manager.finishOperation("previewShape"));break;case ce.default.shape.ON_SHAPE_PRE_INSERT:this.state.onListenEsc||(document.addEventListener("keydown",this._onKeyDown),this.state.onListenEsc=!0);break;case ce.default.shape.ON_SHAPE_CANCLE_INSERT:window.APP.editor.picture.cancleInsertShape(),this.workspace.drawingPreviewer.update({showPreviewer:!1}),_.isPad&&!_.isIPad||this.workspace.focusWithoutScroll(),this.state.needClosePreive=!1,this.state.uilState=re.a.DONE,window.APP.workspace.toggleContainerPointerStyle(ue.cursorTypes.default),this.manager.finishOperation("previewShape");break;case ce.default.names.DOC_UNDO_REDO:window.APP.editor.picture.cancleInsertShape(),window.APP.workspace.toggleContainerPointerStyle(ue.cursorTypes.default);break;case ce.default.restrictEdit.ON_RESTRICT_STATE_CHANGE:e.detail.isRestrict&&this._doCancleInsert()}return this.state.uilState}},{key:"onStart",value:function(e,t){return this.state.uilState=re.a.BLOCK,this.state.pos=t.pos,this.beginPreview(e),this.state.uilState}},{key:"onEnd",value:function(e,t){var n=t.pos;if("mouseup"===e.type&&_.isPad&&this.workspace.enableScroll(),this.state.pos.x===n.x&&this.state.pos.y===n.y){this.workspace.drawingPreviewer.update({showPreviewer:!1});var i=void 0,a=window.APP.drawingTools.getFill(window.APP.editor.picture.getPreInsertShapeData());a&&(i={fill:a}),this.endPreview({x:this.state.pos.x,y:this.state.pos.y,props:i})}return this.state.uilState}},{key:"beginPreview",value:function(e){this.manager.startOperation("previewShape"),"mousedown"===e.type&&_.isPad&&this.workspace.disableScroll(),this.workspace.drawingPreviewer.update({showPreviewer:!0,event:e})}},{key:"endPreview",value:function(e){this.state.needClosePreive=!0,window.APP.editor.picture.commitShape({data:e}),_.isPad&&this.workspace.enableScroll(),this.state.onListenEsc&&(document.removeEventListener("keydown",this._onKeyDown),this.state.onListenEsc=!1)}},{key:"_doCancleInsert",value:function(){this.state.onListenEsc&&(document.removeEventListener("keydown",this._onKeyDown),this.state.onListenEsc=!1),ce.default.dispatchEvent(ce.default.shape.ON_SHAPE_CANCLE_INSERT)}},{key:"initialState",get:function(){return{uilState:re.a.DONE,needClosePreive:!1,onListenEsc:!1}}}],[{key:"matchTriggerConditions",value:function(e,t,n){return!(e.isReadOnly()||!e.api.isConnected())&&window.APP.editor.picture.getPreInsertShapeData()}}]),t}(le.a);Xe.type=Ee.a.SHAPE_PREVIEW,Xe.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:ce.default.shape.ON_SHAPE_BEGIN_PREVIEW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_END_PREVIEW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.canvas.ON_AFTER_REFRESH_CANVAS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_PRE_INSERT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_CANCLE_INSERT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_UNDO_REDO,target:Pe.a.window,flag:Pe.b.native}];var Ve=Xe,qe=n(3319),Ke=n(4743),Qe=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"isSupportShapeOperation",value:function(e){return!(this.app.isWebMode()&&!e.isEmbedding)}},{key:"onGestureEvent",value:function(e,t){if(!this.isSupportShapeOperation(t.shapeInfo))return this.state.uilState;var n=e.type,i=e.event;switch(n){case ae.a.START:return this.onStart(i,t);case ae.a.END:return this.onEnd(i,t)}return this.state.uilState=re.a.BLOCK,this.state.uilState}},{key:"onCustomEvent",value:function(e){switch(e.type){case ce.default.shape.ON_SHAPE_BEGIN_SET_ADJUSTHANDLER:this.state.uilState=re.a.BLOCK,this.beginSetAdjustHandler(e);break;case ce.default.shape.ON_SHAPE_END_SET_ADJUSTHANDLER:this.endSetAdjustHandler(e.detail),this.state.uilState=re.a.DONE}return this.state.uilState}},{key:"onStart",value:function(e,t){this.state.uilState=re.a.BLOCK,"mousedown"===e.type&&_.isPad&&this.workspace.disableScroll(),this.state.pos=t.pos;var n=t.shapeInfo.shape,i=n.viewPage.outer_rect,o=n.viewRect,r=n.visualTransform2D,s=n.drawingLayout,l=n.shapeData,c=n.shapeDataForAutoFit,u=n.parent,d=c||l,h=new qe.a(o);h.addOffset(i.left,i.top);var p={shapeRect:h,visualTransform2D:r,geometry2D:s.geometry2D,shapeData:d.private,adjustIdx:parseInt(t.type.substr(-1)),calcAdjustRenderInfo:function(e){var t=a()({},d.private);t.geometry2D=Object(Ke.a)(t.geometry2D),t.geometry2D.adjustValues=e;var n=window.APP.drawingTools.createShape(t),i=void 0;u&&(n.parent=u.shapeData,i=u.drawingLayout);var o=window.APP.drawingTools.layout({shapeData:n,scale:Object(R.Ti2Px)(1),isLocalShape:!0,parentLayout:i}),r=o.geometry2D.geometry.adjustHandles,s=o.exactRect,l=s.x,c=s.y,h=s.width,p=s.height,f=o.layoutRect;return{shapeData:n,layout:o,adjustHandler:r,innerBoundary:X.a.initByOriginAndSize({x:l-f.x,y:c-f.y},{width:h,height:p})}},renderAdjustHandlerFunc:function(e,t){var n=e.shapeData,i=e.layout,a=e.innerBoundary;t.save(),t.translate(-a.left,-a.top),window.APP.drawingTools.render(t,n,i),t.restore()}};return this.beginSetAdjustHandler(e,p),this.state.uilState}},{key:"onEnd",value:function(e,t){"mouseup"===e.type&&_.isPad&&this.workspace.enableScroll();var n=t.pos;return this.state.pos.x===n.x&&this.state.pos.y===n.y&&(this.state.uilState=re.a.DONE,this.endSetAdjustHandler()),this.state.uilState}},{key:"beginSetAdjustHandler",value:function(e,t){this.manager.startOperation("setAdjustHandler"),"mousedown"===e.type&&_.isPad&&this.workspace.disableScroll(),this.workspace.drawingAdjustHandler.update(a()({showAdjustHandler:!0},t))}},{key:"endSetAdjustHandler",value:function(e){this.manager.finishOperation("setAdjustHandler"),e&&window.APP.editor.picture.setAdjustHandle(e),this.workspace.drawingAdjustHandler.update({showAdjustHandler:!1})}},{key:"initialState",get:function(){return{uilState:re.a.DONE}}}],[{key:"matchTriggerConditions",value:function(e,t,n){var i=t.type;if(n&&n.type&&(n.type===x.b.TEXTBOX_PAGE||n.type===x.b.WATER_DROP))return!1;if(!n||!n.shapeInfo||!n.shapeInfo.isHitOnShape)return!1;var a=window.APP.formatContentController;return!(e.isReadOnly()||!e.api.isConnected()||a.isRestrictEditMode&&!a.checkIsInContentControl(n.position))&&(!(i!==ae.a.START||!n.type.startsWith("SHAPE_ADJUSTHANDLER_"))||void 0)}}]),t}(le.a);Qe.type=Ee.a.SHAPE_ADJUSTHANDLER,Qe.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:ce.default.shape.ON_SHAPE_BEGIN_SET_ADJUSTHANDLER,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.shape.ON_SHAPE_END_SET_ADJUSTHANDLER,target:Pe.a.window,flag:Pe.b.native}];var Je=Qe,Ze=n(240),$e=n(8845),et=n(4420),tt=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"_onLeftButtonClick",value:function(e){this.selection.setPosition(e,e,{isSend:!0}),this.state.uilState=re.a.DONE}},{key:"_onRightButtonClick",value:function(e,t){var n=this,i=t.shapeInfo,a=t.ctrlInfos,o=void 0===a?[]:a;o=o.filter(this.app.formatContentController.isOperableContentControl);var r=this._getContextMenuType(t,o);if(null===r)return ce.default.dispatchEvent(ce.default.names.DOC_CLOSE_CONTEXT_MENU),void(this.state.uilState=re.a.DONE);var s=void 0;if(r==$e.a.Text&&t.textbox&&!t.textbox.isEmbedding&&(e.shiftKey||e.ctrlKey)){var l=this.selection,c=l.selAlter.getAdaptedSelShapes(),u=l.activeShape;if(c.length>1||u&&!u.isEmbedding||l.selContext.shapeIdxPathOfTextbox&&!Object(De.b)(l.selContext.shapeIdxPathOfTextbox,t.shapeIdxPathOfTextbox)){r=$e.a.Shape;var d=t.textbox;i={id:d.id,gcp:d.anchor?d.anchor.pos:d.topShape.anchor.pos,isEmbedding:!1,shape:d,shapeTreeType:d.shape_tree_type,shapeIdxPath:d.shapeIdxPath},s=!0}}if(r===$e.a.Shape&&!t.shapeInfo.isEmbedding){var h=this.selection.selShapes;h&&!h[0].isEmbedding&&(e.shiftKey||e.ctrlKey)&&(s=!0),h&&1===h.length&&h[0].isTopShape&&t.shapeInfo.shape.topShape===h[0]&&(t.shapeInfo.shape=h[0],t.shapeInfo.shapeIdxPath=h[0].shapeIdxPath,t.shapeInfo.shapeTreeType=t.shapeInfo.shape.shape_tree_type)}var p,f,g,v=null;switch(r){case $e.a.Table:var y=this.selection.selInfo.getSelectionInfo(),m=!y.inTable;this.workspace.toggleContainerPointerStyle(ue.cursorTypes.default),v=this._selectTableSubtype(y,t,m),r=this._isTableTypeChange(y,m,t)?$e.a.Text:r;break;case $e.a.Shape:var _=this.selection.selShapes;!e.shiftKey&&!e.ctrlKey&&_&&_.length>1&&(p=t.shapeInfo.shape,f=p.shapeIdxPath[0],(g=n.selection.selShapeIdxPaths)&&g.find((function(e){return e[0]===f})))||this.selection.selAlter.selectShape(i,{preventScroll:!0,shouldBlur:!0,isSelShapes:s});break;case $e.a.FormatContent:this.app.formatContentController.updateActiveControlInfoByHitResult(t);break;case $e.a.HyperLink:this.manager.sendCommandToModule(re.b.SELECTION,this.layer.moduleTypes.HYPERLINK,"onCommandResponseResetUILModule")}r!==$e.a.FormatContent&&r!==$e.a.Text&&r!==$e.a.HyperLink||this.manager.isTapOnSelection(t)||(this.selection.setPosition(t,t,{isSend:!0,updateOnly:!0}),Object(Ze.stopBubble)(e));var x=o[0],w=this._getData(r,t,x);ce.default.dispatchEvent(ce.default.names.DOC_SHOW_CONTEXT_MENU,{subType:v,data:w,type:r}),this.state.uilState=re.a.BLOCK}},{key:"_enterTableLink",value:function(e){return this.selection.selInfo.getHyperlink()&&this.manager.isTapOnSelection(e)}},{key:"_getData",value:function(e,t,n){var i=t.pos,a=this.workspace.getCurrentRect(),o=a.offsetTop-a.top,r=this.utils.adjustContextMenuPos(i.x,i.y,0,o),s=r.x,l=r.y,c=this.selection.selInfo.getSelectionInfo(),u=c.wholeCellSelected,d=c.rowSelected,h=c.columnSelected,p=c.rowCnt,f=c.columnCnt,g={position:{x:s,y:l},connected:this.app.api.isConnected()};return e!==$e.a.Shape||(g.isWebshape=t.isWebshape,g.webExtension=t.webExtension),g.hyperLink=this.selection.selInfo.getHyperlink(),e===$e.a.FormatContent&&(g.controller=n),e===$e.a.Text&&(g.autoNum=this.manager.editHandler.getAutoNumFormatOp()),e===$e.a.Table&&(g.autoNum=this.manager.editHandler.getAutoNumFormatOp(),g.row=p||1,g.column=f||1,g.isAllowMergeCells=this.manager.editHandler.isAllowMergeCells(!0),g.isAllowSplitCells=this.manager.editHandler.isAllowSplitCells(!0),g.isAllowRepeatRowHeader=this.manager.editHandler.isAllowRepeatRowHeader(!0),g.wholeSelected=u||d||h),g}},{key:"_selectTableSubtype",value:function(e,t,n){var i=e.tableSelected,a=e.wholeCellSelected;return n?"multiple":i?null:a?"cells":t.hyperLink?"hyperlink":t.hotSpot?"multiple":"text"}},{key:"_isTableTypeChange",value:function(e,t,n){var i=e.begin,a=e.end,o=i<=n.position&&a>n.position,r=this._outOfCellSelection(e,n),s=!1;return(!t&&r||t&&!o)&&(this.selection.setPosition(n,n,{isSend:!0,isClick:!0}),s=!0),!(s||!t)}},{key:"_outOfCellSelection",value:function(e,t){if(e.cells){var n=t.position;return!e.cells.some((function(e){return e.some((function(e){return e.begin<=n&&e.end>n}))}))}return!0}},{key:"_getContextMenuType",value:function(e,t){var n=null,i=this.app.data.doc.isTemplate;if(e.shapeInfo&&e.shapeInfo.isHitOnShape)return $e.a.Shape;if(t.length&&!i){var a=t[0];if(!(e.isInTable&&e.tableInfos&&e.tableInfos.tableRange&&e.tableInfos.tableRange.begin>a.begin))return n=$e.a.FormatContent}return e.hyperLink&&!e.isInTable?n=$e.a.HyperLink:e.isInTable?n=$e.a.Table:e.isInTable?n:n=$e.a.Text}},{key:"_insert",value:function(e){var t=e.type,n=e.count,i=!0;switch(t){case S.TABLE_INSERT_TYPE.ROW_TOP:i=this.manager.editHandler.insertRowAbove(n);break;case S.TABLE_INSERT_TYPE.ROW_BOTTOM:i=this.manager.editHandler.insertRowBelow(n);break;case S.TABLE_INSERT_TYPE.COLUMN_LEFT:i=this.manager.editHandler.insertColumnLeft(n);break;case S.TABLE_INSERT_TYPE.COLUMN_RIGHT:i=this.manager.editHandler.insertColumnRight(n)}return i}},{key:"_delete",value:function(e){switch(e.type){case S.TABLE_DELETE_TYPE.COLUMN:this.manager.editHandler.deleteColumn();break;case S.TABLE_DELETE_TYPE.ROW:this.manager.editHandler.deleteRow();break;case S.TABLE_DELETE_TYPE.TABLE:this.manager.editHandler.deleteTable()}}},{key:"_mergeCells",value:function(){this.manager.editHandler.mergeTableCells()}},{key:"splitCells",value:function(){this.manager.editHandler.splitTableCells()}},{key:"handleColumnInsertLimited",value:function(){this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.localUil.columnInsertLimit", "The column width is too small and the content cannot be added"))}},{key:"onGestureEvent",value:function(e,t){var n=this,i=e.type,a=e.event;if(i===ae.a.START)switch(a.button){case oe.b.LEFT:this._onLeftButtonClick(t);break;case oe.b.RIGHT:this._onRightButtonClick(a,t)}return i===ae.a.LONG_TAP&&"touchstart"===a.type&&(e.event.preventDefault(),_.isPad&&!_.isIPad?(this.app.blurInput(),setTimeout((function(){n._onRightButtonClick(a,t)}),32)):this._onRightButtonClick(a,t)),this.state.uilState}},{key:"onCustomEvent",value:function(e){var t=e.type,n=e.detail,i=e.detail&&e.detail.hyperLink;switch(t){case ce.default.hyperLink.ON_LINK_INSERT:this.selection.selAlter.adjustLinkSelection(),ce.default.dispatchEvent(ce.default.hyperLink.ON_LINK_MODAL_SWITCH,{linkInsertEnterType:et.a.COMTEXT_MENU}),this.state.uilState=re.a.DONE;break;case ce.default.hyperLink.ON_LINK_DELETE:this.manager.editHandler.deleteHyperlink(i),this.state.uilState=re.a.DONE;break;case ce.default.hyperLink.ON_LINK_OPEN:this.manager.editHandler.navigateByHyperlink(i),this.state.uilState=re.a.DONE;break;case ce.default.hyperLink.ON_LINK_EDIT:ce.default.dispatchEvent(ce.default.hyperLink.ON_LINK_MODAL_SWITCH,{hyperLink:i}),this.state.uilState=re.a.DONE;break;case ce.default.hyperLink.ON_LINK_SELECT:this.manager.editHandler.selectHyperlink(i),this.state.uilState=re.a.DONE;break;case ce.default.webshape.SWITCH_TO_LINK:this.manager.editHandler.switchToLink(i),this.state.uilState=re.a.DONE;break;case ce.default.webshape.ON_WEBSHAPE_INSERT:this.manager.editHandler.insertWebshape(i),this.state.uilState=re.a.DONE;break;case ce.default.hyperLink.SWITCH_TO_WEBSHAPE:this.manager.editHandler.switchToWebshape(i),this.state.uilState=re.a.DONE;break;case ce.default.cooperation.ON_CONVENE_INITIATE:this.state.uilState=re.a.DONE,!_.isPad&&this.workspace.focusWithoutScroll();break;case ce.default.names.DOC_RELEASE_CONTEXT_MENU:this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_INSERT:var a=this._insert(n);a&&a.columnInsertLimited&&this.handleColumnInsertLimited(),this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_DELETE:this._delete(n),this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_MERGE_CELLS:this._mergeCells(),this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_SPLIT_CELLS:this.splitCells(),this.state.uilState=re.a.DONE;break;case ce.default.footnoteEndnote.ON_FOOTNOTE_SETTING_CT:ce.default.dispatchEvent(ce.default.footnoteEndnote.ON_NOTE_SETTING_DIALOG_SWITCH,{on:!0,noteType:0}),this.state.uilState=re.a.DONE;break;case ce.default.footnoteEndnote.ON_ENDNOTE_SETTING_CT:ce.default.dispatchEvent(ce.default.footnoteEndnote.ON_NOTE_SETTING_DIALOG_SWITCH,{on:!0,noteType:1}),this.state.uilState=re.a.DONE}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.BLOCK}}}],[{key:"_isWaterDropHandle",value:function(e){return!(!e.target||"string"!=typeof e.target.className)&&-1!==e.target.className.indexOf("water-drop-icon")}},{key:"_isInTableResizing",value:function(e){var t=e.uilManager.getModuleState(re.b.SELECTION,"TABLE");return t&&t.isResizing}},{key:"matchTriggerConditions",value:function(e,n,i){if(Object(Ie.hasQuery)("template"))return!1;var a=n instanceof Event?n:n.event,o=a.button===oe.b.RIGHT,r=n.type===ae.a.LONG_TAP&&"touchstart"===n.event.type,s=t._isWaterDropHandle(a),l=r&&(i.type!==x.b.WATER_DROP||!s);return!(r&&i.type===x.b.WATER_DROP&&!s&&t._isInTableResizing(e))&&(!(!i||!o&&!l)&&(!i.type.startsWith("SHAPE_RESIZE_")&&!i.type.startsWith("SHAPE_ADJUSTHANDLER_")))}}]),t}(le.a);tt.type=Ee.a.CONTEXT_MENU,tt.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture}].concat(r()(_.isPad?[{type:ae.a.LONG_TAP,target:Pe.a.view,flag:Pe.b.gesture}]:[]),[{type:"keydown",target:Pe.a.input,flag:Pe.b.native},{type:ce.default.hyperLink.ON_LINK_INSERT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.hyperLink.ON_LINK_DELETE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.hyperLink.ON_LINK_OPEN,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.hyperLink.SWITCH_TO_WEBSHAPE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.hyperLink.ON_LINK_EDIT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.hyperLink.ON_LINK_SELECT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.cooperation.ON_CONVENE_INITIATE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_RELEASE_CONTEXT_MENU,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_INSERT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_DELETE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_MERGE_CELLS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SPLIT_CELLS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.footnoteEndnote.ON_FOOTNOTE_SETTING_CT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.footnoteEndnote.ON_ENDNOTE_SETTING_CT,target:Pe.a.window,flag:Pe.b.native}]);var nt=tt,it=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"onStart",value:function(e,t){var n=t.position,i=t.isInTable,a=t.isInTextbox,o=t.shapeInfo,r=t.isTranspose,s=t.isInComment;this.changeParagraphSettingPos(n);var l=t.line.papx.getPropVal("bidi");if(!(i||o&&o.isHitOnShape&&!o.isEmbedding||a||r||l)){if(s)return this.selection.selContext.isParagraphSetting=!1,ce.default.dispatchEvent(ce.default.names.ON_EXIT_PARAGRAPH_SETTING_MODE),void(this.state.uilState=re.a.DONE);var c=this.data.selection.getNormalRange(),u=c.pos,d=c.len,h=this.data.doc.textStream.getPapx(n);h.good&&(d>0&&h.pos>=u+d||0===d&&h.pos>u||h.pos+h.len<=u)&&this.selection.setPosition(h.pos,h.pos+h.len,{preventFocus:!0,isSend:!0,isClick:!0,isManualRangeSelect:!0,applyFormat:!0})}}},{key:"onGestureEvent",value:function(e,t){return e.type===ae.a.START&&this.onStart(e,t),this.state.uilState}},{key:"onEnterParagraphSettingMode",value:function(){var e=this.selection,t=e.begin,n=e.end,i=n.position>t.position&&n.glyphTail?n.position-1:n.position;this.data.doc.isTemplate||(this.workspace.getFormatContentManager().showAll=!1,this.formatContentController.clearActiveControls()),this.changeParagraphSettingPos(i),window.APP.data.selection.selContext.isParagraphSetting=!0,this.selection.selAlter.selectParagraph(i,{isSend:!0,isClick:!0,preventScroll:!1,preventFocus:!0,isManualRangeSelect:!0}),this.state.uilState=re.a.BLOCK}},{key:"onExitParagraphSettingMode",value:function(e){var t=this.selection.end;if(window.APP.data.selection.selContext.isParagraphSetting=!1,this.data.doc.getSubDocType(t.position)===A.MainText&&!e){var n=this.data.selection.getNormalRange(),i=n.pos,a=n.len;this.state.pos>=i&&this.state.pos<=i+a?this.selection.setPosition(this.state.pos,void 0,{isSend:!0,isClick:!0}):this.selection.setPosition(i+a-1,void 0,{isSend:!0,isClick:!0})}this.state.uilState=re.a.DONE}},{key:"changeParagraphSettingPos",value:function(e){this.state.pos=e}},{key:"onCustomEvent",value:function(e,t){var n=e.type,i=e.detail;switch(n){case ce.default.names.ON_ENTER_PARAGRAPH_SETTING_MODE:this.onEnterParagraphSettingMode();break;case ce.default.names.ON_EXIT_PARAGRAPH_SETTING_MODE:this.onExitParagraphSettingMode(i.noLocate)}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.BLOCK,pos:0}}}],[{key:"matchTriggerConditions",value:function(e,t,n){return t.type===ce.default.names.ON_ENTER_PARAGRAPH_SETTING_MODE}}]),t}(le.a);it.type=Ee.a.PARAGRAPH_SETTING,it.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:"keydown",target:Pe.a.input,flag:Pe.b.native},{type:ce.default.names.ON_ENTER_PARAGRAPH_SETTING_MODE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.ON_EXIT_PARAGRAPH_SETTING_MODE,target:Pe.a.window,flag:Pe.b.native}];var at=it,ot=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"_onLeftButtonClick",value:function(e,n){var i=this,a=n.tickCharInfo;if(a&&a.isInTickChar){var o=window.APP.editor,r=a.gcp,s={isSend:!0,applyFormat:!0,isClick:!0},l=t.tickCharReplaceMap[a.uCode];a.isTextSymbol?l&&(this.selection.setPosition(r+1,r+1,s),o.setSymbolChar(l.uCode,{pos:r,len:1})):(this.data.selection.setPosition(r,r+1,s),l&&o.insertSymbol({charcode:l.uCode,fontName:l.font})),setTimeout((function(){i.workspace.focusWithoutScroll()}),100),this.state.uilState=re.a.DONE}}},{key:"onGestureEvent",value:function(e,t){var n=e.type,i=e.event;return n!==ae.a.START||i.button!==oe.b.LEFT&&"touchstart"!==i.type||this._onLeftButtonClick(i,t),this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.DONE}}}],[{key:"matchTriggerConditions",value:function(e,t,n){if(Object(Ie.hasQuery)("template"))return!1;var i=t instanceof Event?t:t.event,a=t.type,o=i.button;return(n||{}).type===b.a.TICKCHAR&&!(a!==ae.a.START||!(o===oe.b.LEFT||_.isPad&&"touchstart"===t.event.type))}}]),t}(le.a);ot.type=Ee.a.TICKCHAR,ot.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture}],ot.tickCharReplaceMap={9633:{uCode:82,font:"Wingdings 2"},168:{uCode:254,font:"Wingdings"},61608:{uCode:254,font:"Wingdings"},111:{uCode:254,font:"Wingdings"},61551:{uCode:254,font:"Wingdings"},163:{uCode:82,font:"Wingdings 2"},61603:{uCode:82,font:"Wingdings 2"},42:{uCode:82,font:"Wingdings 2"},61482:{uCode:82,font:"Wingdings 2"},82:{uCode:163,font:"Wingdings 2"},61522:{uCode:163,font:"Wingdings 2"},254:{uCode:168,font:"Wingdings"},61694:{uCode:168,font:"Wingdings"},9745:{uCode:163,font:"Wingdings 2"}};var rt=ot,st=n(1238),lt=n(2009),ct=n(3684),ut=void 0,dt=void 0,ht=0,pt=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this)}},{key:"onGestureEvent",value:function(e,t){switch(e.type){case ae.a.DOUBLE_TAP:this._onDoubleTap(t);break;default:this.state.uilState=re.a.DONE}return this.state.uilState}},{key:"_onDoubleTap",value:function(e){var t=this;this.state.uilState=re.a.DONE;var n=e.glyphGroupInfo,i=e.position;e.glyphTail&&--i;var a=Object(ct.a)(n),o=a.isFootnote;if(a.isPlaceHolder){var r=this.data.doc.footnoteBodys.getRefByPos(i)||this.data.doc.endnoteBodys.getRefByPos(i);if(r){var s=r.pos+1;Object(st.typoToPositionWithLoading)(s).then((function(){window.APP.data.selection.setPosition(s,s),t.startBlink({pos:s-1,len:1}),window.APP.workspace.makesureCursorVisible(!0)}))}}else{var l=o?this.data.doc.footnotes.getNote(i):this.data.doc.endnotes.getNote(i);if(l){var c=l.body.pos+1;Object(st.typoToPositionWithLoading)(c).then((function(){window.APP.data.selection.setPosition(c,c),t.startBlink({pos:c-1,len:1}),window.APP.workspace.makesureCursorVisible(!0)}))}}}},{key:"startBlink",value:function(e){dt=e,ht&&clearTimeout(ht),ut=3,this.showHighLight()}},{key:"showHighLight",value:function(){var e=this;if(dt.len>0&&ut>0){--ut;var t={ranges:[Object.assign({color:"rgb(85,165,255)"},dt)],time:500};dt.cells&&dt.cells.length>0&&(dt.cells.forEach((function(e){e.color="rgb(85,165,255)"})),t.ranges=dt.cells),ce.default.dispatchEvent(lt.a.HIGHLIGHT.BLINK,{affair:"blink",params:t}),ht=setTimeout((function(){return e.showHighLight()}),1e3)}else ht=0}}],[{key:"matchTriggerConditions",value:function(e,t,n){var i=t.type,a=n&&n.glyphGroupInfo;return!(i!==ae.a.DOUBLE_TAP||!a||!Object(ct.a)(a))}}]),t}(le.a);pt.type=Ee.a.NOTES,pt.events=[{type:ae.a.DOUBLE_TAP,target:Pe.a.view,flag:Pe.b.gesture}];var ft,gt=pt,vt=function(e){function t(e,n){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return v()(t,e),u()(t,[{key:"loadModules",value:function(e){return this.modules.get(e)||this.modules.set(e,new t.modulesMap[e](this,this.app,this.manager)),!0}}],[{key:"matchTriggerConditions",value:function(e,n,i){var a=null;return i&&i.isInComment?null:(Object.keys(t.modulesMap).some((function(o){if(t.modulesMap[o].matchTriggerConditions(e,n,i))return a=o,!0})),a)}}]),t}(se.a);vt.modulesMap=(ft={},$()(ft,at.type,at),$()(ft,Fe.type,Fe),$()(ft,Oe.type,Oe),$()(ft,nt.type,nt),$()(ft,Ae.type,Ae),$()(ft,ze.type,ze),$()(ft,rt.type,rt),$()(ft,gt.type,gt),$()(ft,Ve.type,Ve),$()(ft,Je.type,Je),ft),vt.eventList=se.a.getEventList(vt);var yt=vt,mt=n(8846),_t=(b.a.TEXT,b.a.TABLE_TEXT,b.a.TEXTFRAME,b.a.TASK_LIST,b.a.COOPER_SELECTION,b.a.HYPERLINK,b.a.TABLE_HYPERLINK,b.a.TEXTBOX_PAGE,new Map([[b.a.DEFAULT,{default:ue.cursorTypes.default}],[b.a.SCROLLBAR,{default:ue.cursorTypes.default}],[b.a.SELECTION,{default:ue.cursorTypes.default}],[b.a.TEXT,{default:ue.cursorTypes.text}],[b.a.TEXT_FOOTENDNOTE_PLACEHOLDER,{default:ue.cursorTypes.footnote_placeholder}],[b.a.COOPER_SELECTION,{default:ue.cursorTypes.text}],[b.a.TASK_LIST,{default:ue.cursorTypes.hand,readonly:ue.cursorTypes.text}],[b.a.TABLE_TEXT,{default:ue.cursorTypes.text}],[b.a.TABLE_HYPERLINK,{default:ue.cursorTypes.text,readonly:ue.cursorTypes.hand}],[b.a.TABLE_CELL_SELECT,{default:ue.cursorTypes.cell_select,readonly:ue.cursorTypes.text}],[b.a.TABLE_ROW_SELECT,{default:ue.cursorTypes.row_select,readonly:ue.cursorTypes.text}],[b.a.TABLE_COLUMN_SELECT,{default:ue.cursorTypes.col_select,readonly:ue.cursorTypes.text}],[b.a.TABLE_ROW_RESIZE,{default:ue.cursorTypes.ns_resize,readonly:ue.cursorTypes.text}],[b.a.TABLE_COLUMN_RESIZE,{default:ue.cursorTypes.ew_resize,readonly:ue.cursorTypes.text}],[b.a.SHAPE,{default:ue.cursorTypes.move,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.COOPER_SELECTION_SHAPE,{default:ue.cursorTypes.move,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_TL,{default:ue.cursorTypes.nw_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_TM,{default:ue.cursorTypes.n_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_TR,{default:ue.cursorTypes.ne_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_RM,{default:ue.cursorTypes.e_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_BR,{default:ue.cursorTypes.se_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_BM,{default:ue.cursorTypes.s_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_BL,{default:ue.cursorTypes.sw_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.SHAPE_RESIZE_LM,{default:ue.cursorTypes.w_resize,readonly:ue.cursorTypes.default,limited:ue.cursorTypes.default}],[b.a.HYPERLINK,{default:ue.cursorTypes.text,readonly:ue.cursorTypes.hand}],[b.a.TEXTBOX_PAGE,{default:ue.cursorTypes.text}],[b.a.TEXTFRAME,{default:ue.cursorTypes.text}],[b.a.TICKCHAR,{default:ue.cursorTypes.default,readonly:ue.cursorTypes.text}]]));var xt=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){if(n&&this.isRestrictEditMode){if(!this.checkIsInContentControl(n.position)&&this.checkIsOutTextFormField())return this.initialState.uilState;if(n.isInTable){var i=n.tableInfos.tableRange,a=n.ctrlInfos[0],o=a.begin,r=a.end;if(o>=i.begin&&r<i.end)return this.initialState.uilState}}return f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"getCursorMapParams",value:function(e){return{isReadOnly:this.app.isReadOnly(),isLimited:this.app.isWebMode()&&e.shapeInfo&&!e.shapeInfo.isEmbedding}}},{key:"onMouseEvent",value:function(e,t){if("mousemove"===e.type){var n=t.shapeResizeType?t.shapeResizeType:t.type;if(n===b.a.TEXT||n===b.a.TABLE_TEXT){var i=t&&t.glyphGroupInfo;i&&Object(ct.a)(i)&&!t.isFuzzyHit&&(n=b.a.TEXT_FOOTENDNOTE_PLACEHOLDER)}if(n!==this.state.hitResultType){var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.a.DEFAULT,t=arguments[1],n=_t.get(e)||{},i=void 0;switch(!0){case t.isReadOnly:i=n.readonly||n.default;break;case t.isLimited:i=n.limited||n.default;break;default:i=n.default}return i||ue.cursorTypes.default}(n,this.getCursorMapParams(t));this.workspace.toggleContainerPointerStyle(a),this.state.hitResultType=n}}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,hitResultType:""}}}]),t}(le.a);xt.events=[{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native}];var wt=xt,kt=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return n&&this.isRestrictEditMode&&!this.checkIsInContentControl(n.position)?this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"initState",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initState",this).call(this),this.tipHeight=22,this.updateDelay=100}},{key:"adjustCoopSelTipPos",value:function(e,t){var n=this.app.workspace.config.zoom,i=this.workspace.element.cacheDOMAttr,a=i.scrollLeft,o=i.scrollTop,r=i.rect,s=document.body.cacheDOMAttr.clientHeight-this.tipHeight,l=r.top,c=e+this.app.workspace.getZoomDiff()/n-a/n,u=t-o/n+l/n;return c<0&&(c=0),u>s&&(u=s),{left:c,top:u}}},{key:"isUpdateNeeded",value:function(e){return!this.state.pos||(!this.state.pos||e.left!==this.state.pos.left||e.top!==this.state.pos.top)}},{key:"show",value:function(e,t,n){this.workspace.coopSelTip.update(!0,e,t,n)}},{key:"hide",value:function(){if(this.state.visible){var e=this.state,t=e.pos,n=e.username,i=e.color,a=t.left,o=t.top;this.workspace.coopSelTip.update(!1,{left:a,top:o},n,i),this.state.visible=!1,this.state.pos=null}}},{key:"onMouseEvent",value:function(e,t){var n=e.type,i=e.target;if("mousemove"===n)if(t.type===b.a.COOPER_SELECTION){if(!this.app.isCooperationMode)return void this.hide();if(!this.checkIsInTextPage(i))return;var a=t.pos2layoutpage,o=t.username,r=t.color,s=this.adjustCoopSelTipPos(a.x,a.y),l=s.left,c=s.top,u=this.app.workspace.config.zoom;if(l*=u,c*=u,!this.isUpdateNeeded({left:l,top:c}))return;this.hide(),this.show({left:l,top:c},o,r),this.state.pos={left:l,top:c},this.state.color=r,this.state.visible=!0,this.state.username=o}else this.app.isCooperationMode&&this.hide();return this.state.uilState}},{key:"onWindowEvent",value:function(e,t){return"scroll"===e.type&&this.app.isCooperationMode&&this.hide(),this.state.uilState}},{key:"checkIsInTextPage",value:function(e){var t=e.ownerSVGElement,n="";return t&&"svg"===t.tagName?n=t.getAttribute("class"):"svg"===e.tagName&&(n=e.getAttribute("class")),!!/\btext-page\b/.test(n)}}]),t}(le.a);kt.events=[{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"scroll",target:Pe.a.workspaceElement,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native}];var bt=kt,Tt=n(12965),Ct=n.n(Tt),St=n(12966),Et=n.n(St),Pt=b.a.TABLE_COLUMN_RESIZE,Lt=b.a.TABLE_ROW_RESIZE,At=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.isSelectedIntactArea=function(){var e=a.state.selInfo,t=e.columnSelected,n=void 0!==t&&t,i=e.rowSelected,o=void 0!==i&&i,r=e.tableSelected,s=void 0!==r&&r,l=e.isCellsContinuous,c=n&&!s;return!(!n&&!o||s)&&(!!(void 0!==l&&l)&&!!a.isSelectedRegular(c))},a._throttleUpdateTableMenus=window.utils.Lodash.throttle((function(e){if(a.isTableNonEditable)a.hideOperationBox();else if((a.selection.selInfo&&a.selection.selInfo.getSelectionInfo()||{}).inTable){var t=a.selection,n=t.begin,i=t.end,o=(n.position<=i.position?n:i).pos,r=o.posX,s=o.posY+o.charHeight/2,l=a.manager.hit({type:ne.a.TABLE,pos:{x:r,y:s}});l.isInTable?(a.calcContextState(l),a.showOperationBox(),a.hideResizeHighlight()):a.hideOperationBox()}else a.hideOperationBox()}),80,{trailing:!0}),a.onMouseUpOutside=function(e){var t=a.state.backupHitResult;a.handleMouseUp(e,t),document.removeEventListener("mouseup",a.onMouseUpOutside)},a.attachMouseUpListener=function(){document.addEventListener("mouseup",a.onMouseUpOutside)},a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return[].concat(r()(t.events),r()(t.preferredEvents))}}]),u()(t,[{key:"execute",value:function(e,n){if(n&&this.isRestrictEditMode){if(!this.checkIsInContentControl(n.position))return this.initialState.uilState;if(n.isInTable){var i=n.tableInfos.tableRange,a=n.ctrlInfos[0],o=a.begin,r=a.end;if(o>=i.begin&&r<i.end)return this.initialState.uilState}}return f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"calcContextState",value:function(e){var t=e.tableInfos,n=e.hotSpot,i=e.type,o=t.table,r=t.tableProps,s=t.tableRange,l=t.tableLineRange,c=t.textLineRange,u=t.isBeginPartOfTable,d=t.isEndPartOfTable,h=t.rect,p=t.tOffsetXRange,f=t.resizeHighlightLength,g=h.tableRect,v=h.rowRect,y=h.rowRects,m=h.columnRects,_=h.viewOffset,x=this.workspace.config.zoom,w={width:this.data.typoinfo.width,height:this.data.typoinfo.height*x},k=this.app.isWebMode()?{top:0,bottom:w.height,left:0,right:this.data.typoinfo.width*x}:h.outerRect,b={left:g.left,top:g.top,width:g.size.width,height:g.size.height},T=g.size||{},C=this.state.highlightType||{};i===Pt?C.resize=S.TABLE_HIGHLIGHT_TYPE.COLUMN:i===Lt&&(C.resize=S.TABLE_HIGHLIGHT_TYPE.ROW);var E=this.selection.getNormalRange(),P=s&&E.pos>=s.begin&&E.pos+E.len<=s.end,L={pos:s.begin,len:s.end-s.begin},A=this.selection.selInfo.isWrapTable(L);this.state=a()({},this.state,{table:o,tableProps:r,textLineRange:c||this.state.textLineRange,tableLineRange:l||this.state.tableLineRange,tableRange:s||this.state.tableRange,size:T,hotSpot:n,rowRect:v,rowRects:y,columnRects:m,outerRect:w,layoutRect:k,viewOffset:_,highlightType:C,resizeHighlightLength:f,operationBoxPos:b,tOffsetXRange:p,isBeginPartOfTable:u,isEndPartOfTable:d,tablePos:s.begin,isSelInTable:P,isWrapTable:A})}},{key:"setTableHiddenTimeout",value:function(){var e=this;this.state.isTableMenusVisible&&!this.state.tableHiddenTimeout&&!this.state.isKeepActive&&(this.state.tableHiddenTimeout=setTimeout((function(){e.hideOperationBox(),e.state.tableHiddenTimeout=null}),S.TABLE_HIDDEN_TIMEOUT))}},{key:"clearTableHiddenTimeout",value:function(){this.state.tableHiddenTimeout&&(clearTimeout(this.state.tableHiddenTimeout),this.state.tableHiddenTimeout=null)}},{key:"setResizeHighlightTimeout",value:function(){var e=this;this.state.isTableMenusVisible&&!this.state.resizeHighlightTimeout&&(this.state.isResizeHighlighted?this.showResizeHighlight():this.state.resizeHighlightTimeout=setTimeout((function(){e.showResizeHighlight(),e.state.resizeHighlightTimeout=null}),S.TABLE_RESIZE_HIGHLIGHT_TIMEOUT))}},{key:"clearResizeHighlightTimeout",value:function(){this.state.resizeHighlightTimeout&&(clearTimeout(this.state.resizeHighlightTimeout),this.state.resizeHighlightTimeout=null)}},{key:"handleTableSelection",value:function(){var e=this.selection.selInfo.getSelectionInfo()||{},t=this.selection.getNormalRanges(),n=e.columnSelected,i=void 0!==n&&n,o=e.rowSelected,r=void 0!==o&&o,s=e.tableSelected,l=void 0!==s&&s,c=e.inTable,u=e.begin,d=e.end,h=e.wholeCellSelected,p=void 0!==h&&h,f=e.minLevel,g=this.state,v=g.table,y=g.tableRange,m=g.operationBoxPos,_=g.outerRect,x=g.layoutRect,w=g.size,k=g.tOffsetXRange,b=g.isBeginPartOfTable,T=g.isEndPartOfTable,C=g.rowRects,S=g.columnRects,E=g.viewOffset,P=f>1;P&&(i=!1,r=!1,l=!1);var L={ranges:t,rowSelected:r,columnSelected:i,tableSelected:l,cellSelected:!P&&(p||r||i)};if(c&&y&&u>=y.begin&&d<=y.end){var I=we(this.workspace,v,C,S,L);this.state.activeTableAreaRect=I.activeTableAreaRect,this.state.selInfo=e;var R=!this.state.isStartSelects&&this.isSelectedIntactArea(),O=v&&v.currentPageTableLines,M=O&&O[0].range.begin,D=this.data.doc.getSubDocType(M)===A.MainText;return this.state.canRowOrColDrag=R,this.workspace.tableFloatMenus.update({canRowOrColDrag:R,canTableDrag:D}),!i&&!r||l?(this.state.isTableMenusVisible=!0,this.state.isDecreaseBtnVisible=!1,this.workspace.tableFloatMenus.update(a()({selContext:L,operationBoxPos:m,layoutRect:x,viewOffset:E,outerRect:_,size:w,tOffsetXRange:k,isBeginPartOfTable:b,isEndPartOfTable:T},I,{isSelInTable:!0,showContextMenu:L.cellSelected,showDecreaseBtn:!1,showOperationBox:!0,isResizeLine:!1,isScroll:!1,currentTableBegin:y.begin})),!0):(this.showDecreaseBtn(e,a()({selContext:L},I)),!0)}return!1}},{key:"showOperationBox",value:function(){var e=this.state,t=e.operationBoxPos,n=e.layoutRect,i=e.outerRect,a=e.size,o=e.tOffsetXRange,r=e.isSelInTable,s=e.isBeginPartOfTable,l=e.isEndPartOfTable,c=e.rowRects,u=e.columnRects,d=e.viewOffset,h=e.table;if(!this.state.tableMenusVisibleDelay&&!this.handleTableSelection()){this.state.isTableMenusVisible=!0;var p=h&&h.currentPageTableLines,f=p&&p[0].range.begin,g=this.data.doc.getSubDocType(f)===A.MainText;this.workspace.tableFloatMenus.update({operationBoxPos:t,rowRects:c,columnRects:u,layoutRect:n,viewOffset:d,outerRect:i,size:a,tOffsetXRange:o,isBeginPartOfTable:s,isEndPartOfTable:l,isSelInTable:r,selContext:{rowSelected:!1,columnSelected:!1,tableSelected:!1},isResizeLine:!1,showOperationBox:!0,showDecreaseBtn:!1,showContextMenu:!1,currentTableBegin:f,canTableDrag:g})}}},{key:"hideOperationBox",value:function(){var e=this,t=this.state,n=t.isStartSelects,i=t.isStartDragRowCol;n||i||this.state.isTableMenusVisible&&(this.clearTableHiddenTimeout(),this.state.isTableMenusVisible=!1,this.state.isDecreaseBtnVisible=!1,this.state.isResizeHighlighted=!1,this.state.highlightState={showResizeHighlight:!1},this.state.tableMenusVisibleDelay=!0,this.state.isKeepActive=!1,this.workspace.tableFloatMenus.update({showOperationBox:!1,showDecreaseBtn:!1,highlightState:this.state.highlightState,isStartSelects:!1}),setTimeout((function(){e.state.tableMenusVisibleDelay=!1}),200),this.startSelectsFromBar(!1))}},{key:"hideResizeHighlight",value:function(){this.state.isTableMenusVisible&&this.state.isResizeHighlighted&&(this.state.isResizeHighlighted=!1,this.state.highlightState=a()({},this.state.highlightState,{showResizeHighlight:!1}),this.workspace.tableFloatMenus.update({showOperationBox:!0,isResizeLine:!1,highlightState:this.state.highlightState}))}},{key:"showResizeHighlight",value:function(){var e=this.state,t=e.highlightType,n=e.hotSpot,i=e.operationBoxPos,o=e.size,r=e.resizeHighlightLength,s=e.rowRect,l=e.layoutRect,c=e.isSelInTable,u=this.app.isWebMode()?this.workspace.config.zoom:1;if(t&&void 0!==t.resize&&n){var d={},h=void 0;t.resize===S.TABLE_HIGHLIGHT_TYPE.ROW?(d.top="bottom"!==n.key?n.top:n.bottom,h=(l.right-l.left)/u,s&&(d.left=s.left)):(d.left="right"!==n.key?n.left:n.right,d.top=Math.round(i.top),h=(l.bottom-l.top)/u),this.state.isResizeHighlighted=!0,this.state.highlightState=a()({},this.state.highlightState,{showResizeHighlight:!0,resizeHighlightPos:d,resizeHighlightType:t.resize,resizeHighlightLength:r,positionHighlightLength:h}),Number.isNaN(d.left)||Number.isNaN(d.top)||this.workspace.tableFloatMenus.update({showOperationBox:!0,highlightState:this.state.highlightState,isSelInTable:c,operationBoxPos:i,size:o})}}},{key:"showAdjustHighlight",value:function(){var e=this.state,t=e.operationBoxPos,n=e.layoutRect,i=e.size,a=this.workspace.container.cacheDOMAttr.scrollTop,o=this.workspace.config.zoom,r=n.top-a,s=(n.bottom-n.top)/(this.app.isWebMode()?o:1);this.workspace.tableFloatMenus.update({showAdjustHighlight:!0,adjustColumnInfo:{left:t.left,right:t.left+i.width,top:r,height:s}})}},{key:"hideAdjustHighlight",value:function(){this.workspace.tableFloatMenus.update({showAdjustHighlight:!1})}},{key:"setAdjustHighlightHiddenTimeout",value:function(){var e=this;setTimeout((function(){e.hideAdjustHighlight()}),S.TABLE_ADJUST_HIGHLIGHT_TIMEOUT)}},{key:"showDecreaseBtn",value:function(e,t){var n=e.topRects,i=e.leftRects,o=e.columnSelected,r=e.rowSelected,s=this.state,l=s.outerRect,c=s.operationBoxPos,u=s.size,d=s.tOffsetXRange,h=s.isBeginPartOfTable,p=s.isEndPartOfTable,f=s.rowRects,g=s.columnRects,v=s.viewOffset,y={};switch(!0){case o&&n instanceof Array:var m=Number.MAX_SAFE_INTEGER,_=0,x=n[0].top;n.forEach((function(e){m=Math.min(e.left,m),_+=e.width})),y.type=S.TABLE_HIGHLIGHT_TYPE.COLUMN,y.left=m+_/2,y.top=Math.max(x,t.activeTableAreaRect.top);break;case r&&i instanceof Array:var w=Number.MAX_SAFE_INTEGER,k=0,b=i[0].left;i.forEach((function(e){w=Math.min(e.top,w),k+=e.height})),y.type=S.TABLE_HIGHLIGHT_TYPE.ROW,y.left=b,y.top=w+k/2;break;default:return}this.state.isTableMenusVisible=!0,this.state.isDecreaseBtnVisible=!0,this.state.decreaseBtnPos=y;var T=r||o&&this.isSelectedRegular(!0);this.workspace.tableFloatMenus.update(a()({isBeginPartOfTable:h,isEndPartOfTable:p,decreaseBtnPos:y,outerRect:l,operationBoxPos:c,viewOffset:v,columnRects:g,rowRects:f,size:u,tOffsetXRange:d},t,{isSelInTable:!0,showContextMenu:t.selContext.cellSelected,showOperationBox:!0,showDecreaseBtn:T,isResizeLine:!1}))}},{key:"handleSelectByShortcut",value:function(e){var t=e.index,n=e.selectType,i=e.isContinuous,a=this.state,o=a.table,s=a.selInfo,l=void 0===s?{}:s,c=l.columnSelected,u=void 0!==c&&c,d=l.rowSelected,h=void 0!==d&&d,p=n===S.TABLE_HIGHLIGHT_TYPE.COLUMN;if(!u&&!h||u&&p||h&&!p){var f=u||h?ke(this.selection,o,p):[],g=[],v=f.indexOf(t);if(i)if(-1===v){var y=[].concat(r()(f),[t]),m=Math.min.apply(Math,r()(y)),_=Math.max.apply(Math,r()(y));g=Se(m,_)}else g=Se(f[0],t);0!==g.length&&this.select({type:n,index:g})}}},{key:"startDragRowCol",value:function(e){var t=e.isStart,n=e.dragType,i=void 0===n?"":n,a=e.mouseStartPos,o=void 0===a?{}:a,r=e.moveOutsideTable,s=void 0!==r&&r;if(this.state.isStartDragRowCol=t,t){var l=this.state,c=l.tablePos,u=l.table,d=u.isBeginPartOfTable,h=u.isEndPartOfTable,p=i===S.TABLE_HIGHLIGHT_TYPE.COLUMN,f=ke(this.selection,u,p),g={startIndex:f[0],endIndex:f[f.length-1]};this.state.isStartSelects=!1,this.state.curTable={selected:g,moveOutsideTable:s,dragType:i,isBeginPartOfTable:d,isEndPartOfTable:h,pos:c,startPos:o},this.attachMouseUpListener(),this.workspace.toggleContainerPointerStyle(ue.cursorTypes.grabbing)}else ce.default.dispatchEvent(ce.default.table.ON_TABLE_DRAG_END_COLUMN_OR_ROW),this.state.uilState=re.a.DONE;this.workspace.tableFloatMenus.update({isStartDragRowCol:t})}},{key:"isAllowed2Insert",value:function(e,t){if(e<0)return!1;var n=this.state,i=n.table,a=i.currentPageTableLines,o=i.wholeTableLines,r=n.rowRects,s=n.columnRects,l=n.curTable.selected,c=l.startIndex,u=l.endIndex;if(e>=c&&e<=u+1)return!1;if(0===e||e===(t?s:r).length)return!0;var d=e>u?e-1:e,h=!0,p=e<c;if(t){var f=a[0].tablecells[d];a.some((function(e,t){if(0!==t)return e.tablecells.some((function(e){if(p&&e.rect.right===f.rect.right&&e.rect.left<f.rect.left||!p&&e.rect.left===f.rect.left&&e.rect.right>f.rect.right)return h=!1,!0})),!h||void 0}))}else{var g=-1;(this.app.isWebMode()?o:a).some((function(e){var n=e.tablecells,i=k()(n,1)[0];if(-1!==g&&i.merge_type&&i.merge_type!==T.e.FIRST||g++,d===g&&n.some((function(e){if(i.merge_type===T.e.MIDDLE)return!0;var n=!(p||i.merge_type&&i.merge_type!==T.e.LAST||e.merge_type!==T.e.FIRST),a=e.merge_type===T.e.MIDDLE,o=p&&(!i.merge_type||i.merge_type===T.e.FIRST)&&e.merge_type===T.e.LAST;return!t&&(n||a||o)?(h=!1,!0):void 0})),!h)return!0}))}return h}},{key:"onDragRowCol",value:function(e,t){var n=!!this.state.curTable&&this.state.curTable.moveOutsideTable;if((t.isInTable||n)&&this.state.isStartDragRowCol&&this.isInSameTable()&&this.state.canRowOrColDrag){var i=this.state,a=i.curTable,o=i.rowRects,s=i.columnRects,l=i.operationBoxPos,c=i.activeTableAreaRect,u=i.table,d=a.dragType,h=a.startPos,p=u.wholeTableLines,f=u.isEndPartOfTable,g=this.workspace.getScaleValue(),v=this.workspace.getZoomDiff()-(window.APP.isWebMode()?this.workspace.horizontalCenterOffset:0),y=(c.left-v)/g,m=c.top/g,_=y+(c.right-c.left)/g,x=m+(c.bottom-c.top)/g,w=this.workspace.element.cacheDOMAttr,k=w.scrollTop,b=w.scrollLeft,T=(h.x-e.pageX-b)/g,C=(h.y-e.pageY-k)/g,E=d===S.TABLE_HIGHLIGHT_TYPE.COLUMN,P=[].concat(r()(E?s:o)),L=P[0];P.unshift({left:E?L.left+2:L.left,top:E?L.top:L.top+2,bottom:E?L.bottom:L.top,right:E?L.left:L.right,height:2,width:2});var A=_-y,I=x-m,R=y-T,O=m-C,M=l.left+l.width,D=l.top+l.height,N=R>M-A?M-A:R,B=E?R<l.left?l.left:N:y,j=O>D-I?D-I:O,F=E?m:O<l.top?l.top:j,H=C>0,G=T>0,U=-1;P.some((function(e,t){if(0===t)return!1;if(E)if(G){if(R<l.left)return U=0,!0;if(B>=e.left-(t>0?P[t-1].width*(1/4):0)&&B<=e.right-e.width*(1/4))return U=t-1,!0}else{if(R+A>M)return U=P.length-1,!0;var n=B+A;if(n>=e.left+e.width*(1/4)&&n<=e.right+(t===P.length-1?0:P[t+1].width*(1/4)))return U=t,!0}else if(H){if(O<l.top)return U=0,!0;if(F>=e.top-(t>0?P[t-1].height*(1/4):0)&&F<=e.bottom-e.height*(1/4))return U=t-1,!0}else{if(O+I>D)return U=P.length-1,!0;var i=F+I;if(i>=e.top+e.height*(1/4)&&i<=e.bottom+(t===P.length-1?0:P[t+1].height*(1/4)))return U=t,!0}}));var W=p.reduce((function(e,t){return e+t.rect.height}),0),Y={width:A,height:E?W:I,left:B,top:E&&f?F-(W-I):F},z=this.isAllowed2Insert(U,E)?U:-1;this.state.curTable.insertIndex=z,ce.default.dispatchEvent(ce.default.table.ON_TABLE_DRAG_COLUMN_OR_ROW,{columnRects:E?P:s,rowRects:E?o:P,boxPos:l,dragType:d,insertIndex:z,previewRect:Y,offsetX:T,offsetY:C})}}},{key:"updateColumnHeightMap",value:function(e,t){var n=0,i=0,a=[].concat(r()(t));if(a.some((function(t,a){if(e.left>=t.left&&(n=a),e.right<=t.right)return i=a,!0})),n===i)e.left===a[n].left&&e.mergeType!==T.e.MIDDLE&&e.mergeType!==T.e.LAST&&(a[n].height+=e.height);else{a[i].left=a[n].left;for(var o=a[n].height,s=n+1;s<=i;s++)a[s].height>o&&(o=a[s].height);a[i].height=Math.max(o,a[i].height+e.height),a.splice(n,i-n)}return a}},{key:"isSelectedRegular",value:function(e){var t=this,n=this.state,i=n.selInfo,a=n.activeTableAreaRect,o=n.table;if(!a)return!1;var r=i.idxs,s=void 0===r?[]:r,l=i.rows,c=void 0===l?[]:l,u=i.inTable,d=void 0!==u&&u,h=i.cells;if(!d||s.length*c.length==0)return!1;var p=!0;if(e){var f=[];s.some((function(e,t){var n={pos:h[t][0].begin,len:h[t][0].end-h[t][0].begin},i=Ce(n,o,!1);if(i){var a=i.tablecells,r={top:0,bottom:0,width:0,left:0},s=f[f.length-1];if(e.some((function(e,t){var n=a[e],o=Te(n,i),s=o.top,l=o.left,c=o.width,u=s+o.height;0===t?r={top:s,bottom:u,width:c,left:l}:(r.top=Math.min(s,r.top),r.width+=c,r.bottom=Math.max(u,r.bottom))})),0!==t&&r.top>s.top&&r.top<s.bottom)return s.top=Math.min(r.top,s.top),s.width=Math.max(r.width,s.width),s.bottom=Math.max(r.bottom,s.bottom),!1;f.push(r)}})),f.some((function(e,t){if(0===t)return!1;var n=f[0].width;return Math.abs(e.width-n)>=1?(p=!1,!0):void 0}))}else{var g=[];s.some((function(e,n){var i={pos:h[n][0].begin,len:h[n][0].end-h[n][0].begin},a=Ce(i,o,!1);if(a){var r=a.tablecells;e.some((function(e){var i=r[e],o=Te(i,a),s=o.left,l=o.width,c=o.height,u=s+l,d={left:s,right:u,height:c,mergeType:i.merge_type};if(0===n){var h=i.merge_type===T.e.LAST||d.mergeType===T.e.MIDDLE?0:c;g.push({left:s,right:u,height:h})}else g=t.updateColumnHeightMap(d,g)}))}})),g.some((function(e,t){if(0===t)return!1;var n=g[0].height;return Math.abs(e.height-n)>=1?(p=!1,!0):void 0}))}return p}},{key:"getInsertPos",value:function(e,t){var n=this,i=this.state,a=i.table,o=a.currentPageTableLines,r=a.wholeTableLines,s=t>i.curTable.selected.endIndex,l=s?t-1:t,c=null;if(e){var u=o[0].tablecells[l];c=u.cell_page.range.pos}else{var d=0;(this.app.isWebMode()?r:o).some((function(e){var t=k()(e.tablecells,1)[0],i=t.merge_type===T.e.FIRST,a=t.merge_type===T.e.MIDDLE||t.merge_type===T.e.LAST;if(0===d||!a){if(d===l){var o=e.range,r=o.begin,u=o.end;if(s&&i){var h=be(t);if(h&&h.parent){var p=h.parent;c=p.range.begin}}else if(a){var f=Object(P.getFirstMergedCell)(n.data.doc,r,u,0).tapx;c=f.begin}else c=r;return!0}d++}return!1}))}return c}},{key:"afterDragRowCol",value:function(e,t,n){var i=this,a=this.selection.getNormalRanges(),o=this.data.doc.getDataLogic("final").specTable.getTapx(t).end;return function(r){if(r.success){var s=i.state,l=s.curTable,c=s.tableProps,u=s.columnRects,d=a.sort((function(e,t){return e.pos-t.pos}))[0],h=l.selected.startIndex,p=e<h;if(n){var f=k()(c,1)[0].cellDatas,g=e===u.length?f[f.length-1].end-d.len:f[e].begin-d.len,v=p?f[e].begin:g,y=v+d.len-1,m=Object(P.collectColumns)(i.data.doc,v,y,1).ranges;i.selection.setRanges(m,{isSend:!0,preventScroll:!0,applyFormat:!0})}else{var _=p?t:o-d.len,x=_+d.len;if(_<0||x<0)return;i.selection.setPosition(_,x,{isSend:!0,preventScroll:!0,applyFormat:!0})}}}}},{key:"onDragEndRowCol",value:function(){if(this.startDragRowCol(!1),this.state.canRowOrColDrag&&this.isInSameTable()){var e=this.state.curTable,t=e.insertIndex,n=e.dragType;if(-1===t||void 0===t)return;var i=n===S.TABLE_HIGHLIGHT_TYPE.COLUMN,a=this.getInsertPos(i,t),o={insertPos:a};this.manager.editHandler.moveTableOfRowOrCol(o,this.afterDragRowCol(t,a,i))}this.state.uilState=re.a.DONE}},{key:"startMoveTable",value:function(e){if(this.state.isStartMoveTable=e,this.workspace.tableFloatMenus.update({isStartMoveTable:e}),e){var t=this.state,n=t.size,i=t.tableRange,a=t.table,o=t.isWrapTable;this.state.curTable={size:n,isWrapTable:o,range:i,rect:a.currentPageTableRect},this.attachMouseUpListener(),this.data.selection.selAlter.selectTable(i.begin,!0)}else ce.default.dispatchEvent(ce.default.table.ON_TABLE_MOVING_EDIT_MODE_END),this.state.uilState=re.a.DONE}},{key:"hitPos2PagePos",value:function(e){var t=e.x,n=e.y,i=this.workspace.getScaleValue(),a=this.workspace.element.cacheDOMAttr,o=a.scrollTop;return{pageX:t*i-a.scrollLeft+this.workspace.getZoomDiff(),pageY:n*i+100-o}}},{key:"getPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.pos,i=n.x,a=n.y,o=this.getMenuBtnOffset,r=this.state.curTable.size,s={left:i+o.x,top:a+o.y,right:i+o.x+r.width,bottom:a+o.y+r.height},l={},c={},u=this.app.isWebMode();if(u){var d=this.app.data.typoinfo,h=d._viewOffset,p=d.size;c=l={left:h.x,top:h.y,width:p.width,height:p.height}}else{var f=this.app.data.typoinfo.outer_rects;c=f[0];var g=this.selection.selInfo.getCurrentWordInfo(),v=g.pageIndex;l=f[v-1],f.some((function(e){return s.top<=e.top+e.height&&(l=e,!0)}))}var y=l.left,m=l.left+l.width,_=s.right>m?m-r.width:s.left,x=r.width>l.width,w={x:x||s.left<y?y:_,y:s.top<c.top?c.top:s.top},k={x:w.x-o.x,y:w.y-o.y},b=this.hitPos2PagePos(k);return t?this.manager.getPosByEvent(b):b}},{key:"isAllowed2Pass",value:function(e){var t=e||{},n=t.ctrlInfos,i=t.catalogInfos,a=t.line,o=t.type,r=a||{},s=r.isInTable,l=r.isOMathPara,c=o===b.a.HYPERLINK,u=n&&n.length>0?n[0]:{},d=u.isDate,h=u.isDropdownList,p=u.isRichText,f=this.manager.getModule(re.b.SELECTION,Ee.a.CATALOG),g=i&&i.length>0||f.isHitOnHotSpot(e,!1);return!(s||c||l||d||h||p||g)}},{key:"locateCursor",value:function(e){this.isAllowed2Pass(e)&&this.data.selection.setPosition(e,null,{updateOnly:!0})}},{key:"onDragTable",value:function(e,t){this.hideOperationBox(),this.state.backupHitResult=t;var n=this.state.curTable.size;ce.default.dispatchEvent(ce.default.table.ON_TABLE_MOVING_EDIT_MODE,{size:n,position:this.getPos(t),zoom:this.workspace.getScaleValue()}),"mousemove"===e.type&&_.isPad&&this.workspace.disableScroll(),this.workspace.toggleContainerPointerStyle(ue.cursorTypes.grabbing),this.locateCursor(t),this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(e)}},{key:"isAllowed2Move",value:function(){var e=this.selection.selInfo.isInTable(),t=this.selection.inOMath,n=this.selection.selInfo.isHitOnCtrl(),i=n.isHitOnDatetime,a=n.isHitOnDropList,o=n.isHitOnRichText,r=this.selection.activeCatalogs&&this.selection.activeCatalogs.length>0;return!(e||t||i||a||o||r)}},{key:"selectFirstCell",value:function(e){var t=this.selection.begin.position-e;this.selection.setPosition(t)}},{key:"onDragEndTable",value:function(e,t){var n=this;this.startMoveTable(!1),["mouseup","mousemove","touchend"].includes(e.type)&&_.isPad&&this.workspace.enableScroll();var i=this.selection.begin.position,a=this.state.curTable,o=a.range,r=o.begin,s=o.end,l=a.rect,c=a.isWrapTable;if(i!==r)if(this.isAllowed2Move()){var u=s-r,d=this.getPos(t,!0),h=this.getMenuBtnOffset,p=d.x+h.x-l.left,f=d.y+h.y-l.top,g=Math.round(Object(R.Px2Ti)(p)),v=Math.round(Object(R.Px2Ti)(f)),y={len:u,insertPos:i,xOffset:g,yOffset:v,isWrapTable:c,pos:r};this.manager.editHandler.moveTable(y,(function(){return n.selectFirstCell(u)}))}else this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.selectionUil.tableCanNotDragIntoCurrentCtrl", "You cannot insert a table into this object."));this.workspace.scrollerHelper&&this.workspace.scrollerHelper.clear(),this.workspace.toggleContainerPointerStyle(ue.cursorTypes.default),this.state.uilState=re.a.DONE}},{key:"startSelectsFromBar",value:function(e){if(this.state.isStartSelects=e,e){var t=this.state,n=t.tablePos,i=t.table,a=i.isBeginPartOfTable,o=i.isEndPartOfTable;this.state.curTable={pos:n,isBeginPartOfTable:a,isEndPartOfTable:o},this.attachMouseUpListener()}else this.state.selectType=null,this.showOperationBox(),this.state.uilState=re.a.DONE;this.workspace.tableFloatMenus.update({isStartSelects:e})}},{key:"getCurPositionInTable",value:function(e){var t=e.pos,n=this.state,i=n.columnRects,a=n.rowRects,o=n.table.currentPageTableRect,r=o.left,s=o.right,l=o.top,c=o.bottom,u=t.x,d=t.y;if(this.app.isWebMode()){var h=this.app.data.typoinfo._viewOffset;u-=h.x,d-=h.y}return u=u<r?r:u>s?s:u,d=d<l?l:d>c?c:d,{rowIndex:a.findIndex((function(e){return d>=e.top&&d<=e.bottom})),columnIndex:i.findIndex((function(e){return u>=e.left&&u<=e.right}))}}},{key:"isInSameTable",value:function(){var e=this.state,t=e.tablePos,n=e.curTable,i=e.table,a=n.pos,o=n.isBeginPartOfTable,r=n.isEndPartOfTable,s=a===t,l=this.app.isWebMode()||o===i.isBeginPartOfTable&&r===i.isEndPartOfTable;return s&&l}},{key:"selectFromBar",value:function(e){var t=this.state,n=t.selectIndex,i=t.selectType,a=t.isStartSelects;if((e.isInTable||i!==S.TABLE_HIGHLIGHT_TYPE.ROW)&&a&&this.isInSameTable()){var o=this.getCurPositionInTable(e),r=o.columnIndex,s=o.rowIndex,l=i===S.TABLE_HIGHLIGHT_TYPE.COLUMN?r:s,c=Array.isArray(n);if(!(n===l||c&&n[n.length-1]===l)){var u=c?n[0]:n,d={type:i,index:Se(u,l)};this.select(d)}}}},{key:"selectColumns",value:function(e){var t=this,n=this.state,i=n.columnRects,a=n.tableProps,o=n.table.wholeTableLines,s=Math.min.apply(Math,r()(e)),l=Math.max.apply(Math,r()(e)),c=i.length,u=l-s+1===e.length;if(u&&0===s&&l===c-1){var d=this.state.tablePos;this.data.selection.selAlter.selectTable(d,!0)}else{var h=k()(a,1)[0].cellDatas;if(u){var p=h[s].begin,f=h[l].begin,g=Object(P.collectColumns)(this.data.doc,p,f,1).ranges;this.selection.setRanges(g,{isSend:!0,preventScroll:!0,applyFormat:!0})}else{var v=[],y={inTable:!0,rowSelected:!1,cellsSelected:!0,columnSelected:!0,wholeCellSelected:!0};y.rowCnt=a.length,y.columnCnt=e.length,y.topRects=[],y.rows=a.map((function(e){return e.prop}));var m=[],_=[];[].concat(r()(e)).sort((function(e,t){return e-t})).forEach((function(n,i){var a=h[n].begin,o=Object(P.collectColumns)(t.data.doc,a,a,1),s=o.ranges,l=o.cells,c=o.idxs;v.push.apply(v,r()(s)),0===i?(y.begin=s[0].begin,m.push.apply(m,r()(JSON.parse(JSON.stringify(l)))),_.push.apply(_,r()(JSON.parse(JSON.stringify(c))))):(m.forEach((function(e,t){var n=[].concat(r()(e),r()(l[t]));m[t]=Ct()(n,Et.a)})),_.forEach((function(e,t){var n=[].concat(r()(e),r()(c[t]));_[t]=[].concat(r()(new Set(n)))}))),i===e.length-1&&(y.end=s[s.length-1].end)})),y.cells=m,y.idxs=_;for(var x=o[0],w=x.tablecells,b=x.viewPage,T=b.outer_rect,E=this.app.isWebMode(),L=E?C.a.transvertPositionFromNode2Target(x,b):C.a.getPosition2view(x),A=s;A<=l;A++){var I=w[A],R={left:(E?C.a.transvertPositionFromNode2Target(I,I.viewPage):C.a.getPosition2view(I)).x+T.left,top:L.y+T.top,width:I.rect.width,height:I.rect.height};y.topRects.push(R)}this.selection.setRanges(v,{isSend:!0,preventScroll:!0,applyFormat:!0},y)}setTimeout((function(){t.workspace.focusWithoutScroll()}),S.TABLE_FOCUS_TABLE_TIMEOUT)}}},{key:"selectRows",value:function(e){var t=this,n=this.state,i=n.table,a=i.currentPageTableLines,o=i.wholeTableLines,s=n.rowRects,l=Math.min.apply(Math,r()(e)),c=Math.max.apply(Math,r()(e)),u=s.length;if(c-l+1===e.length&&0===l&&(c===u||0===c&&c===u-1)){var d=this.state.tablePos;this.data.selection.selAlter.selectTable(d,!0)}else{var h=[];[].concat(r()(e)).sort((function(e,t){return e-t})).forEach((function(e){var n=-1;(t.app.isWebMode()?o:a).some((function(t){var i=t.tablecells,a=k()(i,1)[0];if(-1!==n&&a.merge_type&&a.merge_type!==T.e.FIRST||n++,e===n){var o=t.range,r=o.begin,s=o.end;h.push({begin:r,end:s})}}))})),this.selection.setRanges(h,{isSend:!0,preventScroll:!0,applyFormat:!0}),setTimeout((function(){t.workspace.focusWithoutScroll()}),S.TABLE_FOCUS_TABLE_TIMEOUT)}}},{key:"select",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=t.index;if(this.state.selectType){if(this.state.selectType!==n)return}else this.state.selectType=n;this.state.selectIndex=i;var a=this.state,o=a.tableProps,r=a.table,s=r.currentPageTableLines,l=r.wholeTableLines,c=a.columnRects,u=this.app.isWebMode(),d=Array.isArray(i);if(this.state.selectType===S.TABLE_HIGHLIGHT_TYPE.COLUMN){if(d)return void this.selectColumns(i);if(1===c.length&&0===i){var h=this.state.tablePos;return void this.data.selection.selAlter.selectTable(h,!0)}var p=k()(o,1),f=p[0],g=f.cellDatas,v=f.prop.table_row.bidi,y=g[v?g.length-i-1:i].begin,m=Object(P.collectColumns)(this.data.doc,y,y,1),_=m.ranges;this.selection.setRanges(_,{isSend:!0,preventScroll:!0,applyFormat:!0}),this.selection.clearActiveCtrls()}else if(this.state.selectType===S.TABLE_HIGHLIGHT_TYPE.ROW){if(d)return void this.selectRows(i);var x=0,w=u?l:s;w.some((function(t){var n=k()(t.tablecells,1)[0],a=t.range,o=n.merge_type===T.e.MIDDLE||n.merge_type===T.e.LAST;if(0===x||!o){if(x===i){var r=t.range,s=r.begin,c=r.end,d=t.viewPage,h={};h.begin=a.pos,h.end=a.pos+a.len,h.inTable=!0,h.rowSelected=!0,h.cellsSelected=!0,h.columnSelected=!1,h.rowCnt=1,h.columnCnt=t.tablecells.length,h.leftRects=[],h.tableSelected=1===l.length;var p=[],f=[];t.tablecells.forEach((function(e,t){var n=e.range;n&&(f.push(t),p.push(n?{begin:n.pos,end:n.pos+n.len}:{}))}));var g=e.data.doc.textStream.getPapxTbl().findNodeContainPos(h.end-1).prop;h.cells=[p],h.idxs=[f],h.rows=[g];var v=u?C.a.transvertPositionFromNode2Target(t,d):C.a.getPosition2view(t),y={left:v.x+(u?d.viewOffset.x:e.state.layoutRect.left),top:v.y+(u?d.viewOffset.y:e.state.layoutRect.top),width:n.rect.width,height:n.rect.height};if(h.leftRects.push(y),o){var m=Object(P.getFirstMergedCell)(e.data.doc,s,c,0).tapx;h.begin=m.begin,h.end=m.end,e.selection.setPosition(m.begin,m.end,{isSend:!0,preventScroll:!0,applyFormat:!0},h)}else e.selection.setPosition(s,c,{isSend:!0,preventScroll:!0,applyFormat:!0},h);return e.selection.clearActiveCtrls(),!0}x++}return!1}))}setTimeout((function(){e.workspace.focusWithoutScroll()}),S.TABLE_FOCUS_TABLE_TIMEOUT)}},{key:"selectAll",value:function(){var e=this,t={};_.isPad&&!_.isIPad?(window.APP.blurInput(),t.updateOnly=!0):setTimeout((function(){e.workspace.focusWithoutScroll()}),S.TABLE_FOCUS_TABLE_TIMEOUT);var n=this.state.tablePos;this.data.selection.selAlter.selectTable(n,!0,t),this.showOperationBox()}},{key:"insert",value:function(e){var t=e.type,n=e.index,i=this.state.table,a=i.currentPageTableLines,o=i.wholeTableLines,r=!0,s=0,l=-1;switch(t){case S.TABLE_INSERT_TYPE.ROW_BOTTOM:(this.app.isWebMode()?o:a).some((function(e,t){var i=e.tablecells||[],a=k()(i,1)[0],o=(a||{}).merge_type,r=o===T.e.MIDDLE||o===T.e.LAST;if(a&&r&&0!==t||++l,l===n)return s=e.range.pos,!0})),this.workspace.disableUpdate(),this.selection.setPosition(this.manager.editHandler.move2Outermost(s)),this.workspace.enableUpdate(),r=this.manager.editHandler.insertRowBelow(),window.collection("commandbar","click","quickbutton|table_InsertRow");break;case S.TABLE_INSERT_TYPE.COLUMN_RIGHT:s=o[0].tablecells[n].range.pos,this.workspace.disableUpdate(),this.selection.setPosition(this.manager.editHandler.move2Outermost(s)),this.workspace.enableUpdate(),r=this.manager.editHandler.insertColumnRight(),window.collection("commandbar","click","quickbutton|table_InsertColumn")}return this.workspace.focusWithoutScroll(),r}},{key:"delete",value:function(e){switch(e.type){case S.TABLE_DELETE_TYPE.COLUMN:this.manager.editHandler.deleteColumn(),window.collection("commandbar","click","quickbutton|table_DeleteColumns");break;case S.TABLE_DELETE_TYPE.ROW:this.manager.editHandler.deleteRow(),window.collection("commandbar","click","quickbutton|table_DeleteRows");break;case S.TABLE_DELETE_TYPE.TABLE:this.manager.editHandler.deleteTable(!0),window.collection("commandbar","click","quickbutton|table_DeleteTable")}}},{key:"mergeCells",value:function(){this.manager.editHandler.mergeTableCells()}},{key:"splitCells",value:function(){this.manager.editHandler.splitTableCells()}},{key:"adjustColumn",value:function(){var e=this,t=this.state.tableRange,n=t.begin,i={pos:n,len:t.end-n},a=this.data.doc.getDataLogic("final").specTable,o=a.collectTapxs(i.pos,i.len),r=o[0].prop.table_row,s=r.tableXPos,l=r.rgdxa,c=s,u=l[l.length-1]-l[0];this.manager.editHandler.autoAdjustColumn(i),setTimeout((function(){e.workspace.focusWithoutScroll();var t=a.collectTapxs(i.pos,i.len);if((t=t.filter((function(e){return!!e.prop}))).length===o.length){var n=t[0].prop.table_row,r=n.tableXPos,s=n.rgdxa,l=r,d=s[s.length-1]-s[0];l===c&&d===u&&(e.showAdjustHighlight(),e.setAdjustHighlightHiddenTimeout())}}),100)}},{key:"beginResizing",value:function(e){this.state.isResizing=!0,this.clearTableHiddenTimeout(),this.clearResizeHighlightTimeout(),e&&e.type===S.TABLE_HIGHLIGHT_TYPE.TABLE&&(this.state.resizeType=e.type,this.selectAll(),this.workspace.toggleContainerPointerStyle(ue.cursorTypes.select))}},{key:"endResizing",value:function(e){this.state.isResizing=!1;var t=e.size,n=e.offsetX,i=e.offsetY;if(this.state.resizeType===S.TABLE_HIGHLIGHT_TYPE.TABLE){if(this.workspace.scrollerHelper&&this.workspace.scrollerHelper.clear(),!n&&!i)return void this.app.focusInput();this.manager.editHandler.adjustTable(this.state.tablePos,n,i),this.state.size=t}}},{key:"keepActive",value:function(){this.state.isKeepActive=!0,this.clearTableHiddenTimeout()}},{key:"cancelActive",value:function(){this.state.isKeepActive=!1,this.setTableHiddenTimeout()}},{key:"handleColumnInsertLimited",value:function(){this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.selectionUil.columnInsertLimit", "The column width is too small and the content cannot be added"))}},{key:"handleScrollIntoView",value:function(e){this.state.resizeType===S.TABLE_HIGHLIGHT_TYPE.TABLE&&this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(e.event)}},{key:"updateTableMenus",value:function(e){this._throttleUpdateTableMenus(e)}},{key:"handleMouseMove",value:function(e,t){if(!(this.state.isResizing||this.app.api.cmdBlocking||this.state.isKeepActive&&!this.state.isStartSelects&&!this.state.isStartDragRowCol))if(this.isTableNonEditable)this.hideOperationBox();else if(e.clientY!==this.state.prevClientY||e.clientX!==this.state.prevClientX){this.state.prevClientX=e.clientX,this.state.prevClientY=e.clientY;var n=!0;t.isInTable?(this.clearTableHiddenTimeout(),this.clearResizeHighlightTimeout(),this.calcContextState(t),this.showOperationBox(),t.type!==Pt&&t.type!==Lt||(n=!1,this.setResizeHighlightTimeout())):this.setTableHiddenTimeout(),n&&(this.hideResizeHighlight(),this.clearResizeHighlightTimeout()),this.selectFromBar(t),this.state.isStartMoveTable&&this.onDragTable(e,t),this.onDragRowCol(e,t)}}},{key:"handleMouseDown",value:function(e){this.clearResizeHighlightTimeout(),!e.isInTable&&this.state.isTableMenusVisible&&this.hideOperationBox()}},{key:"handleMouseUp",value:function(e,t){this.state.isStartSelects&&(this.startSelectsFromBar(!1),this.workspace.tableFloatMenus.update({isStartSelects:!1})),this.state.isStartMoveTable&&this.onDragEndTable(e,t),this.state.isStartDragRowCol&&this.onDragEndRowCol(e,t)}},{key:"onMouseEvent",value:function(e,t){var n=e.type;if(!t)return this.state.uilState;switch(n){case"mousemove":this.handleMouseMove(e,t);break;case"mousedown":this.handleMouseDown(t);break;case"mouseup":this.handleMouseUp(e,t)}return this.state.uilState}},{key:"onCustomEvent",value:function(e,t){var n=this,i=e.type,a=e.detail;switch(i){case ce.default.table.ON_TABLE_SELECTS_START:this.state.uilState=re.a.BLOCK,this.startSelectsFromBar(a.isStart);break;case ce.default.table.ON_TABLE_SELECT_COLUMN_OR_ROW:this.select(a),this.state.uilState=re.a.CONTINUE;break;case ce.default.table.ON_TABLE_SPLIT_CELLS:this.splitCells(),this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_MERGE_CELLS:this.mergeCells(),this.state.uilState=re.a.DONE;break;case ce.default.table.ON_TABLE_INSERT:var o=this.insert(a);o&&o.columnInsertLimited&&this.handleColumnInsertLimited(),this.state.uilState=re.a.CONTINUE;break;case ce.default.table.ON_TABLE_DELETE:this.delete(a),this.state.uilState=re.a.CONTINUE;break;case ce.default.table.ON_TABLE_SELECT_ALL:this.selectAll(),this.state.uilState=re.a.CONTINUE;break;case ce.default.table.ON_TABLE_BEGIN_RESIZING:this.beginResizing(a),this.state.uilState=re.a.BLOCK;break;case ce.default.table.ON_TABLE_END_RESIZING:this.endResizing(a),this.state.uilState=re.a.CONTINUE;break;case ce.default.table.ON_TABLE_KEEP_ACTIVE:this.keepActive();break;case ce.default.table.ON_TABLE_CANCEL_ACTIVE:this.cancelActive();break;case ce.default.table.ON_TABLE_MOVING_START:this.startMoveTable(a.isStart),this.state.uilState=re.a.BLOCK;break;case ce.default.table.ON_TABLE_DRAG_START_COLUMN_OR_ROW:this.startDragRowCol(a),this.state.uilState=re.a.BLOCK;break;case ce.default.table.ON_TABLE_SELECT_BY_SHORTCUT:this.handleSelectByShortcut(a);break;case ce.default.names.DOC_SCROLL_INTO_VIEW:this.handleScrollIntoView(a);break;case ce.default.names.DOC_WORKSPACE_SCROLL:var r=e.detail.passive;this.state.isTableMenusVisible&&!r&&(this._scrollHandler||(this._scrollHandler=window.utils.Lodash.debounce((function(){n.workspace.tableFloatMenus.update({isScroll:!0})}),60)),this._scrollHandler());break;case ce.default.zoom.ON_SCALING_CHANGE:this.state.isTableMenusVisible&&this.handleTableSelection();break;case ce.default.names.SELECTION_CHANGE_AND_CONTENT_UPDATED:this.updateTableMenus(a);break;case ce.default.docmap.ON_PANEL_CLOSE:case ce.default.docmap.ON_PANEL_OPEN:this.hideOperationBox()}return this.state.uilState}},{key:"onKeyboardEvent",value:function(e,t){var n=e.type,i=e.keyCode;if("keydown"===n)switch(i){case oe.a.SPACE:case oe.a.PAGEUP:case oe.a.PAGEDOWN:this.state.isResizing&&e.preventDefault()}return this.state.uilState}},{key:"onWindowEvent",value:function(e){return"resize"===e.type&&this.updateTableMenus({isResized:!0}),this.state.uilState}},{key:"onCommandResponseSelectionEvent",value:function(){this.updateTableMenus({})}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,isResizing:!1,isResizeHighlighted:!1,isTableMenusVisible:!1,isDecreaseBtnVisible:!1,highlightState:{}}}},{key:"isTableNonEditable",get:function(){if(this.isRestrictEditMode&&this.state.tableRange){var e=this.state.tableRange,t=e.begin,n=e.end;if(!this.app.formatContentController.checkIsEditable(t,n-t))return!0}return!1}},{key:"getMenuBtnOffset",get:function(){var e=this.workspace.getScaleValue();return{x:24/e,y:0/e}}}]),t}(le.a);At.events=[{type:"mousedown",target:Pe.a.view,flag:Pe.b.native},{type:"mouseup",target:Pe.a.view,flag:Pe.b.native},{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"scroll",target:Pe.a.workspaceElement,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"resize",target:Pe.a.window,options:{throttleParams:[16]},flag:Pe.b.native},{type:"keydown",target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_INSERT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_COPY,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_CUT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_DELETE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SELECT_ALL,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_BEGIN_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_END_RESIZING,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_MERGE_CELLS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SPLIT_CELLS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_KEEP_ACTIVE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_CANCEL_ACTIVE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SELECT_COLUMN_OR_ROW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SELECTS_START,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_MOVING_START,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_DRAG_START_COLUMN_OR_ROW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.table.ON_TABLE_SELECT_BY_SHORTCUT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_SCROLL_INTO_VIEW,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_WORKSPACE_SCROLL,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.zoom.ON_SCALING_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.docmap.ON_PANEL_OPEN,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.docmap.ON_PANEL_CLOSE,target:Pe.a.window,flag:Pe.b.native}],At.preferredEvents=[{type:ce.default.names.SELECTION_CHANGE_AND_CONTENT_UPDATED,target:Pe.a.window,flag:Pe.b.native}];var It=At,Rt=n(80),Ot=n.n(Rt),Mt=n(2293),Dt=n(1104),Nt=n(324),Bt=n(7138),jt=n(1917),Ft=n(4806),Ht=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a._onMouseUpOutside=a._onMouseUpOutside.bind(a),a.selection.attachObserver(a),a.app.formatContentController.attachObserver(a),a.validCrossCells=!1,a}var n;return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"resetState",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resetState",this).call(this),this.selection.clearCache(),this.workspace.scrollerHelper&&this.workspace.scrollerHelper.clear(),this.validCrossCells=!1}},{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.selection.detachObserver(this),this.app.formatContentController.detachObserver(this)}},{key:"updateActiveFormatedContentControl",value:function(e){if(!this.data.doc.isTemplate&&window.APP.isEditMode){var t=e.ctrlInfos,n=void 0===t?[]:t;n=n.filter((function(e){return e.isRichText||e.isPureText||e.isComboBox||e.isCheckBox||e.isRepeatSec||e.isRepeatItem})),this.isRestrictEditMode&&0===n.length||this.formatContentController.updateActiveControlInfoByHitResult(e)}}},{key:"_dealLineBreak",value:function(e,t,n){if(e&&e.lineBreakHit&&Math.abs(t.x-n.x)>=3){if(e.isInTable){var i=this.data.doc.getDataLogic("final").getPapx(e.position),a=i&&i.prop.getPropVal("para_type"),o=i&&i.prop.getPropVal("nest_level");if(a===Dt.b){var r=Object(P.getCellRangeByPos)(this.data.doc,e.position,o);if(r&&this.state._hitResult.position>=r.begin)return}}e.position+=1,e.glyphTail=!0}}},{key:"_preparePosition",value:function(e,t,n){var i=t&&t.pos,o=void 0;if(!i)return!1;var r=a()({preventScroll:!0,activeContentControlUpdated:!0,isClick:!0,mouseStart:!0},n);if(e&&e.shiftKey){var s=this.selection.begin.pos;if(s)return o=this.state._pos={x:s.posX,y:s.posY+s.height/2},this.state._hitResult=this.utils.getHitResult(o),this._dealLineBreak(t,o,i),this.selection.setPosition(this.selection.begin,t,r),!0}return this.state._pos=i,this.state._hitResult=t,t.type!==x.b.TASK_LIST&&this.selection.setPosition(t,t,r),!0}},{key:"_hitDiffFooterArea",value:function(e,t,n){var i=e.isInFooter,a=e.position;if(void 0!==i&&i!==t.isInFooter){var o=this.selection.begin.position>this.selection.end.position,r=this.data.doc.getLimitedRange(o?a-1:a),s=r.pos,l=r.len,c=o?s:s+l;return this.selection.setPosition(e,c,n),!0}return!1}},{key:"_onMouseUpOutside",value:function(e){var t=this.workspace,n=t.container,i=t.commentContainer;(this.selection.selContext.isInComment()?i&&i.isMounted&&!i.element.contains(e.target):!n.contains(e.taret))&&this.state._backupHitResult&&(this.onEnd(e,this.state._backupHitResult,{isMoved:!0}),this.afterOnEnd(e,this.state._backupHitResult),this.resetState()),document.removeEventListener("mouseup",this._onMouseUpOutside)}},{key:"_attachMouseUpListener",value:function(){document.addEventListener("mouseup",this._onMouseUpOutside)}},{key:"beforeOnStart",value:function(){this.manager.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseonSelectionBeforeOnStart")}},{key:"_recordDragStartAttr",value:function(e){this.state.flexibleHeight=e.pos.height/2,this.state.startPos={x:e.pos.posX,y:e.pos.posY+this.state.flexibleHeight}}},{key:"startOnWaterDrop",value:function(e,t){if(t.type!==x.b.WATER_DROP||this.isOutOfEditableArea)return!1;var n=this.selection.getRangedSelection(),i=n.isSame,a=n.begin,o=n.end,r=this.workspace.config.zoom;switch(t.dropItemType){case Bt.a.Cursor:this._preparePosition(e,t)&&(this.state.uilState=re.a.BLOCK,this.state.isSetNewPositionInTouchstart=i&&t.position!==o.position),this.state.cursorDragMode=!0;var s=this.selection.getLeftTopPoint();this.workspace.waterdrop.setWaterdropCursorPos(s,r),this._recordDragStartAttr(a),void 0!==this.startTouchPos&&null!==this.startTouchPos||(this.startTouchPos=a.position);break;case Bt.a.WaterDropCursor:var l=this.selection.getLeftTopPoint();this.workspace.waterdrop.setWaterdropCursorPos(l,r,!0);break;case Bt.a.WaterDrop:if(a&&o){var c=t.dropItem.isBegin?[a,o]:[o,a],u=k()(c,2),d=u[0],h=u[1];this._recordDragStartAttr(d),this.selection.setPosition(h,d,{updateOnly:!0})}}return this.state._hitResult=t,this.state.dropItemType=t.dropItemType,this.state.dropItem=t.dropItem,this.state.isInteractOnWaterDrop=!0,this.state.startInteractPos=t.pos,!0}},{key:"onTouchStart",value:function(e,t){this.state._hitResult=t,this.startOnWaterDrop(e,t)&&(e.preventDefault(),this.state.uilState=re.a.BLOCK),this.data.doc.isTemplate||(this.workspace.getFormatContentManager().showAll=!1)}},{key:"onMouseDown",value:function(e,t){if(this.data.doc.isTemplate||(this.workspace.getFormatContentManager().showAll=!1),_.isPad&&e.cancelable&&e.preventDefault(),this.startOnWaterDrop(e,t))this.state.uilState=re.a.BLOCK;else{this.state.isInteract=!1;var n=this.getIPadParam(e);this._preparePosition(e,t,n)&&(this._attachMouseUpListener(),this.state.uilState=re.a.BLOCK),t.type!==x.b.TASK_LIST&&ce.default.dispatchEvent(ce.default.shape.ON_SHAPE_CANCEL_SELECT),this.manager.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseonSelectionOnStart")}}},{key:"onStart",value:function(e,t){if(this.state.selectionStage=Ee.b.START,"touchstart"===e.type?this.onTouchStart(e,t):this.onMouseDown(e,t),_.isPad){var n=this.manager.UILs.SELECTION.getModule("KEYBOARD");if(n){var i=n.currentKeyboardEventsHandler;i.currentUserInputCompositionState!==jt.a.CompositionUpdate&&i.currentUserInputCompositionState!==jt.a.CompositionEnd||this.app.workspace.input.blur()}}}},{key:"_getCurrentPosWhenDrag",value:function(e,t){var n=this.state,i=n.startPos,a=n.startInteractPos,o=n.flexibleHeight,r=e.pos,s=t||2,l=0;a.y-r.y>s?l=o:r.y-a.y>s&&(l=-o);var c=r.x-a.x,u=r.y-a.y;return{x:i.x+c,y:i.y+l+u}}},{key:"_extendDragMove",value:function(e,t){var n=this.state.flexibleHeight,i=this.selection.end,a=this._getCurrentPosWhenDrag(t,n),o=this.manager.hit({event:e,pos:a});i.position!==o.position&&(this.selection.setPosition(this.startTouchPos,o,{isSend:!0,notRenderSelectDrop:!0}),this.state._hasDrag=!0)}},{key:"moveOnWaterDrop",value:function(e,t){if(this.state.isInteractOnWaterDrop){e.preventDefault();var n=this.state,i=n.startInteractPos,a=n.startPos,o=n.dropItemType,r=n.dropItem,s=t.pos;if(i.x&&Math.abs(i.x-s.x)>1||i.y&&Math.abs(i.y-s.y)>10)switch(o){case Bt.a.Cursor:!0===this.state.cursorDragMode&&(this.workspace.waterdrop.reset(),this._extendDragMove(e,t));break;case Bt.a.WaterDropCursor:var l={x:s.x,y:s.y-(r.waterDropHeight+2)};if(this.state.singleDropCursorDragMode)this._extendDragMove(e,t),ce.default.dispatchEvent(ce.default.mobile.RENDER_DRAG_MARK,{visible:!0});else{var c=this.manager.hit({event:e,pos:l});this.selection.setPosition(c,null,{isSend:!0}),this.startTouchPos=c.position}this.workspace.waterdrop.setWaterdropCursorPos({pos:this.selection.end.pos},this.workspace.config.zoom,!1);break;case Bt.a.WaterDrop:var u=this._getCurrentPosWhenDrag(t),d=this.manager.hit({event:e,pos:u});this.selection.begin||this.selection.setBegin(this.manager.hit({event:e,pos:a}),{updateOnly:!0}),this._dealLineBreak(d,a,u),this.selection.setEnd(d,{isSend:!0,updateOnly:!0})}return!0}return!1}},{key:"onTouchMove",value:function(e,t){this.moveOnWaterDrop(e,t)}},{key:"onMouseMove",value:function(e,t,n){if(this.state.selectionStage=Ee.b.MOVE,this.state.uilState===re.a.BLOCK&&n.isMoved&&!this.moveOnWaterDrop(e,t)){var i=t.pos,a=this.state._pos;if(a&&i&&t.type!==x.b.TASK_LIST&&t.isInTextbox===this.selection.begin.pos.isInTextbox){this._dealLineBreak(t,a,i);var o=this.selection.selInfo.getSelectionInfo().cells,r=void 0===o?[]:o,s=r.length>0?this.state._hitResult:this.selection.begin.pos;!this.validCrossCells&&this.isValidCrossCells(r,s,t)&&(this.validCrossCells=!0);var l={preventScroll:!0,activeContentControlUpdated:!0,isManualRangeSelect:_.isPad,isMoving:!0,validCrossCells:this.validCrossCells};this._hitDiffFooterArea(s,t,l)||this.selection.setPosition(s,t,l),this.isRestrictEditMode?this.formatContentController.checkBeginAndEndInSameContentController(s,t)&&this.updateActiveFormatedContentControl(t):this.updateActiveFormatedContentControl(t),this.workspace.scrollerHelper&&this.workspace.scrollerHelper.updateIfNeeded(e),this.state.uilState=re.a.BLOCK}}}},{key:"isValidCrossCells",value:function(e,t,n){if(1===e.length&&1===e[0].length){var i=e[0][0];if(i.end-i.begin==1)return!0;var a=Object(Ft.b)(this.app.data,i.begin,i.end-i.begin);return a.length>0&&"delete"===a[0].type&&a[0].range.pos===i.begin&&a[0].range.len===i.end-i.begin-1}return!1}},{key:"onMove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"touchmove"===e.type?this.onTouchMove(e,t):this.onMouseMove(e,t,n)}},{key:"_shouldExitCursorDragMode",value:function(){if(!0===this.state.cursorDragMode){var e=this.selection,t=e.begin,n=e.end;t.position!==n.position?(this.startTouchPos=null,this.selection.setPosition(t,n)):!0===this.state._hasDrag&&(this.selection.setPosition(t,null),this.workspace.waterdrop._cursor.switchVisibility(!0),this.state._hasDrag=!1),this.state.cursorDragMode=!1}}},{key:"_shouldExitSingleWaterDragMode",value:function(){if(!0===this.state.singleDropCursorDragMode){var e=this.selection,t=e.begin,n=e.end;t.position!==n.position&&(this.state.singleDropCursorDragMode=!1,this.startTouchPos=null,this.workspace.waterdrop.reset(),this.selection.setPosition(t,n)),this.state._hasDrag=!1,ce.default.dispatchEvent(ce.default.mobile.RENDER_DRAG_MARK,{visible:!1})}}},{key:"endOnWaterDrop",value:function(e,t){if(this.state.isInteractOnWaterDrop){this._shouldExitCursorDragMode(),this._shouldExitSingleWaterDragMode();var n=t.dropItemType===Bt.a.WaterDropCursor,i=this.selection,a=i.begin,o=i.end;if(n&&a.position===o.position){var r=this.selection.getLeftTopPoint();this.workspace.waterdrop.setWaterdropCursorPos(r,this.workspace.config.zoom,!0)}return!0}return!1}},{key:"restoreSelectionWhenHitOnTaskList",value:function(e,t){var n=this.selection,i=n.begin,a=n.end;this.selection.selContext.prevSelInfo={glyphTail:a.glyphTail},"lineHome"===i.pos.type&&"lineHome"===a.pos.type&&(i=a=e);var o=this.selection,r=o.activeShapeIdxPath,s=o.activeShapeTreeType,l=o._selShapeIdxPaths;this.selection.setPosition(i,a,Object.assign(t,{shapeIdxPath:r,shapeTreeType:s,selShapeIdxPaths:l}))}},{key:"onTouchEnd",value:function(e,t,n){if(!this.endOnWaterDrop(e,t)){if(!(n.isSwiped||n.isDoubleTap||_.isPad&&n.isMultiTouch))if(t.type===x.b.TASK_LIST){if(!this.isRestrictEditMode&&!this.app.isReadOnly()){var i={isSend:!0,applyFormat:!0,preventScroll:!0,activeContentControlUpdated:!0,isClick:!0,isManualRangeSelect:_.isPad&&n.isMoved};this.restoreSelectionWhenHitOnTaskList(t,i)}}else{var a={isSend:!0,isClick:!0};if(_.isPad&&Object.assign(a,this.getIPadParam(e)),this.selection.setPosition(t,null,a),!this.app.isReadOnly()&&!this.isOutOfEditableArea){var o=this.selection.getLeftTopPoint();this.workspace.waterdrop.setWaterdropCursorPos(o,this.workspace.config.zoom,!0)}}e.preventDefault()}}},{key:"onMouseUp",value:function(e,t,n){if(!this.endOnWaterDrop(e,t)){var i=t.pos,a=this.state._pos;if(t.isInTextbox!==this.selection.begin.pos.isInTextbox)return this.selection.setPosition(this.selection.begin,this.selection.end,{preventScroll:!0,isClick:!0}),void this.resetState();if(a&&i){this._dealLineBreak(t,a,i);var o=!1;_.isPad&&(o=n.isMoved&&this.selection.getNormalRange().len>0);var r={isSend:!0,applyFormat:!0,preventScroll:!0,activeContentControlUpdated:!0,isClick:!0,isManualRangeSelect:o,validCrossCells:this.validCrossCells},s=this.selection.selInfo.getSelectionInfo().cells,l=(void 0===s?[]:s).length>0?this.state._hitResult:this.selection.begin.pos;if(Object.assign(r,this.getIPadParam(e)),this.isRestrictEditMode)this.formatContentController.checkBeginAndEndInSameContentController(l,t)?(n.isMoved||e.shiftKey?this.selection.setPosition(l,t,r):this.selection.setPosition(t,t,r),this.updateActiveFormatedContentControl(t)):this.checkIsOutTextFormField()||this.restoreSelectionWhenHitOnTaskList(t,r);else if(t.type!==x.b.TASK_LIST){if(!this._hitDiffFooterArea(l,t,r)){var c=t.position-l.position,u=1===c&&this.app.data.doc.getText(l.position,1).charCodeAt()===Nt.a;0===c&&!this.validCrossCells||1===c&&u?this.selection.setPosition(t,null,r):0===c&&this.validCrossCells?this.selection.setPosition(t,t,r):n.isMoved||e.shiftKey?this.selection.setPosition(l,t,r):this.selection.setPosition(t,t,r)}this.updateActiveFormatedContentControl(t)}else this.restoreSelectionWhenHitOnTaskList(t,r)}(n.isDoubleTap||n.isTripleTap)&&this.workspace.focusWithoutScroll(),n.isSwiped||e.cancelable&&e.preventDefault()}}},{key:"onEnd",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"touchend"===e.type?this.onTouchEnd(e,t,n):this.onMouseUp(e,t,n),this.resetState()}},{key:"afterOnEnd",value:function(e,t){this.manager.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseonSelectionAfterOnEnd")}},{key:"onLeave",value:function(e,t){this.workspace.isElementAcceptable(e.relatedTarget)||(this.state._backupHitResult=t)}},{key:"onTap",value:function(e,t){if(t){var n=t.taskListInfo;if(n&&n.isTaskList&&!this.app.isReadOnly()){var i=n.index===Mt.b?Mt.a:Mt.b;this.manager.editHandler.paraFormat.setList(i,!0,{pos:t.line&&t.line.range.pos,len:0})}}this.resetState()}},{key:"onDoubleTap",value:(n=Ot()(regeneratorRuntime.mark((function e(t,n){var i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={isSend:!0,isManualRangeSelect:_.isPad&&"mousedown"===t.type},this.app.isEditMode&&(window.APP.data.glyphpool.glyphBuff.getCharCode(n.position)===Nt.e?this.selection.selAlter.selectionBlock(n.position+1,i):(a=n&&n.glyphGroupInfo)&&Object(ct.a)(a)||((o=this.getPageFieldInDoubleTapIn(n))?this.selection.setPosition(o.begin,o.end,i):(Object.assign(i,this.getIPadParam(t)),this.selection.selAlter.extendSelectBlock(n,null,i)))),this.resetState();case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"onTripleTap",value:function(e,t){if(t){var n=t.position;this.selection.selAlter.selectParagraph(n,{isManualRangeSelect:_.isPad&&"mousedown"===e.type,isTripleTap:!0}),this.resetState()}}},{key:"longTapOnWaterDrop",value:function(e,t){if(this.state.dropItemType===Bt.a.WaterDropCursor){this.state.singleDropCursorDragMode=!0;var n=this.selection.getRangedSelection().begin;this.startTouchPos=n.position,this._recordDragStartAttr(n),ce.default.dispatchEvent(ce.default.mobile.RENDER_DRAG_MARK,{visible:!0}),this.state.uilState=re.a.BLOCK}}},{key:"onLongTap",value:function(e,t){this.state.isInteractOnWaterDrop&&this.longTapOnWaterDrop(e,t)}},{key:"onGestureEvent",value:function(e,t){var n=e.event,i=e.type,a=e.context;if(!x.a.TEXT.includes(t.type)&&this.state.uilState!==re.a.BLOCK)return this.state.uilState;if(this.isRestrictEditMode&&t&&this.data.doc.getSubDocType(t.position)===A.Comment)return this.state.uilState;switch(i){case ae.a.START:var o=n.button;o&&o!==oe.b.LEFT||(this.beforeOnStart(n,t),this.onStart(n,t));break;case ae.a.MOVE:this.onMove(n,t,a);break;case ae.a.END:this.onEnd(n,t,a),this.afterOnEnd(n,t);break;case ae.a.LEAVE:this.onLeave(n,t);break;case ae.a.TAP:this.onTap(n,t);break;case ae.a.PRE_DOUBLE_TAP:this.onDoubleTap(n,t);break;case ae.a.PRE_TRIPLE_TAP:this.onTripleTap(n,t),window.collection("commandshortcut","click","triple_click");break;case ae.a.LONG_TAP:this.onLongTap(n,t);break;default:this.state.uilState=re.a.CONTINUE}return this.state.uilState}},{key:"onSelectionChanged",value:function(e,t){t&&t.applyFormat&&this.manager.editHandler.state.copiedFormat&&(this.selection.selInfo.info.isNonEditableInRestrictedMode||this.manager.editHandler.pasteFormat(),ce.default.dispatchEvent(ce.default.formatPainter.ON_FORMAT_PAINTER_APPLIED))}},{key:"onInsertEmptyDefaultContent",value:function(e){this.resetState()}},{key:"getPageFieldInDoubleTapIn",value:function(e){if(e.isInTextbox&&this.selection.selContext.isInHeaderFooter||e.glyphGroupInfo&&e.glyphGroupInfo.zone&&e.glyphGroupInfo.zone.isEqZone){var t=this.data.doc.fields.getField(e.position);if(t&&("PAGE"===t.type||"NUMPAGES"===t.type||"EQ"===t.type))return t}return null}},{key:"onKeyboardEvent",value:function(e){var t=e.type;if(this.state.uilState===re.a.BLOCK)switch(t){case"keydown":case"input":case"compositionend":case"compositionupdate":case"compositionstart":this.manager.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseonKeyboardEvent",e)}return this.state.uilState}},{key:"onCustomEvent",value:function(e){return e.type===ce.default.names.SELECTION_CHANGE_AND_CONTENT_UPDATED&&this.state.uilState===re.a.BLOCK&&this.manager.sendCommandToModule(re.b.SELECTION,Ee.a.TABLE,"onCommandResponseSelectionEvent",e),this.state.uilState}},{key:"getIPadParam",value:function(e){if(_.isPad&&e.target&&e.target.className&&e.target.className.indexOf&&-1!==e.target.className.indexOf("page-container"))return{preventScroll:!1,preventFocus:!0};return{}}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,_pos:null,selectionStage:Ee.b.INIT}}},{key:"isOutOfEditableArea",get:function(){return!!this.app.restrictEditHandler.isInRestrictEditMode&&!this.app.formatContentController.checkIsInContentControl()}}]),t}(le.a);Ht.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.MOVE,target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.gesture},{type:ae.a.TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.PRE_DOUBLE_TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.PRE_TRIPLE_TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.LONG_TAP,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.view,flag:Pe.b.gesture},{type:ae.a.LEAVE,target:Pe.a.view,flag:Pe.b.gesture},{type:"input",target:Pe.a.input,flag:Pe.b.native},{type:"compositionend",target:Pe.a.input,flag:Pe.b.native},{type:"compositionstart",target:Pe.a.input,flag:Pe.b.native},{type:"compositionupdate",target:Pe.a.input,flag:Pe.b.native},{type:"keydown",target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.SELECTION_CHANGE_AND_CONTENT_UPDATED,target:Pe.a.window,flag:Pe.b.native}].concat(r()(_.isPad?[{type:ae.a.START,target:Pe.a.waterdropElements,flag:Pe.b.gesture},{type:ae.a.MOVE,target:Pe.a.waterdropElements,flag:Pe.b.gesture},{type:ae.a.END,target:Pe.a.waterdropElements,flag:Pe.b.gesture},{type:ae.a.LONG_TAP,target:Pe.a.waterdropElements,flag:Pe.b.gesture}]:[]));var Gt=Ht,Ut=n(24),Wt=n.n(Ut),Yt=n(3489),zt=n(227),Xt=n(4428),Vt=[],qt=[Yt.f],Kt=[Yt.L],Qt=[Yt.f,Yt.L],Jt=[Yt.f,Yt.b],Zt=[Yt.L,Yt.b];function $t(){if(window.APP.isPCMode()||window.APP.isPaginationMode()){var e=window.APP.data.selection,t=e.activeShape,n=e._selShapeIdxPaths,i=e.activeShapeIdxPath;if(t&&!t.topShape.isEmbedShape&&!n)return{gcp:t.pos,id:t.id,shapeTreeType:t.shape_tree_type,shapeIdxPath:i}}}var en=function(){function e(){return l()(this,e),"object"===Wt()(e._instance_)?e._instance_:(e._instance_=this,this)}return u()(e,[{key:"init",value:function(e,t,n,i){this.input=e,this.editor=t,this.selection=n,this.workspace=i}},{key:"getInputConfig",value:function(){var e=this,t={get readOnly(){var e=window.APP;return!(!e.data.selection.selContext.isInComment()||!e.isAclComment)}},n=Object.assign({composingDisabled:!0,offlineDisabled:!0,deleteWithControlDisabled:!0,inReadOnlyDocumentFieldDisabled:!0,unEditableCommentDisabled:!0},t),i=function(t){e.inputHandler.collection.begin(Xt.b.DELETE_TEXT),e.editor.deleteText(t),e.inputHandler.collection.end()};return[[Vt,Yt.d,function(){i(!0)},n],[Vt,Yt.j,function(){i(!1)},n],[Vt,Yt.n,function(){if(e.input.value="",e.selection.selContext.isInComment()){if(e.selection.isComposing)return;if(e.workspace.revisionComment.isReEditComment)return e.workspace.app.uilManager.exitCommentBody(),e.workspace.app.uilManager.resetCommentElements(),void setTimeout((function(){e.selection.setPosition(e.selection.begin.pos,void 0,{isSend:!0})}),50);e.editor.commitAndInsertNewTempComment()}else e.inputHandler.collection.begin(Xt.b.INSERT_PARAGRAPH),e.editor.insertParagraph(),e.inputHandler.collection.end()},Object.assign({offlineDisabled:!0,insertWithControlDisabled:!0,inReadOnlyDocumentFieldDisabled:!0,unEditableCommentDisabled:!0},t)],[Vt,Yt.N,function(){e.selection.selContext.isInComment()||(e.inputHandler.collection.begin(Xt.b.INSERT_TAB),e.editor.insertTab(!1),e.inputHandler.collection.end())},{offlineDisabled:!0,insertWithControlDisabled:!0,inReadOnlyDocumentFieldDisabled:!0}],[Vt,Yt.t,function(){window.APP.restrictEditHandler.isInRestrictEditMode||(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput())&&(e.selection.selAlter.toLineStart(),e.workspace.makesureCursorVisible(),window.collection("commandshortcut","click","home"))},{readOnly:!0}],[Vt,Yt.m,function(){window.APP.restrictEditHandler.isInRestrictEditMode||(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput())&&(e.selection.selAlter.toLineEnd(),e.workspace.makesureCursorVisible(),window.collection("commandshortcut","click","end"))},{readOnly:!0}],[Vt,Yt.y,function(){if(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput()){var t=$t();if(t){var n=t.gcp,i=t.id,a=t.shapeTreeType,o=t.shapeIdxPath,r=-1/window.APP.workspace.getScaleValue();window.APP.editor.picture.moveShape(n,i,a,Object(R.Px2Ti)(r),0,o)}else e.selection.selAlter.previousPosition(),e.workspace.makesureCursorVisible()}else window.APP.isHistoryVersionCompare?(window.collection("commandbar","click","revision_previous_shortcut"),e.workspace.revisionComment.versionCompare.handPrevClick(!1)):e.workspace.scrollerHelper.toX(e.workspace.scrollLeft-80)},{composingDisabled:!0,inputtingDisabled:!0,readOnly:!0}],[Vt,Yt.P,function(){if(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput()){var t=$t();if(t){var n=t.gcp,i=t.id,a=t.shapeTreeType,o=t.shapeIdxPath,r=-1/window.APP.workspace.getScaleValue();window.APP.editor.picture.moveShape(n,i,a,0,Object(R.Px2Ti)(r),o)}else if(e.selection.selAlter.upPosition(),e.workspace.makesureCursorVisible(),window.APP.isWebMode()){var s=e.selection.begin.pos.line.range;0!==window.APP.workspace.element.cacheDOMAttr.scrollTop&&0===s.begin&&(e.workspace.scrollerHelper.startPassiveScroll(),e.workspace.element.scrollTop=0)}}else window.APP.isHistoryVersionCompare?(window.collection("commandbar","click","revision_previous_shortcut"),e.workspace.revisionComment.versionCompare.handPrevClick(!1)):e.workspace.scrollerHelper.toY(e.workspace.scrollTop-80)},{composingDisabled:!0,readOnly:!0}],[Vt,Yt.I,function(){if(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput()){var t=$t();if(t){var n=t.gcp,i=t.id,a=t.shapeTreeType,o=t.shapeIdxPath,r=1/window.APP.workspace.getScaleValue();window.APP.editor.picture.moveShape(n,i,a,Object(R.Px2Ti)(r),0,o)}else e.selection.selAlter.nextPosition(),e.workspace.makesureCursorVisible()}else window.APP.isHistoryVersionCompare?(window.collection("commandbar","click","revision_next_shortcut"),e.workspace.revisionComment.versionCompare.handNextClick(!1)):e.workspace.scrollerHelper.toX(e.workspace.scrollLeft+80)},{composingDisabled:!0,readOnly:!0}],[Vt,Yt.k,function(){if(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput()){var t=$t();if(t){var n=t.gcp,i=t.id,a=t.shapeTreeType,o=t.shapeIdxPath,r=1/window.APP.workspace.getScaleValue();window.APP.editor.picture.moveShape(n,i,a,0,Object(R.Px2Ti)(r),o)}else e.selection.selAlter.downPosition(),e.workspace.makesureCursorVisible()}else window.APP.isHistoryVersionCompare?(window.collection("commandbar","click","revision_next_shortcut"),e.workspace.revisionComment.versionCompare.handNextClick(!1)):e.workspace.scrollerHelper.toY(e.workspace.scrollTop+80)},{composingDisabled:!0,readOnly:!0}],[Vt,Yt.F,function(){e.workspace.pageUp()},{readOnly:!0,commentDisabled:!0}],[Vt,Yt.E,function(){e.workspace.pageDown()},{readOnly:!0,commentDisabled:!0}],[qt,Yt.y,function(){e.selection.selAlter.keyboardSelectLeftWords(),e.workspace.makesureCursorVisible(!0)}],[qt,Yt.I,function(){e.selection.selAlter.keyboardSelectRightWords(),e.workspace.makesureCursorVisible(!0)}],[qt,Yt.P,function(){e.selection.selAlter.keyboardToParagraphHead(),e.workspace.makesureCursorVisible(!0)}],[qt,Yt.k,function(){e.selection.selAlter.keyboardToParagraphEnd(),e.workspace.makesureCursorVisible(!0)}],[qt,Yt.a,function(){e.selection.selAlter.selectAll()},{readOnly:!0}],[qt,Yt.c,function(){window.collection("commandshortcut","click","bold"),e.editor.bold()},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.e,function(){e.editor.copy()},{readOnly:!0}],[qt,Yt.l,function(){e.editor.align_horiz(),window.collection("commandshortcut","click","horiz")},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.u,function(){window.collection("commandshortcut","click","italic"),e.editor.italic()},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.v,function(){e.editor.align_both(),window.collection("commandshortcut","click","both")},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.w,function(){e.editor.openHyperLink(),window.collection("commandshortcut","click","insert_url")},{offlineDisabled:!0,commentDisabled:!0}],[qt,Yt.x,function(){e.editor.align_left(),window.collection("commandshortcut","click","left")},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.H,function(){e.editor.align_right(),window.collection("commandshortcut","click","right")},{macDisabled:!0,offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.O,function(){window.collection("commandshortcut","click","underline"),e.editor.underline()},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.Q,function(){e.editor.cut()},{offlineDisabled:!0,readOnly:!0,deleteWithControlDisabled:!0,inReadOnlyDocumentFieldDisabled:!0,unEditableCommentDisabled:!0}],[qt,Yt.z,function(){e.editor.font_size_minus(),window.collection("commandshortcut","click","size_minus")},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.J,function(){e.editor.font_size_add(),window.collection("commandshortcut","click","size_add")},{offlineDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[qt,Yt.n,function(){e.editor.toNextPageStart(),window.collection("commandshortcut","click","insert_page_break")},{offlineDisabled:!0,formatControlDisabled:!0,headerFooterDisabled:!0,webModDisabled:!0,textModDisabled:!0,insertWithControlDisabled:!0,commentDisabled:!0}],[Kt,Yt.y,function(){e.selection.selAlter.moveLeft(),e.editor.closeLastTransact(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0,inputtingDisabled:!0}],[Kt,Yt.P,function(){e.selection.selAlter.moveUp(),e.editor.closeLastTransact(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Kt,Yt.I,function(){e.selection.selAlter.moveRight(),e.editor.closeLastTransact(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Kt,Yt.k,function(){e.selection.selAlter.moveDown(),e.editor.closeLastTransact(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Kt,Yt.t,function(){(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput())&&(e.selection.selAlter.toLineStart(!0),e.workspace.makesureCursorVisible(!0),window.collection("commandshortcut","click","shift+home"))},{restrictEditModeDisabled:!0,readOnly:!0}],[Kt,Yt.m,function(){(!window.APP.isReadOnly()||window.APP.isReadOnlyComment()&&e.isInCommentInput())&&(e.selection.selAlter.toLineEnd(!0),e.workspace.makesureCursorVisible(!0),window.collection("commandshortcut","click","shift+end"))},{restrictEditModeDisabled:!0,readOnly:!0}],[Kt,Yt.N,function(){e.selection.selContext.isInComment()||(e.inputHandler.collection.begin(Xt.b.INSERT_TAB),e.editor.insertTab(!0),e.inputHandler.collection.end())},{offlineDisabled:!0,insertWithControlDisabled:!0}],[Kt,Yt.F,function(){e.workspace.pageUp(!0)},{commentDisabled:!0}],[Kt,Yt.E,function(){e.workspace.pageDown(!0)},{commentDisabled:!0}],[Kt,Yt.d,function(){i(!0)},n],[Kt,Yt.j,function(){i(!1)},n],[Kt,Yt.n,function(){e.selection.selContext.isInComment()&&(e.inputHandler.collection.begin(Xt.b.INSERT_PARAGRAPH),e.input.value="",e.editor.insertParagraph(),e.inputHandler.collection.end())},Object.assign({},t)],[Qt,Yt.y,function(){e.selection.selAlter.keyboardLightSelectLeftWords("light"),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Qt,Yt.I,function(){e.selection.selAlter.keyboardLightSelectRightWords(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Qt,Yt.P,function(){e.selection.selAlter.keyboardToSelectParagraphHead(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Qt,Yt.k,function(){e.selection.selAlter.keyboardToSelectParagraphEnd(),e.workspace.makesureCursorVisible(!0)},{readOnly:!0}],[Qt,Yt.u,function(){window.collection("commandshortcut","click","bullets_apply"),e.editor.bullets()},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Qt,Yt.O,function(){window.collection("commandshortcut","click","numbering_apply"),e.editor.numbering()},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Qt,Yt.R,function(){window.collection("commandshortcut","click","tasklist_apply"),e.editor.tasklist()},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Qt,Yt.v,function(){e.editor.align_decentralized(),window.collection("commandshortcut","click","decentralized")},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Qt,Yt.t,function(){e.selection.selAlter.toPageStart(!0)},{restrictEditModeDisabled:!0}],[Qt,Yt.m,function(){e.selection.selAlter.toPageEnd(!0)}],[Jt,Yt.A,function(){e.editor.insertComment(),window.collection("commandbar","click","comment_shortcut")},{offlineDisabled:!0,restrictEditModeDisabled:!0,commentWithControlDisabled:!0,commentDisabled:!0,readOnly:!0}],[Jt,Yt.h.NUM0,function(){window.APP.editor.setStyle(0)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM1,function(){window.APP.editor.setStyle(1)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM2,function(){window.APP.editor.setStyle(2)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM3,function(){window.APP.editor.setStyle(3)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM4,function(){window.APP.editor.setStyle(4)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM5,function(){window.APP.editor.setStyle(5)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM6,function(){window.APP.editor.setStyle(6)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM7,function(){window.APP.editor.setStyle(7)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM8,function(){window.APP.editor.setStyle(8)},{winDisabled:!0,commentDisabled:!0}],[Jt,Yt.h.NUM9,function(){window.APP.editor.setStyle(9)},{winDisabled:!0,commentDisabled:!0}],[Zt,Yt.g,function(){e.editor.reduce_indentation(),window.collection("commandshortcut","click","reduce_indentation")},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Zt,Yt.G,function(){e.editor.increase_indentation(),window.collection("commandshortcut","click","increase_indentation")},{offlineDisabled:!0,restrictEditModeDisabled:!0,formatWithControlDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM0,function(){window.APP.editor.setStyle(0)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM1,function(){window.APP.editor.setStyle(1)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM2,function(){window.APP.editor.setStyle(2)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM3,function(){window.APP.editor.setStyle(3)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM4,function(){window.APP.editor.setStyle(4)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM5,function(){window.APP.editor.setStyle(5)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM6,function(){window.APP.editor.setStyle(6)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM7,function(){window.APP.editor.setStyle(7)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM8,function(){window.APP.editor.setStyle(8)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.h.NUM9,function(){window.APP.editor.setStyle(9)},{macDisabled:!0,commentDisabled:!0}],[Zt,Yt.y,function(){e.editor.increaseTitleStyle()},{commentDisabled:!0}],[Zt,Yt.I,function(){e.editor.decreaseTitleStyle()},{commentDisabled:!0}]]}},{key:"getGlobalConfig",value:function(){var e=this;return[[qt,Yt.t,function(){e.selection.selAlter.toPageStart(),e.workspace.makesureCursorVisible(),window.collection("commandshortcut","click","ctrl+home")},{readOnly:!0}],[qt,Yt.m,function(){e.selection.selAlter.toPageEnd(),e.workspace.makesureCursorVisible(),window.collection("commandshortcut","click","ctrl+end")},{readOnly:!0}],[qt,Yt.p,function(){e.editor.find(),window.collection("commandshortcut","click","find")},{readOnly:!0,restrictEditModeDisabled:!0,commentDisabled:!0,cachePreviewDisabled:!0}],[qt,Yt.s,function(){e.editor.replace(),window.collection("commandshortcut","click","replace")},{restrictEditModeDisabled:!0,commentDisabled:!0,cachePreviewDisabled:!0}],[qt,Yt.D,zt.default.names.file.ON_PRINT,{readOnly:!0}],[qt,Yt.K,function(){e.editor.closeLastTransact(),e.editor.save()},{readOnly:!0,offlineDisabled:!0}],[Vt,Yt.q,ce.default.names.DOC_FIND_NEXT,{macDisabled:!0,readOnly:!0}],[Kt,Yt.q,ce.default.names.DOC_FIND_PREV,{macDisabled:!0,readOnly:!0}],[qt,Yt.r,ce.default.names.DOC_FIND_NEXT,{winDisabled:!0,readOnly:!0}],[Qt,Yt.r,ce.default.names.DOC_FIND_PREV,{winDisabled:!0,readOnly:!0}],[qt,Yt.R,function(){var t=window.APP.data.selection.compositionState;!(_.isPad&&(t===jt.a.CompositionUpdate||t===jt.a.CompositionEnd))&&window.g_rpt.canRedo()&&e.editor.redo(!0),window.collection("commandshortcut","click","redo")},{offlineDisabled:!0,otherInputDisabled:!0}],[qt,Yt.S,function(){var t=window.APP.data.selection.compositionState;!(_.isPad&&(t===jt.a.CompositionUpdate||t===jt.a.CompositionEnd))&&window.g_rpt.canUndo()&&e.editor.undo(!0),window.collection("commandshortcut","click","undo")},{offlineDisabled:!0,otherInputDisabled:!0}],[Vt,Yt.M,function(){},{disabledInAllInput:!0},function(e){return e.target===document.body||window.APP.workspace.element.contains(e.target)}]].map((function(e){return e[3]||(e[3]={}),e[3].global=!0,e}))}},{key:"isInCommentInput",value:function(){var e=this.selection.selContext;return e.isInComment()&&e.isCommentEditable}},{key:"inputHandler",get:function(){return this.workspace.app.uilManager.getModule(re.b.SELECTION,Ee.a.KEYBOARD).currentKeyboardEventsHandler}}]),e}(),tn=n(6747),nn=n(1590),an=n(1033),on=n(4113),rn=jt.a.CompositionInit,sn=jt.a.CompositionStart,ln=jt.a.CompositionUpdate,cn=jt.a.CompositionEnd,un=0,dn=1,hn=function(e){function t(){var e;l()(this,t);var n,i=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"object"===Wt()(t._instance_)?(n=t._instance_,h()(i,n)):(t._instance_=i,i._compositionDurationSelectionPosition=-1,i._quickInputQueue=[],i.debounceInputEventHandler=window.utils.Lodash.debounce((function(e,t){i.handleDeounceInput(e,t)}),16),i._currentUserInputCompositionState=rn,i._lastCompositionEndData="",e=i,h()(i,e))}return v()(t,e),u()(t,[{key:"handleUpdateSelectionAfterOnEnd",value:function(){}},{key:"updatecompositionDurationSelectionPosition",value:function(){if(this.currentUserInputCompositionState===ln){var e=window.APP.data.selection.getNormalRange();this._compositionDurationSelectionPosition=e.pos}}},{key:"resetCompositionDurationSelectionPosition",value:function(){this._compositionDurationSelectionPosition=-1}},{key:"updateUserInputCompositionState",value:function(e){var t=this.currentUserInputCompositionState;switch(e){case ln:if(t!==ln&&t!==sn)return;break;case sn:if(t!==rn)return;break;case rn:if(t!==rn&&t!==cn)return}this._currentUserInputCompositionState=e}},{key:"dropQuickInputMessage",value:function(){if(!(this._quickInputQueue.length<=0)){this.compositionState===sn||this.compositionState===ln?this.handleCompositionEnd("",!1):this.compositionState===cn&&(clearTimeout(this._delayEndCompositionForRejectInput),this._delayEndCompositionForRejectInput=null,this.updateCompositionState(rn)),this._quickInputQueue.length=0;var e=this.currentUserInputCompositionState;e===sn?this.handleCompositionStart(!0):e===ln&&(this.handleCompositionStart(!0),this.handleCompositionUpdate(this.getInputValue()))}}},{key:"pushQuickInputMessageElement",value:function(e,t){this._quickInputQueue.push({messageType:e,data:t})}},{key:"isQuickInputMessageEmpty",value:function(){return 0===this._quickInputQueue.length}},{key:"wakeUpInputMessageQueue",value:function(){if(!this.isQuickInputMessageEmpty())for(;!this.isQuickInputMessageEmpty();){var e=this._quickInputQueue.shift();switch(e.messageType){case sn:this.handleCompositionStart(!1);break;case ln:this.handleCompositionUpdate(e.data);break;case cn:return this.handleCompositionEnd(e.data);case jt.b:this.handleInputEvent(e.data.event,e.data.inputString)}}}},{key:"init",value:function(e,n,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e,n,i,a,o)}},{key:"handleStartInput",value:function(){this.selection.getNormalRange().len>0&&this.editor.preDeleteText()}},{key:"resetTargetIpChpx",value:function(e){this._ipChpxCache=e||{}}},{key:"storeTargetIpChpx",value:function(){var e=this.selection.selInfo.getIpChpx();this.resetTargetIpChpx(a()({},e)),void 0!==e&&(e.underlineType&&(this._ipChpxCache.underlineType=e.underlineType,this._ipChpxCache.underlineColor=e.underlineColor),this.selection.updateIpChpx(an.Font_Underline,nn.wpsUnderlineNone,on.a))}},{key:"loadIpChpx",value:function(){void 0!==this._ipChpxCache&&(this.selection.selContext.ipChpx=this._ipChpxCache,this.resetTargetIpChpx())}},{key:"isInComposition",value:function(){return this.compositionState>=sn&&this.compositionState<=cn}},{key:"compositionstartIsHandleStartInput",value:function(){return!0}},{key:"handleCompositionStart",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.compositionState===rn&&(e&&this.compositionstartIsHandleStartInput()&&this.handleStartInput(),this.updateCompositionState(sn),this.storeTargetIpChpx(),this.isInputting=!0,this._lastCompositionEndData="")}},{key:"onCompositionStart",value:function(e){this.needComposing&&(this.collection.begin(Xt.b.INSERT_TEXT_WITH_COMPOSITION),this.updateUserInputCompositionState(sn),this.isQuickInputMessageEmpty()?this.compositionState===cn?this.pushQuickInputMessageElement(sn):this.handleCompositionStart():this.pushQuickInputMessageElement(sn))}},{key:"handleCompositionUpdate",value:function(e){if(""!==e&&(this.compositionState===sn||this.compositionState===ln)){this.updateCompositionState(ln);var t=window.g_rpt.getLastLocalCommand();t&&t.param&&t.param.isComposing&&t.param.string===e||(this.editor.insertText(e,{state:this.compositionState}),this.isQuickInputMessageEmpty()&&this.collection.end())}}},{key:"onCompositionUpdate",value:function(e){if(this.needComposing){this.collection.begin(Xt.b.INSERT_TEXT_WITH_COMPOSITION),this.updateUserInputCompositionState(ln);var t=e.data;this.isQuickInputMessageEmpty()?this.handleCompositionUpdate(t):this.pushQuickInputMessageElement(ln,t)}}},{key:"compositionEndForSelection",value:function(e){var t=e;if(" "===t&&(t=""),this.editor.isPalaceMuseumTemplate&&this.editor.isAllowInsert()&&!this.editor.isCanInsertInPalaceMuseumTemplate(t)){if(this.selection.updateCompositionState(cn),!this.editor.cmdExecutor.exec({name:"closeComposingTransact"}).result)return void console.error("closeComposingTransact error");this.selection.clearCache(),this.selection._dispatch("onUILOperationTriggered",window.APP.data.selection.getNormalRange().pos,null,{isEditing:!0,isCompositionEnd:!0})}else{var n=this.getCompositionEndUserClickPosition(),i=n.result,a=n.pos;this.editor.insertText(t,{state:this.compositionState,isUseUserClickPosition:i?a:null})}this.isInputting=!1}},{key:"getCompositionEndUserClickPosition",value:function(){return-1!==this.compositionDurationSelectionPosition?{result:!0,pos:this.compositionDurationSelectionPosition}:{result:!1}}},{key:"_addCompositionForRejectInput",value:function(){var e=this;this._delayEndCompositionForRejectInput=setTimeout((function(){clearTimeout(e._delayEndCompositionForRejectInput),e._delayEndCompositionForRejectInput=null,e.updateCompositionState(rn),e.wakeUpInputMessageQueue()}),150)}},{key:"handleCompositionEnd",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(_.isEdge){if(this.compositionState===sn)return this.updateCompositionState(rn),void(this.isQuickInputMessageEmpty()||this.wakeUpInputMessageQueue())}else if(_.isPad&&this.compositionState!==ln)return void(this.isQuickInputMessageEmpty()||t&&this._addCompositionForRejectInput());this.updateCompositionState(cn),this.loadIpChpx(),this.compositionEndForSelection(e),this._lastCompositionEndData=e,t&&this._addCompositionForRejectInput(),this.isQuickInputMessageEmpty()&&this.collection.end()}},{key:"onCompositionEndAfter",value:function(){this.input.value="",this.updateUserInputCompositionState(rn),(_.isFirefox||_.isSafari)&&this.resetCompositionDurationSelectionPosition()}},{key:"onCompositionEnd",value:function(){if(this.needComposing){this.collection.begin(Xt.b.INSERT_TEXT_WITH_COMPOSITION);var e=this.getInputValue();this.updateUserInputCompositionState(cn),this.isQuickInputMessageEmpty()?this.compositionState===cn?this.pushQuickInputMessageElement(cn,e):this.handleCompositionEnd(e):this.pushQuickInputMessageElement(cn,e),this.onCompositionEndAfter()}}},{key:"handleInput",value:function(e,t){if(""!==e){switch(t){case dn:this.compositionState===cn&&(this.editor.insertText(e,{state:this.CompositionInit}),this.isInputting=!1);break;case un:this.compositionState===rn&&(this.handleStartInput(),this.editor.insertText(e,{state:this.compositionState}),this.isInputting=!1)}this.isQuickInputMessageEmpty()&&this.collection.end()}}},{key:"handleInputEvent",value:function(e,t){if(this.isInComposition()){if(this.compositionState===cn){if(e.isComposing||e.inputType&&("insertCompositionText"===e.inputType||"insertFromComposition"===e.inputType))return;if(_.isQQBrowser&&!1===e.isComposing&&"insertText"===e.inputType){if(""===this._lastCompositionEndData)return this.handleInput(t,dn);if(" "===this._lastCompositionEndData)return}t.charAt(t.length-1)!==this._lastCompositionEndData.charAt(this._lastCompositionEndData.length-1)&&this.handleInput(t,dn)}}else this.handleInput(t,un)}},{key:"getInputValue",value:function(){return this.input.value}},{key:"handleDeounceInput",value:function(e,t){this.isQuickInputMessageEmpty()?this.handleInputEvent(e,t):this.pushQuickInputMessageElement(jt.b,{event:e,inputString:t}),this.onInputAfter()}},{key:"onInputBefore",value:function(){}},{key:"onInput",value:function(e){if(this.onInputBefore(),this.currentUserInputCompositionState===rn){this.collection.begin(Xt.b.INSERT_TEXT_WITHOUT_COMPOSITION);var t=this.getInputValue();""!==t&&(this.isInputting=!0,this.debounceInputEventHandler(e,t))}}},{key:"onInputAfter",value:function(){this.input.value=""}},{key:"compositionDurationSelectionPosition",get:function(){return this._compositionDurationSelectionPosition}},{key:"currentUserInputCompositionState",get:function(){return this._currentUserInputCompositionState}}]),t}(tn.a),pn=function(e){function t(){var e;l()(this,t);var n,i=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"object"===Wt()(t._instance_)?(n=t._instance_,h()(i,n)):(t._instance_=i,e=i,h()(i,e))}return v()(t,e),u()(t,[{key:"onCommandResponseSelectionStart",value:function(){}},{key:"onCompositionUpdate",value:function(){}}]),t}(n(8860).a),fn=jt.a.CompositionInit,gn=jt.a.CompositionUpdate,vn=function(e){function t(){l()(this,t);var e,n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"object"===Wt()(t._instance_)?(e=t._instance_,h()(n,e)):(t._instance_=n,n._lastTimeInputLength=0,n._lastInputEndInSelectionState=!1,n.onInputValueChanged=n.onInputValueChanged.bind(n),n.bindEvent(),n)}return v()(t,e),u()(t,[{key:"bindEvent",value:function(){window.addEventListener(ce.default.input.ON_INPUT_VALUE_CHANGED,this.onInputValueChanged)}},{key:"clearAll",value:function(){window.removeEventListener(ce.default.input.ON_INPUT_VALUE_CHANGED,this.onInputValueChanged)}},{key:"handleUpdateSelectionAfterOnEnd",value:function(){if(this.compositionState===gn){var e=window.g_rpt.getLastLocalCommand();if(!e||!e.param||!e.param.isComposing)return!1;var t=e.param.pos,n=e.param.strlen||e.param.string.length;this.selection.setPosition(t,t+n)}}},{key:"getCompositionEndUserClickPosition",value:function(){var e=window.APP.uilManager.getModuleState(re.b.SELECTION,Ee.a.SELECTION);return e&&e.selectionStage===Ee.b.START||e.selectionStage===Ee.b.MOVE?f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getCompositionEndUserClickPosition",this).call(this):{result:!1}}},{key:"getInputValue",value:function(){return this.lastTimeInputLength===this.input.value.length?"":this.input.value.slice(this.lastTimeInputLength-this.input.value.length)}},{key:"checkIsCurrentInputError",value:function(){return this.input.element.selectionEnd!==this.input.value.length&&(window.isDebugger&&console.log("%c【Edge】-checkInput---illegal-selectionPosition","color:red",this.input.element.selectionEnd,this.input.value.length),!0)}},{key:"checkIsLastSelectEffective",value:function(){return!!this._lastInputEndInSelectionState&&(this.input.element.selectionStart!==this.input.element.selectionEnd||0===this.input.element.selectionStart)}},{key:"onInputBefore",value:function(){this.checkIsCurrentInputError()&&(this.input.element.setSelectionRange(this.input.element.value.length,this.input.element.value.length),window.isDebugger&&console.log("%c-----------【Edge-输入-onInputBefore】","color:green;","进行纠正",this.input.element.selectionEnd)),this.checkIsLastSelectEffective()&&(this._lastInputEndInSelectionState=!1,this.lastTimeInputLength=0)}},{key:"onInputAfter",value:function(){this.lastTimeInputLength=this.input.value.length,this.input.value.length>500&&(this.input.element.select(),this._lastInputEndInSelectionState=!0)}},{key:"compositionstartIsHandleStartInput",value:function(){var e=window.APP.uilManager.getModuleState(re.b.SELECTION,Ee.a.SELECTION);return!(e&&e.selectionStage===Ee.b.START||e.selectionStage===Ee.b.MOVE)}},{key:"onCompositionEndAfter",value:function(){this.lastTimeInputLength=this.input.value.length,this.updateUserInputCompositionState(fn),this.input.value.length>500?(this.input.element.select(),this._lastInputEndInSelectionState=!0):this.checkIsCurrentInputError()&&(this.input.element.setSelectionRange(this.input.element.value.length,this.input.element.value.length),window.isDebugger&&console.log("%c-----------【Edge-输入-compositionendafter】","color:green;","进行纠正",this.input.element.selectionEnd)),this.resetCompositionDurationSelectionPosition()}},{key:"onInputValueChanged",value:function(){this.lastTimeInputLength=this.input.value.length}},{key:"lastTimeInputLength",get:function(){return this._lastTimeInputLength},set:function(e){this._lastTimeInputLength=e}}]),t}(hn),yn=jt.a.CompositionInit,mn=jt.a.CompositionStart,_n=jt.a.CompositionUpdate,xn=jt.a.CompositionEnd,wn=function(e){function t(){l()(this,t);var e,n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"object"===Wt()(t._instance_)?(e=t._instance_,h()(n,e)):(t._instance_=n,n)}return v()(t,e),u()(t,[{key:"onCompositionStart",value:function(e){this.needComposing&&(this.collection.begin(Xt.b.INSERT_TEXT_WITH_COMPOSITION),this.updateUserInputCompositionState(mn),this.handleCompositionStart())}},{key:"onCompositionEnd",value:function(e){if(this.needComposing){this.collection.begin(Xt.b.INSERT_TEXT_WITH_COMPOSITION);var t=e.data;this.updateUserInputCompositionState(xn),this.compositionState!==xn&&(this.handleCompositionEnd(t),this.onCompositionEndAfter(t))}}},{key:"onCompositionEndAfter",value:function(e){e===this.input.value&&(this.input.value=""),this.updateUserInputCompositionState(yn),(_.isFirefox||_.isSafari)&&this.resetCompositionDurationSelectionPosition()}},{key:"onInput",value:function(e){if(this.onInputBefore(),this.currentUserInputCompositionState===yn){this.collection.begin(Xt.b.INSERT_TEXT_WITHOUT_COMPOSITION);var t=this.getInputValue();""!==t&&(this.isInputting=!0,this.handleDeounceInput(e,t))}}},{key:"handleCompositionEnd",value:function(e){this.compositionState===_n&&(this.updateCompositionState(xn),this.loadIpChpx(),this.compositionEndForSelection(e),this._lastCompositionEndData=e,this.updateCompositionState(yn),this.collection.end())}}]),t}(hn),kn=n(6123),bn=n(1170),Tn=n(7217),Cn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));a.shortcutHandler=Function.prototype;var o=a.workspace.input;return a.selection.selContext.isInComment()&&(o=a.workspace.commentInput||o),a.initKeyboardEventsHandler(o),a}var n;return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.currentKeyboardEventsHandler.clearAll(),kn.a.clearAll()}},{key:"initKeyboardEventsHandler",value:function(e){var t=this;this.input&&(this.input.value=""),this.input=e;var n=new en;n.init(e,this.manager.editHandler,this.selection,this.workspace);var i=void 0,a=this.isEnableComposition();(i=a?_.isEdge?new vn:_.isIPad?new wn:new hn:new pn).init(e,this.manager.editHandler,this.selection,this.workspace,a);var o=[].concat(r()(n.getInputConfig()),r()(n.getGlobalConfig())),s=[e.element];if(!0===this.app.isReadOnly()){var l=document.querySelector("body");s.push(l)}this.shortcutHandler=kn.a.bind(o,(function(e,n){var a=n.target,o=t.app.formatContentController.checkIsEditable(),r=o.allowInsert,l=o.allowDelete,c=o.allowComment,u=o.allowFormat;if(!0===e.restrictEditModeDisabled&&t.app.restrictEditHandler.isInRestrictEditMode)return!1;if(!0===e.webModDisabled&&t.app.isWebMode())return!1;if(!0===e.cachePreviewDisabled&&window.__WPSENV__.cache_preview)return!1;if(!0===e.insertWithControlDisabled&&!r)return!1;if(!0===e.deleteWithControlDisabled&&!l)return!1;if(!0===e.formatWithControlDisabled&&!u)return!1;if(!0===e.commentWithControlDisabled&&!c)return!1;if(!0===e.headerFooterDisabled&&(t.app.coreDataInvalid()||!0===t.app.data.selection.selContext.isInHeaderFooter))return!1;if(t.selection.selContext.isInComment()){if(!0===e.commentDisabled)return!1;if(!0===e.unEditableCommentDisabled&&!t.selection.selContext.isCommentEditable)return!1}return(!0!==e.offlineDisabled||!t.app.isPermanentOffline)&&((!0!==e.macDisabled||!0!==_.isMacOs)&&((!0!==e.winDisabled||!0!==_.isWindows)&&((!0!==e.composingDisabled||!0!==n.isComposing)&&((!0!==e.inputtingDisabled||!0!==i.isInputting)&&((!0!==e.textModDisabled||!t.app.data.doc.textboxs||!t.app.data.doc.textboxs.isInTextbox(t.app.data.selection.begin.position))&&((!0!==e.inReadOnlyDocumentFieldDisabled||!t.selection.selInfo.checkIsSelInReadOnlyDocumentField())&&((!0!==t.app.isReadOnly()||!0===e.readOnly)&&((!e.disabledInAllInput||!["INPUT","TEXTAREA"].includes(n.target.tagName))&&(-1!==s.indexOf(a)||(e.otherInputDisabled?e.global&&!t.workspace.isEditable(a):e.global))))))))))})),this.currentKeyboardEventsHandler=i}},{key:"initTempCommentKeyboardEventsHandler",value:function(e){this.input=e,(new en).init(e,this.manager.editHandler,this.selection,this.workspace);var t=void 0,n=this.isEnableComposition();(t=n?_.isEdge?new vn:_.isIPad?new wn:new hn:new pn).init(e,this.manager.editHandler,this.selection,this.workspace,n),this.shortcutHandler=function(){},this.currentKeyboardEventsHandler=t}},{key:"isEnableComposition",value:function(){return this.app.isEnableComposition()}},{key:"onCommandResponseonKeyboardEvent",value:function(e){this.onKeyboardEvent(e)}},{key:"onCommandResponseonSelectionOnStart",value:function(){(_.isEdge||_.isFirefox||_.isSafari)&&this.isEnableComposition()&&this.currentKeyboardEventsHandler.updatecompositionDurationSelectionPosition()}},{key:"onCommandResponseonSelectionBeforeOnStart",value:function(){this.isEnableComposition()&&this.currentKeyboardEventsHandler.dropQuickInputMessage()}},{key:"onCommandResponseonSelectionAfterOnEnd",value:function(){this.isEnableComposition()&&this.currentKeyboardEventsHandler.handleUpdateSelectionAfterOnEnd()}},{key:"onCommandResponseOnEnterCommentBody",value:function(e){Object(bn.isInTempComment)()?this.initTempCommentKeyboardEventsHandler(e):this.initKeyboardEventsHandler(e)}},{key:"onCommandResponseOnExitCommentBody",value:function(){this.initKeyboardEventsHandler(this.workspace.input)}},{key:"onPaste",value:function(e){this.manager.editHandler.paste(e)}},{key:"isEditKeyboardEventsInComment",value:function(e){var t=e.type,n=e.keyCode,i=e.shiftKey,a=e.ctrlKey,o=e.altKey,r=e.metaKey;if("keydown"===t){var s=i||a||o||r,l=this.selection.getNormalRange().len;if((n===Yt.j||n===Yt.d)&&!s&&l>0)return!0;if(n===Yt.n&&o)return!0}else if("keyup"!==t)return!0;return!1}},{key:"handleKeydownEvent",value:function(e){this.state.isActiveByKeyboard=!0;var t=Object(Tn.altModeKeydownHandler)(e,this.state.altModeState);this.state.altModeState=Object.assign(this.state.altModeState,t),this.app.functionStatus.altMode.isInAltMode&&e.altKey||this.shortcutHandler(e)}},{key:"handleKeyupEvent",value:function(e){this.state.isActiveByKeyboard=!0,Object(Tn.tryEnterAltModeOnKeyup)(e)&&(this.state.uilState=re.a.DONE)}},{key:"onKeyboardEvent",value:(n=Ot()(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,["keydown","keyup"].includes(n)||!this.isNonEditable){e.next=4;break}return this.input.value="",e.abrupt("return",this.state.uilState);case 4:this.selection.selContext.isInComment()&&this.isEditKeyboardEventsInComment(t)&&"paste"===n&&(t.preventDefault(),i=t.clipboardData||window.clipboardData,a=i.getData(_.isIE?"Text":"text/plain"),t.textInClipboard=a),e.t0=n,e.next="keydown"===e.t0?9:"keyup"===e.t0?11:"input"===e.t0?13:"compositionstart"===e.t0?15:"compositionupdate"===e.t0?17:"compositionend"===e.t0?19:"paste"===e.t0?21:23;break;case 9:return this.handleKeydownEvent(t),e.abrupt("break",24);case 11:return this.handleKeyupEvent(t),e.abrupt("break",24);case 13:return this.state.isActiveByKeyboard?this.currentKeyboardEventsHandler.onInput(t):this.input.value="",e.abrupt("break",24);case 15:return this.currentKeyboardEventsHandler.onCompositionStart(t),e.abrupt("break",24);case 17:return this.currentKeyboardEventsHandler.onCompositionUpdate(t),e.abrupt("break",24);case 19:return this.currentKeyboardEventsHandler.onCompositionEnd(t),e.abrupt("break",24);case 21:return this.onPaste(t),e.abrupt("break",24);case 23:return e.abrupt("break",24);case 24:return e.abrupt("return",this.state.uilState);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,isActiveByKeyboard:_.isPad||!this.isEnableComposition(),altModeState:{isPressingAltKeyOnly:!1,canEnterAltModeOnKeyup:!1}}}},{key:"isNonEditable",get:function(){var e=this.app,t=e.formatContentController,n=e.isPermanentOffline,i=this.selection.selInfo.checkIsSelInReadOnlyDocumentField(),a=t.checkIsEditable().allowInsert,o=this.selection.selInfo.info.isSelectionRangeNonEditable,r=this.checkIsOutTextFormField();return n||t.isRestrictEditMode&&!t.checkIsInContentControl()&&r||!this.app.isReadOnly()&&!a||i||o}}]),t}(le.a);Cn.events=[{type:"input",target:Pe.a.input,flag:Pe.b.native},{type:"compositionstart",target:Pe.a.input,flag:Pe.b.native},{type:"compositionupdate",target:Pe.a.input,flag:Pe.b.native},{type:"compositionend",target:Pe.a.input,flag:Pe.b.native},{type:"paste",target:Pe.a.input,flag:Pe.b.native},{type:"keydown",target:Pe.a.window,flag:Pe.b.native},{type:"keyup",target:Pe.a.window,flag:Pe.b.native}];var Sn=Cn,En=n(1090),Pn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.selection.attachObserver(a),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return n&&this.isRestrictEditMode&&!this.checkIsInContentControl(n.position)?this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"initConfig",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initConfig",this).call(this),this.config=a()({},this.config,{hasContextMenu:!0})}},{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.selection.detachObserver(this)}},{key:"closeCardMenu",value:function(){ce.default.dispatchEvent(ce.default.hyperLink.ON_LINK_CARD_SWITCH,{visible:!1}),this.state.isHyperlinkMenuVisible=!1}},{key:"openCardMenu",value:function(e,t){var n=Object(En.getStageInfo)(t.hyperLink.getAddress());ce.default.dispatchEvent(ce.default.hyperLink.ON_LINK_CARD_SWITCH,{visible:!0,position:e,hyperLink:t.hyperLink,urlStatus:n&&n.status})}},{key:"handleMouseDownOnHyperlink",value:function(e){if(this.timer&&clearTimeout(this.timer),this.timer=null,!this.app.isReadOnly()){var t=e.hyperLink;if(t){if(t.isKWProtocolAddress())return;var n=e.ctrlInfos,i=void 0===n?[]:n,a=e.height,o=e.posY,r=e.pos,s=t.field,l=s.begin,c=s.end;if(this.isRestrictEditMode&&i[0]&&l<i[0].begin)return;var u=this.workspace.getCurrentRect(),d=u.offsetTop,h=u.top;this.openCardMenu(this.utils.adjustContextMenuPos(r.x,o+a,0,d-h),e),l!==this.state.field.begin&&c!==this.state.field.end&&window.collection("commandbar","click","pop_hyperlink_show"),this.state.field={begin:l,end:c}}else this.closeCardMenu(),this.resetState()}}},{key:"handleMouseMoveOnHyperlink",value:function(e,t){var n=this;this.timer&&clearTimeout(this.timer),this.timer=null;var i=t.type;if(i===b.a.HYPERLINK||i===b.a.TABLE_HYPERLINK){document.querySelector(".link-btn-group")||(this.timer=setTimeout((function(){n.handleMouseDownOnHyperlink(t)}),1e3));var a=!Object(oe.c)(e)&&!this.app.isReadOnly()||t.hyperLink.isKWProtocolAddress()?this.getNormalCursor(t):ue.cursorTypes.hand;t.hyperLink.isFileLinkAddress()&&(a=ue.cursorTypes.hand),this.workspace.toggleContainerPointerStyle(a)}}},{key:"onMouseEvent",value:function(e,t){if(!t)return this.state.uilState;switch(e.type){case"mousedown":this.handleMouseDownOnHyperlink(t);break;case"mousemove":this.handleMouseMoveOnHyperlink(e,t)}return this.state.uilState}},{key:"onTap",value:function(e,t){_.isPad&&this.handleMouseDownOnHyperlink(t)}},{key:"onGestureEvent",value:function(e,t){var n=e.type,i=e.event;return n===ae.a.TAP&&this.onTap(i,t),this.state.uilState}},{key:"onWindowEvent",value:function(e){var t=this,n=e.type;return this._scrollHandler||(this._scrollHandler=window.utils.Lodash.throttle((function(){t.state.isHyperlinkMenuVisible&&(t.closeCardMenu(),t.resetState())}),50)),"scroll"===n&&this._scrollHandler(),this.state.uilState}},{key:"onKeyboardEvent",value:function(e,t){switch(e.type){case"keydown":var n=(t||{}).hyperLink;n&&!Object(oe.d)(e)&&Object(oe.c)(e)&&!n.isKWProtocolAddress()&&(this.state.cursorStatus=!0,this.workspace.toggleContainerPointerStyle(ue.cursorTypes.hand));break;case"keyup":this.state.cursorStatus&&(this.workspace.toggleContainerPointerStyle(this.getNormalCursor(t)),this.state.cursorStatus=!1),this.state.isHyperlinkMenuVisible&&(this.closeCardMenu(),this.resetState())}return this.state.uilState}},{key:"onSelectionChanged",value:function(e,t){var n=this;this._selectionChangedHandler||(this._selectionChangedHandler=window.utils.Lodash.throttle((function(){var e=n.selection,t=e.begin,i=e.end;t.position!==i.position&&n.state.isHyperlinkMenuVisible&&(n.selection.selInfo.getHyperlink()||(n.closeCardMenu(),n.resetState()))}),50)),this._selectionChangedHandler()}},{key:"onCommandResponseResetUILModule",value:function(){this.resetState()}},{key:"getNormalCursor",value:function(e){var t=e&&e.glyphGroupInfo;return t&&Object(ct.a)(t)&&!e.isFuzzyHit?ue.cursorTypes.footnote_placeholder:ue.cursorTypes.text}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,cursorStatus:!1,field:{begin:-1,end:-1}}}}]),t}(le.a);Pn.events=[{type:"mousedown",target:Pe.a.view,flag:Pe.b.native},{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"scroll",target:Pe.a.workspaceElement,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"keydown",target:Pe.a.window,flag:Pe.b.native},{type:"keyup",target:Pe.a.window,flag:Pe.b.native},{type:ae.a.TAP,target:Pe.a.view,flag:Pe.b.gesture}];var Ln=Pn,An=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.onResize=window.utils.Lodash.throttle((function(){a.showDatetimeConfig()}),100),a.selection.attachObserver(a),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return n&&this.isRestrictEditMode&&!this.checkIsInContentControl(n.position)?this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.selection.detachObserver(this)}},{key:"_getComponentInfo",value:function(e){var t=e.maxLayoutIndex,n=e.maxTextPage,i=e.displayFormat,a=e.isShowLunar,o=e.isShowTime,r=e.rects,s=e.pointsMap,l=r[t].get(n),c={rect:X.a.initByRawRect(l[l.length-1]),maskSize:{width:this.workspace.container.cacheDOMAttr.clientWidth,height:this.workspace.container.cacheDOMAttr.clientHeight},displayFormat:i,isShowLunar:a,isShowTime:o,range:{pos:e.pos,len:e.len}},u=c.rect,d=u.width,h=u.left,p=u.bottom,f=c.rect.height,g=s[t].get(n),v=g[g.length-1],y=Math.floor((v.length-1)/4),m=p-X.a.initByRawRect(l[0]).top;return{config:c,wrapperPos:{top:p,left:h},btnRect:{top:-(f=v[2*y].y-v[2*y-1].y),left:d,height:f},offset:m}}},{key:"_updateActiveControl",value:function(e){var t=void 0;if(this.app.isWebMode()){var n=this.app.formatContentController.getActiveControlBelongingTextPage(e),i=this.app.formatContentController.getActiveControlPointsMap(e),o=(new Map).set(n,[].concat(r()(i)));t=a()({},e,{pointsMap:{0:o}})}else t=e;t._isShow=!0,this.selection.activeDateCtrls=[t]}},{key:"_resetActiveControl",value:function(){this.selection.activeDateCtrls=[]}},{key:"_showConfig",value:function(e,t){var n=this._getComponentInfo(e);this.workspace.dateTimeFloatMenus.update(a()({ctrlInfo:e,visible:!0,isShowPanel:t},n)),this.state.hasShowConfig=!0,this.state.ctrlInfo=e,this._updateActiveControl(e),this.workspace.refreshDryly()}},{key:"_updateConfig",value:function(e){var t=this._getComponentInfo(e);this.workspace.dateTimeFloatMenus.update(a()({visible:!0},t)),this.state.ctrlInfo=e,this._updateActiveControl(e),this.workspace.refreshDryly()}},{key:"_closeConfig",value:function(){this.state.hasShowConfig&&(this.state.hasShowConfig=!1,this.workspace.dateTimeFloatMenus.update({visible:!1,isShowPanel:!1}),this.state.ctrlInfo=null,this._resetActiveControl(),this.workspace.refreshDryly())}},{key:"_isHitOnHotSpot",value:function(e){if(!this.state.ctrlInfo)return!1;var t=e;this.app.isWebMode()&&(t={x:e.x-this.data.typoinfo.viewOffset.x,y:e.y-this.data.typoinfo.viewOffset.y});var n=this.state.ctrlInfo.rects,i=null;return Object.keys(n).some((function(e){for(var o=n[e].entries(),r=o.next();!r.done;){for(var s=r.value[1],l=s.length-1,c=0;c<s.length;++c){if(i=s[c],c===l&&(i=a()({},i,{right:i.right+14})),X.a.pointInRect(t,i))return!0}r=o.next()}return!1}))}},{key:"showDatetimeConfig",value:function(e,t){var n=this.app.formatContentController.isRestrictEditMode;if(e){var i=e.ctrlInfos||[],a=k()(i,1)[0],o=this.app.formatContentController.checkIsInContentControl(e.position);if(n&&!o)return;a&&a.isDate&&(a.ctrl=a,this._showConfig(a,!1))}else{var r=this.selection.getNormalRange().pos,s=this.app.formatContentController.checkIsInContentControl(r);if(n&&!s)return;t&&(r-=2);var l=D.b.locate(this.data,r,!1,this.data.typoinfo);H.a.hit(this.app,this.data,l.pos,l);var c=l.ctrlInfos||[],u=k()(c,1)[0];u&&u.isDate&&(u.ctrl=u,this._showConfig(u,this.state.isApplyingDatetime))}}},{key:"hideDatetimeConfig",value:function(){this._closeConfig()}},{key:"onDatetimeConfigPanelVisibleChange",value:function(e){var t=e.detail.visible;this.state.hasShowPanel=t}},{key:"onSelectionChanged",value:function(e,t){var n=this;this._selectionChangedHandler||(this._selectionChangedHandler=window.utils.Lodash.throttle((function(){var e=n.selection.getNormalRange(),t=e.pos,i=e.len;if(n.data.doc.getSubDocType(t)!==A.Comment){if(n.state.isApplyingDatetime)return n.state.cursorInDate=!0,n.showDatetimeConfig(null,!0),void(n.state.isApplyingDatetime=!1);var a=~(t-1)?t-1:0,o=(n.data.doc.contentControls.collect(a,1)||[]).find((function(e){return e.isDate}));if((!i||n.selection.isComposing||o&&i<o.len)&&o&&~(t-1)&&a<o.pos+o.len-1)return n.state.cursorInDate=!0,void n.showDatetimeConfig();n.state.cursorInDate=!1,n.hideDatetimeConfig()}}),60)),this._selectionChangedHandler()}},{key:"onMouseEvent",value:function(e,t){if("mousemove"===e.type){var n=this.state,i=n.hasShowConfig,a=n.hasShowPanel,o=t.pos;if(a)return this.state.uilState;var r=this._isHitOnHotSpot(o),s=t.ctrlInfos||[],l=k()(s,1)[0];if(l&&l.isDate){if(i&&r)return this.state.uilState;this.state.cursorInDate=!1,this.showDatetimeConfig(t,!1,!0)}else i&&r||this.state.cursorInDate||a||this.hideDatetimeConfig()}return this.state.uilState}},{key:"onCustomEvent",value:function(e){switch(e.type){case ce.default.contentControls.BEFORE_CONTENT_CONTROLS_DATE_APPLY:this.state.isApplyingDatetime=!0;break;case ce.default.names.ON_DATETIME_CONFIG_PANEL_VISIBLE_CHANGE:this.onDatetimeConfigPanelVisibleChange(e);break;case ce.default.names.DOC_WORKSPACE_AFTER_RESIZE:this.onResize()}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,isApplyingDatetime:!1,cursorInDate:!1,hasShowConfig:!1,hasShowPanel:!1}}}]),t}(le.a);An.events=[{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:ce.default.names.ON_DATETIME_CONFIG_PANEL_VISIBLE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_WORKSPACE_AFTER_RESIZE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.contentControls.BEFORE_CONTENT_CONTROLS_DATE_APPLY,target:Pe.a.window,flag:Pe.b.native}];var In=An,Rn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.onResize=window.utils.Lodash.throttle((function(){a.showCatalogConfig()}),100),a.selection.attachObserver(a),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return n&&this.isRestrictEditMode&&!this.checkIsInOuterCtrl(n.position,n.catalogInfos)?this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.selection.detachObserver(this)}},{key:"checkIsInOuterCtrl",value:function(e,t){var n=this.formatContentController.getOuterMostControl(e);return!!n&&(!(t&&t.length>0)||t.every((function(e){return e.begin>n.begin&&e.end<n.end})))}},{key:"isHitOnHotSpot",value:function(e,t){var n=e.pos,i=this.state.catalogInfo;if(!i)return!1;var o=n;if(this.app.isWebMode()&&(o={x:n.x-this.data.typoinfo.viewOffset.x,y:n.y-this.data.typoinfo.viewOffset.y}),this.app.isPCMode()){var r=e.layoutIndex,s=e.line,l=s.isInTable&&i.pos<s.parent.range.pos?U.getTextpage(s.parent.parent.parent):U.getTextpage(s),c=!!i.rects[r]&&i.rects[r].get(l);return!!c&&(c=a()({},c,{top:t?c.top-24:c.top}),X.a.pointInRect(o,c))}var u=null;return Object.keys(i.rects).some((function(e){for(var n=i.rects[e].entries(),r=n.next();!r.done;){var s=r.value[1];if(u=a()({},s,{top:t?s.top-24:s.top}),X.a.pointInRect(o,u))return!0;r=n.next()}return!1}))}},{key:"isSelectionInCatalog",value:function(e){if(!e)return!1;var t=this.app.data.selection.getNormalRange(),n=t.pos,i=t.len,a=e.begin,o=e.end;return a<n&&o>n+i}},{key:"getComponentInfo",value:function(e,t){var n=e.rects,i=void 0;if(this.app.isPCMode()){var a=t.layoutIndex,o=t.line,r=o.isInTable&&e.pos<o.parent.range.pos?U.getTextpage(o.parent.parent.parent):U.getTextpage(o);i=n[a].get(r)}else Object.keys(n).forEach((function(e){for(var t=n[e].entries(),a=t.next();!a.done;){var o=a.value[1];i||(i=o),i=i.top<o.top?i:o,a=t.next()}}));var s=X.a.initByRawRect(i);return{btnRect:{top:s.top,left:s.left+s.width/2}}}},{key:"updateActiveCatalog",value:function(e){var t=e;if(this.app.isWebMode()){var n=this.app.formatContentController.getActiveControlBelongingTextPage(e),i=this.getWebPagePoints(e),o=(new Map).set(n,[].concat(r()(i)));t=a()({},e,{pointsMap:{0:o}})}this.selection.activeCatalogs=[t]}},{key:"getWebPagePoints",value:function(e){var t=e.begin,n=e.end,i=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;return this.data.typoinfo.textLineRanges.forEachHintInRange(t,n,(function(e){var n=e._node.line;n.isInTable&&t<n.parent.range.pos&&(n=n.parent.parent.parent);var s=C.a.getPosition2viewForMobile(n.parent),l=s.x+n.rect.left,c=l+n.rect.width,u=s.y+n.rect.top,d=u+n.rect.height;i=i<l?i:l,a=a>c?a:c,o=o<u?o:u,r=r>d?r:d}),I.IT.strictIntersectTest),[[{x:i-=1,y:o-=1},{x:a+=1,y:o},{x:a,y:r+=1},{x:i,y:r},{x:i,y:o}]]}},{key:"resetActiveControl",value:function(){this.selection.activeCatalogs=[]}},{key:"showConfig",value:function(e,t){var n={layoutIndex:t.layoutIndex,line:t.line},i=this.getComponentInfo(e,n);this.workspace.catalogFloatMenus.update(a()({range:{pos:e.pos,len:e.len},visible:!0},i)),this.state.hasShowConfig=!0,this.state.catalogInfo=e,this.updateActiveCatalog(e),this.workspace.refreshDryly()}},{key:"hideCatalogConfig",value:function(){if(this.state.hasShowConfig)this.state.hasShowConfig=!1,this.workspace.catalogFloatMenus.update({visible:!1}),this.state.catalogInfo=null,this.resetActiveControl(),this.workspace.refreshDryly();else{var e=this.selection.activeCatalogs;e&&e.length>0&&this.resetActiveControl()}}},{key:"showCatalogConfig",value:function(e,t){var n=e?e.position:this.selection.getNormalRange().pos,i=this.app.formatContentController.isRestrictEditMode,a=this.app.formatContentController.checkIsInContentControl(n);if(!i||a){!e&&t&&(n-=2);var o=void 0;e?o=e:(o=D.b.locate(this.data,n,!1,this.data.typoinfo),U.hit(this.app,this.data,o.pos,o));var r=o.catalogInfos||[],s=k()(r,1)[0];s&&this.showConfig(s,o,!1)}}},{key:"onSelectionChanged",value:function(){var e=this;this._selectionChangedHandler||(this._selectionChangedHandler=window.utils.Lodash.throttle((function(){var t=e.selection.getNormalRange(),n=t.pos,i=t.len;if(e.data.doc.getSubDocType(n)!==A.Comment){if(e.state.isApplyingCatalog)return e.state.cursorInCatalog=!0,e.showCatalogConfig(null,!0),void(e.state.isApplyingCatalog=!1);var a=~(n-1)?n-1:0,o=U.getCatalogs(e.data,{position:n})[0];if(!(!e.isRestrictEditMode||e.checkIsInOuterCtrl(a,o?[o]:null)))return e.state.cursorInCatalog=!1,void e.hideCatalogConfig();if((!i||e.selection.isComposing)&&o&&~(n-1)&&a<o.pos+o.len-1)return e.state.cursorInCatalog=!0,void e.showCatalogConfig();if(o){var r=e.isSelectionInCatalog(o);return e.state.cursorInCatalog=r,void(r?e.showCatalogConfig():e.hideCatalogConfig())}e.state.cursorInCatalog=!1,e.hideCatalogConfig()}}),60)),this._selectionChangedHandler()}},{key:"onCatalogConfigPanelVisibleChange",value:function(e){var t=e.detail.visible;this.state.hasShowPanel=t,t&&(this.state.isTipShowEnoughTime=!0,this.hideCatalogTip())}},{key:"hideCatalogTip",value:function(){this.tipTimer&&(clearTimeout(this.tipTimer),this.tipTimer=null),this.state.isShowTip&&this.handleVisibleTip(!1)}},{key:"handleVisibleTip",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.state.isShowTip=e,e){var n=a()({},t.pos);if(this.app.isWebMode()){var i=this.data.typoinfo.viewOffset,o=i.x,r=i.y;n.x=n.x-o,n.y=n.y-r}ce.default.dispatchEvent(ce.default.catalog.SHOW_CATALOG_TIP,{isShowTip:e,tipPos:n})}else ce.default.dispatchEvent(ce.default.catalog.SHOW_CATALOG_TIP,{isShowTip:e})}},{key:"onMouseEvent",value:function(e,t){var n=this;if("mousemove"===e.type){var i=this.state,a=i.hasShowConfig,o=i.hasShowPanel,r=i.cursorInCatalog,s=i.isTipShowEnoughTime;if(o)return this.state.uilState;if(!t)return;var l=this.isHitOnHotSpot(t,!0),c=t.catalogInfos||[],u=k()(c,1)[0],d=this.isHitOnHotSpot(t,!1);if((u||a)&&d?s||(this.handleVisibleTip(!0,t),this.tipTimer||(this.tipTimer=setTimeout((function(){n.state.isTipShowEnoughTime=!0,n.handleVisibleTip(!1),n.tipTimer=null}),3e3))):(this.hideCatalogTip(),s&&(this.state.isTipShowEnoughTime=!1)),a&&l)return this.state.uilState;u?(this.state.cursorInCatalog=!1,this.showCatalogConfig(t,!1)):r||o||this.hideCatalogConfig()}return this.state.uilState}},{key:"onCustomEvent",value:function(e){switch(e.type){case ce.default.catalog.BEFORE_CATALOG_APPLY:this.state.isApplyingCatalog=!0;break;case ce.default.catalog.ON_CATALOG_CONFIG_PANEL_VISIBLE_CHANGE:this.onCatalogConfigPanelVisibleChange(e);break;case ce.default.names.DOC_WORKSPACE_AFTER_RESIZE:this.onResize()}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,hasShowConfig:!1,hasShowPanel:!1,cursorInCatalog:!1,isApplyingCatalog:!1,isShowTip:!1,isTipShowEnoughTime:!1}}}]),t}(le.a);Rn.events=[{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:ce.default.catalog.ON_CATALOG_CONFIG_PANEL_VISIBLE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_WORKSPACE_AFTER_RESIZE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.catalog.BEFORE_CATALOG_APPLY,target:Pe.a.window,flag:Pe.b.native}];var On=Rn,Mn=n(3490),Dn=n(4978),Nn=n(8861),Bn=n(4979),jn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.selection.attachObserver(a),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.selection.detachObserver(this)}},{key:"_getContentBlockOptions",value:function(e){var t=e.contentBlock,n={isDeletable:!0};return t&&(n.isDeletable=!t.lockControl),n}},{key:"_getContentsByCtrlInfos",value:function(e){var t=e.ctrlInfos,n=e.range,i=this.state.templateType;return{contentBlock:((t?window.utils.Lodash.groupBy(t,Dn.a.bind(null,i)):n?Nn.a.getCtrls({range:n,templateType:i}):{})[Mn.a]||[])[0]}}},{key:"_getActiveCtrls",value:function(e){var t=e.contentBlock;return t.highlightType=Bn.a.DOTTED_BOX,[t].filter(Boolean)}},{key:"_isPosInCtrl",value:function(e,t,n){return n&&(e>n.begin&&e<n.end||e===n.begin&&!!t)}},{key:"showContentBlockFloatMenus",value:function(e,t){this.state.isContentBlockActive=!0,this.state.ctrlInfo=e,this.workspace.contentBlockFloatMenus.update(a()({visible:!0},t))}},{key:"hideContentBlockFloatMenus",value:function(){this.state.isContentBlockActive&&(this.state.isContentBlockActive=!1,this.state.ctrlInfo=null,this.workspace.contentBlockFloatMenus.update({visible:!1}))}},{key:"updateContentBlockFloatMenus",value:function(e,t){var n=this._getContentsByCtrlInfos({range:{pos:e,len:t}}).contentBlock;if(this._isPosInCtrl(e,t,n)){var i=D.b.locate(this.data,this.data.doc.gcpToCp(e).cp,!1,this.data.typoinfo);H.a.hit(this.app,this.data,i.pos,i);var a=i.ctrlInfos,o=void 0===a?[]:a,r=i.subDocType===A.MainText,s=this._getContentsByCtrlInfos({ctrlInfos:o}).contentBlock;if(s&&r)return this.selection.activeCtrls=this._getActiveCtrls({contentBlock:s}),this.showContentBlockFloatMenus(s,{blockRects:s.rects,options:this._getContentBlockOptions({contentBlock:s})}),void ce.default.dispatchEvent(ce.default.guide.SWITCH_GUIDE_CONTENT,{title:s.title,tag:s.tag})}this.selection.activeCtrls=[],this.hideContentBlockFloatMenus(),ce.default.dispatchEvent(ce.default.guide.SWITCH_GUIDE_CONTENT,{title:"",tag:""})}},{key:"isClickOnContentBlock",value:function(e,t){if(!t)return!1;var n=t.rects;return Object.keys(n).some((function(t){for(var i=n[t].entries(),a=i.next();!a.done;){for(var o=a.value[1],r=0;r<o.length;++r){var s=o[r];if(e.x>=s.left&&e.x<=s.right&&e.y>=s.top&&e.y<=s.bottom)return!0}a=i.next()}return!1}))}},{key:"isClickOnAnotherContentBlock",value:function(e){return!this.state.ctrlInfo||this.state.ctrlInfo.title!==e.title&&this.state.ctrlInfo.tag!==e.tag}},{key:"checkIfContentStructureChanged",value:function(){var e=this,t=Nn.a.getCtrls({templateType:this.state.templateType,contentType:Mn.a}),n=!1;this.state.ctrlInfos&&this.state.ctrlInfos.length===t.length&&(t.forEach((function(t){~e.state.ctrlInfos.findIndex((function(e){return e.title===t.title&&e.tag===t.tag}))||(n=!0)})),!n)||(this.state.ctrlInfos=t,ce.default.dispatchEvent(ce.default.guide.ON_CONTENT_STRUCTURE_CHANGED,{ctrlInfos:t}))}},{key:"handleMouseDownInTemplate",value:function(e){var t=(e.ctrlInfos||[]).filter((function(e){return e.isRichText})),n=e.subDocType===A.MainText;if(t.length>0&&n){var i=this._getContentsByCtrlInfos({ctrlInfos:t}).contentBlock;if(this.isClickOnContentBlock(e.pos,i))return this.selection.activeCtrls=this._getActiveCtrls({contentBlock:i}),this.showContentBlockFloatMenus(i,{blockRects:i.rects,options:this._getContentBlockOptions({contentBlock:i})}),void ce.default.dispatchEvent(ce.default.guide.SWITCH_GUIDE_CONTENT,{title:i.title,tag:i.tag})}this.selection.activeCtrls=[],this.hideContentBlockFloatMenus(),ce.default.dispatchEvent(ce.default.guide.SWITCH_GUIDE_CONTENT,{title:"",tag:""}),this.resetState()}},{key:"handleResizeInTemplate",value:function(){this.state.isContentBlockActive&&this.updateContentBlockFloatMenus(this.selection.begin.position,1)}},{key:"handleSelectionChangedInTemplate",value:function(e){if(this.checkIfContentStructureChanged(),e&&(e.isEditing||e.activateCtrl)){var t=this.selection.getNormalRange(),n=t.pos,i=t.len;this.app.updater.updateToPosInContext(this.data,n+i),this.updateContentBlockFloatMenus(n,i),this.workspace.refreshDryly()}}},{key:"handleUILOperationInTemplate",value:function(){var e=this.selection.getNormalRange(),t=e.pos,n=e.len;this.app.updater.updateToPosInContext(this.data,t+n),this.updateContentBlockFloatMenus(t,n),this.workspace.refreshDryly()}},{key:"onMouseEvent",value:function(e,t){if(this.state.isTemplate)return"mousedown"===e.type&&this.handleMouseDownInTemplate(t),this.state.uilState}},{key:"onGestureEvent",value:function(e,t){if(this.state.isTemplate){switch(e.type){case ae.a.START:this.handleMouseDownInTemplate(t)}return this.state.uilState}}},{key:"onWindowEvent",value:function(e){var t=this,n=e.type;this._resizeHandler||(this._resizeHandler=window.utils.Lodash.debounce((function(){t.state.isTemplate&&t.handleResizeInTemplate()}),500)),"resize"===n&&this._resizeHandler()}},{key:"onSelectionChanged",value:function(e,t){var n=this;this._selectionChangedHandler||(this._selectionChangedHandler=window.utils.Lodash.throttle((function(e){n.state.isTemplate&&n.handleSelectionChangedInTemplate(e)}),60)),this._selectionChangedHandler(t)}},{key:"onUILOperationTriggered",value:function(e,t,n,i){var a=this;this.state.isTemplate&&(this._UILOperationHandler||(this._UILOperationHandler=window.utils.Lodash.throttle((function(){a.handleUILOperationInTemplate()}),16)),this._UILOperationHandler(t))}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,templateType:this.data.doc.templateType,isTemplate:this.data.doc.isTemplate,isContentBlockActive:!1}}}]),t}(le.a);jn.events=[{type:"mousedown",target:Pe.a.view,flag:Pe.b.native},{type:"resize",target:Pe.a.window,options:{throttleParams:[16]},flag:Pe.b.native},{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture}];var Fn=jn,Hn="PLUGIN_SUCCESS_TIPS",Gn="PLUGIN_ERROR_TIPS",Un=n(342),Wn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));_.isPad&&(a.app.appApi.keyboardHeight=0),a._normalWorkspaceScrollEventHandler=a._normalScroll.bind(a);var o=document.querySelector(".filename-wrap");return o&&MutationObserver&&(a.fileNameDOMObserver=new MutationObserver((function(){o.querySelector("input")?a.app.workspace.switchIndicatorState(!1):(a.app.workspace.switchIndicatorState(!0),a.app.workspace.focusWithoutScroll())})),a.fileNameDOMObserver.observe(o,{childList:!0,subtree:!0})),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return[].concat(r()(t.events),r()(t.preferredEvents))}}]),u()(t,[{key:"clearAll",value:function(){this._removeNormalScrollEvent(),f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.fileNameDOMObserver&&this.fileNameDOMObserver.disconnect()}},{key:"onComponentChange",value:function(e){var t=this,n=e.detail.visible;n?this.state._panelOrModalCount+=1:this.state._panelOrModalCount-=1,this.state._panelOrModalCount>0?(n&&1===this.state._panelOrModalCount&&(_.isPad?this.workspace.switchIndicatorState(!1):this.manager.uiHandler.handleFocusEvent(!1)),this.state.timeoutKey&&(clearTimeout(this.state.timeoutKey),this.state.timeoutKey=null)):this.state.timeoutKey=setTimeout((function(){document.activeElement&&!t.app.functionStatus.altMode.isInAltMode&&(t.workspace.isEditable()&&document.activeElement!==t.input.element||(_.isPad?t.workspace.switchIndicatorState(!0):t.manager.uiHandler.handleFocusEvent(!0)))}),100)}},{key:"offsetView",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return isNaN(e)||isNaN(t)?(console.error("偏移值不合法..."),!1):(0!==e||0!==t)&&(this.data.typoinfo.offsetView(e,t),this.workspace.refreshDryly(),this.workspace.resize(),n.isResetSelection?this.selection.setPosition(0,0,{isSend:!0,preventScroll:!0}):this.selection.validateSelection(),!0)}},{key:"switchFilename",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.data.typoinfo,r=a()({},this.data.doc.docInfo,t),s=r.woTemplateFileNameVisible,l=o.getFilenameHeight(),c=s?l:-l,u=this.workspace.element.cacheDOMAttr.scrollTop,d=!e&&u>=o.verticalPadding,h=function(){if(i&&!n.offsetView(0,c,{isResetSelection:d}))return!1;var e=o.width-2*o.horizontalPadding,t=o.verticalPadding,a=n.workspace.canvasHandler.fileNameContainerDiv;n.workspace.refreshWebView(r),ce.default.dispatchEvent(ce.default.webMode.ON_FILENAME_SWITCH,{containerWidth:e,containerHeight:t,docInfo:r,containerDiv:a})};0===u||e?h():(this.workspace.scrollerHelper.toY(0),setTimeout(h,400))}},{key:"onFilenameSettingChanged",value:function(e){var t=this,n=e.detail,i=n.isVisible,a=n.shouldAdjustOffset,o=this.data.doc.docInfo,r=o.woTemplateTypoMode,s=o.woTemplateFileNameVisible,l=o.woTypoMode;i!==s&&"web"===(r||l)&&(this.state.isChangingFilenameSetting=!0,this.manager.editHandler.setDocProps([{name:"woTemplateFileNameVisible",val:i}],(function(e){var n=e.success,i=e.result,o=void 0===i?{}:i;n&&t.switchFilename(!1,o,a)})))}},{key:"onSetDocProp",value:function(e){var t=e.detail,n=t.error,i=t.result;0===n&&(void 0!==i.woTemplateFileNameVisible&&(this.state.isChangingFilenameSetting||this.switchFilename(!0,i)),this.state.isChangingFilenameSetting=!1)}},{key:"onFocus",value:function(e){this.handleFocusOnWindow(e),this.manager.uiHandler.handleFocus()}},{key:"onBlur",value:function(){this.manager.uiHandler.handleBlur()}},{key:"isClickOnDropdown",value:function(e){return e.target.classList.contains("dropdown")||e.target.closest(".dropdown")}},{key:"isPanelExpand",value:function(e){return e.target.classList.contains("selected")||e.target.closest(".selected")}},{key:"onClick",value:function(e){var t=this,n=this.app.workspace.isEditable(e.target);if(this.app.workspace.input.IsFocusOther=!1,n){var i=document.querySelector(".word-component-task-pane");i&&i.contains(e.target)&&(this.app.workspace.input.IsFocusOther=!0)}if(_.isPad&&n&&this.app.workspace.switchIndicatorState(!1),!(this.app.isReadOnly()||this.app.workspace.waterdrop._cursor._lockShow||n||_.isPad&&(this.isClickOnDropdown(e)||e.target.classList.contains("prevent-focus-in-ipad")||e.target.closest(".prevent-focus-in-ipad")))){if(this.header=this.header||document.querySelector(".component-header"),this.header&&(e.target===this.header||this.header.contains(e.target))){if(this.shareBtnWrap=this.shareBtnWrap||document.querySelector(".share-link-btn-wrap"),this.shareBtnWrap&&this.shareBtnWrap.contains(e.target))return;this.workspace.shouldFocusWithoutScroll()}this.commandBar=this.commandBar||document.querySelector(".wps-cmd-bar"),this.commandBar&&(this.commandBar===e.target||this.commandBar.contains(e.target))&&this.workspace.shouldFocusWithoutScroll(),this.statusBar=this.statusBar||document.querySelector(".cmd-status-bar"),_.isPad||!this.statusBar||this.statusBar!==e.target&&!this.statusBar.contains(e.target)||this.workspace.shouldFocusWithoutScroll();var a=document.querySelector(".word-component-task-pane");a&&(a===e.target||a.contains(e.target))&&this.workspace.shouldFocusWithoutScroll();var o=document.querySelector(".component-notice");o&&o.contains(e.target)&&this.workspace.shouldFocusWithoutScroll(),window.__WPSPLUGIN__.helper.has(Un.PLUGIN_TYPE.AT)&&(this.pluginContainers=document.querySelectorAll(".plugin_container"),this.pluginContainers&&this.pluginContainers.length>0&&Array.from(this.pluginContainers).some((function(n){if(n===e.target||n.contains(e.target))return t.workspace.switchIndicatorState(!1),!0})))}}},{key:"_normalScroll",value:function(){this.manager.uiHandler.scrollPageNum()}},{key:"_addNormalScrollEvent",value:function(){this.state._isScrollEventAdded||(this.workspace.element.addEventListener("scroll",this._normalWorkspaceScrollEventHandler),this.state._isScrollEventAdded=!0)}},{key:"_removeNormalScrollEvent",value:function(){this.state._isScrollEventAdded&&(this.workspace.element.removeEventListener("scroll",this._normalWorkspaceScrollEventHandler),this.state._isScrollEventAdded=!1)}},{key:"_showNotifyToast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userid,n=e.cmdName,i=e.type;if(t&&t!==this.app.info.userid){var a=zt.default.cooper.getCooperCenter().getCooperationUsers().get(t);if(a)if("insertInks"===n)(this._lastShowInsertInkTipsTime<=Date.now()||!this._lastShowInsertInkTipsTime)&&(this._lastShowInsertInkTipsTime=Date.now()+3e5,this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.selectionUil.insertInkTip", "{0} An ink object is inserted, you can try to switch the page layout to view").replace("{0}",a.name)));else if("formatOp"===n)switch(i){case an.Sec_PageOrientation:this.workspace.showToast("warn",(""+_i18n("applications.writer.components.core.event.uil.selectionUil.changed", "{0}Adjusted {1}")).replace("{0}",a.name).replace("{1}",_i18n("applications.writer.components.core.event.uil.selectionUil.paperDirection", "Paper direction")));break;case an.Sec_Margins:this.workspace.showToast("warn",(""+_i18n("applications.writer.components.core.event.uil.selectionUil.changed", "{0}Adjusted {1}")).replace("{0}",a.name).replace("{1}",_i18n("applications.writer.components.core.event.uil.selectionUil.pageMargin", "Margins")));break;case an.Sec_PageSize:this.workspace.showToast("warn",(""+_i18n("applications.writer.components.core.event.uil.selectionUil.changed", "{0}Adjusted {1}")).replace("{0}",a.name).replace("{1}",_i18n("applications.writer.components.core.event.uil.selectionUil.paperSize", "Paper Size")))}}}},{key:"onMouseMove",value:function(e){e.currentTarget===this.workspace.element&&(this.manager.uiHandler.updatePageNum(e)?this._addNormalScrollEvent():this._removeNormalScrollEvent())}},{key:"onMouseEnter",value:function(e){var t=e.toElement||e.target;t!==this.workspace.container&&t!==this.workspace.container.parentNode||this.uiState.isAllowUpdateHeaderFooterTip||this.manager.uiHandler.allowHeaderFooterTipUpdate()}},{key:"onMouseLeave",value:function(e){var t=e.fromElement||e.srcElement;t!==this.workspace.container&&t!==this.workspace.container.parentNode||this.uiState.isAllowUpdateHeaderFooterTip&&(ce.default.dispatchEvent(lt.a.HEADER_FOOTER.SHOW_HIT_TIP,{affair:"showHitTip",params:{isShow:!1}}),this.manager.uiHandler.preventHeaderFooterTipUpdate()),this.state._isScrollEventAdded&&(this.manager.uiHandler.hidePageNum(),this._removeNormalScrollEvent())}},{key:"onMouseEvent",value:function(e,t){switch(e.type){case"click":this.onClick(e);break;case"mouseenter":this.onMouseEnter(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseleave":this.onMouseLeave(e)}return this.state.uilState}},{key:"onResize",value:function(){var e=this,t=this.app.appApi,n=document.activeElement&&document.activeElement.classList.contains("virtual-input"),i=t.isKeyboardActive||["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&!n,a=window.visualViewport?window.visualViewport.height:window.innerHeight,o=t.viewportHeight?t.viewportHeight-a:0;if((this.state.keyboardHeight>0&&o<=0||!_.isPad)&&(i=!1),this.state.keyboardHeight=o,i){if(this.state.keyboardActive=!0,!t.viewportHeight)return;o&&_.isPad&&(o+=45),this.keyboardHeight=o,o&&(t.keyboardHeight=o,t.isKeyboardActive=!0,this.app.workspace.updateContainer(!0),ce.default.dispatchEvent(ce.default.names.ON_KEYBOARD_HEIGHT_CHANGED,{height:o}),document.activeElement===window.APP.workspace.input.element&&setTimeout((function(){e.app.workspace.makesureCursorVisible(!0,void 0,!0)}),16))}else this.state.keyboardActive?(this.state.keyboardActive=!1,this.app.blurInput(),this.app.workspace.updateContainer(!0),setTimeout((function(){t.viewportHeight=document.body.offsetHeight}),500),ce.default.dispatchEvent(ce.default.names.ON_KEYBOARD_HEIGHT_CHANGED,{height:0})):this.workspace.resizeIfNecessary()}},{key:"onOrientationchange",value:function(){var e=this;this.app.blurInput(),setTimeout((function(){e.app.appApi.viewportHeight=window.innerHeight}),500)}},{key:"onWindowEvent",value:function(e){switch(e.type){case"focus":this.onFocus(e);break;case"blur":this.onBlur();break;case"resize":this.onResize();break;case"orientationchange":this.onOrientationchange()}return this.state.uilState}},{key:"onCustomPluginEvents",value:function(e){var t=e.detail,n=t.pluginEvent,i=t.detail,a=(void 0===i?{}:i).text;switch(n){case Hn:this.workspace.showToast("success",a);break;case Gn:this.workspace.showToast("error",a)}}},{key:"onCustomEvent",value:function(e){var t=e.type,n=e.detail;switch(t){case zt.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE:case zt.default.names.ON_MODAL_VISIBLE_CHANGE:case ce.default.names.ON_CUSTOM_MODAL_VISIBLE_CHANGE:this.onComponentChange(e);break;case ce.default.pluginEvent.CUSTOM_PLUGIN_EVENT:this.onCustomPluginEvents(e);break;case ce.default.webMode.ON_FILENAME_SETTING_CHANGE:this.onFilenameSettingChanged(e);break;case ce.default.names.DOC_SET_PROPS:this.onSetDocProp(e);break;case ce.default.cooperation.ON_NOTIFY_TIPS:this._showNotifyToast(n)}return this.state.uilState}},{key:"handleFocusOnWindow",value:function(e){e.target===window&&this.state._panelOrModalCount}},{key:"initialState",get:function(){return{_isScrollEventAdded:!1,_panelOrModalCount:0,timeoutKey:null,isChangingFilenameSetting:!1,uilState:re.a.CONTINUE}}},{key:"uiState",get:function(){return this.manager.uiHandler.state}}]),t}(le.a);Wn.events=[{type:"mousemove",target:Pe.a.view,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native},{type:"focus",target:Pe.a.window,flag:Pe.b.native},{type:"blur",target:Pe.a.window,flag:Pe.b.native},{type:"click",target:Pe.a.window,options:{listenerParams:{capture:!0}},flag:Pe.b.native},{type:"mouseenter",target:Pe.a.view,flag:Pe.b.native},{type:"mouseleave",target:Pe.a.view,flag:Pe.b.native},{type:"mousedown",target:Pe.a.view,flag:Pe.b.native},{type:"mouseup",target:Pe.a.view,flag:Pe.b.native},{type:"mousemove",target:Pe.a.workspaceElement,flag:Pe.b.native},{type:ce.default.pluginEvent.CUSTOM_PLUGIN_EVENT,target:Pe.a.window,flag:Pe.b.native}],Wn.preferredEvents=[{type:zt.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:zt.default.names.ON_MODAL_VISIBLE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.ON_CUSTOM_MODAL_VISIBLE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.webMode.ON_FILENAME_SETTING_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_SET_PROPS,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.cooperation.ON_NOTIFY_TIPS,target:Pe.a.window,flag:Pe.b.native}].concat(r()(_.isPad?[{type:"resize",target:Pe.a.visualViewport,flag:Pe.b.native},{type:"orientationchange",target:Pe.a.window,flag:Pe.b.native}]:[]));var Yn=Wn,zn=0,Xn=2,Vn=3,qn=n(1737),Kn=n(1804),Qn=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.data.doc.documentFields.attachObserver(a),a.data.selection.attachObserver(a),a.data.fontServer.attachObserver(a),_.isPad&&(a.debounceReadingScrollCostRecord=window.utils.Lodash.debounce((function(){if(a.state.isRecordingReadingScrollRenderCost=!1,a.state.isScrollByTouch){var e=(performance.now()-a.state.readingScrollRenderStartPoint)/a.state.readingScrollRenderCount;window.collection("experience",{event:"reading_scroll",times:Math.round(e)})}a.state.isScrollByTouch=!1,a.state.readingScrollRenderCount=0}),a.state.readingScrollRenderCostRecordDelay),a.onScroll=function(e){a.state.readingScrollRenderCount++,a.state.isRecordingReadingScrollRenderCost||(a.state.isRecordingReadingScrollRenderCost=!0,a.state.readingScrollRenderStartPoint=performance.now()),a._onScroll(),a.debounceReadingScrollCostRecord()}),a}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.preferredEvents}}]),u()(t,[{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.data.selection.detachObserver(this),this.data.fontServer.detachObserver(this),this.data.doc.documentFields.detachObserver(this)}},{key:"_onScroll",value:function(e){this.app.viewUIL.typoUpdate();var t=this.workspace.scrollerHelper.deperacted_isPassiveScroll(),n=this.workspace.element.cacheDOMAttr?this.workspace.element.cacheDOMAttr:this.workspace.element;ce.default.dispatchEvent(ce.default.names.DOC_WORKSPACE_SCROLL,{passive:t,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,clientWidth:n.clientWidth,clientHeight:n.clientHeight}),this.workspace.scrollerHelper.handleScroll()}},{key:"onScroll",value:function(e){this._onScroll(e)}},{key:"_getResizeTriggerType",value:function(e){var t=e&&e.trigger;return"head-lazy-load"===t?Xn:"component-load-trigger"===t?Vn:zn}},{key:"onResize",value:function(e){var t=this;this._resizeHandler||(this._resizeHandler=window.utils.Lodash.throttle((function(n){if(_.isPad&&e.target===window.visualViewport)t.handleResizeOnIPad(e);else if(t.data.selection.clearCache(),t.workspace.resize(n),!_.isPad){window.APP.workspace.getFormatContentManager().showAll,t.data.selection.update()}}),16)),this._resizeHandler(this._getResizeTriggerType(e.detail))}},{key:"handleResizeOnIPad",value:function(){if(_.isIosChrome){var e=Math.max(document.body.clientHeight-window.visualViewport.height,0);document.body.style.paddingBottom=e+"px"}}},{key:"onWindowEvent",value:function(e){switch(e.type){case"scroll":this.onScroll(e);break;case"resize":this.onResize(e)}return this.state.uilState}},{key:"getShapeId",value:function(e){var t=this.data.doc.getEmbedDrawing(e);return t&&t.anchor&&t.anchor.shapeId?t.anchor.shapeId:null}},{key:"onUILOperationTriggered",value:function(e,t,n,i){var a=t,o=n;if(!i.isComposing){if(i.selShapeIdxPaths){var r=i.selShapeIdxPaths,s={shouldBlur:!1};r.length>1&&(s.isSelShapes,s.selShapeIdxPaths=r);var l=this.data.doc,c=i.shpaeTreeType,u=l.layer.getShapeTree(c).childs.at(r[0][0]).shapeId,d=l.getSubDocRange(c===Kn.d||c===Kn.c?A.MainText:A.HeaderFooter),h=(l.anchors.getAnchor2(c,u,d.pos,d.len)||l.inlineAnchors.getAnchor2(c,u,d.pos,d.len)).pos;return this.selection.selAlter.selectShape({id:u,gcp:h,shapeIdxPath:r[0],shapeTreeType:c},s),!0}if(i.selectionShapes&&i.selectionShapes.length>0||o-a==1){var p=i.selectionShapes?i.selectionShapes[0].shapeId:this.getShapeId(a),f=i.selectionShapes?i.selectionShapes[0].anchorStart:a;if(null!==p)return this.selection.selAlter.selectShape({id:p,gcp:f},{shouldBlur:!1,preventScroll:i.preventScroll}),void(this.selection.selShapes&&this.selection.selShapes[0].isPresetDrawing||i.preventScroll||this.workspace.makesureCursorVisible(!0))}}!0===i.isGlyphTail&&Number.isInteger(o)&&a===o&&(a=o=new qn.a(this.data.selection,o,!0)),this.selection.clearCache(),this.selection.setPosition(a,o,i),this.app.isReadOnly()||!i.shouldBlur&&i.isEditing&&this.workspace.switchIndicatorVisibility(!0)}},{key:"onFontUpdate",value:function(e,t){var n=-1;t.forEach((function(e){(-1==n||n>e.pos)&&(n=e.pos)})),this.data.selection.clearCache(),this.workspace.onFontUpdate(),this.workspace.refreshForcedly(),this.workspace.updateIndicator({selection:this.data.selection,updateOnly:!0})}},{key:"onGestureEvent",value:function(e,t){var n=e.event;switch(e.type){case ae.a.MOVE:this.state.isScrollByTouch="touchmove"===n.type}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,isRecordingReadingScrollRenderCost:!1,readingScrollRenderCount:0,readingScrollRenderCostRecordDelay:60}}}]),t}(le.a);Qn.preferredEvents=[{type:"resize",target:Pe.a.window,options:{throttleParams:[16]},flag:Pe.b.native},{type:"scroll",target:Pe.a.workspaceElement,options:{throttleParams:[16,{trailing:!1}]},flag:Pe.b.native}].concat(r()(_.isPad?[{type:ae.a.MOVE,target:Pe.a.view,flag:Pe.b.gesture}]:[]));var Jn=Qn,Zn=n(1103),$n=n(1169),ei=n(554),ti="DEFAULT",ni="POINT_EDIT",ii="SEL_EDIT",ai=function(){function e(t,n){l()(this,e),Object($n.f)(this),this.selection=t,this.document=n,this.selection.attachObserver(this),this.document.attachObserver(this),window.__CONFIG__.wps.useLowPerformanceMode&&(this.handleSelectionChanged=this.handleSelectionChanged.bind(this),window.addEventListener(ce.default.names.DOC_SELECTION_CHANGED,this.handleSelectionChanged)),this.rangeClass=new $n.e(this.document,Zn.u,I.IT.outer,I.IT.Nesting,!0),Object(ei.default)(this)}return u()(e,[{key:"init",value:function(e){var t=e.pos,n=e.len,i=new $n.d(t,t+n);this.rangeClass.attachNode(i)}},{key:"getRange",value:function(){if(!this.rangeClass)return null;var e=0,t=this.document.getTextSize(),n=this.rangeClass.mapInRange(e,e+t,I.IT.mapToNode,I.IT.strictIntersectTest);return k()(n,1)[0]}},{key:"destroy",value:function(){this.rangeClass.clear(),this.document.detachObserver(this),this.selection.detachObserver(this),this.document.detachObserver(this.rangeClass),window.__CONFIG__.wps.useLowPerformanceMode&&window.removeEventListener(ce.default.names.DOC_SELECTION_CHANGED,this.handleSelectionChanged),this.rangeClass=null,this._operate=this._throttleOperate=null}},{key:"operateIfChangeInRange",value:function(e,t){var n=this;this._operate||(this._operate=function(e,t){var i=n.getRange();if(i){var a=void 0,o=!1;switch(t){case ni:a=function(e){return!(e.pos<=i.pos||e.pos>=i.pos+i.len)},o=!0;break;case ii:a=function(e){return!(e.pos+e.len<=i.pos||e.pos>=i.pos+i.len)},o=!0;break;case ti:a=function(e){return e.pos>=i.pos&&e.pos+e.len<=i.pos+i.len},o=!1}var r=e.every(a);o&&r||!o&&!r?(n.destroy(),n._dispatch("onDestroyPasteArea")):o&&n._dispatch("onUpdatePasteArea")}}),t===ti?(this._throttleOperate||(this._throttleOperate=window.utils.Lodash.throttle(this._operate,100,{trailing:!1})),this._throttleOperate(e,t)):this._operate(e,t)}},{key:"onSelectionChanged",value:function(e,t){if(!(t&&t.isEditing&&t.updateOnly)){var n=this.selection.getNormalRanges();this.operateIfChangeInRange(n,ti)}}},{key:"onUILOperationTriggered",value:function(e,t,n,i){i.isEditing&&!i.updateOnly&&this._dispatch("onDestroyPasteArea")}},{key:"handleSelectionChanged",value:function(e){(e.detail||{}).isExecCmd&&this._dispatch("onDestroyPasteArea")}},{key:"onInsertText",value:function(e,t,n){var i={pos:t,len:n.length};this.operateIfChangeInRange([i],ni)}},{key:"onDeleteText",value:function(e,t,n){var i={pos:t,len:n.length};this.operateIfChangeInRange([i],ii)}},{key:"onChpxChanged",value:function(e,t){this.operateIfChangeInRange([t],ii)}},{key:"onPapxChanged",value:function(e,t){e.block||this.operateIfChangeInRange([t],ii)}}]),e}(),oi={isDisableAll:!1,isDisableSourceFormat:!1,isDisableCurrentFormat:!1,isDisablePlainText:!1},ri=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return[].concat(r()(t.events),r()(t.preferredEvents))}}]),u()(t,[{key:"getPasteRange",value:function(){var e=this.manager.editHandler.state.pasteArea;return e&&e.getRange()}},{key:"clearAll",value:function(){this.unbindCoreEventObservers()}},{key:"bindCoreEventObservers",value:function(e,t){this.unbindCoreEventObservers(!0);var n=new ai(this.selection,this.data.doc);n.init({pos:e,len:t}),n.attachObserver(this),this.manager.editHandler.state.pasteArea=n}},{key:"unbindCoreEventObservers",value:function(e){var t=this.manager.editHandler.state.pasteArea;t&&(e&&t.destroy(),t.detachObserver(this),this.manager.editHandler.state.pasteArea=null)}},{key:"calcSelectivePasteFloatMenuPos",value:function(){var e=this.getPasteRange();if(e&&e.len){var t=this.selection.end.pageIndex,n=this.data.doc.getSubDocType(this.selection.end.position)===A.HeaderFooter,i=this.app.isWebMode(),a=this.data.typoinfo.collectTextLines({begin:e.pos,end:e.pos+e.len}).filter((function(e){return e&&(!n||e.viewPage.layout_index===t-1)})),o=a[a.length-1];if(o){var r=void 0,s=void 0,l=void 0,c=0,u=o.range;if(o.isInTable){var d=this.data.typoinfo.tableLineRanges.mapInRange(u.pos,u.pos+u.len,(function(e){return e._node.line}),I.IT.strictIntersectTest).filter((function(e){return!!e})).sort((function(e,t){return t.range.len-e.range.len})).find((function(i){return i.range.pos>=e.pos&&i.range.pos+i.range.len<=e.pos+e.len&&(!n||i.viewPage.layout_index===t-1)}));r=d,c=d&&d.rect?d.rect.width:0}if(!r){c=o.homePos||o.rect.left;var h=[];o.sublines&&o.sublines.length>0?o.sublines.forEach((function(e){h=h.concat(e.glyphGroupInfos)})):h=o.glyphGroupInfos||[];var p=e.pos+e.len-u.pos,f=h.find((function(e){return e.beginOffset<=p&&p<e.endOffset}));if(f){c=f.x-o.position2parent.x;var g=f.widths,v=f.beginOffset;g.some((function(e,t){return v+t>=p||(c+=e,!1)}))}else{var y=h[h.length-1];c=y.x+y.widthSum-o.position2parent.x}r=o}var m=r.viewPage,_=m.outer_rect;if(i){var x=this.data.typoinfo.width;s=C.a.transvertPositionFromNode2Target(r,m),l=x-34}else s=C.a.getPosition2view(r),l=_.left+_.width-34;return s.x+=_.left+c,s.y+=_.top+r.rect.height,s.x=Math.min(s.x,l),s}}}},{key:"showSelectivePasteFloatMenu",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oi,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.state.isMenuVisible=!0,n&&(this.state.updateTag=Date.now()),this.workspace.selectivePasteFloatMenu.update({pos:e,visible:!0,options:t,updateTag:this.state.updateTag})}},{key:"hideSelectivePasteFloatMenu",value:function(){this.state.isMenuVisible&&(this.workspace.selectivePasteFloatMenu.update({visible:!1,updateTag:this.state.updateTag}),this.state.isMenuVisible=!1)}},{key:"updateSelectivePasteFloatMenu",value:function(){if(this.state.isMenuVisible){var e=this.calcSelectivePasteFloatMenuPos();this.showSelectivePasteFloatMenu(e)}}},{key:"onUpdatePasteArea",value:function(e){var t=this;this.state.updateTimeout&&clearTimeout(this.state.updateTimeout),this.state.updateTimeout=setTimeout((function(){clearTimeout(t.state.updateTimeout),t.state.updateTimeout=null,t.updateSelectivePasteFloatMenu()}))}},{key:"onDestroyPasteArea",value:function(e){this.unbindCoreEventObservers(),this.hideSelectivePasteFloatMenu()}},{key:"checkIfAllowSmartPaste",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a()({},oi),i=!(!t.string||!(t.serverHtml||t.html||t.extHtml)),o=!!(t.internal||t.serverCore||t.ksDocClipboardId||i);if(!o)return n.isDisableAll=!0,n;var r=!1,s=!1;if(this.selection.selInfo.containDrawing([e]))if(1===e.len)s=!0;else{var l=this.data.doc.getText(e.pos,e.len);if(r=-1!==l.indexOf(String.fromCharCode(Nt.l)),2!==e.len||t.internal){var c=this.data.doc.fields.getField(e.pos);if(c){var u=c.pos===e.pos,d=c.len===e.len,h=c.len+1===e.len;u&&d&&(s=!0),u&&h&&r&&(s=!0)}}else s=!0}if(s)return n.isDisableAll=!0,n;var p=this.selection.selInfo.isHitOnCtrl(e),f=p.isHitOnDatetime,g=p.isHitOnRichText,v=p.isIncludedByCtrl;return f&&v?(n.isDisableAll=!0,n):(g&&this.app.restrictEditHandler.isInRestrictEditMode&&(n.isDisableAll=!0),n)}},{key:"onPasteSuccess",value:function(e){if(e){var t=this.manager.editHandler.state.pasteParam||{},n=this.checkIfAllowSmartPaste(e,t);if(!n.isDisableAll){this.bindCoreEventObservers(e.pos,e.len);var i=this.calcSelectivePasteFloatMenuPos();this.showSelectivePasteFloatMenu(i,n,!0),window.collection("commandbar","click","paste_show")}}}},{key:"onSelectivePasteSuccess",value:function(e){if(e){this.bindCoreEventObservers(e.pos,e.len);var t=this.calcSelectivePasteFloatMenuPos();this.showSelectivePasteFloatMenu(t)}}},{key:"onSelectivePaste",value:function(e){this.manager.editHandler.smartPaste({type:e})}},{key:"onSecurityPasteNotify",value:function(){this.app.api.resetCmdBlocking(),zt.default.dispatchEvent(zt.default.names.cooper.ON_DOCUMENT_SAVE_SUCCESS)}},{key:"onDisconnect",value:function(){this.unbindCoreEventObservers(!0),this.hideSelectivePasteFloatMenu()}},{key:"onCustomEvent",value:function(e){var t=e.type,n=e.detail,i=void 0===n?{}:n;switch(t){case zt.default.names.edit.COPY_PASTE_SUCCESS:this.onPasteSuccess(i.range);break;case ce.default.names.SELECTIVE_PASTE_SUCCESS:this.onSelectivePasteSuccess(i.range);break;case ce.default.names.ON_SELECTIVE_PASTE:this.onSelectivePaste(i.type);break;case zt.default.names.network.ON_DISCONNECTED:this.onDisconnect();break;case zt.default.names.edit.SECURITY_PASTE_NOTIFY:this.onSecurityPasteNotify()}return this.state.uilState}},{key:"onWindowEvent",value:function(e){var t=this;return this._throttleResizeHandler||(this._throttleResizeHandler=window.utils.Lodash.throttle((function(){t.updateSelectivePasteFloatMenu()}),300)),"resize"===e.type&&this._throttleResizeHandler(),this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,updateTag:Date.now(),isMenuVisible:!1}}}]),t}(le.a);ri.events=[{type:"resize",target:Pe.a.window,options:{throttleParams:[16]},flag:Pe.b.native},{type:zt.default.names.network.ON_DISCONNECTED,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.ON_SELECTIVE_PASTE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.SELECTIVE_PASTE_SUCCESS,target:Pe.a.window,flag:Pe.b.native}],ri.preferredEvents=[{type:zt.default.names.edit.COPY_PASTE_SUCCESS,target:Pe.a.window,flag:Pe.b.native},{type:zt.default.names.edit.SECURITY_PASTE_NOTIFY,target:Pe.a.window,flag:Pe.b.native}];var si=ri,li=n(6748),ci=n(7131),ui=n(2183),di={},hi=function(e){function t(e,n,i){l()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.delayUpdateCommentPanelTimer=null,a.debounceUpdateCommentHighlight=window.utils.Lodash.debounce((function(){ce.default.dispatchEvent(ce.default.comments.DRAW_CONTENT_BY_COMMENT,{})}),150),a.debounceUpdateCommentByText=window.utils.Lodash.debounce((function(e){if(void 0!==e&&a.data&&a.data.doc&&a.data.doc.commentBubbles){var t=a.data.doc.commentBubbles.getBubbleByRange(e,0);if(t){var n=a.state,i=n.currentBubbleId,o=n.currentCommentId;zt.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,{isCooperEdit:!1,isUpdateNow:!0,editingBubbleId:i,editingCommentId:o,updatedBubbleIds:[t.id]})}}}),150),a.beforeModifyComment=function(){a.commitOrDiscardComment()},a.app.commentShowStatus.commentPanel&&(a.restoreCurrentCommentState(),a.state.isInitContext=!0,a.data.selection.attachObserver(a),a.data.doc.reviewMgr.attachObserver(a)),a}var n,i,o,s;return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"clearAll",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.app.commentShowStatus.commentPanel&&(this.data.selection.detachObserver(this),this.data.doc.reviewMgr.detachObserver(this)),this.debounceUpdateCommentHighlight.cancel&&this.debounceUpdateCommentHighlight.cancel(),this.debounceUpdateCommentByText.cancel&&this.debounceUpdateCommentByText.cancel()}},{key:"setCurrentCommentState",value:function(e){var t=e.bubbleId,n=e.rcId,i=e.commentId,o=e.replyId,r=e.isNotifyComment,s=e.currentReeditCommentId,l=void 0===s?null:s,c=e.range;di=a()({},di,{isNotifyComment:r,isMakingComment:!0,currentBubbleId:t,currentRcId:n,currentCommentId:i,currentReplyId:o,tempRange:c}),this.state=a()({},this.state,di,{currentReeditCommentId:l})}},{key:"resetCurrentCommentState",value:function(){di=a()({},di,{isNotifyComment:!1,isMakingComment:!1,currentBubbleId:null,currentRcId:null,currentCommentId:null,currentReplyId:null,currentReplyTo:null,currentReeditCommentId:null,tempRange:null,tempTrueCommentId:null}),this.state=a()({},this.state,di)}},{key:"restoreCurrentCommentState",value:function(){var e=this.selection.selContext;if(e.isInComment()&&e.isCommentEditable){var t=di,n=t.currentCommentId,i=t.currentRcId;n===e.commentId&&i===e.commentRcId&&(this.state=a()({},this.state,di))}}},{key:"adjustCommentRange",value:function(){var e=this.selection.getNormalRange(),t=window.APP.restrictEditHandler.readonlyProtection.adjustEditableRange(e);t.pos===e.pos&&t.len===e.len||this.selection.setPosition(t.pos,t.pos+t.len,{isSend:!0})}},{key:"getInsertCommentRangeBySpecific",value:function(){var e=this;return new Promise((function(t){var n=e.docUserCommentsHandle.getCommentRange();if(e.selection.getNormalRange().len>0)t(n);else{var i=e.selection.end.pos,a=i.posX,o=i.posY,r=e.manager.hit({pos:{x:a+1,y:o+1}}),s=!1;r.catalogInfos&&t(n),r&&r.position<r.line.range.end-1&&(s=e.selection.selAlter.extendSelectBlock(r,(function(n){n&&(e.adjustCommentRange(),t(e.docUserCommentsHandle.getCommentRange()))}))),!1===s&&(r=e.manager.hit({pos:{x:a-1,y:o+1}}),e.selection.selAlter.extendSelectBlock(r,(function(){e.adjustCommentRange(),t(e.docUserCommentsHandle.getCommentRange())})))}}))}},{key:"getInsertCommentRangeByParams",value:function(e){if(e.range)return e.range;var t=void 0;if(e.bubbleId){var n=this.data.doc.commentBubbles.getBubbleById(e.bubbleId);t={pos:n.pos,len:n.len}}else if(this.selection.selContext.isInComment()){var i=null,a=this.selection.selContext,o=a.commentId,r=a.commentRcId;o?i=this.data.doc.comments.getCommentByCommentId(o):r&&(i=this.data.doc.comments.getCommentByRcId(r)),t=this.data.doc.commentBubbles.getBubbleByRange(i.pos,i.len).range,this.app.uilManager.exitCommentBody()}else{if(e.replyId){var s=this.data.doc.comments.getCommentByCommentId(e.replyId);s&&(t={pos:s.pos,len:s.len})}if(!t){t=this.selection.getNormalRange();var l=this.data.doc.commentBubbles.getBubbleByRange(t.pos,t.len);l&&l.data&&l.data.length>0&&(t=l.range),0!==t.len&&this.docUserCommentsHandle.isLineBreak(t.pos+t.len-1)&&t.len--}}return t}},{key:"insertComment",value:(s=Ot()(regeneratorRuntime.mark((function e(t){var n,i,a,o,r,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isMakingComment){e.next=2;break}return e.abrupt("return",!1);case 2:return this.state.isMakingComment=!0,n=this.getInsertCommentRangeByParams(t),i=this.app.data.doc.commentBubbles.getBubbleByRange(n.pos,n.len),this.state.currentCommentId=bn.TEMP,a=bn.TEMP,o=bn.TEMP,r=bn.TEMP,i&&(s=this.app.data.doc.commentBubbles.getBubbleById(i.id))&&(a=s.id,n.pos=s.pos,n.len=s.len),this.setCurrentCommentState({bubbleId:a,rcId:o,replyId:t.replyId,range:n,commentId:r,placeholderPos:n.pos+n.len,isNotifyComment:!0}),ce.default.dispatchEvent(ce.default.comments.ON_INSERT_TEMP_COMMENT),l={isCooperEdit:!1,isTempComment:!0,isAdd:!0,isEdit:!0,editingBubbleId:a,editingCommentId:r},i?l.updatedBubbleIds=[a]:l.insertedBubbleIds=[a],ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,l),e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"replyComment",value:function(e){var t=e.replyId;if(void 0!==t){if(this.state.currentReplyId===t&&!this.state.currentReeditCommentId)return void this.workspace.updateCommentIndicator(!0);this.commitOrDiscardComment(),_.isIPad&&Object(de.focusOnOtherInput)()}this.insertComment({replyId:t})}},{key:"resetSelectionToMainText",value:function(e){var t=void 0,n=void 0;switch(!0){case void 0!==e.pos&&void 0!==e.len:t=e.pos+e.len-1;break;case void 0!==e.comment_id:t=(n=this.app.data.doc.comments.getCommentByCommentId(e.comment_id)).pos+n.len-1;break;case void 0!==e.rc_id:t=(n=this.app.data.doc.comments.getCommentByRcId(e.rc_id)).pos+n.len-1}this.app.uilManager.resetCommentElements(),this.selection.setPosition(t,t,{isSend:!0})}},{key:"deleteComment",value:function(e){this.state.isMakingComment?this.commitOrDiscardComment():this.selection.selContext.isInComment()&&(this.resetCurrentCommentState(),this.manager.resetCommentElements(),this.resetSelectionToMainText(e)),e.comment_id?this.docUserCommentsHandle.removeCommentById(e.comment_id):this.docUserCommentsHandle.removeCommentByLocalId(e.rc_id)}},{key:"discardEditingComment",value:function(e){var t=this.app.data.doc.comments.getCommentByRcId(this.state.currentRcId)||{},n=t.body,i=t.pos,a=t.len;if(Object(bn.isInTempComment)(1)){var o=this.state.currentBubbleId;return this.resetCurrentCommentState(),this.manager.exitCommentBody(),this.selection.setPosition(this.selection.begin.pos),this.updateByDelTempComment(o),!0}return!(!n||e.onlyEmptyComment&&n.len>1)&&(this.resetCurrentCommentState(),this.manager.resetCommentElements(),this.manager.editHandler.cmdExecutor.exec({name:"resetComment",param:{pos:i,len:a,bSendSelectionBack:_.isPad}}),this.app.viewUIL.typoUpdate(),e.updatePosition&&this.selection.setPosition(i,i+Math.max(a-1,0),{isSend:!0}),!0)}},{key:"editComment",value:function(e){this.state.isMakingComment&&this.discardEditingComment({onlyEmptyComment:!0,updatePosition:!1});var t=e;if(!t&&this.selection.selContext.isInComment()){var n=this.selection.getNormalRange();t=this.data.doc.commentBodys.getCommentByPos(n.pos)}if(t){var i=t,a=i.comment_id,o=i.rc_id,r=this.data.doc.comments.getCommentByCommentId(a),s=this.data.doc.commentBubbles.getBubbleByRange(r.pos,r.len);if(s){var l=s.id,c=s.range,u=c.pos,d=c.len,h={pos:u,len:d},p=this.app.commentsDataManager.getCommentCache(a),f=p&&p.p_comment_id;this.setCurrentCommentState({commentId:a,rcId:o,bubbleId:l,replyId:f,range:h,placeholderPos:u+d-1,isNotifyComment:!1,currentReeditCommentId:a}),ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,{isCooperEdit:!1,isEdit:!0,editingBubbleId:l,editingCommentId:a,updatedBubbleIds:[l]})}this.app.data.selection.setPosition(r.pos,r.pos+r.len)}}},{key:"switchComment",value:function(){this.state.currentRcId!==this.selection.selContext.getCommentRcId()&&(this.manager.resetCommentElements(),this.editComment())}},{key:"updateByDelTempComment",value:function(e){var t={isCooperEdit:!1,isUpdateNow:!0,updatedBubbleIds:[e]};ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,t)}},{key:"commitComment",value:function(e){var t=this,n=e.callback,i=e.resetNow,o=this.workspace.commentInput;if(!o||!o.element||!o.value)return this.app.uilManager.resetCommentElements(),n&&n(!1),!1;var r=o.value,s=r.content,l=r.count,c=r.contents,u=r.nodes;if(!l)return n&&n(!1),!1;if(this.state.isCommitComment)return n&&n(!1),!1;window.collection("commandbar","click","comment_send"),this.state.isCommitComment=!0;var d=this.state,h=d.currentReeditCommentId,p=d.currentBubbleId,f=d.currentReplyId,g=d.tempRange;i&&(this.resetCurrentCommentState(),this.manager.resetCommentElements());var v={text:s,cid:h,p_comment_id:f};window.__WPSENV__.reduxDispatch(Object(ui.commentReviewAsync)(v)).then((function(e){if(e.error);else if(e&&e.response&&e.response.body){var o=e.response.body,r=o.comment_id,l=o.user_info,d=o.p_comment_id,v=o.content,y=void 0===v?{}:v,m=o.time,_=d||f,x={range:g,text:s,replyId:_,contents:c,content:a()({},y,{text:y.text||s}),comment_id:r,time:m,user_info:l,p_comment_id:_,isReply:!!_};i||(t.resetCurrentCommentState(),t.manager.resetCommentElements());var w=h?t.app.commentsDataManager.modifyComment(a()({},x,{commentId:r})):t.app.commentsDataManager.commitTempComment(a()({},x,{commentId:r}));if(!w)return n&&n(!1),!1;var k=g,b=t.app.data.doc.commentBubbles.getBubbleByRange(g.pos,g.len);b&&(k=b.range),(Object(bn.isTempBubbleId)(p)||h)&&t.updateByDelTempComment(p),t.app.servicesLoader.commentsDataManager.setCommentCacheObjProperty(r,x),t.app.commentsDataManager.notifyComment({id:h||w.comment_id,isVoice:!1,text:s,duration:0}),ce.default.dispatchEvent(ce.default.comments.COMMENT_INSERTOREDIT_SUCCESS,{type:h?"edit":"insert",commentId:h||w.comment_id,nodes:u}),h&&ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,{isCooperEdit:!1,updatedBubbleIds:[p]}),n&&n(!h&&k)}})).finally((function(){t.state.isCommitComment=!1}))}},{key:"commitOrDiscardComment",value:function(){var e=this;this.commitComment({updatePosition:!0,callback:function(t){t||e.discardEditingComment({onlyEmptyComment:!0,updatePosition:!0})}})}},{key:"commitAndInsertNewComment",value:function(){var e=this;return this.commitComment({resetNow:!1,callback:function(t){t&&(e.manager.editHandler.closeLastTransact(),_.isIPad&&Object(de.focusOnOtherInput)(),e.insertComment({range:t}))}}),!0}},{key:"onUndoRedo",value:function(){var e=this.selection.selContext,t=this.state.isMakingComment;switch(!0){case e.isInComment()&&!t:this.editComment();break;case e.isInComment()&&t:this.switchComment();break;case!e.isInComment()&&t:this.commitComment({updatePosition:!1})}}},{key:"handleEditingCommentAdded",value:function(e,t){}},{key:"handleEditingCommentDeleted",value:function(e,t){var n=this.state,i=n.isMakingComment,a=n.currentBubbleId,o=n.currentCommentId,r=n.currentReplyId;if(!i)return!1;var s=t.remove,l=t.deleteComments,c=this.app.isCmdExecutingByCurrentUser;if(!(s||l&&l.length))return!1;switch(!0){case l&&-1!==l.findIndex((function(e){return e.comment_id===o})):case s&&a===e:this.resetCurrentCommentState(),this.manager.exitCommentBody(),c||this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.selectionUil.commentDeletedByCooper", "Other collaborators have deleted the comment"));break;case l&&-1!==l.findIndex((function(e){return e.comment_id===r})):c||this.workspace.showToast("warn",_i18n("applications.writer.components.core.event.uil.selectionUil.replyCommentDeletedByCooper", "The comment you referenced has been deleted."))}}},{key:"checkAndHandleCommentBubblesUpdate",value:function(e){for(var t in e){var n=e[t];this.handleEditingCommentAdded(t,n),this.handleEditingCommentDeleted(t,n)}}},{key:"onUpdateCommentBubbles",value:function(e,t){var n=t.items;this.checkAndHandleCommentBubblesUpdate(n);var i={isCooperEdit:!this.app.isCmdExecutingByCurrentUser},a=this.state,o=a.currentRcId,s=a.currentBubbleId,l=a.currentCommentId,c=n[s];switch(i.editingBubbleId=s,i.editingCommentId=l,!0){case c&&c.add:i.isAdd=!0,i.isEdit=!0,i.insertedBubbleIds=[].concat(r()(i.insertedBubbleIds||[]),[s]);break;case c&&c.insertComments&&c.insertComments.findIndex((function(e){return e.rc_id===o}))>-1:i.isAdd=!0,i.isEdit=!0,i.updatedBubbleIds=[].concat(r()(i.updatedBubbleIds||[]),[s]),i.editingBubbleId=s,i.editingCommentId=l;break;default:for(var u in n){var d=n[u];switch(!0){case d.add:i.isAdd=!0,i.insertedBubbleIds=[].concat(r()(i.insertedBubbleIds||[]),[u]);break;case d.remove:i.isDelete=!0,i.removedBubbleIds=[].concat(r()(i.removedBubbleIds||[]),[u]);break;case!!d.deleteComments||!!d.insertComments:i.isAdd=!!d.insertComments,i.isDelete=!!d.deleteComments,i.updatedBubbleIds=[].concat(r()(i.updatedBubbleIds||[]),[u])}}}this.delayUpdateCommentPanelTimer&&(clearTimeout(this.delayUpdateCommentPanelTimer),this.delayUpdateCommentPanelTimer=null),window.APP.workspace.updateDisabled?this.delayUpdateCommentPanelTimer=setTimeout((function(){zt.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,i)}),300):zt.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,i)}},{key:"adjustCommentPosOnInsertText",value:function(e,t,n){return t<=e?e+n.length:e}},{key:"onInsertText",value:function(e,t,n,i){var a=this.data.selection.selContext;a.isInComment()&&!isNaN(a.commentPos)&&(a.commentPos=this.adjustCommentPosOnInsertText(a.commentPos,t,n)),this.debounceUpdateCommentHighlight(),this.debounceUpdateCommentByText(t)}},{key:"adjustCommentPosOnDeleteText",value:function(e,t,n){var i=t+n.length;return i<=e?e-n.length:t<e&&i>e?t:e}},{key:"onDeleteText",value:function(e,t,n,i){var a=this.data.selection.selContext;a.isInComment()&&!isNaN(a.commentPos)&&(a.commentPos=this.adjustCommentPosOnDeleteText(a.commentPos,t,n)),this.debounceUpdateCommentHighlight(),this.debounceUpdateCommentByText(t)}},{key:"onCommentShowStatusUpdate",value:function(e){e.commentPanel&&!this.state.isInitContext?(this.state.isInitContext=!0,this.data.selection.attachObserver(this),this.data.doc.reviewMgr.attachObserver(this)):!e.commentPanel&&this.state.isInitContext&&(this.onCommentPanelBubbleInactive(),this.state.isInitContext=!1,this.data.selection.detachObserver(this),this.data.doc.reviewMgr.detachObserver(this))}},{key:"updateTempRange",value:function(){if(Object(bn.isInTempComment)(1)&&this.state.tempRange)if(Object(bn.isTempBubbleId)(this.state.currentBubbleId)){var e=this.app.data.selection.getNormalRange();if(0===e.len)this.delTempComment();else{var t=this.state.tempRange;e.pos===t.pos&&e.len===t.len||(this.state.tempRange=e)}}else if(Object(bn.isTempCommentId)(this.state.currentCommentId)){var n=this.app.data.doc.commentBubbles.getBubbleById(this.state.currentBubbleId);if(n){var i=this.state.tempRange;n.pos===i.pos&&n.len===i.len||(this.state.tempRange={pos:n.pos,len:n.len})}else{var a=this.app.data.selection.getNormalRange();if(0===a.len)this.delTempComment();else{var o=this.state.tempRange;a.pos===o.pos&&a.len===o.len||(this.state.tempRange=a)}}}}},{key:"delTempComment",value:function(){var e=this.state.currentBubbleId;this.app.uilManager.exitCommentBody(),this.resetCurrentCommentState(),ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,{isCooperEdit:!0,isDelete:!0,removedBubbleIds:[e]})}},{key:"onSelectionChanged",value:function(e,t){if(!this.app.commentShowStatus.commentBubble&&(this.updateTempRange(),this.workspace.commentRenderHandler.onSelectionChanged(),!this.selection.selContext.isInComment()&&(this.workspace.revisionComment&&this.workspace.revisionComment.commentTip.updateAddPos(),t&&t.isClick))){var n=this.data.doc.commentBubbles.getBubbleByRange(this.selection.getNormalRange().pos,0);n?ce.default.dispatchEvent(ce.default.comments.ACTIVE_COMMENT_PANEL_BUBBLE,{id:n.id}):ce.default.dispatchEvent(ce.default.comments.CANCEL_COMMENT_PANEL_BUBBLE_ACTIVE)}}},{key:"onCommentPanelBubbleActive",value:function(e){var t=this,n=e.id;this.state.isMakingComment&&this.state.currentBubbleId!==n&&this.commitComment({updatePosition:!1,callback:function(e){e||t.discardEditingComment({onlyEmptyComment:!0,updatePosition:!1})}})}},{key:"onCommentPanelBubbleInactive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.state.isMakingComment){var t=this.state.currentReeditCommentId===this.state.currentCommentId;e.isDiscard&&!t?this.discardEditingComment({updatePosition:!0}):this.commitOrDiscardComment()}else this.selection.selContext.isInComment()&&this.resetSelectionToMainText({comment_id:this.selection.selContext.commentId,rc_id:this.selection.selContext.commentRcId})}},{key:"onModifyComments",value:function(e,t){var n=t.bubbles;if(t.changes.some((function(e){return e.diff.isDone}))){var i=n.map((function(e){return e.id}));if(this.state.isMakingComment){var a=i.indexOf(this.state.currentBubbleId);-1!==a&&i.splice(a,1)}i.length>0&&ce.default.dispatchEvent(ce.default.comments.NOTIFY_COMMENTS_PANEL_DATA_IS_CHANGED,{isCooperEdit:!1,updatedBubbleIds:i})}}},{key:"onBeforeUnload",value:function(){this.state.isMakingComment&&this.discardEditingComment({onlyEmptyComment:!0,updatePosition:!0})}},{key:"onBeforeViewModeChanged",value:function(){this.state.isMakingComment&&this.discardEditingComment({onlyEmptyComment:!0,updatePosition:!0})}},{key:"onAfterViewModeChanged",value:function(){this.app.commentShowStatus.commentPanel&&!this.app.isReadOnly&&ce.default.dispatchEvent(ce.default.comments.SHOW_COMMENTS_TIPS,{checked:!0})}},{key:"onRestrictStateChange",value:function(e){var t=this;e.isRestrict&&this.state.isMakingComment&&this.commitComment({callback:function(e){e||t.discardEditingComment({onlyEmptyComment:!0,updatePosition:!1})}})}},{key:"onCommentInactive",value:function(){this.state.isMakingComment&&this.discardEditingComment({updatePosition:!0})}},{key:"onCommandResponseOnExitCommentBody",value:function(){var e=this;this.state.isMakingComment&&this.commitComment({updatePosition:!1,resetNow:!0,callback:function(t){t||e.discardEditingComment({onlyEmptyComment:!0,updatePosition:!1})}})}},{key:"onCommandResponseOnInput",value:(o=Ot()(regeneratorRuntime.mark((function e(){var t,n,i,a,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.isMakingComment,i=t.isNotifyComment,a=t.currentRcId,o=t.commentNotifyPromise,!n||!i){e.next=13;break}if(!o){e.next=6;break}return e.next=5,o;case 5:return e.abrupt("return",!1);case 6:return r=this.app.data.doc.comments.getCommentByRcId(a)||{},this.state.commentNotifyPromise=this.app.servicesLoader.commentsDataManager.commitComment(r),e.next=10,this.state.commentNotifyPromise;case 10:return this.state.commentNotifyPromise=null,this.state.isNotifyComment=!1,e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"navigateToCommentHighlight",value:function(e){var t=e.id;if(!t)return!1;var n=this.data.doc.commentBubbles.getBubbleById(t);if(n){var i=n.pos;this.selection.setPosition(i,i,{isSend:!0,preventFocus:!0}),this.workspace.revisionComment.makeCommentAreaVisible(i)}}},{key:"mentionInComment",value:(i=Ot()(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rcId,i=t.bubbleId){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=this.data.doc.commentBubbles.getBubbleById(i),n){e.next=9;break}return e.next=7,this.insertComment({range:{pos:a.pos,len:a.len}});case 7:return e.next=9,new Promise((function(e){return setTimeout(e,100)}));case 9:ce.default.dispatchEvent(ce.default.comments.ON_CLICK_OPEN_AT);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"activeCommentByRange",value:function(e){var t=e.range;if(t){var n=this.data.doc.commentBubbles.getBubbleByRange(t.pos,t.len);n&&ce.default.dispatchEvent(ce.default.comments.ACTIVE_COMMENT_PANEL_BUBBLE,{id:n.id})}}},{key:"inactiveComment",value:function(){ce.default.dispatchEvent(ce.default.comments.CANCEL_COMMENT_PANEL_BUBBLE_ACTIVE)}},{key:"onCustomEvent",value:(n=Ot()(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,i=t.detail,this.app.commentShowStatus.commentPanel||this.state.isInitContext){e.next=3;break}return e.abrupt("return",this.state.uilState);case 3:e.t0=n,e.next=e.t0===ce.default.comments.ON_COMMENT_SHOW_STATUS_UPDATE?6:e.t0===ce.default.comments.ON_ADD_ITEM_BY_BTN?8:e.t0===ce.default.comments.ON_ADD_ITEM_BY_MODAL?15:e.t0===ce.default.comments.ON_DELETE_ITEM?17:e.t0===ce.default.comments.ON_EDIT_ITEM?19:e.t0===ce.default.comments.ON_REPLY_ITEM?21:e.t0===ce.default.comments.ON_CANCEL_REPLY_ITEM?23:e.t0===ce.default.comments.ON_COMMENT_PANEL_BUBBLE_ACTIVE?25:e.t0===ce.default.comments.ON_COMMENT_PANEL_BUBBLE_INACTIVE?27:e.t0===ce.default.comments.COMMIT_AND_INSERT_NEW_COMMENT?29:e.t0===ce.default.names.DOC_UNDO_REDO?31:e.t0===ce.default.view.BEFORE_VIEW_MODE_CHANGED?33:e.t0===ce.default.view.AFTER_VIEW_MODE_CHANGED?35:e.t0===ce.default.restrictEdit.ON_RESTRICT_STATE_CHANGE?37:e.t0===zt.default.names.ON_BEFORE_UNLOAD?39:e.t0===ce.default.comments.ON_COMMENTS_MODIFIED?41:e.t0===ce.default.comments.NAVIGATE_TO_COMMENT_HIGHLIGHT?43:e.t0===ce.default.comments.MENTION_IN_COMMENT?45:e.t0===ce.default.comments.ACTIVE_COMMENT_BY_RANGE?47:e.t0===ce.default.comments.INACTIVE_COMMENT?49:e.t0===ce.default.comments.BEFORE_MODIFY_COMMENT?51:53;break;case 6:return this.onCommentShowStatusUpdate(i),e.abrupt("break",54);case 8:return e.t1=this,e.next=11,this.getInsertCommentRangeBySpecific();case 11:return e.t2=e.sent,e.t3={range:e.t2},e.t1.insertComment.call(e.t1,e.t3),e.abrupt("break",54);case 15:return this.insertComment(i.params),e.abrupt("break",54);case 17:return this.deleteComment(i.params),e.abrupt("break",54);case 19:return this.editComment(i.params),e.abrupt("break",54);case 21:return this.replyComment(i.params),e.abrupt("break",54);case 23:return this.discardEditingComment({onlyEmptyComment:!1,updatePosition:!0}),e.abrupt("break",54);case 25:return this.onCommentPanelBubbleActive(i),e.abrupt("break",54);case 27:return this.onCommentPanelBubbleInactive(i),e.abrupt("break",54);case 29:return this.commitAndInsertNewComment(),e.abrupt("break",54);case 31:return this.onUndoRedo(),e.abrupt("break",54);case 33:return this.onBeforeViewModeChanged(),e.abrupt("break",54);case 35:return this.onAfterViewModeChanged(),e.abrupt("break",54);case 37:return this.onRestrictStateChange(i),e.abrupt("break",54);case 39:return this.onBeforeUnload(),e.abrupt("break",54);case 41:return this.onCommentsModified(i),e.abrupt("break",54);case 43:return this.navigateToCommentHighlight(i),e.abrupt("break",54);case 45:return this.mentionInComment(i),e.abrupt("break",54);case 47:return this.activeCommentByRange(i),e.abrupt("break",54);case 49:return this.inactiveComment(),e.abrupt("break",54);case 51:return this.beforeModifyComment(),e.abrupt("break",54);case 53:return e.abrupt("break",54);case 54:return e.abrupt("return",this.state.uilState);case 55:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE,isInitContext:!1,isNotifyComment:!1,isMakingComment:!1,isCommitComment:!1,currentBubbleId:null,currentRcId:null,currentCommentId:null,currentReeditCommentId:null,currentReplyId:null,currentReplyTo:null,tempRange:null,tempTrueCommentId:null}}},{key:"docUserCommentsHandle",get:function(){return this.app.services.userCommentsManager.docUserCommentsHandle}}]),t}(le.a);hi.events=[{type:ae.a.START,target:Pe.a.view,flag:Pe.b.gesture},{type:ce.default.view.BEFORE_VIEW_MODE_CHANGED,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.view.AFTER_VIEW_MODE_CHANGED,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.restrictEdit.ON_RESTRICT_STATE_CHANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.names.DOC_UNDO_REDO,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ACTIVE_COMMENT_BY_RANGE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.INACTIVE_COMMENT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_ADD_ITEM_BY_BTN,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_ADD_ITEM_BY_MODAL,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_DELETE_ITEM,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_EDIT_ITEM,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_REPLY_ITEM,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_CANCEL_REPLY_ITEM,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_COMMENT_PANEL_BUBBLE_ACTIVE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_COMMENT_PANEL_BUBBLE_INACTIVE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.COMMIT_AND_INSERT_NEW_COMMENT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.NAVIGATE_TO_COMMENT_HIGHLIGHT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.ON_COMMENT_SHOW_STATUS_UPDATE,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.MENTION_IN_COMMENT,target:Pe.a.window,flag:Pe.b.native},{type:ce.default.comments.BEFORE_MODIFY_COMMENT,target:Pe.a.window,flag:Pe.b.native},{type:zt.default.names.ON_BEFORE_UNLOAD,target:Pe.a.window,flag:Pe.b.native}];var pi=hi,fi=function(e){function t(e,n,i){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return v()(t,e),u()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),u()(t,[{key:"execute",value:function(e,n){return n&&this.isRestrictEditMode&&!this.checkIsInContentControl(n.position)?this.initialState.uilState:f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}},{key:"handleClickControl",value:function(e){var t=e.isRepeatItem?e.parent:e,n=t&&t.data&&Object.assign({},t.data.private);n&&ce.default.dispatchEvent(ce.default.contentControls.ON_CONTENT_CONTROL_ENTER,n)}},{key:"hanleClickCheckBox",value:function(e){this.app.formatContentController.setCheckBoxChecked(e)}},{key:"onGestureEvent",value:function(e,t){if(this.app.isReadOnly()||!this.app.api.isConnected())return this.state.uilState;switch(e.type){case ae.a.TAP:if(t.ctrlInfos&&t.ctrlInfos.length){var n=t.ctrlInfos[0];this.handleClickControl(n.ctrl||n),t.isHitCheckBox&&n.isCheckBox&&this.hanleClickCheckBox(n.begin)}}return this.state.uilState}},{key:"initialState",get:function(){return{uilState:re.a.CONTINUE}}}]),t}(le.a);fi.events=[{type:ae.a.TAP,target:Pe.a.view,flag:Pe.b.gesture}];var gi,vi=fi,yi=function(e){function t(e,n){return l()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return v()(t,e),u()(t,null,[{key:"isEventPreferred",value:function(e){return t.getPreferredEvents(t).has(e)}}]),u()(t,[{key:"loadModules",value:function(){var e=this,t=this.app.isReadOnly(),n=this.app.data.doc.isEnhancedTemplate,i=Object(Ie.hasQuery)("template"),a=!!window.__WPSPLUGIN__.loader.search({pluginType:Un.PLUGIN_TYPE.AT});[[Ee.a.UI,Yn],[Ee.a.COOPERATION,li.a],[Ee.a.UPDATE,Jn],[Ee.a.COMMENT,pi]].concat(r()(a?[[Ee.a.AT,ci.a]]:[]),[[Ee.a.SELECTION,Gt]],r()(t?[]:[[Ee.a.TABLE,It]]),r()(t?[]:[[Ee.a.DATE,In]]),r()(t?[]:[[Ee.a.CATALOG,On]]),r()(!t&&n?[[Ee.a.RICH_TEXT,Fn]]:[]),r()(t?[]:[[Ee.a.CONTENT_CONTROL,vi]]),r()(i?[]:[[Ee.a.KEYBOARD,Sn]]),[[Ee.a.CURSOR,wt],[Ee.a.COOPER_SELECTION,bt],[Ee.a.HYPERLINK,Ln],[Ee.a.SELECTIVE_PASTE,si]]).forEach((function(t){var n=k()(t,2),i=n[0],a=n[1];e.modules.get(i)||e.modules.set(i,new a(e,e.app,e.manager))}))}}]),t}(mt.a);yi.modulesMap=(gi={},$()(gi,Ee.a.UI,Yn),$()(gi,Ee.a.UPDATE,Jn),$()(gi,Ee.a.AT,ci.a),$()(gi,Ee.a.SELECTION,Gt),$()(gi,Ee.a.TABLE,It),$()(gi,Ee.a.DATE,In),$()(gi,Ee.a.CATALOG,On),$()(gi,Ee.a.RICH_TEXT,Fn),$()(gi,Ee.a.KEYBOARD,Sn),$()(gi,Ee.a.CURSOR,wt),$()(gi,Ee.a.COOPER_SELECTION,bt),$()(gi,Ee.a.HYPERLINK,Ln),$()(gi,Ee.a.SELECTIVE_PASTE,si),$()(gi,Ee.a.COOPERATION,li.a),$()(gi,Ee.a.COMMENT,pi),$()(gi,Ee.a.CONTENT_CONTROL,vi),gi),yi.eventList=mt.a.getEventList(yi);var mi,_i,xi=yi,wi=n(2139),ki=n(3854),bi=function(){function e(t){l()(this,e),this.workspace=t,this._active=!1}return u()(e,[{key:"updateIfNeeded",value:function(e){var t=this.workspace.element.cacheDOMAttr.rect;return e.clientX>t.right-ki.a.page_num_tip_available_right&&e.clientX<t.right?(this.workspace.pageNumTip.update(),this._active=!0):(this.workspace.pageNumTip.delayHideIfNeeded("instant"),this._active=!1),this._active}},{key:"hide",value:function(){this._active&&(this.workspace.pageNumTip.delayHideIfNeeded("instant"),this._active=!1)}},{key:"scroll",value:function(){this.workspace.pageNumTip.update(),this.workspace.pageNumTip.delayHideIfNeeded("long")}}]),e}(),Ti=function(e){function t(e,n){l()(this,t);var i=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.app.isPCMode()&&(i.pageNumUtil=new bi(i.workspace)),i}return v()(t,e),u()(t,[{key:"handleFocus",value:function(){this.workspace.switchIndicatorState(!0)}},{key:"handleBlur",value:function(){this.workspace.switchIndicatorState(!1)}},{key:"handleFocusEvent",value:function(e){var t=this;e?(setTimeout((function(){t.workspace.focusWithoutScroll()})),this.workspace.switchIndicatorState(!0)):(this.app.blurInput(),this.workspace.switchIndicatorState(!1))}},{key:"allowHeaderFooterTipUpdate",value:function(){this.state.isAllowUpdateHeaderFooterTip=!0}},{key:"preventHeaderFooterTipUpdate",value:function(){this.state.isAllowUpdateHeaderFooterTip=!1}},{key:"scrollPageNum",value:function(e){this.pageNumUtil&&this.pageNumUtil.scroll()}},{key:"updatePageNum",value:function(e){return this.pageNumUtil&&this.pageNumUtil.updateIfNeeded(e)}},{key:"hidePageNum",value:function(){this.pageNumUtil&&this.pageNumUtil.hide()}},{key:"initialState",get:function(){return{isAllowUpdateHeaderFooterTip:!0}}}]),t}(wi.a),Ci=n(7123),Si=n(6742),Ei=n(3037),Pi=n(2657),Li=n(691),Ai=n(1731),Ii=n(1734),Ri=n(1916),Oi=n(4112),Mi=n(1403),Di=n(302),Ni=n(3427),Bi=n(6003),ji=n(760),Fi=n(698),Hi=n(5911),Gi=n(5910),Ui=n(4752),Wi=n(4721),Yi=n(564),zi=n(5341),Xi=function(e){var t=e.url,n=e.responseType,i=void 0===n?"json":n;return window.__WPSENV__.request({method:"GET",url:t,responseType:i}).end()},Vi=(mi=Ot()(regeneratorRuntime.mark((function e(t){var n,i,a,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/office/file/"+t,i=null,e.prev=2,e.next=5,Xi({url:n});case 5:a=e.sent,i=a&&a.body,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(2),console.error("getFileMeta出错",e.t0),e.abrupt("return",null);case 13:if(o=i.file){e.next=16;break}return e.abrupt("return",null);case 16:if(!o.name||Object(zi.getFileType)(o.name)){e.next=18;break}return e.abrupt("return",null);case 18:if(r={id:o.id,name:o.name,link_url:""},o.attrs&&o.attrs.link_url){e.next=21;break}return e.abrupt("return",null);case 21:return r.link_url=o.attrs.link_url,e.abrupt("return",r);case 23:case"end":return e.stop()}}),e,void 0,[[2,9]])}))),function(e){return mi.apply(this,arguments)}),qi=(_i=Ot()(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.link_id,e.next=3,Vi(n);case 3:if(null!==(i=e.sent)){e.next=6;break}return e.abrupt("return",{result:0});case 6:return e.abrupt("return",{result:1,file:i,linkInfo:t});case 7:case"end":return e.stop()}}),e,void 0)}))),function(e){return _i.apply(this,arguments)}),Ki=function(e){function t(e,n){l()(this,t);var i=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.insertTab=Bi.g.bind(null,i.app,i,i.data),i.adjustColumn=Ni.a.bind(null,i,i.data),i.adjustRow=Ni.b.bind(null,i,i.data),i.adjustTable=Ni.c.bind(null,i,i.data),i.autoAdjustColumn=Ni.e.bind(null,i,i.data),i.autoAdjustTable=Ni.f.bind(null,i.app,i,i.data),i.isAllowMergeCells=Ni.o.bind(null,i.data),i.isAllowSplitCells=Ni.q.bind(null,i.data),i.isAllowRepeatRowHeader=Ni.p.bind(null,i.data),i.splitTableCells=Ni.C.bind(null,i,i.data),i.mergeTableCells=Ni.r.bind(null,i,i.data),i.applyTableStyle=Ni.d.bind(null,i,i.data),i.setCellsFillColor=Ni.w.bind(null,i,i.data),i.setRepeatRowHeader=Ni.y.bind(null,i,i.data),i.setTableCellAlignment=Ni.z.bind(null,i,i.data),i.setTableFormatAlignment=Ni.B.bind(null,i,i.data),i.setTableCellBorderType=Ni.A.bind(null,i,i.data),i.setCellsBorderStyle=Ni.v.bind(null,i),i.moveTable=Ni.t.bind(null,i,i.data),i.moveTableOfRowOrCol=Ni.u.bind(null,i,i.data),i.insertContentControl=Gi.e.bind(null,i,i.data),i.deleteHyperlink=Ui.deleteHyperlink.bind(null,i,i.data),i.editHyperlink=Ui.editHyperlink.bind(null,i,i.data),i.copyHyperlink=Ui.copyHyperlink.bind(null,i),i.locateDocumentField=Hi.h.bind(null,i.data),i}var n,i;return v()(t,e),u()(t,[{key:"closeLastTransact",value:function(){var e=window.g_rpt.getLastLocalCommand();e&&"insertComment"===e.name||f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"closeLastTransact",this).call(this)}},{key:"setSeparator",value:function(e,t,n,i){var a=e.pos,o=e.borderType;if(void 0===a)return!1;var r=this.data.doc.getDataLogic("final").getPapx(a);if(!r)return!1;var s=void 0,l=void 0,c=0;if(t&&(c|=1),n&&(c|=2),i){var u=this.getRandomColor(i);l=Mi.a.initWithHexColor(u,!1).naked_color,c|=4}switch(o){case Oi.d:if((s=r.prop.border_top)&&s.styleType&&s.style&&s.style!==Ri.l)return t&&(s.style=t),n&&(s.lineWidth=n),l&&(s.color=l),this.paraFormat.setBorders(a,1,{border_top:s},c,!0),!0;break;case Oi.a:if((s=r.prop.border_bottom)&&s.styleType&&s.style&&s.style!==Ri.l)return t&&(s.style=t),n&&(s.lineWidth=n),l&&(s.color=l),this.paraFormat.setBorders(a,1,{border_bottom:s},c,!0),!0;break;default:return!1}return!1}},{key:"find",value:function(){this.app.api.isConnected()&&ce.default.dispatchEvent(ce.default.names.DOC_SHOW_FIND_PANEL)}},{key:"replace",value:function(){this.app.api.isConnected()&&ce.default.dispatchEvent(ce.default.names.DOC_SHOW_REPLACE_PANEL)}},{key:"openHyperLink",value:function(){ce.default.dispatchEvent(ce.default.hyperLink.ON_LINK_ITEM_CLICK)}},{key:"toNextPageStart",value:function(){this.insertBreak(Si.f)}},{key:"save",value:function(){this.app.isReadOnlyComment()?window.Toast.success(_i18n("applications.writer.components.core.event.uil.handlers.saveSuccess", "Current editing has been successfully saved")):this.app.isReadOnly()?window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.cannotSave", "The document is read-only")):zt.default.dispatchEvent(zt.default.names.file.ON_SAVE_VERSION,{triggerSave:!0})}},{key:"getAutoNumFormatOp",value:function(){if(this.selection.selInfo.getListType()===Ii.c){var e=this.selection.getNormalRange(!0).pos,t=this.data.doc.getDataLogic("final").getPapx(e).prop;if(t.revision&&t.revision.paraFormat)return;var n=this.data.autonum.getAutoNumNodeByPos(e);if(!n)return;if(n.getRealPrev()&&n.index>0)return an.Auto_Number_Restart;var i=n.getPrevOfSpace();if(i){if(n.level>i.level)return;var a=n.format,o=i.format;if(a.levelCount!==o.levelCount||a.levelFrom!==o.levelFrom)return;for(var r=!0,s=a.levelFrom;s<a.levelFrom+a.levelCount;++s){var l=a.levels[s],c=o.levels[s];if(l.startAt!==c.startAt||l.noRestart!==c.noRestart||l.noRestart&&l.restartAfterLevel!==c.restartAfterLevel||l.nfc!==c.nfc||l.legal!==c.legal||l.xst!==c.xst||l.charFollow!==c.charFollow||l.jc!==c.jc){r=!1;break}}if(r)return an.Auto_Number_Continue}}}},{key:"insertComment",value:function(){if(Object(Yi.isReadingMode)())return Object(Yi.closeReadingMode)(),!1;this.data.api.isConnected()&&!this.app.functionStatus.comment.disabled&&ce.default.dispatchEvent(ce.default.comments.OPEN_COMMENTS_DIALOG_BY_BTN)}},{key:"insertEmojiComment",value:function(e){if(Object(Yi.isReadingMode)())return Object(Yi.closeReadingMode)(),!1;this.data.api.isConnected()&&!this.app.functionStatus.comment.disabled&&setTimeout((function(){Object(Wi.checkHasCommentPermission)().then((function(){ce.default.dispatchEvent(ce.default.comments.INSERT_EMOJI_COMMENT_BY_BTN,{emoji_id:e})})).catch(Wi.goToApplyForPermission)}))}},{key:"getRandomColor",value:function(e){var t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),a=Math.max(Math.ceil(3*Math.random()),1),o=parseInt(5*Math.random(),10);switch(a){case 1:t=(t+=o)>255?t-2*o:t;break;case 2:n=(n+=o)>255?n-2*o:n;break;case 3:i+=o,i=t>255?i-2*o:i}return Di.default.rgbObjToHexStr({red:t,green:n,blue:i})}},{key:"insertSeparator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000";if(e&&t){var i=this.getRandomColor(n),a={type:0,hex:8};i&&(a=Mi.a.initWithHexColor(i,!1).naked_color);var o=this.selection.getNormalRange(),r={pos:o.pos,len:o.len,lineStyle:e,lineWidth:t,color:a},s={name:"insertSeparator",param:r},l=this.cmdExecutor.exec(s);if(void 0!==l&&!1!==l){var c=this.data.doc.getLimitedRange(l);l>c.pos&&(l-=1),this.selection.setPosition(l,null,{isEditing:!0,shouldBlur:_.isPad}),this.selection.onCmdExec()}}else console.log("分割线参数缺了")}},{key:"sub_script",value:function(){this.font.setSubscript(!this.selection.selInfo.getSubscript())}},{key:"super_script",value:function(){this.font.setSuperscript(!this.selection.selInfo.getSuperscript())}},{key:"insertBreak",value:function(e,t){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()&&!this.selection.selInfo.info.isSelectionRangeNonEditable){var n=this.selection.getNormalRange();if(!(n.pos<0)){var i={pos:n.pos,len:n.len,breaktype:e,bSendSelectionBack:!0};3===e&&this.selection.selContext.isInHeaderFooter&&(this.selection.end&&this.selection.end.isInFooter?i.isInFooter=!0:i.isInHeader=!0);var a=i.pos;this.selection.setPosition(a,void 0,{shouldBlur:_.isPad}),this.cmdExecutor.sendCommandBlock({name:"insertBreak",param:i},t)&&(this.selection._dispatch("onUILOperationTriggered",a,null,{isEditing:!0}),this.selection.onCmdExec())}}}},{key:"allowInsertHyperlink",value:function(){var e=this.selection.getActiveAreaNormalRanges();if(e.length>1)return!1;if(this.selection.activeShape&&this.selection.activeShape.wrap_mode&&7!==this.selection.activeShape.wrap_mode)return!1;for(var t=e[0],n=t.pos,i=t.pos+t.len,a=this.data.doc.fields.getFields({begin:n,end:i}),o=0,r=0;r<a.length;++r)if("HYPERLINK"===a[r]._node.type){if(++o>1)return!1;if(new Pi.a(this.data,a[r]._node).isKWProtocolAddress())return!1}var s=this.data.doc.getText(t.pos,t.len);if(s)for(var l=0;l<s.length;++l){if(s.charCodeAt(l)===Nt.g)return!1}return!this.selection.selInfo._crossCell(n,i)}},{key:"insertHyperlink",value:function(e){var t=e.textToDisplay,n=e.subAddress;console.log("address",i),console.log("textToDisplay",t);var i=e.address,a=e.screenTip,o=e.target,r=e.refStart,s=e.refEnd,l=e.ranges||this.selection.getActiveAreaNormalRanges(),c=l.length,u=l[0];u.pos>l[c-1].pos&&(u=l[c-1]),n=void 0!==n?Object(Ui.pretreatAddress)(this.data,n):n;var d=t!==_i18n("applications.writer.components.core.event.uil.handlers.chose", "<<Selected content in document>>")?t:Object(Fi.getPureText)(this.data,Li.isSpecialPlaceholder,l),h=21;h+=i?i.length:0,h+=n?n.length:0;var p=this.data.doc.getText(u.pos,u.len);void 0!==t&&t!==p&&t!==_i18n("applications.writer.components.core.event.uil.handlers.chose", "<<Selected content in document>>")?h+=t.length-u.len:t=void 0;var f={pos:u.pos,len:u.len,strlen:h,address:i,subAddress:n,screenTip:a,textToDisplay:t,_textToDisplay:d,target:o,refStart:r,refEnd:s},g=this.state.ipChpx;g&&(f.ipChpx=g);var v={name:"insertHyperlink",param:f},y=f.pos+f.len;this.selection.setPosition(y,void 0,{shouldBlur:_.isPad}),this.cmdExecutor.exec(v)&&(this.selection._dispatch("onUILOperationTriggered",y,null,{isEditing:!0}),this.selection.onCmdExec())}},{key:"showPasteToast",value:function(){if(_.isPad)this.uilManager.clipboardHandler.clipboard.showPasteTips();else{var e=_.convertCtrl(_i18n("applications.writer.components.core.event.uil.handlers.rbMenuPaste", "Right click does not support pasting, please use Ctrl+V"));this.workspace.showToast("warn",e)}}},{key:"insertImage",value:function(e){var t=e.map((function(e){return Object(Ei.getImageType)(e)}));Promise.all(t).then((function(t){t.some((function(e){return e===Ei.ImageType.TIFF}))?window.Notice.warn(_i18n("applications.writer.components.core.event.uil.handlers.cannotCopyLocalFiles", "Image pasting failed, please copy the image separately, or use the \"Insert Image\" function"),8):ce.default.dispatchEvent(ce.default.shape.ON_IMAGE_UPLOAD_REQUEST,{file:e})})).catch((function(e){console.log(e)}))}},{key:"convertDataURLtoFile",value:function(e,t){for(var n=atob(e),i=n.length,a=new Uint8Array(i);i--;)a[i]=n.charCodeAt(i);return new Blob([a],{type:t})}},{key:"focusAfterClickingNotice",value:function(){var e=this,t=document.querySelector(".component-notice-content");t&&(t.addEventListener("click",(function(){e.workspace.focusWithoutScroll()})),t=null)}},{key:"_includeLocalFiles",value:function(e){var t=e.replace(/[\r\n]/g,""),n=/<img[^>(src)]*(src="file:\/\/\/.*")?[^(src)]*>/gi.test(t);n&&(/<!--\[if gte vml 1\]><v:.*/gi.test(t)&&!/<v:imagedata src="file:\/\/\/.*/gi.test(t)&&(n=!1));return n}},{key:"_pastePureTextInClient",value:function(){var e=Ot()(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uilManager.clipboardHandler.getClipboardData();case 2:t=e.sent,n=t.text,this.selection.selContext.isInComment()?this._pastePureTextForComment(n):this.selection.selContext.isInMath()?this._pastePureTextForMath(n):this._pastePureText(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_pastePureTextForComment",value:function(e){var t=Object(ji.filterText)(Object(de.n2r)(e),Li.isInvalidPlaceholderInComment);this.state.reportPaste.cmd="insertText",this.insertText(t,{cleanCopyData:!0,replace:!0})}},{key:"_pastePureTextForMath",value:function(e){window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.mathNotSupportCopy", "Formulas do not support copy, cut, or paste."))}},{key:"_pastePureText",value:function(e){var t=this;if(!e||e.length<=0)return!1;var n;return null==(n=function(e){if(!window.__CONFIG__.wps.enableHyperlink2CloudDoc)return null;var t=function(e){var t=e.split("\n");if(t.length>2||t.length<=0)return null;var n=null,i=null;if(1===t.length?n=t[0].trim():0===t[1].trim().indexOf("https")?(n=t[1].trim(),i=t[0].trim()):(n=t[0].trim(),i=t[1].trim()),i){if(!/^[\[【].*[\]】][ *](.*)/i.test(i))return null}var a=/^https:\/\/[a-zA-Z0-9.\/]+[lp]\/([a-zA-Z0-9]+)/i;if(!a.test(n))return null;var o=n.match(a);return o&&2===o.length&&o[1]?{link_id:o[1],link_url:o[0]}:null}(e);return null===t?null:t}(e))?(this._realPasteText(e),!0):(qi(n).then((function(n){0!=n.result&&n.file&&n.linkInfo?t._realCloudDocInsert(n):t._realPasteText(e)})),!0)}},{key:"_realCloudDocInsert",value:function(e){var t=e.file,n=e.linkInfo,i="📄"+Object(zi.getFileNameDesc)(t.name),a=t.id,o=""===t.link_url?n.link_url:t.link_url,r=[{address:"kw:filelink?fType="+Object(zi.getFileType)(t.name)+"&fid="+a+"&shareLink="+o,textToDisplay:i}],s=this.data.selection.getActiveAreaNormalRanges();this.insertHyperlinks(r,[s[0]],{underlineType:nn.wpsUnderlineNone,underlineColor:"#000"})}},{key:"_realPasteText",value:function(e){if(e&&e.length)if(e.length>2e5)window.Notice.warn(_i18n("applications.writer.components.core.event.uil.handlers.pasteContentLimit", "The content length exceeds the browser limit and cannot be pasted, please copy in batches")),this.focusAfterClickingNotice();else{var t=this.filterPureTextForPaste(Object(de.n2r)(e));this.state.reportPaste.cmd="insertText",this.insertText(t,{cleanCopyData:!0,replace:!0})}}},{key:"_pasteFromCurrentDoc",value:function(e,t){var n=this.data.api.isConnected(),i=e.text,a=this.uilManager.clipboardHandler.state,o=a.clientCopySuccess,r=a.serverCopySuccess,s=a.serverCore,l=a.serverHtml,c=a.id,u=a.text,d=t.clipboardInfo&&t.clipboardInfo.id&&t.clipboardInfo.id===c&&n,h=this.uilManager.clipboardHandler.clipboard.type;if(!d&&n&&"async"===h&&u&&(d=!o&&i===u),d){var p={};return r&&(p.serverCore=s,p.internal=!0),p.serverCore||(p.serverHtml=l,p.string=i,p.noPara=!this.hasPara(l,i)),r||p.serverHtml||this.addClipboardIdForPaste(p,e,t.clipboardInfo),console.log("文档内粘贴，以内部数据格式。"),this.serverPaste(p),!0}return t.isConnected=n,t.text=i,this.uilManager.clipboardHandler.onPasteOtherContent(),!1}},{key:"_pasteFromOtherDoc",value:function(e,t){var n=t.isConnected,i=t.clipboardInfo;if(i&&i.id&&n){var a={},o=e.text;return o&&o.length&&(a.string=o),this.addClipboardIdForPaste(a,e,i),console.log("跨文档粘贴，文字间以内部数据格式，表格到文字，点了“粘贴到外部”按钮以html格式，否则以纯文本",a.extHtml),this.serverPaste(a),!0}return!1}},{key:"_pasteFromHTML",value:function(e,t){var n=t.isConnected,i=e.html,a=!1,o=!1;if(i&&"string"==typeof i&&i.length>0&&n){console.log("pasteHtml:",i);var r=t.text;if(r&&r.length>2e5)return window.Notice.warn(_i18n("applications.writer.components.core.event.uil.handlers.pasteContentLimit", "The content length exceeds the browser limit and cannot be pasted, please copy in batches")),this.focusAfterClickingNotice(),!0;if(a=!this.hasPara(i,r),o=this._includeLocalFiles(i),r&&r.length>0)return console.log("html粘贴"),this.serverPaste({html:i,noPara:a,string:r}),!0}return t.html=i,t.noPara=a,t.isIncludeLocalFiles=o,!1}},{key:"_pasteFromText",value:function(e,t){var n=t.text,i=t.html,a=t.isIncludeLocalFiles,o=t.noPara,r=t.isConnected,s=!1,l=e.image;return l&&(/[^.]*\.(png|jpg|jpeg|bmp|gif)+/.test(n)||"[图片]"===n)&&(s=!0),!n&&l&&(s=!0),s?(this.state.reportPaste.cmd="insertPicture",this.insertImage(l),!0):!(i&&"string"==typeof i&&i.length>0&&r)||a&&l?this._pastePureText(n):(console.log("html粘贴"),this.serverPaste({html:i,noPara:o,string:n}),!0)}},{key:"_pasteFromCurrentDocInIE",value:function(e,t){var n=this.uilManager.clipboardHandler.state,i=n.clientCopySuccess,a=n.serverCopySuccess,o=n.serverCore,r=n.serverHtml,s=n.text,l=e.text;if(!i&&s&&l===s&&this.data.api.isConnected()){var c={};return a&&(c.serverCore=o,c.internal=!0),c.serverCore||(c.serverHtml=r,c.string=s),this.serverPaste(c),!0}return t.text=l,!1}},{key:"_pasteFromTextInIE",value:function(e,t){var n=t.text;if("[图片]"!==n&&n)this._pastePureText(n);else{var i=e.image;i?(this.state.reportPaste.cmd="insertPicture",this.insertImage(i)):this._pastePureText(n)}return!0}},{key:"_pasteFromTextForComment",value:function(e,t){var n=t.event.textInClipboard;return this._pastePureTextForComment(n),!0}},{key:"_pasteFromTextForMath",value:function(e,t){var n=t.event.textInClipboard;return this._pastePureTextForMath(n),!0}},{key:"_isSupportCloudClipboard",value:function(){var e=Ot()(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.info){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",["et","webwpp","wps","db"].indexOf(n.from)>=0);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_pasteWithSystemClipboard",value:(i=Ot()(regeneratorRuntime.mark((function e(t){var n,i,a,o,r,s,l,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uilManager.clipboardHandler.getClipboardData(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:if(_.isMobile||t||_.isPCWpsClient()){e.next=21;break}if(i=n.callstatus,a=!n.html&&!n.text&&!n.image,o="ok"===i,r=this.app.copyControl(),!o||!a||r&&(!r||n.id)){e.next=12;break}return e.abrupt("return",!1);case 12:if(e.t0=a,!e.t0){e.next=17;break}return e.next=16,this._isSupportCloudClipboard(n);case 16:e.t0=!e.sent;case 17:if(!e.t0){e.next=21;break}return this.showPasteToast(),window.collection("copypaste","value","right_menu_paste_fail"),e.abrupt("return",!0);case 21:return s=[],(l={event:t}).clipboardInfo=n.info,s=this.selection.selContext.isInComment()?[this._pasteFromTextForComment]:this.selection.selContext.isInMath()?[this._pasteFromTextForMath]:_.isIE?[this._pasteFromCurrentDocInIE,this._pasteFromTextInIE]:[this._pasteFromCurrentDoc,this._pasteFromOtherDoc,this._pasteFromHTML,this._pasteFromText],c=void 0,s.some((function(e){return c=e.call(u,n,l)})),e.abrupt("return",c);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"paste",value:(n=Ot()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAllowInsert()){e.next=2;break}return e.abrupt("return");case 2:if(!this.isDeleteCrossNotesBody()){e.next=5;break}return t.preventDefault(),e.abrupt("return");case 5:if(this.state.reportPaste={begin:Date.now(),cmd:"paste"},this.app.canCopy()){e.next=10;break}if(!_.isPCWpsClient()){e.next=10;break}return this._pastePureTextInClient(),e.abrupt("return");case 10:return t&&t.preventDefault(),e.next=13,this._pasteWithSystemClipboard(t);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_isMixTitleStyle",value:function(){var e=this.data.doc.getDataLogic("prime"),t=this.selection,n=t.begin,i=t.end,a=n.position>i.position?i.position:n.position,o=e.getPapx(a);return e.collectChpxs(o.pos,o.len).some((function(e){return e.prop&&e.prop.basestyle&&e.prop.basestyle.id}))}},{key:"_getTitleStyle",value:function(){var e=this.selection.selInfo.getStyle();if(void 0===e){var t=this.data.doc.getDataLogic("prime"),n=this.selection,i=n.begin,a=n.end,o=i.position>a.position?a.position:i.position,r=t.getPapx(o);r&&r.prop&&r.prop.basestyle&&(e=r.prop.basestyle.id)}return e}},{key:"handlerTitleStyle",value:function(e){if(!this.selection.selInfo.info.isPapxNonEditable&&void 0===this.selection.begin.isInFooter){var t="increase"===e,n=t?1:2;if(!this._isMixTitleStyle()){var i=this._getTitleStyle();if(0===i){var a=this.data.doc.getDataLogic("prime"),o=this.selection.begin.position,r=a.getPapx(o);if(r.pos>0){for(var s=a.getPapx(r.pos,I.IT.Exclude);s&&s.prop&&s.prop.basestyle&&0===s.prop.basestyle.id;)s=a.getPapx(s.pos,I.IT.Exclude);if(s&&s.prop&&s.prop.basestyle){var l=s.prop.basestyle.id,c=0!==l;t?c&&l&&(n=l):c&&(n=l+1)}}}else t?i>1&&(n=i-1):n=i+1}this.setStyle(n)}}},{key:"increaseTitleStyle",value:function(){this.handlerTitleStyle("increase")}},{key:"decreaseTitleStyle",value:function(){this.handlerTitleStyle("decrease")}},{key:"setPageOrientation",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t=this.selection.getNormalRange(!0),n={pos:t.pos,len:t.len,opType:an.Sec_PageOrientation,value:e,broadcast:!0};return this.cmdExecutor.sendCommandBlock({name:"formatOp",param:n})?(this.selection.onCmdExec(),!0):void 0}},{key:"setSymbolChar",value:function(e,t){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;if(e<=0)return!1;var n={pos:t.pos,len:t.len,opType:an.Symbol_Char,value:e,broadcast:!0};return this.cmdExecutor.sendCommandBlock({name:"formatOp",param:n})?(this.selection.onCmdExec(),!0):void 0}},{key:"setLineNumbering",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t=void 0,n=void 0;if(window.APP.isWebMode())t=0,n=this.data.doc.getBodyRange(0).end;else{var i=this.selection.getNormalRange(!0);t=i.pos,n=i.len}var a={pos:t,len:n,opType:an.Sec_LineNumbering,broadcast:!0};return e&&(a.value=e),this.cmdExecutor.sendCommandBlock({name:"formatOp",param:a})?(this.selection.onCmdExec(),!0):void 0}},{key:"changeAutoNum",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t=this.selection.getNormalRange(!0),n={opType:e,pos:t.pos,len:t.len};return this.cmdExecutor.sendCommandBlock({name:"formatOp",param:n}),!0}},{key:"replaceControlContent",value:function(e){this.data.api.isConnected()&&!this.data.api.hasBlocking()&&this.cmdExecutor.sendCommandBlock({name:"replaceControlContent",param:e})}},{key:"enterCurrentHeaderFooter",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.selection.end||this.app.isReadOnly()||this.app.formatContentController.isInRestrictEditMode)return Promise.reject("promise reject: enterCurrentHeaderFooter: disable");var n=this.selection.end.pos;if(!n||void 0===n.layoutIndex||n.layoutIndex<0||n.layoutIndex>=this.data.typoinfo.pageCount)return Promise.reject("promise reject: enterCurrentHeaderFooter: no pos");var i=this.data.typoinfo.layout_pages[n.layoutIndex];return i?(this.selection.selContext.setHeaderfooterLayoutIndex(n.layoutIndex),new Promise((function(a,o){if(void 0===i.header||void 0===i.footer){if(!e.data.api.isConnected()||e.data.api.hasBlocking())return null;var r={pos:e.selection.end.position,len:0,strlen:0,bSendSelectionBack:!0};e.cmdExecutor.sendCommandBlock({name:"insertHeaderFooter",param:r},(function(e){e.success?a({pageIndex:n.layoutIndex,isInsert:!0}):o("promise reject: enterCurrentHeaderFooter: command block error")}))}else{var s=t?i.header.range.pos:i.footer.range.pos;e.selection.setPosition(s,s,{isSend:!0,preventFocus:_.isPad}),a({pageIndex:n.layoutIndex,isInsert:!1})}}))):Promise.reject("promise reject: enterCurrentHeaderFooter: no layout")}},{key:"enterCurrentHeader",value:function(){return this.enterCurrentHeaderFooter(!0)}},{key:"enterCurrentFooter",value:function(){return this.enterCurrentHeaderFooter(!1)}},{key:"leaveCurrentHeaderFooter",value:function(e){var t=this.selection.end;if(!t)return!1;var n=t.pos;if(!n||void 0===n.layoutIndex||n.layoutIndex<0||n.layoutIndex>=this.data.typoinfo.pageCount)return!1;var i=this.data.typoinfo.layout_pages[n.layoutIndex];if(!i)return!1;var a=0;if(null==e){var o=i.range.pos,r=i.range.len;a=o,n.isInFooter&&(a=o+r-1)}else a=e;this.selection.setPosition(a,a,{isSend:!0,shouldBlur:_.isPad}),this.workspace.switchIndicatorState(!0);var s={name:"exitHeaderFooter",param:{pos:n.position,len:0}};this.cmdExecutor.sendCommandBlock(s)}},{key:"resetCopiedFormat",value:function(){this.state.copiedFormat=!1}},{key:"clearFormatting",value:function(){var e=this.selection.getNormalRange(),t={name:"formatOp",param:{pos:e.pos,len:e.len,opType:an.Font_Para_ClearFormat,rgs:this.selection.getNormalRanges()}};this.cmdExecutor.exec(t)&&(this.selection._dispatch("onUILOperationTriggered",e.pos,e.pos+e.len,{isEditing:!0}),this.selection.onCmdExec())}},{key:"insertWatermark",value:function(e,t){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var n=this.selection.getNormalRange(),i={pos:n.pos,len:n.len};return void 0!==e.applyTo&&(i.applyTo=e.applyTo),void 0!==e.name&&(i.name=e.name),void 0!==e.templateIndex?i.templateIndex=e.templateIndex:(i.textWatermark=e.textWatermark,i.pictureWatermark=e.pictureWatermark),this.cmdExecutor.sendCommandBlock({name:"insertWatermark",param:i},t),!0}},{key:"deleteWatermark",value:function(e,t){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var n={};if(void 0!==e&&(void 0!==e.type&&(n.type=e.type),void 0!==e.applyTo&&(n.applyTo=e.applyTo,0===n.applyTo))){var i=this.selection.getNormalRange();n.pos=i.pos,n.len=i.len}return this.cmdExecutor.sendCommandBlock({name:"deleteWatermark",param:n},t),!0}},{key:"modifyWaterMark",value:function(e,t){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var n=Object.assign({},e);if(0===n.applyTo){var i=this.selection.getNormalRange();n.pos=i.pos,n.len=i.len}this.cmdExecutor.sendCommandBlock({name:"doWaterMarkOp",param:n},(function(e){window.APP.workspace.refreshForcedly(),"function"==typeof t&&t(e)}))}},{key:"canApplyDatetime",value:function(){var e=this,t=this.selection.getNormalRange(),n=this.selection.selInfo.getSelectionInfo(),i=n.ctrls;return Array.isArray(i)?i.every((function(n){return!(n.isDate&&!e.selection.selInfo._isHitBeforeCtrl(t.pos,t.len,n))})):!!!this.selection.selInfo.getHyperlink()&&(!n.inTable||!(n.tableSelected||n.wholeCellSelected||n.rowSelected||n.columnSelected))}},{key:"applyDatetime",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t=void 0!==e.rg?e.rg:this.selection.getNormalRange(),n={pos:t.pos,len:t.len,displayText:e.displayText,displayFormat:e.displayFormat,strlen:e.displayFormat.length,bSendSelectionBack:!0};void 0!==e.isModify&&(n.isModify=e.isModify),void 0!==e.isModifyFormat&&(n.isModifyFormat=e.isModifyFormat),void 0!==e.year&&(n.year=e.year),void 0!==e.month&&(n.month=e.month),void 0!==e.day&&(n.day=e.day),void 0!==e.hours&&(n.hours=e.hours),void 0!==e.minutes&&(n.minutes=e.minutes),void 0!==e.seconds&&(n.seconds=e.seconds),void 0!==e.lunarCalendar&&(n.lunarCalendar=e.lunarCalendar,n.strlen+=e.lunarCalendar.length);var i=this.selection.selContext.ipChpx;return i&&(n.ipChpx=i),n.woUserID=this.app.userTagId,this.cmdExecutor.sendCommandBlock({name:"insertDatetime",param:n})?(this.selection.onCmdExec(),!0):void 0}},{key:"insertCatalog",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t=this.selection.getNormalRange(),n=t.pos,i=t.len,a=this.data.doc.contentControls.collect(t.pos,t.len)||[];if(a.length>0){var o=a[0],r=a[a.length-1];r.isRepeatSec||r.isRichText||r.isPureText||(n=o.end,i=0)}var s={pos:n,len:i,replaceContent:!1};return this.cmdExecutor.exec({name:"insertTableOfContents",param:s,cb:e.cb})?(this.selection.onCmdExec(),!0):void 0}},{key:"removeCatalog",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t={pos:e.pos,len:e.len};return this.cmdExecutor.exec({name:"removeTableOfContents",param:t,cb:e.cb})?(this.selection.onCmdExec(),!0):void 0}},{key:"updateCatalog",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t={pos:e.pos,len:e.len,updateType:e.updateType};return this.cmdExecutor.exec({name:"updateTableOfContents",param:t,cb:e.cb})?(this.selection.onCmdExec(),!0):void 0}},{key:"setCatalog",value:function(e){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var t={pos:e.pos,len:e.len,showLevel:e.showLevel,showPageNum:e.showPageNum,leader:e.leader};return this.cmdExecutor.exec({name:"modifyTableOfContents",param:t,cb:e.cb})?(this.selection.onCmdExec(),!0):void 0}},{key:"setSectionMargins",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.selection.selInfo.getMaxMargin();if(e.left>n.l||e.right>n.r)return-1;if(e.top>n.t||e.bottom>n.b)return-2;if(!this.data.api.isConnected()||this.data.api.hasBlocking())return this.selection.selContext.backupMargins=e,1;var i=this.selection.getNormalRange();if(this.selection.selContext.isInHeaderFooter){var a=this.selection.begin.pos.line.viewPage.section;i={pos:a.pos,len:0}}var o={pos:i.pos,len:i.len,opType:an.Sec_Margins,unit:e.unit,left:e.left,right:e.right,top:e.top,bottom:e.bottom,broadcast:!0,scope:t};return this.cmdExecutor.sendCommandBlock({name:"formatOp",param:o})?(this.selection.onCmdExec(),1):void 0}},{key:"setPageSize",value:function(e){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var t=this.selection.getNormalRange(!0),n={pos:t.pos,len:t.len,opType:an.Sec_PageSize,unit:e.unit,height:e.height,width:e.width,scope:e.scope,broadcast:!0,isCustomSize:e.isCustomSize};this.cmdExecutor.sendCommandBlock({name:"formatOp",param:n})&&this.selection.onCmdExec()}}},{key:"setStyle",value:function(e,t){if(!this.selection.selInfo.info.isPapxNonEditable){var n=e===Ai.o,i=this.selection.getNormalRange(!n),a=this.data.doc.getDataLogic("final"),o=a.getChar(i.pos),r=a.getChar(i.pos+i.len);if(o.charCodeAt(0)===Nt.n&&r.charCodeAt(0)!==Nt.o&&(i.pos++,i.len--),!n||0!==i.len){if(e<9){var s=this.data.doc.stylesheet.findStyle(e);s&&"apply"in s&&(s.apply=!0)}var l={testParam:1,pos:i.pos,len:i.len,opType:an.Style_ApplyToRange,value:e,isExpendPara:!n,rgs:this.selection.getNormalRanges(!n)};e>=Ai.n&&e<=Ai.k&&(l.keepProps=!0),t&&(l.isCancel=!0);var c={name:"formatOp",param:l};if(this.cmdExecutor.exec(c)){var u=this.selection.getNormalRange(),d=u.pos,h=u.len;this.selection._dispatch("onUILOperationTriggered",d,d+h,{isEditing:!0}),this.selection.onCmdExec()}}}}},{key:"gainLinkName",value:function(e,t,n){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var i=t;if(i>0){var a=this.data.doc.getDataLogic("final").getPapx(e+i-1);if(e+i===a.pos+a.len&&a.prop.getPropVal("para_type")===Dt.b)--i;else{var o=this.data.doc.getSubDocType(e);if(o===A.Comment){var r=this.data.doc.comments.getCommentByBookmarkPos(e);if(r){var s=r.body;e+i===s.pos+s.len&&--i}}else{var l=this.data.doc.getSubDocRange(o);e+i===l.pos+l.len&&--i}}}if(i>0){var c=this.data.doc.getText(e,i);if(c)for(var u=c.length-1;u>=0;--u){if(c.charCodeAt(u)!==Nt.a)break;--i}}var d=this.data.doc.bookmarks.rangeClass.findNodeEqualRange(e,e+i);if(d)n&&n(d.name);else{for(var h="_link"+Math.random().toString(36).substr(2),p=0,f=this.data.doc.bookmarks.map;f[h];)++p,h=h+"_"+p;var g={name:"insertBookmark",param:{pos:e,len:i,name:h}};this.cmdExecutor.exec(g)&&this.data.api.save((function(){n&&n(h)}))}}}},{key:"commitAndInsertNewTempComment",value:function(){ce.default.dispatchEvent(ce.default.comments.COMMIT_AND_INSERT_NEW_COMMENT)}}]),t}(Ci.a),Qi=n(6752),Ji=function(e){function t(e){l()(this,t);var n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.app.isReadOnly()||_.isPad||n.workspace.focusWithoutScroll(),n}return v()(t,e),u()(t,[{key:"getEvents",value:function(){return[].concat(r()(yt.eventList),r()(xi.eventList))}},{key:"initEventInfos",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initEventInfos",this).call(this),this.eventTargetMap=a()({},this.eventTargetMap,{input:this.app.workspace.input,workspaceElement:this.app.workspace.element,waterdropElement:this.app.workspace.waterdrop,waterdropElements:this.app.workspace.waterdrop.elements,visualViewport:window.visualViewport?window.visualViewport:window}),this.eventWhiteList={transact:["mousedown","click","resize","focus","blur"]}}},{key:"getGestureRelatedEventTypes",value:function(e){return _.isPad?"waterdropElements"===e?[ae.c.TOUCH]:[ae.c.MOUSE,ae.c.TOUCH]:[ae.c.MOUSE]}},{key:"initState",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initState",this).call(this),this.pos=null}},{key:"initContext",value:function(){this.context={classes:{local:yt,selection:xi,eventList:Qi.a}}}},{key:"initHandlers",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initHandlers",this).call(this),this.uiHandler=new Ti(this.app,this),this.editHandler=new Ki(this.app,this)}},{key:"onPermissionChange",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onPermissionChange",this).call(this),this.app.isReadOnly()||_.isPad||this.app.workspace.input.focus()}},{key:"isTapOnSelection",value:function(e){if(e.isFuzzyHit)return!1;var t=this.data.selection.getNormalRange(),n=t.pos,i=n,a=n+t.len;return e.position>=i&&(e.position<a||e.position===a&&e.glyphTail)}},{key:"getPosByEvent",value:function(e){var t=this.workspace.element.cacheDOMAttr,n=t.scrollLeft,i=t.scrollTop,a=t.rect,o=document.body.cacheDOMAttr,r=o.scrollLeft,s=o.scrollTop,l=void 0;e.touches&&e.touches.length?l=e.touches[0]:e.changedTouches&&e.changedTouches.length?l=e.changedTouches[0]:isNaN(e.pageX)||isNaN(e.pageY)||(l={pageX:e.pageX,pageY:e.pageY});var c=this.workspace.getScaleValue(),u=(n+(l.pageX-a.left-r))/c,d=(i+(l.pageY-a.top-s))/c;return{x:u-=this.workspace.getZoomDiff()/c,y:d}}},{key:"getPosByEventInComment",value:function(e){return _.isFirefox?{x:e.layerX,y:e.layerY}:{x:e.offsetX,y:e.offsetY}}},{key:"enterHeaderFooter",value:function(e,t,n){var i=n.layout,a=n.layoutIndex,o=n.isInFooter,r=i.header,s=i.footer,l=i.range;if(this.data.selection.selContext.setHeaderfooterLayoutIndex(a),void 0!==r&&r.range&&void 0!==s&&s.range){this.data.selection.selContext.setSubdocType(A.HeaderFooter),window.collection("doc_enter_header_footer",2);var c=this.hit({pos:e,event:t});this.data.selection.setPosition(c,c,{isSend:!0,isClick:!0}),this.workspace.makesureCursorVisible()}else if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var u={pos:l.pos,len:0,strlen:0,bSendSelectionBack:!0};o&&(u.seekedFooter=!0);var d={name:"insertHeaderFooter",param:u};this.editHandler.cmdExecutor.sendCommandBlock(d)}}},{key:"exitHeaderFooter",value:function(e,t){this.data.selection.selContext.setSubdocType(A.MainText);var n=this.hit({pos:e,event:t});this.editHandler.leaveCurrentHeaderFooter(n)}},{key:"setupCommentElements",value:function(e,t,n){this.workspace.commentContainer=e,this.workspace.commentInput&&this.workspace.commentInput.element===t.element||(this.workspace.commentInput=t,this.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseOnEnterCommentBody",t),this.sendCommandToModule(re.b.SELECTION,Ee.a.AT,"onCommandResponseOnEnterCommentBody")),this.workspace.commentCursor=n}},{key:"resetCommentElements",value:function(){this.workspace.commentCursor=null,this.workspace.commentContainer=null,this.workspace.commentInput=null,this.sendCommandToModule(re.b.SELECTION,Ee.a.KEYBOARD,"onCommandResponseOnExitCommentBody"),this.sendCommandToModule(re.b.SELECTION,Ee.a.AT,"onCommandResponseOnExitCommentBody")}},{key:"enterCommentBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pos,n=e.range,i=e.event,a=e.context,o=a.rcId,r=a.commentId,s=a.isReply,l=a.commentContainer,c=a.commentInput,u=a.commentCursor,d=a.isCommentEditable,h=this.data.selection;this.data.selection.enterCommentBody(o,r,s,d),this.setupCommentElements(l,c,u);var p=null;if(Object(bn.isInTempComment)()){var f=Object(bn.getTempData)(),g=f.tempRange;g.len&&h.setPosition(g.pos,g.pos+g.len)}else if(n){var v=window.g_rpt.getLastLocalCommand(),y=v&&"insertComment"===v.name;h.setPosition(n.pos,n.pos+n.len,{isSend:!0,isEditing:d&&!y})}else t&&(p=this.hit({pos:t,event:i}),this.app.restrictEditHandler.isInRestrictEditMode||h.setPosition(p,p,{isSend:!0}));return ce.default.dispatchEvent(ce.default.comments.ON_ENTER_COMMENT_BODY,{id:o}),window.requestAnimationFrame((function(){window.APP.isReadOnly()||c.element.focus()})),p}},{key:"enterComment",value:function(e,t){var n=e.rcId,i=e.commentId,a=this.workspace.revisionComment.commentComponentManager.getCommentComponentInfo({rcId:n,commentId:i});if(a){this.exitCommentBody();var o=a.commentTextRef;this.enterCommentBody({range:{pos:t.pos,len:t.len},context:{rcId:n,commentId:i,commentContainer:o.getCommentContainer(),commentInput:o.getCommentInput(),commentCursor:o.getCommentCursor()}})}else console.warn("评论不存在")}},{key:"exitCommentBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.data.selection.selContext.isInComment()){var t=this.data.selection.selContext.getCommentRcId(),n=this.data.selection.selContext.isCommentEditable;this.data.selection.exitCommentBody(),this.sendCommandToModule(re.b.SELECTION,Ee.a.COMMENT,"onCommandResponseOnExitCommentBody"),ce.default.dispatchEvent(ce.default.comments.ON_EXIT_COMMENT_BODY,a()({id:t,isEditable:n},e)),this.resetCommentElements()}}},{key:"getVisibleCoordinate",value:function(){return this.getPosByEvent({pageX:0,pageY:this.workspace.element.cacheDOMAttr.rect.top+5})}},{key:"hit",value:function(e){var t=e.type,n=e.event,i=e.pos,a=this.data.selection.selContext.isInComment(),o=i,r={event:n};void 0===i&&(o=a?this.getPosByEventInComment(n):this.getPosByEvent(n)),a&&(r.commentId=this.data.selection.selContext.getCommentRcId());var s=m.a.hit(this.data,Object.assign({},o),this.data.typoinfo,r);return s&&(void 0!==t?this.hitInSpecific(t,o,s,n):ie.hit(this.app,this.data,o,s,n)),s}},{key:"hitInSpecific",value:function(e,t,n,i){ie.hitInSpecific({pos:t,type:e,hitResult:n,event:i,app:this.app,data:this.data})}},{key:"handleGestureEventOnComment",value:function(e,t,n,i){var a=this.data.selection.selContext;return t===ae.a.LEAVE||a.isInComment()&&a.getCommentRcId()===i.rcId&&(!i.commentContainer.element||this.workspace.commentContainer)&&i.commentContainer.element===this.workspace.commentContainer.element?this.hit({pos:e,event:n}):(this.exitCommentBody(),this.enterCommentBody({pos:e,event:n,context:i}))}},{key:"handleGestureEventOffComment",value:function(e,t,n){var i=t!==ae.a.LEAVE&&t!==ae.a.MOVE,a="touchstart"!==e.type&&"touchmove"!==e.type&&("touchend"!==e.type||!n.isMoved);_.isPad?a&&i&&this.exitCommentBody():i&&this.exitCommentBody()}},{key:"preHandleDoubleTapInEditMode",value:function(e,t){var n=void 0,i=ie.hitHeaderFooterInfo(e,this.data);if(this.data.selection.selContext.isInHeaderFooter){if(n=this.hit({pos:e,event:t}),!i){var a=n,o=a.position,r=a.type,s=this.data.doc.getSubDocType(o);if(!(r===b.a.SHAPE&&s===A.HeaderFooter||s===A.TextboxInHF))return this.exitHeaderFooter(e,t),null}}else{if(i)return this.enterHeaderFooter(e,t,i),null;n=this.hit({pos:e,event:t})}return n}},{key:"onGestureEvent",value:function(e,t){var n=e.event,i=e.type,a=e.context,o=void 0,r=!1;void 0!==t.rcId?(o=this.getPosByEventInComment(n),r=this.handleGestureEventOnComment(o,i,n,t)):(this.handleGestureEventOffComment(n,i,a),o=this.getPosByEvent(n),r=i!==ae.a.DOUBLE_TAP||window.APP.isReadOnly()?this.hit({pos:o,event:n}):this.preHandleDoubleTapInEditMode(o,n)),r&&(this.createLocalUILIfNeeded(e,r),this.execute(e,r))}},{key:"onKeyboardEvent",value:function(e){var t=null;this.pos&&Object(oe.c)(e)&&(t=this.hit({pos:this.pos})),this.execute(e,t)}},{key:"execute",value:function(e,n){var i=e.type,a=this.context.classes.eventList,o=a.mouse,r=a.gesture,s=(n||{}).hitFileName;if(this.eventWhiteList.transact.includes(e.type)&&!this.app.data.selection.selContext.isInComment()&&this.editHandler.closeLastTransact(),!this.app.isEnterFileName&&!s||!(o.includes(i)&&"mouseleave"!==i&&"mouseenter"!==i||r.includes(i)))return f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e,n)}}]),t}(y.a);t.default=Ji},1090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateWebshapeByEdit=t.getAllUrlsInfo=t.getStageInfo=t.setStageInfo=t.getEmbedsUrlInfo=t.getFileInfo=t.elementToSnapshot=t.uploadMimeDataImg=t.urlsInfo=t.urlsStatus=t.drawWebshape=void 0;var i=n(5),a=i.__importDefault(n(312)),o=n(358),r=n(167),s=n(1569),l=i.__importDefault(n(1570)),c=i.__importDefault(n(1571)),u=!1,d={},h={s:700,f:700,w:650};function p(e){var t=null==e?void 0:e.split("/");return(null==e?void 0:e.startsWith("http"))?t[0]+"//"+t[2]:t[0]}function f(e,t){var n,i,a=P(e),r=(n=null==a?void 0:a.url,"string"!=typeof(i=null==a?void 0:a.icon)?"":new RegExp(/^(?:http(s)?:\/\/)?(\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/).test(i)||"data:image"===i.split("/")[0]?i:p(n)+(i||"/favicon.ico"));return y({tag:"div",options:{id:"frame_topbar",style:"height: 44px; padding: 8px 0px 8px 12px; display: flex; flex-direction: row; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(13, 13, 13, 0.12); cursor: auto; background-color: white;"},childList:[{tag:"div",options:{style:"height: 44px; width: fit-content; display: flex; flex-direction: row; align-items: center; padding: 0px; gap: 4px;"},childList:(null==a?void 0:a.url)&&[{tag:"i",options:{style:"height: 16px; width: 16px; background-image: url(".concat(r,"); background-size: contain;")}},{tag:"span",options:{title:null==a?void 0:a.title,style:"height: 44px; font-style: normal; font-family: 'PingFang SC'; font-weight: 400; font-size: 14px; line-height: 44px; color: rgba(13, 13, 13, 0.9); text-transform: capitalize; display: flex; white-space: nowrap; align-items: center; max-width: ".concat(t.width-128,"px;")},innerText:null==a?void 0:a.title}]},{tag:"div",options:{style:"height: 28px; width: fit-content; display: flex; flex-direction: row; align-items: center; border-radius: 6px; padding: 3px 12px 3px 24px; cursor: pointer; background-color: white;"},childList:[{tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: #0A6CFF;"},innerText:_i18n("applications.writer.helpers.webshapeDraw.openLink", "Open Link"),events:(null==a?void 0:a.url)&&{onclick:function(){(0,o.openHyperlink)(null==a?void 0:a.url),window.collection("commandbar","click","webshape_openPreviewViewLink")},ontouchend:function(){(0,o.openHyperlink)(null==a?void 0:a.url),window.collection("commandbar","click","webshape_openPreviewViewLink")}}}]}]})}function g(e){var t=e.width,n=e.height;return y({tag:"div",options:{id:"frame_page",style:"height: ".concat(n-44,"px; width: ").concat(t,"px; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #FAFAFA;")}})}function v(e){var t=a.default.iconTypes.other.wps_webshape_iframe_error.split(" "),n=t[0],i=t[1];return y({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 16px; padding: 0px; width: fit-content; height: fit-content; margin-bottom: 16px;"},childList:[{tag:"div",options:{class:"icons-".concat(n,"-").concat(i),style:"height: 100px; width: 100px;"}},{tag:e&&"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:e}]})}function y(e){var t=e.tag,n=e.options,i=e.innerText,a=e.childList,o=e.events,r=document.createElementNS("http://www.w3.org/1999/xhtml",t);for(var s in i&&(r.innerText=i),a&&a.length&&a.forEach((function(e){if(e.tag){var t=y(e);r.appendChild(t)}})),o)r[s]=o[s];for(var s in n)r.setAttribute(s,n[s]);return r}function m(e,t){var n=g(e),i=v(_i18n("applications.writer.helpers.webshapeDraw.loadFailed", "Failed to load")),a=y({tag:"span",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; color: ".concat(r.isMobile||r.isPad?"white":"#0A6CFF","; padding: 3px 8px; height: 28px; width: 80px;\n          cursor: pointer; background: ").concat(r.isMobile||r.isPad?"#0A6CFF":"white","; text-align: center; border-radius: 4px;")},innerText:_i18n("applications.writer.helpers.webshapeDraw.reload", "Reload"),events:{onclick:function(){t&&t()},ontouchend:function(){t&&t()}}});return n.appendChild(i),n.appendChild(a),n}function _(e){var t=g(e),n=v(_i18n("applications.writer.helpers.webshapeDraw.cantOpen", "Access failed.")),i=y({tag:"span",options:{style:"height: 22px; font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; display: flex; align-items: center; color: rgba(13, 13, 13, 0.46);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.rejectConnect", "The web page denied your connection.")});return t.appendChild(n),t.appendChild(i),t}function x(e){var t=g(e),n=v(_i18n("applications.writer.helpers.webshapeDraw.notSupportView", "You cannot preview this web page."));return t.appendChild(n),t}function w(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,s.getUrlsStatus)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function k(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:if(!Array.isArray(e))throw new Error("param is not array");return!e.length||1===e.length&&""===e[0]?[2]:[4,window.APP.dispatch((0,s.getUrlsInfo)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function b(e,t){var n=e.children,i=t.page,a=t.topBar,o=n.frame_page||n[1],r=n.frame_topbar||n[0];a&&(e.removeChild(r),e.insertBefore(a,o)),i&&(e.innerHTML="",e.appendChild(r),e.appendChild(i))}function T(e,t,n,a){e.innerHTML="";var o=function(){C(n).then((function(i){if("ok"!==i.result)throw new Error("fail to horization");delete d[n],A([n]),T(e,t,n,a)}))},l=function(){var t=x(a);b(e,{page:t})},v=function(){var i=null;!function e(t,n){return!!t&&(t===n.fileInfo.id||n!==n._parent&&e(t,n._parent))}(P(n).id,window)?(i=function(e,t,n,i,a){var o,r=(0,s.isKdocsDoc)(n)?n.split("?")[0]+"?simple&hidecmb&readonly&title_not_update&hide_public_popups&disablePlugins&enterView=card":n,l=i.width,c=i.height,u=(null===(o=window.APP.data.selection.activeShape)||void 0===o?void 0:o.id)===t,d=setTimeout((function(){try{var a=f.firstChild.contentWindow;a&&(a.document.write(""),a.document.close())}catch(e){}var o=m(i,(function(){T(e,t,n,i)}));b(e,{page:o})}),5e3),p=function(){var t=e.querySelector(".webshape-iframe-mask");t&&(t.style.display="none");var n=null==f?void 0:f.parentElement.getBoundingClientRect(),i=n.x,a=n.y,o=window.APP.uilManager.hit({event:{pageX:i,pageY:a}});window.APP.data.selection.selAlter.selectShape(null==o?void 0:o.shapeInfo,{})},f=y({tag:"div",options:{style:"height: ".concat(c-44,"px; width: ").concat(l,"px;")},childList:[{tag:"iframe",options:{style:"height: ".concat(c-44,"px; width: ").concat(l,"px; border: 1px solid rgba(0,0,0,0);"),src:r,allowpaymentrequest:!0,frameBorder:"0",allow:"encrypted-media",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation"},events:{onload:function(t){var o;d&&clearTimeout(d),d=null;try{var r=f.firstChild.contentDocument;if(r){var c=null===(o=P(n))||void 0===o?void 0:o.officeType,u=h[c];f.firstChild.contentWindow.addEventListener("resize",(function(){var e=(0,s.isKdocsDoc)(n)&&r.getElementsByClassName("cmd-status-bar")[0]||r.getElementsByClassName("et-cmd-status-bar")[0];window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width?e&&u&&e.setAttribute("style",""):e&&u&&(e.style.width="".concat(u,"px"),e.style.transform="scale(".concat(l>u?1:l/u,")"),e.style.left="-".concat((u-l)/2,"px"))}));var p=setInterval((function(){var e,i=(0,s.isKdocsDoc)(n)&&r.getElementsByClassName("cmd-status-bar")[0]||r.getElementsByClassName("et-cmd-status-bar")[0];i&&u&&(i.style.width="".concat(u,"px"),i.style.transform="scale(".concat(l>u?1:l/u,")"),i.style.left="-".concat((u-l)/2,"px"),"w"===c&&(null===(e=f.firstChild.contentWindow)||void 0===e||e.APP.workspace.scrollTo({scrollTop:70,scrollLeft:110})),g&&clearTimeout(g),p&&clearInterval(p),g=null,p=null,a&&a(t))}),500),g=setTimeout((function(){p&&clearInterval(p),p=null,g=null,a&&a(t)}),5e3)}else a&&a(t)}catch(t){var v=_(i);b(e,{page:v})}}}},{tag:"div",options:{class:"webshape-iframe-mask",style:"position: absolute; top: 0; left: 0; right: 0;bottom: 0; display: ".concat(u?"none":"block","; cursor: move;")},events:{onmouseup:p,ontouchend:p}}]});return f}(e,t,n,a,(function(){var t=e.children;t.frame_page&&e.removeChild(t.frame_page),document.title=I})),e.appendChild(i)):(i=function(e){var t=g(e),n=y({tag:"div",options:{style:"font-size: 16px"},innerText:_i18n("applications.writer.helpers.webshapeDraw.noNest", "Viewing the preview view is not supported.")});return t.appendChild(n),t}(a),b(e,{page:i}))},S=function(i){if(n.startsWith("http://")){var s=x(a);b(e,{page:s})}else switch(i){case"succeed":switch(P(n).frame_option){case"DENY":M=_(a),b(e,{page:M});break;case"SAMEORIGIN":p(n)===window.top.location.origin?v():(M=_(a),b(e,{page:M}));break;default:v()}break;case"failed":M=x(a),b(e,{page:M});break;case"unauthorized":M=function(e,t,n,i){var a=g(e),o=y({tag:"div",options:{style:"display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 8px;"},childList:[{tag:"p",options:{style:"height: 24px; font-family: 'PingFang SC'; font-style: normal; font-weight: 600; font-size: 16px; line-height: 24px; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.askTrust", "Are you sure you want to trust this web page?")},{tag:"p",options:{style:"font-family: 'PingFang SC'; font-style: normal; font-weight: 400; font-size: 14px; line-height: 22px; text-align: center; color: rgba(13, 13, 13, 0.66);"},innerText:"".concat(_i18n("applications.writer.helpers.webshapeDraw.trustInfo", "For the security of your personal information, make sure that the web page can be trusted to prevent security risks:")).concat(t)},{tag:"div",options:{style:"width: 154px; display: flex; flex-direction: row; align-items: center; gap: 8px; height: 32px;"},childList:[{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #F5F7FA; border-radius: 4px; padding: 4px 15px;\n                          line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; \n                          color: rgba(13, 13, 13, 0.9); cursor: pointer;\n                          box-shadow: 0px 0px 0px 1px rgba(13, 13, 13, 0.1), 0px 1px 0px rgba(13, 13, 13, 0.14);"},innerText:r.isMobile||r.isPad?_i18n("applications.writer.helpers.webshapeDraw.cancel", "Cancel"):_i18n("applications.writer.helpers.webshapeDraw.notTrust", "Do Not Trust"),events:{onclick:function(){i&&i()},ontouchend:function(){i&&i()}}},{tag:"span",options:{style:"width: 123.5px; height: 32px; background: #0A6CFF; border-radius: 4px; padding: 4px 15px;\n                          cursor: pointer; line-height: 22px; text-align: center; font-weight: 400; font-size: 14px; color: #FFFFFF;"},innerText:r.isMobile||r.isPad?_i18n("applications.writer.helpers.webshapeDraw.confirm", "OK"):_i18n("applications.writer.helpers.webshapeDraw.trust", "Trust"),events:{onclick:function(){n?n():C(t)},ontouchend:function(){n?n():C(t)}}}]}]});return a.appendChild(o),a}(a,n,o,l),b(e,{page:M});break;default:var c=setTimeout((function(){clearInterval(u),clearTimeout(c),M=m(a,(function(){T(e,t,n,a)})),b(e,{page:M})}),1e4),u=setInterval((function(){var i=P(n);A([n]),i&&(clearInterval(u),clearTimeout(c),T(e,t,n,a))}),1e3);Promise.race([c,u])}},I=document.title,R=function(e){var t=g(e),n=y({tag:"div",options:{style:"display: flex; flex-direction: row; align-items: center; padding: 0px; height: 22px; gap: 4px;"},childList:[{tag:"img",options:{style:"width: 16px; height: 16px;",src:c.default}},{tag:"span",options:{style:"font-size: 14px; font-weight: 400; height: 22px; line-height: 22px; align-items: center; color: rgba(13, 13, 13, 0.9);"},innerText:_i18n("applications.writer.helpers.webshapeDraw.contentIsLoading", "Loading the content...")}]});return t.appendChild(n),t}(a),O=f(n,a),M=R;if(e.appendChild(O),e.appendChild(M),L(n)&&!u)u=!0,w([n]).then((function(e){e&&"succeed"===e[0].status?k([n]).then((function(t){t[0]&&(E(i.__assign(i.__assign({},e[0]),t[0])),S(e[0].status)),u=!1})):(S(e&&e[0].status),u=!1)}));else{var D=P(n);S(D&&D.status||"")}}function C(e){var t;return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,window.APP.dispatch((0,s.authorizedUrl)(e))];case 1:return n=i.sent(),[2,null===(t=null==n?void 0:n.response)||void 0===t?void 0:t.body]}}))}))}function S(e,t){return i.__awaiter(this,void 0,void 0,(function(){var n,a,o,r;return i.__generator(this,(function(i){return n=e.split("?")[0],a=n.split("/"),o=a[a.length-1],(r=new XMLHttpRequest).open("GET","/api/office/file/"+o),r.send(),r.onload=function(){t(JSON.parse(r.response))},[2]}))}))}function E(e){(null==e?void 0:e.url)&&(d[e.url]=e)}function P(e){return d[e]}function L(e){var t=P(e);return t&&t.status&&"succeed"===t.status&&void 0===t.icon&&void 0!==t.title||!t}function A(e,t){if(!(!1===t||u&&void 0!==t)&&e.length&&window.__CONFIG__.wps.isEnableSwitchToWebshape){u=!0;var n=e.filter((function(e){return"string"==typeof e})),a=n.filter((function(e){return L(e)&&!(0,s.isKdocsDoc)(e)})),o=n.filter((function(e){return L(e)&&(0,s.isKdocsDoc)(e)})),r=a.length+o.length;if(0!==r){var l=0;o.map((function(e){S(e,(function(t){if(null==t?void 0:t.file){var n=t.file.name,i=t.file.office_type,a=i?"https://qn.cache.wpscdn.cn/kdocs/cloud/dotview/favicon/favicon_".concat(i,".png"):"https://www.kdocs.cn/favicon.ico";E({url:e,status:"succeed",title:n,icon:a,id:t.file.id,officeType:i})}else E({url:e,status:"succeed",title:"",icon:""});(l+=1)===r&&(u=!1)}))})),a.length&&w(a).then((function(e){var t=(e||[]).filter((function(e){return"succeed"===e.status})).map((function(e){return e.url}));t.length?k(t).then((function(t){t&&t[0]?a.forEach((function(n){var a=null==e?void 0:e.find((function(e){return e.url===n})),o=null==t?void 0:t.find((function(e){return e.url===n}));E(i.__assign(i.__assign({url:n},a),o)),(l+=1)===r&&(u=!1)})):(a.forEach((function(t){var n=null==e?void 0:e.find((function(e){return e.url===t}));E(i.__assign({url:t},n)),l+=1})),u=!1)})):a.forEach((function(t){E(null==e?void 0:e.find((function(e){return e.url===t}))),(l+=1)===r&&(u=!1)}))}))}else u=!1}}t.urlsStatus=w,t.urlsInfo=k,t.uploadMimeDataImg=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){return[2,window.APP.data.api.postObjectURL().then((function(n){var i=new XMLHttpRequest;i.open("GET",l.default),i.responseType="blob",i.send(),i.onload=function(){var a=t||new Blob([i.response],{type:"image/*"}),o=new FormData;o.append("object",a,t&&t.name||"loading"),window.__WPSENV__.request({method:"POST",url:n,body:o}).end().then((function(t){e&&e(t.body.uploadid)}))}}))]}))}))},t.drawWebshape=T,t.getFileInfo=S,t.elementToSnapshot=function(e){if(!e)throw new Error("can not find element");var t=document.createElement("canvas"),n=t.getContext("2d"),i='data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg">'.concat((new XMLSerializer).serializeToString(e),"</svg>").replace(/\n/g,"").replace(/#/g,"%23"),a=new Image;a.src=i,n.drawImage(a,0,0);for(var o=t.toDataURL("image/png").split(","),r=o[0].match(/:(.*?);/)[1],s=window.atob(o[1]),l=s.length,c=new Uint8Array(l);l--;)c[l]=s.charCodeAt(l);return new File([c],s.slice(0,16)+".png",{type:r})},t.setStageInfo=E,t.getStageInfo=P,t.getEmbedsUrlInfo=function(e){var t=!!e.find((function(e){return e.shape.isWebshape}));A(e.filter((function(e){return e.shape.isWebshape})).map((function(e){return e.shape.webshapeUrl})),t)},t.getAllUrlsInfo=A,t.updateWebshapeByEdit=function(e,t,n){var i=e.getBoundingClientRect();T(e,n,t,i)}},1092:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u}));var i=n(1134);n.d(t,"a",(function(){return i.a}));var a=n(167);n.d(t,"h",(function(){return a}));var o={Picture:1,NormalShape:2,TextBox:3,Processon:4,Table:5,SmartArt:6,Diagram:7,Chart:8,Slicer:9,Media:10,OleShape:11,GroupShape:12,Background:13,Ink:14},r={MODEL_CHART:0,MODEL_DIAGRAM:1,MODEL_DIAGRAM_SHAPETREE:2,MODEL_DIAGRAM_GROUPSHAPE:3,MODEL_DIAGRAM_SHAPE:4,MODEL_SMARTART:5,MODEL_SMARTART_SHAPETREE:6,MODEL_SMARTART_GROUPSHAPE:7,MODEL_SMARTART_SHAPE:8,MODEL_SMARTART_PICTURE_PLACEHOLDER:9,MODEL_OBJTABLE:10,MODEL_OBJTABLE_CELL:11,MODEL_TEXTFRAME:12,MODEL_OUTLINE:13,MODEL_SLICER:14,MODEL_CHART_SUBMODEL_BEGIN:15,MODEL_CHART_SUBMODEL_END:270,MODEL_CUSTOM:65536,MODEL_SLIDECONTAINER:65537,MODEL_NORMALSLIDE:65538,MODEL_MASTERSLIDE:65539,MODEL_LAYOUTSLIDE:65540,MODEL_HANDOUTMASTER:65541,MODEL_NOTESMASTER:65542,MODEL_NOTESPAGE:65543,MODEL_SHAPETREE:65544,MODEL_BGSHAPE:65545,MODEL_GROUPSHAPE:65546,MODEL_SHAPE:65547,MODEL_OUTLINE_TEXTFRAME:65548},s={SINGLE:"single",DOUBLE:"double",THIN_THICK:"thin_thick",THICK_THIN:"thick_thin",THIN_THICK_THIN:"thin_thick_thin",ROUND_DOT:"round_dot",SHORT_DASH:"short_dash",DASH_DOT:"dash_dot",DOUBLE_DOT:"double_dot",OTHER:"..."},l={LineEndTypeNone:0,LineEndTypeTriangle:1,LineEndTypeStealth:2,LineEndTypeDiamond:3,LineEndTypeOval:4,LineEndTypeArrow:5},c={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9},u={VerticalFlipped:"verticalFlipped",HorizontalFlipped:"horizontalFlipped",Right:"right",Left:"left",Some:"some",Reset:"reset"}},1134:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var i={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},a={Shape:function(e){return"s_"+e},BackendShape:function(e){return"backend_s_"+e},Geomerty:function(e){return"s_"+e+"_geomerty"},Media:function(e){return"s_"+e+"_media"},Text:function(e){return"s_"+e+"_text"},TextParagraph:function(e){return"s_"+e+"_textParagraph"},Ink:function(e){return"s_"+e+"_ink"},Table:function(e){return"s_"+e+"_table"},TableCell:function(e){return"s_"+e+"_tableCell"},TableText:function(e){return"s_"+e+"_tableText"},TableBorder:function(e){return"s_"+e+"_tableBorder"},ShapeFill:function(e,t){return"s_"+e+"_shapeFill_"+t},ShapeImage:function(e,t){return"s_"+e+"_image_"+t},ShapeFillPath:function(){return"shape_fill"},ShapeOutlinePath:function(){return"shape_outline"}}},1144:function(e,t,n){"use strict";n.r(t),t.default={SUCCESS_INCLUDE_DATA:1,SUCCESS_CONTENT_LONG:2,SUCCESS_CONTENT_LONG_TEXT:3,SUCCESS_CONTENT_LONG_TEXT_CUT:4,ERROR:5}},1232:function(e,t,n){"use strict";n.r(t),n.d(t,"TABLE_HOTSPOT_UNIT",(function(){return i})),n.d(t,"TABLE_HIGHLIGHT_TYPE",(function(){return a})),n.d(t,"TABLE_INSERT_TYPE",(function(){return o})),n.d(t,"TABLE_DELETE_TYPE",(function(){return r})),n.d(t,"TABLE_CELL_OPTIONS",(function(){return s})),n.d(t,"TABLE_SELECT_MODE",(function(){return l})),n.d(t,"TABLE_COLUMN_ROW_ADJUST_MODE",(function(){return c})),n.d(t,"TABLE_BORDER_STYLE",(function(){return u})),n.d(t,"TABLE_THEME_COLOR",(function(){return d})),n.d(t,"TABLE_ROW_HEADER_TYPE",(function(){return h})),n.d(t,"TABLE_DASHED_BORDER_TYPE",(function(){return p})),n.d(t,"TABLE_COLUMN_MIN_WIDTH",(function(){return f})),n.d(t,"TABLE_HIDDEN_TIMEOUT",(function(){return g})),n.d(t,"TABLE_RESIZE_HIGHLIGHT_TIMEOUT",(function(){return v})),n.d(t,"TABLE_ADJUST_HIGHLIGHT_TIMEOUT",(function(){return y})),n.d(t,"TABLE_FOCUS_TABLE_TIMEOUT",(function(){return m})),n.d(t,"TABLE_HOVER_ADD_BTN_TIMEOUT",(function(){return _}));var i={BORDER:4,PADDING:4,MARGIN:10,DIFF:5,OVERLAY:20},a={TABLE:"TABLE",COLUMN:"COLUMN",ROW:"ROW"},o={ROW_TOP:"ROW_INSERT_TOP",ROW_BOTTOM:"ROW_INSERT_BOTTOM",COLUMN_LEFT:"COLUMN_INSERT_LEFT",COLUMN_RIGHT:"COLUMN_INSERT_RIGHT"},r={ROW:"DELETE_ROW",COLUMN:"DELETE_COLUMN",TABLE:"DELETE_TABLE"},s={MERGE:"MERGE_CELLS",SPLIT:"SPLIT_CELLS",VERT_HORZ_CENTER:"VERT_HORZ_CENTER"},l={NONE:"NONE",CELL:"CELL",ROW:"ROW",COLUMN:"COLUMN"},c={ADJUST_WIN:0,AVERAGE_ROW:1,AVERAGE_COLUMN:2},u={DEFAULT:0,FULL_LINE:1,FULL_FILL:2,TOP_COLUMN:3,COLUMN_ROW_FILL:4},d={DEFAULT:0,BLUE:1,GREEN:2,DARK:3,YELLOW:4,PURPLE:5},h={SET:"SET_TABLE_ROW_HEADER_DUPLICATE",CANCEL:"CANCEL_TABLE_ROW_HEADER_DUPLICATE"},p={SHOW:"SHOW_TABLE_DASHED_BORDER",HIDE:"HIDE_TABLE_DASHED_BORDER"},f=16,g=1e3,v=500,y=500,m=100,_=300},12965:function(e,t,n){var i=n(8847);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?i(e,void 0,t):[]}},12966:function(e,t,n){var i=n(7380);e.exports=function(e,t){return i(e,t)}},1312:function(e,t,n){var i=n(5305),a=n(5308);e.exports=function(e,t){var n=a(e,t);return i(n)?n:void 0}},1470:function(e,t,n){"use strict";n.r(t),n.d(t,"UnitType",(function(){return l})),n.d(t,"UnitName",(function(){return c})),n.d(t,"UnitCNName",(function(){return u})),n.d(t,"UnitI18nName",(function(){return d}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(240),l={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},c=["pt","inc","cm","mm","ref","ti"],u=["磅","英寸","厘米","毫米","?","缇"],d=function(e,t){switch(e.toUpperCase()){case"EN-US":return["pt","inc","cm","mm","ref","ti"][t];case"AR":return["الرطل","بوصة","سم","مم","الصفوف","ti"][t];case"TH":return["ปอนด์","นิ้ว","ซม.","มม.","แถว","สีส้มอมแดง"][t];default:return["磅","英寸","厘米","毫米","?","缇"][t]}},h=function(){function e(t,n){a()(this,e),this.val=t,this.unit=n}return r()(e,[{key:"ti",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_ti])}},{key:"pt",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_pt])}},{key:"inc",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_inc])}},{key:"cm",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_cm])}},{key:"mm",get:function(){return Object(s.convertUnit)(this.val,c[this.unit],c[l.Unit_mm])}}],[{key:"init",value:function(t,n){return new e(t,n)}}]),e}();t.default=h},1530:function(e,t,n){},1569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKdocsDoc=t.getDocInfo=t.authorizedUrl=t.getUrlsInfo=t.getUrlsStatus=void 0;var i=n(5).__importDefault(n(361));t.getUrlsStatus=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/status");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.get(t).query({urls:e.join(",")}).end()}}},t.getUrlsInfo=function(e){if(!e.length)throw new Error('FrontEnd Error: expected "links"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/info");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.get(t).query({urls:e.join(",")}).end()}}},t.getDocInfo=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var t=e.split("?")[0].split("/"),n=t[t.length-1],a="/api/office/file/".concat(n);return{types:i.default.HTTP_TYPES,callAPI:function(e){return e.get(a).query({disableSubFileId:!0}).end()}}},t.authorizedUrl=function(e){if(!e)throw new Error('FrontEnd Error: expected "link"');var t="/api/v3/office/file/".concat(window.fileInfo.id,"/url/capture/authorization");return{types:i.default.HTTP_TYPES,callAPI:function(n){return n.post(t).send({url:e}).end()}}},t.isKdocsDoc=function(e){return new RegExp(/(http(s)?:(\/\/)?)?(www.)?kdocs.cn\/(office\/)?([a-z]){1}\/([a-z]|[A-Z]|[\d]){12}/).test(e)}},1570:function(e,t,n){e.exports=n.p+"images/frameLoading.449d1bc4.png"},1571:function(e,t,n){e.exports=n.p+"images/loading.1c6861da.gif"},1573:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var i={None:0,Legacy:1,Normal:2,Lighten:3,LightenLess:4,Darken:5,DarkenLess:6},a={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},o={LinearShade:0,ShapeShade:1,CircleShade:2,RectangleShade:3},r={TileFlipNone:0,TileFlipHorizontal:1,TileFlipVertical:2,TileFlipBoth:3},s={RectangleAlignmentTopLeft:0,RectangleAlignmentTop:1,RectangleAlignmentTopRight:2,RectangleAlignmentLeft:3,RectangleAlignmentCenter:4,RectangleAlignmentRight:5,RectangleAlignmentBottomLeft:6,RectangleAlignmentBottom:7,RectangleAlignmentBottomRight:8},l={AlphaBiLevel:0,AlphaCeiling:1,AlphaFloor:2,AlphaInverse:3,AlphaModulate:4,Blend:5,AlphaModulateFixed:6,AlphaOutset:7,AlphaReplace:8,BiLevel:9,Blur:10,ColorChange:11,ColorReplace:12,Duotone:13,EffectContainer:14,EffectRef:15,FillOverlay:16,Glow:17,Grayscale:18,HSL:19,InnerShadow:20,Luminance:21,OuterShadow:22,PresetShadow:23,Reflection:24,RelativeOffset:25,SoftEdges:26,Tint:27,Transform:28,PictureEffectBegin:29,ArtisticBlur:29,ArtisticCement:31,ArtisticChalkSketch:32,ArtisticCrisscrossEtching:33,ArtisticCutout:34,ArtisticFilmGrain:35,ArtisticGlass:36,ArtisticGlowDiffused:37,ArtisticGlowEdges:38,ArtisticLightScreen:39,ArtisticLineDrawing:40,ArtisticMarker:41,ArtisticMosiaicBubbles:42,ArtisticPaintBrush:43,ArtisticPaintStrokes:44,ArtisticPastelsSmooth:45,ArtisticPencilGrayscale:46,ArtisticPencilSketch:47,ArtisticPhotocopy:48,ArtisticPlasticWrap:49,ArtisticTexturizer:50,ArtisticWatercolorSponge:51,BackgroundRemoval:52,BrightnessContrast:53,ColorTemperature:54,Saturation:55,SharpenSoften:56},c={type:a.FillTypeNone},u={type:a.FillTypeGradient,shadeType:o.LinearShade}},1698:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var i={MoveTo:1,LineTo:2,ArcTo:3,QuadraticBezierTo:4,CubicBezierTo:5,Close:6},a={None:0,Legacy:1,Normal:2,Lighten:3,LightenLess:4,Darken:5,DarkenLess:6},o={MultiplyDivide:0,AddSubtract:1,AddDivide:2,IfElse:3,Absolute:4,ArcTan:5,CosineArcTan:6,Cosine:7,Maximum:8,Minimum:9,Modulo:10,PinTo:11,SineArcTan:12,Sine:13,SquareRoot:14,Tangent:15,SumAngle:16,Ellipse:17,LiteralValue:18},r={gdRefXY:0,gdRefX:1,gdRefY:2,gdRefR:3,gdRefAng:4,gdRefPolar:5},s=5},1699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMeasureCTX=void 0;var i,a=n(676);t.getMeasureCTX=function(){if(!i){var e=(0,a.createElement)({type:"canvas",classname:"measure-canvas",style:{"data-type":"svg-blob",display:"none"},parent:document.body});i=e.getContext("2d")}return i}},1720:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(144),l=n.n(s),c=n(310),u=n(400),d=n(626),h=n(411),p=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a,o){o.enter(i);var r=e.hitCell(t,n,i,a,o);return o.exit(),r}},{key:"hitCell",value:function(e,t,n,i,a){var o=d.a.initWithOrigin({x:t.x-(n.cell2page_offset&&n.cell2page_offset.x||0),y:t.y-(n.cell2page_offset&&n.cell2page_offset.y||0)});if(n.is_diag_cell&&n.diagCell.pages.length&&this._hitDiagCell(e,o,n,i,a))return!0;if(!n.cell_page){for(var r=n.parent.prev;r&&r.isInTable;){var s=r.tablecells[n.index];if(s.cell_page){for(var l=d.a.initWithOrigin({x:t.x-(s.cell2page_offset&&s.cell2page_offset.x||0),y:t.y-(s.cell2page_offset&&s.cell2page_offset.y||0)}),c=s,u=[],h=a.node_chain.length;h>0;h--)a.exit(),u.unshift(c),c=c.parent||c.outer.host;return u.forEach((function(e){a.enter(e)})),B.hit(e,l,s.cell_page,i,a)}r=r.prev}return!1}return!!B.hit(e,o,n.cell_page,i,a)}},{key:"_hitDiagCell",value:function(e,t,n,i,a){if(n.is_diag_cell&&n.diagCell.pages.length){var o=[];n.diagCell.pages.forEach((function(e){var t={x:e.rect.left,y:e.rect.top};e.lines.forEach((function(e){(e.sublines&&e.sublines.length?e.sublines:[e]).forEach((function(e){o.push({line:e,rect:u.a.getRectByRectAndOffset(e.rect,t)})}))}))}));for(var r=Number.MAX_SAFE_INTEGER,s=-1,l=0;l<o.length;++l){var c=o[l].rect,d=u.a.distanceFromPointToRect(t,c);if(d<r&&(s=l,(r=d)<=0))break}if(-1==s)return!1;var p=o[s].line,f=p.parent.layoutType===h.DOCLayoutType.CellPage?p.parent:p.parent.parent;return!!B.hit(e,t,f,i,a)}}}]),e}(),f=n(723),g=n(947),v=n(2657),y=n(324),m=n(1591),_=n(1252),x=n(3684),w=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a,o,r){r.enter(i);var s=e.hitLine(t,n,i,a,o,r);return r.exit(),s}},{key:"getCoorPos2Worspace",value:function(e,t){for(var n=e.getCoorPos2Worspace(),i=n.x,a=n.y,o=t.parent;o&&!o.isChildShape;)o=o.parent;if(o){var r=o.rect2TopShape;i+=r.left,a+=r.top}return{x:i,y:a}}},{key:"hitLine",value:function(t,n,i,a,o,r){var s=null;o.innerPos={x:n.x,y:n.y};var u=e.getCoorPos2Worspace(r,i),h=u.x,p=u.y;if(o.coorPos2View={x:h,y:p},i.auto_num&&(d.a.add(r.position,i.position2parent,i.offset4child),s=i.glyphGroupInfos),i.tablecells){var w=d.a.initWithOrigin({x:n.x-i.position2parent.x,y:n.y-i.position2parent.y});return e.tablecellsHit(t,w,i.tablecells,o,r)}if(i.sublines)return e.sublinesHit(t,n,i.sublines,a,o,r);i.auto_num||(d.a.add(r.position,i.position2parent,i.offset4child),s=i.glyphGroupInfos);var k=e.getCoorPos2Worspace(r,i);if(o.isFuzzyHit=!1,o.glyphTail=!1,o.lineBreakHit=!1,!s||s.length<=0)return Object.assign(o,{glyphTail:!0,isLineLastChar:!0,halfOfRight:!0,position:0,charWidth:0,height:0,posX:0,posY:0,charPosY:0,charHeight:0,line:i}),!0;var b=n.x,T=-1,C=0,S=0,E=t.glyphpool.glyphBuff,P=function(e){var t=e.endOffset+i.range.pos-1;return!!f.a.isLineBreak(E.getCharCode(t))};if(0===(s=s.filter((function(e){return!(!e.isVisible()&&!e.oMath)||f.a.isControl(E.getCharCode(e.beginOffset+i.range.pos))})).sort((function(e,t){return e.x+e.widthSum/2-(t.x+t.widthSum/2)}))).length)try{var L=i.range.begin,A=t.typoinfo.getPosition(L).pos;return Object.assign(o,{glyphTail:!0,isLineLastChar:!0,halfOfRight:!0,position:A.position,charWidth:A.charWidth,height:A.height,posX:A.posX,posY:A.posY,charPosY:A.charPosY,charHeight:A.charHeight,line:A.line}),!0}catch(e){return!1}var I=!1;if(b<s[0].x){var R=s[0];R.isLayoutRTL?(P(R)?(o.lineBreakHit=!0,T=0):(o.glyphTail=!0,T=R.widths.length),S=R.x):I=!0}else{var O=s.length-1,M=s[O];if(b>=M.x+M.widthSum)M.isLayoutRTL?I=!0:P(M)?(o.lineBreakHit=!0,T=0,S=M.x):(T=M.widths.length,o.glyphTail=!0,S=M.x+M.widthSum),C=O;else{for(var D=0,N=s.length;D<N;){var B=D+N>>1,j=s[B],F=j.x;if(b<F)N=B;else{if(!(b>F+j.widthSum)){C=B;break}D=B+1}}var H=s[C];if(H.zone.type===m.b.TwoLinesInOne){var G=H.zone;if(G.secondLine){var U=(n.y<=G.getFirstLineBottom()?G.firstLine.glyphGroupInfos:G.secondLine.glyphGroupInfos).find((function(e){return e.x<=b&&b<=e.x+e.widthSum}));void 0!==U&&U!==H&&(C=s.findIndex((function(e){return e===U})))}}}}if(!o.lineBreakHit&&!o.glyphTail){var W=s[C],Y=W.widths,z=Y.length;if(W.oMath){var X=W.oMath.hit(b-W.x,n.y-(W.y+i.baseline-W.oMath.baseline));T=X.posOffset}else if(Object(x.a)(W)){var V=W.x,q=W.widthSum;b<V+q&&b>V+q/2?(T=1,S=V+q,o.glyphTail=!0):(T=0,S=V)}else if(W.isLayoutRTL){var K=W.x+W.widthSum;for(T=0;T<z;++T){var Q=Y[T];if(b>K-Q){b<=K-Q/2?(++T,o.glyphTail=!0,S=K-Q):S=K;break}K-=Q}}else if(W.zone.isEqZone){var J=Y[Y.length-1];b<W.x+J/2?(T=0,S=W.x):(T=Y.length,S=W.x+W.widthSum,o.glyphTail=!0)}else{var Z=W.x;for(T=0;T<z;++T){var $=Y[T];if(b<Z+$){b>Z+$/2?(++T,o.glyphTail=!0,S=Z+$):S=Z,b>=Z&&n.y>=W.y&&n.y<=W.y+i.baseline&&W.isTickCharBox()&&(o.isHitOnBox=!0,o.isTickCharSymbol=W.isTickCharSymbol());break}S=Z+=$}}}var ee=void 0,te=void 0,ne=void 0;if(I&&o.glyphTail){o.isLineLastChar=!0,o.position=i.range.pos+i.range.len,o.charWidth=0,o.height=i.rect.bottom-i.rect.top;var ie=s[C];ee=ie.isLayoutRTL?ie.x:ie.x+ie.widthSum,te=ie.y;var ae=ie.zone.getDrawBaseline&&ie.zone.getDrawBaseline(i.baseline,ie)||i.baseline,oe=ie.metrics,re=ie.y+ae-oe.ascent;ne=Math.max(te,re),o.charHeight=Math.max(0,Math.min(re+oe.height-ne,te+o.height-ne)),o.line=i,n.x>ie.x+ie.widthSum&&(o.isFuzzyHit=!0)}else{var se=s[C],le=void 0,ce=void 0,ue=void 0,de=function(){var e=se.beginOffset+T,n=s.findIndex((function(t){return t.beginOffset<=e&&e<t.beginOffset+t.widths.length}));-1!==n&&(C=n);var a=i.range.pos+e;if(ce=f.a.isControlBegin(E.getCharCode(a)),ue=f.a.isControlEnd(E.getCharCode(a-1)),o.glyphTail&&f.a.isEmbedDrawing(E.getCharCode(a-1))||!o.glyphTail&&f.a.isEmbedDrawing(E.getCharCode(a)))return"break";var r=void 0;if(ce||ue||f.a.isLineBreak(E.getCharCode(a))&&(se.isLayoutRTL?(r=s[C+1])&&r.isLayoutRTL&&(ue=f.a.isControlEnd(E.getCharCode(r.beginOffset+i.range.pos))):(r=s[C-1])&&!r.isLayoutRTL&&(ue=f.a.isControlEnd(E.getCharCode(r.beginOffset+i.range.pos)))),ce){var c=t.doc.contentControls.collect(a,1).sort((function(e,t){return e.len-t.len})),u=l()(c,1)[0];if(u&&u.isDate)return"break";if(se.oMath)return"break";var d=se.isLayoutRTL?C-1:C+1;if(!(le=s[d]))return"break";T=se.isLayoutRTL===le.isLayoutRTL?0:le.widths.length,S=(se=le).isLayoutRTL?0==T?se.x+se.widthSum:se.x:0==T?se.x:se.x+se.widthSum,C=d}else if(ue){var h=t.doc.contentControls.collect(a-1,1).sort((function(e,t){return e.len-t.len})),p=l()(h,1)[0];if(p&&p.isDate)return"break";var g=se.isLayoutRTL?C+1:C-1;if(!(le=s[g]))return"break";T=se.isLayoutRTL?se.isLayoutRTL===le.isLayoutRTL?le.widths.length:0:le.widths.length-1,S=se.isLayoutRTL?se.x:le.x+le.widthSum,se=le,C=g}};do{if("break"===de())break}while(ce||ue);o.isLineLastChar=!1,o.glyphGroupInfo=se,o.position=se.beginOffset+i.range.pos+T,se.isCombine&&o.glyphTail&&(o.position+=se.endOffset-se.beginOffset-1),o.charWidth=se.widths[T],o.height=i.rect.bottom-i.rect.top,o.drawHeight=se.zone.getLineDrawHeight&&se.zone.getLineDrawHeight(se),ee=S,te=se.y;var he=se.zone.getDrawBaseline&&se.zone.getDrawBaseline(i.baseline,se)||i.baseline,pe=se.metrics,fe=se.y+he-pe.ascent;for(ne=Math.max(te,fe),o.charHeight=Math.max(0,Math.min(fe+pe.height-ne,te+o.height-ne)),o.line=i,0===T&&f.a.isLineBreak(E.getCharCode(o.position))&&(o.lineBreakHit=!0);E.getCharCode(o.position)===y.o;)++o.position;var ge=o.lineBreakHit?8:0;if(n.x<se.x-ge?0==C&&0==T&&(o.isFuzzyHit=!0):n.x>se.x+se.widthSum+ge&&(o.isFuzzyHit=!0),o.isFuzzyHit||o.isFuzzyHitOnLine||!se.isField()||t.doc.fields.rangeClass.forEachHintInRange(se.beginOffset+i.range.pos,se.beginOffset+i.range.pos,(function(e){if("HYPERLINK"===e._node.type)return o.type=g.a.HYPERLINK,o.hyperLink=new v.a(t,e._node),!0}),c.IT.strictIntersectTest),se.oMath){var ve=se.oMath.locate(T);ee=se.x+ve.x,te=se.y+i.baseline-se.oMath.baseline+ve.y-(ve.charHeight-ve.height)/2,ve.data&&ve.data.shape&&(o.shapeForMath=ve.data.shape,o.offsetOfGlyphGroupInfo=T),o.charHeight=ve.charHeight,o.drawHeight=o.charHeight,ne=te}}o.line=i;var ye=r.getCurrentCoor().node,me=ye.textflow;if("T2B"===me.corX){if(me.isReverseLine){var _e=ye.rect.width-i.rect.top-i.rect.height;te=te-i.rect.top+_e,ne=ne-i.rect.top+_e}o.posX=k.x+ye.rect.width-te,o.posY=k.y+ee,o.charPosY=o.posY,o.charPosX=k.x+ye.rect.width-ne-o.charHeight,o.isTranspose=!0}else"B2T"===me.corX?(o.posX=k.x+te,o.posY=k.y+ye.rect.height-ee,o.charPosY=o.posY,o.charPosX=k.x+ne,o.isTranspose=!0):(o.posX=k.x+ee,o.posY=k.y+te,o.charPosY=k.y+ne,o.charPosX=o.posX);if(ye.parent.layoutType===_.c.ShapeScene){var xe=ye.parent.getTextBoxRect(),we=k.x-ye.rect.left+xe.left,ke=k.y-ye.rect.top+xe.top;o.clipRect={left:we,top:ke,width:xe.width,height:xe.height}}else if(ye.layoutType===_.c.CellPage&&ye.parent.diagCell){var be=k.x-ye.rect.left,Te=k.y-ye.rect.top,Ce=ye.parent.rect,Se=Ce.width,Ee=Ce.height;o.clipRect={left:be,top:Te,width:Se,height:Ee}}return o.posX=Math.round(o.posX),o.posY=Math.round(o.posY),o.charPosY=Math.round(o.charPosY),o.charPosX=Math.round(o.charPosX),!0}},{key:"sublinesHit",value:function(t,n,i,a,o,r){for(var s=Number.MAX_SAFE_INTEGER,l=-1,c=0;c<i.length;++c){var d=i[c].rect,h=u.a.distanceFromPointToRect(n,d);if(h<s&&(s=h,l=c,0===h))break}if(-1==l)return!1;var p=i[l];return!!e.hitLine(t,n,p,a,o,r)}},{key:"tablecellsHit",value:function(e,t,n,i,a){for(var o=Number.MAX_SAFE_INTEGER,r=-1,s=0;s<n.length;++s){var l=n[s],c=l.rect,h=u.a.distanceFromPointToRect(t,c);if(h<o&&(l.cell_page&&l.cell_page.lines.length||l.is_diag_cell&&l.diagCell.pages.length)&&(o=h,r=s,0===h))break}if(-1==r)return!1;var f=n[r],g=d.a.initWithOrigin({x:t.x-f.position2parent.x,y:t.y-f.position2parent.y});return!!p.hit(e,g,f,i,a)&&(i.tablecellIdx=r,!0)}},{key:"hitOnShape",value:function(e,t,n,i){if(n.glyphGroupInfo=i,window.APP.isMobileMode()){var a=!!i.shape;return a?{isHitOnShape:a,mobilePage:t.viewPage,shape:i.shape,line:t}:{isHitOnShape:a}}}}]),e}(),k=n(1733),b=n(1032),T=n(2011),C=n(772),S=n(22),E=n.n(S),P=n(23),L=n.n(P),A=n(1319),I=n(3077),R=0,O=1,M=function(e){function t(e,n,i){a()(this,t);var o=E()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{parent:e,viewPage:e.viewPage,coorSystem:null})),r=e.heightAt(n);return o.range=new I.a(i.pos,i.pos+i.len,o),o.pendingNode=new A.e,o.pendingNode.line=o,o.rect=u.a.initByRawRect({top:r,left:0,right:e.rect.width,bottom:r+1}),o}return L()(t,e),r()(t,[{key:"moveTo",value:function(e){var t=e-this.rect.top,n=this.rect.height;this.rect.top+=t,this.rect.bottom=this.rect.top+n}},{key:"toString",value:function(){return""+this.range}},{key:"layoutType",get:function(){return h.DOCLayoutType.Pending}},{key:"yForView",get:function(){return this.viewOffset.y}},{key:"pendingType",get:function(){return R}}]),t}(h.DOCLayout),D=(function(e){function t(e,n){a()(this,t);var i=E()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{parent:e.page,viewPage:e,coorSystem:null}));return i.detail=n,i.pendingNode=new A.e,i.pendingNode.line=i,i}L()(t,e),r()(t,[{key:"mobilePage",get:function(){return this.viewPage}},{key:"layoutType",get:function(){return h.DOCLayoutType.Pending}},{key:"yForView",get:function(){return this.viewPage.offsetTopOfComments}},{key:"pendingType",get:function(){return O}}])}(h.DOCLayout),n(3283)),N=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a,o){o.enter(i);var r=e.hitPage(t,n,i,a,o);return o.exit(),r}},{key:"hitPage",value:function(e,t,n,i,a){var o={x:t.x-n.position2parent.x,y:t.y-n.position2parent.y},r=n.textflow;if("T2B"===r.corX){var s=o.y,l=n.rect.width-o.x;o.x=s,o.y=l,r.isReverseLine&&(o.y=n.rect.width-o.y)}else if("B2T"===r.corX){var c=n.rect.height-o.y,d=o.x;o.x=c,o.y=d}for(var h=n.lines,p=Number.MAX_SAFE_INTEGER,f=-1,g=void 0,v=0;v<h.length;++v){var y=h[v];if(!(y instanceof M||y.isSnippetLine)&&!(0===y.rect.height&&h.length>1||n instanceof b.a&&Object(D.f)(v,n,e.glyphpool,!0))){var m=y.renderRect||y.rect,_=u.a.verticalDistanceFromPointToRect(o,m);if(y.isRepeatHeaderRow){g=_;continue}_<p&&(p=_,f=v)}}if(-1===f)return!1;i.isFuzzyHitOnLine=0!==p,void 0!==g&&g<p&&(i.isInRepeatHeaderRow=!0);var x=h[f];if(x instanceof T.a&&x.hasMergedCell){for(var S=Number.MAX_SAFE_INTEGER,E=-1,P={x:o.x-x.position2parent.x,y:o.y-x.position2parent.y},L=0;L<x.tablecells.length;++L){var A=x.tablecells[L].rect,I=u.a.distanceFromPointToRect(P,A);if(I<S&&(S=I,E=L,0===I))break}var R=x.tablecells[E];if(-1!==E&&(R.merge_type===C.e.MIDDLE||R.merge_type===C.e.LAST)){var O=Object(k.findFirstMergeLine)(R.rect.left,f,h);null!==O&&(x=O)}}var N=w.hit(e,o,x,{},i,a);return i.layoutPos=t,!!N&&(i.isFuzzyHit=0!=p||i.isFuzzyHit,!0)}}]),e}(),B=t.a=N},1742:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMOJI_REGEX=void 0;t.EMOJI_REGEX="🏴󠁧󠁢(?:󠁷󠁬󠁳|󠁳󠁣󠁴|󠁥󠁮󠁧)󠁿|(?:🧑🏿‍❤️‍(?:💋‍)?🧑|👩🏿‍🤝‍(?:\ud83d[\udc68\udc69]))(?:\ud83c[\udffb-\udffe])|(?:🧑🏾‍❤️‍(?:💋‍)?🧑|👩🏾‍🤝‍(?:\ud83d[\udc68\udc69]))(?:\ud83c[\udffb-\udffd\udfff])|(?:🧑🏽‍❤️‍(?:💋‍)?🧑|👩🏽‍🤝‍(?:\ud83d[\udc68\udc69]))(?:\ud83c[\udffb\udffc\udffe\udfff])|(?:🧑🏼‍❤️‍(?:💋‍)?🧑|👩🏼‍🤝‍(?:\ud83d[\udc68\udc69]))(?:\ud83c[\udffb\udffd-\udfff])|(?:🧑🏻‍❤️‍(?:💋‍)?🧑|👩🏻‍🤝‍(?:\ud83d[\udc68\udc69]))(?:\ud83c[\udffc-\udfff])|👨(?:🏻(?:‍(?:❤️‍(?:💋‍👨(?:\ud83c[\udffb-\udfff])|👨(?:\ud83c[\udffb-\udfff]))|🤝‍👨(?:\ud83c[\udffc-\udfff])|[⚕⚖✈]️|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd]))?|(?:\ud83c[\udffc-\udfff])‍❤️‍(?:💋‍👨(?:\ud83c[\udffb-\udfff])|👨(?:\ud83c[\udffb-\udfff]))|‍(?:❤️‍(?:💋‍)?👨|(?:\ud83d[\udc68\udc69])‍(?:👦‍👦|👧‍(?:\ud83d[\udc66\udc67]))|👦‍👦|👧‍(?:\ud83d[\udc66\udc67])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏿‍(?:🤝‍👨(?:\ud83c[\udffb-\udffe])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏾‍(?:🤝‍👨(?:\ud83c[\udffb-\udffd\udfff])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏽‍(?:🤝‍👨(?:\ud83c[\udffb\udffc\udffe\udfff])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏼‍(?:🤝‍👨(?:\ud83c[\udffb\udffd-\udfff])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:🏿‍[⚕⚖✈]|🏾‍[⚕⚖✈]|🏽‍[⚕⚖✈]|🏼‍[⚕⚖✈]|‍[⚕⚖✈])️|‍(?:(?:\ud83d[\udc68\udc69])‍(?:\ud83d[\udc66\udc67])|\ud83d[\udc66\udc67])|🏿|🏾|🏽|🏼)?|(?:👩(?:🏻‍❤️‍(?:💋‍(?:\ud83d[\udc68\udc69])|\ud83d[\udc68\udc69])|(?:\ud83c[\udffc-\udfff])‍❤️‍(?:💋‍(?:\ud83d[\udc68\udc69])|\ud83d[\udc68\udc69]))|🧑(?:\ud83c[\udffb-\udfff])‍🤝‍🧑)(?:\ud83c[\udffb-\udfff])|👩‍👩‍(?:👦‍👦|👧‍(?:\ud83d[\udc66\udc67]))|👩(?:‍(?:❤️‍(?:💋‍(?:\ud83d[\udc68\udc69])|\ud83d[\udc68\udc69])|\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏿‍(?:\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏾‍(?:\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏽‍(?:\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏼‍(?:\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏻‍(?:\ud83c[\udf3e\udf73\udf7c\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd]))|🧑(?:‍(?:🤝‍🧑|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏿‍(?:\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏾‍(?:\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏽‍(?:\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏼‍(?:\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|🏻‍(?:\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd]))|👩‍👦‍👦|👩‍👩‍(?:\ud83d[\udc66\udc67])|👩‍👧‍(?:\ud83d[\udc66\udc67])|(?:👁️‍🗨|🧑(?:🏿‍[⚕⚖✈]|🏾‍[⚕⚖✈]|🏽‍[⚕⚖✈]|🏼‍[⚕⚖✈]|🏻‍[⚕⚖✈]|‍[⚕⚖✈])|👩(?:🏿‍[⚕⚖✈]|🏾‍[⚕⚖✈]|🏽‍[⚕⚖✈]|🏼‍[⚕⚖✈]|🏻‍[⚕⚖✈]|‍[⚕⚖✈])|😶‍🌫|🏳️‍⚧|🐻‍❄|(?:(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])|👯|\ud83e[\udd3c\uddde\udddf])‍[♀♂]|(?:⛹|\ud83c[\udfcb\udfcc]|🕵)(?:️|\ud83c[\udffb-\udfff])‍[♀♂]|🏴‍☠|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])‍[♀♂]|[©®‼⁉™ℹ↔-↙↩↪⌨⏏⏭-⏯⏱⏲⏸-⏺Ⓜ▪▫▶◀◻◼☀-☄☎☑☘☠☢☣☦☪☮☯☸-☺♀♂♟♠♣♥♦♨♻♾⚒⚔-⚗⚙⚛⚜⚠⚧⚰⚱⛈⛏⛑⛓⛩⛰⛱⛴⛷⛸✂✈✉✏✒✔✖✝✡✳✴❄❇❣➡⤴⤵⬅-⬇〰〽㊗㊙]|\ud83c[\udd70\udd71\udd7e\udd7f\ude02\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff5\udff7]|\ud83d[\udc3f\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3])️|🏳️‍🌈|👩‍👧|👩‍👦|😵‍💫|😮‍💨|🐕‍🦺|🧑(?:🏿|🏾|🏽|🏼|🏻)?|👩(?:🏿|🏾|🏽|🏼|🏻)?|🇽🇰|🇶🇦|🇴🇲|🐈‍⬛|❤️‍(?:🔥|🩹)|👁️|🏳️|🇿(?:\ud83c[\udde6\uddf2\uddfc])|🇾(?:\ud83c[\uddea\uddf9])|🇼(?:\ud83c[\uddeb\uddf8])|🇻(?:\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa])|🇺(?:\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff])|🇹(?:\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff])|🇸(?:\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff])|🇷(?:\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc])|🇵(?:\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe])|🇳(?:\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff])|🇲(?:\ud83c[\udde6\udde8-\udded\uddf0-\uddff])|🇱(?:\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe])|🇰(?:\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff])|🇯(?:\ud83c[\uddea\uddf2\uddf4\uddf5])|🇮(?:\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9])|🇭(?:\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa])|🇬(?:\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe])|🇫(?:\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7])|🇪(?:\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa])|🇩(?:\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff])|🇨(?:\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff])|🇧(?:\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff])|🇦(?:\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff])|[#*0-9]️⃣|❤️|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])|(?:⛹|\ud83c[\udfcb\udfcc]|🕵)(?:️|\ud83c[\udffb-\udfff])|🏴|(?:[✊✋]|\ud83c[\udf85\udfc2\udfc7]|\ud83d[\udc42\udc43\udc46-\udc50\udc66\udc67\udc6b-\udc6d\udc72\udc74-\udc76\udc78\udc7c\udc83\udc85\udc8f\udc91\udcaa\udd7a\udd95\udd96\ude4c\ude4f\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd30-\udd34\udd36\udd77\uddb5\uddb6\uddbb\uddd2\uddd3\uddd5])(?:\ud83c[\udffb-\udfff])|(?:[☝✌✍]|\ud83d[\udd74\udd90])(?:️|\ud83c[\udffb-\udfff])|[✊✋]|\ud83c[\udf85\udfc2\udfc7]|\ud83d[\udc08\udc15\udc3b\udc42\udc43\udc46-\udc50\udc66\udc67\udc6b-\udc6d\udc72\udc74-\udc76\udc78\udc7c\udc83\udc85\udc8f\udc91\udcaa\udd7a\udd95\udd96\ude2e\ude35\ude36\ude4c\ude4f\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd30-\udd34\udd36\udd77\uddb5\uddb6\uddbb\uddd2\uddd3\uddd5]|\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd]|👯|\ud83e[\udd3c\uddde\udddf]|[⌚⌛⏩-⏬⏰⏳◽◾☔☕♈-♓♿⚓⚡⚪⚫⚽⚾⛄⛅⛎⛔⛪⛲⛳⛵⛺⛽✅✨❌❎❓-❕❗➕-➗➰➿⬛⬜⭐⭕]|\ud83c[\udc04\udccf\udd8e\udd91-\udd9a\ude01\ude1a\ude2f\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff8-\udfff]|\ud83d[\udc00-\udc07\udc09-\udc14\udc16-\udc3a\udc3c-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude2d\ude2f-\ude34\ude37-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udeeb\udeec\udef4-\udefc\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3f-\udd45\udd47-\udd76\udd78\udd7a-\uddb4\uddb7\uddba\uddbc-\uddcb\uddd0\udde0-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6]|(?:[©®‼⁉™ℹ↔-↙↩↪⌚⌛⌨⏏⏩-⏳⏸-⏺Ⓜ▪▫▶◀◻-◾☀-☄☎☑☔☕☘☝☠☢☣☦☪☮☯☸-☺♀♂♈-♓♟♠♣♥♦♨♻♾♿⚒-⚗⚙⚛⚜⚠⚡⚧⚪⚫⚰⚱⚽⚾⛄⛅⛈⛎⛏⛑⛓⛔⛩⛪⛰-⛵⛷-⛺⛽✂✅✈-✍✏✒✔✖✝✡✨✳✴❄❇❌❎❓-❕❗❣❤➕-➗➡➰➿⤴⤵⬅-⬇⬛⬜⭐⭕〰〽㊗㊙]|\ud83c[\udc04\udccf\udd70\udd71\udd7e\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude02\ude1a\ude2f\ude32-\ude3a\ude50\ude51\udf00-\udf21\udf24-\udf93\udf96\udf97\udf99-\udf9b\udf9e-\udff0\udff3-\udff5\udff7-\udfff]|\ud83d[\udc00-\udcfd\udcff-\udd3d\udd49-\udd4e\udd50-\udd67\udd6f\udd70\udd73-\udd7a\udd87\udd8a-\udd8d\udd90\udd95\udd96\udda4\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa-\ude4f\ude80-\udec5\udecb-\uded2\uded5-\uded7\udee0-\udee5\udee9\udeeb\udeec\udef0\udef3-\udefc\udfe0-\udfeb]|\ud83e[\udd0c-\udd3a\udd3c-\udd45\udd47-\udd78\udd7a-\uddcb\uddcd-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6])️?"},1873:function(e,t){var n=Array.isArray;e.exports=n},1980:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){var t=e.extData&&e.extData.isLatexMath,n=e.isOle&&e.controlObj&&e.controlObj.progId&&e.controlObj.progId.match(/Visio.Drawing/);return!(75!==e.shapeType||e.group||e.hasArtWord||e.isOle&&!n||t)}},2020:function(e,t,n){"use strict";n.r(t),n.d(t,"LAYOUT",(function(){return i}));var i={PLUGIN_ADD_CONTAINER:"PLUGIN_ADD_CONTAINER",PLUGIN_SET_CONTAINER_POSITION:"PLUGIN_SET_CONTAINER_POSITION",PLUGIN_HIDE_CONTAINER:"PLUGIN_HIDE_CONTAINER",PLUGIN_SHOW_CONTAINER:"PLUGIN_SHOW_CONTAINER",PLUGIN_CHANGE_CONTAINER_TYPE:"PLUGIN_CHANGE_CONTAINER_TYPE",PLUGIN_RENDER:"PLUGIN_RENDER",PLUGIN_FINISH_RENDER:"PLUGIN_FINISH_RENDER"}},2139:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=function(){function e(t,n){a()(this,e),this.app=t,this.workspace=t.workspace,this.data=t.data,this.selection=t.data.selection,this.uilManager=n,this.initState()}return r()(e,[{key:"initState",value:function(){this.state=Object.assign({},this.initialState)}},{key:"resetState",value:function(){this.state=this.initialState}},{key:"initialState",get:function(){return{}}}]),e}();t.a=s},2143:function(e,t,n){var i=n(1312)(Object,"create");e.exports=i},2144:function(e,t,n){var i=n(5313),a=n(5314),o=n(5315),r=n(5316),s=n(5317);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=r,l.prototype.set=s,e.exports=l},2145:function(e,t,n){var i=n(3688);e.exports=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},2146:function(e,t,n){var i=n(5319);e.exports=function(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},2309:function(e,t,n){"use strict";n.r(t),n.d(t,"getCanRename",(function(){return c})),n.d(t,"setCanRename",(function(){return u})),n.d(t,"textToFilename",(function(){return h})),n.d(t,"fileAutoRename",(function(){return p}));var i=n(1742),a=n(332),o=/[\\\/\?\*<":>|]/g,r=new RegExp(i.EMOJI_REGEX,"g"),s=void 0,l=!1;function c(){return void 0===s&&(s=window.__CONFIG__.isEnableAutoRename&&window.__WPSENV__.store.getState().public.file.user_acl.rename&&d()),s}function u(e){s=e}var d=function(){var e=window.__WPSENV__.store.getState().public.file,t=e.name,n=!1;switch(e.office_type){case"s":case"k":n=/^\u5de5\u4f5c\u7c3f(\(\d+\))?$/.test(t);break;case"p":n=/^\u6f14\u793a\u6587\u7a3f(\(\d+\))?$/.test(t);break;case"w":n=/^\u6587\u5b57\u6587\u7a3f(\(\d+\))?$/.test(t)}return n},h=function(e){var t=e.trim().replace(r,"_").replace(o,"_");return t.length>235&&(t=t.slice(0,235)),t},p=function(e,t,n){if(l)return!1;if(!c())return!1;var i=window.__WPSENV__.store.getState().public.file.ext,o=h(e)+i;l=!0,window.__WPSENV__.reduxDispatch(Object(a.changeFilename)(window.urlFileId,o,!1)).then((function(e){l=!1,["fileNameConflict","AuditFailed","Unavailable","fileNameEmpty"].includes(e.result)||u(!1),t&&t(e)})).catch((function(e){l=!1,n&&n(e)}))}},2474:function(e,t,n){"use strict";n.r(t),n.d(t,"ExistingFileOrPage",(function(){return i})),n.d(t,"PlaceInDoc",(function(){return a})),n.d(t,"EmailAddress",(function(){return o}));var i=0,a=1,o=2},248:function(e,t,n){"use strict";n.r(t);var i=n(144),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(23),h=n.n(d),p=(n(724),n(238)),f=n.n(p),g=n(250),v=n.n(g),y=n(284),m=n.n(y),_=n(227),x={},w=function(e){function t(e){r()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkOnline=function(){if(window.__WPSENV__.store){var e=window.__WPSENV__.store.getState().public.network.connected;n.setState({onLine:e})}},n.handleOnline=n.handleOnline.bind(n),n.state={onLine:window.navigator.onLine},n}return h()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.state.onLine||(this.checkOnline(),window.addEventListener("online",this.handleOnline),window.addEventListener(_.default.names.network.ON_CONNECTED,this.handleOnline))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("online",this.handleOnline),window.removeEventListener(_.default.names.network.ON_CONNECTED,this.handleOnline)}},{key:"handleOnline",value:function(){this.setState({onLine:!0})}},{key:"getTypeName",value:function(e,t,n){var i=this.state.onLine,a="icons-"+t+"-"+n;return window.__WPSENV__.isHybrid?a:e||i||x[a]?(x[a]=!0,a):""}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.className,i=e.title,o=e.role,r=e.onClick,s=e.altScPosition;if(!t)return f.a.createElement("i",{className:"icons "+n});var l=t.split(" "),c=a()(l,3),u=c[0],d=c[1],h=c[2],p="icons icons-"+u;"loading"===(d=d||"")?p+=" icons-loading":p+=" "+this.getTypeName(h,u,d.toLowerCase());return n&&(p+=" "+n),f.a.createElement(v.a,{title:i},f.a.createElement("i",{className:p,onClick:r,role:o,"alt-sc-position":s}))}}]),t}(p.PureComponent);w.types=m.a,t.default=w},2495:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(1720),l=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a,o){o.enter(i);var r=e.hitMobilePage(t,n,i,a,o);return o.exit(),r}},{key:"hitMobilePage",value:function(e,t,n,i,a){return!!s.a.hit(e,t,n.page,i,a)&&(i.pageIdx=0,!0)}}]),e}(),c=n(309),u=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a){a.enter(i);var o=e.hitView(t,n,i,a);return a.exit(),o}},{key:"hitView",value:function(e,t,n,i){var a={},o=!1;t.y-=n.viewOffset.y,t.y<n.verticalPadding&&(window.APP.isWebMode()&&t.y>0&&(o=!0),t.y=n.verticalPadding);var r=n.hitViewPage(t.y);if(r){t.x-=n.viewOffset.x;var s=r.page;return t.x-=s.rect.left-s._drawingOffset.x,t.y-=s.rect.top,!!l.hit(e,t,s,a,i)&&(a.layoutIndex=s.layout_index,a.subDocType=c.MainText,a.pos=t,o&&(a.hitFileName=!0),a)}}}]),e}(),d=n(4419),h=n(400),p=n(3862),f=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(e,t,n,i,a){for(var o=Number.MAX_SAFE_INTEGER,r=-1,s=0,l=0;l<e.typoinfo.pageCount;++l){var c=e.typoinfo.getLayoutPageCache(l);if(!c)return!1;var u=c.outer_rect,f=h.a.distanceFromPointToRect(t,u);if(f<o?(o=f,r=l,s=0):++s,3==s)break}if(-1==r)return!1;var g=n[r],v=g;if(e.selection.selContext.isInHeaderFooter&&(v=g.decorativePage),g instanceof p.a)return e.typoinfo.queryRangeForPage(g.layout_index,g.layout_index),!1;var y=d.a.hit(e,t,v,i,a);return y&&(i.layoutIndex=r,i.isFuzzyHit=0!=o||i.isFuzzyHit),y}}]),e}(),g=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(e,t,n,i,a){a.enter(n);var o=s.a.hit(e,t,n.page,i,a);return a.exit(),o}}]),e}(),v=n(1170),y=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hitView",value:function(e,t,n,i){var a={},o=n.getCommentPage(i.commentId),r={x:t.x-n.horizontalPadding,y:t.y-n.verticalPadding};return!(Object(v.isInTempComment)()||!o)&&(!!g.hit(e,r,o,a,i)&&(a.pos=t,a.isInComment=!0,a.subDocType=c.Comment,a))}},{key:"hit",value:function(t,n,i,a){var o=i.getCommentView(a.commentId);a.enter(o);var r=e.hitView(t,n,o,a);return a.exit(),r}}]),e}(),m=n(1915),_=n(3079),x=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(e,t,n,i){var a=new m.a({mode:_.b,logColor:{color1:"red",color2:"blue"}});if(i&&Object.assign(a,i),e.selection.selContext.isInComment())return y.hit(e,t,n,a);if(window.APP.isPCMode()||window.APP.isPaginationMode()){var o={};return f.hit(e,t,n.layout_pages,o,a)&&o}return u.hit(e,t,n,a)}}]),e}();t.a=x},250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementType=void 0;var i=n(5),a=i.__importStar(n(238)),o=i.__importDefault(n(244)),r=i.__importStar(n(167)),s=i.__importDefault(n(604)),l=i.__importDefault(n(398)),c=n(426);Object.defineProperty(t,"PlacementType",{enumerable:!0,get:function(){return c.PlacementType}});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currDom=null,t.position=null,t.handleClose=function(){void 0===t.props.visible&&t.close()},t.handleMouseEnter=function(e){var n=t.props,i=n.title;void 0===n.visible&&i&&!t.position&&t.show(e)},t.handleMouseLeave=function(e){var n=t.props,i=n.title;void 0===n.visible&&i&&t.position&&t.close()},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.currDom=o.default.findDOMNode(this),this.bindEvents()},t.prototype.componentDidUpdate=function(e){if(e!==this.props){var t=o.default.findDOMNode(this);t!==this.currDom&&(this.unbindEvents(),this.currDom=t,this.bindEvents())}var n=this.props,i=n.title,a=n.visible;void 0!==a&&void 0!==e.visible?a?this.show(null):this.close():e.title!==i&&this.position&&(i?this.update():this.close())},t.prototype.componentWillUnmount=function(){this.position&&this.close(),this.unbindEvents()},t.prototype.bindEvents=function(){r.isPad||(this.currDom.addEventListener("mouseenter",this.handleMouseEnter),this.currDom.addEventListener("mouseleave",this.handleMouseLeave))},t.prototype.unbindEvents=function(){this.currDom.removeEventListener("mouseenter",this.handleMouseEnter),this.currDom.removeEventListener("mouseleave",this.handleMouseLeave)},t.prototype.show=function(e){void 0!==this.props.visible&&(e={pageX:0,pageY:0,currentTarget:o.default.findDOMNode(this)});var t=e.currentTarget;void 0===this.props.isMustShowTitle?l.default.isMustShowTitle(t,this.props.title)&&(this.position={x:e.pageX,y:e.pageY},this.update()):this.props.isMustShowTitle&&(this.position={x:e.pageX,y:e.pageY},this.update())},t.prototype.close=function(){this.position=null,this.update()},t.prototype.update=function(){var e=this.props,t=e.title,n=e.visible,i=e.middleShow,a=e.verticalMiddleShow,o=e.placement,r={title:this.position?t:null,element:this.position?this.currDom:null,position:this.position,middleShow:void 0!==n||i,verticalMiddleShow:a,onClose:this.handleClose,placement:o};h(r)},t.prototype.handleEventFromChildrenOrRoot=function(e,t,n){return function(){for(var i,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e?e.apply(void 0,o):a.default.isValidElement(n)&&n.props[t]&&(i=n.props)[t].apply(i,o)}},t.prototype.render=function(){var e=this.props.children;(0,a.isValidElement)(e)||(e=a.default.createElement("span",null,e));var t={onClick:this.handleEventFromChildrenOrRoot(this.props.onClick,"onClick",e),onMouseEnter:this.handleEventFromChildrenOrRoot(this.props.onMouseEnter,"onMouseEnter",e),onMouseLeave:this.handleEventFromChildrenOrRoot(this.props.onMouseLeave,"onMouseLeave",e)};return a.default.cloneElement(e,t)},t.defaultProps={placement:c.PlacementType.topBottom},t}(a.PureComponent);t.default=u;var d=null,h=function(e){var t;d||((t=document.createElement("div")).className="wowui-tooltip",document.body.appendChild(t),d=t),o.default.render(a.default.createElement(s.default,i.__assign({},e)),d)}},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(691),l=n(1290),c=n(2474),u=n(309),d=n(2701),h=n(1090),p=n(324),f=[u.Comment,u.MainText],g=[u.Comment,u.MainText,u.HeaderFooter,u.Textbox,u.TextboxInHF],v=["http://","https://","mailto:","ftp://"],y=function(){function e(t,n,i){a()(this,e),this.data=t,this.field=n,Object(h.getAllUrlsInfo)([this.getAddress()]),this.curPos=i||-1}return r()(e,[{key:"isEmailAddress",value:function(e){return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)}},{key:"isKWProtocolAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:(mention|link|filelink)\S+/.test(e)}},{key:"isMentionAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:mention\S+/.test(e)}},{key:"isFileLinkAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAddress();return/^kw:filelink\S+/.test(e)}},{key:"isLegalURL",value:function(e){if(!e)return!1;var t=e.toLowerCase();return v.some((function(e){return 0===t.indexOf(e)&&t.length>e.length}))}},{key:"isEmbHyperLink",value:function(){for(var e=this.data.doc.getText(this.field.begin,this.field.len),t=0,n=0;n<e.length;n++){if(t>1)return!0;e.charCodeAt(n)==p.n&&(t+=1)}return!1}},{key:"getEmbHyperLink",value:function(e,t,n){for(var i=n,a={rg:[],code:""},o=0,r=i;r<t.length;){if(t.charCodeAt(r)===p.n&&(i=r,o>0&&(a.rg.push({begin:o+1,end:i}),o=(r=this.getEmbHyperLink(e,t,i))-1)),t.charCodeAt(r)===p.p&&(o=r,a.code=t.slice(i+1,o)),t.charCodeAt(r)===p.o)return a.rg.push({begin:o+1,end:r}),e.push(a),r+1;r++}}},{key:"getHyperLinkCode",value:function(e){if(!this.isEmbHyperLink()){var t=this.field.begin+1,n=this.field.sepDistance-2;return this.data.doc.getText(t,n)}var i=this.data.doc.getText(this.field.begin,this.field.len),a=[];this.getEmbHyperLink(a,i,0),this.curPos<0&&(this.curPos=this.data.selection.begin.position),void 0!==e&&(this.curPos=e);for(var o=this.curPos-this.field.begin,r=0;r<a.length;r++)for(var s=a[r],l=0;l<s.rg.length;l++){var c=s.rg[l];if(c.begin<=o&&c.end>o)return s.code}return a[a.length-1].code}},{key:"getAddress",value:function(e){var t=this.getHyperLinkCode(e),n=new d.a;return n.parse(t),0!==n.params.length?n.params[0].url:null}},{key:"getKWProtocolParams",value:function(){var e={},t=this.getAddress();if(this.isKWProtocolAddress(t)){var n=t.indexOf("?");-1!==n&&(e=Object(l.toParams)(t.slice(n+1))),e.extraAttrs&&(e.extraAttrs=decodeURIComponent(window.atob(e.extraAttrs)))}return e}},{key:"getPositionExist",value:function(){var e=this.field.begin+1,t=this.field.sepDistance-2,n=this.data.doc.getText(e,t),i=Object(l.parseFieldCode)(n);if(!i.switchs.l)return!1;var a=i.switchs.l,o=this.data.doc.bookmarks.map[a];if("_top"===a||o){var r=o.pos,s=this.data.doc.getSubDocType(r);return!!(window.APP.isPaginationMode()&&g.indexOf(s)>=0||window.APP.isMobileMode()&&f.indexOf(s)>=0)}return!1}},{key:"getType",value:function(){var e=this.field.begin+1,t=this.field.sepDistance-2,n=this.data.doc.getText(e,t),i=Object(l.parseFieldCode)(n);return 0!==i.params.length?0===i.params[0].indexOf("mailto:")?c.EmailAddress:c.ExistingFileOrPage:i.switchs.l?c.PlaceInDoc:c.ExistingFileOrPage}},{key:"getDisplayText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=void 0,n=void 0,i=this.data.selection.selAreas.activeArea.getNormalRanges(),a=i[0];if(a.pos>i[i.length-1].pos?(t=i[i.length-1].pos,n=i[0].pos+i[0].len):(t=i[0].pos,n=i[i.length-1].pos+i[i.length-1].len),t<this.field.begin&&n>=this.field.end)return this.data.selection.selInfo.getDisplayText(e);var o=this.getResult();if(o)for(var r=0;r<o.length;++r){var l=o.charCodeAt(r);if(Object(s.isSpecialPlaceholder)(l)||Object(s.isFieldPlaceholder)(l))return e&&(e.hasSpecialHolder=!0),_i18n("applications.writer.components.core.shell.model.doc.hyperLink.chose", "<<Selected content in document>>")}return o}},{key:"getResult",value:function(){var e=this.field.sep+1,t=this.field.end;if(t>e)return this.data.doc.getText(e,t-e-1)}}]),e}()},284:function(e,t){e.exports={size16:{ai_logo:"16 ai_logo",back_normal:"16 back_normal 1",network_normal:"16 network_normal 1",network_slow:"16 network_slow 1",network_offline:"16 network_offline 1",topbar_more:"16 topbar_more 1",minus:"16 minus 1",add:"16 add 1",full_screen:"16 full_screen 1",format_painter:"16 format_painter 1",view_zoom_best:"16 View_Best 1",structure:"16 structure 1",helper:"16 helper 1",more_horiz:"16 more_horiz 1",more_vertical:"16 more_vertical 1",close:"16 close 1",share_file:"16 share_file 1",share_cooperation:"16 share_cooperation 1",undo:"16 undo 1",redo:"16 redo 1",clear_formats:"16 clear_formats 1",font_size_add:"16 font_size_add 1",font_size_minus:"16 font_size_minus 1",font_bold:"16 font_bold 1",font_italic:"16 font_italic 1",font_underline:"16 font_underline 1",font_del_line:"16 font_del_line 1",font_color:"16 font_color 1",align_left:"16 align_left 1",align_horiz:"16 align_horiz 1",align_right:"16 align_right 1",align_vertical:"16 align_vertical 1",sheet_sort_ascending:"16 sort_ascending 1",picture:"16 picture 1",find:"16 find 1",border_all:"16 border_all 1",img_checked:"16 img_checked",db_add:"16 db_add 1",db_kanban_view:"16 db_kanban_view 1",db_grid_view:"16 db_grid_view 1",db_gallery_view:"16 db_gallery_view 1",db_form_view:"16 db_form_view 1",db_form_view_unactived:"16 db_form_view_unactived 1",db_gantt_view:"16 db_gantt_view 1",db_query_view:"16 db_query_view 1",db_row_height:"16 db_row_height 1",db_group:"16 db_group 1",db_group_expand:"16 db_group_expand 1",db_group_collapse:"16 db_group_collapse 1",db_card_style:"16 db_card_style 1",db_field_manage:"16 db_field_manage 1",db_filter:"16 db_filter 1",db_ungroup_first:"16 db_ungroup_first 1",db_ungroup_last:"16 db_ungroup_last 1",db_create_from_et:"16 db_create_from_et 1",db_create_from_template:"16 db_create_from_template 1",db_create_blank:"16 db_create_blank 1",db_add_dashboard:"16 db_add_dashboard 1",db_fp_create_blank:"16 db_fp_create_blank 1",db_sheet_menu:"16 db_sheet_menu 1",db_arrow_down:"16 db_arrow_down",db_arrow_up:"16 db_arrow_up",db_arrow_down_fill:"16 db_arrow_down_fill",db_arrow_right_fill:"16 db_arrow_right_fill",db_view_fold:"16 db_view_fold 1",db_view_unfold:"16 db_view_unfold 1",db_generate_form:"16 db_generate_form",db_form_field_edit:"16 db_form_field_edit",db_form_clean:"16 db_form_clean",db_single_default:"16 db_single_default",db_single_default_selected:"16 db_single_default_selected",db_fav_default:"16 db_fav_default 1",db_fav_selected:"16 db_fav_selected 1",db_personal_view:"16 db_personal_view",db_view_more:"16 db_view_more",db_tool_notice:"16 db_tool_notice",db_editable_field_config:"16 db_editable_field_config",db_clear:"16 db_clear",db_field_readonly:"16 db_field_readonly",k_merge_new:"16 k_merge_new",k_merge_modify:"16 k_merge_modify",k_cell_origin_image:"16 k_cell_origin_image",k_expand_merge_cell:"16 k_expand_merge_cell",k_air_script:"16 k_air_script",line_spacing:"16 increase_spacing 1",align_decentralized:"16 decentralized_alignment 1",increase_indentation:"16 increase_indentation 1",reduce_indentation:"16 reduce_indentation 1",numbering:"16 numbeing 1",bullet:"16 bullet 1",font_highlight:"16 font_highlight 1",wordtool:"16 wordtool 1",font_attr:"16 font_attr 1",insert_panel:"16 insert_panel 1",align_both:"16 alignment7 1",web_mode:"16 web_mode 1",show_paramark:"16 show_paramark 1",wps_structure:"16 wps_structure 1",wps_web_mode:"16 wps_web_mode 1",slide:"16 slide 1",insert_panel_geomerty:"16 insert_panel_geomerty 1",play_from_active:"16 play_from_active 1",highlight_play:"16 highlight_play 1",otl_highlight_play:"16 otl_highlight_play 1",hidden_taskbar:"16 hidden_taskbar",hover_hidden_taskbar:"16 hover_hidden_taskbar",show_taskbar:"16 show_taskbar",hover_show_taskbar:"16 hover_show_taskbar",comment_reply:"16 comment_reply",comment_at:"16 comment_at",comment_more:"16 comment_more",statusbar_keyboard:"16 statusbar_keyboard",pdf_first_page:"16 pdf_first_page 1",pdf_last_page:"16 pdf_last_page 1",pdf_next_page:"16 pdf_next_page 1",pdf_prev_page:"16 pdf_prev_page 1",pdf_converter:"16 pdf_converter 1",pdf_drag_mode:"16 pdf_drag_mode 1",pdf_go_to:"16 pdf_go_to 1",pdf_multi_page:"16 pdf_multi_page 1",pdf_background:"16 pdf_background 1",pdf_eye:"16 pdf_eye 1",pdf_rotate_page:"16 pdf_rotate_page 1",pdf_auto_scroll:"16 pdf_auto_scroll 1",pdf_highlight:"16 pdf_highlight 1",pdf_underline:"16 pdf_underline 1",pdf_strikeout:"16 pdf_strikeout 1",pdf_eraser:"16 pdf_eraser 1",pdf_page_first:"16 pdf_page_first 1",pdf_page_last:"16 pdf_page_last 1",pdf_page_prev:"16 pdf_page_prev 1",pdf_page_next:"16 pdf_page_next 1",pdf_catalog:"16 pdf_catalog 1",left_side_bar:"16 left_side_bar 1",right_side_bar:"16 right_side_bar 1",pdf_full_size_zoom:"16 pdf_full_size_zoom 1",pdf_adapt_zoom:"16 pdf_adapt_zoom 1",pdf_view_zoom_best:"16 pdf_view_best 1",pdf_page_width_zoom:"16 pdf_page_width_zoom 1",pdf_normal_pen:"16 pdf_normal_pen",pdf_more_color:"16 pdf_more_color",pdf_play:"16 pdf_play 1",todo_list:"16 todo_list 1",otl_inline_code:"16 otl_inline_code 1",otl_cover_pic_loading:"16 otl_cover_pic_loading 1",merge_new:"16 merge_new",merge_modify:"16 merge_modify",merge_warn:"16 merge_warn",merge_select:"16 merge_select",merge_refresh:"16 merge_refresh",merge_info:"16 merge_info",merge_last_stamp:"16 merge_last_stamp",processon:"16 processon",full_screen2:"16 full_screen2",insert_symbol:"16 insert_symbol",validation_list:"16 validation_list",new_validation_list:"16 new_validation_list",new_validation_list_delete:"16 new_validation_list_delete",hyper_link:"16 hyper_link",func_logical:"16 func_logical",func_info:"16 func_info",insert_left_col:"16 insert_left_col",insert_right_col:"16 insert_right_col",copy:"16 copy",exit_full_screen:"16 exit_full_screen",exit_full_screen2:"16 exit_full_screen2",text_box_horizontal:"16 text_box_horizontal",text_box_vertical:"16 text_box_vertical",inc_indent:"16 increase_indent",dec_indent:"16 decrease_indent",hide_slide:"16 hide_slide",wpp_export_pdf:"16 wpp_export_pdf",laserpen:"16 laserpen",processon_edit:"16 processon_edit",check_origin_pic:"16 check_origin_pic",set_to_bg:"16 set_to_bg",play_from_start:"16 play_from_start",hide_slide_icon:"16 hide_slide_icon",coop_num:"16 coop_num",play_from_meeting:"16 play_from_meeting",mark:"16 mark",wpp_brush_format:"16 wpp_brush_format",wpp_brush_position:"16 wpp_brush_position",wpp_brush_animation:"16 wpp_brush_animation",wpp_object_tile_top:"16 wpp_object_tile_top",wpp_object_tile_right:"16 wpp_object_tile_right",wpp_object_tile_bottom:"16 wpp_object_tile_bottom",wpp_object_tile_left:"16 wpp_object_tile_left",wpp_object_tile_center:"16 wpp_object_tile_center",wpp_object_tile_ver_average:"16 wpp_object_tile_ver_average",wpp_object_tile_ver_center:"16 wpp_object_tile_ver_center",wpp_object_tile_hor_average:"16 wpp_object_tile_hor_average",wpp_object_tile_hor_center:"16 wpp_object_tile_hor_center",wpp_object_tile_consider_slide:"16 wpp_object_tile_consider_slide",wpp_object_rotate:"16 wpp_object_rotate",wpp_object_rotate_90left:"16 wpp_object_rotate_90left",wpp_object_rotate_90right:"16 wpp_object_rotate_90right",wpp_object_rotate_some:"16 wpp_object_rotate_some",wpp_object_rotate_hor:"16 wpp_object_rotate_hor",wpp_object_rotate_ver:"16 wpp_object_rotate_ver",wpp_object_rotate_reset:"16 wpp_object_rotate_reset",wpp_shape_ungroup:"16 wpp_shape_ungroup",anime_exit:"16 anime_exit",anime_emphasis:"16 anime_emphasis",anime_entrance:"16 anime_entrance",anime_path:"16 anime_path",anime_media:"16 anime_media",docer_icons:"16 docer_icons",backward_arrow:"16 backward_arrow",replace_picture:"16 replace_picture",download_picture:"16 download_picture",matting_picture:"16 matting_picture",adjust_layer:"16 adjust_layer",layer_front:"16 layer_front",layer_back:"16 layer_back",layer_forward:"16 layer_forward",layer_backward:"16 layer_backward",wpp_image_clip:"16 wpp_image_clip",wpp_clip_list:"16 wpp_clip_list",wpp_clip_cancel:"16 wpp_clip_cancel",wpp_shape_1to1:"16 wpp_shape_1to1",wpp_shape_4to3:"16 wpp_shape_4to3",wpp_shape_16to9:"16 wpp_shape_16to9",wpp_shape_bigger:"16 wpp_shape_bigger",wpp_shape_lower:"16 wpp_shape_lower",wpp_shape_roundRectangle:"16 wpp_shape_roundRectangle",wpp_shape_ellipse:"16 wpp_shape_ellipse",wpp_shape_flowChartDelay:"16 wpp_shape_flowChartDelay",wpp_shape_diamond:"16 wpp_shape_diamond",wpp_shape_heart:"16 wpp_shape_heart",wpp_shape_parallelogram:"16 wpp_shape_parallelogram",wpp_shape_pentagon:"16 wpp_shape_pentagon",wpp_shape_star5:"16 wpp_shape_star5",wpp_shape_rightTriangle:"16 wpp_shape_rightTriangle",wpp_shape_trapezoid:"16 wpp_shape_trapezoid",wpp_ipad_select_text_all:"16 wpp_ipad_select_text_all",wpp_autofit_format:"16 wpp_autofit_format",wpp_import_loading:"16 wpp_import_loading",warn_tip:"16 warn_tip",wpp_explain_replay:"16 wpp_explain_replay",wpp_explain_zan_empty:"16 wpp_explain_zan_empty",wpp_explain_zan_lighten:"16 wpp_explain_zan_lighten",wpp_reading_order_ltr:"16 wpp_reading_order_ltr",wpp_reading_order_rtl:"16 wpp_reading_order_rtl",pdf_anno_color_selected:"16 pdf_anno_color_selected",pdf_text_mode:"16 pdf_text_mode",pdf_background_default:"16 pdf_background_default 1",pdf_background_dark:"16 pdf_background_dark 1",pdf_background_sheep:"16 pdf_background_sheep 1",pdf_background_eyes:"16 pdf_background_eyes 1",pdf_anno_list:"16 pdf_anno_list 1",pdf_anno_list_right:"16 comment_count",pdf_anno_list_text:"16 pdf_anno_list_text",pdf_anno_list_filter:"16 pdf_anno_list_filter",pdf_anno_list_filter_selected:"16 pdf_anno_list_filter_selected",pdf_anno_list_voice:"16 pdf_anno_list_voice",pdf_start:"16 pdf_start",pdf_pause:"16 pdf_pause",pdf_stop:"16 pdf_stop",font_color2:"16 font_color2",fill_color2:"16 fill_color2",fill_color:"16 fill_color",merge_cancel_cell:"16 merge_cancel_cell",add_lines:"16 add_lines",delete_lines:"16 delete_lines",border_empty:"16 border_empty",border_external:"16 border_external",border_bold:"16 border_bold",border_bottom:"16 border_bottom",border_top:"16 border_top",border_left:"16 border_left",border_right:"16 border_right",border_color:"16 border_color",comment_add:"16 comment_add",delete:"16 delete",comment_next:"16 comment_next",comment_prev:"16 comment_prev",sub_script:"16 subscript",super_script:"16 superscript",format_eraser:"16 format_eraser",insert_date_time:"16 insert_date_time",insert_panel_seperatorline:"16 insert_panel_seperatorline",insert_panel_page:"16 insert_panel_page",insert_panel_table:"16 insert_panel_table",insert_panel_hyperlink:"16 insert_panel_hyperlink",insert_panel_picture:"16 insert_panel_picture",revision:"16 revision",align_left_selected:"16 alignment4_white",align_horiz_selected:"16 alignment5_white",align_right_selected:"16 alignment6_white",align_both_selected:"16 alignment7_white",align_decentralized_selected:"16 decentralized_alignment_white",align_fill:"16 alignment_fill",align_fill_selected:"16 alignment_fill_white",align_cas:"16 alignment_cas",align_cas_white:"16 alignment_cas_white",font_bold_selected:"16 Bold_white",font_italic_selected:"16 Italic_white",font_del_line_selected:"16 Deleting_line_white",super_script_selected:"16 superscript_white",sub_script_selected:"16 subscript_white",font_del_doubleline:"16 Deleting_doubleline",font_focus_upper:"16 focus_upper",font_focus_lower:"16 focus_lower",wps_title_style:"16 wps_title_style",wps_fill_color:"16 wps_fill_color",wps_border_all:"16 wps_border_all",wps_border_empty:"16 wps_border_empty",wps_border_external:"16 wps_border_external",wps_table_align_left:"16 wps_table_align_left",wps_table_align_horiz:"16 wps_table_align_horiz",wps_table_align_right:"16 wps_table_align_right",font_del_doubleline_selected:"16 Deleting_doubleline_white",font_focus_upper_selected:"16 focus_upper_white",font_focus_lower_selected:"16 focus_lower_white",select_black:"16 Select_black",select_white:"16 Select_white",color_empty:"16 Unfilled_color",wpp_color_empty:"16 wpp_color_empty",setting:"16 setting",k_setting:"16 k_setting",ksheet_setting:"16 ksheet_setting",setting_white:"16 setting_white",replace:"16 replace",add_blue:"16 add_blue",switch_menu:"16 switch",close_white:"16 close_white",close_red:"16 close_red",delete_column:"16 delete_column",delete_row:"16 delete_row",delete_leftmove:"16 delete_leftmove",delete_moveup:"16 delete_moveup",delete_worksheet:"16 delete_worksheet",insert_column:"16 insert_column",insert_row:"16 insert_row",mention:"16 mention 1",cooper_version_view:"16 version_view",cooper_history_reduction:"16 reduction",cooper_history_filter:"16 cooper_history_filter",cooper_history_down:"16 array_down",cooper_history_up:"16 array_up",filter_number:"16 filter_number",filter_below_average:"16 filter_below_average",filter_above_average:"16 filter_above_average",back:"16 back",search:"16 search_icon",search_menu:"16 search_menu",download:"16 download",password_hide:"16 code_hide",password_show:"16 code_show",share_contact:"16 contact",share_scan:"16 scan",sheet_sort_descending:"16 sort_descending",sheet_sort_custom:"16 sheet_sort_custom",version_restore:"16 restore",frozen_row:"16 frozen_row",frozen_col:"16 frozen_col",frozen_cancel:"16 frozen_cancel",vertical_more:"16 vertical_more",notice_warn:"16 notice_warn",notice_info:"16 notice_info",wpp_remark:"16 wpp_remark",insert_hyper_links:"16 insert_hyper_links",insert_picture:"16 insert_picture",insert_cell_picture_cloud:"16 insert_cell_picture_cloud",insert_signature:"16 insert_signature",paper_horizontal_direct:"16 paper_horizontal_direct",paper_vertical_direct:"16 paper_vertical_direct",report:"16 report",wordtool1:"16 wordtool1",wordtool2:"16 wordtool2",wordtool3:"16 wordtool3",wordtool4:"16 wordtool4",wordtool5:"16 wordtool5",wordtool6:"16 wordtool6",wordtool7:"16 wordtool7",wordtool8:"16 wordtool8",wordtool9:"16 wordtool9",wordtool10:"16 wordtool10",wordtool11:"16 wordtool11",wps_title_style_1:"16 wps_title_style_1",wps_title_style_2:"16 wps_title_style_2",wps_title_style_3:"16 wps_title_style_3",wps_title_style_4:"16 wps_title_style_4",wps_title_style_5:"16 wps_title_style_5",wps_title_style_6:"16 wps_title_style_6",wps_title_style_7:"16 wps_title_style_7",wps_title_style_8:"16 wps_title_style_8",wps_title_style_9:"16 wps_title_style_9",wps_official_document:"16 wps_official_document",wps_more_btn:"16 wps_more_btn",wps_comment_share:"16 wps_comment_share",wps_comment_praise:"16 wps_comment_praise",wps_comment_filter:"16 wps_comment_filter",wps_comment_filter_selected:"16 wps_comment_filter_selected",wps_catalog_arrow:"16 wps_catalog_arrow",wps_close:"16 wps_close",wps_switch_to_webshape:"16 wps_switch_to_webshape",wps_copy_link:"16 wps_copy_link",wps_edit_link:"16 wps_edit_link",wps_cancel_link:"16 wps_cancel_link",wps_jump_link:"16 wps_jump_link",wps_switch_to_hyperlink:"16 wps_switch_to_hyperlink",wps_webshape_add_comment:"16 wps_webshape_add_comment",insert_panel_codeblock:"16 insert_panel_codeblock",insert_panel_footer:"16 insert_panel_footer",insert_panel_reference:"16 insert_panel_reference",insert_panel_bookmark:"16 insert_panel_bookmark",header_footer_setting:"16 header_footer_setting",page_number:"16 page_number",paragraph_setting:"16 paragraph_setting",close_paragraph_setting:"16 close_paragraph_setting",watermark_edit:"16 insert_panel_watermark",watermark_delete:"16 watermark_delete",watermark_more:"16 watermark_more",page_break:"16 page_break",line_break:"16 line_break",column_break:"16 column_break",section_break_continue:"16 section_break_continue",section_break_next_page:"16 section_break_next_page",section_break_odd:"16 section_break_odd",section_break_even:"16 section_break_even",export_img:"16 export_img",export_img_new:"16 export_img_new",export_pdf:"16 export_pdf",export_pdf_new:"16 export_pdf_new",page_margin:"16 page_margin",paper_direct:"16 paper_direct",wps_paper_size:"16 wps_paper_size",wps_custom_checkbox:"16 wps_custom_checkbox",trash:"16 trash",del_red:"16 del_red",print_wait:"16 print_wait",slide_copy:"16 slide_copy",slide_cut:"16 slide_cut",slide_new_ppt:"16 slide_new_ppt",slide_delete_ppt:"16 slide_delete_ppt",slide_new_section:"16 slide_new_section",slide_paste:"16 slide_paste",slide_paste_pic:"16 slide_paste_pic",slide_paste_select:"16 slide_paste_select",et_error_tips:"16 et_error_tips",remove_highlight:"16 remove_highlight",picture_edit:"16 picture_edit",processon_close:"16 processon-close",image_loading:"16 image_loading",image_loading_circle_white:"16 image_loading_circle_white",approval:"16 approval",page_setting:"16 page_setting",enter_header_footer:"16 enter_header_footer",exit_header_footer:"16 exit_header_footer",enter_line_numbering:"16 enter_line_numbering",highlight_cooperation:"16 highlight_cooperation",insert_comment:"16 insert_comment",display_comment:"16 display_comment",font_decorate:"16 font_decorate",arrow_left:"16 arrow_left",arrow_right:"16 arrow_right",single_arrow_left:"16 single_arrow_left",double_arrow_left:"16 double_arrow_left",notice_ok_normal:"16 notice_ok_normal",k_notice_ok_normal:"16 k_notice_ok_normal",border_inside_horz:"16 InsideHorz_frameline",border_inside_vert:"16 InsideVert_frameline",border_diag_down:"16 DiagDown_frameline",border_diag_up:"16 DiagUp_frameline",revision_submit:"16 revision_submit",revision_cancel:"16 revision_cancel",revision_history_prev:"16 revision_history_prev",revision_history_next:"16 revision_history_next",mind_map:"16 mind_map",flow_chart:"16 flow_chart",text_control_entry:"16 text_control_entry",revision_modify:"16 revision_modify",restrict_edit:"16 restrict_edit",docer_vip_label:"16 docer_vip_label",arrow_up:"16 arrow_up 1",arrow_down:"16 arrow_down 1",arrow_first:"16 arrow_first 1",arrow_end:"16 arrow_end 1",specify_page:"16 specify_page",play_auto:"16 play_auto",play_autostop:"16 play_autostop",showmore_close:"16 showmore_close",showmore_open:"16 showmore_open",et_full_screen:"16 et_full_screen",plugin_center_icon:"16 plugin_center_icon",help_question_mark:"16 help_question_mark",info:"16 info",usinghelp:"16 usinghelp",feedback:"16 feedback",bulb:"16 bulb",tips:"16 tips",float_cancel:"16 float_cancel",float_ok:"16 float_ok",logo:"16 logo",warning:"16 warning",warning_red:"16 warning_red",fmt_delete:"16 fmt_delete",number_custom:"16 number_custom",cell_history:"16 cell_history",name_del:"16 name_del",taskpanel_bookmark_pos:"16 taskpanel_bookmark_pos",selective_paste:"16 selective_paste",selective_paste_preserve:"16 selective_paste_preserve",selective_paste_match:"16 selective_paste_match",selective_paste_text_only:"16 selective_paste_text_only",selective_paste_wpp:"16 selective_paste_wpp",insert_audio:"16 insert_audio",insert_video:"16 insert_video",icon_selected:"16 icon_selected",setting_open:"16 setting_open",setting_close:"16 setting_close",interline:"16 interline",filename:"16 filename",revision_question_mark:"16 revision_question_mark",revision_status_setting:"16 revision_status_setting",dv_date:"16 dv_date",dv_time:"16 dv_time",dv_clear_col:"16 dv_clear_col",checkbox_true:"16 checkbox_true",checkbox_false:"16 checkbox_false",et_checkbox_true:"16 et_checkbox_true",et_export_db:"16 et_export_db",db_type_single_text:"16 db_type_single_text",db_type_single_text_small:"16 db_type_single_text_small",db_type_multi_text:"16 db_type_multi_text",db_type_multi_text_small:"16 db_type_multi_text_small",db_type_date:"16 db_type_date",db_type_date_small:"16 db_type_date_small",db_type_time:"16 db_type_time",db_type_time_small:"16 db_type_time_small",db_type_number:"16 db_type_number",db_type_number_small:"16 db_type_number_small",db_type_currency:"16 db_type_currency",db_type_currency_small:"16 db_type_currency_small",db_type_percentage:"16 db_type_percentage",db_type_percentage_small:"16 db_type_percentage_small",db_type_id:"16 db_type_id",db_type_id_small:"16 db_type_id_small",db_type_phone:"16 db_type_phone",db_type_phone_small:"16 db_type_phone_small",db_type_email:"16 db_type_email",db_type_email_small:"16 db_type_email_small",db_type_hyperlink:"16 db_type_link",db_type_hyperlink_small:"16 db_type_link_small",db_type_checkbox:"16 db_type_checkbox",db_type_checkbox_small:"16 db_type_checkbox_small",db_type_checkbox_false:"16 db_type_checkbox_false",db_checkbox_true:"16 db_checkbox_true",db_checkbox_false:"16 db_checkbox_false",db_type_single:"16 db_type_single",db_type_single_small:"16 db_type_single_small",db_type_multi:"16 db_type_multi",db_type_multi_small:"16 db_type_multi_small",db_type_grade:"16 db_type_grade",db_type_grade_small:"16 db_type_grade_small",db_type_grade_gray:"16 db_type_grade_gray",db_type_progress:"16 db_type_progress",db_type_progress_small:"16 db_type_progress_small",db_type_image:"16 db_type_image",db_type_image_small:"16 db_type_image_small",db_type_file:"16 db_type_file",db_type_file_small:"16 db_type_file_small",db_type_contacts:"16 db_type_contacts",db_type_contacts_small:"16 db_type_contacts_small",db_type_formula:"16 db_type_formula",db_type_formula_small:"16 db_type_formula_small",db_type_auto_number:"16 db_type_auto_number",db_type_auto_number_small:"16 db_type_auto_number_small",db_type_creator:"16 db_type_creator",db_type_creator_small:"16 db_type_creator_small",db_type_create_time:"16 db_type_create_time",db_type_create_time_small:"16 db_type_create_time_small",db_type_trigger:"16 db_type_trigger",db_type_trigger_small:"16 db_type_trigger_small",db_type_note:"16 db_type_note",db_type_note_small:"16 db_type_note_small",db_type_link_record:"16 db_type_link_record",db_type_link_record_small:"16 db_type_link_record_small",db_type_field_lookup:"16 db_type_field_lookup",db_type_field_lookup_small:"16 db_type_field_lookup_small",db_type_address:"16 db_type_address",db_type_address_small:"16 db_type_address_small",db_type_last_modified_time:"16 db_type_last_modified_time",db_type_last_modified_time_small:"16 db_type_last_modified_time_small",db_type_last_modified_by:"16 db_type_last_modified_by",db_type_last_modified_by_small:"16 db_type_last_modified_by_small",db_field_tip:"16 db_field_tip",db_add_link_field:"16 db_add_link_field",db_new_add:"16 db_new_add",db_rename:"16 db_rename",db_get_link:"16 db_get_link",db_card_prev:"16 db_card_prev",db_card_next:"16 db_card_next",db_card_arrow_up:"16 db_card_arrow_up",db_card_arrow_down:"16 db_card_arrow_down",db_print:"16 db_print",db_print_preview:"16 db_print_preview",db_print_fullScreen:"16 db_print_fullscreen",db_print_quit_fullscreen:"16 db_print_quit_fullscreen",k_sheet_db_type_auto_number:"16 k_sheet_db_type_auto_number",k_sheet_db_type_checkbox:"16 k_sheet_db_type_checkbox",k_sheet_db_type_checkbox2:"16 k_sheet_db_type_checkbox2",k_sheet_db_type_contacts:"16 k_sheet_db_type_contacts",k_sheet_db_type_create_time:"16 k_sheet_db_type_create_time",k_sheet_db_type_currency:"16 k_sheet_db_type_currency",k_sheet_db_type_email:"16 k_sheet_db_type_email",k_sheet_db_type_creator:"16 k_sheet_db_type_creator",k_sheet_db_type_field_lookup:"16 k_sheet_db_type_field_lookup",k_sheet_db_type_address:"16 k_sheet_db_type_address",k_sheet_db_type_file:"16 k_sheet_db_type_file",k_sheet_db_type_image:"16 k_sheet_db_type_file",k_sheet_db_type_formula:"16 k_sheet_db_type_formula",k_sheet_db_type_grade:"16 k_sheet_db_type_grade",k_sheet_db_type_hyperlink:"16 k_sheet_db_type_hyperlink",k_sheet_db_type_id:"16 k_sheet_db_type_id",k_sheet_db_type_link_record:"16 k_sheet_db_type_link_record",k_sheet_db_type_multi:"16 k_sheet_db_type_multi",k_sheet_db_type_multi_text:"16 k_sheet_db_type_multi_text",k_sheet_db_type_single_text:"16 k_sheet_db_type_multi_text",k_sheet_db_type_note:"16 k_sheet_db_type_note",k_sheet_db_type_number:"16 k_sheet_db_type_number",k_sheet_db_type_percentage:"16 k_sheet_db_type_percentage",k_sheet_db_type_phone:"16 k_sheet_db_type_phone",k_sheet_db_type_progress:"16 k_sheet_db_type_progress",k_sheet_db_type_single:"16 k_sheet_db_type_single",k_sheet_db_type_time:"16 k_sheet_db_type_time",k_sheet_db_type_trigger:"16 k_sheet_db_type_trigger",k_sheet_db_type_date:"16 k_sheet_db_type_date",k_p_s_format:"16 k_p_s_format",k_p_s_val_dig:"16 k_p_s_val_dig",k_p_s_format_all:"16 k_p_s_format_all",k_p_s_value:"16 k_p_s_value",k_p_s_trans:"16 k_p_s_trans",k_trans_image:"16 k_trans_image",k_dv_image_album:"16 k_dv_image_album",ksheet_db_type_checkbox:"16 ksheet_db_type_checkbox",ksheet_db_type_progress:"16 ksheet_db_type_progress",ksheet_db_type_date:"16 ksheet_db_type_date",ksheet_db_type_time:"16 ksheet_db_type_time",ksheet_db_type_single:"16 ksheet_db_type_single",ksheet_db_type_image:"16 ksheet_db_type_image",ksheet_db_type_email:"16 ksheet_db_type_email",ksheet_db_type_hyperlink:"16 ksheet_db_type_link",ksheet_db_type_phone:"16 ksheet_db_type_phone",ksheet_db_type_id:"16 ksheet_db_type_id",ksheet_dv_clear_col:"16 ksheet_dv_clear_col",k_sheet_db_clear:"16 k_sheet_db_clear",ksheet_db_add:"16 ksheet_db_add",ksheet_db_get_link:"16 ksheet_db_get_link",ksheet_db_form_edit_mode:"16 ksheet_db_form_edit_mode",ksheet_db_blue_add:"16 ksheet_db_blue_add",ksheet_db_editor_close:"16 ksheet_db_editor_close",ksheet_comment_at:"16 ksheet_comment_at",ksheet_cell_history_sm:"16 ksheet_cell_history_sm",ksheet_color_empty:"16 ksheet_color_empty",as_dv_tip:"16 as_dv_tip",db_dv_tip:"16 db_dv_tip",pub_menu_item_tip:"16 pub_menu_item_tip",pub_menu_item_new_tip:"16 pub_menu_item_new_tip",menu_search:"16 menu_search",new_sheet_normal:"16 new_sheet_normal",eye_open:"16 eye_open",eye_close:"16 eye_close",db_row_h1:"16 db_row_h1",db_row_h2:"16 db_row_h2",db_row_h3:"16 db_row_h3",db_row_h4:"16 db_row_h4",db_card_link_go:"16 db_card_link_go",db_primary_field:"16 db_primary_field",db_image_add:"16 db_image_add",db_image_download:"16 db_image_download",db_image_viewer:"16 db_image_viewer",db_image_delete:"16 db_image_delete",db_attachment_download:"16 db_attachment_download",db_attachment_viewer:"16 db_attachment_viewer",db_attachment_delete:"16 db_attachment_delete",db_sheet_normal:"16 db_sheet_normal",db_sheet_normal_1:"16 db_sheet_normal_1",db_sheet_normal_active:"16 db_sheet_normal_active",db_dashboard:"16 db_dashboard",db_dashboard_active:"16 db_dashboard_active",db_sheet_normal_fp:"16 db_sheet_normal_fp",db_sheet_normal_fp_active:"16 db_sheet_normal_fp_active",db_pack_up:"16 db_pack_up",db_notice:"16 db_notice",db_gallery_cover_picture:"16 db_gallery_cover_picture",db_gallery_cover_attachment:"16 db_gallery_cover_attachment",db_gallery_no_cover:"16 db_gallery_no_cover",db_add_trigger:"16 db_add_trigger",db_unfold:"16 db_unfold",db_fold:"16 db_fold",db_view_share:"16 db_view_share",db_query_setting:"16 db_query_setting",db_video_viewer_close:"16 db_video_viewer_close",db_find_pre:"16 db_find_prev",db_find_next:"16 db_find_next",db_find_pre_active:"16 db_find_prev_active",db_find_next_active:"16 db_find_next_active",db_search:"16 db_search",db_add_record:"16 db_add_record",re_application:"16 re_application",show_all:"16 show_all",filter_auto:"16 filter_auto",more_color:"16 more_color",db_help:"16 db_help",db_show_more_green:"16 db_show_more_green",db_show_more:"16 db_show_more",db_fold_green:"16 db_fold_green",db_fold_gray:"16 db_fold_gray",db_protect_disable:"16 db_protect_disable",db_white_close:"16 db_white_close",db_protect_entry:"16 db_protect_entry",db_preview:"16 db_preview",db_qrcode:"16 db_qrcode",db_minipro_code:"16 db_minipro_code",db_hyperlink_edit:"16 db_hyperlink_edit",db_batch_paste:"16 db_batch_paste",db_form_drag:"16 db_form_drag",drag:"16 drag",db_formula_operator:"16 db_formula_operator",db_formula_add:"16 db_formula_add",db_formula_mult:"16 db_formula_mult",db_formula_sub:"16 db_formula_sub",db_formula_divi:"16 db_formula_divi",db_formula_list:"16 db_formula_list",db_change_arrow:"16 db_change_arrow",db_eye_close:"16 db_eye_close",db_editor_close:"16 db_editor_close",db_editor_fold:"16 db_editor_fold",db_editor_unfold:"16 db_editor_unfold",db_link_arrow:"16 db_link_arrow",db_form_edit_mode:"16 db_form_edit",db_form_design_mode:"16 db_form_design",ksheet_unfold:"16 ksheet_unfold",ksheet_dbsheet_new_sheet:"16 ksheet_dbsheet_new_sheet",ksheet_et_delete:"16 ksheet_et_delete",ksheet_hide_slide:"16 ksheet_hide_slide",ksheet_eye_open:"16 ksheet_eye_open",ksheet_copy:"16 ksheet_copy",ksheet_set_chart:"16 ksheet_set_chart",ksheet_set_type_chart:"16 ksheet_set_type_chart",keyboard:"16 keyboard",grid:"16 grid",add_canvas:"16 add_canvas",repeat:"16 repeat",text_vertical:"16 text_vertical",text_horizontal:"16 text_horizontal",note_color_diff:"16 note_color_diff",adapt_window:"16 adapt_window",kw_border_none:"16 kw_border_none",font:"16 font",para:"16 para",autonum:"16 autonum",average_col_width:"16 average_col_width",average_row_height:"16 average_row_height",border_center:"16 border_center",border_center_horizental:"16 border_center_horizental",border_center_vertical:"16 border_center_vertical",droplist_setting_minus:"16 droplist_setting_minus",droplist_setting_plus:"16 droplist_setting_plus",droplist_setting_draw:"16 droplist_setting_draw",font_size_add_white:"16 font_size_add_white",font_size_minus_white:"16 font_size_minus_white",edit_name:"16 edit_name",window_btn:"16 window_btn",play_explain:"16 play_explain",auto_play:"16 auto_play",docer_logo:"16 docer_logo",protect_edit:"16 protect_edit",spell_check_enabled:"16 spell_check_enabled",spell_check_disabled:"16 spell_check_disabled",calculate_finish_status:"16 calculate_finish_status",wps_selected:"16 selected_w",et_selected:"16 selected_s",wpp_selected:"16 selected_p",pdf_selected:"16 selected_f",disabled_tag:"16 disabled-tag",submenu_dropdown:"16 submenu-dropdown",arrow_gray:"16 arrow_gray",bell:"16 bell",bell_ban:"16 bell_ban",add_one:"16 add_one",praise:"16 praise",chart_element:"16 chart_element",chart_layout:"16 chart_layout",chart_color:"16 chart_color",chart_style:"16 chart_style",chart_power:"16 chart_power",chart_linear:"16 chart_linear",chart_logarithm:"16 chart_logarithm",chart_multinomial:"16 chart_multinomial",chart_exponent:"16 chart_exponent",chart_moveavg:"16 chart_moveavg",chart_marker_square:"16 chart_marker_square",chart_marker_diamond:"16 chart_marker_diamond",chart_marker_triangle:"16 chart_marker_triangle",chart_marker_x:"16 chart_marker_x",chart_marker_star:"16 chart_marker_star",chart_marker_dot:"16 chart_marker_dot",chart_marker_dash:"16 chart_marker_dash",chart_marker_circle:"16 chart_marker_circle",chart_marker_plus:"16 chart_marker_plus",chart_question:"16 chart_question",wpp_switch_queue:"16 wpp_switch_queue",wpp_add_anime:"16 wpp_add_anime",wpp_format_setting:"16 wpp_format_setting",default_layout:"16 default_layout",add_new:"16 add_new",copy_format:"16 copy_format",paste_format:"16 paste_format",copy_once:"16 copy_once",exchange:"16 exchange",animation:"16 animation",reduce:"16 reduce",opacity:"16 opacity",text_attribute:"16 text_attribute",border_none:"16 border_none",fill_none:"16 fill_none",wps_circle_checkbox_checked:"16 wps_circle_checkbox_checked",wps_circle_checkbox:"16 wps_circle_checkbox",wps_comment_panel:"16 wps_comment_panel",add_sign:"16 add_sign",delete_sign:"16 delete_sign",sign_manage:"16 sign_manage",sign_manage_ok:"16 sign_manage_ok",info_warn:"16 info_warn",warn_red:"16 warn_red",help_info:"16 help_info",import:"16 import",insert_hr:"16 insert_hr",block_quote:"16 block_quote",code_block:"16 code_block",font_h1:"16 font_h1",font_h2:"16 font_h2",font_h3:"16 font_h3",font_h4:"16 font_h4",font_h5:"16 font_h5",quote:"16 quote",comment_count:"16 comment_count",insert_bilibili:"16 insert_bilibili",insert_ximalaya:"16 insert_ximalaya",insert_netease_music:"16 insert_netease_music",insert_thirdsresources:"16 insert_thirdsresources",link_open:"16 link_open",link_reload:"16 link_reload",outline_user:"16 outline_user",outline_date:"16 outline_date",outline_link:"16 outline_link",outline_doc:"16 outline_doc",outline_template_plugin:"16 outline_template_plugin",otl_pco_edit:"16 otl_pco_edit",otl_add_todo:"16 otl_add_todo",otl_image_border:"16 otl_image_border",otl_image_rotate:"16 otl_image_rotate",otl_full_screen:"16 otl_full_screen",otl_insert_comment:"16 otl_insert_comment",img_full_screen:"16 img_full_screen",table_insert_right:"16 table_insert_right",table_insert_left:"16 table_insert_left",table_insert_below:"16 table_insert_below",table_insert_ahead:"16 table_insert_ahead",paragraph_bar_insert_blank:"16 paragraph_bar_insert_blank",insert_date:"16 insert_date",insert_img:"16 insert_img",insert_schedule:"16 insert_schedule",insert_markdown:"16 insert_markdown",insert_column_block:"16 insert_column_block",insert_highlight_block:"16 insert_highlight_block",insert_lock_block:"16 insert_lock_block",cancel_lock_block:"16 cancel_lock_block",set_object_block_style:"16 set_object_block_style",otl_cancel_link:"16 otl_cancel_link",otl_comment_add:"16 otl_comment_add",otl_video:"16 otl_video",otl_copy_right_click:"16 otl_copy_right_click",otl_paste_right_click:"16 otl_paste_right_click",otl_paste_text_right_click:"16 otl_paste_text_right_click",otl_cut_right_click:"16 otl_cut_right_click",table_merge_cells:"16 table_merge_cells",table_split_cell:"16 table_split_cell",blue_right_arrow:"16 blue_right_arrow",gray_right_arrow:"16 gray_right_arrow",countdown:"16 countdown",otl_table_vertical_top:"16 otl_table_vertical_top",otl_table_vertical_middle:"16 otl_table_vertical_middle",otl_table_vertical_bottom:"16 otl_table_vertical_bottom",otl_pc_comment:"16 otl_pc_comment",otl_pc_find:"16 otl_pc_find",otl_increase_indentation:"16 otl_increase_indentation",otl_reduce_indentation:"16 otl_reduce_indentation",otl_font_sup:"16 otl_font_sup",otl_font_sub:"16 otl_font_sub",otl_font_color:"16 otl_font_color",otl_redo:"16 otl_redo",otl_undo:"16 otl_undo",otl_font_highlight:"16 otl_font_highlight",otl_cmb_more_btn:"16 otl_cmb_more_btn",otl_align_left:"16 otl_align_left",otl_align_horiz:"16 otl_align_horiz",otl_align_right:"16 otl_align_right",otl_todo_list:"16 otl_todo_list",otl_bullet:"16 otl_bullet",otl_numbering:"16 otl_numbering",otl_close_comment:"16 otl_close_comment",otl_comment_show_btn:"16 otl_comment_show_btn",dropdown_selected:"16 dropdown_selected",voice_telephone:"16 voice_telephone",koa_chat:"16 koa_chat",woa_chat:"16 woa_chat",menu_meeting:"16 menu_meeting",latex_formula:"16 latex_formula",toggle_panel:"16 toggle_panel",tip:"16 tip",otl_nps_icon:"16 otl_nps_icon",img_fill:"16 img_fill",ksheet_nps_icon:"16 ksheet_nps_icon",spreadsheet_nps_icon:"16 spreadsheet_nps_icon",wpp_nps_icon:"16 wpp_nps_icon",pdf_nps_icon:"16 pdf_nps_icon",wps_nps_icon:"16 wps_nps_icon",nps_close:"16 nps_close",otl_insert_panel:"16 otl_insert_panel",common_fullscreen:"16 common_fullscreen",sub_dropdown:"16 sub_dropdown",k_app_share:"16 k_app_share",k_app_add:"16 k_app_add",k_app_close:"16 k_app_close",k_more:"16 k_more",k_app_config:"16 k_app_config",k_app_data:"16 k_app_data",k_app_more:"16 k_app_more",k_app_preview:"16 k_app_preview",link_copy:"16 link_copy",footnote_endnote:"16 footnote_endnote",insert_footnote:"16 insert_footnote",insert_endnote:"16 insert_endnote",footnote_setting:"16 footnote_setting",endnote_setting:"16 endnote_setting",dropdown_arrow:"16 dropdown_arrow",chat_tick_success:"16 chat_tick_success"},size24:{more:"24 more 1",otl_view_img:"24 otl_view_img",k_et_icon:"24 k_et_icon",arrow_up_white:"24 arrow_up_white",arrow_down_white:"24 arrow_down_white",add_white:"24 add_white",db_card_close:"24 db_card_close",play_from_start:"24 play_from_start",play_from_active:"24 play_from_active",play_fast:"24 play_fast",remark:"24 remark",insert_text:"24 insert_text",stop_play:"24 stop_play",wpp_insert_picture:"24 wpp_insert_picture",picture_shortcut:"24 picture_shortcut 1",table_shortcut:"24 table_shortcut 1",chart_shortcut:"24 chart_shortcut 1",cell_delete:"24 delete",cell_format:"24 format",et_data_manage:"24 et_data_manage",et_set_chart:"24 et_set_chart",et_set_style_chart:"24 et_set_style_chart",et_set_type_chart:"24 et_set_type_chart",url_cell_pic:"24 url_cell_pic",cell_origin_image:"24 cell_origin_image",delete_circle:"24 delete_circle",close:"24 close",enter:"24 enter",format_painter_wps:"24 format_painter",print:"24 print",trash:"24 trash",topbar_font:"24 topbar_font",warning:"24 warning",topbar_history:"24 topbar_history",success:"24 ok_24",wrong:"24 wrong_24",info:"24 message_24",border_empty:"24 border_empty",border_external:"24 border_external",border_fill_color:"24 Fill",border_inside:"24 Inside_frameline",merge_center:"24 Merge",cooper_history:"24 Revised_record",topbar_hidden:"24 topbar_fold",password_btn_disabled:"24 go_disable",password_btn_normal:"24 go_normal",back:"24 back",mobile_cooperation:"24 mobile_cooperation",lock:"24 lock",exportFile:"24 export",rotate:"24 rotate",rotate_2:"24 rotate_2",mobile_play_fast:"24 mobile_play_fast",more_items:"24 more_items",hyper_link:"24 hyper_link",func:"24 func",et_image_save_excel:"24 et_image_save_excel",et_image_save_cloud_last:"24 et_image_save_cloud_last",et_loading_finish:"24 et_loading_finish",et_export_img:"24 et_export_img",et_export_pdf:"24 et_export_pdf",et_condition_format:"24 et_condition_format",fill_color:"24 fill_color",wps_export_pdf:"24 wps_export_pdf",wps_export_img:"24 wps_export_img",textWrappingAboveCharacter:"24 text_wrapping_above_character",textWrappingSurroundUpAndDown:"24 text_wrapping_around_up_and_down",textWrappingEmbedded:"24 text_wrapping_embedded",textWrappingSurround:"24 text_wrapping_surround",textWrappingThroughAround:"24 text_wrapping_through_around",textWrappingTightAround:"24 text_wrapping_tight_around",textWrappingUnderCharacter:"24 text_wrapping_under_character",textWrappingWebModeEmbedded:"24 text_wrapping_web_mode_embedded",textWrappingWebModeExclusive:"24 text_wrapping_web_mode_exclusive",et_error_check_tips:"24 et_error_check_tips",insert_picture:"24 insert_picture",processon_edit_2:"24 processon_edit_2",process_edit:"24 process-edit",sign_clear:"24 sign_clear",sign_cancel:"24 sign_cancel",wpp_uil_tip_close:"24 wpp_uil_tip_close",wpp_uil_tip_open:"24 wpp_uil_tip_open",unfold:"24 unfold",wps_bookmark_item:"24 wps_bookmark_item",wpp_play_mark:"24 wpp_play_mark",wpp_add_new:"24 wpp_add_new",wpp_add_new_gray:"24 wpp_add_new_gray",kw_close_btn:"24 kw_close_btn",mind_map:"24 mind_map",flow_chart:"24 flow_chart",note:"24 note",picture:"24 picture",select:"24 select",textbox:"24 textbox",insert_geometry:"24 insert_geometry",wpp_play_start:"24 wpp_play_start",wpp_play_stop:"24 wpp_play_stop",wpp_play_fullscreen:"24 wpp_play_fullscreen",wpp_explain_exit_fullscreen:"24 wpp_explain_exit_fullscreen",wpp_play_exit_fullscreen:"24 wpp_play_exit_fullscreen",wpp_play_loading:"24 wpp_play_loading",wpp_play_loading_gray:"24 wpp_play_loading_gray",wpp_playbar_more:"24 wpp_playbar_more",wpp_playbar_fullscreen_exit:"24 wpp_playbar_fullscreen_exit",wpp_playbar_fullscreen:"24 wpp_playbar_fullscreen",wpp_playbar_laser:"24 wpp_playbar_laser",wpp_playbar_laser_active:"24 wpp_playbar_laser_active",wpp_playbar_create_meeting:"24 wpp_playbar_create_meeting",wpp_playbar_finish:"24 wpp_playbar_finish",wpp_playbar_audience_view:"24 wpp_playbar_audience_view",setting_white:"24 setting_white",time_countdown:"24 time_countdown",start_autoplay:"24 start_autoplay",play_page:"24 play_page",mark:"24 mark",show_mark:"24 show_mark",audio_icon_1:"24 audio_icon_1",audio_icon_2:"24 audio_icon_2",audio_icon_3:"24 audio_icon_3",audio_icon_4:"24 audio_icon_4",audio_icon_5:"24 audio_icon_5",audio_icon_6:"24 audio_icon_6",media_muted:"24 media_muted",media_volume:"24 media_volume",remarks_view:"24 remarks_view",pdf_mouse:"24 pdf_mouse",pdf_play_left_bar:"24 pdf_play_left_bar",pdf_play_right_bar:"24 pdf_play_right_bar",pdf_play_drag:"24 pdf_play_drag",pdf_auto_scroll:"24 pdf_auto_scroll",pdf_end_play:"24 pdf_end_play",pdf_enter_full:"24 pdf_enter_full",pdf_exit_full:"24 pdf_exit_full",pdf_play_prev:"24 pdf_play_prev",pdf_play_next:"24 pdf_play_next",pdf_play_enlarge:"24 pdf_play_enlarge",pdf_play_narrow:"24 pdf_play_narrow",pdf_play_adapt:"24 pdf_play_adapt",pdf_play_pagew:"24 pdf_play_pagew",pdf_play_multi_page:"24 pdf_play_multi_page",otl_reload:"24 otl_reload",otl_cut:"24 otl_cut",otl_copy:"24 otl_copy",otl_paste:"24 otl_paste",otl_arrow_mouse:"24 otl_arrow_mouse",otl_select_text_all:"24 otl_select_text_all",otl_comment:"24 otl_comment",otl_edit:"24 otl_edit",otl_delete:"24 otl_delete",otl_jumplink:"24 otl_jumplink",otl_clean:"24 otl_clean",otl_table_insert:"24 otl_table_insert",otl_image_add_border:"24 otl_image_add_border",otl_image_cancel_border:"24 otl_image_cancel_border",otl_image_rotate:"24 otl_image_rotate",otl_table_merge_cells:"24 otl_table_merge_cells",otl_table_split_cell:"24 otl_table_split_cell",otl_close:"24 otl_close",otl_playbar_close:"24 otl_playbar_close",otl_playbar_edit:"24 otl_playbar_edit",otl_playbar_finish:"24 otl_playbar_finish",otl_zoom_in:"24 otl_zoom_in",otl_zoom_out:"24 otl_zoom_out",text_align_left:"24 align_l",text_align_right:"24 align_r",text_align_center:"24 align_c",vertical_top:"24 vertical_top",vertical_middle:"24 vertical_middle",vertical_bottom:"24 vertical_bottom",image_zoom_in:"24 image_zoom_in",image_zoom_out:"24 image_zoom_out",image_rotate_left:"24 image_rotate_left",image_rotate_right:"24 image_rotate_right",image_adapt_size:"24 image_adapt_size",image_origin_size:"24 image_origin_size",image_download:"24 image_download",image_more:"24 image_more",image_last:"24 image_last",image_next:"24 image_next",image_thumb_last:"24 image_thumb_last",image_thumb_next:"24 image_thumb_next",image_location:"24 image_location",image_edit:"24 image_edit",image_close:"24 image_close",image_mini_mode:"24 image_mini_mode",image_full_mode:"24 image_full_mode",image_loading:"24 image_loading",i_more:"24 i_more",i_rotate_left:"24 i_rotate_left",i_rotate_right:"24 i_rotate_right",i_zoom_in:"24 i_zoom_in",i_zoom_out:"24 i_zoom_out",i_origin_size:"24 i_origin_size",i_adapt_size:"24 i_adapt_size",image_aerial_view:"24 image_aerial_view",image_exit_fullscreen:"24 image_exit_fullscreen",image_fullscreen:"24 image_fullscreen",db_logo:"24 db",k_logo:"24 k_logo",go_forward_five:"24 go_forward_five",go_back_five:"24 go_back_five",wpp_theme_loading:"24 wpp_theme_loading",ksheet_more:"24 ksheet_more",other:"24 other",ksheet_other:"24 ksheet_other",protect_other:"24 protect_other",video_play:"24 video_play",video_pause:"24 video_pause",video_volume:"24 video_volume",video_fullscreen:"24 video_fullscreen",video_volume_muted:"24 video_volume_muted",video_exit_fullscreen:"24 video_exit_fullscreen",video_loading:"24 video_loading",video_volume_active:"24 video_volume_active"},size38:{warn:"38 warn",success:"38 ok",wrong:"38 wrong",safe:"38 safe",process_on_edit:"38 process_on_edit",portrait:"38 portrait",landscape:"38 landscape",allColPage:"38 allColPage",allRowPage:"38 allRowPage",inPage:"38 inPage"},size48:{close:"48 close",share:"48 share",invite:"48 invite",rename:"48 rename",feedback:"48 feedback",settings:"48 settings",exportFile:"48 export",saveAs:"48 saveAs",reportFile:"48 reportFile",aboutWps:"48 aboutwps",other_apps:"48 other_apps",scan_code:"48 scan_code",edit:"48 edit",edit_finish:"48 edit_finish",rotate:"48 rotate",format_satting:"48 format_satting",format_satting_selected:"48 format_satting_selected",et_aido_fill:"48 et_aido_fill",et_aido_signature:"48 et_aido_signature",text_encoding:"48 text_encoding",wpp_image_reload:"48 wpp_image_reload",et_link_green:"48 et_link_green",db_gallery_add:"48 db_gallery_add",db_image_placeholder:"48 db_image_placeholder",nps_submit:"48 nps_submit",image_loading:"48 image_loading"},size64:{cooper_histories_none:"64 No_collaboration",cooper_version_none:"64 historic_version",et_condition_format_none:"64 et_condition_format_none",et_aido_fill:"64 et_aido_fill",et_aido_signature:"64 et_aido_signature",k_link_green:"64 k_link_green",ksheet_condition_format_none:"64 ksheet_condition_format_none"},line:{blsThin:"line bls_thin",blsHair:"line bls_hair",blsDotted:"line bls_dotted",blsDashed:"line bls_dashed",blsDashDot:"line bls_dash_dot",blsDashDotDot:"line bls_dash_dot_dot",blsDouble:"line bls_double",blsMedium:"line bls_medium",blsMediumDashed:"line bls_medium_dashed",blsMediumDashDot:"line bls_medium_dash_dot",blsMediumDashDotDot:"line bls_medium_dash_dot_dot",blsSlantedDashDot:"line bls_slanted_dash_dot",blsThick:"line bls_thick"},outline:{single:"outline single",double:"outline double",thin_thick:"outline thin_thick",thick_thin:"outline thick_thin",thin_thick_thin:"outline thin_thick_thin",round_dot:"outline round_dot",short_dash:"outline short_dash",dash_dot:"outline dash_dot",double_dot:"outline double_dot",header_btn_triangle:"outline header_btn_triangle 1",header_btn_triangle_hover:"outline header_btn_triangle_hover",insert_panel_table:"outline insert_panel_table",insert_panel_table2:"16 insert_panel_table2",insert_panel_kanban:"outline insert_panel_kanban",insert_panel_todolist:"outline insert_panel_todolist",insert_panel_emoji:"outline insert_panel_emoji",insert_panel_group_card:"outline insert_panel_group_card",mind_map:"16 mind_map",flow_chart:"16 flow_chart",delete_column:"outline delete_table_element",delete_row:"outline delete_table_element",delete_table:"outline delete_table_element",add_column_hover:"outline add_table_element_hover",add_column_not_hover:"outline add_table_element_not_hover",add_row_hover:"outline add_table_element_hover",add_row_not_hover:"outline add_table_element_not_hover",template_btn_hover:"outline template_btn_element_hover",template_btn_not_hover:"outline template_btn__element_not_hover",video_load_fail:"outline video_load_fail",new_comment_close:"outline new_comment_close",question_mark:"outline question_mark",spin_loading:"outline spin_loading",checkbox_active:"outline checkbox_active",vote_multiple_choice:"outline vote_multiple_choice",vote_single_choice:"outline vote_single_choice",extensions:"outline extensions",extensions_channels_activity:"outline extensions_channels_activity",extensions_file_update_notice:"outline extensions_file_update_notice",vote_add_16:"outline vote_add_16",vote_arrow_16:"outline vote_arrow_16",vote_close_16:"outline vote_close_16",dropdown_normal_16_vote:"outline dropdown_normal_16_vote",dropdown_normal_16_h1:"outline dropdown_normal_16_h1",dropdown_normal_16_h2:"outline dropdown_normal_16_h2",dropdown_normal_16_h3:"outline dropdown_normal_16_h3",dropdown_normal_16_h4:"outline dropdown_normal_16_h4",dropdown_normal_16_h5:"outline dropdown_normal_16_h5",dropdown_normal_16_un_order_list:"outline dropdown_normal_16_un_order_list 1",dropdown_normal_16_order_list:"outline dropdown_normal_16_order_list 1",dropdown_normal_16_todo_list:"outline dropdown_normal_16_todo_list 1",dropdown_normal_16_highlight_block:"outline dropdown_normal_16_highlight_block",dropdown_normal_16_quote:"outline dropdown_normal_16_quote",dropdown_normal_16_code_block:"outline dropdown_normal_16_code_block",dropdown_normal_16_align_left:"outline dropdown_normal_16_align_left",dropdown_normal_16_align_center:"outline dropdown_normal_16_align_center",dropdown_normal_16_align_right:"outline dropdown_normal_16_align_right",dropdown_normal_16_link:"outline dropdown_normal_16_link 1",dropdown_colorful_16_image:"outline dropdown_colorful_16_image",dropdown_colorful_16_table:"outline dropdown_colorful_16_table",dropdown_colorful_16_cloud_documents:"outline dropdown_colorful_16_cloud_documents",dropdown_colorful_16_highlight_block:"outline dropdown_colorful_16_highlight_block",dropdown_colorful_16_date:"outline dropdown_colorful_16_date",dropdown_colorful_16_code_block:"outline dropdown_colorful_16_code_block",dropdown_colorful_16_quote:"outline dropdown_colorful_16_quote",dropdown_colorful_16_emoji:"outline dropdown_colorful_16_emoji",dropdown_colorful_16_hyperlink:"outline dropdown_colorful_16_hyperlink",dropdown_colorful_16_dividing_line:"outline dropdown_colorful_16_dividing_line",dropdown_colorful_16_latex:"outline dropdown_colorful_16_latex",dropdown_colorful_16_mind_mapping:"outline dropdown_colorful_16_mind_mapping",dropdown_colorful_16_flow_chart:"outline dropdown_colorful_16_flow_chart",dropdown_colorful_16_et:"outline dropdown_colorful_16_et",dropdown_colorful_16_db:"outline dropdown_colorful_16_db",dropdown_colorful_16_db_grid_view:"outline dropdown_colorful_16_db_grid_view",dropdown_colorful_16_db_kanban_view:"outline dropdown_colorful_16_db_kanban_view",dropdown_colorful_16_db_gallery_view:"outline dropdown_colorful_16_db_gallery_view",dropdown_colorful_16_db_kanban:"outline dropdown_colorful_16_db_kanban",dropdown_colorful_16_db_todolist:"outline dropdown_colorful_16_db_todolist",dropdown_colorful_16_countdown:"outline dropdown_colorful_16_countdown",dropdown_colorful_16_schedule:"outline dropdown_colorful_16_schedule",dropdown_colorful_16_group_business_card:"outline dropdown_colorful_16_group_business_card",dropdown_colorful_16_markdown:"outline dropdown_colorful_16_markdown",dropdown_colorful_16_third_party:"outline dropdown_colorful_16_third_party",dropdown_colorful_16_share_paragraph_link:"outline dropdown_colorful_16_share_paragraph_link",dropdown_colorful_16_content_protection:"outline dropdown_colorful_16_content_protection",dropdown_colorful_16_content_un_protection:"outline dropdown_colorful_16_content_un_protection",dropdown_colorful_16_color_settings:"outline dropdown_colorful_16_color_settings",dropdown_colorful_16_add_kdocs_todo:"outline dropdown_colorful_16_add_kdocs_todo",dropdown_colorful_16_woa_tpl:"outline dropdown_colorful_16_woa_tpl",intention_collection:"outline intention_collection",hide_table_border:"outline hide_table_border",otl_cloud_32:"outline otl_cloud_32",otl_save_success_32:"outline otl_save_success_32",dropdown_colorful_16_insert_below:"outline dropdown_colorful_16_insert_below",dropdown_colorful_image_properties:"outline dropdown_colorful_image_properties",dropdown_normal_16_frame:"outline dropdown_normal_16_frame",dropdown_normal_16_rotate_90:"outline dropdown_normal_16_rotate_90",dropdown_colorful_16_text_attribute:"outline dropdown_colorful_16_text_attribute 1",dropdown_normal_16_text_bold:"outline dropdown_normal_16_text_bold 1",dropdown_normal_16_text_italic:"outline dropdown_normal_16_text_italic 1",dropdown_normal_16_text_underline:"outline dropdown_normal_16_text_underline 1",dropdown_normal_16_text_del_line:"outline dropdown_normal_16_text_del_line 1",dropdown_colorful_16_copy:"outline dropdown_colorful_16_copy",dropdown_colorful_16_cut:"outline dropdown_colorful_16_cut",dropdown_colorful_16_delete:"outline dropdown_colorful_16_delete",dropdown_colorful_16_paste:"outline dropdown_colorful_16_paste",dropdown_colorful_16_paste_text:"outline dropdown_colorful_16_paste_text",et_full_screen:"outline et_full_screen",linkpanel_copylink:"outline linkpanel_copylink",linkpanel_editlink:"outline linkpanel_editlink",linkpanel_unlink:"outline linkpanel_unlink",otl_cloud_document_comment:"16 otl_cloud_document_comment",otl_cloud_document_preview_view:"16 otl_cloud_document_preview_view",otl_cloud_document_title_view:"16 otl_cloud_document_title_view",otl_cloud_document_link:"16 otl_cloud_document_link",dropdown_arrow_fold:"outline dropdown_arrow_fold",dropdown_arrow_unfold:"outline dropdown_arrow_unfold",otl_doc_menu_loading:"outline otl_doc_menu_loading",font_color_select_white:"outline font_color_select_white",font_color_black:"outline font_color_black",font_color_red:"outline font_color_red",font_color_orange:"outline font_color_orange",font_color_green:"outline font_color_green",font_color_blue:"outline font_color_blue",font_color_lightBlue:"outline font_color_lightBlue",font_color_gray:"outline font_color_gray",font_color_pink:"outline font_color_pink",font_color_gold:"outline font_color_gold",font_color_lightGreen:"outline font_color_lightGreen",font_color_rainbowBlue:"outline font_color_rainbowBlue",font_color_violet:"outline font_color_violet",font_color_pink_orange:"outline font_color_pink_orange",font_color_gold_green:"outline font_color_gold_green",font_color_blue_violet:"outline font_color_blue_violet",font_color_orange_rainbowBlue:"outline font_color_orange_rainbowBlue",font_color_lightBlue_red:"outline font_color_lightBlue_red",font_color_lightGreen_blue:"outline font_color_lightGreen_blue",high_light_color_empty:"outline high_light_color_empty",high_light_color_clear:"outline high_light_color_clear",high_light_color_select_black:"outline high_light_color_select_black",high_light_color_select_black46:"outline high_light_color_select_black46",table_merge_cells:"outline table_merge_cells",table_split_cell:"outline table_split_cell",table_align_center:"outline table_align_center",table_align_left:"outline table_align_left 1",table_align_right:"outline table_align_right",table_insert_left:"outline table_insert_left",table_insert_right:"outline table_insert_right",table_trash:"outline table_trash",table_insert_ahead:"outline table_insert_ahead",table_insert_below:"outline table_insert_below",table_vertical_top:"outline table_vertical_top",table_vertical_middle:"outline table_vertical_middle",table_vertical_bottom:"outline table_vertical_bottom",table_average_column_widths:"outline table_average_column_widths",image_full_screen:"outline image_full_screen",image_border:"outline image_border",image_rotate:"outline image_rotate",picture_caption:"outline picture_caption",image_link:"outline image_link",image_link_placeholder:"outline image_link_placeholder",image_link_more:"outline image_link_more",image_link_open:"outline image_link_open",image_link_edit:"outline image_link_edit",image_link_cancel:"outline image_link_cancel",latex_edit:"outline latex_edit",comment_insert:"outline comment_insert 1",et_comment_insert:"outline et_comment_insert",comment_voice_microphone:"outline comment_voice_microphone",comment_voice_keyboard:"outline comment_voice_keyboard",comment_add:"outline comment_add 1",otl_logo:"outline otl_logo",kdocs_home:"outline kdocs_home",switch_catalog:"outline switch_catalog 1",undo:"outline undo 1",redo:"outline redo 1",cmb_more_btn:"outline cmb_more_btn 1",reduce_indentation:"outline reduce_indentation 1",increase_indentation:"outline increase_indentation 1",todo_list:"outline todo_list 1",numbering:"outline numbering 1",bullet:"outline bullet 1",find:"outline find 1",insert_panel:"outline insert_panel 1",inline_code:"outline inline_code 1",font_sub:"outline font_sub 1",font_sup:"outline font_sup 1",font_highlight:"outline font_highlight 1",font_color:"outline font_color 1",name_more:"outline name_more 1",cancel_lock_block:"outline cancel_lock_block",dialog_close_16:"outline dialog_close_16",link_reload:"outline link_reload",link_open:"outline link_open",double_arrow_left:"outline double_arrow_left",single_arrow_left:"outline single_arrow_left",double_arrow_right:"outline double_arrow_right",single_arrow_right:"outline single_arrow_right",find_panel_close:"outline find_panel_close",play_mode_edit:"outline play_mode_edit",play_mode_checked:"outline play_mode_checked",play_mode_zoom_out:"outline play_mode_zoom_out",play_mode_zoom:"outline play_mode_zoom",play_mode_exit:"outline play_mode_exit",play_mode_btn:"outline play_mode_btn",paperclip:"outline paperclip",close_1:"outline close_1",restore:"outline restore",change:"outline change",say_ai_good:"outline say_ai_good",say_ai_just_so_so:"outline say_ai_just_so_so",ai_heart_occupy:"outline ai_heart_occupy",ai_warning:"outline ai_warning",ai_discard:"outline ai_discard",ai_edit_active:"outline ai_edit_active",ai_more_menu:"outline ai_more_menu",ai_insert:"outline ai_insert",ai_insert_into_content:"outline ai_insert_into_content",like_ai_reply:"outline like_ai_reply",like_ai_reply_active:"outline like_ai_reply_active",unlike_ai_reply:"outline unlike_ai_reply",unlike_ai_reply_active:"outline unlike_ai_reply_active",drop_ai_content:"outline drop_ai_content",ai_assist_icon:"outline ai_assist_icon",abort_ask_ai:"outline abort_ask_ai",ai_menu_button_icon:"outline ai_menu_button_icon",ai_question_send_button:"outline ai_question_send_button",ai_scene_define_button:"outline ai_scene_define_button",ai_fast_entrance_scene_outline:"outline ai_fast_entrance_scene_outline",ai_session_history:"outline ai_session_history",slash_colorful_16_h1:"outline slash_colorful_16_h1",slash_colorful_16_h2:"outline slash_colorful_16_h2",slash_colorful_16_h3:"outline slash_colorful_16_h3",slash_colorful_16_h4:"outline slash_colorful_16_h4",slash_colorful_16_h5:"outline slash_colorful_16_h5",slash_colorful_16_h6:"outline slash_colorful_16_h6",slash_colorful_16_al_video:"outline slash_colorful_16_al_video",slash_colorful_16_bilibili:"outline slash_colorful_16_bilibili",slash_colorful_16_map:"outline slash_colorful_16_map",slash_colorful_16_mock:"outline slash_colorful_16_mock",slash_colorful_16_modao:"outline slash_colorful_16_modao",slash_colorful_16_net_music:"outline slash_colorful_16_net_music",slash_colorful_16_xiaohuozhuo:"outline slash_colorful_16_xiaohuozhuo",slash_colorful_16_figma:"outline slash_colorful_16_figma",slash_colorful_16_mastergo:"outline slash_colorful_16_mastergo",ipad_ai_logo:"outline ai_logo",ipad_comment:"outline ipad_comment",ipad_copy:"outline ipad_copy",ipad_cut:"outline ipad_cut",ipad_delete:"outline ipad_delete",ipad_edit:"outline ipad_edit",ipad_jump_link:"outline ipad_jump_link",ipad_paste:"outline ipad_paste",ipad_select_text_all:"outline ipad_select_text_all",ipad_table_insert:"outline ipad_table_insert",ipad_table_merge_cells:"outline ipad_table_merge_cells",ipad_table_split_cell:"outline ipad_table_split_cell",ipad_average_column_widths:"outline ipad_average_column_widths",ipad_fullscreen:"outline ipad_fullscreen",ipad_reload:"outline ipad_reload",ipad_view_image:"outline ipad_view_image",ipad_image_add_border:"outline ipad_image_add_border",ipad_image_rotate:"outline ipad_image_rotate",ipad_text_align_left:"outline ipad_text_align_left",ipad_text_align_center:"outline ipad_text_align_center",ipad_text_align_right:"outline ipad_text_align_right",ipad_vertical_top:"outline ipad_vertical_top",ipad_vertical_middle:"outline ipad_vertical_middle",ipad_vertical_bottom:"outline ipad_vertical_bottom",ipad_arrow_mouse:"outline ipad_arrow_mouse",ipad_view:"outline ipad_view",save_loading:"outline save_loading",latex_question:"outline latex_question",otl_video:"outline otl_video",code_block_setting_btn_black:"outline code_block_setting_btn_black",code_block_setting_btn_white:"outline code_block_setting_btn_white",code_block_setting_btn_blue:"outline code_block_setting_btn_blue",code_arrow_down_dark:"outline code_arrow_down_dark",code_arrow_down_light:"outline code_arrow_down_light",code_arrow_up:"outline code_arrow_up",kd_logo_origin:"outline kd_logo_origin",catalog_pin:"outline catalog_pin",catalog_pin_active:"outline catalog_pin_active",loading_white:"outline loading_white",page_zoom_plus:"outline page_zoom_plus 1",page_zoom_plus_default:"outline page_zoom_plus_default 1",page_zoom_minus:"outline page_zoom_minus 1",page_zoom_minus_default:"outline page_zoom_minus_default 1",otl_cover_placeholder:"outline otl_cover_placeholder",otl_random:"outline otl_random",otl_refresh:"outline otl_refresh",otl_no_third_party_pic:"outline otl_no_third_party_pic",otl_empty_gallery:"outline otl_empty_gallery",notice_detail_question:"outline notice_detail_question"},other:{topbar_history:"other topbar_history 1",topbar_at_in_box:"other topbar_at_in_box 1",toast_wrong:"other toast_wrong 1",toast_message:"other toast_message 1",toast_ok:"other toast_ok 1",application:"other application 1",meeting_launch:"other meeting_launch 1",helper:"other helper 1",koa_chat:"other koa_chat 1",voice_telephone:"other voice_telephone 1",checked:"other checkbox 1",checkbox_s:"other checkbox_s 1",checkbox_k:"other checkbox_k 1",checkbox_w:"other checkbox_w 1",checkbox_p:"other checkbox_p 1",checkbox_f:"other checkbox_f 1",checkbox_system:"other checkbox_system 1",ksheet_cooper:"other ksheet_cooper 1",text_hold_up:"other text_hold_up 1",text_hold_down:"other text_hold_down 1",checkbox_select:"other checkbox_select 1",checkbox_normal:"other checkbox_normal 1",comment_tip_add_active:"other comment_tip_add_active",comment_tip_add_normal:"other comment_tip_add_normal 1",comment_tip_add_normal_black:"other comment_tip_add_normal_black 1",comment_emoji_tip_add_active:"other comment_emoji_tip_add_active 1",comment_emoji_tip_add_normal:"other comment_emoji_tip_add_normal 1",comment_emoji_tip_add_normal_black:"other comment_emoji_tip_add_normal_black 1",checkbox_done:"other checkbox_done 1",highlight_play:"other highlight_play 1",highlight_pdf_play:"other highlight_pdf_play 1",otl_highlight_play:"other otl_highlight_play 1",otl_cover_pic_fail:"other otl_cover_pic_fail 1",otl_play:"other otl_play 1",otl_play_default:"other otl_play_default 1",otl_width_standard:"other otl_width_standard 1",otl_width_self_adaptive:"other otl_width_self_adaptive 1",otl_fullwidth:"other otl_fullwidth 1",otl_fullwidth_default:"other otl_fullwidth_default 1",select_white:"other select_white 1",indeterminate:"other indeterminate 1",publish:"other publish",tip_warning:"other tip_warning",error_page:"other error_page",stop_publish:"other stop_publish",file_too_large:"other file_too_large",_404:"other 404",file_error:"other error",dropdown:"other Arrow",arrow_left:"other Arrow_left",arrow_right:"other Arrow_right",dropdown_triangle_15:"other dropdown_triangle_15",dropdown_triangle_17:"other dropdown_triangle_17",dropdown_triangle_19:"other dropdown_triangle_19",dropdown_triangle_21:"other dropdown_triangle_21",dropdown_triangle_23:"other dropdown_triangle_23",dropdown_triangle_25:"other dropdown_triangle_25",session_full:"other session_full",no_permission:"other no_permission",drag_right_bottom:"other drag_bar",arrow_collapse:"other arrow_collapse",arrow_expand:"other arrow_expanding",new_empty_et:"other new_empty_et",new_empty_ksheet:"other new_empty_ksheet",new_empty_wps:"other new_empty_wps",new_empty_wpp:"other new_empty_wpp",view_eye:"other view_eye",type_icon_et:"other type_icon_et",type_icon_wps:"other type_icon_wps",type_icon_wpp:"other type_icon_wpp",cooper_history_expand:"other Unfold2",timeline_arrow_open:"other Unfold4",timeline_arrow_close:"other Unfold3",cooper_history_news:"other news",arrow_left_2:"other arrow_left_2",arrow_right_2:"other arrow_right_2",close_2:"other close_2",Newline:"other Newline",tab:"other tab",coopShare:"other list_share",collapse:"other buttom_arrow",shareList:"other list_arrow",cooperation_write:"other cooperation_write",avatar_default:"other avatar_default",from_scratch:"other from_scratch",from_active:"other from_active",increase_line:"other increase_line",delete_row:"other delete_row",delete:"other delete",adjust_column:"other adjust_column",adjust_table:"other adjust_table",vertical_center:"other table_vertical_center",menu_arrow:"other table_menu_arrow",menu_arrow_selected:"other table_menu_arrow_white",wps_table_menu:"other wps_table_menu",wps_table_menu_hover:"other wps_table_menu_hover",wps_table_menu_highlight:"other wps_table_menu_highlight",column_row_add:"other column_row_add",column_row_remove:"other column_row_remove",k_color_clean:"other k_color_clean",wps_webshape_iframe_error:"other wps_webshape_iframe_error",blue_table_1:"other blue_table_1",blue_table_2:"other blue_table_2",blue_table_3:"other blue_table_3",blue_table_4:"other blue_table_4",dark_table_1:"other dark_table_1",dark_table_2:"other dark_table_2",dark_table_3:"other dark_table_3",dark_table_4:"other dark_table_4",green_table_1:"other green_table_1",green_table_2:"other green_table_2",green_table_3:"other green_table_3",green_table_4:"other green_table_4",purple_table_1:"other purple_table_1",purple_table_2:"other purple_table_2",purple_table_3:"other purple_table_3",purple_table_4:"other purple_table_4",yellow_table_1:"other yellow_table_1",yellow_table_2:"other yellow_table_2",yellow_table_3:"other yellow_table_3",yellow_table_4:"other yellow_table_4",default_table_0:"other default_table_0",default_table_5:"other default_table_5",hyper_link_url:"other hyper_link_url",hyper_link_image:"other hyper_link_image",comment_tip:"other comment_tip",zoom_in:"other zoom_in",zoom_out:"other zoom_out",original_size:"other original_size",maximum_size:"other maximum_size",download:"other download",nextImage:"other nextImage",lastImage:"other lastImage",close:"other close",info:"other info",wpsUnderlineNone:"other wpsUnderlineNone",wpsUnderlineSingle:"other wpsUnderlineSingle",wpsUnderlineDouble:"other wpsUnderlineDouble",wpsUnderlineDotted:"other wpsUnderlineDotted",wpsUnderlineThick:"other wpsUnderlineThick",wpsUnderlineDash:"other wpsUnderlineDash",wpsUnderlineDotDash:"other wpsUnderlineDotDash",wpsUnderlineDotDotDash:"other wpsUnderlineDotDotDash",wpsUnderlineWavyHeavy:"other wpsUnderlineWavyHeavy",wpsUnderlineDottedHeavy:"other wpsUnderlineDottedHeavy",wpsUnderlineDashHeavy:"other wpsUnderlineDashHeavy",wpsUnderlineDotDashHeavy:"other wpsUnderlineDotDashHeavy",wpsUnderlineDotDotDashHeavy:"other wpsUnderlineDotDotDashHeavy",wpsUnderlineDashLong:"other wpsUnderlineDashLong",wpsUnderlineDashLongHeavy:"other wpsUnderlineDashLongHeavy",wpsUnderlineWavyDouble:"other wpsUnderlineWavyDouble",wpsUnderlineWavy:"other wpsUnderlineWavy",back:"other back",public_qrcode:"other public_qrcode",file_et:"other file_et",file_wps:"other file_wps",file_wpp:"other file_wpp",file_pdf:"other file_pdf",edit_no_lock:"other edit_no_lock",tmp_more:"other tmp_more",play_from_active:"other play_from_active",meeting_tips:"other meeting_tips",meeting_tips_close:"other meeting_tips_close",color_empty_round:"other color_empty_round",duplicate_remove:"other duplicate_remove",insert_line_group_geomerty:"other insert_line_group_geomerty",insert_rectangle_group_geomerty:"other insert_rectangle_group_geomerty",insert_normal_group_geomerty:"other insert_normal_group_geomerty",insert_arrow_group_geomerty:"other insert_arrow_group_geomerty",insert_formual_group_geomerty:"other insert_formual_group_geomerty",insert_process_group_geomerty:"other insert_process_group_geomerty",insert_startandflag_group_geomerty:"other insert_startandflag_group_geomerty",insert_callout_group_geomerty:"other insert_callout_group_geomerty",insert_action_group_geomerty:"other insert_action_group_geomerty",ink_hand_rect:"other ink_hand_rect",ink_geo_rect:"other ink_geo_rect",ink_hand_star:"other ink_hand_star",ink_geo_star:"other ink_geo_star",ink_hand_para:"other ink_hand_para",ink_geo_para:"other ink_geo_para",ink_hand_line:"other ink_hand_line",ink_geo_line:"other ink_geo_line",ink_hand_circle:"other ink_hand_circle",ink_geo_circle:"other ink_geo_circle",ink_hand_triangle:"other ink_hand_triangle",ink_geo_triangle:"other ink_geo_triangle",ink_hand_diamond:"other ink_hand_diamond",ink_geo_diamond:"other ink_geo_diamond",ink_hand_arrow:"other ink_hand_arrow",ink_geo_arrow:"other ink_geo_arrow",ink_arrow:"other ink_arrow",wpp_line_end_type:"other wpp_line_end_type",wps_line_end_type:"other wps_line_end_type",time_out:"other time_out",explain_empty:"other explain_empty",wpp_new_empty_slide:"other wpp_new_empty_slide",hot:"other hot",no_picture:"other no_picture",helper_new_msg:"other helper_new_msg",et_col_more:"other et_col_more",et_col_more_dark:"other et_col_more_dark",sequence1:"other sequence1",sequence2:"other sequence2",sequence3:"other sequence3",sequence4:"other sequence4",sequence5:"other sequence5",sequence6:"other sequence6",sequence7:"other sequence7",sequence8:"other sequence8",sequence9:"other sequence9",numbering_symbol1:"other numbering_symbol1",numbering_symbol2:"other numbering_symbol2",numbering_symbol3:"other numbering_symbol3",numbering_symbol4:"other numbering_symbol4",numbering_symbol5:"other numbering_symbol5",numbering_symbol6:"other numbering_symbol6",numbering_symbol7:"other numbering_symbol7",symbol1:"other symbol1",symbol2:"other symbol2",symbol3:"other symbol3",symbol4:"other symbol4",symbol5:"other symbol5",symbol6:"other symbol6",symbol7:"other symbol7",bullets_symbol1:"other bullets_symbol1",bullets_symbol2:"other bullets_symbol2",bullets_symbol3:"other bullets_symbol3",bullets_symbol4:"other bullets_symbol4",bullets_symbol5:"other bullets_symbol5",bullets_symbol6:"other bullets_symbol6",bullets_symbol7:"other bullets_symbol7",symbol_mult_1:"other symbol_mult_1",symbol_mult_2:"other symbol_mult_2",symbol_mult_3:"other symbol_mult_3",symbol_mult_4:"other symbol_mult_4",symbol_mult_5:"other symbol_mult_5",symbol_mult_6:"other symbol_mult_6",symbol_mult_7:"other symbol_mult_7",sequence_mult_1:"other sequence_mult_1",sequence_mult_2:"other sequence_mult_2",sequence_mult_3:"other sequence_mult_3",sequence_mult_4:"other sequence_mult_4",sequence_mult_5:"other sequence_mult_5",sequence_mult_6:"other sequence_mult_6",sequence_mult_7:"other sequence_mult_7",sequence_mult_8:"other sequence_mult_8",sequence_mult_9:"other sequence_mult_9",sequence_mult_10:"other sequence_mult_10",woa_chat:"other woa_chat 1",db_none_group:"other none_group",db_book_no_access:"other db_book_no_access",comment_panel_not_cmt:"other comment_panel_not_cmt",comment_panel_not_resolve_cmt:"other comment_panel_not_resolve_cmt",et_to_db:"other et_to_db",db_none_record:"other db_none_record",db_card_no_note:"other db_card_no_note",db_field_note_tip:"other db_field_note_tip",db_field_link_tip:"other db_field_link_tip",db_field_lookup_tip:"other db_field_lookup_tip",db_link_delete:"other db_link_delete",divider_right:"other divider_right",db_no_history:"other db_no_history",db_flash:"other db_flash",db_date_banner:"other db_date_banner",db_gantt_warn:"other db_gantt_warn",db_none_query_result:"other db_none_query_result",db_dropdown:"other db_dropdown",db_video_viewer_error:"other db_video_viewer_error",db_empty_chart:"other db_empty_chart",db_chart_invalid:"other db_chart_invalid",db_basic_bar:"other db_basic_bar",db_basic_line:"other db_basic_line",db_horiz_bar:"other db_horiz_bar",db_basic_pie:"other db_basic_pie",db_value:"other db_value",k_sheet_db_dropdown:"other k_sheet_db_dropdown",ksheet_et_share_confirm:"other ksheet_et_share_confirm",k_arrow_down_white:"other k_arrow_down_white",otl_playbar_plus:"other otl_playbar_plus",otl_playbar_minus:"other otl_playbar_minus",otl_switch_catalog:"other otl_switch_catalog",otl_cloud:"other otl_cloud",otl_catalog_arrow:"other otl_catalog_arrow",otl_catalog_arrow_hover:"other otl_catalog_arrow_hover",otl_catalog_pin_active:"other otl_catalog_pin_active",otl_moremenu:"other otl_moremenu 1",otl_at_in_box:"other otl_at_in_box",otl_woa:"other otl_woa",otl_meetings:"other otl_meetings",otl_message:"other otl_message",otl_logo:"other otl_logo",otl_arrow_down:"other otl_arrow_down",et_icon_30:"other et_icon_30",office_icon_30:"other office_icon_30",pdf_touch_scroll:"other pdf_touch_scroll",emotion_hate:"other emotion_hate",emotion_dislike:"other emotion_dislike",emotion_neutral:"other emotion_neutral",emotion_like:"other emotion_like",emotion_love:"other emotion_love",new_tag:"other new_tag",weboffice:"other weboffice",video_play_large:"other video_play_large",video_replay:"other video_replay",nonsupport_video:"other nonsupport_video",nonsupport_video_in_template:"other nonsupport_video_in_template",video_no_permission:"other video_no_permission",video_load_fail:"other video_load_fail",video_loading:"other video_loading",pdf_anno_list_right_empty:"other pdf_anno_list_right_empty",ksheet_invalid_page:"other invalid_page",ksheet_db_pic_placeholder:"other ksheet_db_pic_placeholder",k_app_local:"other k_app_local",ksheet_app_close:"other ksheet_app_close",k_logo:"other k_logo",k_keyboard_mark:"other k_keyboard_mark",k_keyboard_backslash:"other k_keyboard_backslash",k_keyboard_semicolon:"other k_keyboard_semicolon",k_keyboard_bracket:"other k_keyboard_bracket",k_portrait:"other k_portrait",k_landscape:"other k_landscape",k_allColPage:"other k_allColPage",k_allRowPage:"other k_allRowPage",k_inPage:"other k_inPage",k_color_select_white:"other k_color_select_white",k_color_select_black:"other k_color_select_black",k_et_icon:"other k_et_icon",ksheet_switch_catalog:"other ksheet_switch_catalog",ksheet_moremenu:"other ksheet_moremenu",ksheet_db_none_query_result:"other ksheet_db_none_query_result",scrollbar_left_arrow:"other scrollbar_left_arrow",template_btn:"other template_btn",template_btn_hover:"other template_btn_hover",pivot_move:"other pivot_move",air_flow_print_fullscreen:"other air_flow_print_fullscreen",air_flow_print_quit_fullscreen:"other air_flow_print_quit_fullscreen",air_flow_no_script:"other air_flow_no_script",air_flow_maximize:"other air_flow_maximize",air_flow_restore_window:"other air_flow_restore_window"},voice:{voiceNormal:"other voiceNormal",transform:"other transform",transform_hot:"other transform_hot",loading:"24 loading",comment_alert:"other comment_alert"},text_style:{title1:"text_style text_style1",title2:"text_style text_style2",title3:"text_style text_style3",title4:"text_style text_style4",title5:"text_style text_style5"},separator_line:{line_single:"separator_line line_single",line_dot:"separator_line line_dot",line_dash_small_gap:"separator_line line_dash_small_gap",line_dash_large_gap:"separator_line line_dash_large_gap",line_dash_dot:"separator_line line_dash_dot",line_dash_dot_dot:"separator_line line_dash_dot_dot",line_double:"separator_line line_double",line_triple:"separator_line line_triple",line_thin_thick_small_gap:"separator_line line_thin_thick_small_gap",line_thick_thin_small_gap:"separator_line line_thick_thin_small_gap",line_thin_thick_thin_small_gap:"separator_line line_thin_thick_thin_small_gap",line_thin_thick_med_gap:"separator_line line_thin_thick_med_gap",line_thick_thin_med_gap:"separator_line line_thick_thin_med_gap",line_thin_thick_thin_med_gap:"separator_line line_thin_thick_thin_med_gap",line_thin_thick_large_gap:"separator_line line_thin_thick_large_gap",line_thick_thin_large_gap:"separator_line line_thick_thin_large_gap",line_thin_thick_thin_large_gap:"separator_line line_thin_thick_thin_large_gap",line_single_wavy:"separator_line line_single_wavy",line_double_wavy:"separator_line line_double_wavy",line_dash_dot_stroked:"separator_line line_dash_dot_stroked",line_emboss_3D:"separator_line line_emboss_3D",line_engrave_3D:"separator_line line_engrave_3D"},summary:{share:"summary share",pdf:"summary pdf",print:"summary print",picture:"summary picture",modal_bg:"summary modal_bg",feedback:"summary feedback",step1:"summary step1",step2:"summary step2",step3:"summary step3",wrong:"summary wrong",right:"summary right",checked:"summary checked",logo:"summary logo"},context:{copy:"context copy",cut:"context cut",paste:"context paste",k_copy:"context k_copy",k_cut:"context k_cut",k_paste:"context k_paste",paste_text:"context paste_text",share:"context share",convense:"context convense",hyperlink:"context hyperlink",link_edit:"context link_edit",link_delete:"context link_delete",insert_bookmark:"context insert_bookmark",hyperlink_more:"context hyperlink_more",change_img:"context change_img",save_img:"context save_img",img_org_src:"context img_org_src",insert_row_col:"context insert_row_col",delete_row_col:"context delete_row_col",insert_top_row:"context insert_top_row",insert_bottom_row:"context insert_bottom_row",insert_left_col:"context insert_left_col",insert_right_col:"context insert_right_col",delete_row:"context delete_row",delete_col:"context delete_col",delete_table:"context delete_table",font:"context font",paragraph_bar_insert_below:"context paragraph_bar_insert_below",paragraph_bar_image_operate:"context paragraph_bar_image_operate",paragraph_bar_text_attr:"context paragraph_bar_text_attr",paragraph_bar_object_attr:"context set_object_block_style",dashed_border:"context dashed_border"}}},2849:function(e,t,n){"use strict";function i(e){var t={};if(9===e.length){t.hex="#"+e.substring(3);var n=parseInt(e.substring(1,3),16);t.trans=Math.round(100*(255-n)/255)}else t.hex=e,t.trans=100;return t}function a(e,t){var n=Math.round(255*(100-t)/100).toString(16);n.length<2&&(n="0"+n);var i=e.substring(1);return 1===i.length?i="00000"+i:i.length>6&&(i=i.substring(i.length-6)),"#"+n+i}function o(e){var t=0,n=0,i=0,a=0;return 9===e.length?(t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),a=parseInt(e.substring(7),16)):8===e.length?(t=parseInt(e.substring(1,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),a=parseInt(e.substring(6),16)):7===e.length&&(n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),a=parseInt(e.substring(5),16),t=0),{a:t,r:n,g:i,b:a}}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},2856:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var i={DEFAULT:"DEFAULT",SELECTION:"SELECTION",TEXT:"TEXT",WATER_DROP:"WATER_DROP",TASK_LIST:"TASK_LIST",TABLE_TEXT:"TABLE_TEXT",TABLE_HYPERLINK:"TABLE_HYPERLINK",TABLE_ROW_SELECT:"TABLE_ROW_SELECT",TABLE_COLUMN_SELECT:"TABLE_COLUMN_SELECT",TABLE_SELECT:"TABLE_SELECT",SHAPE:"SHAPE",SHAPE_RESIZE_TL:"SHAPE_RESIZE_TL",SHAPE_RESIZE_TM:"SHAPE_RESIZE_TM",SHAPE_RESIZE_TR:"SHAPE_RESIZE_TR",SHAPE_RESIZE_RM:"SHAPE_RESIZE_RM",SHAPE_RESIZE_BR:"SHAPE_RESIZE_BR",SHAPE_RESIZE_BM:"SHAPE_RESIZE_BM",SHAPE_RESIZE_BL:"SHAPE_RESIZE_BL",SHAPE_RESIZE_LM:"SHAPE_RESIZE_LM",HYPERLINK:"HYPERLINK",TEXTFRAME:"TEXTFRAME",TEXTBOX_PAGE:"TEXTBOX_PAGE",SWIPEABLE_MATH:"SWIPEABLE_MATH"},a={TEXT:[i.WATER_DROP,i.TEXT,i.TABLE_TEXT,i.TASK_LIST,i.HYPERLINK,i.TABLE_HYPERLINK,i.TEXTBOX_PAGE,i.TEXTFRAME,i.SWIPEABLE_MATH]}},2857:function(e,t,n){var i=n(1312)(n(474),"Map");e.exports=i},300:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}},302:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=function(){function e(){a()(this,e)}return r()(e,null,[{key:"rgbIntToHexStr",value:function(t){var n=e.storeHex.get(t);if(n)return n;if("number"!=typeof t)return"";var i=t.toString(16).toUpperCase();return i.length<"000000".length&&(i="000000".slice(i.length)+i),e.storeHex.set(t,"#"+i),"#"+i}},{key:"extractLiteral",value:function(t){var n=e.storeExtra.get(t);if(n)return n;var i={red:parseInt(t.substr(1,2),16),green:parseInt(t.substr(3,2),16),blue:parseInt(t.substr(5,2),16)};return e.storeExtra.set(t,i),i}},{key:"hexStrToRgbInt",value:function(e){return e=e.replace("#","0x"),parseInt(e)}},{key:"argbIntToHexStr",value:function(e){if("number"!=typeof e)return"";var t=(e&=16777215).toString(16).toUpperCase();return t.length<"000000".length&&(t="000000".slice(t.length)+t),"#"+t}},{key:"hexStrToArgbInt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return console.assert(t>=0&&t<=255),e=e.replace("#","0x"+t.toString(16)),parseInt(e)}},{key:"rgbIntToRgbStr",value:function(e){return[e>>16&255,e>>8&255,255&e].join(",")}},{key:"hexToRgbStr",value:function(t){var n=e.hexStrToRgbInt(t);return e.rgbIntToRgbStr(n)}},{key:"rgbObjToHexStr",value:function(e){var t=e.red<<16|e.green<<8|e.blue;return this.rgbIntToHexStr(t)}},{key:"compareThemeColor",value:function(e,t){return void 0===e&&void 0===t||void 0!==e&&void 0!==t&&e.get()===t.get()}},{key:"middleHexColor",value:function(e,t){e=e.substr(1),t=t.substr(1);for(var n=[e.substr(0,2),e.substr(2,2),e.substr(4,2)],i=[t.substr(0,2),t.substr(2,2),t.substr(4,2)],a=[],o=0;o<n.length;o++){var r=parseInt(n[o],16)+parseInt(i[o],16);1===(r=parseInt(r/2).toString(16)).length&&(r="0"+r),a.push(r.toUpperCase())}return"#"+a.join("")}},{key:"blendColor",value:function(e,t){var n=this.hexStrToRgbInt(e),i=this.hexStrToRgbInt(t),a=void 0;if(0===n)return a=this.rgbObjToHexStr({red:66,green:73,blue:90}),a;var o=.67*(n>>16&255)+.33*(i>>16&255)&255,r=.65*(n>>8&255)+.35*(i>>8&255)&255,s=.67*(255&n)+.33*(255&i)&255;return a=this.rgbObjToHexStr({red:o,green:r,blue:s}),a}},{key:"reverseAlphaBlend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6,n=this.hexStrToRgbInt(e),i=n>>16&255,a=n>>8&255,o=255&n,r=1/(1-t);return i=r*(i-255*t),a=r*(a-255*t),o=r*(o-255*t),this.rgbObjToHexStr({red:i,green:a,blue:o})}},{key:"checkLightColor",value:function(e){var t=(e=e.replace("rgb(","").replace(")","")).split(",");return.299*t[0]+.587*t[1]+.114*t[2]>=192}}]),e}();s.storeHex=new Map,s.storeExtra=new Map,t.default=s},3036:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var i=3,a=4,o=5},3037:function(e,t,n){"use strict";n.r(t),n.d(t,"addWhiteBottomColor",(function(){return c})),n.d(t,"ImageType",(function(){return u})),n.d(t,"getImageType",(function(){return d})),n.d(t,"ImageSrcStatus",(function(){return h})),n.d(t,"getImageList",(function(){return f})),n.d(t,"getImageSize",(function(){return g}));var i=n(8),a=n.n(i),o=n(24),r=n.n(o),s=n(309),l=n(1980);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blob";return new Promise((function(n,i){var a=document.createElement("canvas"),o="object"===(void 0===e?"undefined":r()(e)),s=e;o&&(s=URL.createObjectURL(e));var l=new Image;l.onload=function(e){var i=l.naturalHeight,r=l.naturalWidth;a.width=r,a.height=i;var c=a.getContext("2d");c.fillStyle="#ffffff",c.fillRect(0,0,a.width,a.height),c.drawImage(e.target,0,0),o&&URL.revokeObjectURL(s),"blob"===t?a.toBlob((function(e){return n(e)})):"base64"===t&&n(a.toDataURL())},l.onerror=function(){i("promise reject: add white bottom color: load image error")},l.src=s}))}var u={PNG:"png",JPEG:"jpeg",GIF:"gif",BMP:"bmp",TIFF:"tiff",SVG:"svg",WEBP:"webp",EMF:"emf",WMF:"wmf",UNDEFINED:"undefined"};function d(e){return new Promise((function(t,n){var i=new FileReader;i.onload=function(e){try{var i=new DataView(e.target.result).getUint32(0,!1),a=Number(i).toString(16).toUpperCase();switch(a){case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFED":case"FFD8FFE8":case"FFD8FFDB":t(u.JPEG);break;case"89504E47":t(u.PNG);break;case"3C3F786D":t(u.SVG);break;case"52494646":t(u.WEBP);break;case"47494638":t(u.GIF);break;case"424D0E68":t(u.BMP);break;case"4D4D002A":case"4D4D002B":case"49492A00":t(u.TIFF);break;case"01000000":t(u.EMF);break;case"01000900":case"D7CDC69A":t(u.WMF);break;default:return 0===a.indexOf("424D")?t(u.BMP):0===a.indexOf("492049")?t(u.TIFF):t("UNDEFINED")}}catch(e){console.log(e),n("unsupported file type")}},i.readAsArrayBuffer(e)}))}var h={UNLOAD:"unload",LOADING:"loading",LOADED:"loaded",FAILED:"failed"};function p(e,t){var n=e.pos,i=e.len,o=[];function r(e){var n=e.shapeData,i=n.shapeType,r=n.shapeTreeType,s=n.textRange,c=n.shapeId,u=n.extData,d=n.picture;if(Object(l.a)(e.shapeData)){var f={shapeId:c,shapeTreeType:r,shapeType:i,comparePos:e.pos,pos:e.pos,originalSrcStatus:h.UNLOAD,srcStatus:h.UNLOAD,key:r+"-"+c,url:"",isProcesson:!!u&&u.isProcessOn,fileId:u&&u.isProcessOn&&u.fileId};void 0!==t&&(f.comparePos=t),d&&d.blip&&d.blip.blipAtom&&(f.imageWidth=d.blip.blipAtom.imageWidth||0,f.imageHeight=d.blip.blipAtom.imageHeight||0),o.push(f)}else s&&!window.APP.isMobileMode()&&o.push.apply(o,a()(p(s,e.pos)))}var s=window.APP.data.doc.inlineAnchors.rangeClass.collectRanges(n,i),c=window.APP.data.doc.anchors.rangeClass.collectRanges(n,i);return s.forEach(r),c.forEach(r),o}function f(e){var t=void 0;t=window.APP.data.selection.selContext.isInHeaderFooter?s.HeaderFooter:s.MainText;var n=window.APP.data.doc.getSubDocRange(t),i=p({pos:n.pos,len:n.len});if(t===s.MainText){var a=window.APP.data.doc.getSubDocRange(s.Footnote);i=i.concat(p(a));var o=window.APP.data.doc.getSubDocRange(s.Endnote);i=i.concat(p(o))}return i.sort((function(e,t){return e.comparePos-t.comparePos})),i}function g(e){return new Promise((function(t,n){var i=new Image;i.src=e,i.onload=function(){t({width:i.width,height:i.height})},i.onerror=n}))}},3092:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(654),l=function(){function e(){a()(this,e),this._copyTicket=null,this._querying=!1,this._notifyInfo=null,this._imageHost="",this._x_doc_header="",this.init()}return r()(e,[{key:"init",value:function(){var e=this;if(!this._copyTicket&&!this._querying){var t="/api/v3/office/file/"+window.urlFileId+"/copy/ticket",n=window.__WPSENV__.request({method:"GET",url:t});this._querying=!0,n.end().then((function(t){for(var n=t.responseHeaders.trim().split(/[\r\n]+/),i=n.length-1;i>0;i--){var a=n[i].split(": ");if("x-doc-header"===a[0].toLowerCase()){e._x_doc_header=a[1];break}}e._querying=!1,200===t.status?(e._copyTicket=t.body.copy_ticket,e._imageHost=t.body.image_hosting):console.error("ERR_GET_COPY_TICKET",t.status)})).catch((function(e){console.log(e)}))}return this._copyTicket}},{key:"generateUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._copyTicket)return console.error("ERR_NO_COPY_TICKET"),"";if(!e)return"";this._notifyInfo||(this._notifyInfo={ticket:this._copyTicket,objects:[]});var n=e,i=this.getImageUrlPrePostfix(),a=""+i.urlPrefix+n+i.urlPostfix;console.log("📌[ShapeCopy] ",a);var o=this._notifyInfo.objects.some((function(e){return e.attach_id===n})),r=t&&t.type?t.type:"image";return o||this._notifyInfo.objects.push({attach_id:n,object_type:r,object:e}),a}},{key:"getImageUrlPrePostfix",value:function(){var e=window.__CONFIG__.pathPrefix||"",t=this._imageHost?""+this._imageHost+e+"/"+this._copyTicket+"/attach/object/":""+window.location.origin+e+"/api/v3/office/copy/"+this._copyTicket+"/attach/object/",n=Object(s.default)("weboffice_branch"),i=this._x_doc_header.replace(/,/g,"&");return{urlPrefix:t,urlPostfix:n?"?weboffice_branch="+n+"&"+i:"?"+i}}},{key:"update",value:function(e){if(window.__WPSENV__.file_info&&window.__WPSENV__.file_info.user&&window.__WPSENV__.file_info.user.isLogin&&this._notifyInfo&&this._notifyInfo.objects.length>0){var t="/api/v3/office/copy/"+this._copyTicket+"/attach/object";window.__WPSENV__.request({method:"POST",url:t,body:this._notifyInfo}).end().then((function(t){console.log("📌[ShapeCopy] NotifyServer:",t&&t.body),e&&t&&t.body&&"ok"===t.body.result&&e()}))}this._notifyInfo=null}},{key:"getXDocHeader",value:function(){return this._x_doc_header}}]),e}();t.default=l},312:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=(n(1530),n(238)),h=n.n(d),p=n(250),f=n.n(p),g=n(248),v=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.refWrap=h.a.createRef(),o=n,l()(i,o)}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){}},{key:"getElement",value:function(){return this.refWrap.current}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.selected,a="component-icon-btn";return e.isDropdown&&(a+=" dropdown"),n&&(a+=" disabled"),i&&(a+=" selected"),e.showBorder&&(a+=" show-border"),t&&(a+=" "+t),a}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.disabled,i=e.title,a=e.iconType,o=e.keepEdit,r=e.altHintKeep,s=e.altForceDirection,l=e.altHintEvent,c=e.altRenderDelay,u=e.altScPosition,d=e.onClick,p=e.onDoubleClick,v=e.onMouseEnter,y=e.onMouseLeave;n&&(d=void 0,p=void 0);var m=this.getClassName();return h.a.createElement(f.a,{title:i,onMouseEnter:v,onMouseLeave:y},h.a.createElement("div",{ref:this.refWrap,id:t,className:m,"data-keep-edit":o||void 0,onClick:d,onDoubleClick:p,role:"button","alt-hint-keep":r,"alt-hint-event":l,"alt-render-delay":c,"alt-sc-position":u,"alt-force-direction":s},h.a.createElement(g.default,{type:a})))}}]),t}(d.PureComponent);v.iconTypes=g.default.types,t.default=v},3282:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l}));var i=0,a=1,o=2,r=3,s=4,l=5},3283:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return v}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(772),l=n(411),c=n(324);function u(e,t){return!!(Math.abs(t-e)<=1&&t&&e)}var d=function(){function e(t,n){a()(this,e),this.maxBottomMargin=t,this.btmSpacingExtend=n}return r()(e,[{key:"calcOffset",value:function(e,t){var n=t.cell_page;if(n){var i=t.layers,a=0;if(i&&(a+=i.bottomCards&&i.bottomCards.length||0,a+=i.topCards&&i.topCards.length||0,a+=i.textframes&&i.textframes.length||0),t.align_type===s.a.TOP||a>0)t.cell2page_offset.y=0;else{var o=t.cell2page_offset.y,r=0;if(n.lines.length>0){var l=n.lines[n.lines.length-1];r=l.rect.bottom+l.after_space}var c=0;0!=e&&(c=e-this.btmSpacingExtend-this.maxBottomMargin-n.rect.top),r<=c?t.align_type===s.a.Center?u((c-r)/2,t.cell2page_offset.y)||(t.cell2page_offset.y=(c-r)/2):u(c-r,t.cell2page_offset.y)||(t.cell2page_offset.y=c-r):t.cell2page_offset.y=0,t.cell2page_offset.y!==o&&n.renderInfo&&(n.renderInfo.moved=!0,t.parent.renderInfo.expired=!0)}}}}]),e}(),h=function(){function e(){a()(this,e)}return r()(e,null,[{key:"getTableTopGap",value:function(e){return Math.max(e.maxTopMargin,e.maxTopBorder)}},{key:"getTableTopSpacing",value:function(t){var n=t.spacing;return e.isFirstTableLine(t)&&(n+=t.spacing),n}},{key:"isFirstTableLine",value:function(e){var t=e.parent;return 0===t.lines.length||t.lines[t.lines.length-1].layoutType===l.DOCLayoutType.TableLine}},{key:"findBreakLine",value:function(e,t){var n=t.prev;if(!e||!n||0===n.lines.length)return null;if(e.parent!==t){if(!e.isBrokenAfter)return null}else if(!e.isBrokenBefore)return null;var i=null,a=n.lines.length-1;do{var o=n.lines[a];if(o.layoutType!==l.DOCLayoutType.TableLine)break;if(!o.isBrokenAfter)break;if(e.parent===t&&o.range.end===e.range.end)break;i=o,--a}while(a>=0);return i}}]),e}();function p(e,t){var n=t.parent;if(0===n.lines.length)return null;var i=n.lines.findIndex((function(e){return e===t}));-1===i&&(i=n.lines.length-1);for(var a=i;a>=0;--a){var o=n.lines[a];if(o.layoutType!==l.DOCLayoutType.TableLine)break;for(var r=!1,c=0;c<o.tablecells.length;++c){var u=o.tablecells[c];if(e>=u.rect.left&&e<u.rect.right){if(r=!0,u.merge_type===s.e.FIRST)return u;u.merge_type===s.e.NONE&&(r=!1);break}if(e<u.rect.left)break}if(!1===r)break}return null}function f(e){return e.isTableLast?e.maxBottomBorder+2*e.spacing:e.spacing}function g(e,t){for(var n=e.tablecells,i=e.renderInfo&&e.renderInfo.height!==e.rect.height,a=0;a<n.length;++a){var o=n[a];if((e.isTableLast||t)&&o.merge_type!==s.e.NONE||o.merge_type===s.e.LAST){var r;if(!(r=p(o.rect.left,e))||!r.cell_page&&!r.diagCell||r.cell_page&&r.cell_page.prev)continue;var l=r.parent;if(!l.renderInfo||e.renderInfo&&!i||(l.renderInfo.moved=!0),r.align_type===s.a.TOP)continue;var c=e.rect.bottom-l.rect.top;new d(e.maxBottomMargin,f(e)).calcOffset(c,r)}}}function v(e,t,n,i){if(e>0&&e===t.lines.length-1){var a=t.lines[e-1];if(a.layoutType===l.DOCLayoutType.TableLine||a.layoutType===l.DOCLayoutType.SnippetLine&&!i){var o=t.lines[e];if(1===o.range.len)if(n.glyphBuff.getCharCode(o.range.pos)===c.l)return!0}}return!1}},3400:function(e,t,n){var i=n(4424),a=n(5336),o=n(3936);e.exports=function(e){return o(e)?i(e):a(e)}},3401:function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3402:function(e,t){e.exports=function(e){return function(t){return e(t)}}},3426:function(e,t,n){"use strict";n.d(t,"b",(function(){return o.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"c",(function(){return o.d}));var i=n(1),a=n.n(i),o=(n(1698),n(964)),r=n(2),s=n.n(r),l=2*Math.PI,c=function(){function e(t,n){a()(this,e);var i=window.Point;if(!(t instanceof i&&n instanceof i))throw new Error(t+" or "+n+" is not instanceof Point");this._pt1=new window.Point(t.x(),t.y()),this._pt2=new window.Point(n.x(),n.y())}return s()(e,[{key:"clone",value:function(){return new e(this._pt1.clone(),this._pt2.clone())}},{key:"assign",value:function(e){return this._pt1=e._pt1.clone(),this._pt2=e._pt2.clone(),this}},{key:"p1",value:function(){return new window.Point(this._pt1.x(),this._pt1.y())}},{key:"p2",value:function(){return new window.Point(this._pt2.x(),this._pt2.y())}},{key:"isNull",value:function(){return Object(o.j)(this._pt1.x(),this._pt2.x())&&Object(o.j)(this._pt1.y(),this._pt2.y())}},{key:"setLength",value:function(e){var t=this.unitVector();this._pt2=new window.Point(this._pt1.x()+t.dx()*e,this._pt1.y()+t.dy()*e)}},{key:"length",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y();return Math.sqrt(e*e+t*t)}},{key:"angle",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y(),n=360*Math.atan2(-t,e)/l,i=n<0?n+360:n;return Object(o.j)(i,360)?0:i}},{key:"translate",value:function(e,t){var n=window.Point,i=new n(e,t);this._pt1=n["+"](this._pt1,i),this._pt2=n["+"](this._pt2,i)}},{key:"normalVector",value:function(){var t=window.Point;return new e(this.p1(),t["+"](this.p1(),new t(this.dy(),-this.dx())))}},{key:"intersect",value:function(t,n){var i=window.Point,a=i["-"](this._pt2,this._pt1),o=i["-"](t.p1(),t.p2()),r=i["-"](this._pt1,t.p1()),s=a.y()*o.x()-a.x()*o.y();if(0===s||!isFinite(s))return e.IntersectType.NoIntersection;var l=1/s,c=(o.y()*r.x()-o.x()*r.y())*l;if(n){var u=i["+"](this._pt1,i["*"](c,a));n.setX(u.x()),n.setY(u.y())}if(c<0||c>1)return e.IntersectType.UnboundedIntersection;var d=(a.x()*r.y()-a.y()*r.x())*l;return d<0||d>1?e.IntersectType.UnboundedIntersection:e.IntersectType.BoundedIntersection}},{key:"angleTo",value:function(t){if(!(t instanceof e))throw new Error(t+" is not instance of Line");if(this.isNull()||t.isNull())return 0;var n=this.angle(),i=t.angle()-n,a=i<0?i+360:i;return Object(o.j)(i,360)?0:a}},{key:"unitVector",value:function(){var t=this._pt2.x()-this._pt1.x(),n=this._pt2.y()-this._pt1.y(),i=Math.sqrt(t*t+n*n);return new e(this.p1(),new window.Point(this._pt1.x()+t/i,this._pt1.y()+n/i))}},{key:"dx",value:function(){return this._pt2.x()-this._pt1.x()}},{key:"dy",value:function(){return this._pt2.y()-this._pt1.y()}},{key:"setP1",value:function(e){this._pt1=e}},{key:"setP2",value:function(e){this._pt2=e}},{key:"setPoints",value:function(e,t){return this._pt1=e,this._pt2=t,this}},{key:"setLine",value:function(e,t,n,i){this._pt1=new window.Point(e,t),this._pt2=new window.Point(n,i)}},{key:"setNewLine",value:function(t){if(!(t instanceof e))throw new Error(t+" is no instanceof Line");this.setLine(t.p1().x(),t.p1().y(),t.p2().x(),t.p2().y())}},{key:"pointAt",value:function(e){var t=this._pt2.x()-this._pt1.x(),n=this._pt2.y()-this._pt1.y();return new window.Point(this.pt1.x()+t*e,this.pt1.y()+n*e)}},{key:"toLine",value:function(){return new e(this._pt1.toPoint(),this._pt2.toPoint())}},{key:"isQLine",get:function(){return!0}}]),e}();c.IntersectType={NoIntersection:0,BoundedIntersection:1,UnboundedIntersection:2},window.Line=c},3427:function(e,t,n){"use strict";n.d(t,"s",(function(){return q})),n.d(t,"j",(function(){return H})),n.d(t,"k",(function(){return G})),n.d(t,"l",(function(){return O})),n.d(t,"m",(function(){return M})),n.d(t,"n",(function(){return E})),n.d(t,"g",(function(){return U})),n.d(t,"h",(function(){return R})),n.d(t,"i",(function(){return P})),n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return Q})),n.d(t,"c",(function(){return K})),n.d(t,"e",(function(){return Z})),n.d(t,"f",(function(){return $})),n.d(t,"o",(function(){return Y})),n.d(t,"q",(function(){return V})),n.d(t,"C",(function(){return ae})),n.d(t,"r",(function(){return ie})),n.d(t,"d",(function(){return ee})),n.d(t,"z",(function(){return te})),n.d(t,"B",(function(){return ne})),n.d(t,"v",(function(){return oe})),n.d(t,"w",(function(){return se})),n.d(t,"y",(function(){return ce})),n.d(t,"p",(function(){return le})),n.d(t,"A",(function(){return ue})),n.d(t,"t",(function(){return de})),n.d(t,"u",(function(){return he})),n.d(t,"x",(function(){return L}));var i=n(144),a=n.n(i),o=n(13),r=n.n(o),s=n(8),l=n.n(s),c=n(310),u=n(1631),d=n(1104),h=n(167),p=n(698),f=n(772),g=n(1033),v=n(336),y=n(309),m=n(1252),_=n(1),x=n.n(_),w=n(2),k=n.n(w),b=function(){function e(){x()(this,e)}return k()(e,[{key:"init",value:function(e,t){var n="_init_style_"+e,i="_init_color_"+t;return this[n]&&this[i]?(this[i](),this[n](),!0):(console.error("使用了未配置的表格样式 style_"+e+"_color_"+t),!1)}},{key:"_createBorder",value:function(e,t){return{width:t,color:this._color2num(e),single:!0}}},{key:"_createSpecial",value:function(e,t){return{color:this._color2num(t),opacity:0,borders:{left:e,right:e,top:e,bottom:e}}}},{key:"_init_style_0",value:function(){var e=this._createBorder(this.border_color,10);this.left_border=this.right_border=this.top_border=this.bottom_border=e}},{key:"_init_style_1",value:function(){var e=this._createBorder(this.border_color,10);this.left_border=this.right_border=this.top_border=this.bottom_border=e}},{key:"_init_style_2",value:function(){var e=this._createBorder(this.border_color,20);this.left_border=this.right_border=this.top_border=this.bottom_border=e,this.first_row=this._createSpecial(e,this.header_color),this.band_row1=this._createSpecial(e,this.alternate_color[0]),this.band_row2=this._createSpecial(e,this.alternate_color[1])}},{key:"_init_style_3",value:function(){var e=this._createBorder(this.border_color,20);this.left_border=this.right_border=this.top_border=this.bottom_border=e,this.first_row=this._createSpecial(e,this.header_color)}},{key:"_init_style_4",value:function(){var e=this._createBorder(this.border_color,20);this.left_border=this.right_border=this.top_border=this.bottom_border=e,this.first_row=this._createSpecial(e,this.header_color),this.first_col=this._createSpecial(e,this.header_color)}},{key:"_init_color_0",value:function(){this.border_color="#000000",this.header_color="#ffffff",this.alternate_color=["#ffffff","#ffffff"]}},{key:"_init_color_1",value:function(){this.border_color="#5FB4FF",this.header_color="#AFD7FA",this.alternate_color=["#DCEFFF","#C7E5FF"]}},{key:"_init_color_2",value:function(){this.border_color="#87C220",this.header_color="#BEDDA1",this.alternate_color=["#EDF6E8","#DCEEC9"]}},{key:"_init_color_3",value:function(){this.border_color="#767C85",this.header_color="#C0C6CF",this.alternate_color=["#F2F4F7","#E2E6ED"]}},{key:"_init_color_4",value:function(){this.border_color="#FFB700",this.header_color="#FFE59B",this.alternate_color=["#FFF6DA","#FFF0C4"]}},{key:"_init_color_5",value:function(){this.border_color="#BEB6C5",this.header_color="#DAD3E0",this.alternate_color=["#F8F3FD","#F2EBF3"]}},{key:"_color2num",value:function(e){var t=e.slice(1,3),n=e.slice(3,5),i=e.slice(5,7);return parseInt(t,16)+(parseInt(n,16)<<8)+(parseInt(i,16)<<16)}},{key:"style",get:function(){return{color_bg:this._color2num("#ffffff"),borders:{left:this.left_border,right:this.right_border,top:this.top_border,bottom:this.bottom_border},band:{row1:this.band_row1,row2:this.band_row2,col1:this.band_col1,col2:this.band_col2},spec:{first_row:this.first_row,last_row:this.last_row,first_col:this.first_col,last_col:this.last_col},colors:{border:this.border_color,header:this.header_color,alternate:this.alternate_color}}}}]),e}(),T=function(e,t){var n=new b;return n.init(e,t)?n.style:null},C=n(3932),S=n(1733);function E(e,t,n,i){return new Promise((function(a,o){var r=t.selection,s=t.doc,l=r.getActiveAreaNormalRanges(),c=l.length,u=l[0];u.pos>l[c-1].pos&&(u=l[c-1]);var d=s.getDataLogic("final").getPapx(u.pos);if(d.prop.getPropVal("nest_level")>0)return o("Insert nested table not supported");var p=n*(i+1);d.pos<u.pos&&++p;var f={pos:u.pos,len:u.len,strlen:p,rowNum:n,columnNum:i},g={name:"insertTable",param:f,cb:function(){a()}},v=f.pos;if(r.setPosition(v,void 0,{shouldBlur:h.isPad}),!e.cmdExecutor.exec(g))return o("Insert table command failed");r._dispatch("onUILOperationTriggered",v,null,{isEditing:!0,shouldBlur:h.isPad}),r.onCmdExec()}))}function P(e,t){var n=t.selection,i=function(e,t){var n=e.selInfo.getSelectionInfo(),i=n.begin,a=n.minLevel,o=Object(u.c)(t,i,a);if(!o)return null;var r=o.range,s=r.pos;return{begin:s,end:s+r.len}}(n,t.doc);if(i){var a=i.begin,o=i.end-i.begin,r={pos:a,len:o,isBackspace:!0,string:Object(p.getDeletedTextFromRange)(t,a,o),bSendSelectionBack:!0},s={name:"deleteTable",param:r},l=r.pos;if(!e.cmdExecutor.exec(s))return;n._dispatch("onUILOperationTriggered",l,null,{isEditing:!0}),n.onCmdExec()}}function L(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=i||e.selInfo.getSelectionInfo(),o=a.inTable,r=void 0!==o&&o,s=a.rowSelected,l=void 0!==s&&s,c=a.columnSelected,u=void 0!==c&&c,d=a.isCellsContinuous,h=void 0!==d&&d,p=a.rows,f=void 0===p?[]:p;if(r&&!h&&(l||u)&&f.length>0){var g=[],v=e.getNormalRanges(),y=u?f.length:1,m=[];v.forEach((function(e,t){m.push(e),Number.isInteger((t+1)/y)&&(g.push({rgset:m}),m=[])})),n&&(t.selectType=l?2:u&&3),t.multiareas=g}}function A(e,t){var n=t.pos,i=t.pos+t.len,a=e.getDataLogic("final");if(n===i||a.getPapx(i-1).prop.getPropVal("para_type")!==d.d){var o=a.getPap(n).getPropVal("nest_level"),r=a.specTable,s=r.getTapx(n,c.IT.Include,o);n=s.prop?s.begin:n;var l=r.getTapx(i,c.IT.Include,o);i=l.prop?l.end:i}return{begin:n,end:i}}function I(e,t){for(var n=0,i=e.getDataLogic("final"),a=t.begin;a<t.end;){var o=i.getPapx(a),r=o.prop.getPropVal("para_type");r!==d.b&&r!==d.d||++n,a=o.pos+o.len}return n}function R(e,t){var n=t.selection,i=t.doc,a=n.getActiveAreaNormalRanges(),o=void 0,r=void 0;a[0].pos>a[a.length-1].pos?(o=a[a.length-1].pos,r=a[0].pos+a[0].len):(o=a[0].pos,r=a[a.length-1].pos+a[a.length-1].len);var s=A(i,{pos:o,len:r-o}),l=s.begin,c=s.end-s.begin,u={pos:l,len:c,isBackspace:!0,string:Object(p.getDeletedTextFromRange)(t,l,c)},d=n.selInfo.getSelectionInfo();L(n,u,!0,d);var h={name:"deleteRow",param:u},f=u.pos;n.setPosition(f),e.cmdExecutor.exec(h)&&(n._dispatch("onUILOperationTriggered",f,null,{isEditing:!0}),n.onCmdExec())}function O(e,t,n){var i=t.selection,a=t.doc,o=i.getActiveAreaNormalRanges(),r=void 0,s=void 0;o[0].pos>o[o.length-1].pos?(r=o[o.length-1].pos,s=o[0].pos+o[0].len):(r=o[0].pos,s=o[o.length-1].pos+o[o.length-1].len);var l=A(a,{pos:r,len:s-r}),c={pos:l.begin,len:l.end-l.begin,strlen:I(a,l),bSendSelectionBack:!0,count:n},u={name:"insertRowAbove",param:c},d=c.pos;if(e.cmdExecutor.exec(u))return i._dispatch("onUILOperationTriggered",d,null,{isEditing:!0}),i.onCmdExec(),!0}function M(e,t,n){var i=t.selection,a=t.doc,o=i.getActiveAreaNormalRanges(),r=void 0,s=void 0;o[0].pos>o[o.length-1].pos?(r=o[o.length-1].pos,s=o[0].pos+o[0].len):(r=o[0].pos,s=o[o.length-1].pos+o[o.length-1].len);var l=A(a,{pos:r,len:s-r}),c={pos:l.begin,len:l.end-l.begin,strlen:I(a,l),bSendSelectionBack:!0,count:n},u={name:"insertRowBelow",param:c},d=c.pos+c.len;if(e.cmdExecutor.exec(u))return i._dispatch("onUILOperationTriggered",d,null,{isEditing:!0}),i.onCmdExec(),!0}function D(e,t){var n=e.idxs[0],i=e.rows[0].table_row,a=i.tableCells,o=i.rgdxa,r=0,s=n[0];t||(s=n[n.length-1])<a.length-1&&++s;var l=a[s];void 0!==l.width&&0===l.width.type&&(r=l.width.width);for(var c=0,u=Number.MAX_SAFE_INTEGER,d=0;d<o.length-1;++d){var h=o[d+1]-o[d];u=Math.min(u,h),c+=h}var p=Object(v.Px2Ti)(j()),f=c+e.columnCnt*r;if(f<p)return!0;u*=c>=p?c/f:1-(f-p)/f;var g=20;return i.defCellInnerMarginLeft&&(g+=i.defCellInnerMarginLeft),i.defCellInnerMarginRight&&(g+=i.defCellInnerMarginRight),!(u<g)}function N(e,t,n){var i=e.getDataLogic("final"),a=i.specTable,o=n.getPropVal("nest_level"),r=a.getTapx(t,c.IT.Include,o);if(!r.prop)return!1;var s=i.getPapx(r.pos,c.IT.Exclude);if(!s.good)return!0;var l=s.prop,u=l.getPropVal("nest_level");return!(l.getPropVal("para_type")===d.d&&u===o)}function B(e,t,n,i){var a=e.getDataLogic("final").specTable,o=n.getPropVal("nest_level"),r=a.getTapx(t,c.IT.Include,o);return r.prop?r.cellDatas[i]:(console.log("Wrong situation!!!"),{begin:0,end:0})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=window.APP.isWebMode(),i=window.APP.data,a=i.selection,o=i.typoinfo,r=e||a.begin.pageIndex-1,s=Object(C.b)(r,t,n),l=n?o.size.width-2*o.horizontalPadding:s.rect.width;return l}function F(e,t){if(!t||!e.rows[0]||!e.rows[0].table_row)return t;var n=e.rows[0].table_row.tableCells,i=j(),a=Math.ceil(Object(v.Px2Ti)(i)/200);if(t>a){var o=a-n.length;return o>0?o:void 0}return t}function H(e,t,n){var i=t.selection,a=t.doc,o=i.selInfo.getSelectionInfo();if(!D(o,!0))return{columnInsertLimited:!0};var r={pos:o.begin,len:o.end-o.begin,strlen:o.tableRowCnt*o.columnCnt,bSendSelectionBack:!0,count:F(o,n)},s={name:"insertColumnLeft",param:r},l=r.pos;o.columnSelected&&o.cells||N(a,o.cells[0][0].begin,o.rows[0])?l=o.cells[0][0].begin:l=B(a,o.cells[0][0].begin,o.rows[0],o.idxs[0][0]).begin;e.cmdExecutor.exec(s)&&(i._dispatch("onUILOperationTriggered",l,null,{isEditing:!0}),i.onCmdExec())}function G(e,t,n){var i=t.selection,a=t.doc,o=i.selInfo.getSelectionInfo();if(!D(o,!1))return{columnInsertLimited:!0};var r={pos:o.begin,len:o.end-o.begin,strlen:o.tableRowCnt*o.columnCnt,bSendSelectionBack:!0,count:F(o,n)},s={name:"insertColumnRight",param:r},l=r.pos;if(o.columnSelected&&o.cells||N(a,o.cells[0][0].begin,o.rows[0])){var c=o.cells[0];l=c[c.length-1].end}else{var u=o.idxs[0],d=u[u.length-1];l=B(a,o.cells[0][0].begin,o.rows[0],d).end}e.cmdExecutor.exec(s)&&(i._dispatch("onUILOperationTriggered",l,null,{isEditing:!0}),i.onCmdExec())}function U(e,t){var n=t.selection,i=t.doc,a=n.selInfo.getSelectionInfo(),o={pos:a.begin,len:a.end-a.begin};L(n,o,!0,a);var r={name:"deleteColumn",param:o},s=o.pos,l=void 0;a.columnSelected&&a.cells||N(i,a.cells[0][0].begin,a.rows[0])?(s=a.cells[0][0].begin,l=a.cells[0][a.cells[0].length-1].end):(s=B(i,a.cells[0][0].begin,a.rows[0],a.idxs[0][0]).begin,l=B(i,a.cells[0][0].begin,a.rows[0],a.idxs[0][a.idxs[0].length-1]).end);var c=i.getDataLogic("final");if(a.idxs[0][0]>0&&c.getPap(l).getPropVal("para_type")===d.d){var u=a.idxs[0][0]-1;s=B(i,a.cells[0][0].begin,a.rows[0],u).begin}n.setPosition(s),e.cmdExecutor.exec(r)&&(n._dispatch("onUILOperationTriggered",s,null,{isEditing:!0}),n.onCmdExec())}function W(e,t,n,i,a){for(var o=1,r=a?1:-1,s=t+r,l=e.length;s>=0&&s<l;s+=r){for(var c=e[s],u=c.cells,d=c.prop.table_row.rgdxa,h=-1,p=0,g=u.length;p<g;p++){var v=u[p].vertMerge===f.e.FIRST||u[p].vertMerge===f.e.MIDDLE,y=d[p],m=d[p+1];v&&y===n&&m===i&&(h=p)}if(-1===h)break;o++}return{leftRgdxa:n,rightRgdxa:i,count:o,isForward:a}}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.selection,i=e.doc,a=void 0;t&&(a=1);var o=n.selInfo.getSelectionInfo(),r=o.begin,s=o.end,l=o.inTable;if(r===s||!l)return!1;for(var c=n.getNormalRanges().sort((function(e,t){return e.pos-t.pos})),d=Object(u.c)(i,r,a),h=d.rows,p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,v=void 0,y=void 0,m=0,_=0,x=0,w=[],k=[],b={},T=0,C=h.length;T<C;T++){var S=h[T];if(!(S.end<=r)){if(S.begin>=s)break;p=Math.min(T,p),g=Math.max(T,g),k[x]=[];for(var E=Number.MAX_SAFE_INTEGER,P=Number.MIN_SAFE_INTEGER,L=!1,A=S.cellDatas,I=S.cells,R=S.prop.table_row.rgdxa,O=function(e,t){var n=A[e],i=I[e],a=c[m],o=R[e],r=R[e+1];if(n.begin>=a.pos&&n.end<=a.pos+a.len){_++,L=!0;var s=void 0,l=T;if(i.vertMerge===f.e.FIRST?(s=W(h,T,o,r,!0),w.push(s),l=T+s.count-1,g=Math.max(l,g)):i.vertMerge===f.e.MIDDLE&&(s=W(h,T,o,r,!1),w.push(s),l=T-s.count+1,p=Math.min(l,p)),s)for(var u=1;u<s.count;u++){var d=s.isForward?u:-u;b[T+d]={min:b[T+d]?Math.min(b[T+d].min,o):o,max:b[T+d]?Math.max(b[T+d].max,r):r}}E=Math.min(o,E),P=Math.max(r,P),k[x].push({min:Math.min(l,T),max:Math.max(l,T)})}else if(i.vertMerge===f.e.MIDDLE){var v=w.find((function(e){return e.leftRgdxa===o&&e.rightRgdxa===r}));v&&(E=Math.min(v.leftRgdxa,E),P=Math.max(v.rightRgdxa,P))}b[T]={min:b[T]?Math.min(b[T].min,E):E,max:b[T]?Math.max(b[T].max,P):P}},M=0,D=A.length;M<D;M++)O(M,D);x++,L&&m+1<c.length&&m++,1===x&&(v=E,y=P)}}if(_<=1)return!1;for(var N in b){var B=b[N];if(B.min!==v||B.max!==y)return!1}var j=k[0],F=k[k.length-1];return!j.some((function(e){return e.min!==p}))&&!F.some((function(e){return e.max!==g}))}function z(e,t){var n=e.selection,i=e.doc,a=n.getNormalRange(),o=a.pos,r=a.len,s=n.getNormalRanges().sort((function(e,t){return e.pos-t.pos})),l=Object(u.c)(i,o,t),c=l.range,d=l.rows,h=new Set,p=[],g=0;return d.forEach((function(e){var t=!1,n=e.cellDatas,i=e.cells,a=e.prop.table_row.rgdxa,l=e.begin,c=e.end,u=s[g];if(a.forEach((function(e){return h.add(e)})),!(o>=c||o+r<l||r&&o+r===l))for(var d=0;d<n.length;d++){var v=n[d];u.pos>=v.end||u.pos+u.len<v.begin||u.len&&u.pos+u.len===v.begin||(t=!0,i[d].vertMerge!==f.e.MIDDLE&&p.push({range:v,leftRgdxa:a[d],rightRgdxa:a[d+1],info:i[d]}))}t&&g+1<s.length&&g++})),h=Array.from(h).sort((function(e,t){return e-t})),{cells:p,rgdxaList:h,range:c}}function X(e,t){var n=e.info.vertMerge===f.e.FIRST,i=t.some((function(t){return t>e.leftRgdxa&&t<e.rightRgdxa}));return n||i}function V(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.selection,i=void 0;t&&(i=1);var a=n.selInfo.getSelectionInfo(),o=a.inTable;if(!o)return!1;var r=z(e,i),s=r.rgdxaList,l=r.cells;return l.some((function(e){return X(e,s)}))}function q(e,t){var n=e.getDataLogic("final"),i=n.getPap(t);if(i.getPropVal("nest_level")<=1)return t;for(var a=i.getPropVal("type"),o=t,r=t+1;;){var s=n.getPapx(r),l=s.prop.getPropVal("nest_level"),c=s.prop.getPropVal("type");if(1===l&&c===a){o=r;break}if(0===l||c!==a)break;r=s.pos+s.len}return o}function K(e,t,n,i,a){var o=t.selection,r=t.doc,s=o.getActiveAreaNormalRanges(),l=s.length,c=s[0];c.pos>s[l-1].pos&&(c=s[l-1]);var u={name:"adjustTable",param:{pos:q(r,n),xOff:Math.ceil(Object(v.Px2Ti)(i)),yOff:Math.ceil(Object(v.Px2Ti)(a))}};e.cmdExecutor.exec(u)&&(o._dispatch("onUILOperationTriggered",c.pos,null,{isEditing:!0}),o.onCmdExec())}function Q(e,t,n,i){var a=t.selection,o=t.doc,r=a.getActiveAreaNormalRanges(),s=r.length,l=r[0];l.pos>r[s-1].pos&&(l=r[s-1]);var c=A(o,{pos:q(o,n),len:0}),u={name:"adjustRow",param:{pos:c.begin,len:c.end-c.begin,height:Math.ceil(Object(v.Px2Ti)(i))}};e.cmdExecutor.exec(u)&&(a._dispatch("onUILOperationTriggered",l.pos,null,{isEditing:!0}),a.onCmdExec())}function J(e,t,n,i,a,o){if(!(n<0)){var r=t.selection,s=t.doc,l=r.getActiveAreaNormalRanges(),c=l.length,u=l[0];u.pos>l[c-1].pos&&(u=l[c-1]);var d={name:"adjustColumn",param:{pos:q(s,n),row:i,column:a,offset:Object(v.Px2Ti)(o)}};e.cmdExecutor.exec(d)&&(r._dispatch("onUILOperationTriggered",u.pos,null,{isEditing:!0}),r.onCmdExec())}}function Z(e,t,n){var i=t.selection,a=n||i.getNormalRange(!0);if(a){var o={name:"autoAdjustColumn",param:a};e.cmdExecutor.exec(o)&&(i._dispatch("onUILOperationTriggered",a.pos,null,{isEditing:!0}),i.onCmdExec())}}function $(e,t,n,i,a){var o=n.selection,r=n.typoinfo,s=i||o.getNormalRange(!0);if(s){var l={pos:s.pos,len:s.len,mode:a};0===a&&e.isWebMode()&&(l.typoWidth=Math.round(Object(v.Px2Ti)(r.view.typoWidth)));var c={name:"autoAdjustTable",param:l};t.cmdExecutor.exec(c)&&(o._dispatch("onUILOperationTriggered",s.pos,null,{isEditing:!0}),o.onCmdExec())}}function ee(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var a=t.selection.getNormalRange(),o={pos:a.pos,len:a.len,styleId:n,colorId:i,opType:g.Table_ApplyStyle,style:T(n,i)};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:o})}}function te(e,t,n,i,a){if(t.api.isConnected()&&!t.api.hasBlocking()){var o=t.selection.getNormalRange(),r={pos:o.pos,len:o.len,opType:g.Table_CellAlignment,horz:n,vert:i};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:r},a)}}function ne(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var a=t.selection.getNormalRange(),o={value:n,pos:a.pos,len:a.len,opType:g.Table_FormatAlignment};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:o},i)}}function ie(e,t){var n=t.selection,i=n.selInfo.getSelectionInfo(),a={pos:i.begin,len:i.end-i.begin};if(i.rowCnt>1&&i.columnCnt>1){var o=i.idxs[0].length-1,s=i.idxs[0][o]+1;o=i.idxs[i.rowCnt-1].length-1;for(var l=i.idxs[i.rowCnt-1][o]+1,c=i.rows[0].table_row.rgdxa[s],u=i.rows[i.rowCnt-1].table_row.rgdxa[l];u<c;)++a.len,++l,u=i.rows[i.rowCnt-1].table_row.rgdxa[l]}var d={name:"mergeTableCells",param:r()({},a,{bSendSelectionBack:!0})};e.cmdExecutor.exec(d)&&(n._dispatch("onUILOperationTriggered",a.pos,null,{isEditing:!0}),n.onCmdExec())}function ae(e,t){var n=t.selection,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.doc,i=e.typoinfo,a=void 0;t&&(a=1);var o=z(e,a),r=o.cells,s=o.rgdxaList,u=o.range,d=n.getSubDocType(u.pos),h=r.filter((function(e){return X(e,s)})),p=h.map((function(e){var t=[];[e.leftRgdxa].concat(l()(s.filter((function(t){return e.leftRgdxa<t&&e.rightRgdxa>t}))),[e.rightRgdxa]).reduce((function(e,n,i){return i>0&&t.push(n-e),n}));var n=[],a=void 0,o=0,r=i.tableLineRanges.mapInRange(u.pos,u.pos+u.len,(function(e){return e._node.line}),c.IT.strictIntersectTest).filter((function(e){return e&&e.parent.layoutType!==m.c.CellPage}));if(d===y.HeaderFooter&&r.length){var h=r[0].viewPage;r=r.filter((function(e){return e.viewPage===h}))}var p=!1;return r.some((function(t){return!(t.end<=e.range.begin)&&(t.tablecells.every((function(t){var i=t.range;if(i&&e.range.begin<=i.pos&&e.range.end>=i.pos+i.len){if(a)n[n.length-1]+=Object(v.Px2Ti)(t.rect.height);else{var r=t.style&&t.style.border&&t.style.border.top;r||(r=t.style&&t.style.rowStyle&&t.style.rowStyle.top),o=r?r.lineWidth:0,a=t,n.push(Object(v.Px2Ti)(t.rect.height)-o)}return t.merge_type!==f.e.FIRST&&(p=!0),!1}return!a||Math.floor(a.rect.left)!==Math.floor(t.rect.left)||Math.ceil(a.rect.right)!==Math.ceil(t.rect.right)||(t.merge_type===f.e.MIDDLE?n.push(Object(v.Px2Ti)(t.rect.height)-o):t.merge_type===f.e.LAST&&(n.push(Object(v.Px2Ti)(t.rect.height)-o),p=!0),!1)})),p)})),n=n.filter((function(e){return!!e})),{range:e.range,rows:n,columns:t}}));return p}(t,!0);if(i&&i.length>0){var a={name:"splitTableCells",param:{bSendSelectionBack:!0,areas:i}};e.cmdExecutor.exec(a)&&(n._dispatch("onUILOperationTriggered",i[0].range.begin,null,{isEditing:!0}),n.onCmdExec())}}function oe(e,t,n,i,a,o){var s={name:"setCellsBorderStyle",param:r()({pos:t,opType:n,row:i,column:a},o)};e.cmdExecutor.exec(s)}function re(e){var t=e.slice(1,3),n=e.slice(3,5),i=e.slice(5,7);return parseInt(t,16)+(parseInt(n,16)<<8)+(parseInt(i,16)<<16)}function se(e,t,n){if(t.api.isConnected()&&!t.api.hasBlocking()){var i=t.selection.getNormalRange(),a={pos:i.pos,len:i.len,opType:g.Table_CellFillColor,color:n,fillColor:n&&re(n),isNoFillColor:!n};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:a})}}function le(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.selection,i=e.doc,a=void 0;t&&(a=1);var o=n.selInfo.getSelectionInfo(),r=o.begin,s=o.inTable,l=o.containsTableTextFrame;if(!s)return!1;if(l)return!1;var c=n.getNormalRanges().sort((function(e,t){return e.pos-t.pos})),d=Object(u.c)(i,r,a),h=d.rows,p=h&&h[0];return c[0].pos<=p.end-1}function ce(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var a=t.selection,o=t.doc,r=a.getNormalRange(),s=r.pos,l=r.len,c=a.selInfo.getSelectionInfo().begin,d=Object(u.c)(o,c,1).rows,h=d.find((function(e){return e.begin<=s&&e.end>s})),p=d.find((function(e){return e.begin<=s+l&&e.end>=s+l})),f={pos:h.begin,len:p.end-h.begin,opType:g.Table_RepeatHeader,isRepeat:n};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:f},i)}}function ue(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var a=t.selection.getNormalRange(),o={pos:a.pos,len:a.len,value:n,opType:g.Table_OutSideBorder};e.cmdExecutor.sendCommandBlock({name:"formatOp",param:o},i)}}function de(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var a=r()({},n);e.cmdExecutor.sendCommandBlock({name:"dragTable",param:a},i)}}function he(e,t,n,i){if(t.api.isConnected()&&!t.api.hasBlocking()){var o=t.selection,s=t.doc,l=o.getNormalRange(),c=l.len,u=o.selInfo.getSelectionInfo(),d=u.columnSelected,h=a()(u.cells,1)[0],p=a()(u.rows,1)[0];if(d){var f=h[0].begin,g=h[h.length-1].begin,v=p.nest_level,y=Object(S.collectColumns)(s,f,g,v).ranges;c=y[y.length-1].end-y[0].begin}var m=r()({},n,{len:c,pos:l.pos});e.cmdExecutor.sendCommandBlock({name:"moveTableOfRowOrCol",param:m},i)}}},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCustomProtocalURL=t.registerCustomProtocal=t.isCanFallow=t.isLegalURL=t.openHyperlink=void 0;var i=n(5),a=n(167),o=i.__importDefault(n(82)),r=n(386),s=n(327),l=n(14),c=n(454),u=(0,l.getQuery)("incognito"),d="true"===u||"1"===u,h=function(e){var t=(0,l.getQuery)("sublink"),n=t?parseInt(t)+1:2,i="sublink=".concat(n);e=e+(e.includes("?")?"&":"?")+i,(0,s.callAppLink)(encodeURI(e)).catch((function(){p(e)}))},p=function(e,t){void 0===t&&(t="_blank");var n=window.open(e,t),i=n&&n.opener;!y(e)&&i&&(n.opener=null)};t.openHyperlink=function(e,t){if(w(e)){var n=k(e);return n||window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),n}if(!f(e)||d)return window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1;if(v(e))return a.isMobile?(p(e),!0):(window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "Unable to open link.")),!1);window.collection2("open_hyperlink");/^[a-z]*\:\/\/|^mailto\:/i.test(e)||(e="https://".concat(e));var i={okBtnText:_i18n("applications.public.helpers.openHyperlink.followLinkCopyLink", "Copy Link"),text:_i18n("applications.public.helpers.openHyperlink.followLinkAlertText", "Due to platform limitations, this link can only be opened in external browsers"),cancelBtnText:_i18n("applications.public.helpers.openHyperlink.cancel", "Cancel"),onOk:function(){(0,r.copyToClipboard)(e),window.Toast.success(_i18n("applications.public.helpers.openHyperlink.followLinkCopySuccessTips", "Copy link succeeded")),t&&t.onOk&&t.onOk()},onCancel:function(){t&&t.onCancle&&t.onCancle()}},o=t&&t.fileInfo;return a.isPCWxMiniProgram||a.isPad&&a.isPadMiniProgram?y(e)?(p(e),!0):(window.Confirm(i),!1):a.isInMiniProgram?y(e)?(h(e),!0):(window.Confirm(i),!1):a.isMobile&&a.isMobileWpsClient||(a.isMobile||a.isPad)&&a.isWOA?(y(e)?h(e):p(e),!0):(0,c.isSupportOfflineOpen)(o)?((0,c.offlineOpen)(e,o,(function(){p(e)})),!0):a.isSafari?(function(e){if(y(e))try{var t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noreferrer";var n=new MouseEvent("click",{bubbles:!0,cancelable:!1});t.dispatchEvent(n)}catch(t){p(e)}else p(e)}(e),!0):(p(e),!0)};var f=function(e){var t=/^[`、|~,.?;:/<>'"{}\\\[\]\(\)!@#$%\^&\*\-_=\+·，。、￥？《》：；’‘“{}【】（）——！…]/;if(e.indexOf("javascript:")>-1)return!1;if(/^((https?|ftp)\:\/\/).+/i.test(e)){var n=e.replace(/^https?\:\/\//i,"").replace(/^ftp\:\/\//i,"").replace(/^mailto\:/i,"");if(t.test(n))return!1;return!/^[0-9]/.test(n)||g(n)}if(/^(mailto\:).+/i.test(e))return!0;if(v(e)){n=e.replace(/^tel:/i,"");return!t.test(n)}if(w(e))return!0;if(window.officeType===o.default.dbsheet){if(/^[a-z]*\:\/\/\S/i.test(e))return!0}return g(e)};t.isLegalURL=f;var g=function(e){return/^(((www\.)?[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*\.(com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|xxx|idv|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|yr|za|zm|zw)|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3})(:\d{1,5})?(?:(\/).*)?)$/i.test(e)},v=function(e){var t=new RegExp("^".concat("tel:\\s?").concat("((\\+86|86)\\s?)?1[3-9]\\d{9}","$")),n=new RegExp("^".concat("tel:\\s?").concat("((\\(0\\d{2,3}\\))|(0\\d{2,3}-?))?[1-9]\\d{6,7}","$"));return t.test(e)||n.test(e)},y=function(e){var t=/^https?:\/\/[^\/\?\#]+/i.exec(e.toLowerCase());if(!t)return!1;var n=t[0];return n===window.location.origin.toLowerCase()||m(n)};t.isCanFallow=y;var m=function(e){return!!(window.__CONFIG__.miniProgramHyperLinksWhiteList||"").split(",").find((function(t){return t&&e.endsWith(t)}))},_={},x=function(e){var t=e.match(/^(\w+)\:\/\//i);return t?t[1]:""};t.registerCustomProtocal=function(e,t){return!["https","http"].includes(e)&&(_[e]=t,!0)};var w=function(e){var t=x(e);return!!_[t]};t.isCustomProtocalURL=w;var k=function(e){var t=x(e),n=_[t];return!(!n||"function"!=typeof n)&&(window.collection("openkdocshyperlink",e),n(e))}},3684:function(e,t,n){"use strict";function i(e){var t=void 0,n=void 0,i=void 0;if(e.oMath){var a=e.orgGlyphGroups&&e.orgGlyphGroups[0];t=a.isFootnote(),n=a.isEndnote(),i=!t&&!n&&a.isFootEndNotePlaceholder()}else t=e.isFootnote(),n=e.isEndnote(),i=e.isNotePlaceholder();return t||n||i?{isFootnote:t,isPlaceHolder:i}:null}n.d(t,"a",(function(){return i}))},3685:function(e,t,n){"use strict";var i=n(8),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(1720),u=n(309),d=n(947),h=n(772),p=n(400),f=n(411),g=n(3334),v=function(){function e(){r()(this,e)}return l()(e,null,[{key:"hitTextbox",value:function(t,n,i,o,r,s,l){var h=i.outer_rect,f={x:n.x-h.left,y:n.y-h.top},v=void 0;s==u.MainText?v=i.getTextboxInMainPage():s==u.HeaderFooter&&(v=i.getTextboxInHeaderFooter());var y=t.selection,m=y.selShapes,_=y.activeTextboxShape,x=[],w=function e(t){t.childShapes.forEach((function(t){t.isGroup?e(t):t.has_textbox&&x.push(t)}))};_&&_.isChildShape&&w(_.topShape),m&&m.forEach((function(e){var t=e.topShape;t.isGroup&&w(t)})),x.length&&(v=[].concat(x,a()(v)));for(var k=v.length-1;k>=0;--k){var b=v[k];if(void 0!==l){var T=b.topShape;if(l&&!T.isBehindText||!l&&T.isBehindText)continue}var C=b.textbox_page;if(C){var S=e.getShapeRect(b);if(S){var E=b.visualRotation,P=void 0,L=S.left+C.rect.left,A=S.top+C.rect.top,I=S.left+C.rect.right,R=S.top+C.rect.bottom;if(!b.isRotateText&&(E>=45&&E<135||E>=225&&E<315)){var O=S.left+S.width/2,M=S.top+S.height/2,D=O-S.height/2,N=M-S.width/2;P=p.a.initByRawRect({left:Math.max(L,D),right:Math.min(I,D+S.height),top:Math.max(A,N),bottom:Math.min(R,N+S.width)})}else P=p.a.initByRawRect({left:Math.max(L,S.left),right:Math.min(I,S.right),top:Math.max(A,S.top),bottom:Math.min(R,S.bottom)});var B=b.isRotateText&&!b.hasEnterTextbox()?E:0;if(Object(g.a)(f,P,B)){var j={x:f.x-S.left,y:f.y-S.top};o.type||(o.type=d.a.TEXTBOX_PAGE);var F=e.enterTextboxContext(b,r);return c.a.hit(t,j,C,o,r),e.exitTextboxContext(F,r),o.subDocType=s===u.MainText?u.Textbox:u.TextboxInHF,o.zorder=b.topShape.anchor.zorder,o.isInTextbox=!0,o.shapeIdxPathOfTextbox=b.shapeIdxPath,o.shapeTreeTypeOfTextbox=b.shape_tree_type,o.textbox=b,console.info("hit on textbox"),!0}}}}return!1}},{key:"getParentNodePath",value:function(e){for(var t=e.outer,n=e,i=[];n.layoutType!==f.DOCLayoutType.LayoutPage&&(n=n.upper?n.upper:n.isEmbedShape?t.parent:n.parent).layoutType!==f.DOCLayoutType.LayoutPage;)i.push(n);return i.reverse()}},{key:"enterTextboxContext",value:function(t,n){for(var i=e.getParentNodePath(t),a=0;a<i.length;++a)n.enter(i[a]);return n.enter(t),i}},{key:"exitTextboxContext",value:function(e,t){for(var n=0;n<e.length;++n)t.exit();t.exit()}},{key:"getShapeRect",value:function(e){var t=e.isTopShape?e.viewRect||e.pic_rect||e.visible_rect||e.renderRect:e.viewRect;if(!t)return p.a.initByRawRect({left:0,top:0,right:0,bottom:0});var n=t.left,i=t.top,a=t.height,o=t.width;if(a=0===a?1:a,e.outer.parent.parent instanceof h.c){var r=e.visible_rect,s=e.coor_pos2view;r&&s&&(n=Math.round(r.left)+s.x,i=Math.round(r.top)+s.y)}return p.a.initByRawRect({left:n,top:i,right:n+o,bottom:i+a})}}]),e}();t.a=v},3686:function(e,t,n){var i=n(742),a=n(563);e.exports=function(e){if(!a(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},3687:function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},3688:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},3689:function(e,t,n){var i=n(5331),a=n(4423),o=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols,s=r?function(e){return null==e?[]:(e=Object(e),i(r(e),(function(t){return o.call(e,t)})))}:a;e.exports=s},3690:function(e,t,n){(function(e){var i=n(474),a=n(5334),o=t&&!t.nodeType&&t,r=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=r&&r.exports===o?i.Buffer:void 0,l=(s?s.isBuffer:void 0)||a;e.exports=l}).call(this,n(793)(e))},3691:function(e,t,n){(function(e){var i=n(897),a=t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,r=o&&o.exports===a&&i.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=s}).call(this,n(793)(e))},3692:function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},3693:function(e,t,n){var i=n(5338),a=n(2857),o=n(5339),r=n(4421),s=n(5340),l=n(742),c=n(3687),u=c(i),d=c(a),h=c(o),p=c(r),f=c(s),g=l;(i&&"[object DataView]"!=g(new i(new ArrayBuffer(1)))||a&&"[object Map]"!=g(new a)||o&&"[object Promise]"!=g(o.resolve())||r&&"[object Set]"!=g(new r)||s&&"[object WeakMap]"!=g(new s))&&(g=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,i=n?c(n):"";if(i)switch(i){case u:return"[object DataView]";case d:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case f:return"[object WeakMap]"}return t}),e.exports=g},386:function(e,t,n){"use strict";n.r(t),n.d(t,"copyToClipboard",(function(){return a}));function i(e,t){var n,i,a,o,r,s,l=!1;t||(t={}),n=t.debug||!1;try{if(a=function(){var e=document.getSelection();if(!e.rangeCount&&0!==e.rangeCount)return function(){};for(var t=document.activeElement,n=[],i=0;i<e.rangeCount;i++)n.push(e.getRangeAt(i));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),o=document.createRange(),r=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",document.body.appendChild(s),o.selectNode(s),r.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),l=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{r&&("function"==typeof r.removeRange?r.removeRange(o):r.removeAllRanges()),s&&document.body.removeChild(s),a()}return l}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null;t&&(a=t.getContainer||null);var o=n||_i18n("applications.public.helpers.copy2clipboard.success", "Copy success");return i(e,t)?(window.Toast.success(o,a),!0):(window.Toast.error(_i18n("applications.public.helpers.copy2clipboard.fail", "Copy failed"),a),!1)}},3930:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(3931),l=n(336),c=function(){function e(){a()(this,e)}return r()(e,null,[{key:"getLayoutCorner",value:function(e){var t=1440,n=1440,i=1800,a=1800,o=e.range;if(o){var r=window.APP.data.doc.sections.getSection(o.pos);if(r){var c=r.getPageMargin();t=c.top,n=c.bottom,i=c.left,a=c.right}}var u=Object(l.Ti2Px)(t),d=Object(l.Ti2Px)(n),h=Object(l.Ti2Px)(i),p=Object(l.Ti2Px)(a),f=e.outer_rect,g=s.b.T2B,v=s.b.B2T,y=s.a.L2R,m=s.a.R2L,_=f.width-p,x=f.height-d;return{header_footer_limit:{top:u,bottom:x},left_top_corner:{x:h,y:u,ver:v,hor:m},right_top_corner:{x:_,y:u,ver:v,hor:y},left_bottom_corner:{x:h,y:x,ver:g,hor:m},right_bottom_corner:{x:_,y:x,ver:g,hor:y}}}}]),e}();t.a=c},3931:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var i={T2B:0,B2T:1},a={L2R:0,R2L:1}},3932:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var i=function(e){return window.APP.data.typoinfo.layout_pages[e]},a=function(e,t){var n=i(e);return t?[n.page]:n.mainpages},o=function(e,t,n){return a(e,n)[t]}},3933:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n(547),a={DEFAULT:"DEFAULT",SELECTION:"SELECTION",TEXT:"TEXT",WATER_DROP:"WATER_DROP",COOPER_SELECTION:"COOPER_SELECTION",COOPER_SELECTION_SHAPE:"COOPER_SELECTION_SHAPE",PAGE_MARGIN_LEFT:"PAGE_MARGIN_LEFT",TASK_LIST:"TASK_LIST",TABLE_TEXT:"TABLE_TEXT",TABLE_CELL_SELECT:"TABLE_CELL_SELECT",TABLE_ROW_SELECT:"TABLE_ROW_SELECT",TABLE_COLUMN_SELECT:"TABLE_COLUMN_SELECT",TABLE_ROW_RESIZE:"TABLE_ROW_RESIZE",TABLE_COLUMN_RESIZE:"TABLE_COLUMN_RESIZE",TABLE_HYPERLINK:"TABLE_HYPERLINK",SHAPE:"SHAPE",SHAPE_RESIZE_TL:"SHAPE_RESIZE_TL",SHAPE_RESIZE_TM:"SHAPE_RESIZE_TM",SHAPE_RESIZE_TR:"SHAPE_RESIZE_TR",SHAPE_RESIZE_RM:"SHAPE_RESIZE_RM",SHAPE_RESIZE_BR:"SHAPE_RESIZE_BR",SHAPE_RESIZE_BM:"SHAPE_RESIZE_BM",SHAPE_RESIZE_BL:"SHAPE_RESIZE_BL",SHAPE_RESIZE_LM:"SHAPE_RESIZE_LM",HYPERLINK:"HYPERLINK",TEXTFRAME:"TEXTFRAME",TEXTBOX_PAGE:"TEXTBOX_PAGE",TEXTBOX_PADDING:"TEXTBOX_PADDING"},o={TEXT:[a.TEXT,a.TABLE_TEXT,a.WATER_DROP,a.TASK_LIST,a.COOPER_SELECTION,a.HYPERLINK,a.TABLE_HYPERLINK,a.TEXTBOX_PAGE,a.TEXTFRAME]};new Map([[a.DEFAULT,{default:i.cursorTypes.default}],[a.SELECTION,{default:i.cursorTypes.default}],[a.TEXT,{default:i.cursorTypes.text}],[a.COOPER_SELECTION,{default:i.cursorTypes.text}],[a.TASK_LIST,{default:i.cursorTypes.hand,readonly:i.cursorTypes.text}],[a.TABLE_TEXT,{default:i.cursorTypes.text}],[a.TABLE_HYPERLINK,{default:i.cursorTypes.text,readonly:i.cursorTypes.hand}],[a.TABLE_CELL_SELECT,{default:i.cursorTypes.cell_select,readonly:i.cursorTypes.text}],[a.TABLE_ROW_SELECT,{default:i.cursorTypes.row_select,readonly:i.cursorTypes.text}],[a.TABLE_COLUMN_SELECT,{default:i.cursorTypes.col_select,readonly:i.cursorTypes.text}],[a.TABLE_ROW_RESIZE,{default:i.cursorTypes.ns_resize,readonly:i.cursorTypes.text}],[a.TABLE_COLUMN_RESIZE,{default:i.cursorTypes.ew_resize,readonly:i.cursorTypes.text}],[a.SHAPE,{default:i.cursorTypes.move,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_TL,{default:i.cursorTypes.nw_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_TM,{default:i.cursorTypes.n_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_TR,{default:i.cursorTypes.ne_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_RM,{default:i.cursorTypes.e_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_BR,{default:i.cursorTypes.se_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_BM,{default:i.cursorTypes.s_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_BL,{default:i.cursorTypes.sw_resize,readonly:i.cursorTypes.default}],[a.SHAPE_RESIZE_LM,{default:i.cursorTypes.w_resize,readonly:i.cursorTypes.default}],[a.HYPERLINK,{default:i.cursorTypes.text,readonly:i.cursorTypes.hand}],[a.TEXTFRAME,{default:i.cursorTypes.text}],[a.TEXTBOX_PAGE,{default:i.cursorTypes.text,readonly:i.cursorTypes.move}]])},3934:function(e,t,n){var i=n(5302),a=n(5318),o=n(5320),r=n(5321),s=n(5322);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=r,l.prototype.set=s,e.exports=l},3935:function(e,t){e.exports=function(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}},3936:function(e,t,n){var i=n(3686),a=n(3401);e.exports=function(e){return null!=e&&a(e.length)&&!i(e)}},3937:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReplacedLink=void 0;t.getReplacedLink=function(e){if(!e)return"";var t=window.__CONFIG__&&window.__CONFIG__.pathPrefix||"";return e.replace(/(.*)(\/l\/.+)/i,(function(e,n,i){return"".concat(window.location.origin).concat(t).concat(i)}))}},3972:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var i=[{name:"ANSI",code:20127},{name:"Unicode",code:1200},{name:"Unicode Big_Endian",code:1201},{name:"Unicode UTF-8",code:65001}],a={Chinese:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Chinese", "Chinese"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseGB18030", "GB18030 Simplified Chinese"),code:54936},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseGBK", "ANSI/OEM Simplified Chinese GBK"),code:936},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseGB2312", "Simplified Chinese GB2312"),code:20936},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseHZGB2312", "HZ-GB2312 Simplified Chinese"),code:52936},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseMacGB2312", "MAC Simplified Chinese GB2312"),code:10008},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.SimplifiedChineseISO2022", "ISO-2022 Simplified Chinese"),code:50227},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TraditionalChineseBig5", "ANSI/OEM Traditional Chinese Big5"),code:950},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TraditionalChineseMacBig5", "MAC Traditional Chinese Big5"),code:10002},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TraditionalChineseISO2022", "ISO-2022 Traditional Chinese"),code:50229}]},Baltic:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Baltic", "Baltic"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.BalticISO88594", "ISO 8859-4 Baltic"),code:28594},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMBaltic", "OEM Baltic"),code:775}]},CentralEuropean:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.CentralEuropeanCharacter", "Central European"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88592CentralEurope", "ISO 8859-2 Central Europe"),code:28592},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ANSICentralEurope", "ANSI Central Europe"),code:1250}]},GreekCharacters:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.GreekCharacters", "Greek"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Greek", "ANSI - Greek"),code:1253},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88597Greek", "ISO 8859-7 Greek"),code:28597},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMGreek437G", "OEM Greek 437G"),code:737},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMModernGreek", "OEM Modern Greek"),code:869}]},HebrewCharacter:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.HebrewCharacter", "Hebrew"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMHebrew", "OEM Hebrew"),code:862},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Hebrew", "ANSI - Hebrew"),code:1255},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88598HebrewVisual", "ISO 8859-8 Hebrew: Visual"),code:28598},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88598HebrewLogical", "ISO 8859-8 Hebrew: Logical"),code:38598}]},Latin9Character:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Latin9Character", "Latin 9"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88591Latin1", "ISO 8859-1 Latin 1"),code:28591},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88593Latin3", "ISO 8859-3 Latin 3"),code:28593},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88599Turkish", "ISO 8859-9 Latin 5"),code:28599},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88599Estonian", "ISO 8859-13 Latin 7"),code:28603},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO885915Latin9", "ISO 8859-15 Latin 9"),code:28605}]},Japanese:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Japanese", "Japanese"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacJapanese", "MAC Japanese"),code:10001},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICJapaneseKatakanaExtended", "IBM EBCDIC Japanese Katakana Extended"),code:20290},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO2022JPJISX02011989", "ISO-2022 Japanese JIS X 0201-1989"),code:50222},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.JapaneseShiftJIS", "ANSI/OEM Japanese Shift-JIS"),code:932}]},Korean:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Korean", "Korean"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO2022Korean", "ISO-2022 Korean"),code:50225},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EUCKoreanKorean", "EUC Korean"),code:51949},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ANSIOEMKorean", "ANSI/OEM Korean"),code:949}]},Russian:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Russian", "Russian"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMCyrillicII", "OEM Russian"),code:866},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICRussian", "IBM EBCDIC Cyrillic (Russian)"),code:20880},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.KOI8RRussian", "KOI8 Russian"),code:20866}]},Thai:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Thai", "Thai"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacThai", "MAC Thai"),code:10021},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ANSIOEMThai", "ANSI/OEM Thai"),code:874},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICThai", "IBM EBCDIC Thai"),code:20838}]},Vietnamese:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Vietnamese", "Vietnamese"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ANSIOEMVietnamese", "ANSI/OEM Vietnamese"),code:1258}]},WesternEuropeanCharacter:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.WesternEuropeanCharacter", "Western European"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Western", "ANSI Latin I"),code:1252},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMMultilingualLatinI", "OEM Multilingual Latin I"),code:850},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMMultilingualLatinIEuro", "OEM Multilingual Latin I + Euro"),code:858},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMPortuguese", "OEM Portuguese"),code:860},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMCanadianFrench", "OEM Canadian French"),code:863}]},ArabicCharacter:{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ArabicCharacter", "Arabic"),subItems:[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Arabic", "ANSI - Arabic"),code:1256},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO88596Arabic", "ISO 8859-6 Arabic"),code:28596},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ArabicTransparentASMO", "Arabic Transparent ASMO"),code:720}]}},o=[{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ANSICyrillic", "ANSI - Cyrillic"),code:1251},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.Turkish", "ANSI - Turkish"),code:1254},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.BalticSea", "ANSI - Baltic Sea"),code:1257},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISOCyrillic", "ISO 8859-5 Cyrillic"),code:28595},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.NoHalfwidthKatakana", "ISO-2022 JP with no half-width Katakana"),code:50220},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.HalfwidthKatakana", "ISO-2022 JP with half-width Katakana"),code:50221},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacRoman", "MAC - Roman"),code:1e4},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacKorean", "MAC - Korean"),code:10003},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacArabic", "MAC - Arabic"),code:10004},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacHebrew", "MAC - Hebrew"),code:10005},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacGreek1", "MAC - Greek I"),code:10006},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacCyrillic", "MAC - Cyrillic"),code:10007},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacRomania", "MAC - Romania"),code:10010},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacUkraine", "MAC - Ukraine"),code:10017},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacLatin2", "MAC - Latin II"),code:10029},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacIcelandic", "MAC - Icelandic"),code:10079},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacTurkish", "MAC - Turkish"),code:10081},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.MacCroatia", "MAC - Croatia"),code:10082},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICUSCanada", "IBM EBCDIC - US-Canada"),code:37},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICInternational", "IBM EBCDIC - International"),code:500},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICMultilingualROECELatin2", "IBM EBCDIC - Multilingual/ROECE (Latin-2)"),code:870},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICGreekModern", "IBM EBCDIC - Greek Modern"),code:875},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICTurkishLatin5", "IBM EBCDIC - Turkish (Latin-5)"),code:1026},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICGermany", "IBM EBCDIC - Germany"),code:20273},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICDenmarkNorway", "IBM EBCDIC - Denmark-Norway"),code:20277},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICFinlandSweden", "IBM EBCDIC - Finland-Sweden"),code:20278},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICItaly", "IBM EBCDIC - Italy"),code:20280},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICLatinAmericaSpain", "IBM EBCDIC - Latin America-Spain"),code:20284},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICUnitedKingdom", "IBM EBCDIC - United Kingdom"),code:20285},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICFrance", "IBM EBCDIC - France"),code:20297},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICArabic", "IBM EBCDIC - Arabic"),code:20420},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICGreek", "IBM EBCDIC - Greek"),code:20423},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICHebrew", "IBM EBCDIC - Hebrew"),code:20424},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICKoreanExtended", "IBM EBCDIC - Korean Extended"),code:20833},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICIcelandic", "IBM EBCDIC - Icelandic"),code:20871},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICTurkish", "IBM EBCDIC - Turkish"),code:20905},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.EBCDICSerbianBulgarian", "IBM EBCDIC - Cyrillic (Serbian-Bulgarian)"),code:21025},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMUnitedStates", "OEM - United States"),code:437},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMMultilingualLatinII", "OEM - Latin II"),code:852},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMCyrillic", "OEM - Cyrillic"),code:855},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMTurkish", "OEM - Turkish"),code:857},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMIcelandic", "OEM - Icelandic"),code:861},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMArabic", "OEM - Arabic"),code:864},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.OEMNordic", "OEM - Nordic"),code:865},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIDevanagari", "ISCII - Devanagari"),code:57002},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIBengali", "ISCII - Bengali"),code:57003},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIITamil", "ISCII - Tamil"),code:57004},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIITelugu", "ISCII - Telugu"),code:57005},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIAssamese", "ISCII - Assamese"),code:57006},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIOriya", "ISCII - Oriya"),code:57007},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIKannada", "ISCII - Kannada"),code:57008},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIMalayalam", "ISCII - Malayalam"),code:57009},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIGujarati", "ISCII - Gujarati"),code:57010},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISCIIPunjabi", "ISCII - Punjabi (Gurmukhi)"),code:57011},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ArabicASMO", "Arabic - ASMO"),code:708},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.KoreanJohab", "Korean - Johab"),code:1361},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanCNS", "CNS - \nTaiwan,China"),code:2e4},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanTCA", "TCA - Taiwan,China"),code:20001},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanEten", "Eten - Taiwan,China"),code:20002},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanIBM5550", "IBM5550 - Taiwan,China"),code:20003},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanTeleText", "TeleText - Taiwan,China"),code:20004},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.TaiwanWang", "Wang - Taiwan,China"),code:20005},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.IA5IRV", "IA5 (IRV International Alphabet No. 5)"),code:20105},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.IA5German", "IA5 German"),code:20106},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.IA5Swedish", "IA5 Swedish"),code:20107},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.IA5Norwegian", "IA5 Norwegian"),code:20108},{name:"T.61",code:20261},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ISO6937NonSpacingAccent", "ISO 6937 Non-Spacing Accent"),code:20269},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.KOI8R", "Russian - KOI8"),code:20866},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.ExtAlphaLowercase", "Ext Alpha Lowercase"),code:21027},{name:_i18n("applications.writer.components.CommandBars.StatusBar.textEncoding.KOI8U", "Ukrainian - KOI8-U"),code:21866},{name:"UTF-7",code:65e3}]},398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(238);function a(e,t){if(e.wholeText===t){var n=e.parentNode;if(0===n.scrollWidth||0===n.clientWidth){for(var i=n;i.parentNode&&0===i.parentNode.clientWidth;)i=i.parentNode;var o=i.nextSibling,r=!1;if(o){var s=o.getBoundingClientRect(),l=i.getBoundingClientRect();r=Math.max(s.left,l.left)<=Math.min(s.right,l.right)&&Math.max(s.top,l.top)<=Math.min(s.bottom,l.bottom)}return i.parentNode&&i.offsetWidth<=i.parentNode.clientWidth&&!r}return n.scrollWidth>0&&Math.abs(n.scrollWidth-n.clientWidth)<1&&n.scrollHeight>0&&Math.abs(n.scrollHeight-n.clientHeight)<1}for(var c=e.childNodes,u=0;u<c.length;u++)if(a(c[u],t))return!0;return!1}t.default={isMustShowTitle:function(e,t){return(0,i.isValidElement)(t)&&t.props.children?!a(e,t.props.children):"string"!=typeof t||!a(e,t)},getLottiePosition:function(e,t){var n,i=e.clientWidth,a=e.clientHeight,o=t.getBoundingClientRect(),r=document.body,s=r.clientWidth,l=r.clientHeight,c=s-o.right-4,u=o.left-4,d=o.right+4,h=Math.max(4,o.left-4-i);n=c>=i?d:u>=i?h:c>=u?d:h;var p=l-o.top,f=o.bottom,g=o.top,v=Math.max(4,o.bottom-a);return{left:n,top:p>=a?g:f>=a?v:p>=f?g:v}},getBubblePosition:function(e,t,n,i,a){var o,r,s=e.clientWidth,l=e.clientHeight,c=t.getBoundingClientRect(),u=document.body,d=u.clientWidth,h=u.clientHeight;return o=!i&&c.width>100?n.x-10:c.left+c.width/2-s/2,o=Math.min(d-s-10,o),o=Math.max(10,o),a?(r=c.top+c.height/2-l/2,o+=c.left>o?-10:10):h-10<(r=Math.max(n.y+25,c.bottom+10))+l&&(r=c.top-l-10),{left:o,top:r}}}},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementType=void 0,function(e){e.leftRight="leftRight",e.topBottom="topBottom"}(t.PlacementType||(t.PlacementType={}))},4419:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(1720),l=n(400),c=n(309),u=n(4813),d=n(947),h=n(411),p=n(1232),f=n(3685),g=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(t,n,i,a,o){o.enter(i);var r=!1;if(t.selection.selContext.isInHeaderFooter)r=u.a.hitEditModeHeaderFooter(t,n,i,a,o);else{var s=void 0===o.limitInSubdocType||o.limitInSubdocType===c.Textbox;if(s&&(r=f.a.hitTextbox(t,n,i,a,o,c.MainText,!1)),!r&&(window.APP.formatContentController.isRestrictEditMode||window.APP.isPaginationMode()||u.a.hitReadModeHeaderFooter(t,n,i,a,o),!(r=e.hitTextFrame(t,n,i,i.mainpages,a,o))&&(r=e.hitMainPage(t,n,i,i.mainpages,a,o))&&a.isFuzzyHit&&s)){var l=Object.assign({},a);l.layoutPos=Object.assign({},a.layoutPos),(r=f.a.hitTextbox(t,n,i,l,o,c.MainText,!0))?Object.assign(a,l):r=!0}}return o.exit(),r}},{key:"hasTextFrame",value:function(e){var t=e.getTextFrameInMainPage();return t&&t.length>0}},{key:"enterTextFrameContext",value:function(e,t){for(var n=e.length-1;n>=0;--n)e[n].isCoorSystem&&t.enter(e[n])}},{key:"exitTextFrameContext",value:function(e,t){for(var n=e.length-1;n>=0;--n)e[n].isCoorSystem&&t.exit()}},{key:"hitTextFrame",value:function(t,n,i,a,o,r){for(var u=i.outer_rect,f={x:n.x-u.left,y:n.y-u.top},g=Number.MAX_SAFE_INTEGER,v=-1,y=0;y<a.length;++y){var m=a[y],_=l.a.distanceFromPointToRect(f,m.rect);_<g&&(g=_,v=y)}if(-1==v)return!1;for(var x=i.getTextFrameInMainPage(),w=x.length-1;w>=0;--w){for(var k=function(e){return e.parent?e.parent:e.isScene()?e.upper:null},b=k(x[w]),T=x[w].rect,C=[],S={x:0,y:0};b.layoutType!=h.DOCLayoutType.LayoutPage;)C.push(b),S.x+=b.rect.left,S.y+=b.rect.top,b=k(b);if(f.x>=T.left+S.x-p.TABLE_HOTSPOT_UNIT.MARGIN&&f.x<=T.right+S.x&&f.y>=T.top+S.y&&f.y<=T.bottom+S.y){var E={x:f.x-T.left-S.x,y:f.y-T.top-S.y},P=x[w],L=P.snippetPack,A=void 0;if(L&&(e.enterTextFrameContext(C,r),r.enter(P),A=s.a.hit(t,E,L,o,r),r.exit(),e.exitTextFrameContext(C,r),o.type||(o.type=d.a.TEXTFRAME),A))return o.pageIdx=v,o.subDocType=c.MainText,o.layoutPos.x+=T.left+S.x,o.layoutPos.y+=T.top+S.y,A}}return!1}},{key:"hitMainPage",value:function(t,n,i,a,o,r){for(var u=i.outer_rect,d={x:n.x-u.left,y:n.y-u.top},h=Number.MAX_SAFE_INTEGER,p=-1,f=0;f<a.length;++f){var g=a[f],v=l.a.distanceFromPointToRect(d,g.rect);v<h&&(h=v,p=f)}if(-1==p)return!1;var y=a[p],m=!1,_=y.footnotes,x=y.endnotes,w=y.textflow,k=y.rect,b=r.canHitNotes||void 0===r.limitInSubdocType||r.limitInSubdocType===c.Footnote,T=r.canHitNotes||void 0===r.limitInSubdocType||r.limitInSubdocType===c.Endnote,C=void 0,S={x:d.x-k.left,y:d.y-k.top};return"T2B"!==w.corX||w.isReverseLine?"T2B"===w.corX&&w.isReverseLine||"B2T"===w.corX?_?x?(S.x>=_.rect.left||S.x>=x.rect.left)&&(C=l.a.distanceFromPointToRect(S,_.rect)<l.a.distanceFromPointToRect(S,x.rect)?b&&_:T&&x):S.x>=_.rect.left&&(C=b&&_):x&&S.x>=x.rect.left&&(C=T&&x):_?x?(S.y>=_.rect.top||S.y>=x.rect.top)&&(C=l.a.distanceFromPointToRect(S,_.rect)<l.a.distanceFromPointToRect(S,x.rect)?b&&_:T&&x):S.y>=_.rect.top&&(C=b&&_):x&&S.y>=x.rect.top&&(C=T&&x):_?x?(S.x<=_.rect.right||S.x<=x.rect.right)&&(C=l.a.distanceFromPointToRect(S,_.rect)<l.a.distanceFromPointToRect(S,x.rect)?b&&_:T&&x):S.x<=_.rect.right&&(C=b&&_):x&&S.x<=x.rect.right&&(C=T&&x),C&&(r.enter(y),m=e.hitFootEndNotes(C,S,o,r,t),r.exit(),m)?(o.pageIdx=p,o.subDocType=C===_?c.Footnote:c.Endnote,!0):!!(m=s.a.hit(t,d,y,o,r))&&(o.pageIdx=p,o.subDocType=c.MainText,!0)}},{key:"hasTextbox",value:function(e){var t=e.getTextboxInMainPage();return t&&t.length>0}},{key:"hitFootEndNotes",value:function(e,t,n,i,a){for(var o=e.rect,r={x:t.x-o.left,y:t.y-o.top},c=Number.MAX_SAFE_INTEGER,u=-1,d=0;d<e.notes.length;++d){var h=e.notes[d].rect,p=l.a.distanceFromPointToRect(r,h);p<c&&(c=p,u=d)}u<0&&(u=0),i.enter(e);var f=e.notes[u],g=f.rect;return i.enter(f),s.a.hit(a,{x:r.x-g.left,y:r.y-g.top},f.note_page,n,i),i.exit(),i.exit(),!0}}]),e}();t.a=g},4420:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var i={EDIT_LINK:"EDIT_LINK",SELECT_LINK:"SELECT_LINK",CANCEL_LINK:"CANCEL_LINK",OPEN_LINK:"OPEN_LINK",PREVIEW_LINK:"PREVIEW_LINK"},a={COMMAND_BAR:"COMMAND_BAR",COMTEXT_MENU:"COMTEXT_MENU"}},4421:function(e,t,n){var i=n(1312)(n(474),"Set");e.exports=i},4422:function(e,t,n){var i=n(3935),a=n(1873);e.exports=function(e,t,n){var o=t(e);return a(e)?o:i(o,n(e))}},4423:function(e,t){e.exports=function(){return[]}},4424:function(e,t,n){var i=n(5332),a=n(4425),o=n(1873),r=n(3690),s=n(4749),l=n(4426),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),u=!n&&a(e),d=!n&&!u&&r(e),h=!n&&!u&&!d&&l(e),p=n||u||d||h,f=p?i(e.length,String):[],g=f.length;for(var v in e)!t&&!c.call(e,v)||p&&("length"==v||d&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,g))||f.push(v);return f}},4425:function(e,t,n){var i=n(5333),a=n(716),o=Object.prototype,r=o.hasOwnProperty,s=o.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(e){return a(e)&&r.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},4426:function(e,t,n){var i=n(5335),a=n(3402),o=n(3691),r=o&&o.isTypedArray,s=r?a(r):i;e.exports=s},4427:function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},4428:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(623),l={INSERT_TEXT_WITHOUT_COMPOSITION:1,INSERT_TEXT_WITH_COMPOSITION:2,INSERT_PARAGRAPH:3,INSERT_TAB:4,DELETE_TEXT:5},c=1,u=function(){function e(){a()(this,e),this.isRespond=!0,this.timestamp=null,this.raf=null}return r()(e,[{key:"clearAll",value:function(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}},{key:"begin",value:function(e){c>50||this.isRespond&&(this.isRespond=!1,this.timestamp=performance.now())}},{key:"end",value:function(){var e=this;c>50||this.isRespond||(this.raf&&cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame((function(){var t=performance.now()-e.timestamp;window.report(s.TYPE.SUBTLE_DURATION,"wps_input_performance",parseInt(t)),e.isRespond=!0,e.raf=null,++c})))}}]),e}()},4429:function(e,t,n){"use strict";t.a={wpsFindScope_WholeDocument:0,wpsFindScope_Selection:1,wpsFindScope_MainText:2,wpsFindScope_HeaderFooters:3,wpsFindScope_Footnotes:4,wpsFindScope_Endnotes:5,wpsFindScope_TextFrames:6,wpsFindScope_HeaderFooterTextFrames:7,wpsFindScope_Comments:8}},454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offlineOpen=t.isSupportOfflineOpen=void 0;var i=n(5),a=i.__importDefault(n(168)),o=i.__importDefault(n(84)),r=i.__importDefault(n(85)),s=n(167),l=n(82),c=function(){return!!(s.isMobileWps&&window.wps&&window.wps.openLink)},u=function(e){return!!((0,o.default)()&&e&&e.file_id&&e.file_type)};t.isSupportOfflineOpen=function(e){return c()||u(e)};t.offlineOpen=function(e,t,n){c()?function(e,t){var n=!!t&&t.file_type&&t.file_id&&t.file_name;window.wps.openLink({url:e,link_type:n?"web_office":"common",file_type:n?t.file_type:"",file_id:n?t.file_id:"",file_name:n?t.file_name:""})}(e,t):u(t)&&function(e,t,n){var i=(0,l.getOfficeTypeByFileType)(t.file_type);if(!i)return n(e);a.default.check("openDocsOnlineFile").then((function(a){a?(0,r.default)("openDocsOnlineFile",{fileId:t.file_id,officeType:i}):n(e)})).catch((function(){n(e)}))}(e,t,n)}},4721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkHasCommentPermission=t.goToApplyForPermission=void 0;var i=n(343),a=n(486);t.goToApplyForPermission=function(){window.__CONFIG__.isShowNoPermissionComponent?!(window.fileInfo&&window.fileInfo.user_acl||{}).update&&i.canGotoEdit?(0,i.gotoEdit)({hidesave:!0}):a.canRequestForAuthForSecurityDoc&&(0,a.isEditLimitedSecurityDoc)()&&(0,a.requestForAuth)({type:a.AUTH_TYPES.EDIT}):window.Toast.info(_i18n("applications.writer.components.mobile.Other.CommentPanel.readOnly", "The document is read-only"))},t.checkHasCommentPermission=function(){return window.APP.functionStatus.comment.hasCommentAuthority?Promise.resolve():Promise.reject()}},4743:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i=n(24),a=n.n(i);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t&&t.private&&(t=t.private),t?(Object.keys(t).forEach((function(i){var a=t[i];if(null!=a){var r=e[i];if(a instanceof Object)if(a instanceof Array)n&&void 0!==r||(r||(r=[],e[i]=r),o(r,a,n));else{if(r){if("transform2D"===i&&(r.x<0||r.height<0))return}else r={},e[i]=r;o(r,a,n)}else n?void 0===r&&(e[i]=a):e instanceof Object&&(e[i]=a)}})),e):e}function r(e){return function e(t){if(!t||"object"!==(void 0===t?"undefined":a()(t)))return t;var n=void 0;for(var i in n=t instanceof Array?new Array(t.length):{},t)if(t.hasOwnProperty(i)){var o=t[i];n[i]="object"===(void 0===o?"undefined":a()(o))?e(o):o}return n}(e)}},4744:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g}));var i,a,o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=(i=document.createElement("canvas").getContext("2d"),a=i.backingStorePixelRatio||i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||1,(window.devicePixelRatio||1)/a),u=[];window.canvasPool||(window.canvasPool=u);var d={WEBGL:"webgl",CANVAS:"canvas"},h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.TYPE.CANVAS,a=arguments[3];r()(this,e),this._status=e.STATUS.IDLE,this._type=i,a&&(this._label=a),this._createElement(),this._resize(t,n),this.use()}return l()(e,[{key:"_createElement",value:function(){this._elem||(this._elem=document.createElement("canvas"),this._elem._canvasPoolItem=this)}},{key:"_resize",value:function(t,n){if(t=t<1?1:t,n=n<1?1:n,this.width===t&&this.height===n||(this.width=t<1?1:t,this.height=n<1?1:n,this._elem.style.width=t+"px",this._elem.style.height=n+"px",c>1?(this._elem.width=t*c,this._elem.height=n*c):(this._elem.width=t,this._elem.height=n)),this._type===e.TYPE.CANVAS&&c>1){var i=this.getContext();i&&i.setTransform(c,0,0,c,0,0)}}},{key:"getElem",value:function(){return this._elem}},{key:"getContext",value:function(t){return this._type===e.TYPE.CANVAS?this._elem.getContext("2d"):this._type===e.TYPE.WEBGL?(this._webglContext=this._webglContext||v(this._elem,t),this._webglContext):void 0}},{key:"use",value:function(){this._status=e.STATUS.BUSY}},{key:"release",value:function(){var t=this;if(u.length>20){var n=u.findIndex((function(e){return e===t}));-1!==n&&u.splice(n,1)}else{this.width=0,this._elem.width=0,delete this._label,this._status=e.STATUS.IDLE;try{this._elem.style.cssText=""}catch(e){console.error(e,"reset style fail!")}}}},{key:"isIdle",value:function(){return this._status===e.STATUS.IDLE}}]),e}();function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.CANVAS,i=arguments[3];u.length>100&&console.warn("canvasPool.length = "+u.length+", 请检查是否有可release的canvasPoolItem！",u);var a=new h(e,t,n,i);return u.push(a),a}function f(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.CANVAS,i=arguments[3],a=void 0,o=0;o<u.length;o++){var r=u[o];if(r._type===n&&r.isIdle()){(a=r)._resize(e,t),a._label=i,a.use();break}}return a||(a=p(e,t,n,i)),a}function g(e){for(var t=0;t<u.length;t++){var n=u[t];n._label===e&&n.release()}}h.STATUS={IDLE:0,BUSY:1},h.TYPE=d;var v=function(e,t){for(var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,a=0;a<n.length;++a){try{i=e.getContext(n[a],t)}catch(e){console.error(e)}if(i)break}return i}},4745:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={None:0,Hit_On_Header:1,Hit_On_Footer:2}},4747:function(e,t,n){"use strict";var i=n(8),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(677),u=function(){function e(t,n){r()(this,e),this.app=t,this.manager=n,this.state=c.a.DONE,this.modules=new Map,this.moduleTypes=[],this.activeModuleType=""}return l()(e,[{key:"loadModules",value:function(e){}},{key:"resetModule",value:function(e){var t=this.getModule(e);t&&t.resetState()}},{key:"getModule",value:function(e){return this.modules.get(e)}},{key:"reset",value:function(){this.modules.clear()}},{key:"clearAll",value:function(){this.modules.forEach((function(e){e.clearAll()})),this.reset()}},{key:"enter",value:function(e,t){var n=this;return Array.from(this.modules.keys()).some((function(i){var a=n.getModule(i);return n.state=a.execute(e,t),n.activeModuleType=n.state===c.a.BLOCK?i:"",n.state===c.a.BLOCK||(n.state===c.a.DONE?(n.isLeaveWhenDone?n.leave():a.resetUILState(),!0):void 0)})),this.state}},{key:"leave",value:function(){this.reset(),this.manager.unmountUIL(this)}},{key:"isLeaveWhenDone",get:function(){return!0}}],[{key:"matchTriggerConditions",value:function(e,t,n){return!1}},{key:"getEventList",value:function(e){return Object.values(e.modulesMap).reduce((function(e,t){return[].concat(a()(e),a()(t.getConcernEvents()||[]))}),[])}}]),e}();t.a=u},4748:function(e,t,n){var i=n(2144),a=n(5324),o=n(5325),r=n(5326),s=n(5327),l=n(5328);function c(e){var t=this.__data__=new i(e);this.size=t.size}c.prototype.clear=a,c.prototype.delete=o,c.prototype.get=r,c.prototype.has=s,c.prototype.set=l,e.exports=c},4749:function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&n.test(e))&&e>-1&&e%1==0&&e<t}},4750:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return p}));var i=1,a=2,o=3,r=4,s=5,l=6,c=7,u=8,d=9,h=10,p=11},4751:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var i=0,a=1},4752:function(e,t,n){"use strict";n.r(t),n.d(t,"pretreatAddress",(function(){return m})),n.d(t,"selectHyperlink",(function(){return h})),n.d(t,"navigateByHyperlink",(function(){return f})),n.d(t,"deleteHyperlink",(function(){return y})),n.d(t,"editHyperlink",(function(){return _})),n.d(t,"filterLinkResult",(function(){return g})),n.d(t,"copyHyperlink",(function(){return p})),n.d(t,"switchToWebshape",(function(){return v}));var i=n(167),a=n(309),o=n(691),r=n(1238),s=n(358),l=n(3937),c=n(2701),u=n(1090),d=n(336);function h(e,t){e.selection.setPosition(t.field.begin,t.field.end)}function p(e,t){var n=t.getAddress();e.copy(null,n)}function f(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.doc,d=t.selection,h=n.getHyperLinkCode(),p=new c.a;p.parse(h);var f=void 0,g=void 0;if(n.isFileLinkAddress()){var v=n.getKWProtocolParams(),y=v.shareLink;f=Object(l.getReplacedLink)(y)||""}else 0!==p.params.length&&(f=p.params[0].url.replace(/\\{2}/g,"\\")),p.switchs.get("l")&&(g=p.switchs.get("l"));if(g&&!f){var m=void 0,_=0,x=u.bookmarks,w=x.map[g];if(w){if(!i.isMobile)return void e.workspace.bookmarksManager.debouncePosBookmark(w,o);m=w.pos,_=w.len;var k=u.getSubDocType(m);k===a.Comment&&(m=u.comments.getCommentByBookmarkPos(m).pos)}"_top"===g&&(m=0,_=0),void 0!==m&&Object(r.typoToPositionWithLoading)(m).then((function(){if(w&&w.data.private&&w.data.private.column){var e=u.getDataLogic("final").specTable.getTapx(m),t=w.data.private.column.start-1;e&&e.prop&&e.cellDatas&&e.cellDatas.length>t&&(m=e.cellDatas[t].begin,_=e.cellDatas[t].end-m)}d.selCoop.locate(m,m).then((function(){d.selCoop.showDefaultHighLight({pos:m,len:_})}))}),(function(){}))}else f&&Object(s.openHyperlink)(f)}function g(e){var t="";if(e)for(var n=0;n<e.length;++n)Object(o.isSpecialPlaceholder)(e.charCodeAt(n))||(t+=e[n]);return t}function v(e,t,n,a){var o=n.data.typoinfo.pageWidths&&n.data.typoinfo.pageWidths[0]||(i.isPc?n.data.typoinfo.size&&n.data.typoinfo.size.width:void 0),r=window.APP.data.selection.selInfo.getSectionMargins(),s=o&&Object(d.Px2Ti)(o)-r.l.ti-r.r.ti;Object(u.uploadMimeDataImg)((function(i){var a=t.selection,o={pos:n.field.begin,len:n.field.end-n.field.begin,webExtensionKey:"webshape",webExtensionUrl:n.getAddress(),_textToDisplay:g(n.getResult()),woUserID:window.APP.userTagId,mimeDataID:i,width:s},r=Math.min(a.begin.position,a.end.position),l={name:"switchToWebshape",param:o};e.cmdExecutor.exec(l)&&(a._dispatch("onUILOperationTriggered",r,null,{isEditing:!0}),a.onCmdExec())}),a)}function y(e,t,n){var a=t.selection,o={pos:n.field.begin,len:n.field.end-n.field.begin,_textToDisplay:g(n.getResult())},r=Math.min(a.begin.position,a.end.position),s={name:"deleteHyperlink",param:o,cb:function(){i.isMobile&&window.APP.isPaginationMode()&&window.APP.data.selection.setPosition(n.field.begin,n.field.begin+g(n.getResult()).length)}};e.cmdExecutor.exec(s)&&(a._dispatch("onUILOperationTriggered",r,null,{isEditing:!0}),a.onCmdExec())}function m(e,t){var n=t;if("_top"===n)return n;for(var i=n="_"+n,a=0,o=e.doc.bookmarks.map;o[i];)i=n+"_"+ ++a;return i}function _(e,t,n,i){var a=t.selection,o=t.doc,r=i.address,s=i.screenTip,l=i.target,c=i.refStart,u=i.refEnd,d=i.textToDisplay,h=i.subAddress;void 0!==h&&(h=m(t,h));var p=Math.min(a.begin.position,a.end.position),f=Math.max(a.begin.position,a.end.position);if(p<=n.field.begin&&f>=n.field.end&&f-p!=n.field.end-n.field.begin)e.insertHyperlink({address:r,textToDisplay:d,subAddress:h,screenTip:s,target:l,refStart:c,refEnd:u});else{d!==_i18n("applications.writer.components.core.event.uil.handlers.chose", "<<Selected content in document>>")&&d!==o.getText(p,f-p)||(d=void 0);var v={pos:n.field.begin,len:n.field.end-n.field.begin,address:r,subAddress:h,screenTip:s,textToDisplay:d,_textToDisplay:g(n.getResult()),target:l,refStart:c,refEnd:u},y=v.pos+v.len,_={name:"editHyperlink",param:v};if(!e.cmdExecutor.exec(_))return;a._dispatch("onUILOperationTriggered",y,null,{isEditing:!0}),a.onCmdExec()}}},4813:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(400),l=n(260),c=n(2009),u=n(1720),d=n(309),h=n(3930),p=function(){function e(){a()(this,e)}return r()(e,null,[{key:"getHotspot",value:function(e){var t=e.header,n=e.footer,i=e.outer_rect,a=h.a.getLayoutCorner(e),o=a.left_top_corner,r=a.right_top_corner,l=a.left_bottom_corner,c=a.right_bottom_corner,u=t&&t.rect?Math.max(t.rect.bottom,o.y):o.y,d=s.a.initByRawRect({left:o.x,right:r.x,top:0,bottom:u}),p=n&&n.rect?Math.min(n.rect.top,l.y):l.y;return{header_hotspot:d,footer_hotspot:s.a.initByRawRect({left:l.x,right:c.x,top:p,bottom:i.height})}}},{key:"getAbsoluteHotspot",value:function(t){var n=e.getHotspot(t),i=n.header_hotspot,a=n.footer_hotspot,o=t.outer_rect.origin;return{header_absl_hotspot:s.a.addDeepOffset(i,o),footer_absl_hotspot:s.a.addDeepOffset(a,o)}}}]),e}(),f=n(4745),g=n(947),v=n(411),y=n(1232),m=n(3685),_=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hitReadModeHeaderFooter",value:function(t,n,i,a,o){var r=e.hit(n,i);return e.fireHit(r,o),r}},{key:"fireHit",value:function(e,t){var n=e.pos,i=e.where,a=e.bound,o=t&&t.event&&"mousemove"===t.event.type,r={pos:n,bound:a,isShow:i!==f.a.None,isHeader:i===f.a.Hit_On_Header};!window.APP.isReadOnly()&&o&&l.default.dispatchEvent(c.a.HEADER_FOOTER.SHOW_HIT_TIP,{affair:"showHitTip",params:r})}},{key:"hit",value:function(e,t){var n={where:f.a.None,pos:e,bound:{x:t.view.width,y:t.view.height},layout:t},i=p.getAbsoluteHotspot(t),a=i.header_absl_hotspot,o=i.footer_absl_hotspot;if(s.a.pointInRect(e,a))n.where=f.a.Hit_On_Header;else if(s.a.pointInRect(e,o))n.where=f.a.Hit_On_Footer;else if(t.getTextFrameInHeaderFooter)for(var r=t.getTextFrameInHeaderFooter(),l=t.header&&t.header.range,c=t.footer&&t.footer.range,u=r.length-1;u>=0;--u){var d=r[u],h=s.a.addDeepOffset(d.rect,t.outer_rect.origin);if(s.a.pointInRect(e,h)){var g=d.snippetPack.range;if(l&&g.pos>=l.pos&&g.pos<l.pos+l.len){n.where=f.a.Hit_On_Header;break}if(c&&g.pos>=c.pos&&g.pos<c.pos+c.len){n.where=f.a.Hit_On_Footer;break}}}return n}},{key:"hasTextFrame",value:function(e){return e.layers&&e.layers.textframes&&e.layers.textframes.length>0}},{key:"enterTextFrameContext",value:function(e,t){for(var n=e.length-1;n>=0;--n)e[n].isCoorSystem&&t.enter(e[n])}},{key:"exitTextFrameContext",value:function(e,t){for(var n=e.length-1;n>=0;--n)e[n].isCoorSystem&&t.exit()}},{key:"hitInTextFrame",value:function(t,n,i,a,o){var r=i.outer_rect,l={x:n.x-r.left,y:n.y-r.top},c=Number.MAX_SAFE_INTEGER,h=!1;(void 0!==i.header&&(c=s.a.distanceFromPointToRect(l,i.header.rect)),void 0!==i.footer)&&(s.a.distanceFromPointToRect(l,i.footer.rect)<c&&(h=!0));if(c===Number.MAX_SAFE_INTEGER)return!1;for(var p=i.getTextFrameInHeaderFooter(),f=p.length-1;f>=0;--f){for(var m=function(e){return e.parent?e.parent:e.isScene()?e.upper:null},_=m(p[f]),x=p[f].rect,w=[],k={x:0,y:0};_.layoutType!=v.DOCLayoutType.LayoutPage;)w.push(_),k.x+=_.rect.left,k.y+=_.rect.top,_=m(_);if(l.x>=x.left+k.x-y.TABLE_HOTSPOT_UNIT.MARGIN&&l.x<=x.right+k.x&&l.y>=x.top+k.y&&l.y<=x.bottom+k.y){var b={x:l.x-x.left-k.x,y:l.y-x.top-k.y},T=p[f],C=T.snippetPack,S=void 0;if(C&&(e.enterTextFrameContext(w,o),o.enter(T),S=u.a.hit(t,b,C,a,o),o.exit(),e.exitTextFrameContext(w,o),a.type||(a.type=g.a.TEXTFRAME),S))return a.isInFooter=h,a.subDocType=d.MainText,a.layoutPos.x+=x.left+k.x,a.layoutPos.y+=x.top+k.y,S}}return!1}},{key:"hasTextbox",value:function(e,t){var n=e.getTextboxInHeaderFooter();if(n&&n.length>0)return!0;var i=t.selection.selShapes,a=[];return i&&i.forEach((function(e){var t=e.topShape;t.isGroup&&function e(t){t.childShapes.forEach((function(t){t.isGroup?e(t):t.has_textbox&&a.push(t)}))}(t)})),a.length}},{key:"hitEditModeHeaderFooter",value:function(t,n,i,a,o){var r=void 0;e.hasTextFrame(i)&&(r=e.hitInTextFrame(t,n,i,a,o));var l=void 0===o.limitInSubdocType||o.limitInSubdocType===d.TextboxInHF;if(r||l&&e.hasTextbox(i,t)&&(r=m.a.hitTextbox(t,n,i,a,o,d.HeaderFooter,!1)),r)return r;var c=i.outer_rect,h={x:n.x-c.left,y:n.y-c.top},p=Number.MAX_SAFE_INTEGER,f=!1;if(void 0!==i.header&&(p=s.a.distanceFromPointToRect(h,i.header.rect)),void 0!==i.footer&&s.a.distanceFromPointToRect(h,i.footer.rect)<p&&(f=!0),p===Number.MAX_SAFE_INTEGER)return!1;var g=f?i.footer:i.header,v=u.a.hit(t,h,g,a,o);if(v){if(a.isInFooter=f,a.subDocType=d.HeaderFooter,a.isFuzzyHit&&l){var y=Object.assign({},a);y.layoutPos=Object.assign({},a.layoutPos),(v=m.a.hitTextbox(t,n,i,y,o,d.HeaderFooter,!0))&&Object.assign(a,y)}return!0}return!1}}]),e}();t.a=_},486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canRequestForAuthForSecurityDoc=t.requestForAuth=t.isPrintLimitedSecurityDoc=t.isCopyLimitedSecurityDoc=t.isEditLimitedSecurityDoc=t.isSupportSecurityDoc=t.AUTH_TYPES=void 0;var i=n(5).__importDefault(n(82)),a={EDIT:"edit",COPY:"copy",PRINT:"print",SAVE_AS:"saveAs"};t.AUTH_TYPES=a;var o={pluginType:window.__WPSPLUGIN__.helper.types.SecureDocApplyAuth};var r=[i.default.writer,i.default.spreadsheet,i.default.presentation].includes(window.officeType);function s(){return window.APP.getSecurityDocPermission()||{}}function l(){return 1===s().doctype}t.isSupportSecurityDoc=r,t.isEditLimitedSecurityDoc=function(){return l()&&!(!0===s().edit)},t.isCopyLimitedSecurityDoc=function(){return l()&&!(!0===s().copy)},t.isPrintLimitedSecurityDoc=function(){return l()&&!(!0===s().print)},t.requestForAuth=function(e){return void 0===e&&(e={type:a.EDIT}),window.__WPSPLUGIN__.loader.loadSingleInstance(o).then((function(t){return t.show(e.type)}))};var c=r&&!!window.__WPSPLUGIN__.loader.search(o);t.canRequestForAuthForSecurityDoc=c},515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(794);var a=i.__importStar(n(238)),o=i.__importDefault(n(795)),r=i.__importDefault(n(796)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isUnmount=!1,t.animation=null,t.state={style:{width:null,height:null}},t.refDiv=a.default.createRef(),t}return i.__extends(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.config.style,i=n.width,a=n.height;return i!==t.style.width||a!==t.style.height?{style:{width:i,height:a}}:null},t.prototype.componentDidMount=function(){this.load()},t.prototype.componentWillUnmount=function(){this.isUnmount=!0,this.animation&&this.animation.destroy()},t.prototype.load=function(){var e=this,n=this.props.config;t.preload(n).then((function(t){if(!e.isUnmount){var i=t[0],a=t[1],o=n.loop,r=n.autoplay;e.animation=i.loadAnimation({loop:o,autoplay:r,container:e.refDiv.current,renderer:"svg",animationData:a})}}))},t.prototype.render=function(){var e=this.props,t=e.className,n=e.border,i=this.state.style,o=a.default.classNames({"wowui-lottie":n},t);return a.default.createElement("div",{ref:this.refDiv,className:o,style:i})},t.Config=r.default,t.preload=function(e){var t=[new Promise((function(e){(0,o.default)((function(t){return e(t)}))}))];e&&(Array.isArray(e)?e:[e]).forEach((function(e){var n=new Promise((function(t){e.loader((function(e){return t(e.default)}))}));t.push(n)}));return Promise.all(t)},t.defaultProps={border:!0},t}(a.PureComponent);t.default=s},5299:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var i=0,a=1},5300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utf8ToUtf16=t.utf16ToUtf8=void 0;t.utf16ToUtf8=function(e){for(var t="",n=0,i=e.length;n<i;++n){var a=e.charCodeAt(n);if(a>=0&&a<=127)t+=String.fromCodePoint(a);else if(a>=128&&a<=2047)t+=String.fromCodePoint(192|31&a>>6),t+=String.fromCodePoint(128|63&a);else if(a>=2048&&a<=55295||a>=57344&&a<=65535)t+=String.fromCodePoint(224|15&a>>12),t+=String.fromCodePoint(128|63&a>>6),t+=String.fromCodePoint(128|63&a);else{if(a>56319)throw Error("must be hight surrogates");var o=e.charCodeAt(++n);if(o<56320||o>57343||isNaN(o))throw new Error("must be low surrogates");var r=65536+(a-55296<<10|o-56320);t+=String.fromCodePoint(240|7&r>>18),t+=String.fromCodePoint(128|63&r>>12),t+=String.fromCodePoint(128|63&r>>6),t+=String.fromCodePoint(128|63&r)}}return t};t.utf8ToUtf16=function(e){for(var t,n,i,a,o=e.length,r="",s=0;s<o;)switch((t=e.charCodeAt(s++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r+=e.charAt(s-1);break;case 12:case 13:n=e.charCodeAt(s++),r+=String.fromCodePoint((31&t)<<6|63&n);break;case 14:n=e.charCodeAt(s++),i=e.charCodeAt(s++),r+=String.fromCodePoint((15&t)<<12|(63&n)<<6|(63&i)<<0);break;case 15:n=e.charCodeAt(s++),i=e.charCodeAt(s++),a=e.charCodeAt(s++),r+=String.fromCodePoint((7&t)<<18|(63&n)<<12|(63&i)<<6|63&a)}return r}},5301:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}));var i=n(238),a=n.n(i);function o(e){var t=e.nodeName;if("#text"===t)return document.createTextNode(e.textContent);for(var n=document.createElementNS("http://www.w3.org/2000/svg",t),i=e.attributes,a=0,r=i.length;a<r;++a){var s=i[a],l=s.name,c=s.value;"xlink:href"===l?n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c):n.setAttribute(l,c)}for(var u=e.childNodes,d=0,h=u.length;d<h;++d)n.appendChild(o(u[d]));return n}function r(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.setAttribute("transform","scale("+t+", "+t+")"),n.appendChild(e),n}function s(e){var t=e.width,n=e.height,o=e.getSvgContentFunc,r=e.scaling;return Object(i.useEffect)((function(){var e=document.querySelector(".preview-svg");e.innerHTML="";var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("version",1.1),i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),i.setAttribute("width",t),i.setAttribute("height",n),i.setAttribute("viewBox","0 0 "+t+" "+n),i.appendChild(o(r)),e.appendChild(i)}),[{width:t,height:n}]),a.a.createElement("div",{className:"preview-svg"})}},5302:function(e,t,n){var i=n(5303),a=n(2144),o=n(2857);e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||a),string:new i}}},5303:function(e,t,n){var i=n(5304),a=n(5309),o=n(5310),r=n(5311),s=n(5312);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=r,l.prototype.set=s,e.exports=l},5304:function(e,t,n){var i=n(2143);e.exports=function(){this.__data__=i?i(null):{},this.size=0}},5305:function(e,t,n){var i=n(3686),a=n(5306),o=n(563),r=n(3687),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||a(e))&&(i(e)?h:s).test(r(e))}},5306:function(e,t,n){var i,a=n(5307),o=(i=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(e){return!!o&&o in e}},5307:function(e,t,n){var i=n(474)["__core-js_shared__"];e.exports=i},5308:function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},5309:function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5310:function(e,t,n){var i=n(2143),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return a.call(t,e)?t[e]:void 0}},5311:function(e,t,n){var i=n(2143),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:a.call(t,e)}},5312:function(e,t,n){var i=n(2143);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},5313:function(e,t){e.exports=function(){this.__data__=[],this.size=0}},5314:function(e,t,n){var i=n(2145),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)}},5315:function(e,t,n){var i=n(2145);e.exports=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},5316:function(e,t,n){var i=n(2145);e.exports=function(e){return i(this.__data__,e)>-1}},5317:function(e,t,n){var i=n(2145);e.exports=function(e,t){var n=this.__data__,a=i(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}},5318:function(e,t,n){var i=n(2146);e.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},5319:function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5320:function(e,t,n){var i=n(2146);e.exports=function(e){return i(this,e).get(e)}},5321:function(e,t,n){var i=n(2146);e.exports=function(e){return i(this,e).has(e)}},5322:function(e,t,n){var i=n(2146);e.exports=function(e,t){var n=i(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}},5323:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},5324:function(e,t,n){var i=n(2144);e.exports=function(){this.__data__=new i,this.size=0}},5325:function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},5326:function(e,t){e.exports=function(e){return this.__data__.get(e)}},5327:function(e,t){e.exports=function(e){return this.__data__.has(e)}},5328:function(e,t,n){var i=n(2144),a=n(2857),o=n(3934);e.exports=function(e,t){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!a||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(r)}return n.set(e,t),this.size=n.size,this}},5329:function(e,t,n){var i=n(474).Uint8Array;e.exports=i},5330:function(e,t,n){var i=n(4422),a=n(3689),o=n(3400);e.exports=function(e){return i(e,o,a)}},5331:function(e,t){e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,a=0,o=[];++n<i;){var r=e[n];t(r,n,e)&&(o[a++]=r)}return o}},5332:function(e,t){e.exports=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},5333:function(e,t,n){var i=n(742),a=n(716);e.exports=function(e){return a(e)&&"[object Arguments]"==i(e)}},5334:function(e,t){e.exports=function(){return!1}},5335:function(e,t,n){var i=n(742),a=n(3401),o=n(716),r={};r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&a(e.length)&&!!r[i(e)]}},5336:function(e,t,n){var i=n(3692),a=n(5337),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return a(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},5337:function(e,t,n){var i=n(4427)(Object.keys,Object);e.exports=i},5338:function(e,t,n){var i=n(1312)(n(474),"DataView");e.exports=i},5339:function(e,t,n){var i=n(1312)(n(474),"Promise");e.exports=i},5340:function(e,t,n){var i=n(1312)(n(474),"WeakMap");e.exports=i},5341:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.includeFileExts=t.cloudType=t.getFileClassByExt=t.getFileNameDesc=t.getFileExt=t.getFileType=void 0;var i={wps:["doc","docx","rtf","txt","xml","mhtml","mht","html","htm","uof","dot","wps","wpt","dotx","docm","dotm"],et:["et","xls","xlt","xlsx","xlsm","xltx","xltm","csv","ett"],ksheet:["ksheet"],wpp:["ppt","pptx","pptm","ppsx","ppsm","pps","potx","potm","dpt","dps","pot"],pdf:["pdf"],otl:["otl"],kw:["kw"],img:["gif","jpg","jpeg","png","bmp"],dbt:["dbt"],pof:["pof"],pom:["pom"]};t.cloudType=i;var a=Object.keys(i).reduce((function(e,t){return e.concat(i[t])}),[]);t.includeFileExts=a;var o=function(e){for(var t=e&&e.toLowerCase(),n=Object.keys(i),a=0;a<n.length;a++){var o=n[a];if(i[o].includes(t))return o}return null};t.getFileClassByExt=o;var r=function(e){return void 0===e&&(e=""),e.split(".").pop()};t.getFileExt=r;t.getFileNameDesc=function(e){void 0===e&&(e="");var t=e.split(".");return t.pop(),t.join(".")};t.getFileType=function(e){var t=r(e);return o(t)}},547:function(e,t,n){"use strict";n.r(t),n.d(t,"cursorTypes",(function(){return r})),n.d(t,"cursorTypeReg",(function(){return a}));var i=n(167),a=/cursor\-\S+(\-big)?/,o=(window.devicePixelRatio||1)>1||i.isIE,r={default:"cursor-default",text:"cursor-text",vertical_text:"cursor-vertical-text",hand:"cursor-hand",normal:o?"cursor-normal-big":"cursor-normal",move:o?"cursor-move-big":"cursor-move",select:o?"cursor-selected-big":"cursor-select",grab:"cursor-grab",grabbing:"cursor-grabbing",col_resize:o?"cursor-col-resize-big":"cursor-col-resize",row_resize:o?"cursor-row-resize-big":"cursor-row-resize",row_select:"cursor-row-select",row_select_left:"cursor-row-select-left",col_select_up:"cursor-col-select-up",col_select_down:"cursor-col-select-down",col_select:"cursor-col-select",cell_select:"cursor-cell-select",right:o?"cursor-right-big":"cursor-right",down:o?"cursor-down-big":"cursor-down",n_resize:o?"cursor-n-resize-big":"cursor-n-resize",e_resize:o?"cursor-e-resize-big":"cursor-e-resize",s_resize:o?"cursor-s-resize-big":"cursor-s-resize",w_resize:o?"cursor-w-resize-big":"cursor-w-resize",ne_resize:o?"cursor-ne-resize-big":"cursor-ne-resize",nw_resize:o?"cursor-nw-resize-big":"cursor-nw-resize",se_resize:o?"cursor-se-resize-big":"cursor-se-resize",sw_resize:o?"cursor-sw-resize-big":"cursor-sw-resize",ns_resize:"cursor-ns-resize",ew_resize:"cursor-ew-resize",nesw_resize:"cursor-nesw-resize",nwse_resize:"cursor-nwse-resize",zoom_in:"cursor-zoom-in",zoom_out:"cursor-zoom-out",format_painter:"cursor-format-painter",et_format_painter:"cursor-et-format-painter",wps_format_painter:"cursor-wps-format-painter",normal_big:"cursor-normal-big",move_big:"cursor-move-big",right_big:"cursor-right-big",down_big:"cursor-down-big",selected_big:"cursor-selected-big",nw_resize_big:"cursor-nw-resize-big",n_resize_big:"cursor-n-resize-big",ne_resize_big:"cursor-ne-resize-big",w_resize_big:"cursor-w-resize-big",sw_resize_big:"cursor-sw-resize-big",s_resize_big:"cursor-s-resize-big",se_resize_big:"cursor-se-resize-big",e_resize_big:"cursor-e-resize-big",col_resize_big:"cursor-col-resize-big",row_resize_big:"cursor-row-resize-big",not_allowed:"cursor-not-allowed",footnote_placeholder:"cursor-footnote-placeholder"}},564:function(e,t,n){"use strict";var i,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getEditModeQueryPair=t.isNewFile=t.isEditEnterMode=t.closeReadingMode=t.isReadingMode=void 0;var r=n(5).__importStar(n(167)),s=n(14),l=!!(null===(o=null===(a=null===(i=window.__WPSENV__)||void 0===i?void 0:i.file_info)||void 0===a?void 0:a.file)||void 0===o?void 0:o.corp_id),c=r.isMobile;t.isReadingMode=function(){var e,t,n;return(null===(t=null===(e=window.APP)||void 0===e?void 0:e.isReadOnly)||void 0===t?void 0:t.call(e))&&"read"===(null===(n=window.__WPSENV__)||void 0===n?void 0:n.enterMode)&&l&&!c},t.closeReadingMode=function(){(0,s.setQuery)("enterMode","edit"),location.reload()},t.isEditEnterMode=function(){return"edit"===(0,s.getQuery)("enterMode")},t.isNewFile=function(){return"true"===(0,s.getQuery)("newFile")},t.getEditModeQueryPair=function(){return{enterMode:"edit"}}},5907:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;a()(this,e),this._max=t,this._keyList=[],this._map={}}return r()(e,[{key:"reset",value:function(){this._keyList=[],this._map={}}},{key:"destroy",value:function(){delete this._keyList,delete this._map,this._keyList=[],this._map={}}},{key:"_updateLRU",value:function(e){for(var t=this._keyList,n=t.indexOf(e);n>-1;)t.splice(n,1),n=t.indexOf(e);t.unshift(e)}},{key:"delete",value:function(e){delete this._map[e];for(var t=this._keyList,n=t.indexOf(e);n>-1;)t.splice(n,1),n=t.indexOf(e)}},{key:"set",value:function(e,t){for(this._map[e]=t,this._updateLRU(e);this.size()>this._max;)this.pop()}},{key:"pop",value:function(){var e=this._keyList.pop(),t=this._map[e];return delete this._map[e],t}},{key:"get",value:function(e){var t=this._map[e];return t&&this._updateLRU(e),t}},{key:"size",value:function(){return this._keyList.length}},{key:"isFull",value:function(){return this.size()>=this._max}}]),e}();!function(){function e(t){a()(this,e),this._imageSha1={},this._sha1Base64={}}r()(e,[{key:"isFull",value:function(){return!1}},{key:"set",value:function(e,t){var n=t&&t.data;n&&n.sha1&&(this._imageSha1[e]=n.sha1,this._sha1Base64[n.sha1]={data:t,timestamp:Date.now()},this.clean())}},{key:"get",value:function(e){var t=this._imageSha1[e],n=this._sha1Base64[t];if(t&&n)return n.timestamp=Date.now(),n.data}},{key:"setSha1",value:function(e,t){e&&t&&(this._imageSha1[e]=t)}},{key:"destroy",value:function(){delete this._imageSha1,this._imageSha1={},this.clean()}},{key:"clean",value:function(){var e=Object.values(this._sha1Base64);if(e.length>50){e.sort((function(e,t){return e.timestamp-t.timestamp}));for(var t=0;t<e.length-50;t++){var n=e[t],i=n&&n.data.sha1;i&&delete this._sha1Base64[i]}}}}])}()},5908:function(e,t,n){var i=n(3934),a=n(8848),o=n(8849);function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new i;++t<n;)this.add(e[t])}r.prototype.add=r.prototype.push=a,r.prototype.has=o,e.exports=r},5909:function(e,t){e.exports=function(e,t){return e.has(t)}},5910:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return f}));var i=n(13),a=n.n(i),o=n(1639);function r(e,t,n,i,r){var s=i.pos,l=i.len,c=i.type,u=void 0===c?o.RichText:c,d=i.title,h=i.tag,p=i.placeholderText,f=i.args,g=i.displayFormat,v=n.selection,y=n.api;if(!y.isConnected()||y.hasBlocking())return!1;var m=a()({pos:s,len:l,type:u,title:d,tag:h,placeholderText:p},g?{displayFormat:g}:{});Object.assign(m,f),m.bSendSelectionBack=!0;var _=v.selContext.ipChpx;return _&&(m.ipChpx=_),m.woUserID=e.userTagId,t.cmdExecutor.sendCommandBlock({name:"addContentControl",param:m},r),!0}function s(e,t,n,i,a,o){var r=t.api,s=t.selection;if(r.isConnected()&&!r.hasBlocking()){var l={pos:n,len:i,type:a,index:o,bSendSelectionBack:!0},c=s.selContext.ipChpx;c&&(l.ipChpx=c),e.cmdExecutor.sendCommandBlock({name:"insertContentControl",param:l})}}function l(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments[5],r=t.doc,s=t.api;if(s.isConnected()&&!s.hasBlocking()){var l=r.contentControls.findControl(n,i);if(!l){var c=r.repeatSecItems.findControl(n,i),u=c&&c.parent;if(u){var d={pos:u.pos,len:u.len,secItemRange:{pos:n,len:i},bSendSelectionBack:!0};return void e.cmdExecutor.sendCommandBlock({name:"removeRepeatSecItem",param:d},o)}}var h={pos:n,len:i,type:l&&l.type,bSendSelectionBack:!0,keepContent:a};e.cmdExecutor.sendCommandBlock({name:"deleteContentControl",param:h},o)}}function c(e,t,n,i,a){var o=t.api;if(o.isConnected()&&!o.hasBlocking()){n.data.private.title=i;var r={pos:n.pos,len:n.len,title:i};e.cmdExecutor.sendCommandBlock({name:"setControlTitle",param:r},a)}}function u(e,t,n,i,a){var o=t.api;if(o.isConnected()&&!o.hasBlocking()){n.data.private.tag=i;var r={pos:n.pos,len:n.len,tag:i};e.cmdExecutor.sendCommandBlock({name:"setControlTag",param:r},a)}}function d(e,t,n,i){var a=i.pos,o=i.len,r=i.to,s=i.inherit,l=void 0!==s&&s,c=i.type,u=n.api,d=n.selection;if(u.isConnected()&&!u.hasBlocking())if(d.inOMath||d.hasOMath)window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.notSupportMoveToMath", "Formulas do not support inserting pictures, controls, or other content."));else{var h={pos:a,len:o,to:r,inherit:l,bSendSelectionBack:!0,type:c};h.woUserID=e.userTagId,t.cmdExecutor.sendCommandBlock({name:"moveContent",param:h})}}function h(e,t,n){var i=t.api;if(i.isConnected()&&!i.hasBlocking())return n.bSendSelectionBack=!0,e.cmdExecutor.exec({name:"editContentControl",param:n}),!0}function p(e,t,n,i,a,o,r,s){var l=n.api;if(l.isConnected()&&!l.hasBlocking()){var c={pos:i,len:a,index:o,name:r};return c.woUserID=e.userTagId,t.cmdExecutor.sendCommandBlock({name:"selectDropdownListEntry",param:c},s),!0}}function f(e,t,n,i){var a=n.pos,o=n.len,r=n.secItemPos,s=n.secItemLen,l=n.after,c=void 0===l||l,u=t.api;if(!u.isConnected()||u.hasBlocking())return!1;var d={pos:a,len:o,after:c,secItemRange:{pos:r,len:s},bSendSelectionBack:!0};return e.cmdExecutor.sendCommandBlock({name:"addRepeatSecItem",param:d},i),!0}},5911:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return h}));var i=n(1238);function a(e,t){return e.doc.documentFields.getFields({begin:t,end:t+1}).some((function(e){return e._node&&e._node.readonly}))}function o(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments[5],r=t.api,s=t.selection;if(r.isConnected()&&!r.hasBlocking()){var l=i||s.getNormalRange(),c={pos:l.pos,len:l.len,name:n};Object.keys(a).forEach((function(e){c[e]=a[e]}));var u={name:"insertDocumentField",param:c,cb:o};e.cmdExecutor.exec(u)}}function r(e,t,n,i){var a=t.api;if(a.isConnected()&&!a.hasBlocking()){var o={name:"insertDocumentFields",param:n,cb:i};e.cmdExecutor.exec(o)}}function s(e,t,n,i,a){var o=t.api;if(o.isConnected()&&!o.hasBlocking()){var r={index:n};Object.keys(i).forEach((function(e){r[e]=i[e]})),e.cmdExecutor.exec({name:"documentFieldOp",param:r,cb:a})}}function l(e,t,n,i){var a=t.api;a.isConnected()&&!a.hasBlocking()&&e.cmdExecutor.exec({name:"allDocumentFieldOp",param:n,cb:i})}function c(e,t,n,i,a){var o=t.api;if(o.isConnected()&&!o.hasBlocking()){var r={index:n,value:i};e.cmdExecutor.exec({name:"setDocumentFieldValue",param:r,cb:a})}}function u(e,t,n,i,a){var o=t.api;if(o.isConnected()&&!o.hasBlocking()){var r={index:n,deleteWithContent:!!i.DeleteWithContent};e.cmdExecutor.exec({name:"deleteDocumentField",param:r,cb:a})}}function d(e,t,n,i){var a=t.selection,o=t.doc.documentFields;if(i){if(!a.selContext.activeDocumentFieldNames||!a.selContext.activeDocumentFieldNames.length)return!1;if(o.getFieldByName(a.selContext.activeDocumentFieldNames[0]).len>0)return!1}var r=[];return o.getFields({begin:n,end:n+1}).forEach((function(e){var t=e._node;0==t.len&&(r.push(t.name),o.deleteDocumentField(t))})),!!r.length&&(function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=t.api;if(o.isConnected()&&!o.hasBlocking()){var r={indexs:n,deleteWithContent:!!i.DeleteWithContent};e.cmdExecutor.exec({name:"deleteDocumentFields",param:r,cb:a})}}(e,t,r),!0)}function h(e,t){for(var n=e.selection,a=e.doc,o=t.begin,r=a.documentFields.getFields({begin:o,end:o}).map((function(e){return e._node})).sort((function(e,t){var n=e.pos,i=t.pos;if(n===i){var a=n+e.len-(i+t.len);return 0==a?e.name<t.name?-1:1:a}return i-n}));r.length&&r[0]!=t;)r.splice(0,1);var s=r.map((function(e){return e.name}));Object(i.typoToPositionWithLoading)(t.end).then((function(){n.selCoop.locate(t.end,{documentFieldNames:s,delaySetPosition:200})}),(function(){}))}},6003:function(e,t,n){"use strict";n.d(t,"d",(function(){return se})),n.d(t,"i",(function(){return ee})),n.d(t,"h",(function(){return de})),n.d(t,"e",(function(){return pe})),n.d(t,"g",(function(){return Be})),n.d(t,"b",(function(){return Le})),n.d(t,"k",(function(){return Ie})),n.d(t,"c",(function(){return Re})),n.d(t,"a",(function(){return Oe})),n.d(t,"l",(function(){return Z})),n.d(t,"f",(function(){return Me})),n.d(t,"j",(function(){return Ae}));var i,a=n(80),o=n.n(a),r=n(13),s=n.n(r),l=n(144),c=n.n(l),u=n(310),d=n(811),h=n(4113),p=n(1145),f=n(1),g=n.n(f),v=n(2),y=n.n(v),m=n(324),_=n(309),x=n(167),w=n(1734),k=n(2502),b=n(1731),T=[m.f,m.B,m.A,m.r,m.w],C=["(","（","[","第","例"],S=[".","．","、",")","）",">","-","，"],E=["]","章","节","条","天","段","篇","项","部","课","讲"],P=[" ","\t"],L="节",A="条",I=[{nfc:k.b,radix:10,mapping:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9}},{nfc:k.r,radix:10,mapping:{"０":0,"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9}},{nfc:k.i,radix:10,mapping:{"〇":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"十":10}},{nfc:k.O,radix:10,mapping:{i:1,v:5,x:10}},{nfc:k.db,radix:10,mapping:{I:1,V:5,X:10}},{nfc:k.N,radix:26,mapping:{a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,j:10,k:11,l:12,m:13,n:14,o:15,p:16,q:17,r:18,s:19,t:20,u:21,v:22,w:23,x:24,y:25,z:26}},{nfc:k.cb,radix:26,mapping:{A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:10,K:11,L:12,M:13,N:14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26}},{nfc:k.y,radix:10,mapping:{"①":1,"②":2,"③":3,"④":4,"⑤":5,"⑥":6,"⑦":7,"⑧":8,"⑨":9,"⑩":10,"⑪":11,"⑫":12,"⑬":13,"⑭":14,"⑮":15,"⑯":16,"⑰":17,"⑱":18,"⑲":19,"⑳":20}},{nfc:k.j,radix:10,mapping:{"零":0,"壹":1,"贰":2,"叁":3,"肆":4,"伍":5,"陆":6,"柒":7,"捌":8,"玖":9}},{nfc:k.gb,radix:10,mapping:{"甲":1,"乙":2,"丙":3,"丁":4,"戊":5,"己":6,"庚":7,"辛":8,"壬":9,"癸":10}}],R=function(){function e(t,n){g()(this,e),this.doc=t,this.sel=n}return y()(e,[{key:"canTurnChar2AutoNum",value:function(e,t){var n=this.doc.getDataLogic("final"),i=n.getPapx(e);if(this.sel.selInfo.getListType()!==w.b||i.len<3)return!1;var a=this.doc.contentControls.collect(i.pos,i.len);if(a&&a.length>0)return!1;if(this.isCaption(this.doc.stylesheet,i.prop.basestyle))return!1;for(this.text=n.getText(i.pos,i.len-1),this.len=this.text.length,this.off=0;this.off<this.len&&!(T.indexOf(this.text.charCodeAt(this.off))<0);++this.off);if(this.len-this.off<3)return!1;if(this.prefix=this.text[this.off],C.indexOf(this.prefix)>=0?++this.off:this.prefix="",!this.parseAutoNum())return!1;if(!this.parseSuffix(t))return!1;if(!this.bFollowCharEnd){var o=this.text[this.off];if(o>="0"&&o<="9")return!1}return!(1===t&&this.off>=this.len)&&(console.log("📌[AUTONUM] ",this),!0)}},{key:"isCaption",value:function(e,t){if(!t||0===t.id)return!1;if(t.id===b.a)return!0;var n=e.findStyle(t.id);return!!n&&(!(!n.linkStyle||n.linkStyle.id===t.id||!this.isCaption(e,n.linkStyle))||!(!n.nextstyle||n.nextstyle.id===t.id||!this.isCaption(e,n.nextstyle)))}},{key:"getFormat",value:function(e){for(var t=void 0,n=0;n<I.length;++n)if(I[n].mapping[e]>=0){t=I[n];break}return t}},{key:"parseAutoNum",value:function(){var e=this.text[this.off];if(this.format=this.getFormat(e),!this.format)return!1;++this.off;var t=this.format,n=t.nfc,i=t.radix,a=t.mapping;if(this.levels=[a[e]],0===this.levels[0])return!0;if(n===k.O)return this.parseRoman(["i","v","x"],e);if(n===k.db)return this.parseRoman(["I","V","X"],e);if(n!==k.b&&n!==k.r&&n!==k.i)return!0;for(var o=this.levels[0]>=i,r=!1;;){if(this.off>=this.len)return!1;e=this.text[this.off];var s=this.getFormat(e);if(!s){if(n!==k.b&&n!==k.r||"."!==e&&"-"!==e)break;if(this.levels.length>=9)break;if(this.off+1===this.len)return!1;if(e=this.text[this.off+1],!(s=this.getFormat(e))||s.nfc!==n)break;this.levels.push(0),++this.off}if(r)return!1;if(s.nfc!==n)return!1;++this.off;var l=this.levels.length-1,c=a[e];if(n===k.i){if(c>=i)return!1;o&&(this.levels[l]/=i,r=!0)}if(this.levels[l]=i*this.levels[l]+c,this.levels[l]>9999)return!1}return!0}},{key:"parseRoman",value:function(e,t){var n=!1,i=e[0],a=e[1],o=e[2];if(t===o){for(var r=1;this.off<this.len;){var s=this.text[this.off++];if(s!==o){if(s===a)return this.levels[0]+=5,this.parseRoman(e,s);if(s===i)return this.levels[0]+=1,this.parseRoman(e,s);--this.off;break}if(++r>3)return!1;this.levels[0]+=10}n=!0}else if(t===a){for(var l=0;this.off<this.len;){if(this.text[this.off]!==i)break;if(++l>3)return!1;++this.off}this.levels[0]+=l,n=!0}else if(t===i){var c=this.text[this.off++];if(c===a)this.levels[0]+=3;else if(c===o)this.levels[0]+=8;else if(c===i){this.levels[0]+=1,this.text[this.off]===i&&(this.levels[0]+=1,++this.off)}else--this.off;n=!0}return n}},{key:"parseSuffix",value:function(e){var t=this.levels.length;if(t>1&&"["===this.prefix)return!1;if(this.off+1>=this.len)return!1;this.suffix="",this.followChar="",this.bFollowCharEnd=!1;for(var n=!1,i=1===e,a=!1,o=!1,r=!1,s=!1,l=this.format.nfc,c=0;c<4;++c){var u=this.text[this.off++];if(!u)return!1;if(P.indexOf(u)>=0)return(!a||"第"===this.prefix)&&((1!==t||0!==c||!this.isExceptFmt(e,l,u))&&(this.bFollowCharEnd=!0,this.followChar=u,!0));if(u.charCodeAt(0)===m.r)return(!a||"第"===this.prefix)&&((1!==t||0!==c||!this.isExceptFmt(e,l,u))&&(this.suffix+=u,!0));if(n)return--this.off,!0;if(S.indexOf(u)>=0)this.suffix+=u,n=!0,a=!1;else{if(i){if(1===t&&E.indexOf(u)>=0){a="]"!==u,o="部"===u,s="]"===u,r="课"===u,this.suffix+=u,i=!1;continue}if(t>1&&[L,A].indexOf(u)>=0){a=!0,this.suffix+=u,i=!1;continue}}if(o&&"分"===u)o=!1,this.suffix+=u;else{if(!r||"时"!==u)return--this.off,s;r=!1,this.suffix+=u}}}return!0}},{key:"isExceptFmt",value:function(e,t,n){if([m.A,m.B,m.r].indexOf(n.charCodeAt(0))<0)return!1;if([k.N,k.cb,k.O,k.db,k.i,k.j,k.gb,k.r].indexOf(t)>=0)return!0;if(t===k.b){if(1!==e)return!0;if(n.charCodeAt(0)===m.A)return!0}return!1}}]),e}(),O=function(e){return e===m.B||e===m.x||e===m.A||e===m.w||e===m.r||e===m.j},M=function(e,t,n){if(n&&(1!==n.length||!O(n.charCodeAt(0))))return!1;if(e.mathManager.getMath(t,!0))return!1;if(e.getSubDocType(t)===_.Comment)return!1;var i=e.textStream.getPapxTbl().findNodeContainPos(t),a=Math.max(t-256,i.begin),o=e.getText(a,t-a);if(!o)return!1;for(var r=o.length-1;r>=0;--r){var s=o.charCodeAt(r);if(O(s))break}return function(e){return e.length>6&&0===e.indexOf("ftp://")||e.length>4&&0===e.indexOf("www.")||e.length>7&&0===e.indexOf("http://")||e.length>8&&0===e.indexOf("https://")}(o.substr(r>=0?r+1:0).toLowerCase())},D=function(){function e(t){g()(this,e),this.editor=t}return y()(e,[{key:"apply",value:function(e,t,n){var i=e.doc;i.settings.getAutoApplyAsYouTypeAdjustWordWrap()&&this._applyAdjustWordWrap(i,t,n)}},{key:"_applyAdjustWordWrap",value:function(e,t,n){if(n&&1!==n.length)return!1;var i=n.charCodeAt();if(i==m.A||i==m.r){if(t.len>0)return!1;var a=e.datalogics.final.getPapx(t.pos);return!!a.good&&(a.prop.getPropVal("horizontal_align_mode")==d.i.Right&&(a.end-t.pos==2&&(a.prop.getPropVal("word_wrap")||this.editor.paraFormat.setWordWrap(!0),!0)))}if(i==m.l){var o=e.datalogics.final.getPapx(t.pos);if(!o.good)return!1;if(o.prop.getPropVal("horizontal_align_mode")!=d.i.Right)return!1;if(!o.prop.getPropVal("word_wrap"))return!1;var r=e.datalogic.final.getNextPapx(o);return 1==r.len&&(r.prop.getPropVal("word_wrap")&&this.editor.paraFormat.setWordWrap(!1),!0)}return!1}}]),e}(),N=n(1104),B=n(772),j=n(4751),F=n(1916),H=n(4112),G=n(2180),U=n(1590),W=n(698),Y=n(260),z=n(1917),X=n(3861),V=n(1033),q=n(6749),K=n(2309),Q=n(3427),J=n(4429),Z=(i=o()(regeneratorRuntime.mark((function e(t,n,i){var a,o,r,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=n.api).isConnected()&&!a.hasBlocking()){e.next=3;break}return e.abrupt("return",!1);case 3:if(!Array.isArray(i)){e.next=14;break}o=0;case 5:if(!(o<i.length)){e.next=13;break}return r=i[o],l=r.key,c=r.value,u=s()({isWildcardMatched:!1,isCaseSensitive:!1,isWholeWordMatched:!1,isWidthIgnored:!1},i[o].options||{}),e.next=10,De(t,s()({pos:0,len:0,FindText:l,ReplaceWith:c,Replace:2,Forward:!0,FindScope:0},u.isWildcardMatched?{MatchCase:!0,MatchWholeWord:!1,MatchByte:!0}:{MatchCase:u.isCaseSensitive,MatchWholeWord:u.isWholeWordMatched,MatchByte:!u.isWidthIgnored}));case 10:o++,e.next=5;break;case 13:return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)}),$=String.fromCharCode(m.f);function ee(e){var t=e.selection,n=e.doc,i=t.begin.position,a=t.end.position;if(void 0===i||void 0===a)return!1;var o=n.locateStory(i);return o&&o.contain(a)}function te(e){return 140-e.wordStat.wordCount+e.selection.selInfo.getWordCount()}function ne(e,t){var n=t.selection,i=t.doc,a=n.begin.position;if(n.end.position!==a||void 0===a)return!1;var o=i.getDataLogic("final").getPapx(a),r=t.selection.selInfo.getListType();return(r===w.a||r===w.c)&&(!(o.len>1)&&(0===o.prop.list_level?e.paraFormat.setList(0,r===w.a):e.paraFormat.changeIndent(!1),!0))}function ie(e,t){if(!e.isPalaceMuseumTemplate)return!0;for(var n=e.contentControls.collect(t.pos,t.len),i=0;i<n.length;++i){if("picture"===n[i].title)return!1}return!0}function ae(e,t,n){var i=n.pos,a=n.len,o=t.contentControls.collect(i,a).sort((function(e,t){return t.pos-e.pos}));if(!o.length)return!0;var r=c()(o,1)[0],s=function(e,t,n){return e>n.pos&&e<n.pos+n.len||e===n.pos&&t}(i,a,r);switch(!0){case r.isDate:return!s;case r.isPureText:return r.multiLine;case r.isCheckBox||r.isComboBox:return!s;case r.isRichText:return!e.selInfo._isHitOnInlineCtrl(r,o);default:return!0}}function oe(e,t){var n=e.selection,i=e.doc;if(void 0!==t.revision&&delete t.revision,t.special=!1,delete t.symbol_fontname,delete t.symbol_char,t.asian_layout||t.fit_text_id){var a=n.getNormalRange();if(0===a.len){var o=i.getDataLogic("final");if(o.atPapxBound(a.pos))t.asian_layout&&delete t.asian_layout,t.fit_text_id&&(delete t.fit_text_id,delete t.fit_text,delete t.character_scale,delete t.spacing);else{var r=o.getChp(a.pos);if(t.asian_layout){var s=r.getPropVal("asian_layout");s&&!Object(d.k)(t.asian_layout!=s)||delete t.asian_layout}if(t.fit_text_id){var l=r.getPropVal("fit_text_id");t.fit_text_id!==l&&(delete t.fit_text_id,delete t.fit_text,delete t.character_scale,delete t.spacing)}}}}if(t.script_pos){var c=n.getNormalRange();if(0===c.len)i.getDataLogic("final").atPapxBound(c.pos)?[m.q,m.l].includes(i.getText(c.pos,1).charCodeAt(0))&&delete t.script_pos:i.getText(c.pos-1,1).charCodeAt(0)===m.q&&delete t.script_pos}return t}function re(e){if(e&&e.getPropVal("right_to_left_text"))return e.getPropVal("complex_language")}function se(e,t){if(t.selContext.isInComment()){var n={commentId:t.selContext.getCommentId(),isReplyComment:t.selContext.isReplyComment};return window.APP.isReadOnlyComment()&&(n.commentType=t.selContext.getCommentType()),n}return{}}function le(e,t,n,i){if(window.APP.formatContentController.isRestrictEditMode){i.isRestrictEditMode=!0;var a=e.fieldManager.getField(t.pos);if(a&&"FORMTEXT"===a.getType()){i.isInTextFormField=!0;var o=a.getResultRange(),r=a.maxLength;if(n&&(i.composingFieldLength=o.len,i.maxLength=r),r>0&&o.len>=r&&!e.selection.isComposing&&!n)return!0}}return!1}function ce(e,t,n){var i={isInCatalogs:!1},a=e.data.selection.activeCatalogs;return a&&a.some((function(e){var a=e.begin,o=e.end;if(a<t&&o>t+n)return i.isInCatalogs=!0,!0})),i}function ue(e){return!(!e||e.state!=z.a.CompositionEnd)}function de(e,t,n,i,a){if(!n.selection.selInfo.info.isSelectionRangeNonEditable){var o=i||"";if(ee(n)){if(n.doc.isPalaceMuseumTemplate){if(!function(e,t,n){return!(te(t)<=0&&0!==n.trim().length)}(0,n,o))return void window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.wordCountLimitNotice", "Input limit of 140 characters"));o=function(e,t){if(0===e.trim().length||e.trim().length<=t)return e;var n=e.replace(/(([\d+|[a-z]+|[A-Z]+]))+/g," $1 ").match(/[\u00ff-\uffff]|\S+/g);n.length>t&&window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.wordCountLimitNotice", "Input limit of 140 characters"));var i=n[t-1];if(!i)return e;var a=e.indexOf(i,t-1);return e.slice(0,a+1)}(o,te(n))}(function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=n.selection,r=n.doc,l=n.api,c=i,u=o.getActiveAreaNormalRanges(),d=u.length,f=u[0];if(f.pos>u[d-1].pos&&(f=u[d-1]),ie(r,f)){o.activeShapeIdxPath&&(f.len=0);var g=a.state,v=ue(a);o.updateCompositionState(g);var y={isRestrictEditMode:!1,isInTextFormField:!1,maxLength:0,composingFieldLength:0};if(!le(n,f,v,y)){var m=void 0,_=o.selContext.ipChpx,w=window.g_rpt.getLastLocalCommand();!x.isMobile&&e.isEnableComposition()||(o.isComposing||v)&&w&&w.param&&w.param.ipChpx&&w.param.isComposing&&(_=w.param.ipChpx),_||(m=oe(n,a.replace?o.selInfo.getReplaceChpx():o.selInfo.getChpx()));var k=!x.isMobile&&e.isEnableComposition()&&o.isComposing;if(m&&(a.ignoreShareHint&&m.setProps({share_hint:0}),a.special&&m.setProps({special:!0}),k&&(m.setProps({underline:0}),m.setProps({underline_type:U.wpsUnderlineNone}),m.setProps({underline_color:h.a}))),_&&(a.ignoreShareHint&&(_.shareHint=0),a.special&&(_.special=!0),k&&(_.underlineType=U.wpsUnderlineNone,_.underlineColor=h.a),delete _.symbol_fontname,delete _.symbol_char),!_&&o.inOMath){var b=o.begin.position,T=r.mathManager.getMath(b);T.pos===b&&((_=Object(X.i)(m,r)).fontName=r.fonttable.getName(m.font_name_ascii||m.font_name_ftcbi))}if(a.replace){var C=/(\r\n)|(\r)|(\n)/g;C.test(c)&&(ae(o,r,f)||(c=c.replace(/(\r\n)|(\r)|(\n)/g," ")))}o._needUpdatePosition()&&v&&w&&w.param&&w.param.string&&(c=w.param.string);var S=o.isComposing||v?0:f.len,E=re(m),P=s()({pos:f.pos,len:S,string:c,strlen:c.length,ipChpx:_,chpx:m,woUserID:e.userTagId,language:E,isMathEdit:r.mathManager.isMathEdit(),subDocType:r.getSubDocType(f.pos)},se(0,o),ce(e,f.pos,S)),L=[];if(o.selContext.activeDocumentFieldNames&&o.selContext.activeDocumentFieldNames.length){var A=[],I=r.documentFields;o.selContext.activeDocumentFieldNames.forEach((function(e){var t=I.getFieldByName(e);if(t&&!t.readonly){var n=t.pos,i=n+t.len;n!=P.pos&&i!=P.pos+f.len||(A.push(e),L.push(t))}})),A.length&&(P.extendDocumentFieldNames=A)}_&&Object(p.b)(_.fontName)&&(_.isCJK=!0),a.replace&&P.len>0&&(P.delStr=Object(W.getDeletedTextFromRange)(n,P.pos,P.len)),void 0!==a.cleanCopyData&&(P.cleanCopyData=a.cleanCopyData),void 0!==a.bTickCharOpr&&(P.bTickCharOpr=a.bTickCharOpr);var R=o.selContext.activeDocumentFieldNames;if(R&&R.length||(R=[]),x.isMobile||!e.isEnableComposition()){if(o.isComposing||0==c.length&&v){if(o._needUpdatePosition())return;var O={name:"insertTextForMobileComposing",param:P};if(P.composingAllowCommand=!0,!t.cmdExecutor.exec(O))return;return L.length&&r.documentFields.extendDocumentFields(L,P.pos,P.strlen),o.selCoop.updateCompositionRange(),o._dispatch("onUILOperationTriggered",P.pos,P.pos+P.strlen,{isEditing:!0,isComposing:o.isComposing,documentFieldNames:R}),void o.onCmdExec()}}else{if(o.isComposing){o.clearCache(),P.composingAllowCommand=!0;var N={name:"insertTextForPCComposing",param:P};if(!t.cmdExecutor.exec(N))return;return L.length&&r.documentFields.extendDocumentFields(L,P.pos,P.strlen),o.selCoop.updateCompositionRange(),o._dispatch("onUILOperationTriggered",P.pos,P.pos+P.strlen,{isEditing:!0,isComposing:o.isComposing,documentFieldNames:R}),void o.onCmdExec()}if(v){P.composingAllowCommand=!0;var B={name:"closeComposingTransact",param:P},j=t.cmdExecutor.exec(B);if(!j||!j.result)return void console.error("closeComposingTransact error");if(P.pos=j.pos,0===c.length)o.clearCache();else{if(P.bSendSelectionBack=!1,y.isRestrictEditMode&&y.isInTextFormField&&y.maxLength>0){var F=y.maxLength,H=y.composingFieldLength;if(F<H){var G=H-c.length;P.string=P.string.substr(0,F-G),P.strlen=F-G}if(P.strlen<=0)return void o.setPosition(P.pos,P.pos)}if(B={name:"insertText",param:P},!t.cmdExecutor.exec(B))return}L.length&&r.documentFields.extendDocumentFields(L,P.pos,P.strlen);var z=null;return z=a.isUseUserClickPosition?a.isUseUserClickPosition:P.pos+P.strlen,void o._dispatch("onUILOperationTriggered",z,null,{isEditing:!0,isCompositionEnd:v,documentFieldNames:R})}}if(r.useLowPerformanceMode){if(l.isConnected()&&!l.hasBlocking()){if(M(r,P.pos,c)&&(P.autoFormat=!0,P.usingHttps=!0),P.bSendSelectionBack=!0,window.g_rpt.isTransactCanMerge()&&window.g_rpt.closeLastTransact(),!t.cmdExecutor.sendCommandBlock({name:"insertText",param:P}))return;L.length&&r.documentFields.extendDocumentFields(L,P.pos,P.strlen),o.onCmdExec(),Y.default.dispatchEvent(Y.default.edit.ON_AUTO_FORMAT_BY_INSERT_TEXT)}}else{if(l.isConnected()&&!l.hasBlocking()&&M(r,P.pos,c)){if(P.autoFormat=!0,P.usingHttps=!0,P.bSendSelectionBack=!0,window.g_rpt.isTransactCanMerge()&&window.g_rpt.closeLastTransact(),!t.cmdExecutor.sendCommandBlock({name:"insertText",param:P}))return;Y.default.dispatchEvent(Y.default.edit.ON_AUTO_FORMAT_BY_INSERT_TEXT)}else{P.composingAllowCommand=!0;var V={name:"insertTextForSel",param:P};if(!t.cmdExecutor.exec(V))return;var q=new D(t);q.apply({doc:r},{pos:P.pos,len:0},P.string)}L.length&&r.documentFields.extendDocumentFields(L,P.pos,P.strlen);var K=o._needUpdatePosition();if(!K||K&&o.isComposing&&v){var Q=void 0!==P.insertPos?P.insertPos:P.pos;o._dispatch("onUILOperationTriggered",Q+P.strlen,null,{isEditing:!0,isCompositionEnd:v,documentFieldNames:R,shouldBlur:a.shouldBlur})}else o.clearManualState()}o.onCmdExec(),x.isMobile&&!a.isPaste&&(e.uilManager.collectionInfoRecorder.hasInputTextBeforeKeyboardPickUp=!0,e.uilManager.collectionInfoRecorder.inputTime=Date.now())}}})(e,t,n,o=function(e,t,n,i){return n}(n.selection,n.doc,o),a),e.workspace.makesureCursorVisible()}}}function he(e,t,n){var i=n.selection,a=n.doc,o=n.api,r=i.getActiveAreaNormalRanges(),l=r.length,c=r[0];if(c.pos>r[l-1].pos&&(c=r[l-1]),i.activeShapeIdxPath&&(c.len=0),ae(i,a,c)){var d=function(e,t,n){var i=e.getLimitedRange(t);return{pos:t,len:Math.min(i.pos+i.len-1,n)-t}}(a,c.pos,c.pos+c.len);d&&(c.pos=d.pos,c.len=d.len);var h=s()({pos:c.pos,len:c.len,paraCount:1,subDocType:a.getSubDocType(c.pos)},se(0,i));if(h.deleteCellRanges=Se(i,!0).cells,i.selContext.activeDocumentFieldNames&&i.selContext.activeDocumentFieldNames.length){var p=[],f=a.documentFields;i.selContext.activeDocumentFieldNames.forEach((function(e){var t=f.getFieldByName(e);if(t&&!t.readonly){var n=t.pos,i=n+t.len;n!=h.pos&&i!=h.pos+c.len||p.push(e)}})),p.length&&(h.extendDocumentFieldNames=p)}if(a.useLowPerformanceMode){if(o.isConnected()&&!o.hasBlocking())return M(a,h.pos)&&(h.autoFormat=!0,h.usingHttps=!0),h.bSendSelectionBack=!0,window.g_rpt.isTransactCanMerge()&&window.g_rpt.closeLastTransact(),void(t.cmdExecutor.sendCommandBlock({name:"insertParagraph",param:h})&&(i.setPosition(c.pos+1,null,{isEditing:!0}),i.onCmdExec()))}else{var g=function(e,t,n){return!x.isMobile&&(window.APP.data.doc.getSubDocType(n)!==_.Comment&&new R(e,t).canTurnChar2AutoNum(n,1))}(a,i,h.pos),v=M(a,h.pos);if(o.isConnected()&&!o.hasBlocking()&&(v||g)){if(h.autoFormat=v,h.usingHttps=v,h.applyList=g,h.bSendSelectionBack=!0,window.g_rpt.isTransactCanMerge()&&window.g_rpt.closeLastTransact(),!t.cmdExecutor.sendCommandBlock({name:"insertParagraph",param:h}))return}else if(1===l&&0===c.len&&i.selInfo.getPapx().table_row){if(t.insertRowBelow())return}else{var y={name:"insertParagraph",param:h};if(0===h.len){var m=a.datalogics.final.getPapx(h.pos),w=m&&m.pos||0;if(h.pos>w){for(var k=h.pos-1;k>=w&&a.getText(k,1)===$;)--k;k<w&&(h.pos=w)}}if(!t.cmdExecutor.exec(y))return}}var b=i.selContext.activeDocumentFieldNames;if(b&&b.length||(b=void 0),i.setPosition(c.pos+1,null,{isEditing:!0,documentFieldNames:b}),t.paraFormat.resetTaskList(),a.datalogics.prime.atPapxBound(c.pos+1)){var T=a.datalogics.final.getPapx(c.pos);if(T){var C=T.prop.getPropVal("basestyle"),S=a.stylesheet.getNextStyle(C);if(C&&S&&C.id!=S.id){var E=a.datalogics.prime.getChpx(c.pos,u.IT.Exclude);!function(e,t,n){if(n&&n.prop){var i=n.prop,a=i.getPropSelf("bold");null!=a&&t.updateInsertPointChpx(V.Font_Bold,0!=a);var o=i.getPropSelf("italic");null!=o&&t.updateInsertPointChpx(V.Font_Italic,0!=o);var r=i.getPropSelf("underline"),s=i.getPropSelf("underline_type"),l=i.getPropSelf("underline_color");if(null!=r){var c=r>0?s:r,u=l||void 0;t.updateInsertPointChpx(V.Font_Underline,c,u)}var d=i.getPropSelf("strike");null!=d&&t.updateInsertPointChpx(V.Font_StrikeThrough,0!=d);var h=i.getPropSelf("font_name_asia_east");if(null!=h){var p=e.fonttable.getName(h);t.updateInsertPointChpx(V.Font_Name,p)}var f=i.getPropSelf("font_size_cs");null!=f&&t.updateInsertPointChpx(V.Font_FontSize,f);var g=i.getPropSelf("script_pos");null!=g&&(g>0?t.updateInsertPointChpx(V.Font_Superscript,!0):g<0&&t.updateInsertPointChpx(V.Font_Subscript,!0));var v=i.getPropSelf("highlight_color");null!=v&&t.updateInsertPointChpx(V.Font_HighlightColor,v);var y=i.getPropSelf("character_scale");null!=y&&t.updateInsertPointChpx(V.Font_Scaling,y);var m=i.getPropSelf("caps");null!=m&&t.updateInsertPointChpx(V.Font_AllCaps,m);var _=i.getPropSelf("small_caps");null!=_&&t.updateInsertPointChpx(V.Font_SmallCaps,_);var x=i.getPropSelf("double_strike");null!=x&&t.updateInsertPointChpx(V.Font_DoubleStrikeThrough,1==x);var w=i.getPropSelf("emphasis_type");null!=w&&t.updateInsertPointChpx(V.Font_EmphasisMark,w)}}(a,i,E)}}}i._dispatch("onUILOperationTriggered",h.pos+1,null,{isEditing:!0,documentFieldNames:b}),i.onCmdExec(),x.isMobile&&(e.uilManager.collectionInfoRecorder.hasInputTextBeforeKeyboardPickUp=!0,e.uilManager.collectionInfoRecorder.inputTime=Date.now())}}function pe(e,t,n){if(!n.selection.selInfo.info.isSelectionRangeNonEditable&&ee(n)){if(ne(t,n))return;if(Ae(n)){var i=n.selection,a=i.begin,o=i.end,r=a.position,s=o.position;if(r>s){var l=s;s=r,r=l}return i.setPosition(s),void e.workspace.makesureCursorVisible()}he(e,t,n),e.workspace.makesureCursorVisible(),function(e){new Promise((function(t){if(Object(K.getCanRename)())if(e.isWebMode())t();else if(e.data.doc.isEmptyDocOnStart){var n=e.data.doc.getMainTextLength();if(e.data.selection.begin.position>n)t();else if(n<2)t();else{var i=e.data,a=i.doc.datalogics,o=function e(t){if(t.pos+t.len>n)return"";var o=a.final.collectPapxs(t.pos,t.pos+t.len)[0];if(!o)return"";if(o.len>1){var r=Object(q.getRenameText)({pos:o.pos,len:o.len},i.doc);if(r)return r}return e({pos:o.end,len:1})}({pos:0,len:1});o&&Object(K.fileAutoRename)(o),t()}}else t();else t()}))}(e)}}function fe(e,t,n){var i=e.doc,a=e.glyphpool,o=t,r=i.getMainTextLength(),s=0;if(o>r){var l=i.getSubDocType(o);if(l===_.HeaderFooter||l===_.Textbox){var c=i.getSubDocRange(l);s=c.pos,r=c.pos+c.len-1}else console.log("这个子文档还不支持！")}var u=void 0,d=a.glyphBuff;if(n)for(;o>s;){u?u.prev():u=a.getGlyphIterator(o-1);var h=d.getCharCode(o-1);if(h===m.n||h===m.p||h===m.o)break;if(u.isVisible())break;if(h===m.d||h===m.e)break;--o}else for(;o<r-1;){u?u.next():u=a.getGlyphIterator(o);var p=d.getCharCode(o);if(u.isVisible())break;if(p===m.d||p===m.e)break;++o}return u&&u.free(),o}function ge(e,t){return e.prop.hasAutoNum()}function ve(e,t,n){if(e.isPalaceMuseumTemplate)return!1;var i=t.prop;return void 0!==i.left_indent_chars&&0!==i.left_indent_chars||void 0!==i.left_indent_abs&&0!==i.left_indent_abs||void 0!==i.first_line_indent_chars&&0!==i.first_line_indent_chars||void 0!==i.first_line_indent_abs&&0!==i.first_line_indent_abs}function ye(e,t,n){if(n<=0)return!1;for(var i=t.fields.getFields({begin:n-1,end:n}),a=0;a<i.length;++a){var o=i[a]._node;if(n===o.end||"FORMTEXT"===o.type&&n===o.resultBegin)return e.setPosition(o.begin,o.end),!0}return!1}function me(e,t,n){for(var i=t.fields.getFields({begin:n,end:n}),a=0;a<i.length;++a){var o=i[a]._node;if("EQ"==o.type&&n===o.begin)return e.setPosition(o.begin,o.end),!0}return!1}function _e(e,t,n,i,a){if(!e.selInfo.getSelectionInfo().inTable||n){var o=t.getDataLogic("final");if(a){if(!window.APP.isWebMode()&&!window.APP.isMobileMode())for(var r=window.APP.data.typoinfo,s=0;r.pagePos&&s<r.pagePos.length;s++)if(r.pagePos[s].beginPos==i||r.pagePos[s].endPos==i)return{isKeepBorder:!0};if(i!==n.pos)return;var l=void 0;if(n.prop.border_top&&(l=n.prop.border_top.style),l&&l!==F.l)return{pos:n.pos,borderType:H.d,border:n.prop.border_top};if(0!==n.pos){var c=void 0,u=o.getPapx(n.pos-1);if(u.prop.border_bottom&&(c=u.prop.border_bottom.style),c&&c!==F.l)return{pos:u.pos,borderType:H.a,border:u.prop.border_bottom}}}else{var d=t.getMainTextLength();if(i!==n.pos+n.len-1)return;var h=void 0;if(n.prop.border_bottom&&(h=n.prop.border_bottom.style),h&&h!==F.l)return{pos:n.pos,borderType:H.a,border:n.prop.border_bottom};if(n.pos+n.len!==d){var p=void 0,f=o.getPapx(n.pos+n.len);if(f.prop.border_top&&(p=f.prop.border_top.style),p&&p!==F.l)return{pos:f.pos,borderType:H.d,border:f.prop.border_top}}}}}function xe(e,t,n){var i=n.pos,a={};switch(n.borderType){case H.d:a.border_top={styleType:j.b,style:F.l};break;case H.a:a.border_bottom={styleType:j.b,style:F.l};break;default:return}var o=t.getNormalRange();e.paraFormat.setBorders(i,1,a,0,!0,n.border.style),t.setPosition(o.pos,null,{isEditing:!0})}function we(e,t,n,i,a){var o=t.doc,r=o.contentControls.collect(n,1).sort((function(e,t){return e.len-t.len})),s=c()(r,1)[0];return o.isEnhancedTemplate?function(e,t,n){if(n&&n.isRichText){if(t===n.pos)return n.lockControl?{isAllowDelete:!1}:2===n.len?{isAllowDelete:!0,pos:n.pos,len:2}:{isAllowDelete:!1}}else if(e.getText(t,1).charCodeAt(0)===m.l){var i=t&&e.contentControls.collect(t-1,1).sort((function(e,t){return e.len-t.len}))||[],a=c()(i,1)[0];if(a&&a.isRichText&&e.getText(t+1,1).charCodeAt(0)!==m.l)return{isAllowDelete:!1};var o=e.contentControls.collect(t+1,1).sort((function(e,t){return e.len-t.len}))||[],r=c()(o,1)[0];if(r&&r.isRichText)return{isAllowDelete:!1}}return{isAllowDelete:!0}}(o,n,s):function(e,t,n,i,a,o){if(!i)return{isAllowDelete:!0};if(e.restrictEditHandler.isInRestrictEditMode)return{isAllowDelete:!0};var r=t.selection,s=t.doc;if(i.end-i.begin<=2)return s.isPalaceMuseumTemplate&&(n===i.begin&&o||n===i.end-1&&!o)?{isAllowDelete:!1}:{isAllowDelete:!0,pos:i.begin,len:i.len};var l=e.formatContentController.getControllerBeginPos(i,!0),c=e.formatContentController.getControllerEndPos(i,!0);if(o){if(n>=e.formatContentController.getControllerEndPos(i)&&n<c)return r.setPosition(l,c,{isSelectFormatControl:!0}),{isAllowDelete:!1}}else if(n===l)return r.setPosition(l,c,{isSelectFormatControl:!0}),{isAllowDelete:!1};return{isAllowDelete:!0}}(e,t,n,s,0,a)}function ke(e,t,n,i){var a=t.doc;return a.isTemplate?function(e,t,n){var i=t,a=n;switch(e.templateType){case G.b:for(var o=e.contentControls.collect(t,n-t),r=0;r<o.length;++r){var s=o[r];if(n-t==1&&(t===s.begin||n===s.end))return{res:!1};if(t<s.begin&&n<=s.end||t>=s.begin&&n>s.end)return{res:!1};t===s.begin?i=t+1:n===s.end&&(a=n-1)}}return{res:!0,pos:i,len:a-i}}(a,n,i):function(e,t,n){return e.restrictEditHandler.checkCanModify(t)?(e.formatContentController.checkDeleteContentControllerForSelection(t,n)&&e.formatContentController.deleteContentControllerByPos(t),{res:!0,pos:t,len:n-t}):{res:!1}}(e,n,i)}function be(e,t,n,i){var a=e.getLimitedRange(t);return{pos:t,len:Math.min(a.pos+a.len-1,n)-t}}function Te(e,t,n){if(1===n&&e.comments&&e.getText(t,n).charCodeAt()===m.g){var i=e.comments.collectComments(t,n);if(i&&i.length)return{pos:t,len:n+i.length}}return{pos:t,len:n}}function Ce(e,t,n,i,a){var o=e.getNormalRange();if(0===o.len){var r=t.getDataLogic("final");if(a){var s=r.getPapx(o.pos);if(o.pos===s.pos&&s.pos>0){var l=r.getPap(s.pos-1);if(l.getPropVal("nest_level")<s.prop.getPropVal("nest_level")||l.getPropVal("para_type")===N.b||l.getPropVal("para_type")===N.d)return{res:!1};if(l.getPropVal("nest_level")<s.prop.getPropVal("nest_level")||l.getPropVal("para_type")===N.c)return{res:!1,needSkip:!0}}}if(i>n&&t.isContainLastParaBreak(n,i-n)&&(0!==n||i-n!=1||a))return{res:!1};var c=r.getPapx(n);if(i===c.pos+c.len){var u=c.prop.getPropVal("para_type");if(u===N.b||u===N.c||u===N.d)return{res:!1}}}else{var d=function(e,t,n){for(var i=[],a=Number.MAX_SAFE_INTEGER,o=e.getDataLogic("final"),r=t;r<n;){var s=o.getPapx(r),l=s.prop.getPropVal("nest_level");l<a&&(a=l);var c=s.prop.getPropVal("para_type");(c===N.b||c===N.c)&&s.end<=n?0!==i.length&&l===i[i.length-1]||i.push(l):c===N.d&&0!==i.length&&l===i[i.length-1]&&i.pop(),r=s.pos+s.len}return 0!==i.length?a:-1}(t,n,i);if(-1!==d)return{res:!0,minLayer:d}}return{res:!0}}function Se(e,t){var n=void 0,i=void 0,a=e.selInfo.getSelectionInfo(),o=a.begin,r=a.end,s=a.tableSelected,l=a.wholeCellSelected,c=a.rowSelected,u=a.columnSelected,d=a.cells,h=e.getNormalRanges();if(d){var p=d[0][0];s||c?(n=t?[[p]]:d,i={pos:o,len:r-o}):(l||u)&&(n=t?[[p]]:[d[0]],i=h[0])}return{cells:n,serial:i}}function Ee(e,t,n){var i=e.getDataLogic("prime"),a=i.collectPapxs(t,n);if(t!==a[0].pos&&1===a.length){var o=t+n,r=a[0];if(r.pos+r.len!==o)return;var s=i.getPapx(o);if(!s.good)return;return Object(d.k)(r.prop,s.prop)?void 0:{pos:t,len:n-1}}}function Pe(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=n.selection,r=n.doc,l=n.glyphpool,c=n.api,u=r.getDataLogic("final"),d=o.getNormalRange(),h=d.pos,p=d.len,f=!1;if(0===p){if(t.deleteEmptyDocumentField(h,!i))return;if(i){if(h>0&&t.isInReadonlyDocumentField(h-1))return;if(h>0&&!o.selContext.isInComment()&&window.APP.restrictEditHandler.checkIsRangeNonEditable({pos:h-1,len:1}))return;h=fe(n,h,!0);var g=u.getPapx(h);if(h===g.pos&&ge(g))return void t.paraFormat.setList(0,o.selInfo.getListType()!==w.c);if(h===g.pos&&ve(r,g))return void t.paraFormat.removeIndent();if(ye(o,r,h))return;if(o.selectMathFunction(h-1))return;var v=_e(o,r,g,h,i);if(void 0!==v){if(void 0===v.isKeepBorder)return void xe(t,o,v);f=v.isKeepBorder}var y=r.locateStory(h);if(!(h>y.subdoc_offset))return;if(--h,l.glyphBuff.isLowSurrogatesOfCombineChar(h)&&l.glyphBuff.isHighSurrogatesOfCombineChar(h-1))--h,++p;else{var _=l.glyphBuff.getEmojiCombineCharBackward(h);_&&(h-=_,p+=_)}}else{if(t.isInReadonlyDocumentField(h))return;if(!o.selContext.isInComment()&&window.APP.restrictEditHandler.checkIsRangeNonEditable({pos:h,len:1}))return;if(o.selectMathFunction(h))return;if(me(o,r,h))return;var x=u.getPapx(h),k=_e(o,r,x,h,i);if(void 0!==k)return void xe(t,o,k);if(h=fe(n,h,!1),l.glyphBuff.isHighSurrogatesOfCombineChar(h)&&l.glyphBuff.isLowSurrogatesOfCombineChar(h+1))++p;else{var b=l.glyphBuff.getEmojiCombineCharForward(h);if(b)p+=b;else{var T=l.getGlyphIterator(h),C=T.glyphGroup;C.isCombine&&C.pos===h&&(p=C.len-1),T.free()}}}p+=1;var S=we(e,n,h,d.pos,i);if(!S.isAllowDelete)return;isNaN(S.pos)||isNaN(S.len)||(h=S.pos,p=S.len)}else{var E=Ee(r,h,p);E&&(h=E.pos,p=E.len)}var P=ke(e,n,h,h+p);if(P.res){for(var L=r.fields.getFields({begin:h-1,end:h}),A=0;A<L.length;++A){var I=L[A]._node;if("FORMTEXT"===I.type&&h===I.resultBegin)return o.setPosition(I.begin,I.end),!0}if(h=(P=Te(r,(P=be(r,h,h+p)).pos,P.len)).pos,p=P.len,0!==P.len){var R=Ce(o,r,h,h+p,i);if(R.res){var O=s()({pos:h,len:p,isBackspace:i,isKeepBorder:f,subDocType:r.getSubDocType(d.pos)},se(0,o),ce(e,h,p)),M=o.getActiveAreaNormalRanges();if(a){var D=Se(o,!1),B=D.cells,j=D.serial;if(B&&1===B.length&&1===B[0].length){var F=B[0][0];if(F.begin+1===F.end)return}j&&B&&(O.rgs=M=[j],O.cellRgs=B,O.len=j.len,O.isBackspace=!1)}if(void 0!==R.minLayer&&R.minLayer>0&&!a){if(!c.isConnected())return;for(var H=M.length,G=[],U=r.getDataLogic("final"),Y=0;Y<H;++Y)for(var z=M[Y],X=z.pos,V=z.pos;V<z.pos+z.len;){var q=U.getPapx(V),K=q.prop.getPropVal("nest_level"),J=q.prop.getPropVal("para_type");K===R.minLayer&&J===N.b&&(G.push({begin:X,end:q.pos+q.len-1}),X=q.pos+q.len),V=q.pos+q.len}var Z="",$=!0;H=G.length;for(var ee=0;ee<H;++ee){var te=G[ee],ne=te.end-te.begin;0!==ne&&($=!1,Z+=r.getText(te.begin,ne))}var ie=o.selInfo.getSelectionInfo();if(ie.columnSelected&&i)return t.deleteColumn(),void o.onCmdExec();if($)return void o.setPosition(h);if(O.string=Object(W.getDeletedTextFromString)(Z),o.setPosition(h),!t.cmdExecutor.sendCommandBlock({name:"deleteText",param:O}))return}else{var ae=o.selInfo.getSelectionInfo();O.string=Object(W.getDeletedTextFromRange)(n,O.pos,O.len);var oe=r.useLowPerformanceMode,re=void 0;ae.tableSelected&&!a?(o.setPosition(O.pos),re={name:"deleteTable",param:O}):ae.rowSelected&&!a?(Object(Q.x)(o,O,!0,ae),o.setPosition(O.pos),re={name:oe?"deleteText":"deleteRow",param:O}):re={name:oe?"deleteText":"deleteTextForSel",param:O};var le=ae.isPoint&&(O.string.charCodeAt()===m.f||O.string.charCodeAt()===m.g);if((ae.containDrawing||le)&&window.collection("picedit","action","edit_delete"),oe){if(c.isConnected()&&!c.hasBlocking()&&(O.bSendSelectionBack=!0,!1===t.cmdExecutor.sendCommandBlock({name:re.name,param:O})))return}else{var ue=t.cmdExecutor.exec(re);if(!1===ue)return;void 0===ue&&(ue=O.pos);var de=o.selContext.activeDocumentFieldNames;de&&de.length||(de=[]),o._dispatch("onUILOperationTriggered",O.isBackspace?O.pos:ue,null,{isEditing:!0,documentFieldNames:de})}}o.onCmdExec()}else R.needSkip&&o.setPosition(h)}else i&&!o.selContext.isInComment()&&!o.selContext.isInTextbox&&o.setPosition(h)}}function Le(e,t,n,i){var a=n.selection,o=n.doc,r=a.begin.position,s=a.end.position;if(!(i&&ne(t,n)||a.selInfo.info.isSelectionRangeNonEditable))if(a.selShapeIdxPaths&&(a.selShapeIdxPaths.length>1||a.activeShapeIdxPath&&a.activeShapeIdxPath.length>1))t.picture.deleteShapes();else{if(r<0)return-1;var l=o.locateStory(r);if(l){var c=1;s>r?c=s-r:r>l.subdoc_offset&&(r-=1),l.contain(r)&&l.contain(r+c)&&!Ae(n)?(Pe(e,t,n,i),e.workspace.makesureCursorVisible()):console.log("超出了当前子文档的范围。")}else console.warn("这是什么情况，你能确定给定的位置是合法的吗？");x.isMobile&&(e.uilManager.collectionInfoRecorder.hasInputTextBeforeKeyboardPickUp=!0,e.uilManager.collectionInfoRecorder.inputTime=Date.now())}}function Ae(e){var t=e.selection,n=e.doc,i=t.begin,a=t.end,o=i.position,r=a.position;if(o>r){var s=r;r=o,o=s}var l=n.getSubDocType(o);if(l===_.Footnote){var c=n.footnoteBodys.rangeClass.findNodeContainPos(o);if(r>c.end||r<c.begin)return!0}else if(l===_.Endnote){var u=n.endnoteBodys.rangeClass.findNodeContainPos(o);if(r>u.end||r<u.begin)return!0}return!1}function Ie(e,t,n){var i=n.selection,a=n.doc;if(i.activeShapeIdxPath){var o=i.getNormalRange(),r=a.textboxs.findBodyRange(o.pos);r?i.setPosition(r.pos):i.setPosition(o.pos)}else if(Ae(n)){var s=i.begin,l=i.end,c=s.position,u=l.position;if(c>u){var d=u;u=c,c=d}i.setPosition(u)}else Pe(e,t,n,!0,!0)}function Re(e,t,n){return new Promise((function(i,a){if(e.state.isFinding||!t.api.isConnected()||t.api.hasBlocking())i(null);else{var o=t.selection.getNormalRange(),r=o.pos,l=o.len;e.state.isFinding=!0,t.api.queryCommandBlock("findText",s()({pos:r,len:l},function(e){var t=e.text,n=e.options,i=n.isWildcardMatched,a=void 0!==i&&i,o=n.isCaseSensitive,r=void 0!==o&&o,s=n.isWholeWordMatched,l=void 0!==s&&s,c=n.isWidthIgnored,u=void 0!==c&&c,d={FindText:t,Forward:!0,MatchWildcards:a};return a?(d.MatchCase=!0,d.MatchWholeWord=!1,d.MatchByte=!0):(d.MatchCase=r,d.MatchWholeWord=l,d.MatchByte=!u),window.APP.isPCMode()||window.APP.isPaginationMode()?d.FindScope=0:d.FindScopes=[J.a.wpsFindScope_MainText,J.a.wpsFindScope_Footnotes,J.a.wpsFindScope_Endnotes],d}(n)),(function(t){var n=t.result;e.state.isFinding=!1,i(n)}),{initiative:!0})}}))}function Oe(e,t){e.state.isFinding&&t.api.cancelCommand("findText",{})}function Me(e,t,n,i){var a=n.selection.selInfo.info,o=a.inOMath;a.isSelectionRangeNonEditable||o||ee(n)&&(!function(e,t,n){var i=t.selection,a=i.getActiveAreaNormalRanges(),o=a.length,r=a[0];r.pos>a[o-1].pos&&(r=a[o-1]),i.setPosition(r.pos);var s={pos:r.pos,len:r.len,charcode:n.charcode,fontName:n.fontName},l={name:"insertSymbol",param:s};!!e.cmdExecutor.exec(l)&&(i._dispatch("onUILOperationTriggered",s.pos+1,null,{isEditing:!0}),i.onCmdExec())}(t,n,i),e.workspace.makesureCursorVisible())}function De(e,t){return new Promise((function(n,i){window.addEventListener(Y.default.names.DOC_REPLACE_RESULT,(function e(t){0===t.detail.error?n(t.detail.count):i(t.detail.error),window.removeEventListener(Y.default.names.DOC_REPLACE_RESULT,e)})),e.cmdExecutor.sendCommandBlock({name:"replaceText",param:t})}))}function Ne(e,t,n,i){var a=t.selection,o=t.doc,r=function(e){for(var t=e.selection,n=e.doc,i=t.getNormalRange(),a=n.getDataLogic("final").collectPapxs(i.pos,i.len),o=Number.MAX_SAFE_INTEGER,r=!1,s=0;s<a.length;++s)if(a[s].prop){var l=a[s].prop.getPropVal("nest_level");if(0!==l){if(r)return 0;o=Math.min(l,o)}else{if(o!==Number.MAX_SAFE_INTEGER)return 0;r=!0}}return r?0:o}(t);if(0!==r){var s,l=a.selAreas.activeArea.activeRange,c=i.cells,d=void 0===c?[]:c,h=i.idxs,p=void 0===h?[]:h,f=Math.min(l.begin.position,l.end.position),g=Math.max(l.begin.position,l.end.position),v=void 0,y=void 0,m=void 0,_=void 0,x=void 0;for(s=d.length,m=0;m<s;m++)for(x=d[m].length,_=0;_<x;_++){var w=d[m][_];if(1===s&&1===x||w.begin>=f&&w.end<=g){v=w,y=p[m][_];break}}if(i.columnCnt>1)v&&a.setPosition(v.begin,v.end-1,{isSend:!0});else{var k=v?{pos:v.begin,len:v.end-v.begin}:{pos:f,len:g-f},b=function e(t,n,i,a,o,r){var s=t.getDataLogic("final").specTable.getTapx(i,u.IT.Include,o);if(!s.prop)return null;var l=s.cellDatas,c=s.cells,d=s.begin,h=s.end,p=isNaN(r)?c.length:r,f=n?-1:1,g=void 0,v=void 0;do{if(v=c[p+=f],g=l[p],v&&v.vertMerge!==B.e.MIDDLE)break}while(g);return g||(n?e(t,n,d-1,1,o):e(t,n,h,1,o,-1))}(o,n,k.pos,0,r,y);b?a.setPosition(b.begin,b.end-1,{isSend:!0}):n?a.setPosition(v.begin,v.end-1,{isSend:!0}):(a.setPosition(v.begin),e.insertRowBelow())}}}function Be(e,t,n,i){n.selection.selInfo.info.isSelectionRangeNonEditable||ee(n)&&(!function(e,t,n,i){var a=n.selection,o=n.doc,r=a.getActiveAreaNormalRanges(),s=a.selInfo.getSelectionInfo(),l=s.inTable||a.selInfo.hasTable();if(o.mathManager.isMathEdit())return!0;if(1!==r.length)return!!l&&(t.reduce_indentation(),!0);var c=r[0],u=o.getDataLogic("final").getPapx(c.pos),d=u.prop;if(l&&(d.list_id<0||!d.list_id))return Ne(t,n,i,s),!0;if(l&&1===s.cells.length&&s.end===s.cells[0][0].end-1&&c.pos===u.pos)return t.reduce_indentation(),!0;if(0===c.len&&c.pos===u.pos){if((d.list_id<0||!d.list_id)&&d.tab_stops&&d.tab_stops.stops&&d.tab_stops.stops.length>0)return de(e,t,n,String.fromCharCode(m.B),{special:!0}),!0}else if(c.pos>u.pos||c.pos===u.pos&&c.len<u.len)return de(e,t,n,String.fromCharCode(m.B),{replace:!0,special:!0}),!0;var h={pos:c.pos,len:c.len,shift:i,isTaskList:a.selInfo.isInTaskList()},p={name:"typeTab",param:h};!!t.cmdExecutor.exec(p)&&(a._dispatch("onUILOperationTriggered",h.pos,null,{isEditing:!0}),a.onCmdExec())}(e,t,n,i),e.workspace.makesureCursorVisible(),setTimeout((function(){e.focusInput()})))}},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);n(605);var a=i.__importStar(n(238)),o=i.__importDefault(n(515)),r=i.__importDefault(n(398)),s=n(426),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={style:null},t.handleWindowMouseDown=function(){t.props.element&&t.props.onClose()},t.refWrap=a.default.createRef(),t}return i.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("mousedown",this.handleWindowMouseDown,!0),this.adjustUI()},t.prototype.componentWillUnmount=function(){window.removeEventListener("mousedown",this.handleWindowMouseDown,!0)},t.prototype.componentDidUpdate=function(e,t){this.props!==e&&this.adjustUI()},t.prototype.adjustUI=function(){var e=this.props,t=e.title,n=e.element,i=e.position,a=e.middleShow,l=e.verticalMiddleShow,c=e.placement;if(n&&t){var u=this.refWrap.current,d=void 0;d=t.type===o.default||c===s.PlacementType.leftRight?r.default.getLottiePosition(u,n):r.default.getBubblePosition(u,n,i,a,l),this.setState({style:d})}else this.setState({style:{left:0,top:0}})},t.prototype.renderTitle=function(){var e=this.props.title;if("string"==typeof e){var t=a.default.classNames({"tooltip-text":1,"tooltip-auto-wrap":e.length>20});e=a.default.createElement("div",{className:t},e)}return e},t.prototype.render=function(){var e=this.props,t=e.element,n=e.title,i=this.state.style;if(!t||!n)return!1;var r=a.default.classNames({"wowui-tooltip-content":1,"not-lottie":n.type!==o.default});return a.default.createElement("div",{ref:this.refWrap,className:r,style:i},this.renderTitle())},t}(a.PureComponent);t.default=l},605:function(e,t,n){},6123:function(e,t,n){"use strict";var i=n(24),a=n.n(i),o=n(144),r=n.n(o),s=n(1),l=n.n(s),c=n(2),u=n.n(c),d=n(3489),h=n(167),p=n(240),f=n(227),g=[d.f,d.L,d.b],v=new Set(g),y=[d.i,d.B,d.C,d.L,d.b],m=new Set(y),_=Math.pow(2,0),x=Math.pow(2,1),w=Math.pow(2,2),k=new(function(){function e(){l()(this,e);for(var t=new Map,n=v.size,i=Math.pow(2,n),a=0;a<i;a++)t.set(a,new Map);this.eventMap=t}return u()(e,[{key:"configValid",value:function(e){var t=r()(e,5),n=t[0],i=t[1],o=t[2],s=t[3],l=t[4];return n.every((function(e){return"-1"!==g.indexOf(e)}))?s&&"object"!==(void 0===s?"undefined":a()(s))?(console.error("过滤条件只能是对象: ",JSON.stringify(s)),!1):l&&"function"!=typeof l?(console.error("匹配函数类型错误，实际类型为：",void 0===l?"undefined":a()(l)),!1):"function"!=typeof o&&"string"!=typeof o?(console.error("回调只能是方法或事件名"),!1):!(isNaN(i)&&!Array.isArray(i))||(console.error("快键键触发键只能是数组或数值"),!1):(console.error("修饰键只能由control/command、shift、alt组合而成"),!1)}},{key:"merge",value:function(e,t){var n=this;e.every((function(e){var i=r()(e,5),a=i[0],o=i[1],s=i[2],l=i[3],c=i[4];if(n.configValid(e)){var u={callback:s,condition:l,matchFilter:t,matchFunction:c},d=n.getMapKeyFromConfig(a),h=n.eventMap.get(d);return Array.isArray(o)?o.forEach((function(e){h.set(e,u)})):h.set(o,u),!0}return!1}))}},{key:"handleKeydown",value:function(e,t){var n=this.isMatch(e);n&&(this.execWrapper||(this.execWrapper=this.exec,t&&t.throttle&&(this.execWrapper=window.utils.Lodash.throttle(this.exec,t.throttle))),this.preKeyCode&&this.preKeyCode===e.keyCode?this.execWrapper(e,n):this.exec(e,n),this.preKeyCode=e.keyCode,Object(p.stopBubble)(e))}},{key:"isMatch",value:function(e){var t=this,n=e.keyCode;if(h.isIPad&&!0===e.metaKey&&229===n&&(n=e.code.charCodeAt(3)),!m.has(n)){var i=this.getMapKeyFromEvent(e),a=this.eventMap.get(i).get(n);if(a){var o=a.callback,r=a.condition,s=void 0===r?{}:r,l=a.matchFilter,c=a.matchFunction;return(!l||!0===l(s,e))&&((!c||!0===c(e))&&(h.isIE&&0===i&&[8,13,33,34,35,36,37,38,39,40,46].includes(n)?function(){o.apply(void 0,arguments),t.focusTimer=setTimeout((function(){window.APP.focusInput()}))}:o))}return!1}}},{key:"exec",value:function(e,t){"string"==typeof t?f.default.dispatchEvent(t):t(e)}},{key:"getMapKeyFromEvent",value:function(e){var t=0;return(h.isMacOs||h.isIPad)&&!0===e.metaKey&&!0===e.ctrlKey||(!h.isMacOs&&!0===e.ctrlKey||(h.isMacOs||h.isIPad)&&!0===e.metaKey)&&(t+=_),!0===e.shiftKey&&(t+=x),!0===e.altKey&&(t+=w),t}},{key:"getMapKeyFromConfig",value:function(e){var t=0;return-1!==e.indexOf(d.f)&&(t+=_),-1!==e.indexOf(d.L)&&(t+=x),-1!==e.indexOf(d.b)&&(t+=w),t}},{key:"cancel",value:function(){this.execWrapper&&this.execWrapper.cancel&&this.execWrapper.cancel(),clearTimeout(this.focusTimer),this.focusTimer=null}}]),e}()),b={bind:function(e,t,n){if(Array.isArray(e)){if(!t||"function"==typeof t)return k.merge(e,t),function(e){k.handleKeydown(e,n)};console.error("总过滤器必须是方法"+JSON.stringify(t))}else console.error("配置必须是数组: "+JSON.stringify(e))},isMatch:function(e){return!!k.isMatch(e)},clearAll:function(){k.cancel()}};t.a=b},627:function(e,t,n){"use strict";n.r(t),n.d(t,"MESSAGE",(function(){return i}));var i={PLUGIN_ON_MESSAGE:"PLUGIN_ON_MESSAGE",PLUGIN_ACTION_CONFIG:"PLUGIN_ACTION_CONFIG",PLUGIN_CONFIRM:"PLUGIN_CONFIRM",PLUGIN_CANCEL:"PLUGIN_CANCEL",PLUGIN_ADD:"PLUGIN_ADD",PLUGIN_REMOVE:"PLUGIN_REMOVE",PLUGIN_ON_END:"PLUGIN_ON_END",PLUGIN_NOTIFY:"PLUGIN_NOTIFY",PLUGIN_ON_RECIVE_NOTICE_LIST:"PLUGIN_ON_RECIVE_NOTICE_LIST",PLUGIN_ON_QUERY_AT_STATUS:"PLUGIN_ON_QUERY_AT_STATUS",PLUGIN_ON_AT_GET_NOTICE_LIST:"PLUGIN_ON_AT_GET_NOTICE_LIST"}},663:function(e,t,n){"use strict";n.r(t),n.d(t,"KEYBOARD",(function(){return i}));var i={PLUGIN_INPUT:"PLUGIN_INPUT",PLUGIN_FINISH_INPUT:"PLUGIN_FINISH_INPUT",PLUGIN_KEY_UP:"PLUGIN_KEY_UP",PLUGIN_KEY_DOWN:"PLUGIN_KEY_DOWN",PLUGIN_KEY_LEFT:"PLUGIN_KEY_LEFT",PLUGIN_KEY_RIGHT:"PLUGIN_KEY_RIGHT"}},664:function(e,t,n){"use strict";n.r(t),n.d(t,"MOUSE",(function(){return i}));var i={PLUGIN_CLICK:"PLUGIN_CLICK",PLUGIN_MOVE:"PLUGIN_MOVE",PLUGIN_ENTER:"PLUGIN_ENTER",PLUGIN_LEAVE:"PLUGIN_LEAVE"}},665:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i);t.default=function e(){var t=this;a()(this,e),this.addContainer=function(e){var n=e.pluginName;if(t.pluginName=n,t.containerName=n+"_container",!document.getElementById(t.containerName)){var i=document.createElement("DIV");i.id=t.containerName,document.body.appendChild(i)}},this.getPluginContainer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"mark"===e?document.getElementById(t.pluginName+"_wrapper"):document.getElementById(t.containerName)},this.contanierStyle=function(e){var n=t.getPluginContainer();n&&Object.keys(e).forEach((function(t){n.style.setProperty(t,e[t])}))},this.changerContanierTopAndLeft=function(e){var n=t.getPluginContainer();n&&(n.style.left=e.left,n.style.top=e.top)},this.clearContainer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.getPluginContainer(e);n&&(n.innerHTML="")},this.removeContainer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.getPluginContainer(e);n&&n.remove()},this.hideContainer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.getPluginContainer(e);n&&(n.style.display="none")},this.showContainer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.getPluginContainer(e);n&&(n.style.display="block")}}},6742:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c}));var i=1,a=2,o=3,r=4,s=5,l=6,c=7},6744:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(2856),l=function(){function e(){a()(this,e)}return r()(e,null,[{key:"hit",value:function(e,t,n,i,a){if(a){var o=a.target,r=e.workspace.waterdrop.getDropItem(o,a)||{},l=r.item,c=r.type;void 0!==c&&(i.type=s.b.WATER_DROP,i.dropItem=l,i.dropItemType=c)}}}]),e}();t.a=l},6745:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(4747),h=n(677),p=function(e){function t(e,n){a()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.type=h.b.LOCAL,i}return u()(t,e),r()(t,[{key:"resetModule",value:function(e){var t=this.modules.get(e);t&&t.resetState()}},{key:"isEventProcessible",value:function(e){return!0}}]),t}(d.a);t.a=p},6746:function(e,t,n){var i=n(5908),a=n(8856),o=n(5909);e.exports=function(e,t,n,r,s,l){var c=1&n,u=e.length,d=t.length;if(u!=d&&!(c&&d>u))return!1;var h=l.get(e),p=l.get(t);if(h&&p)return h==t&&p==e;var f=-1,g=!0,v=2&n?new i:void 0;for(l.set(e,t),l.set(t,e);++f<u;){var y=e[f],m=t[f];if(r)var _=c?r(m,y,f,t,e,l):r(y,m,f,e,t,l);if(void 0!==_){if(_)continue;g=!1;break}if(v){if(!a(t,(function(e,t){if(!o(v,t)&&(y===e||s(y,e,n,r,l)))return v.push(t)}))){g=!1;break}}else if(y!==m&&!s(y,m,n,r,l)){g=!1;break}}return l.delete(e),l.delete(t),g}},6747:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(167),l=n(1917),c=n(4428),u=function(){function e(){return a()(this,e),this}return r()(e,[{key:"clearAll",value:function(){this.collection.clearAll()}},{key:"updateCompositionState",value:function(e){this.compositionState=e,this.selection.updateCompositionState(e)}},{key:"getInputValue",value:function(){return this.input.value}},{key:"init",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.input=e,this.editor=t,this.selection=n,this.workspace=i,this.needComposing=a,this.compositionState=l.a.CompositionInit,this.isInsertWithReplace=this.selection.data.doc.useLowPerformanceMode,this.collection=new c.a}},{key:"handleStartInput",value:function(){""==this.input.value&&s.isIE||this.selection.getNormalRange().len>0&&this.editor.preDeleteText()}}]),e}();t.a=u},6748:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(22),r=n.n(o),s=n(2),l=n.n(s),c=n(23),u=n.n(c),d=n(874),h=n(227),p=n(260),f=n(822),g=function(e){function t(e,n,i){a()(this,t);var o=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return o.retryCount=0,o.onCooperInfoUpdated(),o.onEventReady(),o}return u()(t,e),l()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),l()(t,[{key:"onEventReady",value:function(){var e=this;!this.app.data.selection.selCoop.sendSelectionChangeToOtherUsers(!1,void 0,{isInitialSend:!0,isReadOnly:this.app.isReadOnly()})&&this.retryCount<=5&&setTimeout((function(){e.retryCount++,e.onEventReady()}),200)}},{key:"onCooperInfoUpdated",value:function(){var e=this.app.workspace.revisionComment;e&&e.renderHandler.drawComment()}},{key:"onCustomEvent",value:function(e){var t=h.default.cooper.getCooperCenter().getCooperationUsers(),n=this.app.info,i=this.selection.selCoop;switch(e.type){case h.default.names.cooper.ON_USER_LIST_INIT:i.setCooperationSelections(t,n,!0);break;case h.default.names.cooper.ON_USER_JOIN:i.setCooperationSelections(t,n),i.coopInfo.copyUserInfoFromPublic();break;case h.default.names.cooper.ON_USER_QUIT:i.setCooperationSelections(t,n,!1,!1,!0);break;case h.default.names.cooper.ON_OTHERS_SELECTCHANGE:var a=e.detail.active_range||{};i.setCooperationSelections(t,n,!1,e.detail.userid),i.updateConveneList(e.detail.userid,a),a.isInitialSend&&i.sendCooperationInfoWhenNewCooperatorOnline();break;case p.default.names.DOC_COOPINFO_UPDATED:this.onCooperInfoUpdated();break;case p.default.names.DOC_COOPRANGE_UPDATED:i.setCooperationSelections(t,n,!1,void 0)}return this.state.uilState}}]),t}(d.a);g.events=[{type:h.default.names.cooper.ON_USER_LIST_INIT,target:f.a.window,flag:f.b.native},{type:h.default.names.cooper.ON_USER_JOIN,target:f.a.window,flag:f.b.native},{type:h.default.names.cooper.ON_USER_QUIT,target:f.a.window,flag:f.b.native},{type:h.default.names.cooper.ON_OTHERS_SELECTCHANGE,target:f.a.window,flag:f.b.native},{type:p.default.names.DOC_COOPINFO_UPDATED,target:f.a.window,flag:f.b.native},{type:p.default.names.DOC_COOPRANGE_UPDATED,target:f.a.window,flag:f.b.native}],g.preferredEvents=g.events,t.a=g},6749:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRenameText=void 0;var i=n(691),a=n(760);var o={filterControlDefaultContent:function(e){var t=_i18n("applications.writer.core.shell.model.doc.contentControl.formatControlDefaultContent", "Click here to edit directly."),n=new RegExp("".concat(t,""),"g"),i=_i18n("applications.writer.components.other.DroplistControl.placeholderText", "Choose one."),a=new RegExp("".concat(i,""),"g");return e.replace(n,"").replace(a,"")}};t.getRenameText=function(e,t){void 0===t&&(t=window.APP.data.doc);var n=Object.keys(o).reduce((function(e,t){return o[t](e)}),t.getText(e.pos,e.len));return(0,a.filterText)(n,i.isSpecialPlaceholder)}},6750:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertWebshape=t.switchTolink=t.editWebshape=t.navigateByWebshape=t.copyWebshapeLink=void 0;var i=n(5),a=n(358),o=n(1090);t.copyWebshapeLink=function(e,t){var n=t&&t.webshapeUrl;e.copy(null,n)},t.navigateByWebshape=function(e,t){var n=(null==e?void 0:e.webshapeUrl)||(null==t?void 0:t.url);n&&(0,a.openHyperlink)(n)},t.editWebshape=function(e,t,n,a,r){if(r)(0,o.uploadMimeDataImg)((function(o){var r=t.selection,s=n.id,l=n.shape_tree_type,c=i.__assign(i.__assign({shapeId:s,shapeTreeType:l},a),{snapshotMimeDataID:o}),u=Math.min(r.begin.position,r.end.position),d={name:"editWebshape",param:c};e.cmdExecutor.exec(d)&&(r._dispatch("onUILOperationTriggered",u,null,{isEditing:!0}),r.onCmdExec())}),r);else{var s=t.selection,l=n.id,c=n.shape_tree_type,u=i.__assign({shapeId:l,shapeTreeType:c},a),d=Math.min(s.begin.position,s.end.position),h={name:"editWebshape",param:u};if(!e.cmdExecutor.exec(h))return;s._dispatch("onUILOperationTriggered",d,null,{isEditing:!0}),s.onCmdExec()}var p=window.APP.data.selection.activeShape;if(p){var f=p.renderInfo.svgNode.getElementsByTagName("foreignObject")[0];f&&(0,o.updateWebshapeByEdit)(f,a.webExtensionUrl,p.id)}},t.insertWebshape=function(e,t,n){(0,o.uploadMimeDataImg)((function(i){var a=t.selection,o=n.pos,r=n.len,s=n.webExtensionUrl,l={pos:o=o||a.begin.position,len:r=r||a.end.position-a.begin.position,webExtensionUrl:s,webExtensionKey:"webshape",woUserID:window.APP.userTagId,mimeDataID:i},c=Math.min(a.begin.position,a.end.position),u={name:"insertWebshape",param:l};e.cmdExecutor.exec(u)&&(a._dispatch("onUILOperationTriggered",c,null,{isEditing:!0}),a.onCmdExec())}))},t.switchTolink=function(e,t,n){var i=t.selection,a=n.id,o=null==n?void 0:n.shape_tree_type,r={pos:n.begin,shapeId:a,shapeTreeType:o,_textToDisplay:n.webshapeDisplayText,woUserID:window.APP.userTagId},s=Math.max(i.begin.position,i.end.position),l={name:"switchToLink",param:r};e.cmdExecutor.exec(l)&&(i._dispatch("onUILOperationTriggered",s,null,{isEditing:!0}),i.onCmdExec())}},6751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.configs=new Map,this.setVisibilityForUsers=function(e){var n=!1;e.forEach((function(e){var i,a=e.userName,o=e.visible;t.configs.has(a)?(i=t.configs.get(a),n=n||i.visible!==o,i.visible=o):(i={userName:a,visible:o},n=!0,t.configs.set(a,i))})),n&&t.onConfigUpdated()},this.app=e}return e.prototype.isVisibleForUser=function(e){return!this.configs.has(e)||this.configs.get(e).visible},e.prototype.onConfigUpdated=function(){this.app.workspace.refreshForcedly();var e=this.app.workspace.revisionComment,t=e.dataHandler;t.ModifyModalToFit&&t.ModifyModalToFit(),t.setCardVisible&&t.setCardVisible(),e.update&&e.update()},e}();t.default=i},6752:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(812),a=[];for(var o in i.a)a.push(i.a[o]);var r={mouse:["mousedown","mousemove","mouseleave","mouseover","mouseout","mouseup","click","dbClick","contextmenu","mouseenter","mousewheel"],gesture:a,keyboard:["keydown","keypress","keyup","copy","paste","compositionstart","compositionupdate","compositionend","input"],window:["focus","blur","scroll","resize","beforeunload","orientationchange"],document:["visibilitychange"],custom:function(e){return-1!==e.indexOf(".")||-1!==e.indexOf("_")||/[A-Z]+/.test(e)}}},7123:function(e,t,n){"use strict";var i=n(13),a=n.n(i),o=n(300),r=n.n(o),s=n(80),l=n.n(s),c=n(1),u=n.n(c),d=n(2),h=n.n(d),p=n(22),f=n.n(p),g=n(23),v=n.n(g),y=n(2139),m=n(1736),_=n(1590),x=n(1734),w=n(2293),k=n(3972),b=n(167),T=n(227),C=n(698),S=n(691),E=n(623),P=n(3861),L=n(811),A=function(){function e(t){u()(this,e),this.doc=t}return h()(e,[{key:"setChpx",value:function(e,t,n){if(e.len<=0||e.pos<0)return!1;for(var i=new L.a,a=0;a<t.length;a++)i[t[a]]=n[a];window.g_rpt.beginTransact();var o=window.g_rpt.getCurrentTransact(),r=e.rgs;if(void 0===r)console.log("怎么没传rgs！"),this.doc.textStream.setTextProp({pos:e.pos,len:e.len},i,L.j.Set);else{for(var s=r.length,l=0;l<s;++l){var c=r[l];this.doc.textStream.setTextProp({pos:c.pos,len:c.len},i,L.j.Set)}delete e.rgs}return o.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"setBold",value:function(e){var t=[e.value,e.value];return this.setChpx(e,["bold","bold_cs"],t)}},{key:"setItalic",value:function(e){var t=[e.value,e.value];return this.setChpx(e,["italic","italic_cs"],t)}},{key:"setUnderline",value:function(e){var t=[],n=[];return Object(P.g)(e.underlineType,e.underlineColor,t,n),e.rgs=Object(P.a)(this.doc,e.rgs),e.pos=Math.min(e.rgs[0].pos,e.pos),e.len=Math.max(e.rgs[e.rgs.length-1].pos+e.rgs[e.rgs.length-1].len-e.pos,e.len),this.setChpx(e,t,n)}},{key:"setStrikeThrough",value:function(e){var t=[],n=[];return Object(P.f)(e.value,t,n),this.setChpx(e,t,n)}},{key:"setSize",value:function(e){var t=[e.value,e.value];return this.setChpx(e,["font_size_normal","font_size_cs"],t)}},{key:"setSuperscript",value:function(e){var t=[e.value?1:0];return this.setChpx(e,["script_pos"],t)}},{key:"setSubscript",value:function(e){var t=[e.value?-1:0];return this.setChpx(e,["script_pos"],t)}},{key:"setName",value:function(e){var t=[],n=[];return Object(P.c)(e.value,this.doc.fonttable,t,n),this.setChpx(e,t,n)}},{key:"setColor",value:function(e){var t=[],n=[];return Object(P.b)("font_color",e.value,t,n),this.setChpx(e,t,n)}},{key:"setHighlightColor",value:function(e){var t=[],n=[];return-16777216===e.value?(t.push("highlight_color"),n.push("#ffffffffff000000")):Object(P.b)("highlight_color",e.value,t,n),this.setChpx(e,t,n)}},{key:"_getGrowUpChpxs",value:function(e){var t=this.doc.getDataLogic("final"),n=e.rgs,i=[];if(void 0===n)console.log("怎么没传rgs！"),i=t.collectChpxs(e.pos,e.len);else for(var a=n.length,o=0;o<a;++o){var r=n[o];i=i.concat(t.collectChpxs(r.pos,r.len))}if(0===i.length)return console.log("param.pos和param.len传得有问题！"),i;i[0].pos<e.pos&&(i[0].len-=e.pos-i[0].pos,i[0].pos=e.pos);var s=i[i.length-1].pos+i[i.length-1].len;return s>e.pos+e.len&&(s=e.pos+e.len,i[i.length-1].len=s-i[i.length-1].pos),i}},{key:"growUp",value:function(e){if(e.len<=0||e.pos<0)return!1;var t=this._getGrowUpChpxs(e);if(0===t.length)return!1;window.g_rpt.beginTransact();for(var n=window.g_rpt.getCurrentTransact(),i=0;i<t.length;i++){var a=t[i].prop,o=a.font_size_normal,r=a.font_size_cs;if(void 0!==o||void 0!==r){var s=new L.a;void 0!==o&&(s.font_size_normal=e.value?Object(P.d)(o):Object(P.e)(o)),void 0!==r&&(s.font_size_cs=e.value?Object(P.d)(r):Object(P.e)(r)),this.doc.textStream.setTextProp(t[i],s,L.j.Set)}}return n.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"setAllCaps",value:function(e){var t=[e.value?1:0];return this.setChpx(e,["caps"],t)}},{key:"setSmallCaps",value:function(e){var t=[e.value?1:0];return this.setChpx(e,["small_caps"],t)}},{key:"setDoubleStrikeThrough",value:function(e){var t=[e.value?1:0];return this.setChpx(e,["double_strike"],t)}},{key:"setEmphasisMark",value:function(e){var t=[e.value];return this.setChpx(e,["emphasis_type"],t)}},{key:"setHidden",value:function(e){var t=[e.value?1:0];return this.setChpx(e,["vanish"],t)}},{key:"setScaling",value:function(e){var t=[e.value];return this.setChpx(e,["character_scale"],t)}},{key:"setSpacing",value:function(e){var t=[20*e.value];return this.setChpx(e,["spacing"],t)}}]),e}(),I=n(1731),R=function(){function e(t,n){u()(this,e),this.docCmdExec=t,this.doc=n}return h()(e,[{key:"applyToRange",value:function(e){if(e.len<=0||e.pos<0)return!1;var t=this.doc.stylesheet.findStyle(e.value);if(void 0===t)return!1;var n={id:e.value,name:t.name};return e.value===I.o?this.docCmdExec.fontCmdExec.setChpx(e,["basestyle"],[n]):this._setParaStyle(e,t)}},{key:"_setParaStyle",value:function(e,t){var n=this;if(e.pos<0||e.len<0)return!1;window.g_rpt.beginTransact();var i=window.g_rpt.getCurrentTransact(),a=this.doc.getDataLogic("prime").collectPapxs(e.pos,e.len),o=e.rgs||[e];if(a.length>1||1===a.length&&a[0].pos===e.pos&&e.len>=a[0].len-1){var r=new L.c;r.basestyle={id:e.value,name:t.name};for(var s=0;s<o.length;++s){var l=o[s];this.doc.datalogics.prime.collectChpxs(l.pos,l.len).forEach((function(e){n.shouldClearChpx(e)&&n._clearTextProp({pos:e.pos,len:e.len})})),this.doc.textStream.setParaProp({pos:l.pos,len:l.len},r,L.j.Set)}delete e.rgs}else{var c=t.linkStyle||this._createChpLinkStyle(t),u=new L.a;u.basestyle={id:c.id,name:c.name};for(var d=0;d<o.length;++d){var h=o[d];this._clearTextProp({pos:h.pos,len:h.len}),this.doc.textStream.setTextProp({pos:h.pos,len:h.len},u,L.j.Set)}}return i.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"_clearTextProp",value:function(e){var t=new L.a;t.clearAll(),t.font_size_normal=null,t.font_size_cs=null,t.bold=null,t.bold_cs=null,t.basestyle=null,this.doc.textStream.setTextProp(e,t,L.j.Clear)}},{key:"_createChpLinkStyle",value:function(e){return e}},{key:"shouldClearChpx",value:function(e){return!e.prop.basestyle||e.prop.basestyle.id!==I.b}}]),e}(),O=n(5299),M=n(1470),D=n(240),N=n(336),B=n(1033),j=n(3036),F=function(){function e(t){u()(this,e),this.doc=t}return h()(e,[{key:"getPapx",value:function(e){var t=e.rgs;if(void 0!==t){var n=this.doc.getDataLogic("final"),i=void 0;return t.forEach((function(e){n.collectPapxs(e.pos,e.len).forEach((function(e){var t=e.prop;void 0===i?i=t:i.intersect(t)}))})),i}console.log("怎么没传rgs！")}},{key:"setPapx",value:function(e,t,n){if(e.pos<0||e.len<=0&&e.opType!==B.List_ApplyToRange&&e.opType!==B.Font_Para_ClearFormat&&e.opType!==B.Para_RemoveIndent)return!1;for(var i=new L.c,a=0;a<t.length;a++)i[t[a]]=n[a];window.g_rpt.beginTransact();var o=window.g_rpt.getCurrentTransact(),r=e.rgs;if(void 0===r)console.log("怎么没传rgs！"),this.doc.textStream.setParaProp({pos:e.pos,len:e.len},i,L.j.Set);else{for(var s=r.length,l=0;l<s;++l){var c=r[l];this.doc.textStream.setParaProp({pos:c.pos,len:c.len},i,L.j.Set)}delete e.rgs}return o.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"setAlignment",value:function(e){var t=this.getPapx(e),n=e.value;void 0!==t&&t.getPropVal("bidi")&&(n===m.Right?n=m.Left:n===m.Left&&(n=m.Right));var i=[n];return this.setPapx(e,["horizontal_align_mode"],i)}},{key:"setLineSpacing",value:function(e){var t=null;switch(e.rule){case j.a:t=[{rule:"atLeast",value:Object(N.Pt2Ti)(e.value)}];break;case j.b:t=[{rule:"exact",value:Object(N.Pt2Ti)(e.value)}];break;default:t=[{rule:"auto",value:parseInt(240*(e.value+.004))}]}return this.setPapx(e,["line_spacing"],t)}},{key:"_changeIndent",value:function(e,t){var n=this.doc.getDataLogic("final"),i=[];if(void 0===e.rgs)console.log("怎么没传rgs！"),i=n.collectPapxs(e.pos,e.len);else for(var a=e.rgs.length,o=0;o<a;++o){var r=e.rgs[o];i=i.concat(n.collectPapxs(r.pos,r.len))}if(0===i.length)return console.log("param.pos和param.len传得有问题！"),!1;var s="left_indent_chars",l="left_indent_abs";t&&(s="first_line_indent_chars",l="first_line_indent_abs");var c=this.doc.defFontSize();(!c||c<=0)&&(c=210);var u=Number.MAX_SAFE_INTEGER;e.pageWidth&&(u=Object(N.Pt2Ti)(Math.floor(Object(N.Ti2Pt)(e.pageWidth)))),window.g_rpt.beginTransact();for(var d=window.g_rpt.getCurrentTransact(),h=0;h<i.length;h++){var p=i[h],f=new L.c;if(null!=p.prop[l]&&(null==p.prop[s]||0==p.prop[s])){var g=p.prop[l];e.value?g+=c:(g-=c,g=Math.max(g,0)),g=Math.min(u,g),f[s]=0,f[l]=g}else{var v=void 0!==p.prop[s]?p.prop[s]:0;e.value?v+=100:(v-=100,v=Math.max(v,0)),v=Math.min(Math.floor(100*u/c),v),f[s]=v,0===v&&(f[l]=0)}this.doc.textStream.setParaProp({pos:p.pos,len:p.len},f,L.j.Set)}return d.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"changeIndent",value:function(e){return this._changeIndent(e,!1)}},{key:"changeFirstLineIndent",value:function(e){return this._changeIndent(e,!0)}},{key:"setList",value:function(e){if(0!==e.value)return!0;return this.setPapx(e,["list_id"],[-1])}},{key:"removeIndent",value:function(e){return this.setPapx(e,["left_indent_chars","left_indent_abs","first_line_indent_chars","first_line_indent_abs"],[0,0,0,0])}},{key:"getPapxsByParam",value:function(e){var t=this.doc.getDataLogic("final"),n=[];if(void 0===e.rgs)n=t.collectPapxs(e.pos,e.len);else for(var i=e.rgs.length,a=0;a<i;++a){var o=e.rgs[a];if(0===a)n=t.collectPapxs(o.pos,o.len);else{var r=t.collectPapxs(o.pos,o.len);n.concat(r)}}return n}},{key:"applyBorders",value:function(e,t,n){for(var i=this,a=this.doc.getDataLogic("final").collectPapxs(e,t),o=function(e){var t=a[e];if(!t.good||!t.prop)return"continue";Object.keys(n).forEach((function(e){t.prop[e]&&(n[e]=Object.assign({},t.prop[e],n[e]))}));var o=new L.c;Object.assign(o,n),i.doc.textStream.setParaProp({pos:t.pos,len:t.len},o,L.j.Set)},r=0;r<a.length;r++)o(r)}},{key:"setBorders",value:function(e){var t=e.border;if(!t)return console.log("setBorders: border没有传！"),!1;var n=this.getPapxsByParam(e);delete e.rgs,window.g_rpt.beginTransact();for(var i=window.g_rpt.getCurrentTransact(),a=0;a<n.length;a++){var o=n[a],r=new L.c;Object.assign(r,t),this.doc.textStream.setParaProp({pos:o.pos,len:o.len},r,L.j.Set)}return i.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"setReadingOrder",value:function(e){var t=this.getPapx(e),n=e.value,i=["bidi"],a=[n];if(void 0!==t&&void 0!==t.horizontal_align_mode&&t.bidi===O.a&&n===O.b){var o=t.horizontal_align_mode;o===m.Right?o=m.Left:o===m.Left&&(o=m.Right),i.push("horizontal_align_mode"),a.push(o)}return this.setPapx(e,i,a)}},{key:"_setIndent",value:function(e,t,n){var i=[],a=[];return e.unit===M.UnitType.Unit_ref?(i.push(t),a.push(100*e.value),i.push(n),a.push(0)):(i.push(t),a.push(0),i.push(n),a.push(20*Object(D.convertUnit)(e.value,M.UnitName[e.unit],"pt"))),this.setPapx(e,i,a)}},{key:"setLeftIndent",value:function(e){return this._setIndent(e,"left_indent_chars","left_indent_abs")}},{key:"setFirstLineIndent",value:function(e){var t=[],n=[];if(e.unit===M.UnitType.Unit_ref)t.push("first_line_indent_chars"),n.push(100*e.value),t.push("first_line_indent_abs"),n.push(0);else{t.push("first_line_indent_chars"),n.push(0),t.push("first_line_indent_abs");var i=Object(D.convertUnit)(e.value,M.UnitName[e.unit],"pt");n.push(20*i),void 0!==e.leftIndentVal&&i<0&&(e.leftIndentVal-=i,t.push("left_indent_abs"),n.push(20*e.leftIndentVal),t.push("left_indent_chars"),n.push(0))}return this.setPapx(e,t,n)}},{key:"setRightIndent",value:function(e){return this._setIndent(e,"right_indent_chars","right_indent_abs")}},{key:"_setSinglePapx",value:function(e,t){var n=[t],i=[e.value];return this.setPapx(e,n,i)}},{key:"_setSpace",value:function(e,t,n,i){var a=[],o=[];return e.isAuto?(a.push(i),o.push(!0)):(a.push(i),o.push(!1)),e.unit===M.UnitType.Unit_ref?(a.push(n),o.push(100*e.value),a.push(t),o.push(0)):(a.push(t),o.push(20*Object(D.convertUnit)(e.value,M.UnitName[e.unit],"pt")),a.push(n),o.push(0)),this.setPapx(e,a,o)}},{key:"setSpaceBefore",value:function(e){return this._setSpace(e,"para_margin_before","para_lineunit_margin_before","para_margin_before_auto")}},{key:"setSpaceAfter",value:function(e){return this._setSpace(e,"para_margin_after","para_lineunit_margin_after","para_margin_after_auto")}},{key:"clearParaLayout",value:function(e){return this.setPapx(e,["left_indent_chars","left_indent_abs","right_indent_chars","right_indent_abs","first_line_indent_chars","first_line_indent_abs","para_margin_before","para_lineunit_margin_before","para_margin_before_auto","para_margin_after","para_lineunit_margin_after","para_margin_after_auto","line_spacing"],[0,0,0,0,0,0,0,0,!1,0,0,!1,{rule:"auto",value:240}])}},{key:"setOutlineLevel",value:function(e){return this._setSinglePapx(e,"out_line_level")}},{key:"setFarEastLineBreakControl",value:function(e){return this._setSinglePapx(e,"kinsoku")}},{key:"setWordWrap",value:function(e){return this._setSinglePapx(e,"word_wrap")}},{key:"setHangingPunctuation",value:function(e){return this._setSinglePapx(e,"overflow_punct")}},{key:"setHalfWidthPunctuationOnTopOfLine",value:function(e){return this._setSinglePapx(e,"topline_punct")}},{key:"setAddSpaceBetweenFarEastAndAlpha",value:function(e){return this._setSinglePapx(e,"auto_space_de")}},{key:"setAddSpaceBetweenFarEastAndDigit",value:function(e){return this._setSinglePapx(e,"auto_space_dn")}}]),e}(),H=n(4750),G=function(){function e(t,n){u()(this,e),this.docCmdExec=t,this.selection=n}return h()(e,[{key:"executeCMD",value:function(e){var t=this.getCmdName(e),n=this.selection.getCmdExecuteRange(),i={name:"execWordToolCmd",param:{op:t,pos:n.pos,len:n.len}};this.docCmdExec.exec(i)}},{key:"getCmdName",value:function(e){var t=void 0;switch(e){case H.i:t="rearrangeParagraph";break;case H.f:t="smartRearrange";break;case H.j:t="toBlankParagraphSplitMode";break;case H.b:t="deleteBlankParagraph";break;case H.d:t="deletePrefixSpaces";break;case H.e:t="deleteSpaces";break;case H.c:t="deleteSoftReturn";break;case H.k:t="convertSoftReturn";break;case H.g:t="insertParagraphInd";break;case H.h:t="paragraphInd2Spaces";break;case H.a:t="insertBlankParagraphs"}return t}}]),e}(),U=n(4751),W=n(1916),Y=n(1639),z=n(4104),X=n(324),V=n(309),q=n(614),K=n(1104),Q=n(4111),J=n(1403),Z=n(1251),$=n(260),ee=n(4108);function te(e){return window.g_rpt.defaultFactory.createObjectForSvr(q.default.OType_Data,"",{data:e},null)}var ne={},ie={},ae=function(){function e(t,n){var i=this;u()(this,e),this.insertFile=function(e){var t=e.uploadId,n=e.cb;if(t){var a=i.selection.getNormalRange(),o={pos:a.pos,len:a.len,mimeDataID:t};return i.data.api.sendCommandBlock("insertFile",o,(function(e){"function"==typeof n&&n(e)}))}console.error("uploadIds undefined")},this.app=t,this.data=n,this.selection=n.selection,this.doc=n.doc,this.fontCmdExec=new A(n.doc),this.paraFormatCmdExec=new F(n.doc),this.styleCmdExec=new R(this,n.doc),this.wordToolCmdExec=new G(this,n.selection),this.isExecutingCmd=!1,this.timerID=0,this.processingCommands=[],this._insertEditTimer=this._insertEditTimer.bind(this),this._deleteEditTimer=this._deleteEditTimer.bind(this)}return h()(e,[{key:"getCurrentLocalCommand",value:function(){var e=window.g_rpt.getTransact(window.g_rpt.curVersion);return e&&e.localCommand}},{key:"beforeSendCMDCommonModify",value:function(e){this.selection.selContext.isInHeaderFooter&&(this.selection.end&&this.selection.end.isInFooter?e.param.isInFooter=!0:e.param.isInHeader=!0)}},{key:"beforeSendCMDCheck",value:function(e){if(this.app.isReadOnly()&&!this.app.isAllowCmd(e.name,e.param)&&("formatOp"!==e.name||!this.app.isHighlightMode))return console.error(this.app.readOnlyError),!1;if(!e||!e.name)return!1;if(this.data.api.hasBlocking())return!1;var t=window.g_rpt.getLastLocalCommand();return!(t&&t.param&&t.param.isComposing&&(!e.param||!e.param.composingAllowCommand))}},{key:"_mockEditError",value:function(){"edit"===this.app.mockCoreErrorType&&this.app.handleMockError("mock edit error")}},{key:"handleCmdExecException",value:function(e,t,n){try{if(this._mockEditError(),"function"==typeof n)return t||(this.app.isExecutingCmd=!0,this.app.cmdUserId=this.app.info.userid),n()}catch(n){if(t||(this.app.cmdUserId=null,this.app.isExecutingCmd=!1),window.__CONFIG__.wps.isEnableCmdExceptionReload&&$.default.dispatchEvent($.default.names.ON_CORE_ERROR),!this.isCmdExceptionOccurred){var i=JSON.stringify(a()({type:"edit",name:"edit_blocking",cmd:e},this.app.getCoreErrorContext())),o={message:i,stack:n.stack,toString:function(){return i}};window.badJsFunc(!1,{error:o}),console.error(window.isDebugger?n:new Error(i)),this.isCmdExceptionOccurred=!0}}}},{key:"exec",value:function(e,t){var n=this;this.processingCommands.push(e);var i=this.handleCmdExecException(e.name,t,(function(){return!(!t&&!n.beforeSendCMDCheck(e))&&(n.beforeSendCMDCommonModify(e),t?console.log("[auxops] reapply ",JSON.stringify(e)):console.log("[auxops] exec ",JSON.stringify(e)),n[e.name](e.param,e.cb))}));return this.processingCommands.pop(),i}},{key:"sendCommandBlock",value:function(e,t){var n=this;return this.handleCmdExecException(e.name,!1,(function(){return!!n.beforeSendCMDCheck(e)&&(n.beforeSendCMDCommonModify(e),n.data.api.sendCommandBlock(e.name,e.param,t))}))}},{key:"sendCommandQueue",value:function(e){var t=this;return this.handleCmdExecException(e.name,!1,(function(){t.data.api.sendCommandQueue(e.name,e.param)}))}},{key:"redo",value:function(){var e=this;return this.handleCmdExecException("redo",!1,(function(){if(window.g_rpt.canRedoLocal()){var t=window.g_rpt.redo();null!==t&&t.isLocalTransact()}else if(window.g_rpt.canRedo()&&!e.data.api.hasCommands()&&!e.data.api.hasBlocking()){if(!e.data.doc.useCoreTypo){var n=e.data.selection.getNormalRange();e.app.prepareRange({gcpCurrent:n.pos,length:1e3})}e.data.api.sendRedo()&&window.g_rpt.redo()}}))}},{key:"undo",value:function(){var e=this;return this.handleCmdExecException("undo",!1,(function(){if(window.g_rpt.canUndoLocal()&&(e.data.api.hasCommands()||window.g_rpt.isTransactCanMerge())){var t=window.g_rpt.undo();null!==t&&t.isLocalTransact()&&e.data.api.popCommand()}else if(window.g_rpt.canUndo()&&!e.data.api.hasCommands()&&!e.data.api.hasBlocking()){if(!e.data.doc.useCoreTypo){var n=e.data.selection.getNormalRange();e.app.prepareRange({gcpCurrent:n.pos,length:1e3})}e.data.api.sendUndo()&&window.g_rpt.undo()}}))}},{key:"formatOp",value:function(e){var t=this.selection.selInfo.getSelectionInfo();switch(!this.app.isWebMode()&&t.isTextboxSelected&&1===e.len&&(void 0!==e.pos&&(e.pos=t.textbox.pos),void 0!==e.len&&(e.len=t.textbox.len),e.rgs&&e.rgs.length>0&&(e.rgs.length>1&&console.log("文本框全选应该只有rgs[0]"),e.rgs[0].pos=t.textbox.pos,e.rgs[0].len=t.textbox.len)),e.opType){case B.Font_Bold:return this.fontCmdExec.setBold(e);case B.Font_Italic:return this.fontCmdExec.setItalic(e);case B.Font_Underline:return this.fontCmdExec.setUnderline(e);case B.Font_StrikeThrough:return this.fontCmdExec.setStrikeThrough(e);case B.Font_FontSize:return this.fontCmdExec.setSize(e);case B.Font_GrowUp:return this.fontCmdExec.growUp(e);case B.Font_Superscript:return this.fontCmdExec.setSuperscript(e);case B.Font_Subscript:return this.fontCmdExec.setSubscript(e);case B.Font_Name:return this.fontCmdExec.setName(e);case B.Font_Color:return this.fontCmdExec.setColor(e);case B.Font_Para_ClearFormat:return this.clearFormatting(e);case B.Font_AllCaps:return this.fontCmdExec.setAllCaps(e);case B.Font_SmallCaps:return this.fontCmdExec.setSmallCaps(e);case B.Font_DoubleStrikeThrough:return this.fontCmdExec.setDoubleStrikeThrough(e);case B.Font_EmphasisMark:return this.fontCmdExec.setEmphasisMark(e);case B.Font_Hidden:return this.fontCmdExec.setHidden(e);case B.Font_Scaling:return this.fontCmdExec.setScaling(e);case B.Font_Spacing:return this.fontCmdExec.setSpacing(e);case B.Font_HighlightColor:return this.fontCmdExec.setHighlightColor(e);case B.Para_Alignment:return this.paraFormatCmdExec.setAlignment(e);case B.Style_ApplyToRange:return this.styleCmdExec.applyToRange(e);case B.Para_LineSpacing:return this.paraFormatCmdExec.setLineSpacing(e);case B.Para_ChangeIndent:return this.paraFormatCmdExec.changeIndent(e);case B.Para_ChangeFirstLineIndent:return this.paraFormatCmdExec.changeFirstLineIndent(e);case B.Para_RemoveIndent:return this.paraFormatCmdExec.removeIndent(e);case B.List_ApplyToRange:return this.paraFormatCmdExec.setList(e);case B.Para_Borders:return this.paraFormatCmdExec.setBorders(e);case B.Para_ReadingOrder:return this.paraFormatCmdExec.setReadingOrder(e);case B.Para_LeftIndentAbsAndRef:return this.paraFormatCmdExec.setLeftIndent(e);case B.Para_FirstLineIndentAbsAndRef:return this.paraFormatCmdExec.setFirstLineIndent(e);case B.Para_RightIndentAbsAndRef:return this.paraFormatCmdExec.setRightIndent(e);case B.Para_SpaceBeforeAbsAndRef:return this.paraFormatCmdExec.setSpaceBefore(e);case B.Para_SpaceAfterAbsAndRef:return this.paraFormatCmdExec.setSpaceAfter(e);case B.Para_ClearLayout:return this.paraFormatCmdExec.clearParaLayout(e);case B.Para_OutlineLevel:return this.paraFormatCmdExec.setOutlineLevel(e);case B.Para_FarEastLineBreakControl:return this.paraFormatCmdExec.setFarEastLineBreakControl(e);case B.Para_WordWrap:return this.paraFormatCmdExec.setWordWrap(e);case B.Para_HangingPunctuation:return this.paraFormatCmdExec.setHangingPunctuation(e);case B.Para_HalfWidthPunctuationOnTopOfLine:return this.paraFormatCmdExec.setHalfWidthPunctuationOnTopOfLine(e);case B.Para_AddSpaceBetweenFarEastAndAlpha:return this.paraFormatCmdExec.setAddSpaceBetweenFarEastAndAlpha(e);case B.Para_AddSpaceBetweenFarEastAndDigit:return this.paraFormatCmdExec.setAddSpaceBetweenFarEastAndDigit(e);default:console.log("大哥，param传错了！")}}},{key:"_deleteTextInCellRanges",value:function(e){for(var t=e.length-1;t>=0;t--)for(var n=e[t].length-1;n>=0;n--){var i=e[t][n].begin,a=e[t][n].end-e[t][n].begin-1;a&&this.doc.textStream.deleteText(i,a)}}},{key:"insertText",value:function(e){if(e.strlen<=0||e.pos<0)return!1;if(e.chpx&&!(e.chpx instanceof L.a)){var t=new L.a;t.setProps(e.chpx),e.chpx=t}window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact(),i=0==e.len||e.isComposing;return i||this.doc.textStream.deleteText(e.pos,e.len),this.doc.textStream.insertText(e.pos,e.string,e.chpx,e.ipChpx,i,e.woUserID),this.doc.mathManager.onCmdInsertText(this,e.pos,e.string),n.localCommand={name:"insertText",param:e,canMerge:!1},n.canMerge=!1,window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"insertTextForSel",value:function(e){if(e.strlen<=0||e.pos<0)return!1;var t=this.closeComposingTransact();t.result&&(e.pos=t.pos),window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact(),i=e.pos;if(e.len>0){var a=e.len;if(this.doc.isContainLastParaBreak(e.pos,a))a-=1;else if(this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,e.pos+a-1),e.pos+a===ie.end)if(ie.node.prop.getPropVal("para_type")===K.b){var o=this.getFirstCellRange(e.pos),r=o.range;o.isInCell&&(a=r.pos+r.len-e.pos),a-=1}else a=this.calcDeleteTextLength(e);a>0&&(i=this.doc.textStream.deleteText(e.pos,a))}for(;;){var s=this.doc.anchors.findAnchor(i);if(s&&s.wrapMode===Z.a)break;var l=this.doc.textStream.getText(i,1);if(l&&l.length>0){var c=l.charCodeAt(0);if(c===X.a||c===X.f){++i;continue}}break}i!==e.pos&&(e.insertPos=i),this.doc.textStream.insertText(i,e.string,e.chpx,e.ipChpx,0===e.len,e.woUserID),this.doc.mathManager.onCmdInsertText(this,i,e.string),n.localCommand={name:"insertText",param:e};var u=q.default.ctCommit,d=!1,h=window.g_rpt.isTransactCanMerge(),p=window.g_rpt.getLastLocalCommand();!h||"insertText"==p.name&&e.pos==p.param.pos+p.param.strlen||(h=!1);var f=0;h?f=(null!=p.param.strlen?p.param.strlen:p.param.string.length)+(null!=e.strlen?e.strlen:e.string.length):f=null!=e.strlen?e.strlen:e.string.length;f>=20&&(d=!0),!0===h&&!1===d?u=q.default.ctCommit_Merge:!0===h&&!0===d?u=q.default.ctCommit_MergeAndClose:!1===h&&!0===d?u=q.default.ctCommit:!1===h&&!1===d&&(u=q.default.ctCommit_UnClose);var g=e.string.substr(e.string.strlen-1);return" "!==g&&"\t"!==g||(u=q.default.ctCommit),window.g_rpt.endTransact(!1,u),0!==this.timerID&&(clearTimeout(this.timerID),this.timerID=0),u!==q.default.ctCommit_Merge&&u!==q.default.ctCommit_UnClose||(this.timerID=setTimeout(this._insertEditTimer,800)),!0}},{key:"_insertEditTimer",value:function(){this._editTimer("insertText")}},{key:"_deleteEditTimer",value:function(){this._editTimer("deleteText")}},{key:"_editTimer",value:function(e){this.timerID=0,window.g_rpt.isTransactCanMerge()&&(window.g_rpt.getLastLocalCommand().name!==e&&console.error(e+" merge error"),window.g_rpt.closeLastTransact(),console.log("----------timeout"))}},{key:"insertTextForMobileComposing",value:function(e){var t=this.closeComposingTransact();if(e.pos<0||e.strlen<0)return!1;if(0==e.strlen)return!0;t.result&&(e.pos=t.pos),window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact();return this.doc.textStream.insertText(e.pos,e.string,e.chpx,e.ipChpx,0===e.len,e.woUserID),e.isComposing=!0,n.localCommand={name:"insertText",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"insertTextForPCComposing",value:function(e){var t=this.closeComposingTransact();if(e.pos<0||e.strlen<0)return!1;t.result&&(e.pos=t.pos),window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact();return this.doc.textStream.insertText(e.pos,e.string,e.chpx,e.ipChpx,!0,e.woUserID),e.isComposing=!0,n.localCommand={name:"insertText",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"closeComposingTransact",value:function(){var e=window.g_rpt.getLastLocalCommand(),t=!1;if(!e||!e.param||!e.param.isComposing)return{result:t};t=!0;var n=e.param.pos;return window.g_rpt.dropLastTransact(),{result:t,pos:n}}},{key:"getFirstCellRange",value:function(e){var t={},n=!1;if(this.doc.textStream.getPapxTbl().findNodeContainPos(e).prop.getPropVal("nest_level")<1)return{range:t,isInCell:n};var i=this.doc.getDataLogic("final").specTable.getTapx(e);if(!i.prop)return{range:t,isInCell:n};var a=i.cellDatas.findIndex((function(t){return t.begin<=e&&t.end>e}));return-1===a?{range:t,isInCell:n}:(t.pos=i.cellDatas[a].begin,t.len=i.cellDatas[a].end-t.pos,{range:t,isInCell:n=!0})}},{key:"updateCtrlPlcHdrSync",value:function(e){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();return this.doc.textStream.insertText(e.pos,e.string),t.localCommand={name:"updateCtrlPlcHdrSync",param:e},t.canMerge=!1,window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"insertHyperlink",value:function(e){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertHyperlink",e)),!0)}},{key:"insertNHyperlink",value:function(e){return!!e.links.length&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertNHyperlink",e)),!0)}},{key:"deleteHyperlink",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&this.data.api.sendCommandBlock("deleteHyperlink",e,t),!0)}},{key:"editHyperlink",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("editHyperlink",e,t)),!0)}},{key:"insertWebshape",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("addWebExtension",e,t)),!0)}},{key:"switchToWebshape",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("convertHyperlink2webExtension",e,t)),!0)}},{key:"editWebshape",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("editWebExtension",e,t)),!0)}},{key:"switchToLink",value:function(e,t){return!(e.pos<0)&&(this.data.api.isConnected()&&(e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("convertWebExtension2hyperlink",e,t)),!0)}},{key:"insertTable",value:function(e,t){if(e.pos<0)return!1;if(this.data.api.isConnected())e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("insertTable",e,t);else if(b.isMobile){window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact();this._insertTable(e),n.localCommand={name:"insertTable",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit),"function"==typeof t&&t()}return!0}},{key:"_insertTable",value:function(e){var t=e.rowNum,n=e.columnNum;if(t<=0||t>32767||n<=0||n>63)return!1;var i=e.pos,a=this.doc.getDataLogic("prime"),o=a.getPapx(i),r=o.prop;if(r.getPropVal("para_type")===K.d)return!1;var s=a.getChpx(i).prop;void 0!==s.revision&&delete s.revision,s.special=!0,s.script_pos=0,o.pos<i&&(this.doc.textStream.insertParagraph(i),++i);var l=r.getPropVal("nest_level");r.para_type=K.b,r.nest_level=l+1,r.type=Q.b;var c=this.doc.stylesheet.getStyleByProp(r).papx;["revision","shading_back_color","shading_fill_color","shading_texture","border","left_indent_chars","left_indent_abs","first_line_indent_chars","first_line_indent_abs","right_indent_chars","right_indent_abs"].forEach((function(e){c[e]!==c.def[e]&&(c[e]=c.def[e]),void 0!==r[e]&&delete r[e]}));for(var u=0;u<t;++u){for(var d=0;d<n;++d)this.doc.textStream.insertParagraph(i,s,r),++i;for(var h=new L.c,p=[],f=0;f<n;++f){var g={width:{type:0,width:Object(N.Px2Ti)(30)}};p.push(g)}var v={};v.tableCells=p,v.defCellInnerMarginTop=0,v.defCellInnerMarginBottom=0,v.defCellInnerMarginLeft=108,v.defCellInnerMarginRight=108;v.borders={top:{lineWidth:10},bottom:{lineWidth:10},left:{lineWidth:10},right:{lineWidth:10}},h.para_type=K.d,h.nest_level=l+1,h.type=Q.b,h.table_row=v,this.doc.textStream.insertParagraph(i,s,h),++i}}},{key:"insertRowAbove",value:function(e){if(e.pos<0)return!1;if(this.data.api.isConnected())this.data.api.sendCommandBlock("insertRowAbove",e);else if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._insertRow(e.pos,e.pos,e.len,1),t.localCommand={name:"insertRowAbove",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}return!0}},{key:"insertRowBelow",value:function(e){if(e.pos<0)return!1;if(this.data.api.isConnected())this.data.api.sendCommandBlock("insertRowBelow",e);else if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._insertRow(e.pos+e.len,e.pos,e.len,1),t.localCommand={name:"insertRowBelow",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}return!0}},{key:"_insertRow",value:function(e,t,n,i){var a=this,o=e,r=!1,s=t,l=s+n,c=[];for(c.push([]);;){this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,t);var u=ie.node,d=u.prop.getPropVal("nest_level"),h=u.prop.getPropVal("para_type");if(h===K.b&&d===i){var p=this.doc.textStream.getChpxTbl().findNodeContainPos(t).prop;c[c.length-1].push({chpx:p,papx:u.prop})}else if(h===K.d&&d===i){var f=this.doc.textStream.getChpxTbl().findNodeContainPos(t).prop;c[c.length-1].push({chpx:f,papx:u.prop}),c.push([]),r=!0}else if(d<i)break;if(s=ie.end,r&&s>=l)break}0===c[c.length-1].length&&c.pop(),c.forEach((function(e){e.forEach((function(e){a.doc.textStream.insertParagraph(o,e.chpx,e.papx),++o}))}))}},{key:"insertColumnLeft",value:function(e){if(e.pos<0)return!1;if(this.data.api.isConnected())this.data.api.sendCommandBlock("insertColumnLeft",e);else if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._insertColumn(!0,1),t.localCommand={name:"insertColumnLeft",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}return!0}},{key:"insertColumnRight",value:function(e){if(e.pos<0)return!1;if(this.data.api.isConnected())this.data.api.sendCommandBlock("insertColumnRight",e);else if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._insertColumn(!1,1),t.localCommand={name:"insertColumnRight",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}return!0}},{key:"_getColumnInfo",value:function(){var e=this.selection.selInfo.getSelectionInfo();if(e.columnSelected){var t={ranges:[]};e.cells.forEach((function(e){var n={begin:e[0].begin,end:e[e.length-1].end};t.ranges.push(n)}));var n=e.idxs[0];return t.beginIdx=n[0],t.endIdx=n[n.length-1],t}}},{key:"_insertColumn",value:function(e,t){var n=this,i=this._getColumnInfo();if(i){var a=i.ranges,o=i.beginIdx,r=i.endIdx,s=[];a.forEach((function(i){if(e)for(var a=i.begin;;){n.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,a);var o=ie.node,r=o.prop.getPropVal("nest_level");if(o.prop.getPropVal("para_type")===K.b&&r===t){var l=n.doc.textStream.getChpxTbl().findNodeContainPos(a).prop;s.push({chpx:l,papx:o.prop});break}a=ie.end}else{var c=i.end-1,u=n.doc.textStream.getPapxTbl().findNodeContainPos(c),d=u.prop.getPropVal("nest_level");if(u.prop.getPropVal("para_type")===K.b&&d===t){var h=n.doc.textStream.getChpxTbl().findNodeContainPos(c).prop;s.push({chpx:h,papx:u.prop})}else console.log("_insertColumn data error!")}}));var l=[];a.forEach((function(e){for(var i=e.begin;;){n.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,i);var a=ie.node,o=a.prop.getPropVal("nest_level");if(a.prop.getPropVal("para_type")===K.d&&o===t){l.push(a.prop);break}i=ie.end}}));var c=r-o+1;a.forEach((function(t,i){var a=e?t.begin:t.end;a+=i*c;for(var o=0;o<c;++o)n.doc.textStream.insertParagraph(a,s[i].chpx,s[i].papx),++a})),l.forEach((function(t){var n=t.table_row.tableCells,i=!1,a=0;n.forEach((function(e){void 0===e.width||0!==e.width.type?i=!0:a+=e.width.width}));for(var s=e?n[o]:n[r],l=e?o:r+1,u=0;u<c;++u)n.splice(l,0,s);if(!i){var d=a/n.length;n.forEach((function(e){e.width.width=d}))}}))}}},{key:"deleteColumn",value:function(e){if(e.pos<0)return!1;if(this.data.api.isConnected())this.data.api.sendCommandBlock("deleteColumn",e);else if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._deleteColumn(1),t.localCommand={name:"deleteColumn",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}return!0}},{key:"_deleteColumn",value:function(e){var t=this,n=this._getColumnInfo();if(n){var i=n.ranges,a=n.beginIdx,o=n.endIdx,r=[];i.forEach((function(n){for(var i=n.begin;;){t.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,i);var a=ie.node,o=a.prop.getPropVal("nest_level");if(a.prop.getPropVal("para_type")===K.d&&o===e){r.push(a.prop);break}i=ie.end}}));var s=0;i.forEach((function(e){var n=e.end-e.begin,i=e.begin-s;t.doc.textStream.deleteText(i,n),s+=n})),r.forEach((function(e){e.table_row.tableCells.splice(a,o-a+1)}))}}},{key:"adjustTable",value:function(e){if(e.pos<0)return!1;if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._adjustTable(e.pos,e.xOff,e.yOff,1),t.localCommand={name:"adjustTable",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}else this.data.api.isConnected()&&this.data.api.sendCommandBlock("adjustTable",e);return!0}},{key:"_adjustTable",value:function(e,t,n,i){for(var a=[],o=e;o>=0;){this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,o);var r=ie.node,s=r.prop.getPropVal("nest_level");if(r.prop.getPropVal("para_type")===K.d&&s===i)a.push(r.prop);else if(s<i)break;o=ie.begin-1}a.reverse();for(var l=e+1;;){this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,l);var c=ie.node,u=c.prop.getPropVal("nest_level");if(c.prop.getPropVal("para_type")===K.d&&u===i)a.push(c.prop);else if(u<i)break;l=ie.end}var d=n/a.length;a.forEach((function(e,n){var i=e.table_row;void 0!==i.rowHeight?(i.rowHeight.exactly=0,i.rowHeight.rowHeight=void 0+d):i.rowHeight={exactly:0,rowHeight:void 0+d};var a=i.tableCells,o=t/a.length;a.forEach((function(e){void 0!==e.width&&0===e.width.type&&(e.width.width+=o)}))}))}},{key:"adjustRow",value:function(e){if(e.pos<0||e.len<=0)return!1;if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._adjustRow(e.pos+e.len-1,e.height),t.localCommand={name:"adjustRow",param:{pos:e.pos,len:e.len,height:Math.ceil(e.height/20)}},window.g_rpt.endTransact(!1,q.default.ctCommit)}else this.data.api.isConnected()&&this.data.api.sendCommandBlock("adjustRow",{pos:e.pos,len:e.len,height:Math.ceil(e.height/20)});return!0}},{key:"_adjustRow",value:function(e,t){var n=this.doc.textStream.getPapxTbl().findNodeContainPos(e).prop.table_row;n&&(void 0!==n.rowHeight?(n.rowHeight.exactly=0,n.rowHeight.rowHeight=t):n.rowHeight={exactly:0,rowHeight:t})}},{key:"adjustColumn",value:function(e){if(e.pos<0)return!1;if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._adjustColumn(e.offset,1),t.localCommand={name:"adjustColumnEx",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit)}else this.data.api.isConnected()&&this.data.api.sendCommandBlock("adjustColumnEx",e);return!0}},{key:"autoAdjustColumn",value:function(e){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("autoAdjustColumn",e)}},{key:"autoAdjustTable",value:function(e){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("autoAdjustTable",e)}},{key:"mergeTableCells",value:function(e){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("mergeTableCells",e)}},{key:"splitTableCells",value:function(e){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("splitTableCells",e)}},{key:"setCellsBorderStyle",value:function(e){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("setCellsBorderStyle",e)}},{key:"_cellMinWidth",value:function(e,t){return 20+(void 0!==t.innerMargin&&void 0!==t.innerMargin.left?t.innerMargin.left:e.defCellInnerMarginLeft)+(void 0!==t.innerMargin&&void 0!==t.innerMargin.right?t.innerMargin.right:e.defCellInnerMarginRight)}},{key:"_adjustColumn",value:function(e,t){var n=this,i=this._getColumnInfo();if(i){var a=i.ranges,o=[],r=[];a.forEach((function(e){for(var i=0,a=e.begin;;){n.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,a);var s=ie.node,l=s.prop.getPropVal("nest_level"),c=s.prop.getPropVal("para_type");if(c===K.b&&l===t)++i;else{if(c===K.d&&l===t){o.push(s.prop),r.push(i);break}if(l<t)break}a=ie.end}}));o.forEach((function(t,i){var a=t.table_row,o=a.tableCells,s=o.length-r[i];if(s===o.length-1){var l=o[s];if(l.width&&0===l.width.type){var c=l.width.width+e;l.width.width=Math.max(c,n._cellMinWidth(a,l))}}else{var u=o[s],d=o[s+1];if(u.width&&!u.width.type&&d.width&&!d.width.type){var h=u.width.width+e;h=Math.max(h,n._cellMinWidth(a,u));var p=u.width.width+d.width.width-h;p>n._cellMinWidth(a,d)&&(u.width.width=h,d.width.width=p)}}}))}}},{key:"insertParagraph",value:function(e){if(e.paraCount<=0||e.pos<0)return!1;window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();if(e.len>0){var n=e.deleteCellRanges;if(n)this._deleteTextInCellRanges(n);else{this.doc.isContainLastParaBreak(e.pos,e.len)&&(e.len-=1);var i=this.calcDeleteTextLength(e,!0);this.doc.textStream.deleteText(e.pos,i)}}for(var a=0;a<e.paraCount;++a)this.doc.textStream.insertParagraph(e.pos+a,e.chpx,e.papx),this.doc.textStream.setTrackingChanges(!1),this.clearBorder(e.pos+a),this.doc.textStream.setTrackingChanges(!0);return t.localCommand={name:"insertParagraph",param:e},window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"typeTab",value:function(e){return!(e.pos<0)&&(this.data.api.isConnected()&&this.data.api.sendCommandBlock("typeTab",e),!0)}},{key:"inheritPapx",value:function(e,t){if(this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,e),!(e<=0||1!==t||e+1!==ie.end)){var n=this.doc.getDataLogic("final"),i=n.getPapx(e),a=i.prop,o=n.getPapx(e+1).prop;if(null===o.getPropVal("drop_cap")&&a.getPropVal("nest_level")===o.getPropVal("nest_level")){var r=["type","para_type","nest_level","table_row"];return 1===i.len&&r.push("list_id"),r.forEach((function(e){void 0!==a[e]&&delete a[e]})),o.border_bottom&&o.border_bottom.styleType&&o.border_bottom.styleType===U.a&&o.border_bottom.style&&o.border_bottom.style!==W.l&&(a.boder_bottom=Object.assign({},o.border_bottom)),a}}}},{key:"movePicture",value:function(e){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("movePicture",e),!0}},{key:"deletePicture",value:function(e){var t=e.pos,n=e.len;if(1===n&&this.doc.comments){var i=this.doc.comments.collectComments(t,n);i&&i.length&&(e.len=n+i.length)}return this.data.api.sendCommandQueue("deletePicture",e),!0}},{key:"_expandRange",value:function(e){void 0!==e.rgs&&e.rgs.length>1||this.doc.contentControls.rangeClass.collectRanges(e.pos,e.len).length}},{key:"moveShape",value:function(e,t){return this.data.api.sendCommandBlock("moveShape",e,t),!0}},{key:"resizeShape",value:function(e,t){return this.data.api.sendCommandBlock("resizeShape",e,(function(e){t&&t(e)})),!0}},{key:"setShapeWrapFormat",value:function(e,t){return e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("setShapeWrapFormat",e,t),!0}},{key:"setShapeZOrder",value:function(e,t){return e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("setShapeWrapFormat",e,t),!0}},{key:"setShapeLayout",value:function(e){return e.bSendSelectionBack=!0,this.data.api.sendCommandBlock("setShapeLayout",e),!0}},{key:"modifyShapeProps",value:function(e,t){return this.data.api.sendCommandBlock("modifyShapeProps",e,(function(e){t&&t(e)})),!0}},{key:"modifyTextFrameProps",value:function(e,t){return this.data.api.sendCommandBlock("modifyTextFrameProps",e,(function(e){t&&t(e)})),!0}},{key:"groupShapes",value:function(e,t){var n=this,i=e.shapesSeq[0].shapeTreeType;return this.data.api.sendCommandBlock("groupShapes",e,(function(e){var a=e.groupShape,o=Object(ee.a)(i,a.shapeIdxPath),r=o.gcp,s=o.id;n.selection.selAlter.selectShape({gcp:r,id:s,shapeTreeType:i,shapeIdxPath:a.shapeIdxPath}),t&&t(e)})),!0}},{key:"ungroupShape",value:function(e,t){var n=this,i=e.shapesSeq[0].shapeTreeType;return this.data.api.sendCommandBlock("ungroupShape",e,(function(e){var a=e.rsShapesSeq.map((function(e){return e.shapeIdxPath})),o=Object(ee.a)(i,a[0]),r=o.gcp,s=o.id;n.selection.selAlter.selectShape({gcp:r,id:s,shapeTreeType:i,shapeIdxPath:a[0]},{selShapeIdxPaths:a}),t&&t(e)})),!0}},{key:"deleteShapes",value:function(e,t){return this.data.api.sendCommandBlock("deleteShapes",e,t),!0}},{key:"_deleteText",value:function(e){var t=void 0;this._expandRange(e);var n=e.pos,i=e.len;if(void 0!==e.minLayer&&void 0!==e.rgs){var a=e.rgs.length;if(a<=0)return console.log("err"),delete e.minLayer,void delete e.rgs;e.rgs[0].pos>e.rgs[a-1].pos&&e.rgs.reverse();for(var o=[],r=0;r<a;++r)for(var s=e.rgs[r],l=s.pos,c=s.pos;c<s.pos+s.len;){this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,c);var u=ie.node.prop,d=u.getPropVal("nest_level"),h=u.getPropVal("para_type");d===e.minLayer&&h===K.b&&(o.push({begin:l,end:ie.end-1}),l=ie.end),c=ie.end}var p=0;a=o.length;for(var f=0;f<a;++f){var g=o[f],v=g.end-g.begin;if(0!==v){var y=g.begin-p;p+=v,this.doc.textStream.deleteText(y,v)}}delete e.minLayer,delete e.rgs}else{var m=this.inheritPapx(n,i);i>0&&(e.cellRgs?this._deleteTextInCellRanges(e.cellRgs):(this.doc.isContainLastParaBreak(n,i)?--i:i=this.calcDeleteTextLength(e),t=this.doc.textStream.deleteText(n,i))),void 0!==m&&this.doc.textStream.setParaProp({pos:n,len:0},m,L.j.Set)}return t}},{key:"calcDeleteTextLength",value:function(e,t){var n=e.len;if(0===n)return n;var i=this.doc.textStream,a=i.getPapxTbl();if(a.fetchInfoContainPos(ie,e.pos+n-1),e.pos+n===ie.end){var o=ie.node.prop.getPropVal("nest_level"),r=a.findNodeContainPos(e.pos+n);if(r)if(o<r.prop.getPropVal("nest_level")&&n>1&&(a.fetchInfoContainPos(ie,e.pos),ie&&ie.begin!==e.pos||t))return n-1}var s=i.getPapx(e.pos),l=i.getPapx(e.pos+n-1);return!(l.prop.para_type===K.d)&&s.pos<e.pos&&s.pos<l.pos&&l.pos+l.len===e.pos+n?n-1:n}},{key:"deleteText",value:function(e){if(e.len<=0||e.pos<0||e.len<=0)return!1;window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();return this._deleteText(e),t.localCommand={name:"deleteText",param:e},t.canMerge=!1,window.g_rpt.endTransact(!1,q.default.ctCommit),!0}},{key:"deleteRow",value:function(e){return!(e.pos<0||e.len<=0)&&(this.data.api.isConnected()&&this.data.api.sendCommandBlock("deleteRow",e),!0)}},{key:"deleteTable",value:function(e){if(e.pos<0||e.len<=0)return!1;if(b.isMobile){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();this._deleteText(e),t.localCommand={name:"deleteTable",param:e},t.canMerge=!1,window.g_rpt.endTransact(!1,q.default.ctCommit)}else this.data.api.isConnected()&&this.data.api.sendCommandBlock("deleteTable",e);return!0}},{key:"_checkRange",value:function(e,t){return e.pos===t.pos+t.len}},{key:"deleteTextForSel",value:function(e){if(e.len<=0||e.pos<0)return!1;window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact(),n=this._deleteText(e);t.localCommand={name:"deleteText",param:e};var i=q.default.ctCommit;if(!0===e.isBackspace){var a=!1,o=window.g_rpt.isTransactCanMerge(),r=window.g_rpt.getLastLocalCommand();!o||"deleteText"==r.name&&0!=r.param.isBackspace&&"\r"!==e.string&&this._checkRange(r.param,e)||(o=!1),(r&&r.param.len+e.len>10||"\r"===e.string)&&(a=!0),1==o&&0==a?i=q.default.ctCommit_Merge:1==o&&1==a?i=q.default.ctCommit_MergeAndClose:0==o&&1==a?i=q.default.ctCommit:0==o&&0==a&&(i=q.default.ctCommit_UnClose)}return window.g_rpt.endTransact(!1,i),0!==this.timerID&&(clearTimeout(this.timerID),this.timerID=0),i!==q.default.ctCommit_Merge&&i!==q.default.ctCommit_UnClose||(this.timerID=setTimeout(this._deleteEditTimer,800)),n}},{key:"closeLastTransact",value:function(){0!==this.timerID&&(clearTimeout(this.timerID),this.timerID=0),window.g_rpt.isTransactCanMerge()&&window.g_rpt.closeLastTransact()}},{key:"adjustCommentPlaceholderPos",value:function(e){var t=e.pos+e.len;if(e.len<=0)return t;var n=this.doc.getDataLogic("final"),i=n.getPapx(t-1),a=i.prop.getPropVal("para_type");if(a===K.d&&t--,a===K.b)for(var o=n.specTable.getTapx(t),r=o.cells.length-1;r>=0;--r)if(!(o.cellDatas[r].begin>=t)){var s=o.cells[r].vertMerge;if(!s||2!=s)break;t=o.cellDatas[r].begin}if((i=n.getPapx(t-1)).pos+i.len==t&&(a=i.prop.getPropVal("para_type"))!==K.d&&t--,e.isReply)for(var l=this.doc.comments.rangeClass,c=l.findNodeEqualRange(e.pos,t+1);c&&c.isReply;)++t,c=l.findNodeEqualRange(e.pos,t+1);return t}},{key:"adjustCommentRange",value:function(e){var t=this.doc.fields.getFields({begin:e.pos,end:e.pos+e.len});if(t.length>0){t=t.map((function(e){return e._node})).filter((function(e){return"HYPERLINK"===e.type||"TOC"===e.type})).sort((function(e,t){return e.begin-t.begin}));for(var n=e.pos,i=e.pos+e.len,a=0;a<t.length;++a)t[a].begin<n&&(n=t[a].begin),t[a].end>i&&(i=t[a].end);var o=e.pos>n?e.pos-n:0,r=e.pos+e.len,s=i>r?i-r:0;e.pos-=o,e.len+=o+s}}},{key:"insertComment",value:function(e){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact(),n=new L.a;n.special=!0,n.wo_user_id=this.app.userTagId,e.woUserID=this.app.userTagId;var i=this.doc.textStream.getPureTextStream();this.adjustCommentRange(e);var a=this.adjustCommentPlaceholderPos(e);i.insertPlaceholder(a,X.a,n);var o=this.doc.comments.getNextComment({pos:e.pos,len:a-e.pos}),r=this.doc.subdocs[V.Comment],s=o?o.body.begin:r.subdoc_offset+r.subdoc_size-1;i.insertText(s,e.string),i.insertParagraph(s+e.strlen);var l=te({pos:s,len:e.strlen+1}),c=te({body:l,name:e.bkName,author:e.author,date:e.date,done:e.isDone,reply:e.isReply}),u={pos:e.pos,len:a-e.pos+1,data:c};if(this.doc.comments.insertRange(u),e.bkName){var d={pos:s,len:e.strlen+1,data:c},h=!1;if(o){var p=this.doc.bookmarks.getBookMark(o.body.pos,o.body.len);if(p){this.doc.bookmarks.removeRange(p),this.doc.bookmarks.insertRange(d);var f=te({name:p.name}),g={pos:o.body.begin,len:o.body.len,data:f};this.doc.bookmarks.insertRange(g),h=!0}}h||this.doc.bookmarks.insertRange(d)}return e.isMathEdit=this.doc.mathManager.isMathEdit(),this.doc.mathManager.onCmdInsertText(this,a,String.fromCharCode(X.a)),void 0!==e.contents?t.localCommand={name:"insertNewComment",param:e}:t.localCommand={name:"insertComment",param:e},window.g_rpt.endTransact(),!0}},{key:"insertNewComment",value:function(e){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact(),n=new L.a;n.special=!0,n.wo_user_id=this.app.userTagId,e.woUserID=this.app.userTagId;var i=this.doc.textStream.getPureTextStream();this.adjustCommentRange(e);var a=this.adjustCommentPlaceholderPos(e);i.insertPlaceholder(a,X.a,n);var o=this.doc.comments.getNextComment({pos:e.pos,len:a-e.pos}),r=this.doc.subdocs[V.Comment],s=o?o.body.begin:r.subdoc_offset+r.subdoc_size-1;i.insertText(s,e.string),i.insertParagraph(s+e.strlen);var l=te({pos:s,len:e.strlen+1}),c=te({body:l,name:e.bkName,author:e.author,date:e.date,done:e.isDone,reply:e.isReply}),u={pos:e.pos,len:a-e.pos+1,data:c};if(this.doc.comments.insertRange(u),e.bkName){var d={pos:s,len:e.strlen+1,data:c},h=!1;if(o){var p=this.doc.bookmarks.getBookMark(o.body.pos,o.body.len);if(p){this.doc.bookmarks.removeRange(p),this.doc.bookmarks.insertRange(d);var f=te({name:p.name}),g={pos:o.body.begin,len:o.body.len,data:f};this.doc.bookmarks.insertRange(g),h=!0}}h||this.doc.bookmarks.insertRange(d)}return e.isMathEdit=this.doc.mathManager.isMathEdit(),this.doc.mathManager.onCmdInsertText(this,a,String.fromCharCode(X.a)),t.localCommand={name:"insertNewComment",param:e},window.g_rpt.endTransact(),!0}},{key:"modifyNewComment",value:function(e){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact();return e.commentId&&(t.localCommand={name:"modifyNewComment",param:e}),window.g_rpt.endTransact(),!0}},{key:"resetComment",value:function(e){var t=this.getCurrentLocalCommand();!t||"insertComment"!==t.name||t.param._sending?this.deleteComment(e):window.g_rpt.dropLastTransact()}},{key:"deleteComment",value:function(e){var t=this.doc.comments.rangeClass.findNodeEqualRange(e.pos,e.pos+e.len);if(!t)return!1;e.string=this.doc.getText(t.body.pos,t.body.len-1),window.APP.isReadOnlyComment()&&(e.commentId=t.comment_id,e.commentType=t.comment_type),window.g_rpt.beginTransact();var n=window.g_rpt.getCurrentTransact();return this._deleteComment(t),n.localCommand={name:"deleteComment",param:e},window.g_rpt.endTransact(),!0}},{key:"_deleteComment",value:function(e){var t=this.doc.textStream.getPureTextStream();this.doc.comments.removeRange(e);var n=this.doc.bookmarks.getBookmarkByCommentBody(e.body);n&&this.doc.bookmarks.removeRange(n),t.deleteText(e.body.pos,e.body.len),t.deleteText(e.pos+e.len-1,1)}},{key:"modifyComments",value:function(e,t){var n=void 0,i=this.doc.commentBubbles;if(e.bubbleId)n=i.getBubbleById(e.bubbleId);else if(null!=e.commentEnd)n=i.getBubbleByPlaceHolder(e.commentEnd-1);else{var a=void 0,o=this.doc.comments;e.commentId?a=o.getCommentByCommentId(e.commentId):e.rcId&&(a=o.getCommentByRcId(e.rcId)),a&&(n=i.getBubbleByPlaceHolder(a.end-1))}if(!n)return!1;var r={pos:n.end-n.count,len:n.count};if(void 0!==e.done&&(r.done=!!e.done),window.APP.isReadOnlyComment()){var s=n.getCommentByIndex(0);if(!s)return;r.commentId=s.comment_id,r.commentType=s.comment_type}return this.data.api.sendCommandBlock("modifyComments",r,t),!0}},{key:"insertPicture",value:function(e,t){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertPicture",e,t)}},{key:"insertSymbol",value:function(e,t){return e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertSymbol",e,t)}},{key:"insertPicture2",value:function(e,t){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertPicture2",e,t)}},{key:"insertShape",value:function(e,t){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertShape",e,t)}},{key:"changePicture",value:function(e){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("changePicture",e)}},{key:"insertPic4ProcessOn",value:function(e,t){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertPic4ProcessOn",e,t)}},{key:"insertPic4LatexMath",value:function(e,t){return e.bSendSelectionBack=!0,e.woUserID=this.app.userTagId,this.data.api.sendCommandBlock("insertPic4LatexMath",e,t)}},{key:"clearBorder",value:function(e){var t=this.doc.getDataLogic("final"),n=t.getPapx(e);n.good&&n.prop.border_bottom&&this.paraFormatCmdExec.applyBorders(e,0,{border_bottom:{styleType:U.a,style:W.l}}),(n=t.getPapx(e+1)).good&&n.prop.border_top&&this.paraFormatCmdExec.applyBorders(e+1,0,{border_top:{styleType:U.a,style:W.l}})}},{key:"insertSeparator",value:function(e){e.strlen=0;var t=e.pos,n=e.lineStyle,i=e.lineWidth,a=e.color,o=t;e.len>0&&(e.len=0);var r=this.doc.getDataLogic("final"),s=this.doc.getLimitedRange(t),l=r.getPapx(t),c=!1;if(l.pos!==t||0===t)c=!0,t===l.pos+l.len-1&&t!==s.pos+s.len-1&&(c=!1,o+=1);else{var u=r.getPapx(l.pos-1),d=l.prop.border_top,h=u.prop.border_bottom;(d&&d.style&&d.style!==W.l||h&&h.style&&h.style!==W.l)&&(c=!0)}window.g_rpt.beginTransact();var p=window.g_rpt.getCurrentTransact();return c&&(this.doc.textStream.insertParagraph(t),e.strlen=1,o+=1),this._applySeparator(o,n,i,a),p.localCommand={name:"insertSeparator",param:e},window.g_rpt.endTransact(),o}},{key:"_applySeparator",value:function(e,t,n,i){var a=this.doc.getDataLogic("final"),o=!0,r=!0,s=!1,l=a.getPapx(e),c=void 0,u=void 0;0!==l.pos?(0!==(c=a.getPapx(l.pos-1)).pos&&(u=a.getPapx(c.pos-1)).prop.border_top&&u.prop.border_top.style&&u.prop.border_top.style===W.l&&u.prop.border_bottom&&u.prop.border_bottom.style&&u.prop.border_bottom.style!==W.l&&u.prop.border_bottom.style===t&&u.prop.border_bottom.lineWidth===n&&new J.a(u.prop.border_bottom.color).color===new J.a(i).color&&(o=!0,s=!0,r=!0),o&&r&&!s&&c.prop.border_top&&c.prop.border_top.style&&c.prop.border_top.style===W.l&&l.prop.border_bottom&&l.prop.border_bottom.style&&l.prop.border_bottom.style!==W.l&&l.prop.border_bottom.style===t&&l.prop.border_bottom.lineWidth===n&&new J.a(l.prop.border_bottom.color).color===new J.a(i).color&&(o=!1,s=!0,r=!1)):(o=!1,s=!0,r=!0);var d=o?c:l,h=o?u:c,p=o?l:void 0;s&&(this.paraFormatCmdExec.applyBorders(d.pos,0,{border_top:{styleType:U.a,style:t,lineWidth:n,color:i}}),h&&this.paraFormatCmdExec.applyBorders(h.pos,0,{border_bottom:{styleType:U.b,style:W.l}})),r&&(this.paraFormatCmdExec.applyBorders(d.pos,0,{border_bottom:{styleType:U.a,style:t,lineWidth:n,color:i}}),p&&this.paraFormatCmdExec.applyBorders(p.pos,0,{border_top:{styleType:U.b,style:W.l}}))}},{key:"execWordToolCmd",value:function(e){return this.data.api.sendCommandBlock(e.op,e)}},{key:"_getDefaultPapx",value:function(e){var t=e;if(null!==t)return t;t=new L.c;var n=this.doc.stylesheet.findStyle(I.n);if(void 0!==n){var i={id:I.n,name:n.name};t.basestyle=i;var a=this.doc.stylesheet.getStyle(i);void 0!==a.papx&&a.papx.hasAutoNum()&&(t.list_id=-1)}return t}},{key:"clearFormatting",value:function(e){if(e.pos<0)return!1;if(!this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,e.pos))return!1;window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact(),n=null;if(0===e.len){if(!this.doc.textStream.getChpxTbl().fetchInfoContainPos(ne,e.pos))return!1;if(ie.begin===ne.begin&&(ie.end-1===ne.end||ie.end===ne.end)){var i=new L.a;this.doc.textStream.setTextProp({pos:ie.begin,len:ie.end-ie.begin},i,L.j.Cover)}n=this._getDefaultPapx(n),this.doc.textStream.setParaProp({pos:e.pos,len:e.len},n,L.j.Cover)}else{var a=new L.a,o=e.rgs;if(void 0===o)console.log("怎么没传rgs！"),this.doc.textStream.setTextProp({pos:e.pos,len:e.len},a,L.j.Cover),(ie.end<e.pos+e.len||ie.end===e.pos+e.len&&e.pos===ie.begin)&&(n=this._getDefaultPapx(n),this.doc.textStream.setParaProp({pos:e.pos,len:e.len},n,L.j.Cover));else{for(var r=o.length,s=0;s<r;++s){var l=o[s];this.doc.textStream.setTextProp({pos:l.pos,len:l.len},a,L.j.Cover),this.doc.textStream.getPapxTbl().fetchInfoContainPos(ie,l.pos)&&((ie.end<l.pos+l.len||ie.end===l.pos+l.len&&l.pos===ie.begin)&&(n=this._getDefaultPapx(n),this.doc.textStream.setParaProp({pos:l.pos,len:l.len},n,L.j.Cover)))}delete e.rgs}}return t.localCommand={name:"formatOp",param:e},window.g_rpt.endTransact(),!0}},{key:"insertBookmark",value:function(e){window.g_rpt.beginTransact();var t=window.g_rpt.getCurrentTransact(),n=te({name:e.name}),i={pos:e.pos,len:e.len,data:n};return this.doc.bookmarks.insertRange(i),t.localCommand={name:"insertBookmark",param:e},window.g_rpt.endTransact(),!0}},{key:"deleteBookmark",value:function(e,t){return this.deleteBookmarks({names:[e.name]},t)}},{key:"deleteBookmarks",value:function(e,t){return this.data.api.sendCommandBlock("deleteBookmarks",e,t)}},{key:"insertDocumentField",value:function(e,t){return this.data.api.sendCommandBlock("insertDocumentField",e,t)}},{key:"insertDocumentFields",value:function(e,t){return this.data.api.sendCommandBlock("insertDocumentFields",e,t)}},{key:"deleteDocumentField",value:function(e,t){return this.data.api.sendCommandBlock("deleteDocumentField",e,t)}},{key:"deleteDocumentFields",value:function(e,t){return this.data.api.sendCommandBlock("deleteDocumentFields",e,t)}},{key:"allDocumentFieldOp",value:function(e,t){return this.data.api.sendCommandBlock("allDocumentFieldOp",e,t)}},{key:"documentFieldOp",value:function(e,t){return this.data.api.sendCommandBlock("documentFieldOp",e,t)}},{key:"setDocumentFieldValue",value:function(e,t){return this.data.api.sendCommandBlock("setDocumentFieldValue",e,t)}},{key:"insertPageNum",value:function(e){var t=this;return new Promise((function(n){t.data.api.sendCommandBlock(z.default.insertPageNumber,e,n)}))}},{key:"deletePageNum",value:function(e){var t=this;return new Promise((function(n){t.data.api.sendCommandBlock(z.default.deletePageNumber,e,n)}))}},{key:"doWaterMarkOp",value:function(e,t){return this.data.api.sendCommandBlock("doWaterMarkOp",e,t)}},{key:"acceptAllRevisions",value:function(e,t){return this.data.api.sendCommandBlock("acceptAllRevisions",e,t)}},{key:"rejectAllRevisions",value:function(e,t){return this.data.api.sendCommandBlock("rejectAllRevisions",e,t)}},{key:"deleteAllComments",value:function(e,t){var n=this,i=this.doc.comments;if(!i.rangeClass.tree.empty()){if(e&&e.shown)return this.sendCommandBlock({name:"deleteAllComments",param:e},t);var a=[];i.rangeClass.forEachHint((function(e){return a.push(e._node)})),a.sort((function(e,t){return t.end-e.end})),window.g_rpt.beginTransact();var o=window.g_rpt.getCurrentTransact();return a.forEach((function(e){e&&n._deleteComment(e)})),o.localCommand={name:"deleteAllComments",param:{}},window.g_rpt.endTransact(),!0}}},{key:"deleteComments",value:function(e){var t=this,n=e.comments;if(!n||!n.length)return!1;var i=this.doc.comments,a=n.reduce((function(e,t){var n=t.comment_id,a=t.rc_id,o=n?i.getCommentByCommentId(n):i.getCommentByRcId(a);return o&&e.push(o),e}),[]);if(a.sort((function(e,t){return t.end-e.end})),!a.length)return!1;window.g_rpt.beginTransact();var o=window.g_rpt.getCurrentTransact(),r=[];return a.forEach((function(e){var n={pos:e.pos,len:e.len};window.APP.isReadOnlyComment()&&(n.commentId=e.comment_id,n.commentType=e.comment_type),r.push(n),t._deleteComment(e)})),o.localCommand={name:"deleteComments",param:{ranges:r}},window.g_rpt.endTransact(),!0}},{key:"editContentControl",value:function(e){var t=e.pos,n=e.len,i=e.type,a=e.title,o=e.tag,r=e.placeholderText,s=e.entries,l=e.appearance,c=e.lockControl,u=e.lockContent,d=e.isChecked,h=e.multiLine,p=e.displayFormat,f=e.temporary,g=this.doc.contentControls.findControl(t,n);if(!g)return!1;window.g_rpt.beginTransact();var v=window.g_rpt.getCurrentTransact(),y={pos:t,len:n,type:i};switch(void 0!==a&&(y.title=a,g.data.private.title=a),o&&o.length>0&&(y.tag=o,g.data.private.tag=o),r&&r.length&&(y.placeholderText=r,g.data.private.placeholderText=r),void 0!==l&&(y.appearance=l,g.data.private.appearance=l),"boolean"==typeof c&&(y.lockControl=c,g.data.private.lockControl=c),"boolean"==typeof u&&(y.lockContent=u,g.data.private.lockContent=u),"boolean"==typeof f&&(y.temporary=f,g.data.private.temporary=f),i){case Y.DropdownList:case Y.ComboBox:s&&(y.entries=s.length>0?s:[],g.data.private.entries=s);break;case Y.CheckBox:"boolean"==typeof d&&(y.isChecked=d,g.data.private.isChecked=d);break;case Y.PureText:"boolean"==typeof h&&(y.multiLine=h,g.data.private.multiLine=h);break;case Y.Date:p&&(y.displayFormat=p,g.data.private.displayFormat=p)}return v.localCommand={name:"editContentControl",param:y},window.g_rpt.endTransact(),!0}},{key:"insertInks",value:function(e,t){this.data.api.sendCommandBlock("insertInks",e,t)}},{key:"deleteInk",value:function(e,t){this.data.api.sendCommandBlock("deleteInk",e,t)}},{key:"deleteAllInks",value:function(e,t){this.data.api.sendCommandBlock("deleteAllInks",e,t)}},{key:"setReviewFilter",value:function(e,t){this.data.api.sendCommandBlock("setReviewFilter",e,t)}},{key:"insertTableOfContents",value:function(e,t){return!(e.pos<0)&&(!!this.data.api.isConnected()&&this.data.api.sendCommandBlock("insertTableOfContents",e,t))}},{key:"removeTableOfContents",value:function(e,t){return!(e.pos<0)&&(!!this.data.api.isConnected()&&this.data.api.sendCommandBlock("removeTableOfContents",e,t))}},{key:"updateTableOfContents",value:function(e,t){return!(e.pos<0)&&(!!this.data.api.isConnected()&&this.data.api.sendCommandBlock("updateTableOfContents",e,t))}},{key:"modifyTableOfContents",value:function(e,t){return!(e.pos<0)&&(!!this.data.api.isConnected()&&this.data.api.sendCommandBlock("modifyTableOfContents",e,t))}},{key:"insertFootnote",value:function(e,t){return this.data.api.sendCommandBlock("insertFootnote",e,t)}},{key:"insertEndnote",value:function(e,t){return this.data.api.sendCommandBlock("insertEndnote",e,t)}},{key:"setFootnotesSettings",value:function(e,t){return this.data.api.sendCommandBlock("setFootnotesSettings",e,t)}},{key:"setEndnotesSettings",value:function(e,t){return this.data.api.sendCommandBlock("setEndnotesSettings",e,t)}},{key:"dragTable",value:function(e,t){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("dragTable",e,t)}},{key:"moveTableOfRowOrCol",value:function(e,t){if(b.isMobile);else if(this.data.api.isConnected())return this.data.api.sendCommandBlock("moveTableOfRowOrCol",e,t)}}]),e}(),oe=n(3480),re=n(5300),se=n(3037),le=n(2495),ce=n(908),ue=n(1092),de=function(){function e(t,n){u()(this,e),this.processOnData=new Map,this.data=n,this.doc=n.doc,this.selection=n.selection,this.shapeManager=n.shapeManager,this.docCmdExec=t}return h()(e,[{key:"delete",value:function(){var e={pos:this.selection.getNormalRange().pos,len:1,bSendSelectionBack:!0},t={name:"deletePicture",param:e};this.docCmdExec.exec(t)&&this.selection._dispatch("onUILOperationTriggered",e.pos,null,{isEditing:!0})}},{key:"insert",value:function(e,t,n){var i,a=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((i=l()(regeneratorRuntime.mark((function i(r,s){var l,c,u,d,h,p,f;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(p=function(e){r(),"function"==typeof n&&n(e),$.default.dispatchEvent($.default.shape.AFTER_IMAGE_INSERT,e)},e){i.next=5;break}return console.error("uploadIds undefined"),s(),i.abrupt("return");case 5:if(!a.selection.inOMath&&!a.selection.hasOMath){i.next=9;break}return window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.notSupportMoveToMath", "Formulas do not support inserting pictures, controls, or other content.")),s(),i.abrupt("return");case 9:if(t.info.width&&t.info.height){i.next=14;break}return i.next=12,Object(se.getImageSize)(t.url);case 12:l=i.sent,Object.assign(t.info,l);case 14:a.shapeManager.addPicCache(e,t),c=a.selection.getNormalRange(),u=c.pos,d=c.len,o&&(u=o.pos,d=o.len),(h=a.selection.selShapes)&&(h.length>1||!h[0].isEmbedShape)&&(d=0),f={name:"insertPicture",param:{pos:u,len:d,mimeDataID:e},cb:p},a.docCmdExec.exec(f)||s();case 24:case"end":return i.stop()}}),i,a)}))),function(e,t){return i.apply(this,arguments)}))}},{key:"insert2",value:function(e,t,n,i){var a,o=this;return new Promise((a=l()(regeneratorRuntime.mark((function a(r,s){var l,c,u,d,h,p,f,g,v,y,m,_,x;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(_=function(e){r(),"function"==typeof i&&i(e)},e){a.next=5;break}return console.error("uploadIds undefined"),s(),a.abrupt("return");case 5:return l=n.linkToFile,c=n.saveWithDocument,u=n.left,d=n.top,h=n.width,p=n.height,a.next=9,Object(se.getImageSize)(t);case 9:f=a.sent,h||(h=parseInt(Object(N.Px2Pt)(f.width))),p||(p=parseInt(Object(N.Px2Pt)(f.height))),g=o.selection.getNormalRange(),v=g.pos,y=g.len,m={mimeDataID:e,linkToFile:l,saveWithDocument:c,left:u,top:d,width:h,height:p,pos:v,len:y},o.shapeManager.addPicCache(e,{url:t,info:f}),x={name:"insertPicture2",param:m,cb:_},o.docCmdExec.exec(x)||s();case 19:case"end":return a.stop()}}),a,o)}))),function(e,t){return a.apply(this,arguments)}))}},{key:"insertPic4ProcessOn",value:function(e,t){var n=this,i=e.mimeDataID,a=e.img,o=e.category,r=e.definition,s=e.fileId,l=e.title,c=e.type;if(i){oe.write(i,a,(function(e,t,n){e||console.log("[LOCAL-FORAGE] Store Succeed : ",n)}));var u=Object.assign({},e);delete u.img,this.processOnData.set(s,{category:o,definition:r,fileId:s,title:l,type:c});var d={name:"insertPic4ProcessOn",param:u,cb:function(e){console.log("📌[ProcessOn] "+s+" updated",e.success),e.success||n.processOnData.set(s,null)}};console.log("📌[ProcessOn] "+s+" updating"),this.docCmdExec.exec(d)}else console.error("uploadIds undefined")}},{key:"insertPic4LatexMath",value:function(e){var t,n,i,a,o,r,s=e.svgData,l=e.height,c=e.width,u=this.shapeManager,d=window.APP.data.selection.activeShape;if(d){var h=(n=(t=d).rect,i={x:1,y:1},a=n.width-Object(N.Ti2Pt)(t.anchor.effectExtentLeft+t.anchor.effectExtentRight),o=n.height-Object(N.Ti2Pt)(t.anchor.effectExtentTop+t.anchor.effectExtentBottom),(r=t.anchor.shapeData).picture&&r.picture.blip&&r.picture.blip.blipAtom&&(i.x=Math.round(a)/r.picture.blip.blipAtom.imageWidth,i.y=Math.round(o)/r.picture.blip.blipAtom.imageHeight),i);if(e.width=c*h.x,e.height=l*h.y,void 0!==d.wrap_mode&&(e.wrapType=d.wrap_mode),3===e.wrapType&&void 0!==d.is_behind_text&&(d.is_behind_text?e.zOrder=5:e.zOrder=4),d.isExclusive){var p=this.selection.selInfo.getSpacing();e.fontSpacing=p}}else delete e.height,delete e.width;var f=Date.now().toString();u.addPicCache(f,{info:{height:l,width:c},url:"data:image/svg+xml;base64,"+window.btoa(Object(re.utf16ToUtf8)(s))}),e.mimeDataID=f;var g={name:"insertPic4LatexMath",param:e,cb:function(e){}};this.docCmdExec.exec(g)}},{key:"getProcessOnData",value:function(e){var t=this,n=e.shapeId,i=e.shapeTreeType,a=e.fileId;return a?this.processOnData.has(a)?Promise.resolve(this.processOnData.get(a)):window.APP.api.isConnected()?new Promise((function(e){console.log("📌[ProcessOn] query "+a),window.APP.data.api.queryCommandQueue("processData",{shapeTreeType:i,shapeId:n,preventMerge:!0},(function(o){var r=o.success,s=o.result;r&&Object.keys(s).length>0?(s.fileId!==a&&console.error("📌[ProcessOn] "+i+"-"+n+" id unmatch: "+s.fileId+" != "+a),console.log("📌[ProcessOn] resp",s),e(s),t.processOnData.set(a,s)):(t.processOnData.set(a,null),e(null))}))})):Promise.resolve(null):Promise.resolve(null)}},{key:"change",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;if(e){var o=this.shapeManager,r=o.getShapeFromMap(n,i);r.orgSha1="",o.addPicCache(e,t,{shapeTreeType:n,shapeId:i});var s={mimeDataID:e,shapeTreeType:n,shapeId:i};a&&(s.width=a.width,s.height=a.height,s.before=a.before,s.after=a.after);var l={name:"changePicture",param:s};this.docCmdExec.exec(l)}else console.error("uploadIds undefined")}},{key:"allowMove",value:function(e,t){if(!this.doc.isPalaceMuseumTemplate)return!0;for(var n=this.doc.contentControls.collect(e,t),i=0;i<n.length;++i)if("picture"===n[i].title)return!1;return!0}},{key:"allowMoveTo",value:function(e,t){var n=this.doc.getSubDocType(t);if(n===V.Footnote||n===V.Endnote){var i=this.doc.inlineAnchors.findAnchor(e);return!!i&&i.shapeData.picture}return!0}},{key:"move",value:function(e,t,n){var i=e,a=void 0!==t?t:this.selection.getNormalRange().pos;if(this.selection.inOMath||this.selection.hasOMath)window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.notSupportMoveToMath", "Formulas do not support inserting pictures, controls, or other content."));else{if(a!==i&&this.allowMove(a,1)&&this.allowMoveTo(a,i)){var o={name:"movePicture",param:{pos:a,len:1,to_pos:i,isWebshape:n}};if(!this.docCmdExec.exec(o))return;i>a&&--i}this.selection._dispatch("onUILOperationTriggered",i,i,{isEditing:!0})}}},{key:"moveShape",value:function(e,t,n,i,a,o){return new Promise((function(r,s){if(0===i&&0===a)return s();var l={pos:e,len:1,shapeId:t,shapeTreeType:n,xOffset:parseInt(i),yOffset:parseInt(a)};o&&(l.shapeIdxPath=o);var c={name:"moveShape",param:l,cb:r};window.APP.editor.cmdExecutor.exec(c)||s("Error: command blocking!")}))}},{key:"resizeShape",value:function(e){return new Promise((function(t,n){var i={pos:e.pos,len:1,shapeId:e.shapeId,shapeTreeType:e.shapeTreeType,xOffset:parseInt(Object(N.Px2Ti)(e.xOffset)),yOffset:parseInt(Object(N.Px2Ti)(e.yOffset)),width:parseInt(Object(N.Px2Ti)(e.width)),height:parseInt(Object(N.Px2Ti)(e.height))};e.shapeIdxPath&&(i.shapeIdxPath=e.shapeIdxPath),void 0!==e.horizontalFlipped&&(i.horizontalFlipped=e.horizontalFlipped),void 0!==e.verticalFlipped&&(i.verticalFlipped=e.verticalFlipped);var a={name:"resizeShape",param:i,cb:t};window.APP.editor.cmdExecutor.exec(a)||n("Error: command blocking!")}))}},{key:"setShapeWrapFormat",value:function(e,t){var n=this;return new Promise((function(i,a){var o=t.pos,r=t.shapeId,s={pos:o,len:1,shapeId:r,shapeTreeType:t.shapeTreeType,wrapType:e};n.docCmdExec.exec({name:"setShapeWrapFormat",param:s,cb:i})?window.APP.data.shapeManager.addDelayRenderShapeId(r):a("Error: command blocking!")}))}},{key:"setShapeZOrder",value:function(e,t){var n=this;return new Promise((function(i,a){var o={pos:t.pos,len:1,shapeId:t.shapeId,shapeTreeType:t.shapeTreeType,zOrder:e};n.docCmdExec.exec({name:"setShapeZOrder",param:o,cb:i})||a("Error: command blocking!")}))}},{key:"getPreInsertShapeData",value:function(){return this.perInsertShapeData||this.perInsertTextboxData}},{key:"insertShape",value:function(e){var t=e.data;this.perInsertShapeData=t,delete this.perInsertTextboxData,$.default.dispatchEvent($.default.shape.ON_SHAPE_PRE_INSERT)}},{key:"insertTextBox",value:function(e){var t=e.data;this.perInsertTextboxData=t,delete this.perInsertShapeData,$.default.dispatchEvent($.default.shape.ON_SHAPE_PRE_INSERT)}},{key:"cancleInsertShape",value:function(){delete this.perInsertTextboxData,delete this.perInsertShapeData}},{key:"commitShape",value:function(e){var t=this,n=e.data,i=void 0,a=n.x,o=n.y,r=n.width,s=n.height,l=n.props,c=le.a.hit(this.data,{x:a,y:o},this.data.typoinfo,{limitInSubdocType:V.MainText});if(!c||!c.line)return delete this.perInsertTextboxData,delete this.perInsertShapeData,new Promise((function(e,t){t("Error: commitShape")}));var u=c.line;u.isSubLine&&(u=u.parent);var d=u.parent;if(!u.is_para_first){for(var h=d.lines,p=h.indexOf(u);p>0&&!(u=h[--p]).is_para_first;);u=h[p]}var f=u.range.pos,g=void 0,v=void 0,y=d.textflow,m=u.viewPage.outer_rect;if("T2B"===y.corX)v=o-m.top-d.rect.top-u.rect.left,g=y.isReverseLine?a-m.left-d.rect.left-u.rect.top:a-m.left-d.rect.left-d.rect.width+u.rect.top;else if("B2T"===y.corX)v=o-m.top-d.rect.top-d.rect.height+u.rect.left,g=a-m.left-d.rect.left-u.rect.top;else{var _=ce.a.getPosition2view(u),x=_.x,w=_.y;g=a-x-m.left,v=o-w-m.top}return this.perInsertShapeData?i=new Promise((function(e,n){var i=t.perInsertShapeData,a=i.groupId,o=i.index,c={pos:f,len:0,group:a,item:o,xRealOffset:Math.round(Object(N.Px2Ti)(g)),yRealOffset:Math.round(Object(N.Px2Ti)(v))};(r&&r>1||s&&s>1)&&(c.width=Math.round(Object(N.Px2Ti)(r)),c.height=Math.round(Object(N.Px2Ti)(s))),0!==a&&(c.addTextFrame=!0),l&&(c.props=l);var u={name:"insertShape",param:c,cb:e};window.APP.editor.cmdExecutor.exec(u)||n("Error: command blocking!")})):this.perInsertTextboxData&&(i=new Promise((function(e,n){var i=t.perInsertTextboxData,a=i.groupId,o=i.index,l=i.orientation,c={pos:f,len:0,group:a,item:o,addTextFrame:!0,orientation:l,xRealOffset:Math.round(Object(N.Px2Ti)(g)),yRealOffset:Math.round(Object(N.Px2Ti)(v))};r&&r>1&&s&&s>1&&(c.width=Math.round(Object(N.Px2Ti)(r)),c.height=Math.round(Object(N.Px2Ti)(s)));var u={name:"insertShape",param:c,cb:function(t){e(t);var n=t.success,i=t.textFrame;n&&i&&window.APP.data.selection.setPosition(i.range.pos)}};window.APP.editor.cmdExecutor.exec(u)||n("Error: command blocking!")}))),delete this.perInsertTextboxData,delete this.perInsertShapeData,i}},{key:"_getShapeIdxPath",value:function(e,t){var n=[];return function e(i){var a=i.childs;if(a)for(var o=0,r=a.getLength();o<r;++o){n.push(o);var s=a.at(o);if(s.shapeId===t)return!0;if(s.childs&&e(s))return!0;n.pop()}}(this.doc.layer.getShapeTree(e)),n}},{key:"_getShapesSeq",value:function(){var e=this.selection.selShapes,t=this.doc;return e.map((function(e){for(var n=e.shape_tree_type,i=[],a=t.layer.getShapeTree(n),o=e;o;){var r=o,s=r.parent,l=r.id;s?i.push(s.getShapeIndex(l)):i.push(a.getShapeIndex(l)),o=s}return{shapeTreeType:n,shapeIdxPath:i.reverse()}}))}},{key:"setShapeFill",value:function(e){var t=this;return new Promise((function(n,i){var a={shapesSeq:t._getShapesSeq(),props:{fill:e}};t.docCmdExec.exec({name:"modifyShapeProps",param:a,cb:n})||i("Error: command blocking!")}))}},{key:"setOutline",value:function(e){var t=this;return new Promise((function(n,i){var a={shapesSeq:t._getShapesSeq(),props:{outline:e}};t.docCmdExec.exec({name:"modifyShapeProps",param:a,cb:n})||i("Error: command blocking!")}))}},{key:"setTransformInfo",value:function(e){var t=this;return new Promise((function(n,i){var a={shapesSeq:t._getShapesSeq(),props:{transformInfo:e}};t.docCmdExec.exec({name:"modifyShapeProps",param:a,cb:n})||i("Error: command blocking!")}))}},{key:"setShapeZOrder2",value:function(e){var t=this;return new Promise((function(n,i){var a={shapesSeq:t._getShapesSeq(),props:{zOrder:e}};t.docCmdExec.exec({name:"modifyShapeProps",param:a,cb:n})||i("Error: command blocking!")}))}},{key:"setAdjustHandle",value:function(e){var t=this;return new Promise((function(n,i){var a=t._getShapesSeq(),o=window.APP.data.selection.selShapes[0].shapeData.getShapeGroup()==ue.e.LineGroup?"lineAdjustHandler":"shapeAdjustHandler",r={shapesSeq:a,props:{geometry2D:{adjustValues:e,opType:o}}};t.docCmdExec.exec({name:"modifyShapeProps",param:r,cb:n})||i("Error: command blocking!")}))}},{key:"modifyTextFrameProps",value:function(e){var t=this;return new Promise((function(n,i){var a={shapesSeq:t._getShapesSeq(),props:e};t.docCmdExec.exec({name:"modifyTextFrameProps",param:a,cb:n})||i("Error: command blocking!")}))}},{key:"groupShapes",value:function(){var e=this;return new Promise((function(t,n){var i=e._getShapesSeq();e.docCmdExec.exec({name:"groupShapes",param:{shapesSeq:i},cb:t})||n("Error: command blocking!")}))}},{key:"ungroupShape",value:function(){var e=this;return new Promise((function(t,n){var i={shapesSeq:e._getShapesSeq().map((function(e){return e.shapeIdxPath.length>1&&(e.shapeIdxPath=[e.shapeIdxPath[0]]),e}))};e.docCmdExec.exec({name:"ungroupShape",param:i,cb:t})||n("Error: command blocking!")}))}},{key:"deleteShapes",value:function(){var e=this;return new Promise((function(t,n){var i={shapesSeq:e._getShapesSeq()};e.docCmdExec.exec({name:"deleteShapes",param:i,cb:t})||n("Error: command blocking!")}))}}]),e}(),he=n(30),pe=n.n(he),fe=n(1285),ge=n(760),ve=n(1252),ye=function(){function e(t,n){u()(this,e),this.data=n,this.doc=n.doc,this.selection=n.selection,this.docCmdExec=t}return h()(e,[{key:"_setProp",value:function(e,t){if(!this.selection.selInfo.info.isPapxNonEditable){var n=this.selection.getNormalRange(!0),i={pos:n.pos,len:n.len,opType:e,value:t,rgs:this.selection.getNormalRanges()},a=n.pos+n.len,o=window.APP.formatContentController.getInnerMostControl(a,!0);o&&o.isRepeatItem&&o.pos===a&&i.len--;var r={name:"formatOp",param:i};if(this.docCmdExec.exec(r)){var s=this.selection.getNormalRange(),l=s.pos,c=s.len;this.selection._dispatch("onUILOperationTriggered",l,l+c,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setAlignment",value:function(e){this._setProp(B.Para_Alignment,e)}},{key:"setLineSpacing",value:function(e,t,n){if(!this.selection.selInfo.info.isPapxNonEditable){var i=t;t||0===t||(i=j.c);var a=this.selection.getNormalRange(!0),o={name:"formatOp",param:{pos:a.pos,len:a.len,opType:B.Para_LineSpacing,rule:i,value:e,unit:n,rgs:this.selection.getNormalRanges()}};if(this.docCmdExec.exec(o)){var r=this.selection.getNormalRange(),s=r.pos,l=r.len;this.selection._dispatch("onUILOperationTriggered",s,s+l,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"changeIndent",value:function(e){if(!this.selection.selInfo.info.isPapxNonEditable){var t=this.selection.getNormalRange(!0),n=fe.b.locate(this.data,t.pos,null,this.data.typoinfo);try{n.line.papx.getPropVal("nest_level")>0&&(t=this.selection.getNormalRange())}catch(e){}var i={pos:t.pos,len:t.len,opType:B.Para_ChangeIndent,value:e,rgs:this.selection.getNormalRanges(),isTaskList:this.selection.selInfo.isInTaskList()};if(n&&n.line&&n.line.viewPage)if(b.isMobile)i.mobilePageWidth=Object(N.Px2Ti)(n.line.viewPage.rect.width);else{var a=n.line.parent;a.layoutType===ve.c.TextLine&&(a=a.parent),i.pageWidth=Object(N.Px2Ti)(n.isInTextbox?Math.floor(a.rect.width):a.rect.width)}var o={name:"formatOp",param:i};if(this.docCmdExec.exec(o)){var r=this.selection.getNormalRange(),s=r.pos,l=r.len;this.selection._dispatch("onUILOperationTriggered",s,s+l,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],i=arguments[3];if(!this.selection.selInfo.info.isPapxNonEditable){var a=void 0,o=this.selection.selInfo.getSelectionInfo();n?a=n:(a=this.selection.getNormalRange(!this.selection.selInfo.isInTaskList()),o.isTextboxSelected&&(a=o.textbox));var r={pos:a.pos,len:a.len,opType:B.List_ApplyToRange,value:e,bBullet:t,galleryType:i};if(r.len>0){var s=this.doc.getDataLogic("final"),l=s.getPapx(a.pos);r.pos+r.len===l.pos+l.len&&l.prop.getPropVal("para_type")===K.b?--r.len:o.isPoint&&(r.len=0)}if(r.bSendGlyphTailBack=!0,r.glyphTail=!!this.selection.end.glyphTail,0===e){r.rgs=o.isTextboxSelected?[o.textbox]:this.selection.getNormalRanges();var c={name:"formatOp",param:r};if(!this.docCmdExec.exec(c))return}else{if(!this.data.api.isConnected())return;this.docCmdExec.sendCommandBlock({name:"formatOp",param:r})}var u=this.selection.getNormalRange(),d=u.pos,h=u.len;this.selection._dispatch("onUILOperationTriggered",d,d+h,{isEditing:!0}),this.selection.onCmdExec()}}},{key:"resetTaskList",value:function(){var e=this.selection.selInfo.getList();w.a===e.index&&this.setList(w.b,!0)}},{key:"changeFirstLineIndent",value:function(e){this._setProp(B.Para_ChangeFirstLineIndent,e)}},{key:"removeIndent",value:function(){if(!this.selection.selInfo.info.isPapxNonEditable){var e=this.selection.getNormalRange(!0),t={pos:e.pos,len:e.len,opType:B.Para_RemoveIndent};if(this.doc.getDataLogic("final").getPapx(e.pos).prop.getPropVal("para_type")===K.b){var n=this.selection.getNormalRange();t.pos=n.pos,t.len=n.len}var i={name:"formatOp",param:t};if(this.docCmdExec.exec(i)){var a=this.selection.getNormalRange(),o=a.pos,r=a.len;this.selection._dispatch("onUILOperationTriggered",o,o+r,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setBorders",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments[5];if(this.selection.selInfo.info.isPapxNonEditable)return!1;var r={pos:e,len:t,opType:B.Para_Borders,border:n,borderProp:i,isSeparator:a};o&&(r.oldStyle=o);var s={name:"formatOp",param:r};if(this.docCmdExec.exec(s)){var l=this.selection.getNormalRange();return this.selection._dispatch("onUILOperationTriggered",l.pos,l.pos+l.len,{isEditing:!0}),!0}return!1}},{key:"setReadingOrder",value:function(e){this._setProp(B.Para_ReadingOrder,e)}},{key:"_setIndent",value:function(e,t,n){if(!this.selection.selInfo.info.isPapxNonEditable){var i=this.selection.getNormalRange(!0),a={name:"formatOp",param:{pos:i.pos,len:i.len,opType:e,value:t,unit:n,rgs:this.selection.getNormalRanges()}};if(this.docCmdExec.exec(a)){var o=this.selection.getNormalRange(),r=o.pos,s=o.len;this.selection._dispatch("onUILOperationTriggered",r,r+s,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setLeftIndent",value:function(e,t){var n,i=e,a=this.selection.selInfo._getIndent("first_line_indent_chars","first_line_indent_abs"),o=t;o!==M.UnitType.Unit_ref?!a.isMix&&!a.isRef&&a.val<0&&(i-=(n={},pe()(n,M.UnitType.Unit_inc,a.val/72),pe()(n,M.UnitType.Unit_mm,.3527*a.val),pe()(n,M.UnitType.Unit_cm,.3527*a.val/10),pe()(n,M.UnitType.Unit_pt,a.val),n)[t]):a.val<0&&0==e&&(i=Math.abs(a.val),o=M.UnitType.Unit_pt);this._setIndent(B.Para_LeftIndentAbsAndRef,i,o)}},{key:"setFirstLineIndent",value:function(e,t){var n=this.selection.getNormalRange(!0),i={pos:n.pos,len:n.len,opType:B.Para_FirstLineIndentAbsAndRef,value:e,unit:t,rgs:this.selection.getNormalRanges()},a=this.selection.selInfo.getLeftIndent();a.isMix||a.isRef&&0!==a.val||(i.leftIndentVal=a.val/20);var o={name:"formatOp",param:i};if(this.docCmdExec.exec(o)){var r=this.selection.getNormalRange(),s=r.pos,l=r.len;this.selection._dispatch("onUILOperationTriggered",s,s+l,{isEditing:!0}),this.selection.onCmdExec()}}},{key:"setRightIndent",value:function(e,t){this._setIndent(B.Para_RightIndentAbsAndRef,e,t)}},{key:"_setSpace",value:function(e,t,n,i){if(!this.selection.selInfo.info.isPapxNonEditable){var a=this.selection.getNormalRange(!0),o={name:"formatOp",param:{pos:a.pos,len:a.len,opType:e,value:t,unit:n,isAuto:i,rgs:this.selection.getNormalRanges()}};if(this.docCmdExec.exec(o)){var r=this.selection.getNormalRange(),s=r.pos,l=r.len;this.selection._dispatch("onUILOperationTriggered",s,s+l,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setSpaceBefore",value:function(e,t,n){this._setSpace(B.Para_SpaceBeforeAbsAndRef,e,t,n)}},{key:"setSpaceAfter",value:function(e,t,n){this._setSpace(B.Para_SpaceAfterAbsAndRef,e,t,n)}},{key:"clearParaLayout",value:function(){if(!this.selection.selInfo.info.isPapxNonEditable){var e=this.selection.getNormalRange(!0),t={name:"formatOp",param:{pos:e.pos,len:e.len,opType:B.Para_ClearLayout,rgs:this.selection.getNormalRanges()}};if(this.docCmdExec.exec(t)){var n=this.selection.getNormalRange(),i=n.pos,a=n.len;this.selection._dispatch("onUILOperationTriggered",i,i+a,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setOutlineLevel",value:function(e){if(!this.selection.selInfo.info.isPapxNonEditable){var t=this.selection.getNormalRange(!0),n=Object(ge.filterTab)(Object(ge.filterText)(this.doc.textStream.getText(t.pos,t.len-1),S.isSpecialPlaceholder));n.length>11&&(n=n.substr(0,5)+"..."+n.substr(n.length-5,5));var i={name:"formatOp",param:{pos:t.pos,len:t.len,opType:B.Para_OutlineLevel,value:e,string:n,rgs:this.selection.getNormalRanges()}};if(this.docCmdExec.exec(i)){var a=this.selection.getNormalRange(),o=a.pos,r=a.len;this.selection._dispatch("onUILOperationTriggered",o,o+r,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"setFarEastLineBreakControl",value:function(e){this._setProp(B.Para_FarEastLineBreakControl,e)}},{key:"setWordWrap",value:function(e){this._setProp(B.Para_WordWrap,e)}},{key:"setHangingPunctuation",value:function(e){this._setProp(B.Para_HangingPunctuation,e)}},{key:"setHalfWidthPunctuationOnTopOfLine",value:function(e){this._setProp(B.Para_HalfWidthPunctuationOnTopOfLine,e)}},{key:"setAddSpaceBetweenFarEastAndAlpha",value:function(e){this._setProp(B.Para_AddSpaceBetweenFarEastAndAlpha,e)}},{key:"setAddSpaceBetweenFarEastAndDigit",value:function(e){this._setProp(B.Para_AddSpaceBetweenFarEastAndDigit,e)}},{key:"convertIndentBetweenRefAndAbs",value:function(e,t,n){var i=this.selection.getNormalRange(!0),a=this.doc.defFontSize(),o=this.doc.sections.getSection(i.pos);if(void 0===o)return{val:e,result:!1};var r=o.getSnapMode(),s=o.getGridWidth();(s=a+5*s/1024)<a&&++s;var l=e,c=20*e;if(n){var u=this.doc.getPropsWithSection({pos:i.pos,len:1});if(0===u.length)return{val:e,result:!1};var d=u[0].chpx,h=d.font_size_normal;void 0===h&&(h=d.def.font_size_normal);var p=d.character_scale;void 0===p&&(p=d.def.character_scale);var f=d.spacing;void 0===f&&(f=d.def.spacing);var g=Math.max(parseInt(h*p/100+2*f),0);if(l=t?parseInt(e*g):c/g,0!==e&&7===r){var v=l/s;0!==v?(l%s!=0&&(l>0?++v:--v),l=t?v:v*s):l=t?parseInt(e*s):c/s}else if(0!==e&&3===r){l+=t?parseInt(e*(s-a)):c/(s-a)}}else if(3===r||7===r)l=t?parseInt(e*s):c/s;else if(t){var y=e*a,m=Math.abs(parseInt(100*e)%100),_=75==m||25==m?.5:.4;l=parseInt(y>0?Math.floor(y+_):Math.ceil(y-_))}else l=c/a;return{val:t?l/20:l,result:!0}}},{key:"convertSpaceBetweenRefAndAbs",value:function(e,t){var n=this.selection.getNormalRange(!0),i=this.doc.sections.getSection(n.pos);if(void 0===i)return{val:e,result:!1};var a=i.getGridHeight()||240;return{val:t?e*a/20:20*e/a,result:!0}}}]),e}(),me=n(8),_e=n.n(me),xe=n(1145),we=function(){function e(t,n){u()(this,e),this.data=n,this.doc=n.doc,this.selection=n.selection,this.docCmdExec=t}var t,n;return h()(e,[{key:"_isSingleLineSingePoint",value:function(e){if(!e||e.len>0)return!1;var t=this.doc.textStream.getPapxTbl().findNodeContainPos(e.pos);return!(!t||t.len>1||t.prop.hasAutoNum())}},{key:"_isPointInMath",value:function(e){return!(!e||e.isRangeSelection())&&e.inOMath}},{key:"_setFontPropArgs",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.selection.selInfo.info.isSelectionRangeNonEditable||window.APP.isHighlightMode){var i=void 0,a=n||this.selection.getNormalRange();if(n)i=[n];else if(this._isSingleLineSingePoint(a))a.len++,i=[a];else{var o;if((o=this.selection).updateInsertPointChpx.apply(o,_e()(e))){var r=this.selection.getNormalRange(),s=r.pos,l=r.len;return void this.selection._dispatch("onUILOperationTriggered",s,s+l,{isEditing:!0})}i=this.selection.getNormalRanges()}var c=Object.assign({pos:a.pos,len:a.len,rgs:i},t),u={name:"formatOp",param:c};if(this.docCmdExec.exec(u)){var d=this.selection.getNormalRange(),h=d.pos,p=d.len;this.selection._dispatch("onUILOperationTriggered",h,h+p,{isEditing:!0}),this.selection.onCmdExec()}}}},{key:"_setFontProp",value:function(e,t){this._setFontPropArgs([e,t],{opType:e,value:t})}},{key:"setBold",value:function(e){this._setFontProp(B.Font_Bold,e)}},{key:"setItalic",value:function(e){this._setFontProp(B.Font_Italic,e)}},{key:"setUnderline",value:function(e,t){var n=t?parseInt(t.substring(1),16):void 0;this._isPointInMath(this.selection)?this._setFontPropArgs([B.Font_Underline,e,t],{opType:B.Font_Underline,underlineType:e,underlineColor:n},this.selection.getNormalRange()):this._setFontPropArgs([B.Font_Underline,e,t],{opType:B.Font_Underline,underlineType:e,underlineColor:n})}},{key:"setStrikeThrough",value:function(e){this._setFontProp(B.Font_StrikeThrough,e)}},{key:"setSize",value:function(e){this._setFontProp(B.Font_FontSize,e)}},{key:"setSuperscript",value:function(e){this._setFontProp(B.Font_Superscript,e)}},{key:"setSubscript",value:function(e){this._setFontProp(B.Font_Subscript,e)}},{key:"growUp",value:function(e){this._setFontProp(B.Font_GrowUp,e)}},{key:"setName",value:(n=l()(regeneratorRuntime.mark((function e(t){var n,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.APP.fontServer,e.prev=1,e.next=4,n.prepareEmphasizeFontInfoForSetFamily(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("prepareEmphasizeFontInfoForSetFamily error",e.t0);case 9:i=B.Font_Name,a=t,o=Object(xe.b)(a),this._setFontPropArgs([i,a],{opType:i,value:a,isCJK:o});case 13:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return n.apply(this,arguments)})},{key:"setColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._setFontPropArgs([B.Font_Color,e],{opType:B.Font_Color,value:parseInt(e.substring(1),16),isAuto:t})}},{key:"setHighlightColor",value:function(e,t){var n=void 0;n="#ffffffffff000000"===e?-16777216:parseInt(e.substring(1),16),this._setFontPropArgs([B.Font_HighlightColor,e],{opType:B.Font_HighlightColor,value:n},t)}},{key:"setAllCaps",value:function(e){this._setFontProp(B.Font_AllCaps,Number(e))}},{key:"setSmallCaps",value:function(e){this._setFontProp(B.Font_SmallCaps,Number(e))}},{key:"setDoubleStrikeThrough",value:function(e){this._setFontProp(B.Font_DoubleStrikeThrough,e)}},{key:"setEmphasisMark",value:(t=l()(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.APP.fontServer,e.prev=1,e.next=4,n.prepareEmphasizeFontInfoForSetEmphasisMask(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("prepareEmphasizeFontInfoForSetEmphasisMask error",e.t0);case 9:this._setFontProp(B.Font_EmphasisMark,t);case 10:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return t.apply(this,arguments)})},{key:"setHidden",value:function(e){this._setFontProp(B.Font_Hidden,e)}},{key:"setScaling",value:function(e){this._setFontProp(B.Font_Scaling,parseInt(e))}},{key:"setSpacing",value:function(e){this._setFontProp(B.Font_Spacing,e)}}]),e}(),ke=n(6003),be=n(3427),Te=n(5910),Ce=n(5911),Se=n(4752),Ee=n(6750),Pe=n(4578),Le=n(6751),Ae=n.n(Le),Ie=function(){function e(t,n){u()(this,e),this.docCmdExec=t,this.app=n,this.core=n.data.doc.viewSettings,this.revisionMark=new Ae.a(n)}return h()(e,[{key:"changeRevisionsStatus",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments[2],i=e?Pe.a:Pe.b,a=!!t;this.core.setRevisionsView(i,!0),this.core.setRevisionsShowMarkup(a,!0),this.core.getRevisionsSettingsSyncCoop()&&this.sendCommand("setRevisionSettings",{revisionsView:i,showMark:a},n),this.dispatchEvent($.default.revision.REVISION_SETTINGS_CHANGE,{userId:window.APP.info.userid,revisionsView:i,showMark:a}),this.refresh()}},{key:"changeShowRevisionsFrame",value:function(e,t){this.core.setRevisionsFrameShow(!!e,!0),this.core.getRevisionsSettingsSyncCoop()&&this.sendCommand("setRevisionSettings",{showRevisionsFrame:!!e},t),this.dispatchEvent($.default.revision.REVISION_SETTINGS_CHANGE,{userId:window.APP.info.userid,showRevisionsFrame:!!e})}},{key:"switchSyncCoopRevisionsSettings",value:function(e,t){var n=!!e;this.core.setRevisionsSettingsSyncCoop(n);var i={syncCoopRevisionsSettings:n};n&&(i.revisionsView=this.core.getRevisionsView(),i.showMark=this.core.getRevisionsShowMarkup(),i.showRevisionsFrame=this.core.getRevisionsFrameShow()),this.sendCommand("setRevisionSettings",i,t)}},{key:"doSetRevisionSettings",value:function(e){if(void 0!==e.syncCoopRevisionsSettings&&this.core.setRevisionsSettingsSyncCoop(!!e.syncCoopRevisionsSettings),void 0!==e.revisionsView){var t=e.revisionsView?Pe.b:Pe.a;this.core.setRevisionsView(t,!1)}void 0!==e.showMark&&this.core.setRevisionsShowMarkup(!!e.showMark,!1),void 0===e.revisionsView&&void 0===e.showMark||this.refresh(),void 0!==e.showRevisionsFrame&&this.core.setRevisionsFrameShow(!!e.showRevisionsFrame,!1),this.dispatchEvent($.default.revision.REVISION_SETTINGS_CHANGE,e)}},{key:"refresh",value:function(){if(this.app.isPaginationMode())return this.app.workspace.refreshForcedly();window.APP.workspace.resize();var e=this.app.data.selection;e._dispatch("onUILOperationTriggered",e.begin,null,{isEditing:!0}),e.onCmdExec(),this.app.workspace.refreshForcedly()}},{key:"dispatchEvent",value:function(e,t){$.default.dispatchEvent(e,t)}},{key:"sendCommand",value:function(e,t,n){this.app.api.isConnected()?this.docCmdExec.sendCommandBlock({name:e,param:t},n):this.docCmdExec.sendCommandQueue({name:e,param:t})}},{key:"setRevisionsView",value:function(e,t){if(this.app.data.doc.useCoreTypo)return console.error("The file is in core typo mode and can't be modified with revision view settings!"),!1;var n=!e,i=this.core.getRevisionsShowMarkup();return this.changeRevisionsStatus(n,i,t)}},{key:"setRevisionsMode",value:function(e,t){return this.app.data.doc.useCoreTypo?(console.error("The file is in core typo mode and can't be modified with revision view settings!"),!1):(this.core.setRevisionsMode(e,!0),this.refresh(),t&&t({success:!0}),!0)}},{key:"setShowRevisionsAndComments",value:function(e,t){var n=this.core.isRevisionsFinalView();return this.changeRevisionsStatus(n,e,t)}},{key:"setIsShowRevisionBtn",value:function(e){this.app.workspace.revisionComment.isShowRevisionBtn!==e&&(this.app.workspace.revisionComment.isShowRevisionBtn=e,$.default.dispatchEvent($.default.revision.REVISION_BTN_DISPLAY_CHANGE))}},{key:"setReviewFilter",value:function(e,t){if(e.startDate||e.endDate){if(!e.startDate){var n=new Date(0);e.startDate={year:n.getFullYear(),month:n.getMonth()+1,date:n.getDate()}}if(!e.endDate){var i=new Date;e.endDate={year:i.getFullYear(),month:i.getMonth()+1,date:i.getDate()}}}return this.sendCommand("setReviewFilter",e,t)}},{key:"setDisplayDocumentFields",value:function(e){this.core.setDisplayDocumentFields(e),this.app.workspace.refreshForcedly()}},{key:"setReadonlyProtectionExceptionsBackgroundVisible",value:function(e){this.core.setReadonlyProtectionExceptionsBackgroundVisible(e),this.app.workspace.refreshForcedly()}}]),e}(),Re=n(486),Oe=n(2682),Me=n(1238);function De(e,t){return function(n,i,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments[4],s=i.api,l=i.selection;if(s.isConnected()&&!s.hasBlocking()){var c=a||l.getNormalRange(),u={pos:c.pos,len:c.len,name:e};Object.keys(o).forEach((function(e){u[e]=o[e]}));var d=function(e){var n=e[t];n&&n.bodyRange&&(l.setPosition(n.bodyRange.pos),Object(Me.typoToPositionWithLoading)(n.bodyRange.pos).then((function(){window.APP.workspace.makesureCursorVisible(!0)}))),r&&r(e)},h={name:e,param:u,cb:d};n.cmdExecutor.exec(h)}}}function Ne(e){return function(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments[4],r=n.api,s=n.selection;if(r.isConnected()&&!r.hasBlocking()){var l=i||s.getNormalRange(),c={pos:l.pos,len:l.len,name:e};Object.keys(a).forEach((function(e){c[e]=a[e]}));var u={name:e,param:c,cb:o};t.cmdExecutor.exec(u)}}}var Be=De("insertFootnote","footnote"),je=De("insertEndnote","endnote"),Fe=Ne("setFootnotesSettings"),He=Ne("setEndnotesSettings"),Ge=n(1699),Ue=n(2849),We=function(){function e(t,n){u()(this,e),this.data=n,this.doc=n.doc,this.selection=n.selection}return h()(e,[{key:"getFill",value:function(){var e=this.selection.selShapes,t=e&&e[0],n=t&&t.shapeProperty,i={type:ue.a.FillTypeNone},a=n&&n.fill;if(!a&&t.isGroup){for(var o=t;o.isGroup;)o=o.childShapes[0];a=(n=o.shapeProperty)&&n.fill}if(a&&(i.type=a.type,a.color)){var r=Object(Ue.c)(a.color.toRGB);if(i.hex=r.hex,i.trans=r.trans,a.color.transOp){var s=a.color.transOp[0];0===s.op&&(i.trans=100-Math.round(100*s.val))}}return i}},{key:"setFill",value:function(e){var t=e.type,n=e.hex,i=e.trans,a=e.opType,o={toRGB:Object(Ue.b)(n,i)};window.APP.editor.picture.setShapeFill({type:t,color:o,opType:a})}},{key:"setTrans",value:function(e){window.APP.editor.picture.setShapeFill({opacity:(100-e)/100,opType:"opacity"})}},{key:"setTransForPreview",value:function(e){var t=[],n=window.APP.data.selection.selShapes;n&&n.forEach((function(e){return function e(n){if(n.isGroup)n.childShapes.forEach((function(t){e(t)}));else if(n.isPresetDrawing){var i=n.shapeData;i.getShapeGroup()===ue.e.LineGroup||i.isInk()||t.push(n)}}(e)}));var i=window.createCanvas2Svg({width:0,height:0,ctx:Object(Ge.getMeasureCTX)()}),a=window.APP.drawingTools;t.forEach((function(t){try{for(var n=t.renderInfo.presetDrawingSvg,o=n.childNodes,r=o.length-1;r>=0;r--)o[r]&&n.removeChild(o[r]);var s=i.enterChildCtxByNode(n),l=function(e){for(var t=e.rotation,n=e.parent;n;){var i=n.rotation;0!==i&&(t+=i),n=n.parent}return t}(t),c=t.drawingLayout.layoutRect;0!==l&&t.shapeData.private.isRotateText&&t.hasEnterTextbox()&&s.rotate(-l/180*Math.PI,c.width/2,c.height/2);var u=t.drawingLayout,d=u.extendList.measureShapeBody.fill.color,h=Object(Ue.a)(d.toRGB),p=h.r,f=h.g,g=h.b,v=d.rgba;d.rgba="rgba("+p+", "+f+", "+g+", "+(100-e)/100+")",a.render(s,a.createShape(t.shapeData),u),d.rgba=v,console.info("Preview set trans")}catch(e){console.error("Preview set trans error:",e)}}))}}]),e}(),Ye=function(){function e(t,n){u()(this,e),this.defaultInfo={hex:"#41719c",width:1},this.getLineType=function(e,t){var n=ue.c.OTHER;switch(e){case 0:switch(t){case 0:n=ue.c.SINGLE;break;case 2:n=ue.c.SHORT_DASH;break;case 4:n=ue.c.DASH_DOT;break;case 8:n=ue.c.ROUND_DOT;break;default:n=ue.c.OTHER}break;case 1:switch(t){case 0:n=ue.c.DOUBLE;break;case 8:n=ue.c.DOUBLE_DOT;break;default:n=ue.c.OTHER}break;case 2:0===t&&(n=ue.c.THICK_THIN);break;case 3:0===t&&(n=ue.c.THIN_THICK);break;case 4:0===t&&(n=ue.c.THIN_THICK_THIN);break;default:n=ue.c.SINGLE}return n},this.data=n,this.doc=n.doc,this.selection=n.selection}return h()(e,[{key:"getOutline",value:function(){var e=this.selection.selShapes,t=e&&e[0];if(!t)return{fill:{type:ue.a.FillTypeNone},isInk:!1};var n=t&&t.shapeProperty,i=t&&t.shapeData,a=n&&n.outline;if(!a&&t.isGroup){for(var o=t;o.isGroup;)o=o.childShapes[0];a=(n=o.shapeProperty)&&n.outline,i=o&&o.shapeData}var r=this.getFill(a&&a.fill);if(r.type===ue.a.FillTypeNone)return{fill:r,isInk:!1};var s=a&&this.getLineType(a.compoundLine,a.dashType)||ue.c.SINGLE,l=a&&a.width?a.width/12700:1;return l=l>100?100:l,{fill:r,lineType:s,width:Number(l.toFixed(2)),isInk:!1,headEnd:a&&a.headEnd||{type:0},tailEnd:a&&a.tailEnd||{type:0},isSupportEndType:this.isSupportEndType(i)}}},{key:"getFill",value:function(e){var t={type:ue.a.FillTypeNone};if(e&&(t.type=e.type,e.color)){var n=Object(Ue.c)(e.color.toRGB);if(t.hex=n.hex,t.trans=n.trans,e.color.transOp){var i=e.color.transOp[0];0===i.op&&(t.trans=100-Math.round(100*i.val))}}return t}},{key:"isSupportEndType",value:function(e){if(!e||!e.getGeometry2D())return!1;var t=Number(e.getShapeGroup())===ue.e.LineGroup,n=e.getGeometry2D(),i=n.isCustomGeometry()&&!n.isClosedCurve();if(t||i)return!0;var a=Number(e.getPresetShapeType());return a>=88&&a<94||a>=104&&a<=115}},{key:"getStashInfo",value:function(){}},{key:"cloneData",value:function(){return{}}},{key:"setType",value:function(e){var t=this.cloneData();t.fill?t.fill.type=e:t.fill={type:e,color:{toRGB:"#FF41719C"}},t.opType="outline",window.APP.editor.picture.setOutline(t)}},{key:"setColor",value:function(e){var t=this.cloneData();t.fill||(t.fill={type:ue.a.FillTypeSolidColor});var n=t.fill.color?t.fill.color.toRGB.substring(1,3):"FF";t.fill.color={toRGB:"#"+n+e.substring(1)},t.opType="rgb",window.APP.editor.picture.setOutline(t)}},{key:"setLineType",value:function(e){var t=this.cloneData();switch(e){case ue.c.SINGLE:t.compoundLine=0,t.dashType=0;break;case ue.c.DOUBLE:t.compoundLine=1,t.dashType=0;break;case ue.c.THIN_THICK:t.compoundLine=3,t.dashType=0;break;case ue.c.THICK_THIN:t.compoundLine=2,t.dashType=0;break;case ue.c.THIN_THICK_THIN:t.compoundLine=4,t.dashType=0;break;case ue.c.ROUND_DOT:t.compoundLine=0,t.dashType=8;break;case ue.c.SHORT_DASH:t.compoundLine=0,t.dashType=2;break;case ue.c.DASH_DOT:t.compoundLine=0,t.dashType=4;break;case ue.c.DOUBLE_DOT:t.compoundLine=1,t.dashType=8}t.opType="lineType",window.APP.editor.picture.setOutline(t)}},{key:"setHeadEnd",value:function(e){var t=this.cloneData();t.headEnd=e,t.opType="headEnd",window.APP.editor.picture.setOutline(t)}},{key:"setTailEnd",value:function(e){var t=this.cloneData();t.tailEnd=e,t.opType="tailEnd",window.APP.editor.picture.setOutline(t)}},{key:"setTrans",value:function(e){var t=this.cloneData();t.fill||(t.fill={type:ue.a.FillTypeSolidColor});var n=this.getOutline();t.fill.color={toRGB:Object(Ue.b)(n.fill.hex,e)},t.opType="opacity",window.APP.editor.picture.setOutline(t)}},{key:"setTransForPreview",value:function(e){var t=[],n=window.APP.data.selection.selShapes;n&&n.forEach((function(e){return function e(n){n.isGroup?n.childShapes.forEach((function(t){e(t)})):n.isPresetDrawing&&t.push(n)}(e)}));var i=window.createCanvas2Svg({width:0,height:0,ctx:Object(Ge.getMeasureCTX)()}),a=window.APP.drawingTools;t.forEach((function(t){try{for(var n=t.renderInfo.presetDrawingSvg,o=n.childNodes,r=o.length-1;r>=0;r--)o[r]&&n.removeChild(o[r]);var s=i.enterChildCtxByNode(n),l=function(e){for(var t=e.rotation,n=e.parent;n;){var i=n.rotation;0!==i&&(t+=i),n=n.parent}return t}(t),c=t.drawingLayout.layoutRect;0!==l&&t.shapeData.private.isRotateText&&t.hasEnterTextbox()&&s.rotate(-l/180*Math.PI,c.width/2,c.height/2);var u=t.drawingLayout,d=u.extendList.measureShapeBody.outline.fill.color,h=Object(Ue.a)(d.toRGB),p=h.r,f=h.g,g=h.b,v=d.rgba;d.rgba="rgba("+p+", "+f+", "+g+", "+(100-e)/100+")",a.render(s,a.createShape(t.shapeData),u),d.rgba=v,console.info("Preview set trans")}catch(e){console.error("Preview set trans error:",e)}}))}},{key:"setWidth",value:function(e){var t=this.cloneData();t.width=Math.round(12700*e),t.opType="width",window.APP.editor.picture.setOutline(t)}}]),e}(),ze=n(1643);var Xe=function(e){function t(e,n){u()(this,t);var i=f()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.isAllowInsert=ke.i.bind(null,i.data),i.insertText=ke.h.bind(null,i.app,i,i.data),i.insertParagraph=ke.e.bind(null,i.app,i,i.data),i.deleteText=ke.b.bind(null,i.app,i,i.data),i.preDeleteText=ke.k.bind(null,i.app,i,i.data),i.findContent=ke.c.bind(null,i,i.data),i.cancelFindContent=ke.a.bind(null,i,i.data),i.replaceContent=ke.l.bind(null,i,i.data),i.insertSymbol=ke.f.bind(null,i.app,i,i.data),i.isDeleteCrossNotesBody=ke.j.bind(null,i.data),i.move2Outermost=be.s.bind(null,i.data.doc),i.insertColumnLeft=be.j.bind(null,i,i.data),i.insertColumnRight=be.k.bind(null,i,i.data),i.insertRowAbove=be.l.bind(null,i,i.data),i.insertRowBelow=be.m.bind(null,i,i.data),i.insertTable=be.n.bind(null,i,i.data),i.deleteColumn=be.g.bind(null,i,i.data),i.deleteRow=be.h.bind(null,i,i.data),i.deleteTable=be.i.bind(null,i,i.data),i.addContentControl=Te.a.bind(null,i.app,i,i.data),i.addRepeatSecItem=Te.b.bind(null,i,i.data),i.deleteContentControl=Te.c.bind(null,i,i.data),i.moveContent=Te.f.bind(null,i.app,i,i.data),i.setControlTitle=Te.i.bind(null,i,i.data),i.setControlTag=Te.h.bind(null,i,i.data),i.editContentControl=Te.d.bind(null,i,i.data),i.selectDropdownListEntry=Te.g.bind(null,i.app,i,i.data),i.selectHyperlink=Se.selectHyperlink.bind(null,i.data),i.navigateByHyperlink=Se.navigateByHyperlink.bind(null,i.app,i.data),i.deleteHyperlink=Se.deleteHyperlink.bind(null,i,i.data),i.editHyperlink=Se.editHyperlink.bind(null,i,i.data),i.switchToWebshape=Se.switchToWebshape.bind(null,i,i.data),i.navigateByWebshape=Ee.navigateByWebshape.bind(),i.editWebshape=Ee.editWebshape.bind(null,i,i.data),i.insertWebshape=Ee.insertWebshape.bind(null,i,i.data),i.switchTolink=Ee.switchTolink.bind(null,i,i.data),i.copyWebshapeLink=Ee.copyWebshapeLink.bind(null,i),i.isInReadonlyDocumentField=Ce.g.bind(null,i.data),i.insertDocumentField=Ce.e.bind(null,i,i.data),i.insertDocumentFields=Ce.f.bind(null,i,i.data),i.documentFieldOp=Ce.d.bind(null,i,i.data),i.allDocumentFieldOp=Ce.a.bind(null,i,i.data),i.setDocumentFieldValue=Ce.i.bind(null,i,i.data),i.deleteDocumentField=Ce.b.bind(null,i,i.data),i.deleteEmptyDocumentField=Ce.c.bind(null,i,i.data),i.insertFootnote=Be.bind(null,i,i.data),i.insertEndnote=je.bind(null,i,i.data),i.setFootnotesSettings=Fe.bind(null,i,i.data),i.setEndnotesSettings=He.bind(null,i,i.data),i.cmdExecutor=new ae(i.app,i.data),i.picture=new de(i.cmdExecutor,i.data),i.paraFormat=new ye(i.cmdExecutor,i.data),i.font=new we(i.cmdExecutor,i.data),i.shapeFill=new We(i.cmdExecutor,i.data),i.shapeOutline=new Ye(i.cmdExecutor,i.data),i.viewSettings=new Ie(i.cmdExecutor,i.app),i}var n,i;return v()(t,e),h()(t,[{key:"closeLastTransact",value:function(){this.cmdExecutor.closeLastTransact()}},{key:"undo",value:function(e){var t=this;this.closeLastTransact(),b.isPad||b.isAndroid&&window.__CONFIG__.wps.mobile.isEnableInternationalComposition?setTimeout((function(){t.uilManager.undoRedoHandler.undo()}),60):this.uilManager.undoRedoHandler.undo(),window.report(E.TYPE.COUNT,!0===e?"wps_undo_sck":"wps_undo",1)}},{key:"redo",value:function(e){this.uilManager.undoRedoHandler.redo()}},{key:"_getWppClipboardId",value:function(e){var t=e&&e.match(/ ksdocclipboardid=".*" /gi);if(t&&t.length>0)for(var n=0;n<t.length;n++){var i=t[n],a=i.indexOf(' ksdocclipboardid="');if(a>=0){var o=i.slice(a+' ksdocclipboardid="'.length);return a=o.indexOf('"'),o.slice(0,a)}}}},{key:"serverPaste",value:function(e){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var t=this.selection.getNormalRange();if(e.pos=t.pos,e.len=t.len,this.selection.inOMath||this.selection.hasOMath)window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.mathNotSupportCopy", "Formulas do not support copy, cut, or paste."));else{this.state.pasteParam=e||{};var n=e&&(e.serverHtml||e.html||e.extHtml)&&!!e.string;this.state.pasteParam.allowSmartPaste=e&&!!(e.internal||e.serverCore||e.ksDocClipboardId||n),console.log("serverPaste",e),e.woUserID=this.app.userTagId,this.cmdExecutor.sendCommandBlock({name:"paste",param:e})&&(T.default.dispatchEvent(T.default.names.edit.COPY_PASTE_LOADING,{tip:_i18n("applications.writer.components.core.event.uil.handlers.pasteLoadingTip", "Pasting...")}),this.selection.onCmdExec())}}else this.state.reportPaste=void 0}},{key:"pasteHtml",value:function(e,t){var n=this;return!this.data.api.isConnected()||this.data.api.hasBlocking()?Promise.reject("service unavailable"):e?new Promise((function(i,a){var o={pos:t.pos,len:t.len,woUserID:n.app.userTagId,html:e};n.cmdExecutor.sendCommandBlock({name:"paste",param:o},(function(e){e.success?i():a("service copy fail")}))&&n.selection.onCmdExec()})):Promise.reject("invalid data")}},{key:"smartPaste",value:function(e){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var t=this.state.pasteArea&&this.state.pasteArea.getRange();if(t&&t.len){var n=this.state.pasteParam;if(n&&n.allowSmartPaste){for(var i in n)e[i]=n[i];e.pos=t.pos,e.len=t.len,e.woUserID=this.app.userTagId,console.log("smartPaste",e),this.cmdExecutor.sendCommandBlock({name:"smartPaste",param:e})&&this.selection.onCmdExec()}}}}},{key:"reportPaste",value:function(e){if(this.state.reportPaste){var t=this.state.reportPaste;t.begin>0&&0===e.error&&t.cmd===e.cmdName&&window.report(E.TYPE.DURATION,"wps_pastetime",Date.now()-t.begin),this.state.reportPaste=void 0}}},{key:"copy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1],n=e;if(!n){var i=window.WPSOpenApi.__HOOKS__,a=i&&i.KeyboardEventCopy;n=a&&a.Action}if(this.app.canCopy())if(void 0===t){this.app.formatContentController.adjustCopyOrCutRange();var o=this.selection.getNormalRange();if(o.len<=0)n&&n({error:"invalid range"});else if(this.selection.inOMath||this.selection.hasOMath)window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.mathNotSupportCopy", "Formulas do not support copy, cut, or paste."));else if(this.selection.selContext.isInComment())this.app.copyControl()||this.uilManager.clipboardHandler.localCopy(Object(C.getPureText)(this.data,S.isInvalidPlaceholderInComment,[o]));else{if(o.len>5e5)return n&&n({error:"range over limit"}),void window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.copyContentLimit", "The length of the copied content exceeds the browser limit, please copy in batches"));this.uilManager.clipboardHandler.notifyCopy(!0,n,o),!this.app.isReadOnly()&&b.isIE&&this.app.focusInput()}}else try{this.uilManager.clipboardHandler.localCopy(t),window.Toast.success(_i18n("applications.writer.components.core.event.uil.handlers.successCopy", "Copy success"))}catch(e){window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.copyLinkFail", "Failed to copy link"))}else{if(n&&n({error:"can not copy"}),!window.__CONFIG__.isShowNoPermissionComponent)return;var r=window.fileInfo&&window.fileInfo.user_acl||{},s=r.copy;s&&Re.canRequestForAuthForSecurityDoc&&Object(Re.isCopyLimitedSecurityDoc)()?Object(Re.requestForAuth)({type:Re.AUTH_TYPES.COPY}):window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.cannotCopyOrCut", "You do not have permission for this operation, please contact the owner to modify the permission"))}}},{key:"getHtmlData",value:function(e){var t=this;return this.app.canCopy()?!e||e.len<=0?Promise.reject("invalid range"):new Promise((function(n,i){var a=t.uilManager.clipboardHandler.collectShapeInfos({pos:e.pos,len:e.len}),o=a.ready,r=a.address4Src;if(o){var s=r.map((function(e){return{src:e.src,cp:e.cp}}));t.data.api.queryCommandBlock("getHtmlData",{pos:e.pos,len:e.len,address4Src:s},(function(e){!e||e.error?i("error"):(t.uilManager.clipboardHandler.shapeCopy.update(),n({text:e.result.mineData.text,html:e.result.mineData.html}))}))}else window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.copyNonReady", "The selected content has not finished loading. Please copy later."))})):Promise.reject("permission denied")}},{key:"filterPureTextForPaste",value:function(e){return e.replace(/\x01|\x08/g,"")}},{key:"cut",value:function(){var e=window.fileInfo&&window.fileInfo.user_acl||{},t=e.copy,n=e.update;if(this.app.canCopy()){if(!this.selection.selInfo.info.isSelectionRangeNonEditable)if(this.app.isReadOnly())n&&Re.canRequestForAuthForSecurityDoc&&Object(Re.isEditLimitedSecurityDoc)()&&Object(Re.requestForAuth)({type:Re.AUTH_TYPES.EDIT});else{this.app.formatContentController.adjustCopyOrCutRange();var i=this.selection.getNormalRange();if(!(i.len<=0)){if(!this.selection.inOMath&&!this.selection.hasOMath)return this.selection.selContext.isInComment()?(this.uilManager.clipboardHandler.localCopy(Object(C.getPureText)(this.data,S.isInvalidPlaceholderInComment,[i])),void this.deleteText(!0)):void(i.len>5e5?window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.cutContentLimit", "The length of the cut content exceeds the browser limit, please cut in batches")):this.uilManager.clipboardHandler.notifyCopy(!1,null,i));window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.mathNotSupportCopy", "Formulas do not support copy, cut, or paste."))}}}else{if(!window.__CONFIG__.isShowNoPermissionComponent)return;t&&Re.canRequestForAuthForSecurityDoc&&Object(Re.isCopyLimitedSecurityDoc)()?Object(Re.requestForAuth)({type:Re.AUTH_TYPES.COPY}):window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.cannotCopyOrCut", "You do not have permission for this operation, please contact the owner to modify the permission"))}}},{key:"activePaste",value:(i=l()(regeneratorRuntime.mark((function e(){var t,n,i,a,o,r,s,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDeleteCrossNotesBody()){e.next=2;break}return e.abrupt("return");case 2:return this.state.reportPaste={begin:Date.now(),cmd:"paste"},t=this.uilManager.clipboardHandler,e.next=6,t.getClipboardData();case 6:if(n=e.sent,console.log("📌[kDocsPaste] ",n),!this.app.copyControl()){e.next=16;break}if(!n.id){e.next=16;break}return i={},e.next=13,t.getClipboardInfo();case 13:return a=e.sent,this.addClipboardIdForPaste(i,n,a),e.abrupt("return",this.serverPaste(i));case 16:if(o=n&&n.text,r=n&&n.html,!(s=n&&n.info)||!s.id){e.next=24;break}return l={},o&&(l.string=o),this.addClipboardIdForPaste(l,n,s),e.abrupt("return",this.serverPaste(l));case 24:if(o||r){e.next=27;break}return b.isPad?window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.systemNotAllowPaste", "Due to system limitations, copy and paste operations are allowed only within the same document.")):window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.cannotPaste", "You need to copy the content first and then paste it")),e.abrupt("return");case 27:if(r){e.next=31;break}return c=this.filterPureTextForPaste(o),this.state.reportPaste.cmd="insertText",e.abrupt("return",this.insertText(c,{cleanCopyData:!0,replace:!0,isPaste:!0}));case 31:return u={string:o,noPara:!this.hasPara(r,o)},n.id===t.state.id?(u.internal=!0,u.serverHtml=r):u.html=r,e.abrupt("return",this.serverPaste(u));case 34:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"addClipboardIdForPaste",value:function(e,t,n){var i=function(e){var t=[Oe.MIME_TYPES.WPS9,Oe.MIME_TYPES.OO_GVML,Oe.MIME_TYPES.KS_SHAPE,Oe.MIME_TYPES.OO_SHAPE,Oe.MIME_TYPES.HTML,Oe.MIME_TYPES.PNG,Oe.MIME_TYPES.TEXT],n=new Map([]),i=[],a=e.priorityFormat,o=void 0;return a&&(o=t.find((function(e){return-1!=a.indexOf(e)}))),o&&(i.push(o),n.has(o)&&(i=i.concat(n.get(o)))),i}(n);e.ksDocClipboardId=n.id,e.priorityFormat=i[0],e.from=n.from;var a=t.html;a&&"string"==typeof a&&a.length>0&&(e.extHtml=a),e.extArgs=[{type:"ksDocClipboard",data:{ksDocClipboardId:n.id,hasHtml:"false",priorityFormats:i}}]}},{key:"copyFormat",value:function(){if(this.app.canCopy()){this.state.copiedFormat=!0;var e=this.selection.getNormalRange(),t={pos:e.pos,len:e.len};this.data.api.queryCommandQueue("copyFormat",t)}else{if(!window.__CONFIG__.isShowNoPermissionComponent)return;window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.cannotCopyOrCut", "You do not have permission for this operation, please contact the owner to modify the permission"))}}},{key:"pasteFormat",value:function(){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;if(!b.isMobile||this.state.formats){var e=this.selection.getNormalRange(),t={pos:e.pos,len:e.len};return t.formats=this.state.formats,this.cmdExecutor.sendCommandBlock({name:"formatPainter",param:t}),!0}window.Toast.info(_i18n("applications.writer.components.core.event.uil.handlers.cannotPasteFormat", "You need to copy the format first and then paste"))}},{key:"hasPara",value:function(e,t){return!(!t||!t.match(/\n/g))||!!(t&&e&&e.match(/<p /g)&&e.match(/<o:p>/g))}},{key:"align_handler",value:function(e){if(this.selection.selInfo.getAlignment()==={left:1,right:3,horiz:2,decentralized:5}[e])this.paraFormat.setAlignment(m.Adjustify);else{var t={left:m.Left,right:m.Right,horiz:m.Center,decentralized:m.FullAdjustify};this.paraFormat.setAlignment(t[e])}}},{key:"align_left",value:function(){this.align_handler("left")}},{key:"align_horiz",value:function(){this.align_handler("horiz")}},{key:"align_right",value:function(){this.align_handler("right")}},{key:"align_decentralized",value:function(){this.align_handler("decentralized")}},{key:"align_both",value:function(){this.paraFormat.setAlignment(m.Adjustify)}},{key:"reduce_indentation",value:function(){this.paraFormat.changeIndent(!0)}},{key:"increase_indentation",value:function(){this.paraFormat.changeIndent(!1)}},{key:"font_size_add",value:function(){var e=this.font;this.selection.selInfo.getSize()>=32760?window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.fontLimit", "Please specify a font size between {0} and {1}").replace("{0}",1).replace("{1}",1638)):e.growUp(!0)}},{key:"font_size_minus",value:function(){var e=this.font;this.selection.selInfo.getSize()<=20?window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.fontLimit", "Please specify a font size between {0} and {1}").replace("{0}",1).replace("{1}",1638)):e.growUp(!1)}},{key:"bold",value:function(){this.font.setBold(!this.selection.selInfo.getBold())}},{key:"italic",value:function(){this.font.setItalic(!this.selection.selInfo.getItalic())}},{key:"underline",value:function(){var e=this.selection.selInfo.getUnderline(),t=e&&e.underlineType?_.wpsUnderlineNone:_.wpsUnderlineSingle;this.font.setUnderline(t)}},{key:"del_line",value:function(){this.font.setStrikeThrough(!this.selection.selInfo.getStrikeThrough())}},{key:"bullets",value:function(e){if(void 0!==e)this.paraFormat.setList(e,!0),e>0&&(this.state.usrConfig.bullet=e);else{var t=this.selection.selInfo.getListType()===x.a,n=this.state.usrConfig.bullet,i=void 0===n?1:n;this.paraFormat.setList(t?0:i,!0)}}},{key:"numbering",value:function(e,t){if(void 0!==e)this.paraFormat.setList(e,!1,null,t),e>0&&(this.state.usrConfig={galleryType:t,numbering:e});else{var n=this.selection.selInfo.getListType()===x.c,i=this.state.usrConfig,a=i.numbering,o=void 0===a?3:a,r=i.galleryType;this.paraFormat.setList(n?0:o,!1,null,r)}}},{key:"tasklist",value:function(){var e=this.selection.selInfo.getListType()===x.d;this.paraFormat.setList(e?0:w.b,!0)}},{key:"getEncodingName",value:function(e){for(var t in k.a){var n=k.a[t];if(n.code===e)return n.name}for(var i in k.b){var a=k.b[i].subItems;for(var o in a)if(a[o].code===e)return a[o].name}return null}},{key:"setTextEncoding",value:function(e){var t={name:"setTextEncoding",param:{src:this.getEncodingName(this.data.doc.docInfo.openEncoding),dest:this.getEncodingName(e)}};this.cmdExecutor.sendCommandBlock(t),this.data.api.send("document.reloadas",{encoding:e})}},{key:"setDocProps",value:function(e,t){if(!this.data.api.isConnected()||this.data.api.hasBlocking())return!1;var n={props:Array.from(e,(function(e){var t=void 0,n=e.name,i=e.val;switch(!0){case"string"==typeof i:t="s";break;case"boolean"==typeof i:t="b";break;case"number"==typeof i&&Number.isInteger(i):t="i";break;case"number"==typeof i&&!Number.isNaN(i)&&!Number.isIntegern(i):t="f";break;default:t="s"}return{name:n,type:t,val:i}}))};return this.cmdExecutor.sendCommandBlock({name:"setDocProps",param:n},t)}},{key:"insertBookmark",value:function(e,t,n){if(this.data.api.isConnected()&&!this.data.api.hasBlocking()){var i=t||this.selection.getNormalRange(),a={name:"insertBookmark",param:{pos:i.pos,len:i.len,name:e},cb:n};this.cmdExecutor.exec(a)}}},{key:"deleteBookmark",value:function(e,t){return!(!this.data.api.isConnected()||this.data.api.hasBlocking())&&this.cmdExecutor.exec({name:"deleteBookmark",param:e,cb:t})}},{key:"updatePlcHdrSync",value:function(e,t,n){if(!(e<0)){var i={name:"updateCtrlPlcHdrSync",param:{pos:e,len:t,string:n}};this.cmdExecutor.exec(i)}}},{key:"acceptAllRevisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.cmdExecutor.exec({name:"acceptAllRevisions",param:{format:!!e,shown:!!t}})}},{key:"rejectAllRevisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.cmdExecutor.exec({name:"rejectAllRevisions",param:{format:!!e,shown:!!t}})}},{key:"revisionOp",value:function(e,t,n){var i=this.data.doc.revisions.getRevisionWithType(e.pos,t);return!!i&&this.cmdExecutor.sendCommandBlock({name:"revisionOp",param:{pos:i.pos,len:i.len,revisionType:i.revisionType,accept:!!n,string:i.content}})}},{key:"deleteAllComments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return this.cmdExecutor.exec({name:"deleteAllComments",param:{shown:!!e},cb:t})}},{key:"addComment",value:(n=l()(regeneratorRuntime.mark((function e(t,n,i,a){var o,r,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.length,r=Date.now(),s=window.APP.info.username,e.next=5,this.app.servicesLoader.commentsDataManager.commitComment({});case 5:return l=e.sent,e.abrupt("return",this.cmdExecutor.exec({name:"insertComment",param:{pos:t,len:n,string:i,strlen:o,date:r,author:s,submit:!!a,bkName:Object(ze.encodeBkName)(l.comment_id,1)}}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,i,a){return n.apply(this,arguments)})},{key:"deleteComment",value:function(e,t){var n=this.data.doc.comments.getComment(e);return!!n&&this.cmdExecutor.exec({name:"deleteComment",param:{pos:n.pos,len:n.len}})}},{key:"getReviewersInfo",value:function(){var e=this;return new Promise((function(t,n){e.data.api.queryCommandQueue("reviewers",null,(function(e){e.error?n():t(e.result.reviewers)}))}))}},{key:"modifyComments",value:function(e,t){return this.cmdExecutor.exec({name:"modifyComments",param:e,cb:t})}},{key:"getCommentUserInfo",value:function(e){return this.data.api.queryCommandQueue("getCommentUserInfo",e)}},{key:"insertKWProtocolHyperlinks",value:function(e,t){var n=this,i=e.map((function(e){return{address:n.createKWProtocolAddress(e.params),textToDisplay:e.text}}));i.length>0&&this.insertHyperlinks(i,t,{underlineType:_.wpsUnderlineNone,underlineColor:"#000"})}},{key:"createKWProtocolAddress",value:function(e){var t=e.classes,n=e.appid,i=r()(e,["classes","appid"]),a="kw:"+t+"?appid="+n;for(var o in i)a+="&"+o+"="+i[o];return a}},{key:"insertHyperlinks",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t||this.selection.getActiveAreaNormalRanges(),o=i.length,r=i[0];r.pos>i[o-1].pos&&(r=i[o-1]);var s=a()({pos:r.pos,len:r.len,links:e},Object(ke.d)(this.app,this.data.selection)),l=a()({},this.state.ipChpx||{},n);Object.keys(l).length>0&&(s.ipChpx=l),this.cmdExecutor.exec({name:"insertNHyperlink",param:s})&&(this.selection._dispatch("onUILOperationTriggered",r.pos,null,{isEditing:!0}),this.selection.onCmdExec())}},{key:"initialState",get:function(){return{usrConfig:{}}}}]),t}(y.a);t.a=Xe},7131:function(e,t,n){"use strict";var i,a=n(13),o=n.n(a),r=n(80),s=n.n(r),l=n(144),c=n.n(l),u=n(8),d=n.n(u),h=n(1),p=n.n(h),f=n(22),g=n.n(f),v=n(145),y=n.n(v),m=n(2),_=n.n(m),x=n(23),w=n.n(x),k=n(874),b=n(342),T=n(2020),C=n(664),S=n(627),E=n(663),P=n(677),L=n(1806),A=n(812),I=n(1477),R=n(554),O=n(698),M=n(324),D=function(){function e(t,n){p()(this,e),this.selection=t,this.document=n,this.isInitialized=!1,this.invalidChars=[M.g,M.f,M.j,M.l,M.m,M.k,M.i,M.q,M.a,M.d,M.e,M.n,M.p,M.o],this.selection.attachObserver(this),this.document.attachObserver(this),this.range=null,Object(R.default)(this)}return _()(e,[{key:"destroy",value:function(){this.range=null,this.document.detachObserver(this),this.selection.detachObserver(this)}},{key:"getRange",value:function(){return this.range}},{key:"isTextValid",value:function(){var e=this;if(!this.range&&this.isInitialized)return!1;var t=this.document.getText(this.range.pos,this.range.len);return!Array.from(t).some((function(t){return-1!==e.invalidChars.indexOf(t.charCodeAt(0))}))}},{key:"getText",value:function(){return this.range?Object(O.getPureTextExcludeSpecialPlaceholder)(this.selection.data,[{pos:this.range.pos,len:this.range.len}]):""}},{key:"isOutOfRange",value:function(e){var t=this.range,n=t.pos,i=t.len;return!(e>n&&e<=n+i)}},{key:"onInsertText",value:function(e,t,n){if(this.range)switch(!0){case t<=this.range.pos:this.range.pos+=n.length;break;case t>this.range.pos&&t<=this.range.pos+this.range.len:this.range.len+=n.length}else{var i=n.indexOf("@");-1!==i&&(this.isInitialized=!0,this.range={pos:t+i,len:n.length-i})}}},{key:"onDeleteText",value:function(e,t,n){if(this.range)switch(!0){case t<=this.range.pos&&t+n.length>this.range.pos:this.range=null;break;case t+n.length<=this.range.pos:this.range.pos-=n.length;break;case t>this.range.pos&&t<this.range.pos+this.range.len:this.range.len-=Math.min(this.range.pos+this.range.len-t,n.length)}}},{key:"onSelectionChanged",value:function(e,t){if(!(t&&t.isEditing&&t.updateOnly)&&this.range){var n=this.selection.end.position;this.isOutOfRange(n)&&(this.destroy(),this._dispatch("onDestroyAtArea"))}}},{key:"onUILOperationTriggered",value:function(e,t,n,i){!this.isInitialized||this.range&&-1!==this.getText().indexOf("@")||(this.destroy(),this._dispatch("onDestroyAtArea"))}}]),e}(),N=n(227),B=n(260),j=n(1285),F=n(2657),H=n(309),G=n(665),U=n(167),W="DocumentWithMark",Y="Document",z="Workspace",X="ScaleContainer",V="EditArea",q=function(e){function t(e){p()(this,t);var n=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));K.call(n);var i=e.pluginName;return n.pluginName=i,n.containerName=i+"_container",n.currentLayoutType="",n.noMarkLayoutType="",n.addContainer({containerName:n.containerName}),n}return w()(t,e),t}(G.default),K=function(){var e=this;this.addContainer=function(t){var n=t.containerName,i=t.detail,a=void 0===i?{}:i,o=a.pluginName,r=void 0===o?"":o,s=a.type,l=void 0===s?"":s,c=r?r+"_container":n,u=document.getElementById(c);u&&u.remove();var d=document.createElement("DIV");switch(d.id=c,d.className="plugin_container",d.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: 100;"),e.currentLayoutType===W&&l!==e.currentLayoutType&&(l=e.noMarkLayoutType),U.isMobile&&(l=V),!0){case l===z:var h=document.querySelector("#workspace");h&&(h.appendChild(d),e.currentLayoutType=e.noMarkLayoutType=z);break;case!l||l===X:var p=document.querySelector(".scale");p&&(p.appendChild(d),e.currentLayoutType=e.noMarkLayoutType=X);break;case l===Y:document.body.appendChild(d),e.currentLayoutType=e.noMarkLayoutType=Y;break;case l===V:var f=document.querySelector(".edit-area");if(f){d.setAttribute("style","position: absolute; left: 0px; bottom: 0px; width: 100%; z-index: 10000;");var g=document.createElement("DIV");g.className="pluginContainer",g.appendChild(d),f.appendChild(g),e.currentLayoutType=e.noMarkLayoutType=V}break;default:var v=document.createElement("DIV");v.id=c+"_wrapper",v.setAttribute("style","position: fixed; background: rgba(0,0,0,0.1);top: 0px;bottom: 0px;left: 0px;right: 0px;z-index: 1000"),document.body.appendChild(d),document.getElementById(c).appendChild(v),e.currentLayoutType=W}},this.toggleContainer=function(t){var n=t.containerName,i=t.detail,a=void 0===i?{}:i,o=a.type,r=void 0===o?"":o,s=a.pluginName,l=void 0===s?"":s;if(r===e.currentLayoutType)return!1;var c=l?l+"_container":n,u=document.querySelector("#"+c);if(u)switch(!0){case r===z:var d=document.querySelector("#workspace");return!(!d||u.parentElement===d)&&(d.appendChild(u),e.currentLayoutType=e.noMarkLayoutType=z,!0);case!r||r===X:var h=document.querySelector(".scale");return!(!h||u.parentElement===h)&&(h.appendChild(u),e.currentLayoutType=e.noMarkLayoutType=X,!0);case r===Y:return document.body.appendChild(u),e.currentLayoutType=e.noMarkLayoutType=Y,!0;default:return!1}return!1}},Q=q,J=n(624),Z=n(822),$=n(2698),ee=n(1917),te=n(30),ne=n.n(te),ie=n(1290),ae=(i={},ne()(i,ie.NODETYPE.PICTURE,ie.getPictures),ne()(i,ie.NODETYPE.MENTION,ie.getMentions),i);function oe(e){var t=window.APP.data,n=t.doc,i=t.selection.getNormalRange().pos,a=n.getDataLogic("final").getPapx(i);return re({pos:a.pos,len:a.len},e)}function re(e,t){return Object(ie.handleTypes)(ae,e,t).map((function(e){return le(e)}))}function se(e){var t=null;if(e){var n=window.APP.data.doc.comments.getCommentByCommentId(e);t={pos:n.pos,len:n.len}}else t=window.APP.workspace.revisionComment.dataHandler.getCurrentCommentRange();return t?re(t):[]}function le(e){var t={};switch(e._nType){case ie.NODETYPE.PICTURE:t={type:ie.NODETYPE.TEXT,text:"["+_i18n("applications.writer.components.CommandBars.RbTab.Home.InsertPicture.insertPicture", "Picture")+"]"};break;case ie.NODETYPE.MENTION:var n=o()({},e.attrs);n.extraAttrs&&(n.extraAttrs=decodeURIComponent(window.atob(n.extraAttrs))),t={type:ie.NODETYPE.MENTION,text:e.text,attrs:n};break;case ie.NODETYPE.TEXT:t={type:ie.NODETYPE.TEXT,text:e.text}}return t}function ce(e){var t=Object.keys(ae),n=[];return e.forEach((function(e){var i=o()({},e);i._nType=i.type,delete i.type,t.includes(i._nType)||(i._nType=ie.NODETYPE.TEXT);var a=le(i),r=n[0];r&&r.type===ie.NODETYPE.TEXT&&a.type===ie.NODETYPE.TEXT?r.text=r.text+a.text:n.unshift(a)})),n.reverse()}var ue=n(1170),de=n(313),he=n(5341),pe=n(358),fe=n(3937),ge="all",ve="contact",ye="docs",me=function(e){function t(e,n,i){p()(this,t);var a=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return a.getPluginPos=function(){var e=document.querySelector("#root .edit-area"),t=e.scrollLeft,n=t+e.offsetWidth,i=e.scrollTop;return{begin:{offsetX:0,offsetY:0,x:0,y:0},bound:{left:t,right:n,top:i,bottom:i+e.offsetHeight,container:e}}},a.throttleUpdatePluginPosition=window.utils.Lodash.throttle(a.updateAtAreaPosition,300),a.throttleUpdateAtAreaText=window.utils.Lodash.throttle(a.updateAtAreaText,300),a.updatePluginInitialConfig(),a.app.isAtPluginHandled||a.locate(),a.data.doc.fields.attachObserver(a),a.data.doc.attachObserver(a),a.selection.attachObserver(a),a.app.viewUIL.isAppReady&&a.loadAtPlugin(),a}var n,i,a,r,l,u,h;return w()(t,e),_()(t,null,[{key:"getConcernEvents",value:function(){return t.events}}]),_()(t,[{key:"clearAll",value:function(){this.state.atRangeQueryTimeoutID&&clearTimeout(this.state.atRangeQueryTimeoutID),this.clearAtArea(),y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.data.doc.detachObserver(this),this.data.doc.fields.detachObserver(this),this.selection.detachObserver(this),J.default.unsubscribe(b.PLUGIN_TYPE.AT)}},{key:"loadAtPlugin",value:function(){var e=this;if(!this.state.isLoadingPlugin){this.state.isLoadingPlugin=!0;var t=window.__WPSPLUGIN__.loader,n={pluginType:b.PLUGIN_TYPE.AT};this.state.pluginConfig=t.search(n),t.load(n).then((function(t){e.state.pluginConfig&&(e.layout=new Q(e.state.pluginConfig),new t({layout:e.layout}).plugin.then((function(t){t.init(e.state.pluginInitialConfigs),e.atPlugin=t})))}))}}},{key:"updatePluginInitialConfig",value:function(){this.manager.updatePluginInitialConfigs(b.PLUGIN_TYPE.AT,this.state.pluginInitialConfigs)}},{key:"getAtId",value:function(){var e=void 0,t=window.location.search;return-1===t.indexOf("atid")&&(t=window._parent.location.search),-1!==t.indexOf("?")&&t.substring(1).split("&").some((function(t){-1!==t.indexOf("atid")&&(e=t.split("=")[1])})),e}},{key:"makesureRangeToQuery",value:function(e){var t=this,n=this.state.atRangeQueryTimeoutID?300:16;this.state.atRangeQueryTimeoutID=setTimeout((function(){t.app.api.queryRange(e)||t.makesureRangeToQuery(e)}),n)}},{key:"locate",value:function(){var e=this;if(!this.app.isAtPluginHandled&&this.app.isFilePermissionConfirmed){var t,n=this.getAtId();if(n){window.collection("at","action","open_from_at");var i=function(e){return e.map((function(e){return e._node})).filter((function(e){return"HYPERLINK"===e.type})).sort((function(e,t){return e.begin-t.begin}))},a=this.data.doc.getSubDocRange(H.MainText),o=i(this.data.doc.fields.getFields({begin:0,end:a.len})),r=i(this.data.doc.fields.getFields({begin:a.len,end:this.data.doc.getTextSize()})),l=[].concat(d()(r),d()(o));if(!l.length)return void console.error("@定位：找不到跳转目标...");this.state.isLocatingAtArea=!0;var u=this.data.doc.concernRanges,h=c()(u,1)[0];(this.state.atIdLocatePromiseRef.promise=new Promise((function(t,i){l.some((function(a,r){var s=e.data.doc.getSubDocType(a.begin),c=h.pos+h.len;if(s===H.MainText&&a.begin>=c){var u=o[o.length-1];return e.state.atIdLocatePromiseRef.data={atId:n,index:r,lastFieldInMainText:u,fields:l},e.state.atIdLocatePromiseRef.resolve=t,e.state.atIdLocatePromiseRef.reject=i,e.makesureRangeToQuery({gcpCurrent:c,length:u.end-c}),!0}var d=new F.a(e.data,a);if(d.isMentionAddress()&&d.getKWProtocolParams().uuid===n)return t({pos:a.pos,len:a.len}),!0}))||i(!1)}))).then((t=s()(regeneratorRuntime.mark((function t(n){var i,a,o,r,s,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.isLocatingAtArea){t.next=3;break}return e.state.atIdLocatePromiseRef={},t.abrupt("return");case 3:return e.app.isAtPluginHandled=!0,e.state.isLocatingAtArea=!1,e.state.atIdLocatePromiseRef={},i=e.data.doc.getSubDocType(n.pos),a=i===H.HeaderFooter,(o=i===H.Comment)&&e.app.isCommentEnabled&&(e.app.appApi.setLocateCommentId(e.data.doc.commentBodys.getCommentByPos(n.pos).comment_id),e.app.appApi.showComments({checked:!1}),e.app.appApi.setCommentShowStatus({commentBubble:!1,commentPanel:!0}),B.default.dispatchEvent(B.default.taskPane.OPEN_COMMENT_PANEL)),t.next=12,e.workspace.makeContentVisible(n.pos,{isTimeLimited:!1,diffY:e.workspace.element.cacheDOMAttr.clientHeight/3}).promise;case 12:e.app.isReadOnly()||o||e.app.isWebMode()&&a||(a&&(r=e.workspace.getPageCurrent(!0),e.selection.selContext.setHeaderfooterLayoutIndex(r)),s=n.pos+n.len-1,e.selection.setPosition(s,s,{isSend:!0}),e.workspace.focusWithoutScroll()),l={range:n,color:"#FFBD7A"},c={blinkTime:200,intervalTime:600,totalTime:3e3},window.collection("experience",{event:"reading_mention_Jump",times:Math.round(performance.now())}),e.app.setSelectionHightLight(l,c);case 17:case"end":return t.stop()}}),t,e)}))),function(e){return t.apply(this,arguments)})).catch((function(t){e.state.isLocatingAtArea=!1,e.state.atIdLocatePromiseRef={},console.error("@定位：找不到跳转目标...",t)}))}}}},{key:"clearAtArea",value:function(){this.state.atArea&&(this.state.atArea.destroy(),this.state.atArea.detachObserver(this),this.state.atArea=null,this.state.isPluginCreatingAtArea=!1),this.state.atAreaByTap=null,this.state.isPluginClickOnAtArea=!1}},{key:"cancelForwardly",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFocus:!0};this.clearAtArea(),this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,S.MESSAGE.PLUGIN_CANCEL),e.isFocus&&this.workspace.focusWithoutScroll()}},{key:"cancelPassively",value:function(){this.clearAtArea(),this.workspace.focusWithoutScroll()}},{key:"getAtAreaPosition",value:function(e){var t=this.data.typoinfo,n=j.b.locate(this.data,e.pos,!1,t),i=j.b.locate(this.data,e.pos+e.len,!1,t);if(!n||!i)return null;var a={},o=this.workspace,r=o.element.cacheDOMAttr,s=r.rect,l=r.scrollLeft,c=r.scrollTop,u=r.clientWidth,d=r.clientHeight,h=o.config.zoom;if(this.data.doc.getSubDocType(e.pos)===H.Comment){var p=this.workspace.commentContainer,f=p.rect,g=p.scrollTop,v=U.isPad?this.app.appApi.keyboardHeight:0,y=void 0,m=void 0;if(this.app.commentShowStatus.commentBubble)y=f.left+l,m=f.top+c-s.top,a.bound={left:l,right:l+u,top:c,bottom:c+d-v};else{y=f.left,m=f.top;var _=document.body.cacheDOMAttr,x=_.clientWidth,w=_.clientHeight;a.bound={left:0,right:x,top:0,bottom:w-v}}a.begin={x:n.posX+y,y:Math.max(n.posY-g,0)+m,offsetX:n.charWidth||0,offsetY:n.line.rect.height},a.end={x:i.posX+y,y:Math.max(i.posY-g,0)+m,offsetX:i.charWidth||0,offsetY:i.line.rect.height}}else a={begin:{x:n.posX-t.viewOffset.x,y:n.posY-t.viewOffset.y,offsetX:n.charWidth||0,offsetY:n.line.rect.height},end:{x:i.posX-t.viewOffset.x,y:i.posY-t.viewOffset.y,offsetX:i.charWidth||0,offsetY:i.line.rect.height},bound:{left:l/h,right:(l+u)/h,top:c/h,bottom:(c+d)/h}};return a}},{key:"updateAtAreaPosition",value:function(){var e=this,t=this.state,n=t.atArea,i=t.atAreaByTap,a=n?n.getRange():i?{pos:i.field.pos,len:i.field.len}:null;if(a){var r=U.isMobile?this.getPluginPos():this.getAtAreaPosition(a);if(r){var s=void 0;this.state.isPluginCreatingAtArea||this.state.isPluginClickOnAtArea?(s=T.LAYOUT.PLUGIN_SET_CONTAINER_POSITION,this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,s,o()({},r))):this.updatePluginConfig().then((function(){s=T.LAYOUT.PLUGIN_RENDER,e.state.isPluginCreatingAtArea=!0,e.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,s,o()({},r))}))}}}},{key:"updateAtAreaText",value:function(){this.state.atArea&&this.state.atArea.range&&(this.state.atArea.isTextValid()?this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,E.KEYBOARD.PLUGIN_INPUT,{text:this.state.atArea.getText().slice(1),isComposing:this.state.isComposing}):this.cancelForwardly())}},{key:"onInput",value:function(e){if(!this.state.isPluginCreatingAtArea){var t=e.data;if(!t){if(this.app.isEnableComposition()){var n=this.manager.UILs.SELECTION.getModule("KEYBOARD").currentKeyboardEventsHandler;t=n&&n.getInputValue()}t=t||(this.selection.selContext.isInComment()?this.workspace.commentInput.value:this.workspace.input.value)}if("@"===t&&!this.state.atArea){var i=this.selection.selInfo.isHitOnCtrl().isHitOnDatetime,a=this.data.doc.mathManager.isMathEdit();if(i||a)return;var o=this.selection.getNormalRange();this.data.doc.fields.getFields({begin:o.pos,end:o.pos+o.len}).some((function(e){return e.begin<o.pos&&o.pos<e.end||e.begin<o.pos+o.len&&o.pos+o.len<e.end}))||(this.state.atArea=new D(this.selection,this.data.doc),this.state.atArea.attachObserver(this),window.collection("at","action","active_at")),U.isMobile&&this.workspace.input.blur()}}}},{key:"onKeydown",value:function(e){var t=e.keyCode,n=e.ctrlKey,i=e.altKey,a=e.shiftKey,o=e.metaKey;if((this.state.isPluginCreatingAtArea||this.state.isPluginClickOnAtArea)&&t===I.a.ESC)return e.stopPropagation(),e.preventDefault(),this.cancelForwardly(),void(this.state.uilState=P.a.CONTINUE);if(Object(ue.isTempCommentAt)()){var r=this.state.keyboardEventBlockList.some((function(e){return e.keyCode===t&&!!e.ctrlKey===n&&!!e.altKey===i&&!!e.shiftKey===a&&!!e.metaKey===o}));this.state.uilState=r?P.a.DONE:P.a.CONTINUE}else if(this.state.isPluginCreatingAtArea&&this.state.atArea){var s=this.state.keyboardEventBlockList.some((function(e){return e.keyCode===t&&!!e.ctrlKey===n&&!!e.altKey===i&&!!e.shiftKey===a&&!!e.metaKey===o}));this.state.uilState=s?P.a.DONE:P.a.CONTINUE}else this.state.uilState=P.a.CONTINUE}},{key:"onKeyboardEvent",value:function(e){switch(e.type){case"input":this.onInput(e);break;case"compositionstart":this.state.isComposing=!0;break;case"compositionend":this.state.isComposing=!1;break;case"keydown":this.onKeydown(e)}return this.state.uilState}},{key:"onStart",value:function(e){if(this.state.isPluginCreatingAtArea&&this.state.atArea&&this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,C.MOUSE.PLUGIN_CLICK,{isOutside:this.state.atArea.isOutOfRange(e.position)}),this.state.isPluginClickOnAtArea){var t=e.hyperLink;t&&t.isMentionAddress()||(this.state.isPluginClickOnAtArea=!1,this.state.atAreaByTap=null,this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,C.MOUSE.PLUGIN_CLICK,{isOutside:!0}))}}},{key:"onTap",value:(h=s()(regeneratorRuntime.mark((function e(t){var n,i,a,r,s,l,c,u,d,h,p,f,g,v,y,m,_,x,w,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.hyperLink)){e.next=21;break}if(i=n.getAddress(),a=n.isMentionAddress(i),r=n.isFileLinkAddress(i),!a){e.next=20;break}if(this.state.isPluginClickOnAtArea=!0,s={pos:n.field.pos,len:n.field.len},l=this.getAtAreaPosition(s)||{},this.state.atAreaByTap=n,c={},this.selection.selContext.isInComment()){u=this.selection.getNormalRange(),d=u.pos,h=this.data.doc.commentBodys.getCommentByPos(d),p={};try{f=h.body,g=f.pos,v=f.len,p={pos:g,len:v}}catch(e){y=this.data.doc.getDataLogic("final").getPapx(d),m=y.pos,_=y.len,p={pos:m,len:_}}c.main=re(p),c.quote=se()}else c.main=oe();return e.t0=this.manager,e.t1=b.PLUGIN_TYPE.AT,e.t2=C.MOUSE.PLUGIN_CLICK,e.next=17,this.trasnformParam(o()({data:n.getKWProtocolParams(),isOutside:!1},l,{contents:c}));case 17:e.t3=e.sent,e.t0.postMessageToPlugin.call(e.t0,e.t1,e.t2,e.t3),console.log("发送点击新增的inbox消息:",c);case 20:r&&(x=n.getKWProtocolParams(),w=x.shareLink,(k=Object(fe.getReplacedLink)(w))&&Object(pe.openHyperlink)(k));case 21:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"onGestureEvent",value:function(e,t){switch(e.type){case A.a.START:this.onStart(t);break;case A.a.TAP:this.onTap(t)}return this.state.uilState}},{key:"InEmbAtArea",value:function(e,t){if(t&&t.isEmbHyperLink()){var n=t.getAddress(e.position);if(t.isFileLinkAddress(n))return!0}return!1}},{key:"onMouseEvent",value:function(e,t){if("mousemove"===e.type){var n=t.hyperLink,i=this.state,a=i.isEnterAtArea,r=i.atAreaByHover,s=n&&(n.isMentionAddress()||n.isFileLinkAddress()),l=this.InEmbAtArea(t,n);if(a&&!s)return this.state.isEnterAtArea=!1,void this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,C.MOUSE.PLUGIN_LEAVE);if(s||l){var c={pos:n.field.pos,len:n.field.len},u=n.getAddress();if(a&&r&&u===r.address&&r.pos===c.pos&&r.len===c.len)return;this.state.isEnterAtArea=!0,this.state.atAreaByHover={address:u,pos:c.pos,len:c.len};var d=this.getAtAreaPosition(c)||{};this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,C.MOUSE.PLUGIN_ENTER,o()({data:n.getKWProtocolParams()},d))}}}},{key:"onWindowEvent",value:function(e){var t=this;switch(e.type){case"resize":U.isPad||U.isMobile||(this.throttleResizeHandler||(this.throttleResizeHandler=window.utils.Lodash.throttle((function(){(t.state.isPluginCreatingAtArea||t.state.isPluginClickOnAtArea)&&t.cancelForwardly()}),300)),this.throttleResizeHandler());break;case"orientationchange":(this.state.isPluginCreatingAtArea||this.state.isPluginClickOnAtArea)&&this.cancelForwardly()}return this.state.uilState}},{key:"onPluginActionConfig",value:function(e){var t=e.keyboard,n=void 0===t?[]:t;this.state.keyboardEventBlockList=n}},{key:"onPluginConfirm",value:(u=s()(regeneratorRuntime.mark((function e(t){var n,i,a,r,s,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.__WPSENV__.reduxDispatch,this.state.isPluginCreatingAtArea){e.next=3;break}return e.abrupt("return");case 3:if(window.collection("at","action","at_success"),i=[],a=[],r=t.list.map((function(e){var t=window.btoa(encodeURIComponent(e.extraAttrs)),n=e._type,r=e.fname,s=e.name,l=e.appid,c=e.fid,u=e.shareLink,d=e._from,h=e.uuid,p=e.userid,f={appid:l,_type:n,extraAttrs:t,classes:L.classes[L.ItemConfig[n]]},g={};switch(n){case"file":var v=Object(he.getFileType)(r),y=Object(he.getFileNameDesc)(r);g={params:o()({},f,{fType:v,fid:c,fname:r,shareLink:u,_from:d}),text:"📄"+y};break;case"user":default:g={params:o()({},f,{uuid:h,userid:p}),text:"@"+s+" "},i.push(e),a.push(g)}return g})).splice(0,this.state.pluginInitialConfigs.max),this.state.insertingAtAreas=r,s=this.state.atArea.getRange(),l={},r.forEach((function(e){var t=e.params;if(t&&t.userid){var n=t.userid;l[n]?l[n].push(t):l[n]=[t]}})),!((c=Object.keys(l).map((function(e){return e.toString()}))).length>0)){e.next=17;break}return e.next=15,n(Object(de.getOriginUserIds)(c));case 15:(u=e.sent).error?console.error("getOriginUserIds失败"):u.response.body.forEach((function(e){var t=e.id,n=e.origin_id;l[t]&&l[t].forEach((function(e){return e.userid=Number(n)}))}));case 17:this.manager.editHandler.insertKWProtocolHyperlinks(r,[s]),this.cancelForwardly(),this.selection.selContext.isInComment()||i.length>0&&this.sendNotifyMain({users:i,insertLinks:{hyperlinks:a,range:s}});case 20:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"onPluginCancel",value:function(){this.cancelPassively()}},{key:"onCustomPluginEvent",value:function(e){var t=e.detail,n=t.pluginType,i=t.pluginEvent,a=t.detail;if(n===b.PLUGIN_TYPE.AT){if(i===T.LAYOUT.PLUGIN_CHANGE_CONTAINER_TYPE)return this.layout.addContainer(e.detail),!0;if(this.state.isPluginCreatingAtArea){if(i===S.MESSAGE.PLUGIN_CONFIRM){var o=a.isNot,r=a.isSend;this.state.isNotify=!o&&r}var s=window.APP.workspace.revisionComment.dataHandler.isInComment;if(Object(ue.isInTempComment)()||s)switch(i){case S.MESSAGE.PLUGIN_ACTION_CONFIG:this.onPluginActionConfig(a);break;case S.MESSAGE.PLUGIN_CONFIRM:this.onPluginConfirmByComment(a);break;case S.MESSAGE.PLUGIN_CANCEL:this.onPluginCancelByComment()}else switch(i){case S.MESSAGE.PLUGIN_ACTION_CONFIG:this.onPluginActionConfig(a);break;case S.MESSAGE.PLUGIN_CONFIRM:this.onPluginConfirm(a);break;case S.MESSAGE.PLUGIN_CANCEL:this.onPluginCancel(a)}}}}},{key:"showMentionPanel",value:function(){this.state.atArea=new D(this.selection,this.data.doc),this.state.atArea.attachObserver(this),this.manager.editHandler.insertText("@",{state:ee.a.CompositionInit})}},{key:"onCommentPanelScroll",value:function(){var e=this;this.throttleScrollHandler||(this.throttleScrollHandler=window.utils.Lodash.throttle((function(){var t=e.state,n=t.isPluginCreatingAtArea,i=t.isPluginClickOnAtArea;(n||i)&&e.selection.selContext.isInComment()&&e.updateAtAreaPosition()}),60)),this.throttleScrollHandler()}},{key:"onComponentChange",value:function(){(this.state.isPluginCreatingAtArea||this.state.isPluginClickOnAtArea)&&this.cancelForwardly({isFocus:!1})}},{key:"onScalingChange",value:function(){this.selection.selContext.isInComment()&&this.onComponentChange()}},{key:"onCommandResponseOnEnterCommentBody",value:function(){this.layout&&this.layout.toggleContainer({detail:{type:this.app.commentShowStatus.commentBubble?z:Y,pluginName:this.state.pluginConfig.pluginName}})}},{key:"onCommandResponseOnExitCommentBody",value:function(){this.layout&&this.layout.toggleContainer({detail:{type:X,pluginName:this.state.pluginConfig.pluginName}})}},{key:"onCommandResponseOnShowMentionPanel",value:function(){this.showMentionPanel()}},{key:"onCustomEvent",value:function(e){switch(e.type){case N.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE:case N.default.names.ON_MODAL_VISIBLE_CHANGE:case B.default.comments.ON_TEMP_COMMENT_MODAL_SHOW:case B.default.revision.REVISION_ACCEPTREFUSE:case B.default.names.ON_CUSTOM_MODAL_VISIBLE_CHANGE:this.onComponentChange();break;case B.default.zoom.ON_SCALING_CHANGE:this.onScalingChange();break;case B.default.pluginEvent.CUSTOM_PLUGIN_EVENT:this.onCustomPluginEvent(e);break;case N.default.names.network.ON_APP_READY:this.loadAtPlugin();break;case B.default.names.SHOW_MENTION_PANEL:this.showMentionPanel();break;case B.default.comments.ON_COMMENT_PANEL_SCROLL:this.onCommentPanelScroll();break;case B.default.comments.COMMENT_INSERTOREDIT_SUCCESS:this.handleInsertOrEditSuccess(e.detail);break;case B.default.comments.SHOW_AT_MODEL:this.showMentionPanelByComment(e);break;case B.default.comments.COLSE_AT_MODEL:this.closeMentionPanelByComment();break;case B.default.comments.SEARCH_AT_MODEL:this.searchMentionByComment(e)}return this.state.uilState}},{key:"onSelectionChanged",value:function(e,t,n,i){var a=this.state,o=a.isPluginClickOnAtArea,r=a.atAreaByTap;if(o&&r){var s=r.field,l=this.selection.getNormalRange(),c=l.pos,u=l.len;c>s.begin&&c+u<s.end||this.cancelForwardly()}}},{key:"onUILOperationTriggered",value:function(e,t,n,i){if(this.throttleUpdateAtAreaText(),this.throttleUpdatePluginPosition(),this.state.atIdLocatePromiseRef.promise&&(!i||!i.isEditing)){var a=this.state.atIdLocatePromiseRef,o=a.data,r=o.atId,s=o.index,l=o.lastFieldInMainText,u=o.fields,d=a.resolve,h=a.reject,p=c()(this.data.doc.concernRanges,1)[0];if(p.pos+p.len>=l.end){for(var f=s,g=u.length;f<g;f++){var v=u[f],y=new F.a(this.data,v);if(y.isMentionAddress()&&y.getKWProtocolParams().uuid===r)return void d({pos:v.pos,len:v.len})}h(!1)}}}},{key:"onDestroyAtArea",value:function(){this.cancelForwardly()}},{key:"onAddField",value:(l=s()(regeneratorRuntime.mark((function e(t,n){var i,a,o,r,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.app.applyLocalOperation){e.next=2;break}return e.abrupt("return");case 2:if("HYPERLINK"===n.type){e.next=5;break}return e.abrupt("return");case 5:if(!(i=new F.a(this.data,n)).isMentionAddress()){e.next=18;break}return a=i.getKWProtocolParams(),o=a.appid,r=a.uuid,s=this.state.insertingAtAreas.findIndex((function(e){var t=e.params;return t.appid===o&&t.uuid===r})),(l=-1===s)||this.state.insertingAtAreas.splice(s,1),e.t0=this.manager,e.t1=b.PLUGIN_TYPE.AT,e.t2=S.MESSAGE.PLUGIN_ADD,e.next=16,this.trasnformParam({data:i.getKWProtocolParams(),isRecovery:l});case 16:e.t3=e.sent,e.t0.postMessageToPlugin.call(e.t0,e.t1,e.t2,e.t3);case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"getAtAreaParams",value:function(e){var t={},n=e.indexOf("?");return-1!==n&&e.slice(n+1).split("&").reduce((function(e,t){var n=t.split("="),i=c()(n,2),a=i[0],o=i[1];return void 0!==a&&void 0!==o&&(e[a]=o),e}),t),t}},{key:"handleFieldDeleted",value:(r=s()(regeneratorRuntime.mark((function e(t){var n,i,a,o,r,l,c,u,d=this,h=t.type,p=t.content;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,i=n.deletedHyperlinkFieldCount,a=n.isPluginClickOnAtArea,o=n.atAreaByTap,!(i>0&&"HYPERLINK"===h)){e.next=8;break}if(this.state.deletedHyperlinkFieldCount--,!/^kw:mention\S+$/.test(p)){e.next=8;break}return r=this.getAtAreaParams(p),a&&o&&(l=o.data,c=l.appid,u=l.uuid,c===r.appid&&u===r.uuid&&this.cancelForwardly()),s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d.manager,e.t1=b.PLUGIN_TYPE.AT,e.t2=S.MESSAGE.PLUGIN_REMOVE,e.next=5,d.trasnformParam({data:d.getAtAreaParams(p)});case 5:e.t3=e.sent,e.t0.postMessageToPlugin.call(e.t0,e.t1,e.t2,e.t3);case 7:case"end":return e.stop()}}),e,d)})))(),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onDeleteText",value:function(e,t,n){var i=this;if(this.app.applyLocalOperation){for(var a=[],o=0,r=0,s=n.length;r<s;r++)if(n.charCodeAt(r)===M.n)1===++o&&a.push({begin:r}),this.state.isDeletingFieldText=!0;else if(n.charCodeAt(r)===M.p){var l=a[a.length-1];1===o&&l&&(l.sep=r),this.state.isDeletingFieldText=!0}else if(n.charCodeAt(r)===M.o){var u=a[a.length-1];1===o&&u&&(u.end=r),--o,this.state.isDeletingFieldText=!0}if(0===o&&a.length>0&&(a.forEach((function(e){var t=n.substring(e.begin+2,e.sep-1),a=Array.from(t.match(/\s?([A-Z]+)\s?"([\s\S]*)"/)||[]),o=c()(a,3),r=o[1],s=o[2];i.handleFieldDeleted({type:r,content:s})})),this.state.isDeletingFieldText=!1),this.state.isDeletingFieldText&&n.length>1){this.state.isDeletingFieldText=!1;var d=Array.from(n.match(/\s?([A-Z]+)\s?"([\s\S]*)"/)||[]),h=c()(d,3),p=h[1],f=h[2];this.handleFieldDeleted({type:p,content:f})&&(this.state.isDeletingFieldText=!1)}}}},{key:"onDeleteField",value:function(e,t){this.app.applyLocalOperation&&"HYPERLINK"===t.type&&this.state.deletedHyperlinkFieldCount++}},{key:"updatePluginConfig",value:function(){var e="insert_all_body",t=[ve],n=!1;return this.app.data.selection.selInfo.info.isInComment?e="insert_user":(n=!0,t=[ge,ve,ye]),this.state.pluginInitialConfigs._function=e,this.state.pluginInitialConfigs.selectorProps.tabs=t,this.state.pluginInitialConfigs.selectorProps.showSidebar=n,this.updatePluginInitialConfig(),this.atPlugin?this.atPlugin.init(this.state.pluginInitialConfigs):Promise.resolve()}},{key:"sendNotifyMain",value:(a=s()(regeneratorRuntime.mark((function e(t){var n,i=t.users,a=void 0===i?[]:i,o=t.insertLinks;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.isNotify){e.next=2;break}return e.abrupt("return");case 2:return n={users:a,useReAt:!0,contents:{main:oe(o)}},e.t0=this.manager,e.t1=b.PLUGIN_TYPE.AT,e.t2=S.MESSAGE.PLUGIN_NOTIFY,e.next=8,this.trasnformParam(n);case 8:e.t3=e.sent,e.t0.postMessageToPlugin.call(e.t0,e.t1,e.t2,e.t3),console.log("发送正文的inbox消息：",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"sendNotifyComment",value:(i=s()(regeneratorRuntime.mark((function e(t){var n,i=t.users,a=void 0===i?[]:i,o=t.commentid,r=void 0===o?"":o,s=t.comment,l=void 0===s?[]:s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.isNotify){e.next=2;break}return e.abrupt("return");case 2:return n={users:a,useReAt:!0,subAppParams:{commentid:r},contents:{main:l,quote:se(r)}},e.t0=this.manager,e.t1=b.PLUGIN_TYPE.AT,e.t2=S.MESSAGE.PLUGIN_NOTIFY,e.next=8,this.trasnformParam(n);case 8:e.t3=e.sent,e.t0.postMessageToPlugin.call(e.t0,e.t1,e.t2,e.t3),console.log("发送评论的inbox消息：",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleInsertOrEditSuccess",value:function(e){var t=e.commentId,n=e.range,i=e.nodes,a=i?function(e){var t=[];return e.forEach((function(e){if(e.type===ie.NODETYPE.MENTION){var n=o()({},e);n.attrs&&(n.attrs=o()({},e.attrs),n.attrs.extraAttrs&&(n.attrs.extraAttrs=decodeURIComponent(window.atob(n.attrs.extraAttrs)))),t.push(n)}})),t}(i):function(e){return Object(ie.getMentions)(e).map((function(e){return e.attrs&&e.attrs.extraAttrs&&(e.attrs.extraAttrs=decodeURIComponent(window.atob(e.attrs.extraAttrs))),e}))}(n);if(a&&a.length){var r=a.map((function(e){var t=e.attrs,n=e.text;return{appid:t.appid,userid:t.userid,uuid:t.uuid,_type:t._type,extraAttrs:t.extraAttrs,name:n}}));this.sendNotifyComment({users:r,commentid:t,comment:i?ce(i):re(n)})}}},{key:"showMentionPanelByComment",value:function(e){var t=this,n=U.isMobile?this.getPluginPos():e.detail.position;if(e.detail.isUpdate||!1){var i=T.LAYOUT.PLUGIN_SET_CONTAINER_POSITION;this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,i,o()({},n))}else this.updatePluginConfig().then((function(){var e=T.LAYOUT.PLUGIN_RENDER;t.state.isPluginCreatingAtArea=!0,t.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,e,o()({},n))}))}},{key:"closeMentionPanelByComment",value:function(){this.cancelForwardly({isFocus:!1}),this.state.isPluginCreatingAtArea=!1}},{key:"searchMentionByComment",value:function(e){var t=e.detail,n=t.text,i=t.isComposing;this.manager.postMessageToPlugin(b.PLUGIN_TYPE.AT,E.KEYBOARD.PLUGIN_INPUT,{text:n,isComposing:i})}},{key:"onPluginConfirmByComment",value:function(e){var t=e.list.map((function(e){var t={extraAttrs:window.btoa(encodeURIComponent(e.extraAttrs)),classes:L.classes.mention};return void 0!==e.appid&&(t.appid=e.appid),void 0!==e.uuid&&(t.uuid=e.uuid),void 0!==e._type&&(t._type=e._type),void 0!==e.userid&&(t.userid=e.userid),{params:t,text:"@"+e.name}})).splice(0,this.state.pluginInitialConfigs.max);B.default.dispatchEvent(B.default.comments.ON_CONFIRM_AT,{hyperlinks:t}),this.cancelForwardly({isFocus:!1})}},{key:"onPluginCancelByComment",value:function(){B.default.dispatchEvent(B.default.comments.ON_CLOSE_AT),this.state.isPluginCreatingAtArea=!1}},{key:"trasnformParam",value:(n=s()(regeneratorRuntime.mark((function e(t){var n,i,a,o,r,s,l,c,u,d,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.__WPSENV__,i=n.file_info,a=n.reduxDispatch,i.file.corp_id){e.next=3;break}return e.abrupt("return",t);case 3:return o={},r=t.data,s=t.contents,l=t.users,c=function(e){var t=e.userid;t&&(o[t]?o[t].push(e):o[t]=[e])},r&&c(r),l&&l.forEach((function(e){return c(e)})),s&&(u=function(e){e.forEach((function(e){var t=e.type,n=e.attrs;"mention"===t&&n&&c(n)}))},d=s.main,h=s.quote,d&&u(d),h&&u(h)),e.next=11,a(Object(de.getCompanyUserIds)(Object.keys(o).map((function(e){return e.toString()}))));case 11:if(!(p=e.sent).error){e.next=15;break}return console.error("getCompanyUserIds失败"),e.abrupt("return",t);case 15:return p.response.body.forEach((function(e){var t=e.id,n=e.company_user_id;o[t]&&o[t].forEach((function(e){return e.userid=Number(n)}))})),e.abrupt("return",t);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"initialState",get:function(){return{uilState:P.a.CONTINUE,isPluginCreatingAtArea:!1,isPluginClickOnAtArea:!1,isLocatingAtArea:!1,isDeletingFieldText:!1,deletedHyperlinkFieldCount:0,isComposing:!1,keyboardEventBlockList:[],atIdLocatePromiseRef:{},insertingAtAreas:[],pluginInitialConfigs:{max:100,_from:"word",_function:"insert_all_body",fid:Object($.a)(),includeFileExts:he.includeFileExts,selectOnly:!0,linkCheckAlways:!0,selectorProps:{includeGroupInfo:!0,includeTeamInfo:!0,includeDeptInfo:!0,showNoticeCheckbox:!0,showSidebar:!0,tabs:[ge,ve,ye]},memberSelectorProps:{}},isNotify:!1}}}]),t}(k.a);me.events=[{type:A.a.START,target:Z.a.view,flag:Z.b.gesture},{type:A.a.TAP,target:Z.a.view,flag:Z.b.gesture},{type:B.default.pluginEvent.CUSTOM_PLUGIN_EVENT,target:Z.a.window,flag:Z.b.native},{type:N.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,target:Z.a.window,flag:Z.b.native},{type:N.default.names.ON_MODAL_VISIBLE_CHANGE,target:Z.a.window,flag:Z.b.native},{type:N.default.names.network.ON_APP_READY,target:Z.a.window,flag:Z.b.native},{type:B.default.names.ON_CUSTOM_MODAL_VISIBLE_CHANGE,target:Z.a.window,flag:Z.b.native},{type:B.default.names.SHOW_MENTION_PANEL,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.ON_TEMP_COMMENT_MODAL_SHOW,target:Z.a.window,flag:Z.b.native},{type:B.default.revision.REVISION_ACCEPTREFUSE,target:Z.a.window,flag:Z.b.native},{type:B.default.zoom.ON_SCALING_CHANGE,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.ON_COMMENT_PANEL_SCROLL,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.COMMENT_INSERTOREDIT_SUCCESS,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.SHOW_AT_MODEL,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.COLSE_AT_MODEL,target:Z.a.window,flag:Z.b.native},{type:B.default.comments.SEARCH_AT_MODEL,target:Z.a.window,flag:Z.b.native},{type:"input",target:Z.a.input,flag:Z.b.native},{type:"compositionstart",target:Z.a.input,flag:Z.b.native},{type:"compositionend",target:Z.a.input,flag:Z.b.native},{type:"resize",target:Z.a.window,options:{throttleParams:[16]},flag:Z.b.native},{type:"keydown",target:Z.a.window,flag:Z.b.native}].concat(d()(U.isPad?[{type:"orientationchange",target:Z.a.window,flag:Z.b.native}]:[]));t.a=me},7134:function(e,t,n){"use strict";var i=n(8),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(677),u=n(2495),d=n(309),h=n(624),p=n(812),f=n(822),g=n(13),v=n.n(g),y=n(80),m=n.n(y),_=n(22),x=n.n(_),w=n(23),k=n.n(w),b=n(2139),T=n(167),C=n(227),S=n(260),E=n(1144),P=n(324),L=n(623),A=n(2682),I=n.n(A),R=n(1468),O=n(3092),M=n(3427),D=n(14),N='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type  content="text/html; charset=utf-8" ><meta name=ProgId  content=Word.Document ><meta name=Generator  content="Microsoft Word 14" ><meta name=Originator  content="Microsoft Word 14" ><title></title>\x3c!--[if gte mso 9]><xml><o:DocumentProperties><o:Revision>1</o:Revision><o:Pages>1</o:Pages><o:Lines>1</o:Lines><o:Paragraphs>1</o:Paragraphs></o:DocumentProperties></xml><![endif]--\x3e\x3c!--[if gte mso 9]><xml><o:OfficeDocumentSettings></o:OfficeDocumentSettings></xml><![endif]--\x3e\x3c!--[if gte mso 9]><xml><w:WordDocument><w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel><w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery><w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery><w:DocumentKind>DocumentNotSpecified</w:DocumentKind><w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing><w:PunctuationKerning></w:PunctuationKerning><w:View>Normal</w:View><w:Compatibility><w:AdjustLineHeightInTable/><w:DontGrowAutofit/><w:BalanceSingleByteDoubleByteWidth/><w:DoNotExpandShiftReturn/><w:UseFELayout/></w:Compatibility><w:Zoom>0</w:Zoom></w:WordDocument></xml><![endif]--\x3e\x3c!--[if gte mso 9]><xml><w:LatentStyles DefLockedState="false"  DefUnhideWhenUsed="true"  DefSemiHidden="true"  DefQFormat="false"  DefPriority="99"  LatentStyleCount="260" >\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Normal" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 7" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 8" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="heading 9" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 7" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 8" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index 9" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 7" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 8" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toc 9" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Normal Indent" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="footnote text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="annotation text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="header" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="footer" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="index heading" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="caption" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="table of figures" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="envelope address" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="envelope return" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="footnote reference" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="annotation reference" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="line number" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="page number" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="endnote reference" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="endnote text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="table of authorities" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="macro" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="toa heading" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Bullet" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Number" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Bullet 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Bullet 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Bullet 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Bullet 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Number 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Number 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Number 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Number 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Title" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Closing" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Signature" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Default Paragraph Font" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text Indent" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Continue" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Continue 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Continue 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Continue 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Continue 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Message Header" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Subtitle" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Salutation" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Date" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text First Indent" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text First Indent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Note Heading" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text Indent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Body Text Indent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Block Text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Hyperlink" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="FollowedHyperlink" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Strong" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Emphasis" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Document Map" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Plain Text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="E-mail Signature" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Normal (Web)" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Acronym" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Address" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Cite" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Code" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Definition" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Keyboard" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Preformatted" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Sample" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Typewriter" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="HTML Variable" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Normal Table" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="annotation subject" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No List" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / a / i" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / 1.1 / 1.1.1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Article / Section" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Simple 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Simple 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Simple 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Classic 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Classic 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Classic 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Classic 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Colorful 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Colorful 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Colorful 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Columns 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Columns 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Columns 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Columns 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Columns 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 7" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid 8" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 7" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table List 8" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table 3D effects 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table 3D effects 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table 3D effects 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Contemporary" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Elegant" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Professional" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Subtle 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Subtle 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Web 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Web 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Web 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Balloon Text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Grid" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Table Theme" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Placeholder Text" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No Spacing" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="List Paragraph" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Quote" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Intense Quote" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 1" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 2" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 3" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 4" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 5" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Shading Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light List Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Light Grid Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 1 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Shading 2 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 1 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium List 2 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 1 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 2 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Medium Grid 3 Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Dark List Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Shading Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful List Accent 6" ></w:LsdException>\r\n<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Colorful Grid Accent 6" ></w:LsdException>\r\n</w:LatentStyles></xml><![endif]--\x3e<style>\x3c!--\r\n@font-face{\r\nfont-family:"Times New Roman";\r\n}\r\n\r\n@font-face{\r\nfont-family:"宋体";\r\n}\r\n\r\n@font-face{\r\nfont-family:"Calibri";\r\n}\r\n\r\n@font-face{\r\nfont-family:"微软雅黑";\r\n}\r\n\r\n@font-face{\r\nfont-family:"Arial";\r\n}\r\n\r\np.MsoNormal{\r\nmso-style-name:正文;\r\nmso-style-parent:"";\r\nmargin:0pt;\r\nmargin-bottom:.0001pt;\r\nmso-pagination:none;\r\ntext-align:justify;\r\ntext-justify:inter-ideograph;\r\nfont-family:Arial;\r\nmso-fareast-font-family:微软雅黑;\r\nmso-bidi-font-family:\'Times New Roman\';\r\nfont-size:10.5000pt;\r\nmso-font-kerning:1.0000pt;\r\n}\r\n\r\nspan.10{\r\nfont-family:Calibri;\r\nmso-fareast-font-family:微软雅黑;\r\n}\r\n\r\nspan.15{\r\nfont-family:Calibri;\r\nmso-fareast-font-family:微软雅黑;\r\ncolor:rgb(0,0,255);\r\ntext-decoration:underline;\r\ntext-underline:single;\r\n}\r\n\r\nspan.msoIns{\r\nmso-style-type:export-only;\r\nmso-style-name:"";\r\ntext-decoration:underline;\r\ntext-underline:single;\r\ncolor:blue;\r\n}\r\n\r\nspan.msoDel{\r\nmso-style-type:export-only;\r\nmso-style-name:"";\r\ntext-decoration:line-through;\r\ncolor:red;\r\n}\r\n@page{mso-page-border-surround-header:no;\r\n\tmso-page-border-surround-footer:no;}@page Section0{\r\n}\r\ndiv.Section0{page:Section0;}--\x3e</style></head><body style="tab-interval:21pt;text-justify-trim:punctuation;" >\x3c!--StartFragment--\x3e<p class=MsoNormal ><span><a href="{0}" ><u><span class="15"  style="mso-spacerun:\'yes\';font-family:Calibri;mso-fareast-font-family:微软雅黑;\r\nmso-bidi-font-family:\'Times New Roman\';color:rgb(0,0,255);text-decoration:underline;\r\ntext-underline:single;" >{1}</span></u></a></span></p>\x3c!--EndFragment--\x3e</body></html>',B=T.isMobile,j=T.isIE,F={},H=[R.MIME_TYPES.WPS9,R.MIME_TYPES.KS_IMAGE,R.MIME_TYPES.HTML,R.MIME_TYPES.TEXT,R.MIME_TYPES.KS_DATA],G=[R.MIME_TYPES.OO_GVML].concat(H),U=function(e){function t(e,n){r()(this,t);var i=x()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.writeClipboardTime=0,i.setCliboardPositionCallback=function(){i.clipboard.setDocumentPositionFunc((function(){return"position="+i.selection.begin.position}))},i.localPosition=function(){var e=Object(D.getNumberQuery)("position");if(e)try{i.selection.setPosition(e),i.workspace.makesureCursorVisible()}catch(e){}window.removeEventListener(S.default.document.ON_DOC_AFTER_OPEN,i.localPosition)},i.mapCopyInfo=new Map,i.copyShapes=new Map,i.shapeCopy=new O.default,i.clipboard=new I.a,i.copyId=0,i.setCliboardPositionCallback(),window.addEventListener(S.default.document.ON_DOC_AFTER_OPEN,i.localPosition),i}var n,i;return k()(t,e),l()(t,[{key:"initState",value:function(){this.state=F}},{key:"clearAll",value:function(){}},{key:"updateClipBoardInfo",value:function(){}},{key:"setLocalCopyInfo",value:function(){this.state.serverCopySuccess=!1,this.state.serverHtml=null,this.state.serverCore=null}},{key:"createClipboardInfo",value:function(){var e=this.app.data.selection.activeShape,t=void 0,n=void 0;return t=e&&e.id?G:H,this.app.copyControl()&&(n="encryptedData"),this.copyId=++this.copyId,{id:I.a.createClipboardId(window.fileInfo.id,this.shapeCopy.getXDocHeader()),mimeTypes:t,dataType:n,priorityFormat:t,from:"wps"}}},{key:"getClipboardData",value:(i=m()(regeneratorRuntime.mark((function e(t){var n,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboard.read(t);case 2:if(n=e.sent,i=n.result,a=n.callstatus,i){e.next=7;break}return e.abrupt("return",{});case 7:return(o=i.info)&&(i.id=o.id,i.info.priorityFormat=o.mimeTypes),e.abrupt("return",v()({},i,{callstatus:a}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getClipboardInfo",value:(n=m()(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipboard.read(t);case 2:return n=e.sent,i=n.result,(a=i&&i.info)&&(a.priorityFormat=a.mimeTypes),e.abrupt("return",a||{});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"writeClipboard",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.info=this.createClipboardInfo(e),this.clipboard.type!==R.CLIPBOARD_TYPE.ASYNC&&this.clipboard.type!==R.CLIPBOARD_TYPE.SYNC||(e.text||e.html||(e.html="<html><body> </body></html>"),e.html||(e.html="<div>"+e.text+"</div>")),t&&(e.info.id=t),this.clipboardInfo=v()({},e,{id:e.info.id}),this.clipboard.write(e,null,n)}},{key:"onPasteOtherContent",value:function(){this.state.serverCopySuccess=!1}},{key:"localCopy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.clientCopySuccess=!0,this.state.text=e,this.clipboard.write({text:e}),C.default.dispatchEvent(C.default.names.CLIPBOARD_COPY,{text:e}),t&&window.Toast.success(_i18n("applications.writer.components.core.event.uil.handlers.successCopy", "Copy success"))}},{key:"adjustShapeCP",value:function(e,t,n){for(var i=0,a=0;a<n.length;++a){var o=n[a];if(o.end>e)break;"delete"===o.type&&(i-=o.len)}return i}},{key:"useOrigin",value:function(e){return"gif"===e.format}},{key:"collectShapeInfos",value:function(e){var t=[].concat(a()(this.data.doc.anchors.getAnchors(e.pos,e.len)),a()(this.data.doc.inlineAnchors.getAnchors(e.pos,e.len))),n=!0,i=[],o=new Map,r=t.length>0?this.data.doc.contentControls.collect(e.pos,e.len):[],s=[];t.length>0&&this.data.doc.docInfo.trackRevisions&&(s=this.data.doc.revisions.collectRevisions(e.pos,e.len));for(var l=this.data.shapeManager,c=0;c<t.length;++c){var u=t[c],d=u.anchor,h=u.pos,p=d.shapeData,f=p.shapeId,g=p.hasTextbox,v=p.hasArtWord,y=d.shapeData.shapeTreeType;void 0===y&&(y=this.data.doc.getEmbedDrawing(d.begin).shapeTreeType,d.shapeData.shapeTreeType=y);var m=l.getShapeFromMap(y,f);if(!m||!m.sha1){n=!1;break}var _={};d.nakedShapeData&&d.nakedShapeData.controlObj&&(_.OLEFormat={ProgID:d.nakedShapeData.controlObj.progId});var x=this.useOrigin(m),w=x?m.orgSha1:m.sha1;if(i.push({cp:h-e.pos+this.adjustShapeCP(h,r,s),shapeId:f,shapeTreeType:y,sha1:w,src:w&&this.shapeCopy.generateUrl(w),format:m.format,origin:x,shapeData:_}),!B&&g&&!v){var k=o.get(y);k?k.push(f):o.set(y,[f])}}return i.sort((function(e,t){return e.cp-t.cp})),{ready:n,address4Src:i,textboxMap:o}}},{key:"updateShapeUrlAndCopy",value:function(e){var t=this,n=[];e.address4Src.forEach((function(e){e.origin&&!e.src&&n.push({shapeId:e.shapeId,shapeTreeType:e.shapeTreeType})}));var i=function(){console.log("*** copy",e.copyId,e),delete e.textboxMap;var n=t.mapCopyInfo.get(e.copyId);if(t.selection.activeShape&&1===e.address4Src.length&&(n.shape=e.address4Src[0]),n.callback){var i=[];e.address4Src.forEach((function(e){e.shapeData&&Object.keys(e.shapeData).length>0&&i.push(v()({url:e.src},e.shapeData)),delete e.shapeData})),i.length>0&&t.copyShapes.set(e.copyId,i)}t.data.api.queryCommandQueue("copy",e),e.isCut&&t.uilManager.editHandler.deleteText(!0)};if(0===n.length)return i();var a=Array.from(n,(function(n){return new Promise((function(i,a){t.data.shapeManager.getShapeUrl(n.shapeTreeType,n.shapeId,!0).then((function(o){o?(e.address4Src.some((function(e){if(e.shapeId===n.shapeId&&e.shapeTreeType===n.shapeTreeType){var i=t.data.shapeManager.getShapeFromMap(n.shapeTreeType,n.shapeId);return e.sha1=i.sha1,e.src=t.shapeCopy.generateUrl(e.sha1),!0}})),i()):a("promise reject: get blob url failed")}),(function(e){return Promise.reject(e)}))}))}));Promise.all(a).then((function(){i()}),(function(){}))}},{key:"sendCopy",value:function(e,t){var n=this,i=t.isCut,a=void 0!==i&&i,o=t.callback,r=t.copy2nd,s=void 0===r||r,l=t.addExtArgs,c=void 0===l||l,u=e,d={pos:u.pos,len:u.len,copyId:this.copyId,isCut:a};if(1===e.len){var h=null;if(e.pos===this.selection.begin.position)h=this.selection.activeShape;else{var p=this.data.typoinfo.getPosition(e.pos);p.pos&&(h=p.pos.glyphGroupInfo.shape)}h&&(d.shapeId=h.id,d.shapeTreeType=h.shape_tree_type)}var f=this.collectShapeInfos(d),g=f.ready,y=f.address4Src,m=f.textboxMap;if(g){if(u.len>2e3&&!o&&C.default.dispatchEvent(C.default.names.edit.COPY_PASTE_LOADING,{tip:_i18n("applications.writer.components.core.event.uil.handlers.copyLoadingTip", "Copying...")}),d.address4Src=y,this.setLocalCopyInfo(),c){var _=this.clipboardInfo&&this.clipboardInfo.info;this.state=v()({},this.state,_),d.extArgs=[{type:"ksDocClipboard",data:{ksDocClipboardId:this.state.id,priorityFormats:this.state.priorityFormat,delayCopy:!1}}]}if(Object(M.x)(this.selection,d,!0),this.mapCopyInfo.set(d.copyId,{callback:o,copy2nd:s}),m.size>0){var x=[];m.forEach((function(e,t){x.push({shapeTreeType:t,shapeIds:e})})),d.hasTextbox=!0,this.data.api.updateShapes({shapeTrees:x,exportTextboxAsImg:!0},(function(e){e.shapeTrees.forEach((function(e){y.forEach((function(t){e.shapeTreeType===t.shapeTreeType&&e.shapes.some((function(e){if(e.shapeId===t.shapeId)return t.sha1=e.sha1,t.src=n.shapeCopy.generateUrl(e.sha1),t.isTextbox=!0,!0}))}))})),n.updateShapeUrlAndCopy(d)}))}else y.length>0?this.updateShapeUrlAndCopy(d):(console.log("*** copy",d),this.data.api.queryCommandQueue("copy",d),a&&this.uilManager.editHandler.deleteText(!0))}else window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.copyNonReady", "The selected content has not finished loading. Please copy later."))}},{key:"notifyCopy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.copyBegin=Date.now();var a=void 0,o=void 0,r=!1;if(n&&1===n.len){if(n.pos===this.selection.begin.position)o=this.selection.activeShape;else{var s=this.data.typoinfo.getPosition(n.pos);o=s.pos.glyphGroupInfo.shape}r=!!o}r?o.isWebshape?(a={copy2end:!1,text:""},this.writeClipboard({text:""})):a=this.copyShape(o):a=this.copyText(!e,n,i);var l=!0;if(this.selection.selInfo&&this.selection.selInfo.isSelEqZone&&(l=!1),!e&&!h&&l)return!1;this.state.clientCopySuccess=!0;var c=!!i&&a.copy2nd,u=a,d=u.html,h=u.text;return this.data.api.isConnected()?this.sendCopy(n,{isCut:!e,callback:t,copy2nd:c}):(t&&t({error:"network disconnect",text:h,html:d}),this.setLocalCopyInfo(),window.Toast.error(e?_i18n("applications.writer.components.core.event.uil.handlers.errorCopyText", "Network error. Only text content was copied."):_i18n("applications.writer.components.core.event.uil.handlers.errorCutText", "Network error. Only text content was cut."))),C.default.dispatchEvent(C.default.names.CLIPBOARD_COPY,{html:d,text:h}),window.report(L.TYPE.DURATION,"wps_copytime",Date.now()-this.copyBegin),B||T.isPad||this.workspace.focusWithoutScroll(),!0}},{key:"copyShape",value:function(e){var t=e.id,n=e.shape_tree_type,i=e.rect,a=this.data.shapeManager.getShapeFromMap(n,t);if(a&&a.sha1){var o=void 0,r=!1;"gif"===a.format?a.isOriginalPictureReady?o=this.shapeCopy.generateUrl(a.orgSha1):(r=!0,o=this.shapeCopy.generateUrl(a.sha1)):o=this.shapeCopy.generateUrl(a.sha1);var s=i.size,l='<html><body><img src="'+o+'" width="'+s.width+'" height="'+s.height+'" format="'+a.format+'"></body></html>';return this.app.copyControl()?this.writeClipboard({html:"",text:""}):this.writeClipboard({html:l,image:a.url}),console.log("📌[CopyShape] "+o),this.state.html=l,{html:l,copy2nd:r}}window.Toast.error(_i18n("applications.writer.components.core.event.uil.handlers.copyNonReady", "The selected content has not finished loading. Please copy later."))}},{key:"copyText",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.data.doc.getDataLogic("final").specHidden,a=i.getText(t.pos,t.len).text,o=String.fromCharCode(P.m),r=String.fromCharCode(P.k),s=-1!==a.indexOf(o)||-1!==a.indexOf(r),l=a;if(s)for(var c=0;c<a.length;++c){var u=a[c];u.charCodeAt(0)===P.m?l=l.substring(0,c)+r+a.substring(c+1):u.charCodeAt(0)===P.k&&(l=l.substring(0,c)+o+a.substring(c+1))}if(!e||l){if(n){this.writeClipboardTime=Date.now();var d=this.app.copyControl();this.writeClipboard({text:d?"":l})}return this.state.text=l,{text:l,copy2nd:n}}}},{key:"getLocalCopyCallback",value:function(e,t){var n=this;return function(){var i=n.clipboardInfo.id;n.writeClipboard({text:t,html:e},i),n.state.text=t,n.state.html=e,n.workspace.focusWithoutScroll(),C.default.dispatchEvent(C.default.names.CLIPBOARD_COPY,{html:e,text:t})}}},{key:"afterServerCopyInIE",value:function(e,t,n){var i=e.result,a=i.isShape,o=i.isCut;this.state.serverCopySuccess=!!t,n&&(a?this.workspace.showToast("warn",o?_i18n("applications.writer.components.core.event.uil.handlers.cutShapeForIE", "IE does not support cutting the content you selected, it is recommended to use the Chrome browser."):_i18n("applications.writer.components.core.event.uil.handlers.copyShapeForIE", "IE does not support copying the content you selected, it is recommended to use Chrome browser.")):this.workspace.showToast("success",_i18n("applications.writer.components.core.event.uil.handlers.copyForIE", "Due to IE browser limitation, only plain text can be pasted. Chrome browser is recommended.")))}},{key:"afterServerCopyInGeneral",value:function(e,t,n){var i=this,a=t.html,o=t.text,r=t.image,s=e.error,l=e.result,c=l.isCut,u=l.beyondSize,d=l.copy2nd;if(0!==s)n&&C.default.dispatchEvent(C.default.names.edit.COPY_NOTICE,{msg:c?_i18n("applications.writer.components.core.event.uil.handlers.errorCutText", "Network error. Only text content was cut."):_i18n("applications.writer.components.core.event.uil.handlers.errorCopyText", "Network error. Only text content was copied."),type:E.default.ERROR});else if(d)if(!a&&u&&n)window.Toast.success(c?_i18n("applications.writer.components.core.event.uil.handlers.successCutLimit", "The cut is successful, the data exceeds the browser limit, if you want to paste to the outside, please cut in batches"):_i18n("applications.writer.components.core.event.uil.handlers.successCopyLimit", "The copy is successful, the data exceeds the browser limit, if you want to paste to the outside, please copy in batches"));else{var h={text:o,html:a,image:r};this.app.copyControl()&&(h={text:"",html:"<div></div>"});var p=this.clipboardInfo.id;this.writeClipboard(h,p,!1).then((function(e){var t=e.callstatus,a=i.clipboard.type!==R.CLIPBOARD_TYPE.ASYNC&&i.clipboard.type!==R.CLIPBOARD_TYPE.SYNC;"fail"!==t&&!h.html||B||a?n&&window.Toast.success(c?_i18n("applications.writer.components.core.event.uil.handlers.successCut", "Content cut."):_i18n("applications.writer.components.core.event.uil.handlers.successCopy", "Copy success")):n&&C.default.dispatchEvent(C.default.names.edit.COPY_NOTICE,{callBack:i.getLocalCopyCallback(h.html,h.text),msg:c?_i18n("applications.writer.components.core.event.uil.handlers.successCut", "Content cut."):_i18n("applications.writer.components.core.event.uil.handlers.successCopy", "Copy success"),type:u?c?E.default.SUCCESS_CONTENT_LONG_TEXT_CUT:E.default.SUCCESS_CONTENT_LONG_TEXT:E.default.SUCCESS_INCLUDE_DATA}),console.log("📌[onServerCopy.AsyncWrite]",e)}))}else!d&&n&&window.Toast.success(c?_i18n("applications.writer.components.core.event.uil.handlers.successCut", "Content cut."):_i18n("applications.writer.components.core.event.uil.handlers.successCopy", "Copy success"));if(n){var f=document.querySelector(".component-notice-content");f&&(f.addEventListener("click",(function(){i.workspace.focusWithoutScroll()})),f=null)}}},{key:"afterServerCopy",value:function(e,t,n){var i=t.html,a=t.text,o=t.image,r=!0;if(n){var s=this.copyShapes.get(e.result.copyId);if(this.state.serverCopySuccess){var l=this.state;n({text:a,html:i,shapes:s,ksDocClipBoardInfo:{id:l.id,from:l.from,mimeTypes:l.mimeTypes,priorityFormat:l.priorityFormat}})}else n({error:"server copy failed",text:a,html:i,shapes:s});this.copyShapes.delete(e.result.copyId),r=!1}if(this.state.serverHtml=i,j)this.afterServerCopyInIE(e,i,r);else{var c=i;c&&(c=i.replace("<style>","<style>\x3c!--").replace("</style>","--\x3e</style>"),console.log("📌[kDocsCopy] ",{id:this.state.id,text:a,xhtml:c})),this.afterServerCopyInGeneral(e,{html:c,text:a,image:o},r)}}},{key:"onServerCopy",value:function(e){var t=this;console.log("onServerCopy:",e),this.state.clientCopySuccess=!1;var n=this.mapCopyInfo.get(e.result.copyId),i=n.callback,a=n.copy2nd,o=n.shape;if(this.mapCopyInfo.delete(e.result.copyId),i||C.default.dispatchEvent(C.default.names.edit.COPY_PASTE_SUCCESS),e.result.copyId===this.copyId){this.state.serverCopySuccess=0===e.error;var r=void 0,s=void 0;e.result.mineData&&(this.state.serverHtml=e.result.mineData.html,this.state.serverCore=e.result.mineData.core,s=e.result.mineData.text),e.result.copy2nd=a;var l=window.APP.data.selection.activeShape,c=l&&l.isWebshape,u=l&&l.webshapeUrl,d=l&&l.webshapeDisplayText||u;switch(!0){case e.result.isShape:var h="";c?(h=N.replace("{0}",u).replace("{1}",d),s=d):h='<html><body><img src="'+o.src+'" format="'+o.format+'"></body></html>';var p=o.sha1;if(o.isTextbox){e.result.copy2nd=!0,p=o.src,this.shapeCopy.update((function(){t.afterServerCopy(e,{html:h,text:s,image:p},i)}));break}"gif"===o.format&&(p=this.data.shapeManager.shapeMap.getSha1(o.shapeTreeType,o.shapeId)),this.shapeCopy.update(),this.afterServerCopy(e,{html:h,text:s,image:p},i);break;case!!e.result.mineData:r=this.state.serverHtml,/<img[^>(src)]*(src="file:\/\/\/.*")?[^(src)]*>/gi.test(r)&&console.error("😱onServerCopy: include local image!"),this.shapeCopy.update(),this.afterServerCopy(e,{html:r,text:s},i);break;default:this.afterServerCopy(e,{text:s})}this.state.serverCopySuccess&&this.copyBegin>0&&(console.log("server copy duration:",Date.now()-this.copyBegin),window.report(L.TYPE.DURATION,"wps_copytime_svr",Date.now()-this.copyBegin))}else i&&i({error:"copyId mis-match"})}}]),t}(b.a),W={isUndoRedo:!1},Y=function(e){function t(e,n){return r()(this,t),x()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return k()(t,e),l()(t,[{key:"initState",value:function(){this.state=W}},{key:"canRedo",value:function(){var e=window.g_rpt.canRedo();if(e){var t=window.g_rpt.getNextRedoTransact();if(t&&t.isLocalTransact()){var n=t.localCommand;return!(n&&n.param&&n.param.isComposing)&&e}}return e}},{key:"redo",value:function(){this.state.isUndoRedo=!0,this.uilManager.editHandler.cmdExecutor.redo(),this.workspace.refreshForcedly(),this.data.selection.onCmdExec()}},{key:"undo",value:function(){this.state.isUndoRedo=!0,this.uilManager.editHandler.cmdExecutor.undo(),this.workspace.refreshForcedly(),this.data.selection.onCmdExec()}}]),t}(b.a),z=function(){function e(t){r()(this,e),this.app=t,this.data=t.data,this.workspace=t.workspace,this.initState(),this.initContext(),this.initHandlers(),this.initUILs(),this.initEvents(),this.bindEvents()}return l()(e,[{key:"initHandlers",value:function(){this.undoRedoHandler=new Y(this.app,this),this.clipboardHandler=new U(this.app,this)}},{key:"getEvents",value:function(){return[]}},{key:"initEventInfos",value:function(){this.eventsList={},this.gestureList={},this.eventTargetMap={window:window,document:document,view:this.app.workspace._uilTier}}},{key:"getEventHandler",value:function(e){var t,n=this.onEvent.bind(this);e.options&&e.options.throttleParams&&(n=(t=window.utils.Lodash).throttle.apply(t,[n].concat(a()(e.options.throttleParams))));return n}},{key:"initEvents",value:function(){var e=this;this.initEventInfos(),this.getEvents().forEach((function(t){var n=t||{},i=n.target,a=n.type,o=n.flag;if(null!=i&&void 0!==a&&void 0!==o){var r=i+"_"+a;e.eventsList[r]||(e.eventsList[r]=t,"string"==typeof i&&(t.element=e.eventTargetMap[i]),t.handler=e.getEventHandler(t))}else console.warn("存在非法事件定义，请检查模块内的事件配置！")}))}},{key:"onPermissionChange",value:function(){this.app.isFilePermissionConfirmed=!0,this.clearAll(),this.initUILs(),this.bindEvents()}},{key:"bindNativeEvents",value:function(e){var t=e.type,n=e.element,i=e.handler,a=e.options;n&&(a&&a.listenerParams?n.addEventListener(t,i,a.listenerParams):n.addEventListener(t,i))}},{key:"bindGestureEvents",value:function(e){var t=this,n=e.type,i=e.target,a=e.element,o=e.handler;this.gestureList[i]||(Array.isArray(a)?this.gestureList[i]=a.map((function(e){return new p.d(e,null,t.getGestureRelatedEventTypes(i))})):this.gestureList[i]=new p.d(a,null,this.getGestureRelatedEventTypes(i))),Array.isArray(this.gestureList[i])?this.gestureList[i].forEach((function(e){return e.on(n,o)})):this.gestureList[i].on(n,o)}},{key:"bindEvents",value:function(){var e=this,t=[];for(var n in this.eventsList){var i=this.eventsList[n];i.flag===f.b.gesture?t.push(i):this.bindNativeEvents(i)}t.forEach((function(t){e.bindGestureEvents(t)}))}},{key:"unbindEvents",value:function(){for(var e in this.gestureList)Array.isArray(this.gestureList[e])?this.gestureList[e].forEach((function(e){return e.destroy()})):this.gestureList[e].destroy(),delete this.gestureList[e];for(var t in this.eventsList){var n=this.eventsList[t],i=n.element,a=n.flag,o=n.type,r=n.handler,s=n.options;a===f.b.native&&i&&(s&&s.listenerParams?i.removeEventListener(o,r,s.listenerParams):i.removeEventListener(o,r))}}},{key:"isTapOnSelection",value:function(e){if(e.isFuzzyHit)return!1;var t=this.app.data.selection,n=Math.min(t.begin.position,t.end.position),i=Math.max(t.begin.position,t.end.position);return n!==i&&e.position>=n&&e.position<=i}},{key:"initState",value:function(){this.state={currentOperations:new Set}}},{key:"initContext",value:function(){this.context={classes:{},handlers:{}}}},{key:"initUILs",value:function(){this.UILs={},this.UILs[c.b.LOCAL]=null,this.UILs[c.b.FILTER]=[];var e=this.context.classes.selection;this.UILs[c.b.SELECTION]=new e(this.app,this),this.UILs[c.b.SELECTION].loadModules()}},{key:"mountUIL",value:function(e){if(e)switch(e.type){case c.b.LOCAL:this.UILs[c.b.LOCAL]=e;break;case c.b.FILTER:this.UILs[c.b.FILTER].push(e);break;default:this.UILs[e.type]=e}}},{key:"unmountUIL",value:function(e){if(e)switch(e.type){case c.b.local:this.UILs[c.b.local]===e&&(this.UILs[c.b.local]=null);break;case c.b.filter:var t=this.UILs[c.b.filter].findIndex((function(t){return t===e}));t>-1&&this.UILs[c.b.filter].splice(t,1);break;default:this.UILs[e.type]===e&&(this.UILs[e.type]=null)}}},{key:"clearAll",value:function(e){this.unbindEvents();var t=this.UILs[c.b.LOCAL],n=this.UILs[c.b.FILTER],i=this.UILs[c.b.SELECTION];t&&t.clearAll(),n&&n.forEach((function(e){return e.clearAll()})),i&&i.clearAll(),this.clipboardHandler&&this.clipboardHandler.clearAll()}},{key:"getModule",value:function(e,t){var n=this.UILs[e];return n&&n.getModule(t)}},{key:"sendCommandToModule",value:function(e,t,n){var i=this.UILs[e],a=i&&i.getModule(t);if(a){for(var o=arguments.length,r=Array(o>3?o-3:0),s=3;s<o;s++)r[s-3]=arguments[s];return a.responseCommand.apply(a,[n].concat(r))}}},{key:"getModuleState",value:function(e,t){var n=this.UILs[e],i=n&&n.getModule(t);return i&&i.state}},{key:"hasPluginType",value:function(e){return this.app.viewUIL.plugins.hasPluginType(e)}},{key:"updatePluginInitialConfigs",value:function(e,t){this.state.pluginInitialConfigs||(this.state.pluginInitialConfigs={}),this.state.pluginInitialConfigs[e]=t}},{key:"postMessageToPlugin",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};h.default.messagePush({pluginType:e,pluginEvent:t,detail:n})}},{key:"getPosByEvent",value:function(e){}},{key:"getPositionOnVisible",value:function(e){if(this.data.doc.isPalaceMuseumTemplate)return this.data.doc.getDocumentStart();var t=this.data.selection.selContext.subdocType,n=e.isInMainText;void 0!==n&&n&&this.data.selection.selContext.setSubdocType(d.MainText);var i=u.a.hit(this.data,this.getVisibleCoordinate(),this.data.typoinfo);return this.data.selection.selContext.setSubdocType(t),i}},{key:"getGCPOnVisible",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPositionOnVisible(e);return"number"==typeof t?t:t&&t.position}},{key:"getGCPByViewPos",value:function(e,t){return(u.a.hit(this.data,{x:e,y:t},this.data.typoinfo)||{position:-1}).position}},{key:"hit",value:function(e){}},{key:"execute",value:function(e,t){var n=e.type,i=this.UILs[c.b.LOCAL],a=this.UILs[c.b.FILTER],o=this.UILs[c.b.SELECTION],r=void 0;i&&this.context.classes.selection.isEventPreferred(n)&&(r=o.enter(e,t)),i?r=i.enter(e,t):(a instanceof Array&&a.length>0&&a.some((function(n){if((r=n.enter(e,t))===c.a.DONE||r===c.a.BLOCK)return!0})),o&&(r=o.enter(e,t)))}},{key:"createLocalUILIfNeeded",value:function(e,t){var n=this.UILs[c.b.LOCAL];if(n)return!1;var i=this.context.classes.local,a=i.matchTriggerConditions(this.app,e,t);return!!a&&(this.UILs[c.b.LOCAL]=n=new i(this.app,this),this.mountUIL(n),n.loadModules(a),!0)}},{key:"onMouseEvent",value:function(e){var t=this.hit({event:e});t&&(this.pos=t.pos,this.createLocalUILIfNeeded(e,t),this.execute(e,t))}},{key:"onGestureEvent",value:function(e,t){var n=e.event,i=this.hit({event:n});i&&(this.createLocalUILIfNeeded(e,i),this.execute(e,i))}},{key:"onKeyboardEvent",value:function(e){this.execute(e)}},{key:"onWindowEvent",value:function(e){this.execute(e)}},{key:"onDocumentEvent",value:function(){this.execute(event)}},{key:"onCustomEvent",value:function(e){this.createLocalUILIfNeeded(e),this.execute(e)}},{key:"onEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.type,i=this.context.classes.eventList;switch(!0){case i.mouse.includes(n):this.onMouseEvent(e);break;case i.gesture.includes(n):this.onGestureEvent(e,t);break;case i.keyboard.includes(n):this.onKeyboardEvent(e);break;case i.window.includes(n):this.onWindowEvent(e);break;case i.document.includes(n):this.onDocumentEvent(e);break;case i.custom(n):this.onCustomEvent(e)}}},{key:"startOperation",value:function(e){this.state.currentOperations.add(e)}},{key:"finishOperation",value:function(e){this.state.currentOperations.delete(e)}},{key:"isInOperation",value:function(){return this.state.currentOperations.size>0}}]),e}();t.a=z},7215:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={TABLE:"TABLE",TASK_LIST:"TASK_LIST",CONTENT_CONTROLS:"CONTENT_CONTROLS",SHAPE:"SHAPE",COOP_SEL:"COOP_SEL",WATER_DROP:"WATER_DROP"}},724:function(e,t,n){},7375:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(167),l=n(676),c=new(function(){function e(){a()(this,e),this.todoImageSvgContent='<g id="taskListTodo" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect width="14" height="14" rx="2" fill="white"/><rect x="0.5" y="0.5" width="13" height="13" rx="1.5" stroke="#0D0D0D" stroke-opacity="0.48"/></g>',this.doneImageSvgContent='<g id="taskListDone" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect width="14" height="14" rx="2" fill="#3B89FF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M11.6895 3.29378C12.0965 3.69232 12.1044 4.34643 11.7072 4.75477L6.6184 10.6885C6.23825 11.0792 5.62065 11.1057 5.20859 10.749L2.35706 7.51658C1.92645 7.14381 1.87859 6.49142 2.25017 6.05943C2.62176 5.62744 3.27206 5.57944 3.70267 5.95221L5.82091 8.54986L10.2331 3.31153C10.6304 2.90319 11.2824 2.89524 11.6895 3.29378Z" fill="white"/></g>'}return r()(e,[{key:"init",value:function(){}},{key:"createImage",value:function(e){var t=Object(l.createElement)({type:"div",classname:e,style:"display:none;",parent:document.body});if(!t)return null;var n=window.getComputedStyle(t,!1)["background-image"],i=/(data:image.*)\)/g.exec(n);if(!i||!i[1])return null;var a=i[1].replace(/\"/g,"");if(!a)return null;var o=new Image;return o.src=a,o}},{key:"getImageSize",value:function(){return s.isMobile?{width:16,height:16}:{width:14,height:14}}},{key:"todoImage",get:function(){return this._todoImage||(this._todoImage=this.createImage("icons-other-checkbox_normal")),this._todoImage}},{key:"doneImage",get:function(){return this._doneImage||(this._doneImage=this.createImage("icons-other-checkbox_done")),this._doneImage}}]),e}())},7377:function(e,t,n){var i=n(8850);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},7378:function(e,t){e.exports=function(e,t,n,i){for(var a=e.length,o=n+(i?1:-1);i?o--:++o<a;)if(t(e[o],o,e))return o;return-1}},7379:function(e,t){e.exports=function(e,t,n){for(var i=-1,a=null==e?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}},7380:function(e,t,n){var i=n(8855),a=n(716);e.exports=function e(t,n,o,r,s){return t===n||(null==t||null==n||!a(t)&&!a(n)?t!=t&&n!=n:i(t,n,o,r,e,s))}},7509:function(e,t,n){"use strict";n.r(t),n.d(t,"createShape",(function(){return es})),n.d(t,"layout",(function(){return ts})),n.d(t,"render",(function(){return ns})),n.d(t,"preview",(function(){return is})),n.d(t,"getFill",(function(){return as})),n.d(t,"Px2Emu",(function(){return Gr.c})),n.d(t,"hitTest",(function(){return os})),n.d(t,"renderCanvasShape",(function(){return rs}));var i={};n.r(i),n.d(i,"SlideViewType",(function(){return k})),n.d(i,"PresetShapeType",(function(){return b})),n.d(i,"PresetShapeInfo",(function(){return T})),n.d(i,"shapeDefaultSize",(function(){return C})),n.d(i,"ShapeGroupType",(function(){return E})),n.d(i,"ShapeCreateFunctions",(function(){return P})),n.d(i,"ShapeGroupItems",(function(){return L})),n.d(i,"TextVerticalType",(function(){return M})),n.d(i,"TextAutoFitType",(function(){return D})),n.d(i,"LineType",(function(){return O})),n.d(i,"shapeTypeStr2Enum",(function(){return S}));var a,o,r=n(1),s=n.n(r),l=n(2),c=n.n(l),u=n(22),d=n.n(u),h=n(23),p=n.n(h),f=(a=new Date-0,o=0,function(e){return e?e.toString(16):(a+o++).toString(16)}),g=n(24),v=n.n(g);function y(e,t){var n=void 0;if(null==e||"object"!==(void 0===e?"undefined":v()(e)))return e;if(e instanceof Date)return(n=new Date).setTime(e.getTime()),n;if(e instanceof Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array){n=[];for(var i=0,a=e.length;i<a;i++)n[i]=y(e[i],t);return n}if(e instanceof Function)return n=function(){return e.apply(this,arguments)};if(e instanceof Object){for(var o in n=t?new e.constructor:{},e)e.hasOwnProperty(o)&&(n[o]=y(e[o],t));return n}throw new Error("Unable to copy obj as type isn't supported "+e.constructor.name)}function m(e){return y(e,!1)}var _,x=n(30),w=n.n(x),k={wpViewInvalid:0,wpViewSlide:1,wpViewSlideMaster:2,wpViewNotesPage:3,wpViewHandoutMaster:4,wpViewNotesMaster:5,wpViewOutline:6,wpViewSlideSorter:7,wpViewTitleMaster:8,wpViewNormal:9,wpViewPrintPreview:10,wpViewThumbnails:11,wpViewMasterThumbnails:12,wpViewNotesText:13};Object.freeze(k);var b={ShapeInvalid:-1,ShapeBegin:0,ShapeLine:0,ShapeLineInverse:1,ShapeTriangle:2,ShapeRightTriangle:3,ShapeRectangle:4,ShapeDiamond:5,ShapeParallelogram:6,ShapeTrapezoid:7,ShapeNonIsoscelesTrapezoid:8,ShapePentagon:9,ShapeHexagon:10,ShapeHeptagon:11,ShapeOctagon:12,ShapeDecagon:13,ShapeDodecagon:14,ShapeStar4:15,ShapeStar5:16,ShapeStar6:17,ShapeStar7:18,ShapeStar8:19,ShapeStar10:20,ShapeStar12:21,ShapeStar16:22,ShapeStar24:23,ShapeStar32:24,ShapeRoundRectangle:25,ShapeRound1Rectangle:26,ShapeRound2SameRectangle:27,ShapeRound2DiagonalRectangle:28,ShapeSnipRoundRectangle:29,ShapeSnip1Rectangle:30,ShapeSnip2SameRectangle:31,ShapeSnip2DiagonalRectangle:32,ShapePlaque:33,ShapeEllipse:34,ShapeTeardrop:35,ShapeHomePlate:36,ShapeChevron:37,ShapePieWedge:38,ShapePie:39,ShapeBlockArc:40,ShapeDonut:41,ShapeNoSmoking:42,ShapeRightArrow:43,ShapeLeftArrow:44,ShapeUpArrow:45,ShapeDownArrow:46,ShapeStripedRightArrow:47,ShapeNotchedRightArrow:48,ShapeBentUpArrow:49,ShapeLeftRightArrow:50,ShapeUpDownArrow:51,ShapeLeftUpArrow:52,ShapeLeftRightUpArrow:53,ShapeQuadArrow:54,ShapeLeftArrowCallout:55,ShapeRightArrowCallout:56,ShapeUpArrowCallout:57,ShapeDownArrowCallout:58,ShapeLeftRightArrowCallout:59,ShapeUpDownArrowCallout:60,ShapeQuadArrowCallout:61,ShapeBentArrow:62,ShapeUTurnArrow:63,ShapeCircularArrow:64,ShapeLeftCircularArrow:65,ShapeLeftRightCircularArrow:66,ShapeCurvedRightArrow:67,ShapeCurvedLeftArrow:68,ShapeCurvedUpArrow:69,ShapeCurvedDownArrow:70,ShapeSwooshArrow:71,ShapeCube:72,ShapeCan:73,ShapeLightningBolt:74,ShapeHeart:75,ShapeSun:76,ShapeMoon:77,ShapeSmileyFace:78,ShapeIrregularSeal1:79,ShapeIrregularSeal2:80,ShapeFoldedCorner:81,ShapeBevel:82,ShapeFrame:83,ShapeHalfFrame:84,ShapeCorner:85,ShapeDiagonalStripe:86,ShapeChord:87,ShapeArc:88,ShapeLeftBracket:89,ShapeRightBracket:90,ShapeLeftBrace:91,ShapeRightBrace:92,ShapeBracketPair:93,ShapeBracePair:94,ShapeStraightConnector1:95,ShapeBentConnector2:96,ShapeBentConnector3:97,ShapeBentConnector4:98,ShapeBentConnector5:99,ShapeCurvedConnector2:100,ShapeCurvedConnector3:101,ShapeCurvedConnector4:102,ShapeCurvedConnector5:103,ShapeCallout1:104,ShapeCallout2:105,ShapeCallout3:106,ShapeAccentCallout1:107,ShapeAccentCallout2:108,ShapeAccentCallout3:109,ShapeBorderCallout1:110,ShapeBorderCallout2:111,ShapeBorderCallout3:112,ShapeAccentBorderCallout1:113,ShapeAccentBorderCallout2:114,ShapeAccentBorderCallout3:115,ShapeWedgeRectangleCallout:116,ShapeWedgeRoundRectangleCallout:117,ShapeWedgeEllipseCallout:118,ShapeCloudCallout:119,ShapeCloud:120,ShapeRibbon:121,ShapeRibbon2:122,ShapeEllipseRibbon:123,ShapeEllipseRibbon2:124,ShapeLeftRightRibbon:125,ShapeVerticalScroll:126,ShapeHorizontalScroll:127,ShapeWave:128,ShapeDoubleWave:129,ShapePlus:130,ShapeFlowChartProcess:131,ShapeFlowChartDecision:132,ShapeFlowChartInputOutput:133,ShapeFlowChartPredefinedProcess:134,ShapeFlowChartInternalStorage:135,ShapeFlowChartDocument:136,ShapeFlowChartMultidocument:137,ShapeFlowChartTerminator:138,ShapeFlowChartPreparation:139,ShapeFlowChartManualInput:140,ShapeFlowChartManualOperation:141,ShapeFlowChartConnector:142,ShapeFlowChartPunchedCard:143,ShapeFlowChartPunchedTape:144,ShapeFlowChartSummingJunction:145,ShapeFlowChartOr:146,ShapeFlowChartCollate:147,ShapeFlowChartSort:148,ShapeFlowChartExtract:149,ShapeFlowChartMerge:150,ShapeFlowChartOfflineStorage:151,ShapeFlowChartOnlineStorage:152,ShapeFlowChartMagneticTape:153,ShapeFlowChartMagneticDisk:154,ShapeFlowChartMagneticDrum:155,ShapeFlowChartDisplay:156,ShapeFlowChartDelay:157,ShapeFlowChartAlternateProcess:158,ShapeFlowChartOffpageConnector:159,ShapeActionButtonBlank:160,ShapeActionButtonHome:161,ShapeActionButtonHelp:162,ShapeActionButtonInformation:163,ShapeActionButtonForwardNext:164,ShapeActionButtonBackPrevious:165,ShapeActionButtonEnd:166,ShapeActionButtonBeginning:167,ShapeActionButtonReturn:168,ShapeActionButtonDocument:169,ShapeActionButtonSound:170,ShapeActionButtonMovie:171,ShapeGear6:172,ShapeGear9:173,ShapeFunnel:174,ShapeMathPlus:175,ShapeMathMinus:176,ShapeMathMultiply:177,ShapeMathDivide:178,ShapeMathEqual:179,ShapeMathNotEqual:180,ShapeCornerTabs:181,ShapeSquareTabs:182,ShapePlaqueTabs:183,ShapeChartX:184,ShapeChartStar:185,ShapeChartPlus:186,ShapeTypeEnd:186,TextShapeBegin:187,TextArchDown:187,TextArchDownPour:188,TextArchUp:189,TextArchUpPour:190,TextButton:191,TextButtonPour:192,TextCanDown:193,TextCanUp:194,TextCascadeDown:195,TextCascadeUp:196,TextChevron:197,TextChevronInverted:198,TextCircle:199,TextCirclePour:200,TextCurveDown:201,TextCurveUp:202,TextDeflate:203,TextDeflateBottom:204,TextDeflateInflate:205,TextDeflateInflateDeflate:206,TextDeflateTop:207,TextDoubleWave1:208,TextFadeDown:209,TextFadeLeft:210,TextFadeRight:211,TextFadeUp:212,TextInflate:213,TextInflateBottom:214,TextInflateTop:215,TextPlain:216,TextRingInside:217,TextRingOutside:218,TextSlantDown:219,TextSlantUp:220,TextStop:221,TextTriangle:222,TextTriangleInverted:223,TextWave1:224,TextWave2:225,TextWave4:226,TextNoShape:227,TextShapeEnd:228,OutputConnection:229,OutputNone:230,ShapeCustom:231,KsoCustomBegin:232,ShapeInk:233,KsoCustomEnd:234,VmlShapeBegin:4096};Object.freeze(b);var T={0:{text:"line"},1:{text:"lineInv"},2:{text:"triangle",w:1672.65,h:1440.18},3:{text:"rtTriangle"},4:{text:"rect"},5:{text:"diamond"},6:{text:"parallelogram",w:1916.46,h:1440.18},7:{text:"trapezoid",w:1440.18,h:1916.46},8:{text:"nonIsoscelesTrapezoid"},9:{text:"pentagon",w:1513.89,h:1440.18},10:{text:"hexagon",w:1672.65,h:1440.18},11:{text:"heptagon"},12:{text:"octagon"},13:{text:"decagon"},14:{text:"dodecagon"},15:{text:"star4"},16:{text:"star5"},17:{text:"star6"},18:{text:"star7"},19:{text:"star8"},20:{text:"star10"},21:{text:"star12"},22:{text:"star16"},23:{text:"star24"},24:{text:"star32"},25:{text:"roundRect"},26:{text:"round1Rect"},27:{text:"round2SameRect"},28:{text:"round2DiagRect"},29:{text:"snipRoundRect"},30:{text:"snip1Rect"},31:{text:"snip2SameRect"},32:{text:"snip2DiagRect"},33:{text:"plaque"},34:{text:"ellipse"},35:{text:"teardrop"},36:{text:"homePlate",w:1542.24,h:765.45},37:{text:"chevron",w:765.45,h:765.45},38:{text:"pieWedge"},39:{text:"pie"},40:{text:"blockArc"},41:{text:"donut"},42:{text:"noSmoking"},43:{text:"rightArrow",w:1542.24,h:765.45},44:{text:"leftArrow",w:1542.24,h:765.45},45:{text:"upArrow",w:765.45,h:1542.24},46:{text:"downArrow",w:765.45,h:1542.24},47:{text:"stripedRightArrow",w:1542.24,h:765.45},48:{text:"notchedRightArrow",w:1542.24,h:765.45},49:{text:"bentUpArrow",w:1338.12,h:1151.01},50:{text:"leftRightArrow",w:1916.46,h:765.45},51:{text:"upDownArrow",w:765.45,h:1916.46},52:{text:"leftUpArrow",w:1338.12,h:1338.12},53:{text:"leftRightUpArrow",w:1916.46,h:1338.12},54:{text:"quadArrow",w:1916.46,h:1916.46},55:{text:"leftArrowCallout"},56:{text:"rightArrowCallout"},57:{text:"upArrowCallout"},58:{text:"downArrowCallout"},59:{text:"leftRightArrowCallout",w:1916.46,h:907.2},60:{text:"upDownArrowCallout"},61:{text:"quadArrowCallout",w:1916.46,h:1916.46},62:{text:"bentArrow",w:1281.42,h:1366.47},63:{text:"uturnArrow"},64:{text:"circularArrow",w:1542.24,h:1542.24},65:{text:"leftCircularArrow"},66:{text:"leftRightCircularArrow"},67:{text:"curvedRightArrow",w:1151.01,h:1916.46},68:{text:"curvedLeftArrow",w:1151.01,h:1916.46},69:{text:"curvedUpArrow",w:1916.46,h:1151.01},70:{text:"curvedDownArrow",w:1916.46,h:1151.01},71:{text:"swooshArrow"},72:{text:"cube",w:1916.46,h:1916.46},73:{text:"can",w:1440.18,h:1916.46},74:{text:"lightningBolt"},75:{text:"heart"},76:{text:"sun"},77:{text:"moon",w:720.09,h:1440.18},78:{text:"smileyFace"},79:{text:"irregularSeal1"},80:{text:"irregularSeal2"},81:{text:"foldedCorner"},82:{text:"bevel",w:1644.3,h:1644.3},83:{text:"frame"},84:{text:"halfFrame"},85:{text:"corner"},86:{text:"diagStripe"},87:{text:"chord"},88:{text:"arc"},89:{text:"leftBracket",w:113.4,h:1440.18},90:{text:"rightBracket",w:113.4,h:1440.18},91:{text:"leftBrace",w:243.81,h:1440.18},92:{text:"rightBrace",w:243.81,h:1440.18},93:{text:"bracketPair"},94:{text:"bracePair",w:1683.99,h:1440.18},95:{text:"straightConnector1"},96:{text:"bentConnector2"},97:{text:"bentConnector3"},98:{text:"bentConnector4"},99:{text:"bentConnector5"},100:{text:"curvedConnector2"},101:{text:"curvedConnector3"},102:{text:"curvedConnector4"},103:{text:"curvedConnector5"},104:{text:"callout1",w:1440.18,h:963.9},105:{text:"callout2",w:1440.18,h:963.9},106:{text:"callout3",w:1440.18,h:963.9},107:{text:"accentCallout1",w:1440.18,h:963.9},108:{text:"accentCallout2",w:1440.18,h:963.9},109:{text:"accentCallout3",w:1440.18,h:963.9},110:{text:"borderCallout1",w:1440.18,h:963.9},111:{text:"borderCallout2",w:1440.18,h:963.9},112:{text:"borderCallout3",w:1440.18,h:963.9},113:{text:"accentBorderCallout1",w:1440.18,h:963.9},114:{text:"accentBorderCallout2",w:1440.18,h:963.9},115:{text:"accentBorderCallout3",w:1440.18,h:963.9},116:{text:"wedgeRectCallout"},117:{text:"wedgeRoundRectCallout"},118:{text:"wedgeEllipseCallout",w:1440.18,h:963.9},119:{text:"cloudCallout",w:1440.18,h:963.9},120:{text:"cloud"},121:{text:"ribbon",w:1916.46,h:963.9},122:{text:"ribbon2",w:1916.46,h:963.9},123:{text:"ellipseRibbon",w:1916.46,h:1196.37},124:{text:"ellipseRibbon2",w:1916.46,h:1196.37},125:{text:"leftRightRibbon"},126:{text:"verticalScroll",w:1803.06,h:1627.29},127:{text:"horizontalScroll",w:1627.29,h:1803.06},128:{text:"wave"},129:{text:"doubleWave"},130:{text:"plus"},131:{text:"flowChartProcess",w:1440.18,h:963.9},132:{text:"flowChartDecision",w:1440.18,h:963.9},133:{text:"flowChartInputOutput",w:1440.18,h:963.9},134:{text:"flowChartPredefinedProcess",w:1440.18,h:963.9},135:{text:"flowChartInternalStorage",w:963.9,h:963.9},136:{text:"flowChartDocument",w:1440.18,h:963.9},137:{text:"flowChartMultidocument",w:1672.65,h:1196.37},138:{text:"flowChartTerminator",w:1440.18,h:476.28},139:{text:"flowChartPreparation",w:1672.65,h:963.9},140:{text:"flowChartManualInput",w:1440.18,h:720.09},141:{text:"flowChartManualOperation",w:1440.18,h:963.9},142:{text:"flowChartConnector",w:720.09,h:720.09},143:{text:"flowChartPunchedCard"},144:{text:"flowChartPunchedTape",w:1440.18,h:1270.08},145:{text:"flowChartSummingJunction",w:963.9,h:963.9},146:{text:"flowChartOr",w:963.9,h:963.9},147:{text:"flowChartCollate",w:720.09,h:1440.18},148:{text:"flowChartSort",w:720.09,h:1440.18},149:{text:"flowChartExtract",w:1082.97,h:1082.97},150:{text:"flowChartMerge",w:1082.97,h:1082.97},151:{text:"flowChartOfflineStorage"},152:{text:"flowChartOnlineStorage",w:1440.18,h:963.9},153:{text:"flowChartMagneticTape",w:963.9,h:963.9},154:{text:"flowChartMagneticDisk",w:1440.18,h:963.9},155:{text:"flowChartMagneticDrum",w:1440.18,h:1082.97},156:{text:"flowChartDisplay",w:1440.18,h:963.9},157:{text:"flowChartDelay",w:963.9,h:963.9},158:{text:"flowChartAlternateProcess",w:1440.18,h:963.9},159:{text:"flowChartOffpageConnector",w:963.9,h:963.9},160:{text:"actionButtonBlank",w:1644.3,h:1644.3},161:{text:"actionButtonHome",w:1644.3,h:1644.3},162:{text:"actionButtonHelp",w:1644.3,h:1644.3},163:{text:"actionButtonInformation",w:1644.3,h:1644.3},164:{text:"actionButtonForwardNext",w:1644.3,h:1644.3},165:{text:"actionButtonBackPrevious",w:1644.3,h:1644.3},166:{text:"actionButtonEnd",w:1644.3,h:1644.3},167:{text:"actionButtonBeginning",w:1644.3,h:1644.3},168:{text:"actionButtonReturn",w:1644.3,h:1644.3},169:{text:"actionButtonDocument",w:1644.3,h:1644.3},170:{text:"actionButtonSound",w:1644.3,h:1644.3},171:{text:"actionButtonMovie",w:1644.3,h:1644.3},172:{text:"gear6"},173:{text:"gear9"},174:{text:"funnel"},175:{text:"mathPlus"},176:{text:"mathMinus"},177:{text:"mathMultiply"},178:{text:"mathDivide"},179:{text:"mathEqual"},180:{text:"mathNotEqual"},181:{text:"cornerTabs"},182:{text:"squareTabs"},183:{text:"plaqueTabs"},184:{text:"chartX"},185:{text:"chartStar"},186:{text:"chartPlus"},187:{text:"textArchDown"},188:{text:"textArchDownPour"},189:{text:"textArchUp"},190:{text:"textArchUpPour"},191:{text:"textButton"},192:{text:"textButtonPour"},193:{text:"textCanDown"},194:{text:"textCanUp"},195:{text:"textCascadeDown"},196:{text:"textCascadeUp"},197:{text:"textChevron"},198:{text:"textChevronInverted"},199:{text:"textCircle"},200:{text:"textCirclePour"},201:{text:"textCurveDown"},202:{text:"textCurveUp"},203:{text:"textDeflate"},204:{text:"textDeflateBottom"},205:{text:"textDeflateInflate"},206:{text:"textDeflateInflateDeflate"},207:{text:"textDeflateTop"},208:{text:"textDoubleWave1"},209:{text:"textFadeDown"},210:{text:"textFadeLeft"},211:{text:"textFadeRight"},212:{text:"textFadeUp"},213:{text:"textInflate"},214:{text:"textInflateBottom"},215:{text:"textInflateTop"},216:{text:"textPlain"},217:{text:"textRingInside"},218:{text:"textRingOutside"},219:{text:"textSlantDown"},220:{text:"textSlantUp"},221:{text:"textStop"},222:{text:"textTriangle"},223:{text:"textTriangleInverted"},224:{text:"textWave1"},225:{text:"textWave2"},226:{text:"textWave4"},227:{text:"textNoShape"},231:{text:"shapeCustom"}};function C(e){var t={w:1440,h:1440};return T[e]&&(T[e].w&&(t.w=T[e].w),T[e].h&&(t.h=T[e].h)),t}function S(e){for(var t=Object.keys(T).length,n=0;n<t;++n){if(e===T[n].text)return n}return null}Object.freeze(T);var E={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9};Object.freeze(E);var P=["createLine","createConnectorArrow","createConnectorDoubleArrow","createCustomGeometryShape","createNormalShape","createTextBox","createHollowOutShape","createArcShape"];Object.freeze(P);var L=(_={},w()(_,E.LineGroup,{types:[0,95,95,97,97,97,101,101,101,231,231,231],funcIdx:[0,1,2,0,1,2,0,1,2,3,3,3],subTypes:[0,1,95,96,97,98,99,100,101,102,103,231],defaultFill:[0,1,95,96,97,98,99,100,101,102,103,231]}),w()(_,E.RectangleGroup,{types:[4,25,30,31,32,29,26,27,28],funcIdx:[4,4,4,4,4,4,4,4,4],subTypes:[4,25,26,27,28,29,30,31,32],defaultFill:[]}),w()(_,E.NormalGroup,{types:[4,4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],funcIdx:[5,5,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,6,6,4,6,4,4,4,4,4,6,6,6,4,4,4,4,4,4,4,7,7,7,7,7,7,7],subTypes:[4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],defaultFill:[88,89,90,91,92,93,94]}),w()(_,E.ArrowGroup,{types:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],funcIdx:[4,4,4,4,4,4,4,4,6,6,4,4,6,6,6,6,4,4,4,4,4,4,4,4,4,4,6],subTypes:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],defaultFill:[]}),w()(_,E.FormulaGroup,{types:[175,176,177,178,179,180],funcIdx:[4,4,4,4,6,6],subTypes:[175,176,177,178,179,180],defaultFill:[]}),w()(_,E.ProcessGroup,{types:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4],subTypes:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],defaultFill:[]}),w()(_,E.StarAndFlagGroup,{types:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],defaultFill:[]}),w()(_,E.CalloutGroup,{types:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],defaultFill:[]}),w()(_,E.ActionGroup,{types:[165,164,167,166,161,163,168,171,169,170,162,160],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[165,164,167,166,161,163,168,171,169,170,162,160],defaultFill:[]}),_);Object.freeze(L);var A=[b.ShapeLine,b.ShapeLineInverse,b.ShapeStraightConnector1];Object.freeze(A);var I=[b.ShapeBentConnector2,b.ShapeBentConnector3,b.ShapeBentConnector4,b.ShapeBentConnector5];Object.freeze(I);var R=[b.ShapeCurvedConnector2,b.ShapeCurvedConnector3,b.ShapeCurvedConnector4,b.ShapeCurvedConnector5];Object.freeze(R);var O={StraightLine:A,BentLine:I,CurveLine:R};Object.freeze(O);var M={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7};Object.freeze(M);var D={NoAutoFit:0,NormalAutoFit:1,AdvancedAutoFit:2};Object.freeze(D);var N=n(145),B=n.n(N),j=n(144),F=n.n(j),H=n(964),G=n(1698),U=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;s()(this,e),this.setMatrix(t,n,i,a,o,r)}return c()(e,[{key:"m11",value:function(){return this._m11}},{key:"m12",value:function(){return this._m12}},{key:"m21",value:function(){return this._m21}},{key:"m22",value:function(){return this._m22}},{key:"dx",value:function(){return this._dx}},{key:"dy",value:function(){return this._dy}},{key:"toString",value:function(){return"matrix("+this._m11+", "+this._m12+", "+this._m21+", "+this._m22+", "+this._dx+", "+this._dy+")"}},{key:"setMatrix",value:function(e,t,n,i,a,o){this._m11=e,this._m12=t,this._m21=n,this._m22=i,this._dx=a,this._dy=o}},{key:"setTranslate",value:function(e,t){this._dx=e,this._dy=t}},{key:"clone",value:function(){return new e(this._m11,this._m12,this._m21,this._m22,this._dx,this._dy)}},{key:"assign",value:function(t){return t instanceof e?(this.setMatrix(t._m11,t._m12,t._m21,t._m22,t._dx,t._dy),this):(console.error("matrix is no instanceof QMartix"),null)}},{key:"Map",value:function(e){if(e){if(e.isQPoint)return this.map_point(e);if(Object(H.f)(e)){var t=this.MAPDOUBLE(e.x,e.y),n=F()(t,2);return{x:n[0],y:n[1]}}if(e.isQLine);else{if(e.isQRect||e.isRect)return this.mapRect(e);if(e.isQPainterPath)return this.mapPainterPath(e);e.isQPolygon||e.isQRegion}}return console.error("Invalid argument for QMatrix.Map():",e),null}},{key:"map",value:function(e,t,n,i){return this.MAPINT(e,t,n,i)}},{key:"mapDouble",value:function(e,t,n,i){return this.MAPDOUBLE(e,t,n,i)}},{key:"map_path",value:function(e){if(0===e.length)return[];var t=[];if(1===this._m11&&1===this._m22&&0===this._m12&&0===this._m21)if(0!==this._dx||0!==this._dy)for(var n=0;n<e.length;++n){var i=e[n];if(i.type===G.d.Close)t.push(i);else{var a={type:i.type,x:i.x+this._dx,y:i.y+this._dy};t.push(a)}}else t=Object(H.d)(e);else for(var o=0;o<e.length;++o){var r=e[o],s=r.x,l=r.y;if(r.type===G.d.Close)t.push(r);else{var c={type:r.type,x:this._m11*s+this._m21*l+this._dx,y:this._m12*s+this._m22*l+this._dy};t.push(c)}}return t}},{key:"map_point",value:function(e){if(!e||!e.isQPoint)throw Error(e+" is not instanceof Point!");var t=e.x(),n=e.y(),i=e.clone();return i.setPoint(this._m11*t+this._m21*n+this._dx,this._m12*t+this._m22*n+this._dy),i}},{key:"mapContext",value:function(e){return e.transform&&e.transform(this._m11,this._m12,this._m21,this._m22,this._dx,this._dy),!0}},{key:"mapRect",value:function(e){if(!e||!e.isQRect&&!e.isRect)throw Error(e+" is not instanceof Rect!");var t=e.clone();if(0===this._m12&&0===this._m21){var n=this._m11*e.x()+this._dx,i=this._m22*e.y()+this._dy,a=this._m11*e.width(),o=this._m22*e.height();a<0&&(n-=a=-a),o<0&&(i-=o=-o),t.setRect(n,i,a,o)}else{var r=void 0,s=void 0,l=void 0,c=void 0,u=this.MAPDOUBLE(e.x(),e.y(),r,s),d=F()(u,2),h=r=d[0],p=s=d[1],f=r,g=s,v=this.MAPDOUBLE(e.x()+e.width(),e.y(),l,c),y=F()(v,2);l=y[0],c=y[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c);var m=this.MAPDOUBLE(e.x()+e.width(),e.y()+e.height(),l,c),_=F()(m,2);l=_[0],c=_[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c);var x=this.MAPDOUBLE(e.x(),e.y()+e.height(),l,c),w=F()(x,2);l=w[0],c=w[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c),t.setRect(h,p,f-h,g-p)}return t}},{key:"MAPINT",value:function(e,t,n,i){var a=e,o=t;return[Math.round(this._m11*a+this._m21*o+this._dx),Math.round(this._m12*a+this._m22*o+this._dy)]}},{key:"MAPDOUBLE",value:function(e,t,n,i){var a=e,o=t;return[this._m11*a+this._m21*o+this._dx,this._m12*a+this._m22*o+this._dy]}},{key:"scale",value:function(e,t){return this._m11*=e,this._m12*=e,this._m21*=t,this._m22*=t,this}},{key:"translate",value:function(e,t){return this._dx+=e*this._m11+t*this._m21,this._dy+=t*this._m22+e*this._m12,this}},{key:"rotate",value:function(e){var t=0,n=0;if(90===e||-270===e)t=1;else if(270===e||-90===e)t=-1;else if(180===e)n=-1;else{var i=e*Math.PI/180;t=Math.sin(i),n=Math.cos(i)}var a=n*this._m11+t*this._m21,o=n*this._m12+t*this._m22,r=-t*this._m11+n*this._m21,s=-t*this._m12+n*this._m22;return this._m11=a,this._m12=o,this._m21=r,this._m22=s,this}},{key:"shear",value:function(e,t){var n=t*this._m21,i=t*this._m22,a=e*this._m11,o=e*this._m12;return this._m11+=n,this._m12+=i,this._m21+=a,this._m22+=o,this}},{key:"isInvertible",value:function(){return!Object(H.k)(this._m11*this._m22-this._m12*this._m21)}},{key:"determinant",value:function(){return this._m11*this._m22-this._m12*this._m21}},{key:"invertible",value:function(){return 0!==this.determinant()}},{key:"inverted",value:function(){var t=this.determinant();if(0===t)return new e(1,0,0,1,0,0);var n=1/t;return new e(this._m22*n,-this._m12*n,-this._m21*n,this._m11*n,(this._m21*this._dy-this._m22*this._dx)*n,(this._m12*this._dx-this._m11*this._dy)*n)}},{key:"isEqualsTo",value:function(t){return e.isEquals(this,t)}},{key:"multiply",value:function(t){return e.multiply(this,t)}},{key:"*",value:function(e){var t=this._m11*e._m11+this._m12*e._m21,n=this._m11*e._m12+this._m12*e._m22,i=this._m21*e._m11+this._m22*e._m21,a=this._m21*e._m12+this._m22*e._m22,o=this._dx*e._m11+this._dy*e._m21+e._dx,r=this._dx*e._m12+this._dy*e._m22+e._dy;return this._m11=t,this._m12=n,this._m21=i,this._m22=a,this._dx=o,this._dy=r,this}},{key:"multiply2",value:function(t){return e.multiply2(this,t)}},{key:"mapPainterPath",value:function(e){if(!e||!e.isQPainterPath||e.isEmpty())return e;var t=e.clone();t.setDirty(!0);for(var n=t.data,i=0,a=t.elementCount();i<a;++i){var o=n.elements[i],r=this.map_point(o.toPoint());o.x=r.x(),o.y=r.y()}return t}},{key:"isQMatrix",get:function(){return!0}}],[{key:"SetMatrixFromMartix",value:function(t){return t instanceof e?t.clone():(console.error("matrix is no instanceof Qmartix"),null)}},{key:"inverted",value:function(e){return e.inverted()}},{key:"isEquals",value:function(e,t){return e._m11===t._m11&&e._m12===t._m12&&e._m21===t._m21&&e._m22===t._m22&&e._dx===t._dx&&e._dy===t._dy}},{key:"multiply",value:function(t,n){return new e(t._m11*n._m11+t._m21*n._m12+0,t._m12*n._m11+t._m22*n._m12+0,t._m11*n._m21+t._m21*n._m22+0,t._m12*n._m21+t._m22*n._m22+0,t._m11*n._dx+t._m21*n._dy+t._dx,t._m12*n._dx+t._m22*n._dy+t._dy)}},{key:"multiply2",value:function(t,n){return e.multiply(n,t)}}]),e}();window.QMatrix=U;var W=function(){function e(t,n){s()(this,e),this.setPoint(t,n)}return c()(e,[{key:"clone",value:function(){return new e(this._x,this._y)}},{key:"x",value:function(){return this._x}},{key:"y",value:function(){return this._y}},{key:"setX",value:function(e){this._x=e}},{key:"setY",value:function(e){this._y=e}},{key:"setPoint",value:function(e,t){return this._x=e||0,this._y=t||0,this}},{key:"assign",value:function(e){return this._x=e._x,this._y=e._y,this}},{key:"setFromPoint",value:function(t){t instanceof e?(this._x=t.x(),this._y=t.y()):console.error(t+" is no instanceof Point")}},{key:"toPoint",value:function(){return new e(Math.round(this._x),Math.round(this._y))}},{key:"isNull",value:function(){return Object(H.l)(this._y)&&Object(H.l)(this._y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x())+Math.abs(this.y())}},{key:"rotationAt",value:function(t,n){if(n&&0!==n&&360!==n){var i=Math.PI*n/180;return new e((this.x()-t.x())*Math.cos(i)-(this.y()-t.y())*Math.sin(i)+t.x(),(this.x()-t.x())*Math.sin(i)+(this.y()-t.y())*Math.cos(i)+t.y())}return new e(this.x(),this.y())}},{key:"isEquals",value:function(t){if(t instanceof e)return Object(H.k)(this.x()-t.x())&&Object(H.k)(this.y()-t.y());throw new Error(this+","+t+" is not Point")}},{key:"addition",value:function(t){return e["+"](this,t)}},{key:"subtracter",value:function(t){return e["-"](this,t)}},{key:"multiply",value:function(t){return e["*"](t,this)}},{key:"division",value:function(t){return e["*"](this,t)}},{key:"isQPoint",get:function(){return!0}}],[{key:"+",value:function(t,n){if(t instanceof e&&n instanceof e)return new e(t.x()+n.x(),t.y()+n.y());throw new Error(t+","+n+" is not Point")}},{key:"-",value:function(t,n){if(t instanceof e&&n instanceof e)return new e(t.x()-n.x(),t.y()-n.y());throw new Error(t+","+n+" is not Point")}},{key:"*",value:function(t,n){if(n instanceof e&&"number"==typeof t)return new e(n.x()*t,n.y()*t);if(t instanceof e&&"number"==typeof n)return new e(t.x()*n,t.y()*n);throw new Error(n+" is not Point")}},{key:"==",value:function(t,n){if(t instanceof e&&n instanceof e)return Object(H.k)(t.x()-n.x())&&Object(H.k)(t.y()-n.y());throw new Error(t+","+n+" is not Point")}},{key:"/",value:function(t,n){if(t instanceof e&&"number"==typeof n)return new e(t.x()/n,t.y()/n);throw new Error(t+" is not Point")}}]),e}();function Y(e,t,n){return(t.x-e.x)*(n.y()-e.y)-(n.x()-e.x)*(t.y-e.y)}function z(e){return e&&e.isQPoint?{x:e.x(),y:e.y()}:Object(H.f)(e)?e:void 0}window.Point=W;var X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;s()(this,e),this.setRect(t,n,i,a)}return c()(e,[{key:"clone",value:function(){return new e(this.xp,this.yp,this.w,this.h)}},{key:"setRect",value:function(e,t,n,i){this.xp=e,this.yp=t,this.w=n,this.h=i}},{key:"setCoords",value:function(e,t,n,i){this.assignCoords(e,t,n,i)}},{key:"getRect",value:function(){return{x:this.x(),y:this.y(),width:this.width(),height:this.height()}}},{key:"getRoundRect",value:function(){return{x:Math.round(this.x()),y:Math.round(this.y()),width:Math.round(this.width()),height:Math.round(this.height())}}},{key:"getAlignedRect",value:function(){return{x:Math.floor(this.x()),y:Math.floor(this.y()),width:Math.ceil(this.width()),height:Math.ceil(this.height())}}},{key:"getAlignedBounds",value:function(){return{left:Math.floor(this.left()),top:Math.floor(this.top()),right:Math.ceil(this.right()),bottom:Math.ceil(this.bottom())}}},{key:"getCoords",value:function(){return{x1:this.x(),y1:this.y(),x2:this.right(),y2:this.bottom()}}},{key:"getBounds",value:function(){return{left:this.left(),top:this.top(),right:this.right(),bottom:this.bottom()}}},{key:"topLeft",value:function(){return new W(this.xp,this.yp)}},{key:"bottomRight",value:function(){return new W(this.xp+this.w,this.yp+this.h)}},{key:"topRight",value:function(){return new W(this.xp+this.w,this.yp)}},{key:"bottomLeft",value:function(){return new W(this.xp,this.yp+this.h)}},{key:"width",value:function(){return this.w}},{key:"height",value:function(){return this.h}},{key:"left",value:function(){return this.xp}},{key:"right",value:function(){return this.xp+this.w}},{key:"x",value:function(){return this.xp}},{key:"y",value:function(){return this.yp}},{key:"top",value:function(){return this.yp}},{key:"bottom",value:function(){return this.yp+this.h}},{key:"size",value:function(){return this.width()*this.height()}},{key:"center",value:function(){return new W(this.xp+this.w/2,this.yp+this.h/2)}},{key:"setWidth",value:function(e){this.w=e}},{key:"setHeight",value:function(e){this.h=e}},{key:"setSize",value:function(e){this.w=e.width,this.h=e.height}},{key:"setLeft",value:function(e){var t=e-this.xp;this.xp+=t,this.w-=t}},{key:"setRight",value:function(e){this.w=e-this.xp}},{key:"setBottom",value:function(e){this.h=e-this.yp}},{key:"setTop",value:function(e){var t=e-this.yp;this.yp+=t,this.h-=t}},{key:"setTopLeft",value:function(e){this.setLeft(e.x()),this.setTop(e.y())}},{key:"setBottomRight",value:function(e){this.setRight(e.x()),this.setBottom(e.y())}},{key:"setTopRight",value:function(e){this.setRight(e.x()),this.setTop(e.y())}},{key:"setBottomLeft",value:function(e){this.setLeft(e.x()),this.setBottom(e.y())}},{key:"setOffset",value:function(e,t){this.xp+=e,this.yp+=t}},{key:"setOff",value:function(t,n){return new e(this.xp+t,this.yp+n,this.w,this.h)}},{key:"adjust",value:function(e,t,n,i){var a=this.xp+e,o=this.yp+t,r=this.xp+this.w+n,s=this.yp+this.h+i;return this.setCoords(a,o,r,s),this}},{key:"adjusted",value:function(e,t,n,i){return this.clone().adjust(e,t,n,i)}},{key:"assign",value:function(e){return e&&(e.isQRect||e.isRect)?(this.xp=e.x(),this.yp=e.y(),this.w=e.width(),this.h=e.height()):console.error(e+" is not instacneof Rect check!"),this}},{key:"assignCoords",value:function(e,t,n,i){return this.xp=e,this.yp=t,this.w=n-e,this.h=i-t,this}},{key:"rotationAtCenter",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n||this.center(),a=this.topLeft().rotationAt(i,t),o=this.topRight().rotationAt(i,t),r=this.bottomRight().rotationAt(i,t),s=this.bottomLeft().rotationAt(i,t),l=Math.min(a.x(),o.x(),r.x(),s.x()),c=Math.max(a.x(),o.x(),r.x(),s.x()),u=Math.min(a.y(),o.y(),r.y(),s.y()),d=Math.max(a.y(),o.y(),r.y(),s.y());return new e(l,u,c-l,d-u)}},{key:"isInside",value:function(e){var t=this.xp,n=this.yp,i=this.xp+this.w,a=this.yp+this.h,o={x:t,y:n},r={x:t,y:a},s={x:i,y:a},l={x:i,y:n};return Y(o,r,e)*Y(s,l,e)>=0&&Y(r,s,e)*Y(l,o,e)>=0}},{key:"isNull",value:function(){return 0===this.w&&0===this.h}},{key:"isEmpty",value:function(){return this.w<=0||this.h<=0}},{key:"isValid",value:function(){return this.w>0&&this.h>0}},{key:"moveLeft",value:function(e){this.xp=e}},{key:"moveRight",value:function(e){this.xp=e-this.w}},{key:"moveTop",value:function(e){this.yp=e}},{key:"moveBottom",value:function(e){this.yp=e-this.h}},{key:"moveTo",value:function(e){var t=z(e);t&&(this.xp=t.x,this.yp=t.y)}},{key:"moveTopLeft",value:function(e){var t=z(e);t&&(this.moveLeft(t.x),this.moveTop(t.y))}},{key:"moveBottomRight",value:function(e){var t=z(e);t&&(this.moveRight(t.x),this.moveBottom(t.y))}},{key:"moveTopRight",value:function(e){var t=z(e);t&&(this.moveRight(t.x),this.moveTop(t.y))}},{key:"moveBottomLeft",value:function(e){var t=z(e);t&&(this.moveLeft(t.x),this.moveBottom(t.y))}},{key:"moveCenter",value:function(e){var t=z(e);t&&(this.xp=t.x-this.w/2,this.yp=t.y-this.h/2)}},{key:"translate",value:function(e){var t=z(e);return t&&(this.xp+=t.x,this.yp+=t.y),this}},{key:"translated",value:function(e){return this.clone().translate(e)}},{key:"scale",value:function(e,t){return this.xp*=e,this.yp*=t,this.w*=e,this.h*=t,this}},{key:"scaled",value:function(e,t){return this.clone().scale(e,t)}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=z(e),i=this.xp,a=this.yp,o=this.w,r=this.h,s=i,l=i;if(o<0?s+=o:l+=o,t){if(n.x<=s||n.x>=l)return!1}else if(n.x<s||n.x>l)return!1;var c=a,u=a;if(r<0?c+=r:u+=r,c===u)return!1;if(t){if(n.y<=c||n.y>=u)return!1}else if(n.y<c||n.y>u)return!1;return!0}},{key:"containsRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isNull()||e.isNull())return!1;var n=this.xp,i=this.yp,a=this.w,o=this.h,r=n,s=n;a<0?r+=a:s+=a;var l=e.xp,c=e.xp;if(e.w<0?l+=e.w:c+=e.w,t){if(l<=r||c>=s)return!1}else if(l<r||c>s)return!1;var u=i,d=i;o<0?u+=o:d+=o;var h=e.yp,p=e.yp;if(e.h<0?h+=e.h:p+=e.h,t){if(h<=u||p>=d)return!1}else if(h<u||p>d)return!1;return!0}},{key:"contains",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isQRect)return this.containsRect(t,n);if(t.isRect)return this.containsRect(new e(t.x(),t.y(),t.width(),t.height()),n);if(t.isQPoint||Object(H.f)(t))return this.containsPoint(t,n);if(t){if(t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height"))return this.containsRect(new e(t.x,t.y,t.width,t.height),n);if(t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom"))return this.containsRect(new e(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1),n);if(t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2"))return this.containsRect(new e(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),n)}return!1}},{key:"unite",value:function(e){if(this.isNull())return this.assign(e);if(e.isNull())return this;var t=this.xp,n=this.yp,i=this.w,a=this.h,o=t,r=t;i<0?o+=i:r+=i,e.w<0?(o=Math.min(o,e.xp+e.w),r=Math.max(r,e.xp)):(o=Math.min(o,e.xp),r=Math.max(r,e.xp+e.w));var s=n,l=n;return a<0?s+=a:l+=a,e.h<0?(s=Math.min(s,e.yp+e.h),l=Math.max(l,e.yp)):(s=Math.min(s,e.yp),l=Math.max(l,e.yp+e.h)),this.xp=o,this.yp=s,this.w=r-o,this.h=l-s,this}},{key:"intersect",value:function(e){var t=this.xp,n=this.yp,i=this.w,a=this.h,o=t,r=t;if(i<0?o+=i:r+=i,o===r)return this.assignCoords(0,0,0,0);var s=e.xp,l=e.xp;if(e.w<0?s+=e.w:l+=e.w,s===l)return this.assignCoords(0,0,0,0);if(o>=l||s>=r)return this.assignCoords(0,0,0,0);var c=n,u=n;if(a<0?c+=a:u+=a,c===u)return this.assignCoords(0,0,0,0);var d=e.yp,h=e.yp;return e.h<0?d+=e.h:h+=e.h,d===h||c>=h||d>=u?this.assignCoords(0,0,0,0):(this.xp=Math.max(o,s),this.yp=Math.max(c,d),this.w=Math.min(r,l),this.h=Math.min(u,h),this)}},{key:"intersects",value:function(e){var t=this.xp,n=this.yp,i=this.w,a=this.h,o=t,r=t;if(i<0?o+=i:r+=i,o===r)return!1;var s=e.xp,l=e.xp;if(e.w<0?s+=e.w:l+=e.w,s===l)return!1;if(o>=l||s>=r)return!1;var c=n,u=n;if(a<0?c+=a:u+=a,c===u)return!1;var d=e.yp,h=e.yp;return e.h<0?d+=e.h:h+=e.h,d!==h&&!(c>=h||d>=u)}},{key:"isEquals",value:function(t){return e.isEquals(this,t)}},{key:"isQRect",get:function(){return!0}}],[{key:"create",value:function(t){var n=new e;return t&&(t.isQRect?n.assign(t):t.isRect?n.setRect(t.x(),t.y(),t.width(),t.height()):t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height")?n.setRect(t.x,t.y,t.width,t.height):t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom")?n.setRect(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1):t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2")&&n.setRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),n}},{key:"setFromPoint",value:function(t,n){var i=new e;return i.setCoords(t.x(),t.y(),n.x(),n.y()),i}},{key:"unite",value:function(e,t){return e.clone().unite(t)}},{key:"intersect",value:function(e,t){return e.clone().intersect(t)}},{key:"isEquals",value:function(e,t){return Object(H.j)(e.xp,t.xp)&&Object(H.j)(e.yp,t.yp)&&Object(H.j)(e.w,t.w)&&Object(H.j)(e.h,t.h)}}]),e}();window.Rect=X;var V=n(8),q=n.n(V);function K(e,t){var n=e.x1,i=e.y1,a=e.x2,o=e.y2,r=e.x3,s=e.y3,l=1-t,c=n*l+a*t,u=a*l+r*t,d=i*l+o*t,h=o*l+s*t;return{x:(c=c*l+u*t)*l+(u=u*l+(r*l+e.x4*t)*t)*t,y:(d=d*l+h*t)*l+(h=h*l+(s*l+e.y4*t)*t)*t}}function Q(e,t,n){var i=e.x1,a=e.y1,o=e.x2,r=e.y2,s=e.x3,l=e.y3,c=e.x4,u=e.y4,d=.5*(o+s);t.x2=.5*(i+o),n.x3=.5*(s+c),t.x1=i,n.x4=c,t.x3=.5*(t.x2+d),n.x2=.5*(n.x3+d),t.x4=n.x1=.5*(t.x3+n.x2),d=(r+l)/2,t.y2=.5*(a+r),n.y3=.5*(l+u),t.y1=a,n.y4=u,t.y3=.5*(t.y2+d),n.y2=.5*(n.y3+d),t.y4=n.y1=.5*(t.y3+n.y2)}function J(e,t,n){for(var i=new Array(10),a=0;a<i.length;a++)i[a]={x1:0,y1:0,x2:0,y2:0,x3:0,y3:0,x4:0,y4:0};var o=new Array(10);i[0]=e,o[0]=9;for(var r=0,s=0,l=window.Point;r>=0;){var c=i[r],u=c.y4-c.y1,d=c.x4-c.x1,h=Math.abs(d)+Math.abs(u),p=void 0;h>1?p=Math.abs(d*(c.y1-c.y2)-u*(c.x1-c.x2))+Math.abs(d*(c.y1-c.y3)-u*(c.x1-c.x3)):(p=Math.abs(c.x1-c.x2)+Math.abs(c.y1-c.y2)+Math.abs(c.x1-c.x3)+Math.abs(c.y1-c.y3),h=1),p<n*h||0===o[s]?(t.push(new l(c.x4,c.y4)),--r,--s):(Q(c,i[r+1],c),o[s+1]=--o[s],++r,++s)}}var Z=function(){function e(){s()(this,e),this.setBezier(0,0,0,0,0,0,0,0)}return c()(e,[{key:"clone",value:function(){var t=new e;return t.setBezier(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3,this.x4,this.y4),t}},{key:"setBezier",value:function(e,t,n,i,a,o,r,s){this.x1=e,this.y1=t,this.x2=n,this.y2=i,this.x3=a,this.y3=o,this.x4=r,this.y4=s}},{key:"assign",value:function(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this.x4=e.x4,this.y4=e.y4,this}},{key:"bezierOnInterval",value:function(t,n){if(0===t&&1===n)return this;var i=new e;this.parameterSplitLeft(t,i);var a=(n-t)/(1-t);return this.parameterSplitLeft(a,i),i}},{key:"parameterSplitLeft",value:function(e,t){t.x1=this.x1,t.y1=this.y1,t.x2=this.x1+e*(this.x2-this.x1),t.y2=this.y1+e*(this.y2-this.y1),t.x3=this.x2+e*(this.x3-this.x2),t.y3=this.y2+e*(this.y3-this.y2),this.x3=this.x3+e*(this.x4-this.x3),this.y3=this.y3+e*(this.y4-this.y3),this.x2=t.x3+e*(this.x3-t.x3),this.y2=t.y3+e*(this.y3-t.y3),t.x3=t.x2+e*(t.x3-t.x2),t.y3=t.y2+e*(t.y3-t.y2),t.x4=this.x1=t.x3+e*(this.x2-t.x3),t.y4=this.y1=t.y3+e*(this.y2-t.y3)}},{key:"pt1",value:function(){return new W(this.x1,this.y1)}},{key:"pt2",value:function(){return new W(this.x2,this.y2)}},{key:"pt3",value:function(){return new W(this.x3,this.y3)}},{key:"pt4",value:function(){return new W(this.x4,this.y4)}},{key:"pointAt",value:function(e){var t=K(this,e),n=t.x,i=t.y;return new W(n,i)}},{key:"addToPolygon",value:function(e,t){J(this,e,t)}},{key:"split",value:function(e,t){Q(this,e,t)}},{key:"bounds",value:function(){var e=this.x1,t=this.x2,n=this.x3,i=this.x4,a=this.y1,o=this.y2,r=this.y3,s=this.y4,l=e,c=e;t<l?l=t:t>c&&(c=t),n<l?l=n:n>c&&(c=n),i<l?l=i:i>c&&(c=i);var u=a,d=a;return o<u?u=o:o>d&&(d=o),r<u?u=r:r>d&&(d=r),s<u?u=s:s>d&&(d=s),new X(l,u,c-l,d-u)}},{key:"isQBezier",get:function(){return!0}}],[{key:"createBezierFromPoints",value:function(t){if(t&&!(t.length<4)){var n=e.calculateControlPoints(t[0],t[1],t[2]).c2,i=e.calculateControlPoints(t[1],t[2],t[3]).c1;return e.fromPoints(new W(t[0].x,t[0].y),n,i,new W(t[2].x,t[2].y))}}},{key:"fromPoints",value:function(t,n,i,a){var o=new e;return o.x1=t.x(),o.y1=t.y(),o.x2=n.x(),o.y2=n.y(),o.x3=i.x(),o.y3=i.y(),o.x4=a.x(),o.y4=a.y(),o}},{key:"calculateControlPoints",value:function(e,t,n){var i=e.x-t.x,a=e.y-t.y,o=t.x-n.x,r=t.y-n.y,s=(e.x+t.x)/2,l=(e.y+t.y)/2,c=(t.x+n.x)/2,u=(t.y+n.y)/2,d=Math.sqrt(i*i+a*a),h=Math.sqrt(o*o+r*r),p=h/(d+h),f=c+(s-c)*p,g=u+(l-u)*p,v=t.x-f,y=t.y-g;return{c1:new W(s+v,l+y),c2:new W(c+v,u+y)}}}]),e}();window.QBezier=Z;function $(e,t,n,i,a){a=0;var o=e.x(),r=e.y(),s=e.width(),l=e.width()/2,c=.5522847498*l,u=e.height(),d=e.height()/2,h=.5522847498*d,p=[new window.Point(o+s,r+d),new window.Point(o+s,r+d+h),new window.Point(o+l+c,r+u),new window.Point(o+l,r+u),new window.Point(o+l-c,r+u),new window.Point(o,r+d+h),new window.Point(o,r+d),new window.Point(o,r+d-h),new window.Point(o+l-c,r),new window.Point(o+l,r),new window.Point(o+l+c,r),new window.Point(o+s,r+d-h),new window.Point(o+s,r+d)];if(n>360?n=360:n<-360&&(n=-360),0===t){if(360===n){for(var f=11;f>=0;--f)i[a++]=p[f];return[p[12],a]}if(-360===n){for(var g=1;g<=12;++g)i[a++]=p[g];return[p[0],a]}}var v=parseInt(Math.floor(t/90),10),y=parseInt(Math.floor((t+n)/90),10),m=(t-90*v)/90,_=(t+n-90*y)/90,x=n>0?1:-1;x<0&&(m=1-m,_=1-_),Object(H.k)(m-1)&&(m=0,v+=x),Object(H.k)(_)&&(_=1,y-=x),m=ee(90*m),_=ee(90*_);var w=!Object(H.k)(m),k=!Object(H.k)(_-1),b=y+x;if(v===b){var T=3*(3-(v%4+4)%4);return[x>0?p[T+3]:p[T],a]}var C=new window.Point,S=new window.Point;!function(e,t,n,i,a){if(e.isNull())return;for(var o=e.width()/2,r=e.height()/2,s=[t,t+n],l=[i,a],c=window.Point,u=0;u<2;++u)if(l[u]){var d=(s[u]-360*Math.floor(s[u]/360))/90,h=parseInt(Math.floor(d),10);d=ee(90*(d-=h)),1&h&&(d=1-d);var p=void 0,f=void 0,g=void 0,v=void 0,y=te(d,p,f,g,v),m=F()(y,4);p=m[0],f=m[1],g=m[2],v=m[3];var _=new window.Point(p+f+.5522847498*g,v+g+.5522847498*f);1!==h&&2!==h||_.setX(-_.x()),0!==h&&1!==h||_.setY(-_.y()),l[u].setFromPoint(c["+"](e.center(),new window.Point(o*_.x(),r*_.y())))}}(e,t,n,C,S);for(var E=window.QBezier,P=v;P!==b;P+=x){var L=3*(3-(P%4+4)%4),A=void 0;if(A=x>0?E.fromPoints(p[L+3],p[L+2],p[L+1],p[L]):E.fromPoints(p[L],p[L+1],p[L+2],p[L+3]),v===y&&Object(H.j)(m,_))return[C,a];P===v?P===y&&k?A=A.bezierOnInterval(m,_):w&&(A=A.bezierOnInterval(m,1)):P===y&&k&&(A=A.bezierOnInterval(0,_)),i[a++]=A.pt2(),i[a++]=A.pt3(),i[a++]=A.pt4()}return i[a-1]=S,[C,a]}function ee(e){if(Object(H.k)(e))return 0;if(Object(H.j)(e,90))return 1;var t=Math.PI*e/180,n=Math.cos(t),i=Math.sin(t),a=e/90;a-=(((2-3*.5522847498)*a+3*-.4477152502)*a*a+1-n)/(((6-4.9705627482)*a+6*-.4477152502)*a);var o=a-=(((2-3*.5522847498)*a+3*-.4477152502)*a*a+1-n)/(((6-4.9705627482)*a+6*-.4477152502)*a);return o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-i)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498),.5*(a+(o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-i)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498)))}function te(e,t,n,i,a){var o=1-e;return a=(i=e*e)*e,[(n=o*o)*o,n*=3*e,i*=3*o,a]}var ne=n(8838),ie=0,ae=1,oe=2,re=3,se=4,le=0,ce=1,ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ie,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s()(this,e),this.x=t,this.y=n,this.type=i,this.isClosed=a}return c()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.type)}},{key:"isMoveTo",value:function(){return this.type===ie}},{key:"isLineTo",value:function(){return this.type===ae}},{key:"isCurveTo",value:function(){return this.type===oe}},{key:"toPoint",value:function(){return new W(this.x,this.y)}},{key:"isEquals",value:function(e){return e&&e.isElement===this.isElement&&Object(H.j)(this.x,e.x())&&Object(H.j)(this.y,e.y())&&this.type===e.type}},{key:"isElement",get:function(){return!0}}]),e}();function de(e){return e.isQPoint?{x:e.x(),y:e.y()}:e}function he(e){return!e.isQPoint&&Object(H.f)(e)?new W(e.x,e.y):e}var pe=function(){function e(){s()(this,e),this.cStart=0,this.fillRule=le,this.dirtyBounds=!1,this.dirtyControlBounds=!1,this.pathConverter=null,this.require_moveTo=!1,this.convex=!1,this.bounds=new X,this.controlBounds=new X,this.elements=[],this.elements.push(new ue)}return c()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){var t,n;return this.cStart=e.cStart,this.fillRule=e.fillRule,this.dirtyBounds=e.dirtyBounds,this.dirtyControlBounds=e.dirtyControlBounds,this.pathConverter=null,this.require_moveTo=!1,this.convex=e.convex,this.bounds=e.bounds.clone(),this.controlBounds=e.controlBounds.clone(),this.elements=(t=e.elements,n=[],t.forEach((function(e){return n.push(e.clone())})),n),this}},{key:"isClosed",value:function(){var e=this.elements.length,t=this.elements[this.cStart],n=this.elements[e-1];return Ce(t.x-n.x)&&Ce(t.y-n.y)}},{key:"close",value:function(){this.require_moveTo=!0;var e=this.elements.length,t=this.elements[this.cStart],n=this.elements[e-1];t.x!==n.x||t.y!==n.y?Object(H.j)(t.x,n.x)&&Object(H.j)(t.y,n.y)?(n.x=t.x,n.y=t.y):this.elements.push(new ue(t.x,t.y,ae,!0)):!n.isClosed&&Object(H.j)(t.x,n.x)&&Object(H.j)(t.y,n.y)&&this.elements.push(new ue(t.x,t.y,se,!0))}},{key:"maybeMoveTo",value:function(){if(this.require_moveTo){var e=this.elements.length,t=this.elements[e-1].clone();t.type=ie,this.elements.push(t),this.require_moveTo=!1}}},{key:"getPathElementAt",value:function(e){return this.elements[e]}},{key:"length",get:function(){return this.elements.length}}]),e}(),fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;s()(this,e),this.data=null,t&&(this.data=new pe,this.data.elements.push(new ue(t.x,t.y,ie)))}return c()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){return this.data=e.data?e.data.clone():null,this}},{key:"isEmpty",value:function(){return!this.data||1===this.data.elements.length&&this.data.elements[0].type===ie}},{key:"elementCount",value:function(){return this.data?this.data.elements.length:0}},{key:"elementAt",value:function(e){if(this.data)return this.data.elements[e]}},{key:"fillRule",value:function(){return this.isEmpty()?le:this.data.fillRule}},{key:"setFillRule",value:function(e){this.ensureData(),this.data.fillRule=e}},{key:"addRect",value:function(e){if(isFinite(e.x())&&isFinite(e.y())&&isFinite(e.width())&&isFinite(e.height())&&!e.isNull()){this.ensureData(),this.setDirty(!0);var t=this.data.elements.length<2;this.moveTo(e.x(),e.y()),this.data.elements.push(new ue(e.x()+e.width(),e.y(),ae)),this.data.elements.push(new ue(e.x()+e.width(),e.y()+e.height(),ae)),this.data.elements.push(new ue(e.x(),e.y()+e.height(),ae)),this.data.elements.push(new ue(e.x(),e.y(),ae)),this.data.require_moveTo=!0,this.data.convex=t}}},{key:"moveTo",value:function(){var e=arguments,t=void 0,n=void 0;if(1===e.length){var i=de(e[0]);t=i.x,n=i.y}else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=e[0],n=e[1]}if(isFinite(t)&&isFinite(n)){this.ensureData(),this.setDirty(!0);var a=this.data;a.require_moveTo=!1;var o=this.data.elements.length,r=a.elements[o-1];r.type===ie?(r.x=t,r.y=n):a.elements.push(new ue(t,n,ie)),a.cStart=a.elements.length-1}else console.error("Invalid argument for painterPath lineTo!")}},{key:"lineTo",value:function(){var e=arguments,t=void 0;if(1===e.length)t=he(e[0]);else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=new W(e[0],e[1])}if(t.isQPoint&&isFinite(t.x())&&isFinite(t.y())){this.ensureData(),this.setDirty(!0);var n=this.data,i=this.data.elements.length;if(i>0){if(n.maybeMoveTo(),t.isEquals(n.elements[i-1].toPoint()))return;var a=new ue(t.x(),t.y(),ae);n.elements.push(a),n.convex=3===n.elements.length||4===n.elements.length&&n.isClosed()}}else console.error("Invalid argument for painterPath lineTo!")}},{key:"quadTo",value:function(){var e=void 0,t=void 0,n=arguments;if(2===n.length?(e=n[0],t=n[1]):4===n.length?(e=new W(n[0]),t=new W(n[1])):console.error("Invalid argument for painterPath quadTo!"),e.isQPoint&&t.isQPoint){this.ensureData(),this.setDirty(!0);var i=this.data,a=Object(ne.last)(i.elements),o=new W(a.x,a.y);if(!o.isEquals(e)||!e.isEquals(t)){var r=new W((o.x()+2*e.x())/3,(o.y()+2*e.y())/3),s=new W((t.x()+2*e.x())/3,(t.y()+2*e.y())/3);this.cubicTo(r,s,t)}}else console.error("Invalid argument for painterPath quadTo!")}},{key:"cubicTo",value:function(){var e=void 0,t=void 0,n=void 0,i=arguments;if(3===i.length)e=i[0],t=i[1],n=i[2];else{if(6!==i.length)return;e=new W(i[0],i[1]),t=new W(i[2],i[3]),n=new W(i[4],i[5])}if(e.isQPoint&&t.isQPoint&&n.isQPoint){this.ensureData(),this.setDirty(!0);var a=this.data;Object(ne.last)(a.elements).toPoint().isEquals(e)&&e.isEquals(t)&&t.isEquals(n)||(a.maybeMoveTo(),a.elements.push(new ue(e.x(),e.y(),oe)),a.elements.push(new ue(t.x(),t.y(),re)),a.elements.push(new ue(n.x(),n.y(),re)))}}},{key:"bezierCurveTo",value:function(){this.cubicTo.apply(this,arguments)}},{key:"quadraticCurveTo",value:function(){this.quadTo.apply(this,arguments)}},{key:"arcTo",value:function(){}},{key:"ellipse",value:function(e,t,n,i){this.addEllipse(new X(e-n,t-i,2*n,2*i))}},{key:"addEllipse",value:function(e){if(e&&e.isQRect&&!e.isNull()&&Object(H.n)(e.x())&&!isNaN(e.x())&&Object(H.n)(e.y())&&!isNaN(e.y())&&Object(H.n)(e.height())&&!isNaN(e.height())&&Object(H.n)(e.width())&&!isNaN(e.width())){this.ensureData(),this.setDirty(!0);var t=this.data,n=t.elements.length<2,i=[],a=$(e,0,-360,i,void 0),o=F()(a,1)[0];this.moveTo(o),this.cubicTo(i[0],i[1],i[2]),this.cubicTo(i[3],i[4],i[5]),this.cubicTo(i[6],i[7],i[8]),this.cubicTo(i[9],i[10],i[11]),t.require_moveTo=!0,t.convex=n}else console.error("QPainterPath::addEllipse: Adding ellipse where a parameter is NaN or Inf, ignoring call")}},{key:"closeSubpath",value:function(){this.isEmpty()||(this.setDirty(!0),this.data.close())}},{key:"boundingRect",value:function(){return this.data?(this.data.dirtyBounds&&this.computeBoundingRect(),this.data.bounds):new X}},{key:"ensureData",value:function(){this.data||(this.data=new pe)}},{key:"detach",value:function(){this.setDirty(!0)}},{key:"setDirty",value:function(e){this.data.dirtyBounds=e,this.data.dirtyControlBounds=e,this.data.pathConverter=null,this.data.convex=!1}},{key:"computeBoundingRect",value:function(){var e=this.data;e.dirtyBounds=!1;var t=void 0,n=void 0,i=void 0,a=void 0;t=n=e.elements[0].x,i=a=e.elements[0].y;for(var o=1;o<e.elements.length;++o){var r=e.elements[o];switch(r.type){case ie:case ae:r.x>n?n=r.x:r.x<t&&(t=r.x),r.y>a?a=r.y:r.y<i&&(i=r.y);break;case oe:var s=e.elements[o-1],l=e.elements[o+1],c=e.elements[o+2],u=_e({x1:s.x,y1:s.y,x2:r.x,y2:r.y,x3:l.x,y3:l.y,x4:c.x,y4:c.y}),d=u.right(),h=u.bottom();u.x()<t&&(t=u.x()),d>n&&(n=d),u.y()<i&&(i=u.y()),h>a&&(a=h),o+=2}}e.bounds=new X(t,i,n-t,a-i)}},{key:"contains",value:function(e){return e&&e.isQRect?this.containsRect(e):e&&e.isQPoint?this.containsPoint(e):void console.error("Invalid argument for painterPath contains!")}},{key:"containsPointNearly",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!e||!e.isQPoint)return!1;if(this.containsPoint(e))return!0;var n=new X(e.x()-t,e.y()-t,2*t,2*t);return!!(this.containsPoint(n.topLeft())||this.containsPoint(n.topRight())||this.containsPoint(n.bottomRight())||this.containsPoint(n.bottomLeft()))||void 0}},{key:"containsPoint",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;for(var t=this.data,n=0,i=new W,a=new W,o=0;o<t.elements.length;++o){var r=t.elements[o].toPoint();switch(t.elements[o].type){case ie:o>0&&(n=be(i,a,e,n)),a=i=r;break;case ae:n=be(i,r,e,n),i=r;break;case oe:var s=t.elements[++o].toPoint(),l=t.elements[++o].toPoint();n=Te(Z.fromPoints(i,r,s,l),e,n),i=l}}return i!==a&&(n=be(i,a,e,n)),t.fillRule===ce?0!==n:n%2!=0}},{key:"containsRect",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;if(function(e,t){for(var n=new W,i=new W,a=0;a<e.elementCount();++a){var o=e.elementAt(a);switch(o.type){case ie:if(a>0&&Object(H.j)(n.x(),i.x())&&Object(H.j)(n.y(),i.y())&&xe(n.x(),n.y(),i.x(),i.y(),t))return!0;i=n=o.toPoint();break;case ae:if(xe(n.x(),n.y(),o.x,o.y,t))return!0;n=o.toPoint();break;case oe:var r=e.elementAt(++a).toPoint(),s=e.elementAt(++a).toPoint(),l=Z.fromPoints(n,o,r,s);if(we(l,t.top(),t.left(),t.right())||we(l,t.bottom(),t.left(),t.right())||ke(l,t.left(),t.top(),t.bottom())||ke(l,t.right(),t.top(),t.bottom()))return!0;n=s}}if(n!==i&&xe(n.x(),n.y(),i.x(),i.y(),t))return!0;return!1}(this,e)){if(this.fillRule()===le)return!1;if(!(this.contains(e.topLeft())&&this.contains(e.topRight())&&this.contains(e.bottomRight())&&this.contains(e.bottomLeft())))return!1}if(!this.contains(e.center()))return!1;for(var t=this.data,n=0;n<t.elements.length;++n){var i=t.elements[n];if(i.type===ie&&e.contains(i)){if(this.fillRule()===le)return!1;for(var a=!1;!a&&n<t.elements.length;++n){var o=t.elements[n];switch(o.type){case ie:a=!0;break;case ae:if(!this.contains(o))return!1;break;case oe:if(!this.contains(t.elements[n+2]))return!1;n+=2}}--n}}return!0}},{key:"controlPointRect",value:function(){if(this.data){var e=this.data;return e.dirtyControlBounds&&this.computeControlPointRect(),e.controlBounds}this.controlBounds=new X}},{key:"computeControlPointRect",value:function(){if(this.data){var e=this.data;e.dirtyControlBounds=!1;var t=void 0,n=void 0,i=void 0,a=void 0;t=n=e.elements[0].x,i=a=e.elements[0].y;for(var o=1;o<e.elements.length;++o){var r=e.elements[o];r.x>n?n=r.x:r.x<t&&(t=r.x),r.y>a?a=r.y:r.y<i&&(i=r.y)}e.controlBounds=new X(t,i,n-t,a-i)}else this.controlBounds=new X}},{key:"addPolygon",value:function(e){if(Array.isArray(e)){if(0!==e.length){this.ensureData(),this.setDirty(!0),this.moveTo(e[0]);for(var t=0,n=e.length;t<n;t++){var i=e[t];this.lineTo(i)}e.isClosed&&this.closeSubpath()}}else console.error("QPainterPath addPolygon param is not array :",e)}},{key:"connectPolygon",value:function(e){if(Array.isArray(e)){this.ensureData(),this.setDirty(!0);for(var t=0,n=e.length;t<n;t++){var i=e[t];this.lineTo(i)}e.isClosed&&this.closeSubpath()}else console.error("QPainterPath addPolygon param is not array :",e)}},{key:"addPointPath",value:function(e){if(e){this.ensureData(),this.setDirty(!0);var t=e.type,n=e.x,i=e.y;switch(t){case ie:this.moveTo(new W(n,i));break;case ae:this.lineTo(new W(n,i))}}}},{key:"addPath",value:function(e){var t;if(e&&e.isQPainterPath&&!e.isEmpty()){this.ensureData(),this.setDirty(!0);var n=this.data;Object(ne.last)(n.elements).type===ie&&n.elements.splice(n.elements.length-1,1);var i=e.data,a=n.elements.length+e.data.cStart;(t=n.elements).push.apply(t,q()(i.elements)),n.cStart=a,n.require_moveTo=i.isClosed()}else console.error("addPath error!!!",e)}},{key:"toSubpathPolygons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(this.isEmpty())return[];e||(e=new U);var n=[],i=[];i.isClosed=!1;for(var a=this.data,o=0,r=a.elements.length;o<r;o++){var s=a.elements[o];switch(s.type){case ie:if(0!==i.length){var l=Array.from(i);l.isClosed=i.isClosed,Se(i)&&(l.isClosed=!0),n.push(l),i.length=0,i.isClosed=!1,i.push(e.map_point(s.toPoint()))}else i.push(e.map_point(s.toPoint()));break;case ae:i.push(e.map_point(s.toPoint()));break;case oe:if(!a.elements[o-1]||a.elements[o+1].type!==re||a.elements[o+2].type!==re){console.error("this element data error! check");break}var c=s.toPoint(),u=a.elements[o+1].toPoint(),d=a.elements[o+2].toPoint(),h=a.elements[o-1].toPoint(),p=Z.fromPoints(e.map_point(h),e.map_point(c),e.map_point(u),e.map_point(d));p.addToPolygon(i,t),o+=2}}return Se(i)&&(i.isClosed=!0),n.push(i),n}},{key:"translate",value:function(e,t){var n=0,i=0;e.isQPoint?(n=e.x(),i=e.y()):"number"==typeof e&&"number"==typeof t&&(n=e,i=t);var a=this.data;if(a&&(0!==n||0!==i))for(var o=a.elements.length-1,r=a.elements;o>=0;)r[o].x+=n,r[o].y+=i,o--}},{key:"toContextPath",value:function(e){if(!this.isEmpty()&&e.moveTo)for(var t=this.data,n=t.elements,i=0,a=n.length;i<a;i++){var o=n[i],r=o.type,s=o.toPoint();if(o.isClosed)e.closePath&&e.closePath();else switch(r){case ie:e.moveTo&&e.moveTo(s.x(),s.y());break;case ae:e.lineTo&&e.lineTo(s.x(),s.y());break;case oe:if(!t.elements[i-1]||t.elements[i+1].type!==re||t.elements[i+2].type!==re){console.error("this element data error! check");break}var l=s,c=n[i+1].toPoint(),u=n[i+2].toPoint();e.bezierCurveTo&&e.bezierCurveTo(l.x(),l.y(),c.x(),c.y(),u.x(),u.y())}}}},{key:"getPathElementAt",value:function(e){return this.data?this.data.getPathElementAt(e):null}},{key:"isQPainterPath",get:function(){return!0}},{key:"length",get:function(){return this.data?this.data.length:0}}]),e}();function ge(e,t){return 3*(-e[t+"1"]+3*e[t+"2"]-3*e[t+"3"]+e[t+"4"])}function ve(e,t){return 6*(e[t+"1"]-2*e[t+"2"]+e[t+"3"])}function ye(e,t){return 3*(-e[t+"1"]+e[t+"2"])}function me(e,t,n){if(t>=0&&t<=1){var i=K(e,t);i.x<n.minx?n.minx=i.x:i.x>n.maxx&&(n.maxx=i.x),i.y<n.miny?n.miny=i.y:i.y>n.maxy&&(n.maxy=i.y)}}function _e(e){var t=void 0,n=void 0,i=void 0,a=void 0;e.x1<e.x4?(t=e.x1,i=e.x4):(t=e.x4,i=e.x1),e.y1<e.y4?(n=e.y1,a=e.y4):(n=e.y4,a=e.y1);var o={minx:t,miny:n,maxx:i,maxy:a},r=ge(e,"x"),s=ve(e,"x"),l=ye(e,"x");if(Object(H.k)(r)){if(!Object(H.k)(s))me(e,-l/s,o)}else{var c=s*s-4*r*l;if(c>=0){var u=Math.sqrt(c),d=1/(2*r);me(e,(-s+u)*d,o),me(e,(-s-u)*d,o)}}var h=ge(e,"y"),p=ve(e,"y"),f=ye(e,"y");if(Object(H.k)(h)){if(!Object(H.k)(p))me(e,-f/p,o)}else{var g=p*p-4*h*f;if(g>0){var v=Math.sqrt(g),y=1/(2*h);me(e,(-p+v)*y,o),me(e,(-p-v)*y,o)}}return new X(o.minx,o.miny,o.maxx-o.minx,o.maxy-o.miny)}function xe(e,t,n,i,a){var o=a.left(),r=a.right(),s=a.top(),l=a.bottom(),c=(e<o)<<0|(e>r)<<1|(t<s)<<2|(t>l)<<3,u=(n<o)<<0|(n>r)<<1|(i<s)<<2|(i>l)<<3;if(c&u)return!1;if(c|u){var d=n-e,h=i-t;return e<o?(t+=h/d*(o-e),e=o):e>r&&(t-=h/d*(e-r),e=r),n<o?(i+=h/d*(o-n),n=o):n>r&&(i-=h/d*(n-r),n=r),(c=(t<s)<<2|(t>l)<<3)&(u=(i<s)<<2|(i>l)<<3)?!1:(t<s?(e+=d/h*(s-t),t=s):t>l&&(e-=d/h*(t-l),t=l),i<s?(n+=d/h*(s-i),i=s):i>l&&(n-=d/h*(i-l),i=l),!((c=(e<o)<<0|(e>r)<<1)&(u=(n<o)<<0|(n>r)<<1)))}return!1}function we(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.bounds();if(t>=o.top()&&t<o.bottom()&&o.right()>=n&&o.left()<i){var r=.01;if(32===a||o.width()<r&&o.height()<r)return!0;var s=new Z,l=new Z;if(e.split(s,l),we(s,t,n,i,a+1)||we(l,t,n,i,a+1))return!0}return!1}function ke(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.bounds();if(t>=o.left()&&t<o.right()&&o.bottom()>=n&&o.top()<i){var r=.01;if(32===a||o.width()<r&&o.height()<r)return!0;var s=new Z,l=new Z;if(e.split(s,l),ke(s,t,n,i,a+1)||ke(l,t,n,i,a+1))return!0}return!1}function be(e,t,n,i){var a=e.x(),o=e.y(),r=t.x(),s=t.y(),l=n.y(),c=1;if(Object(H.j)(o,s))return i;if(s<o){var u=r;r=a,a=u;var d=s;s=o,o=d,c=-1}l>=o&&l<s&&(a+(r-a)/(s-o)*(l-o)<=n.x()&&(i+=c));return i}function Te(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.y(),o=t.x(),r=e.bounds();if(a>=r.y()&&a<r.y()+r.height()){var s=.001;if(32===i||r.width()<s&&r.height()<s)return e.pt1().x()<=o&&(n+=e.pt4().y()>e.pt1().y()?1:-1),n;var l=new Z,c=new Z;e.split(l,c),n=Te(l,t,n,i+1),n=Te(c,t,n,i+1)}return n}function Ce(e){return Math.abs(e)<1e-7}function Se(e){var t=e.length;return t>1&&Ce(e[0].x()-e[t-1].x())&&Ce(e[0].y()-e[t-1].y())}window.QPainterPath=fe;var Ee=0,Pe=1,Le=2,Ae=4,Ie=8,Re=16;var Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;s()(this,e),this.x=t,this.y=n,this.w=i}return c()(e,[{key:"toPoint",value:function(){var e=1/this.w;return{x:this.x*e,y:this.y*e}}}]),e}();function Me(e,t){var n=new Oe;return n.x=e.m11()*t.x()+e.m21()*t.y()+e.m31(),n.y=e.m12()*t.x()+e.m22()*t.y()+e.m32(),n.w=e.m13()*t.x()+e.m23()*t.y()+e.m33(),n}function De(e,t,n,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=Me(t,n),s=Me(t,i);if(r.w<H.c&&s.w<H.c)return!1;if(s.w<H.c){var l=(H.c-s.w)/(r.w-s.w);s.x+=(r.x-s.x)*l,s.y+=(r.y-s.y)*l,s.w=H.c}else if(r.w<H.c){var c=(H.c-r.w)/(s.w-r.w);r.x+=(s.x-r.x)*c,r.y+=(s.y-r.y)*c,r.w=H.c;var u=r.toPoint();a?(e.moveTo(u),a=!1):e.lineTo(u)}return a&&e.moveTo(r.toPoint()),o&&e.lineTo(s.toPoint()),!0}function Ne(e,t,n,i,a,o,r){for(var s=function(e){var t=null,n=e.type();if(n<=Pe)return{isSameScaleXY:!0,scale:t=1,xScale:1,yScale:1};if(n===Le){var i=Math.abs(e.m11()),a=Math.abs(e.m22());return t=Map.max(i,a),{isSameScaleXY:Object(H.j)(i,a),scale:t,xScale:i,yScale:a}}var o=e.m11()*e.m11()+e.m21()*e.m21(),r=e.m12()*e.m12()+e.m22()*e.m22(),s=e.m11()*e.m11()+e.m12()*e.m12(),l=e.m21()*e.m21()+e.m22()*e.m22();return Math.abs(o-r)>Math.abs(s-l)?(t=Math.sqrt(Math.max(o,r)),{isSameScaleXY:n===Ae&&Object(H.j)(o,r),scale:t}):(t=Math.sqrt(Math.max(s,l)),{isSameScaleXY:n===Ae&&Object(H.j)(s,l),scale:t})}(t).scale,l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=[];return n.push(e.pt1()),J(e,n,t),n}({},0===s?.25:.25/s),c=0;c<l.length-1;++c)De(e,t,l[c],l[c+1],r)&&(r=!1);return!r}var Be=window.Point,je=1,Fe=2,He=0,Ge=1,Ue=2,We=function(){function e(t){s()(this,e),this.affine=t?t.clone():new U,this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=Ee,this.m_dirty=t?Ie:Ee}return c()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"setElements",value:function(e,t,n,i,a,o,r,s,l){this.affine.setMatrix(e,t,i,a,r,s),this.m_13=n,this.m_23=o,this.m_33=l,this.m_type=Ee,this.m_dirty=Re}},{key:"setMatrix",value:function(e,t,n,i,a,o){this.affine.setMatrix(e,t,n,i,a,o),this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=Ee,this.m_dirty=Ie}},{key:"setQMatrix",value:function(e){this.affine.setMatrix(e._m11,e._m12,e._m21,e._m22,e._dx,e._dy),this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=Ee,this.m_dirty=Ie}},{key:"reset",value:function(){this.affine._m11=this.affine._m22=this.m_33=1,this.affine._m12=this.m_13=this.affine._m21=this.m_23=this.affine._dx=this.affine._dy=0,this.m_type=Ee,this.m_dirty=Ee}},{key:"m11",value:function(){return this.affine._m11}},{key:"m12",value:function(){return this.affine._m12}},{key:"m13",value:function(){return this.m_13}},{key:"m21",value:function(){return this.affine._m21}},{key:"m22",value:function(){return this.affine._m22}},{key:"m23",value:function(){return this.m_23}},{key:"m31",value:function(){return this.affine._dx}},{key:"m32",value:function(){return this.affine._dy}},{key:"m33",value:function(){return this.m_33}},{key:"dx",value:function(){return this.affine._dx}},{key:"dy",value:function(){return this.affine._dy}},{key:"inline_type",value:function(){return this.m_dirty===Ee?this.m_type:this.type()}},{key:"type",value:function(){if(this.m_dirty===Ee||this.m_dirty<this.m_type)return this.m_type;switch(this.m_dirty){case Re:if(!Object(H.k)(this.m_13)||!Object(H.k)(this.m_23)||!Object(H.k)(this.m_33-1)){this.m_type=Re;break}case Ie:case Ae:if(!Object(H.k)(this.affine._m12)||!Object(H.k)(this.affine._m21)){var e=this.affine._m11*this.affine._m12+this.affine._m21*this.affine._m22,t=this.affine._m11*this.affine._m21+this.affine._m12*this.affine._m22;Object(H.k)(e)||Object(H.k)(t)?this.m_type=Ae:this.m_type=Ie;break}case Le:if(!Object(H.k)(this.affine._m11-1)||!Object(H.k)(this.affine._m22-1)){this.m_type=Le;break}case Pe:if(!Object(H.k)(this.affine._dx)||!Object(H.k)(this.affine._dy)){this.m_type=Pe;break}case Ee:this.m_type=Ee}return this.m_dirty=Ee,this.m_type}},{key:"determinant",value:function(){var e=this.affine;return e._m11*(this.m_33*e._m22-e._dy*this.m_23)-e._m21*(this.m_33*e._m12-e._dy*this.m_13)+e._dx*(this.m_23*e._m12-e._m22*this.m_13)}},{key:"isAffine",value:function(){return this.inline_type()<Re}},{key:"isIdentity",value:function(){return this.inline_type()===Ee}},{key:"isInvertible",value:function(){return!Object(H.k)(this.determinant())}},{key:"isScaling",value:function(){return this.type()>=Le}},{key:"isRotating",value:function(){return this.inline_type()>=Ae}},{key:"isTranslating",value:function(){return this.inline_type()>=Pe}},{key:"inverted",value:function(t){var n=new e,i=!0;switch(this.inline_type()){case Ee:break;case Pe:n.affine._dx=-this.affine._dx,n.affine._dy=-this.affine._dy;break;case Le:i=!Object(H.k)(this.affine._m11),(i&=!Object(H.k)(this.affine._m22))&&(n.affine._m11=1/this.affine._m11,n.affine._m22=1/this.affine._m22,n.affine._dx=-this.affine._dx*n.affine._m11,n.affine._dy=-this.affine._dy*n.affine._m22);break;case Ae:case Ie:i=this.affine.invertible(),n.affine=this.affine.inverted();break;default:var a=this.determinant();(i=!Object(H.k)(a))&&(n=this.adjoint()/a)}return t&&(t.invertible=i),i&&(n.m_type=this.m_type,n.m_dirty=this.m_dirty),n}},{key:"adjoint",value:function(){var t,n,i,a,o,r,s,l,c,u=this.affine,d=this.m_13,h=this.m_23,p=this.m_33;t=u._m22*p-h*u._dy,a=h*u._dx-u._m21*p,s=u._m21*u._dy-u._m22*u._dx,n=d*u._dy-u._m12*p,o=u._m11*p-d*u._dx,l=u._m12*u._dx-u._m11*u._dy,i=u._m12*h-d*u._m22,r=d*u._m21-u._m11*h,c=u._m11*u._m22-u._m12*u._m21;var f=new e;return f.setElements(t,n,i,a,o,r,s,l,c),f}},{key:"transposed",value:function(){var t=this.affine,n=this.m_13,i=this.m_23,a=this.m_33,o=new e;return o.setElements(t._m11,t._m21,t._dx,t._m12,t._m22,t._dy,n,i,a),o.m_type=this.m_type,o.m_dirty=this.m_dirty,o}},{key:"translate",value:function(e,t){if(0===e&&0===t)return this;switch(this.inline_type()){case Ee:this.affine._dx=e,this.affine._dy=t;break;case Pe:this.affine._dx+=e,this.affine._dy+=t;break;case Le:this.affine._dx+=e*this.affine._m11,this.affine._dy+=t*this.affine._m22;break;case Re:this.m_33+=e*this.m_13+t*this.m_23;case Ie:case Ae:this.affine._dx+=e*this.affine._m11+t*this.affine._m21,this.affine._dy+=t*this.affine._m22+e*this.affine._m12}return this.m_dirty<Pe&&(this.m_dirty=Pe),this}},{key:"fromTranslate",value:function(t,n){var i=new e;return i.setElements(1,0,0,0,1,0,t,n,1),i.m_type=0===t&&0===n?Ee:Pe,i.m_dirty=Ee,i}},{key:"scale",value:function(e,t){if(1===e&&1===t)return this;switch(this.inline_type()){case Ee:case Pe:this.affine._m11=e,this.affine._m22=t;break;case Re:this.m_13*=e,this.m_23*=t;case Ae:case Ie:this.affine._m12*=e,this.affine._m21*=t;case Le:this.affine._m11*=e,this.affine._m22*=t}return this.m_dirty<Le&&(this.m_dirty=Le),this}},{key:"shear",value:function(e,t){if(0===e&&0===t)return this;switch(this.inline_type()){case Ee:case Pe:this.affine._m12=t,this.affine._m21=e;break;case Le:this.affine._m12=t*this.affine._m22,this.affine._m21=e*this.affine._m11;break;case Re:var n=t*this.m_23,i=e*this.m_13;this.m_13+=n,this.m_23+=i;case Ae:case Ie:var a=t*this.affine._m21,o=e*this.affine._m12,r=t*this.affine._m22,s=e*this.affine._m11;this.affine._m11+=a,this.affine._m12+=r,this.affine._m21+=s,this.affine._m22+=o}return this.m_dirty<Ie&&(this.m_dirty=Ie),this}},{key:"rotate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe;if(0===t)return this;var i=0,a=0;if(90===t||-270===t)i=1;else if(270===t||-90===t)i=-1;else if(180===t)a=-1;else{var o=.017453292519943295*t;i=Math.sin(o),a=Math.cos(o)}if(n===Fe){var r=this.affine,s=this.m_13,l=this.m_23;switch(this.inline_type()){case Ee:case Pe:r._m11=a,r._m12=i,r._m21=-i,r._m22=a;break;case Le:var c=a*r._m11,u=i*r._m22,d=-i*r._m11,h=a*r._m22;r._m11=c,r._m12=u,r._m21=d,r._m22=h;break;case Re:var p=a*s+i*l,f=-i*s+a*l;this.m_13=p,this.m_23=f;break;case Ae:case Ie:var g=a*r._m11+i*r._m21,v=a*r._m12+i*r._m22,y=-i*r._m11+a*r._m21,m=-i*r._m12+a*r._m22;r._m11=g,r._m12=v,r._m21=y,r._m22=m}this.m_dirty<Ae&&(this.m_dirty=Ae)}else{var _=new e;n===je?(_.affine._m11=a,_.m_13=1/1024*-i):(_.affine._m22=a,_.m_23=1/1024*-i),_.m_type=Re,this.assign(_.multiplySwap(this))}return this}},{key:"rotateRadians",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe,i=Math.sin(t),a=Math.cos(t);if(n===Fe){var o=this.affine,r=this.m_13,s=this.m_23;switch(this.inline_type()){case Ee:case Pe:o._m11=a,o._m12=i,o._m21=-i,o._m22=a;break;case Le:var l=a*o._m11,c=i*o._m22,u=-i*o._m11,d=a*o._m22;o._m11=l,o._m12=c,o._m21=u,o._m22=d;break;case Re:var h=a*r+i*s,p=-i*r+a*s;this.m_13=h,this.m_23=p;break;case Ae:case Ie:var f=a*o._m11+i*o._m21,g=a*o._m12+i*o._m22,v=-i*o._m11+a*o._m21,y=-i*o._m12+a*o._m22;o._m11=f,o._m12=g,o._m21=v,o._m22=y}this.m_dirty<Ae&&(this.m_dirty=Ae)}else{var m=new e;n===je?(m.affine._m11=a,m.m_13=1/1024*-i):(m.affine._m22=a,m.m_23=1/1024*-i),m.m_type=Re,this.assign(m.multiply(this))}return this}},{key:"assign",value:function(e){return this.affine=e.affine,this.m_13=e.m_13,this.m_23=e.m_23,this.m_33=e.m_33,this.m_type=e.m_type,this.m_dirty=e.m_dirty,this}},{key:"isEquals",value:function(e){var t=this.affine,n=this.m_13,i=this.m_23,a=this.m_33;return t._m11===e.affine._m11&&t._m12===e.affine._m12&&t._m21===e.affine._m21&&t._m22===e.affine._m22&&t._dx===e.affine._dx&&t._dy===e.affine._dy&&n===e.m_13&&i===e.m_23&&a===e.m_33}},{key:"multiply",value:function(e){var t=e.inline_type();if(t===Ee)return this;var n=this.inline_type();if(n===Ee)return this.assign(e);var i=this.affine,a=this.m_13,o=this.m_23,r=this.m_33,s=Math.max(n,t);switch(s){case Ee:break;case Pe:i._dx+=e.affine._dx,i._dy+=e.affine._dy;break;case Le:var l=i._m11*e.affine._m11,c=i._m22*e.affine._m22,u=i._dx*e.affine._m11+e.affine._dx,d=i._dy*e.affine._m22+e.affine._dy;i._m11=l,i._m22=c,i._dx=u,i._dy=d;break;case Ae:case Ie:var h=i._m11*e.affine._m11+i._m12*e.affine._m21,p=i._m11*e.affine._m12+i._m12*e.affine._m22,f=i._m21*e.affine._m11+i._m22*e.affine._m21,g=i._m21*e.affine._m12+i._m22*e.affine._m22,v=i._dx*e.affine._m11+i._dy*e.affine._m21+e.affine._dx,y=i._dx*e.affine._m12+i._dy*e.affine._m22+e.affine._dy;i._m11=h,i._m12=p,i._m21=f,i._m22=g,i._dx=v,i._dy=y;break;case Re:var m=i._m11*e.affine._m11+i._m12*e.affine._m21+a*e.affine._dx,_=i._m11*e.affine._m12+i._m12*e.affine._m22+a*e.affine._dy,x=i._m11*e.m_13+i._m12*e.m_23+a*e.m_33,w=i._m21*e.affine._m11+i._m22*e.affine._m21+o*e.affine._dx,k=i._m21*e.affine._m12+i._m22*e.affine._m22+o*e.affine._dy,b=i._m21*e.m_13+i._m22*e.m_23+o*e.m_33,T=i._dx*e.affine._m11+i._dy*e.affine._m21+r*e.affine._dx,C=i._dx*e.affine._m12+i._dy*e.affine._m22+r*e.affine._dy,S=i._dx*e.m_13+i._dy*e.m_23+r*e.m_33;i._m11=m,i._m12=_,this.m_13=x,i._m21=w,i._m22=k,this.m_23=b,i._dx=T,i._dy=C,this.m_33=S}return this.m_dirty=s,this.m_type=s,this}},{key:"multiplyNumber",value:function(e){return 1===e||(this.affine._m11*=e,this.affine._m12*=e,this.m_13*=e,this.affine._m21*=e,this.affine._m22*=e,this.m_23*=e,this.affine._dx*=e,this.affine._dy*=e,this.m_33*=e,this.m_dirty<Le&&(this.m_dirty=Le)),this}},{key:"dividedNumber",value:function(e){return 0===e?this:this.multiplyNumber(1/e)}},{key:"addNumber",value:function(e){return 0===e||(this.affine._m11+=e,this.affine._m12+=e,this.m_13+=e,this.affine._m21+=e,this.affine._m22+=e,this.m_23+=e,this.affine._dx+=e,this.affine._dy+=e,this.m_33+=e,this.m_dirty=Re),this}},{key:"subNumber",value:function(e){return this.addNumber(-e)}},{key:"MAP",value:function(e,t){var n=this.affine,i=this.m_13,a=this.m_23,o=this.m_33,r=0,s=0,l=this.inline_type();switch(l){case Ee:r=e,s=t;break;case Pe:r=e+n._dx,s=t+n._dy;break;case Le:r=n._m11*e+n._dx,s=n._m22*t+n._dy;break;case Ae:case Ie:case Re:if(r=n._m11*e+n._m21*t+n._dx,s=n._m12*e+n._m22*t+n._dy,l===Re){var c=i*e+a*t+o;c<1e-6&&(c=1e-6),r*=c=1/c,s*=c}}return[r,s]}},{key:"mapPoint",value:function(e){var t=this.MAP(e.x(),e.y()),n=F()(t,2),i=n[0],a=n[1],o=e.clone();return o.setPoint(i,a),o}},{key:"mapLine",value:function(e){var t=this.mapPoint(e.p1()),n=this.mapPoint(e.p2());return e.clone().setPoints(t,n)}},{key:"mapRect",value:function(e){var t=e.clone(),n=this.affine,i=this.inline_type();if(i<=Pe)return t.translate(new Be(n._dx,n._dy));if(i<=Le){var a=n._m11*t.x()+n._dx,o=n._m22*t.y()+n._dy,r=n._m11*t.width(),s=n._m22*t.height();return r<0&&(a-=r=-r),s<0&&(o-=s=-s),t.setRect(a,o,r,s),t}if(i<Re||!Object(H.g)(t,this)){var l=0,c=0,u=this.MAP(t.x(),t.y()),d=F()(u,2),h=l=d[0],p=c=d[1],f=l,g=c,v=this.MAP(t.x()+t.width(),t.y()),y=F()(v,2);l=y[0],c=y[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c);var m=this.MAP(t.x()+t.width(),t.y()+t.height()),_=F()(m,2);l=_[0],c=_[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c);var x=this.MAP(t.x(),t.y()+t.height()),w=F()(x,2);return l=w[0],c=w[1],h=Math.min(h,l),p=Math.min(p,c),f=Math.max(f,l),g=Math.max(g,c),t.setRect(h,p,f-h,g-p),t}var k=new fe;return k.addRect(t),this.map(k).boundingRect()}},{key:"mapPolygon",value:function(e){}},{key:"mapRegion",value:function(e){}},{key:"mapPainterPath",value:function(t){var n=this.inline_type();if(n===Ee||0===t.elementCount())return t;if(n>=Re)return e.mapProjective(this,t);var i=t.clone();if(n===Pe)i.translate(this.affine._dx,this.affine._dy);else{i.detach();for(var a=0;a<t.elementCount();++a){var o=i.elementAt(a),r=this.MAP(o.x,o.y),s=F()(r,2),l=s[0],c=s[1];o.x=l,o.y=c}}return i}},{key:"Map",value:function(e){if(e){if(Object(H.e)(e))return this.mapRect(new X(e.x,e.y,e.width,e.height)).getRect();if(Object(H.f)(e)){var t=this.MAP(e.x,e.y),n=F()(t,2);return{x:n[0],y:n[1]}}if(e.isQPoint)return this.mapPoint(e);if(e.isQLine)return this.mapLine(e);if(e.isQRect||e.isRect)return this.mapRect(e);if(e.isQPainterPath)return this.mapPainterPath(e);if(e.isQPolygon)return this.mapPolygon(e);if(e.isQRegion)return this.mapRegion(e)}return console.error("Invalid argument for QTransform.map():",e),null}},{key:"isQTransform",get:function(){return!0}}],[{key:"multiply",value:function(e,t){return e.clone().multiply(t)}},{key:"mapProjective",value:function(e,t){for(var n=new fe,i=void 0,a=void 0,o=!0,r=0;r<t.elementCount();++r)switch(t.elementAt(r).type){case He:r>0&&a!==i&&De(n,e,i,a,o),a=t.elementAt(r),i=t.elementAt(r),o=!0;break;case Ge:De(n,e,i,t.elementAt(r),o)&&(o=!1),i=t.elementAt(r);break;case Ue:Ne(n,e,0,t.elementAt(r),t.elementAt(r+1),t.elementAt(r+2),o)&&(o=!1),r+=2,i=t.elementAt(r)}return t.elementCount()>0&&a!==i&&De(n,e,i,a,o,!1),n.setFillRule(t.fillRule()),n}}]),e}();window.QTransform=We;var Ye=function(){function e(t){s()(this,e),this._theme=t}return c()(e,[{key:"data",value:function(){return this._theme}},{key:"getFormatScheme",value:function(){this._formatScheme||(this._formatScheme=new Xe({}));var e=this._theme.baseStyle.formatScheme;return this._formatScheme.init(e),this._formatScheme}},{key:"getFontScheme",value:function(){this._fontScheme||(this._fontScheme=new ze({}));var e=this._theme.baseStyle.fontScheme;return this._fontScheme.init(e),this._fontScheme}},{key:"getColorIndex",value:function(e){var t=this._theme.colorMapping;return t&&t[0][e]||0}},{key:"getColorAt",value:function(e){var t=this.getColorIndex(e),n=this._theme.baseStyle;if(n&&n.colorScheme){var i=n.colorScheme.colors;if((i=i||[]).length>t)return i[t]}return null}},{key:"getColorMapping",value:function(){this._colorMapping||(this._colorMapping=new Ve({}));var e=this._theme.colorMapping;return this._colorMapping.init(e),this._colorMapping}},{key:"getColorScheme",value:function(){this._colorScheme||(this._colorScheme=new qe(e&&e.colorScheme||{}));var e=this._theme.baseStyle;return this._colorScheme.init(e&&e.colorScheme||{}),this._colorScheme}}],[{key:"getInstance",value:function(t){this._instance=this._instance||{};var n=t&&t.getId();t&&!this._instance[n]&&(this._instance[n]=new e({baseStyle:{},colorMapping:{}}));var i=this._instance[n];return i&&(i._theme=t&&t.getThemeData()),i}}]),e}(),ze=function(){function e(t){s()(this,e),this.props=t||{}}return c()(e,[{key:"init",value:function(e){this.props=e||{}}},{key:"getDefaultFont",value:function(e){var t=e.themeIndex,n=this.props,i=n.majorFont,a=n.minorFont,o=i;return"minor"===t&&(o=a),o}},{key:"getFontAt",value:function(e){var t=e.themeIndex,n=e.themeScript,i=e.script,a=this.props,o=a.majorFont,r=a.minorFont;n&&(n="drawing.eastAsia"===n?"eastAsianFont":n.replace("drawing.","")+"Font");var s=o;"minor"===t&&(s=r);var l=s;if(s){var c=s.supplemental;if(i&&c)for(var u=0;u<c.length;u++){var d=c[u];if(d.script===i)return d.typeface}s=s[n]}var h=void 0;if(s&&(h=s.name),!h){if(l){var p=l.latinFont,f=l.eastAsianFont,g=l.complexScriptFont,v=l[n];if(h=v&&v.name)return h;if(p&&p.name)return p.name;if(f&&f.name)return f.name;if(g&&g.name)return g.name}h=n&&-1!==n.indexOf("eastAsia")?"宋体":"Arial"}return h}}]),e}(),Xe=function(){function e(t){s()(this,e),this.props=t||{}}return c()(e,[{key:"init",value:function(e){this.props=e||{}}},{key:"getRealIndex",value:function(e){return e>=1e3?e-=1e3:e+=1,e}},{key:"getBackgroundFillAt",value:function(e){var t=this.props.backgroundFill;return t?(e=this.getRealIndex(e),t[Math.min(e,t.length-1)]):{type:0}}},{key:"getEffectsAt",value:function(e){var t=this.props.effects;return e<=0||!t||0===t.length?null:t[Math.min(e,t.length)-1]}},{key:"getFillAt",value:function(e){var t=this.props.fill;return e>=1e3?this.getBackgroundFillAt(e):t?t[Math.min(e,t.length-1)]:{type:0}}},{key:"getLineAt",value:function(e){var t=this.props.lines;return 0!==e&&t&&0!==t.length?t[Math.min(e,t.length)-1]:null}},{key:"getScene3dAt",value:function(e){var t=this.props.scene3d;return t?t[e]:null}},{key:"getShape3dAt",value:function(e){var t=this.props.shape3d;return t?t[e]:null}}]),e}(),Ve=function(){function e(t){s()(this,e),this.colorMapping=t}return c()(e,[{key:"init",value:function(e){this.colorMapping=e}},{key:"mapColor",value:function(e){var t=this.colorMapping&&this.colorMapping[0],n=t&&t[e];return Object.isEmpty(n)?e:n}}]),e}(),qe=function(){function e(t){s()(this,e),this.colorScheme=t}return c()(e,[{key:"init",value:function(e){this.colorScheme=e}},{key:"getColor",value:function(e){if(this.colorScheme){var t=this.colorScheme.colors||[];if(t.length>e)return t[e]}return{type:0,isAutoColor:!1,sRgb:16777215,toRGB:"#00ffffff"}}}]),e}();function Ke(e){return(e%=360)<0&&(e+=360),e}function Qe(e){var t=e>=0?1:-1;return Math.floor(Math.abs(e)+.5)*t}var Je={TRANSFORM_NONE:0,TRANSFORM_TRANSLATE:1,TRANSFORM_ROTATION:2,TRANSFORM_FLIP:4,TRANSFORM_ALL:7},Ze=function(){function e(t){s()(this,e),this._coredata=t}return c()(e,[{key:"getParent",value:function(){var e=this._coredata.parent;return e?e.visual:null}},{key:"isBackground",value:function(){return!1}},{key:"getSlideVisual",value:function(){for(var e=this._coredata,t=null;e;){if(e.isSlideType){t=e;break}e=e.getParent?e.getParent():e.parent}return t?t.visual:null}},{key:"getTheme",value:function(){var e=this.getSlideVisual();return e&&e.coredata?Ye.getInstance(e.coredata):null}},{key:"isIndividual",value:function(){var e=this._coredata;if(e.isSlideType)return!0;if(e.isShape){if(e.isBackground&&e.isBackground())return!0;var t=e.getParent();return t&&t.isGroupShape&&t.isGroupShape()}return!1}},{key:"getIndividualVisual",value:function(){for(var e=this;e;){if(e.isIndividual())return e;e=e.getParent()}return e}},{key:"geometryTransform",value:function(){return{x:0,y:0,width:1,height:1,horizontalFlipped:!1,verticalFlipped:!1,rotation:0}}},{key:"_rect",value:function(){var e=this.geometryTransform();return Object.assign(e,{x:0,y:0}),0===e.width&&(e.width=1),0===e.height&&(e.height=1),e}},{key:"isLayerVisual",value:function(){return!(!this._coredata||!this._coredata.private.layer)}},{key:"_calcTransformMatrix",value:function(e,t,n,i,a,o,r){return r&Je.TRANSFORM_TRANSLATE&&t&&e.translate(t.x,t.y),r&Je.TRANSFORM_ROTATION&&(Object(H.k)(i)||(e.translate(n.x,n.y),e.rotate(i),e.translate(-n.x,-n.y))),r&Je.TRANSFORM_FLIP&&(a||o)&&(e.translate(n.x,n.y),e.scale(a?-1:1,o?-1:1),e.translate(-n.x,-n.y)),e}},{key:"calcFlipRotatedTransform",value:function(e,t,n,i){return this._calcTransformMatrix(new window.QTransform,null,e,t,n,i,Je.TRANSFORM_ROTATION|Je.TRANSFORM_FLIP)}},{key:"transform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je.TRANSFORM_ALL,t=this.geometryTransform();return this._calcTransformMatrix(new window.QTransform,t,{x:t.width/2,y:t.height/2},t.rotation,t.horizontalFlipped,t.verticalFlipped,e)}},{key:"currentRectToLayerRect",value:function(e){var t={x:e.x+e.width/2,y:e.y+e.height/2},n=this.calcTransFromCurrent2Layer(),i=(n=We.multiply(this.transform().inverted({}),n)).Map(t);return{x:i.x-e.width/2,y:i.y-e.height/2,width:e.width,height:e.height}}},{key:"layerRectToCurrentRect",value:function(e){var t={x:e.x+e.width/2,y:e.y+e.height/2},n=this.calcTransFromCurrent2Layer().inverted({}).Map(t);return{x:(n=this.transform().Map(n)).x-e.width/2,y:n.y-e.height/2,width:e.width,height:e.height}}},{key:"calcTransFromCurrent2Layer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je.TRANSFORM_ALL,t=this.getParent();return this.isLayerVisual()||!t?new window.QTransform:We.multiply(this.transform(),t.calcTransFromCurrent2Layer(e))}},{key:"isSwapWidthAndHeight",value:function(e){return(e=Ke(e))>=45&&e<135||e>=225&&e<315}},{key:"calcShapePosData",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(0!=t&&0!=n){var o={x:e.x+e.width/2,y:e.y+e.height/2};o.x*=t,o.y*=n;var r=e.width,s=e.height;this.isSwapWidthAndHeight(i)?(r*=n,s*=t):(r*=t,s*=n),e={x:o.x-r/2,y:o.y-s/2,width:r,height:s}}return a&&(e={x:Qe(e.x),y:Qe(e.y),width:Qe(e.width),height:Qe(e.height)}),e}},{key:"caleMaxBound",value:function(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}}},{key:"coredata",get:function(){return this._coredata}}]),e}(),$e=n(1134),et=1,tt=2,nt=3,it=4;function at(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t&&t.length>0){for(var i=null,a=0;a<t.length;a++){var o=t[a];if(null!=i){if(o)for(var r=0;r<o.length;r++)i.indexOf(o[r])<0&&i.push(o[r])}else i=o}return i}}function ot(e,t,n){return n.bFastClone&&t instanceof Object?n.fastClone?n.fastClone(e,t):m(t):t}function rt(e,t,n,i){if((t=t||{}).customDeepMerge)return t.customDeepMerge(e||[],t);var a=t,o=a.deeps,r=a.names,s=a.merger,l=a.clone,c=a.arrayMerger,u=a.arrayMergeType,d=a.bFastClone;t.init&&(e=t.init(e));for(var h=[],p=0;p<e.length;p++)null!=e[p]&&e[p]instanceof Object&&(t.bClone||0===h.length&&d?h.push(l?l(e[p]):m(e[p])):h.push(e[p]));if(0!==h.length){t.bClone&&(d=!1);for(var f={deeps:o,names:r,merger:s,arrayMerger:c,arrayMergeType:u,bFastClone:d,fastClone:t.fastClone},g=h[0],v=1;v<h.length;v++){var y=h[v];if(null!=o&&n>o)g=y;else for(var _=Object.keys(y),x=0;x<_.length;x++){var w=_[x],k=i+"/"+w;if(r&&s){for(var b=!1,T=0;T<r.length;T++)if(k===r[T]||"/"!==r[T]&&k.endsWith(r[T])){b=!0;break}if(b){var C=s(n,k,g[w],y[w]);if(C&&C.succ){g[w]=C.result;continue}}}if(null!=o&&n>=o)g[w]=y[w];else if(null==g[w])g[w]=ot(k,y[w],t);else if(g[w]instanceof Object&&y[w]instanceof Object){if(!r&&s){var S=s(n,k,g[w],y[w]);if(S&&S.succ){g[w]=S.result;continue}}var E=g[w]instanceof Array,P=y[w]instanceof Array;E&&P?u===et?g[w]=g[w].concat(y[w]):u===tt?at(g[w],y[w]):g[w]=u===nt?rt([g[w],y[w]],f,n+1,i+"/"+w):u===it&&c?c(g[w],y[w]):ot(k,y[w],t):g[w]=E||P?ot(k,y[w],t):rt([g[w],y[w]],f,n+1,i+"/"+w)}else g[w]=ot(k,y[w],t)}}return g}}function st(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return rt(e,t,1,"")}var lt={deeps:1,bClone:!0},ct={deeps:4,arrayMergeType:nt,bClone:!1,bFastClone:!0,clone:function(e){if(!e)return e;var t={};return e.chpStyles&&(t.chpStyles=m(e.chpStyles)),e.paraStyles&&(t.paraStyles=m(e.paraStyles)),e.listNumbers&&(t.listNumbers=Object.assign({},e.listNumbers)),t},fastClone:function(e,t){return"/listNumbers"===e?Object.assign({},t):e.startsWith("/listNumbers/")?t:m(t)},customDeepMerge:function(e,t){if(0!==e.length){var n=t.bClone||t.bFastClone;if(n&&1===e.length)return t.clone?t.clone(e[0]):m(e[0]);for(var i=n?{chpStyles:[],paraStyles:[]}:e[0],a=n?0:1;a<e.length;a++)for(var o=e[a],r=o.chpStyles,s=o.paraStyles,l=o.listNumbers,c=0;c<9;c++){if(r&&r[c]){var u=i.chpStyles[c]&&i.chpStyles[c].prop;i.chpStyles[c]={prop:Object.assign({},u,r[c].prop)}}if(s&&s[c]){var d=i.paraStyles[c]&&i.paraStyles[c].prop;i.paraStyles[c]={prop:Object.assign({},d,s[c].prop)}}l&&(i.listNumbers=Object.assign({},i.listNumbers,l))}return n?t.clone?t.clone(i):m(i):i}}},ut={names:["/fill"],deeps:1,merger:function(e,t,n,i){if("/fill"===t)return{succ:!0,result:st([n,i],lt)}},bClone:!0};var dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split("");var ht={SRgb:0,ScRgb:1,Hsl:2,Scheme:3,Preset:4,System:5,Palette:6,LegacyRef:7},pt=0,ft=4,gt=5,vt=6,yt=7,mt=8,_t=9,xt=11,wt=12,kt=13,bt=14,Tt=15,Ct=16;function St(e,t,n){return e>t&&e>n?e:t>n?t:n}function Et(e,t,n){return e<t&&e<n?e:t<n?t:n}function Pt(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Lt(e,t){var n=e>=.5?{r:1-e,g:e-1,b:e-1}:{r:e,g:-e,b:-e};return{r:Object(H.h)(0,e+n.r*t,1),g:Object(H.h)(0,e+n.g*t,1),b:Object(H.h)(0,e+5*n.b*t,1)}}var At=0,It=1,Rt=2,Ot=3,Mt=4,Dt=5,Nt=6,Bt=7,jt=8,Ft=9,Ht=10,Gt=11,Ut=12,Wt=13,Yt=14,zt=15,Xt=16,Vt=17,qt=18,Kt=19,Qt=20,Jt=21,Zt=22,$t=23,en=24,tn=25,nn=26,an=27;function on(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function rn(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}function sn(e){return{a:e>>24&255,r:e>>16&255,g:e>>8&255,b:255&e}}function ln(e){var t=window.APP.presentation,n=t&&t.getBuddy(),i=n&&n.private.globalPalette;return i&&e<i.length?i[e]:e>=pn?e:fn}function cn(e){var t=window.APP.presentation,n=t&&t.getBuddy(),i=n&&n.private.presetColors;return i&&e<i.length?i[e]:fn}var un=function(){function e(t,n,i,a){s()(this,e),this.setRgba({r:t,g:n,b:i,a:a}),this.hasAlpha=!0}return c()(e,[{key:"toScRgb",value:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}}},{key:"toRGB",value:function(){return{r:Math.round(255*this.r),g:Math.round(255*this.g),b:Math.round(255*this.b),a:Math.round(255*this.a)}}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||{},n=t.prefix,i=t.hasAlpha;if(i=null==i?!!this.hasAlpha:!!i,"rgba"===n){var a=this.toRGB(),o=a.r,r=a.g,s=a.b,l=a.a;return"rgba("+o+","+r+","+s+","+l/255+")"}n="0x"===n?"0x":"#";var c=this.toInt(),u="00000000",d=c.toString(16);return d.length<8&&(d=u.slice(0,8-d.length)+d),i||(d=d.slice(2)),n+d}},{key:"toInt",value:function(){var e=this.toRGB(),t=e.r,n=e.g,i=e.b,a=e.a;a=null==a?255:a;return(this.hasAlpha?(a<<24)+(t<<16)+(n<<8)+i:(t<<16)+(n<<8)+i)>>>0}},{key:"toHsl",value:function(){var e,t=this.r,n=this.g,i=this.b,a=void 0,o=void 0,r=St(t,n,i),s=Et(t,n,i),l=r-s,c=r+s;return a=0,e=.5*c,Object(H.k)(l)?o=0:(o=e<.5?l/c:l/(2-c),Object(H.j)(t,r)?a=(n-i)/l+(n<i?6:0):Object(H.j)(n,r)?a=2+(i-t)/l:Object(H.j)(i,r)&&(a=4+(t-n)/l),a*=1/6),{h:a,l:e,s:o}}},{key:"setHasAlpha",value:function(e){this.hasAlpha=!!e}},{key:"assign",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.hasAlpha=e.hasAlpha}},{key:"setRgba",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=null==e.a?1:e.a}},{key:"setRgb",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b}},{key:"setHsl",value:function(e){var t=e.h,n=e.s,i=e.l,a=void 0,o=void 0,r=void 0,s=void 0,l=void 0;Object(H.j)(t,1)?a=o=r=i:n<0?(a=2*i-Pt(l=2*i-(s=i<.5?i*(1-n):i-n+i*n),s,t+1/3),o=2*i-Pt(l,s,t),r=2*i-Pt(l,s,t-1/3),a=Object(H.h)(0,a,1),o=Object(H.h)(0,o,1),r=Object(H.h)(0,r,1)):Object(H.k)(i)?a=o=r=0:(a=Pt(l=2*i-(s=i<.5?i*(1+n):i+n-i*n),s,t+1/3),o=Pt(l,s,t),r=Pt(l,s,t-1/3),a=Object(H.h)(0,a,1),o=Object(H.h)(0,o,1),r=Object(H.h)(0,r,1)),this.r=a,this.g=o,this.b=r}},{key:"revertGamma",value:function(){this.r=on(this.r),this.g=on(this.g),this.b=on(this.b)}},{key:"gammaCorrected",value:function(){this.r=rn(this.r),this.g=rn(this.g),this.b=rn(this.b)}},{key:"max",value:function(){return St(this.r,this.g,this.b)}},{key:"min",value:function(){return Et(this.r,this.g,this.b)}}],[{key:"fromRGB",value:function(t){var n=t.r,i=t.g,a=t.b,o=t.a;return new e(n/255,i/255,a/255,null==o?1:o/255)}},{key:"fromScRgb",value:function(t){var n=t.r,i=t.g,a=t.b,o=t.a;return Object.isEmpty(o)&&(o=1),new e(n,i,a,o)}},{key:"fromHsl",value:function(t){var n=new e(0,0,0,1);return n.setHsl(t),n}},{key:"fromSrgb",value:function(t){return e.fromRGB(sn(4278190080|t))}},{key:"fromInt",value:function(t){return e.fromRGB(sn(t))}},{key:"fromString",value:function(t){try{return e.fromStringColor(t)}catch(e){}return e.fromInt(16777215)}},{key:"fromStringColor",value:function(t){var n=16777215;if("string"==typeof t){if(t.startsWith("#"))t=t.slice(1);else if(t.startsWith("0x"))t=t.slice(2);else if(t.startsWith("rgba(")&&t.endsWith(")")){var i=t.slice(5,t.length-1).split(",");if(4===i.length)return e.fromRGB({r:parseInt(i[0]),g:parseInt(i[1]),b:parseInt(i[2]),a:Math.round(parseInt(255*i[3]))});t=null}else t=null;t&&(n=parseInt(t,16))}return e.fromInt(n)}},{key:"fromPalette",value:function(t){var n=e.fromInt(ln(32767===t?hn:t));return n.isAutoColor=64===t||65===t||t>=77&&t<=80||32767===t,n}}]),e}(),dn=function(){function e(t){s()(this,e),this._data=t}return c()(e,[{key:"setData",value:function(e){this._data=e}},{key:"clone",value:function(){return new e(m(this._data))}},{key:"getRgba",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._data||{},n=null;switch(t.type){case ht.SRgb:(n=un.fromSrgb(t.sRgb)).revertGamma();break;case ht.System:(n=un.fromInt(ln(t.system))).revertGamma();break;case ht.Preset:(n=un.fromInt(cn(t.preset))).revertGamma();break;case ht.ScRgb:n=un.fromScRgb(t);break;case ht.Hsl:n=un.fromHsl(t.h/6e3/360,t.s,t.l);break;case ht.Scheme:case ht.Palette:case ht.LegacyRef:if(e){var i=e.interpret(this);i?(n=i.getRgba(e),n=i.applyTransforms(n)):console.error("Invalid color, type=",t.type)}}return n||new un(0,0,0,1)}},{key:"toScRgb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getRgba(e);return(t=this.applyTransforms(t)).gammaCorrected(),t}},{key:"toRGB",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getRgba(e);return(t=this.applyTransforms(t)).gammaCorrected(),t.toString()}},{key:"applyTransforms",value:function(e){var t=(this._data||{}).transOp;if(t&&t.length>0)for(var n=0;n<t.length;n++)this.applyTransform(t[n],e);return e}},{key:"applyTransform",value:function(e,t){if(e&&t){var n=e.op,i=e.val;switch(n){case At:t.a=i;break;case It:t.a=Object(H.m)(t.a*i,1);break;case Rt:t.a=Object(H.h)(0,t.a+i,1);break;case Ot:t.b=i;break;case Mt:t.b=Object(H.m)(t.b*i,1);break;case Dt:t.b=Object(H.h)(0,t.b+i,1);break;case Nt:t.gammaCorrected();var a=t.max(),o=t.min();t.r=a+o-t.r,t.g=a+o-t.g,t.b=a+o-t.b,t.revertGamma();break;case Bt:t.gammaCorrected();break;case jt:t.gammaCorrected(),t.r=.2157*t.r+.7137*t.g+.0706*t.b;var r=on(t.r);t.setRgb({r:r,g:r,b:r});break;case Ft:t.g=i;break;case Ht:t.g=Object(H.m)(t.g*i,1);break;case Gt:t.g=Object(H.h)(0,t.g+i,1);break;case Ut:t.gammaCorrected();var s=t.toHsl(),l=s.s,c=s.l;t.setHsl({h:Object(H.h)(0,i/6e4/360,1),s:l,l:c}),t.revertGamma();break;case Wt:t.gammaCorrected();var u=t.toHsl(),d=u.h,h=u.s,p=u.l;d=Math.min(d*i,1),t.setHsl({h:d,s:h,l:p}),t.revertGamma();break;case Yt:t.gammaCorrected();var f=t.toHsl(),g=f.h,v=f.s,y=f.l;(g+=i/6e4/360)<0&&(g+=Object(H.i)(-g)),g-=Math.floor(g),t.setHsl({h:g,s:v,l:y}),t.revertGamma();break;case zt:t.setRgb({r:1-t.r,g:1-t.g,b:1-t.b});break;case Xt:t.revertGamma();break;case Vt:t.gammaCorrected();var m=t.toHsl(),_=m.h,x=m.s;t.setHsl({h:_,s:x,arg:i}),t.revertGamma();break;case qt:t.gammaCorrected();var w=t.toHsl(),k=w.h,b=w.s,T=w.l;T*=i,T=Object(H.m)(T,1),t.setHsl({h:k,s:b,l:T}),t.revertGamma();break;case Kt:t.gammaCorrected();var C=t.toHsl(),S=C.h,E=C.s,P=C.l;t.setHsl({h:S,s:E,l:P+i}),t.revertGamma();break;case Qt:t.r=i;break;case Jt:t.r=Math.min(t.r*i,1);break;case Zt:t.r=Object(H.h)(0,t.r+i,1);break;case $t:t.gammaCorrected();var L=t.toScRgb(),A=L.r,I=L.g,R=L.b;if(Object(H.k)(A-I)&&Object(H.k)(I-R))t.setRgb(Lt(A,i));else{var O=t.toHsl(),M=O.h,D=O.l;t.setHsl({h:M,arg:i,l:D})}t.revertGamma();break;case en:t.gammaCorrected();var N=t.toHsl(),B=N.h,j=N.s,F=N.l;j*=i,t.setHsl({h:B,s:j,l:F}),t.revertGamma();break;case tn:t.gammaCorrected();var G=t.toScRgb(),U=G.r,W=G.g,Y=G.b;if(Object(H.k)(U-W)&&Object(H.k)(W-Y))t.setRgb(Lt(U,i));else{var z=t.toHsl(),X=z.h,V=z.s,q=z.l;V+=i,t.setHsl({h:X,s:V,l:q})}t.revertGamma();break;case nn:t.r*=i,t.g*=i,t.b*=i;break;case an:t.r=t.r*i+1-i,t.g=t.g*i+1-i,t.b=t.b*i+1-i}return t}}},{key:"setTransforms",value:function(e){this._data.transOp=e}},{key:"addTransform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._data.transOp.push({op:e,val:t})}},{key:"getTransform",value:function(e){for(var t=this._data.transOp||[],n=0;n<t.length;n++)if(t[n].op===e)return t[n].val;return null}},{key:"setTransformValue",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,a=this._data.transOp||[],o=0;o<a.length;o++)a[o].op===e&&(a[o].val=t,i=!0);n&&!i&&(a.push({op:e,val:t}),this._data.transOp=a)}},{key:"removeTransform",value:function(e){for(var t=this._data.transOp||[],n=0;n<t.length;)t[n].op===e?t.splice(n,1):n++}},{key:"removeNoMattersTransform",value:function(){for(var e=this._data.transOp||[],t=0;t<e.length;++t)e[t].op!=At&&e[t].op!=It&&e[t].op!=Rt&&(e.splice(t,1),t--)}},{key:"setOpacity",value:function(e){this.setTransformValue(At,e,!0)}},{key:"type",get:function(){return this._data&&this._data.type}},{key:"data",get:function(){return this._data}}],[{key:"fromString",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=un.fromString(t),a={type:ht.SRgb,isAutoColor:!1,toRGB:i.toString(),sRgb:i.toInt()};return null!=n&&(a.transOp=n),new e(a)}},{key:"fromScRgb",value:function(t){return new e({type:ht.SRgb,isAutoColor:!1,toRGB:t.toString(),sRgb:t.toInt()})}},{key:"fromPreset",value:function(t){var n=cn(t),i=un.fromInt(n);return new e({type:ht.Preset,isAutoColor:!1,preset:t,toRGB:i.toString()})}},{key:"fromPalette",value:function(t){var n=un.fromPalette(t);return new e({type:ht.Palette,isAutoColor:n.isAutoColor,preset:t,toRGB:n.toString()})}},{key:"fromSystem",value:function(t){var n=un.fromPalette(t);return new e({type:ht.System,isAutoColor:n.isAutoColor,preset:t,toRGB:n.toString()})}},{key:"defaultColor",get:function(){return new e({type:ht.ScRgb,isAutoColor:!1,r:1,g:1,b:1,toRGB:"#ffffff"})}},{key:"blackColor",get:function(){return new e({type:ht.ScRgb,isAutoColor:!1,r:0,g:0,b:0,toRGB:"#000000"})}},{key:"defaultFillColor",get:function(){return e.fromPreset(e.PresetBlack)}}]),e}();dn.PresetBlack=7;var hn=8,pn=16777215,fn=4278190080,gn=240,vn=241,yn=242,mn=243,_n=244,xn=245,wn=246,kn=247,bn=255,Tn=3840,Cn=256,Sn=512,En=768,Pn=1024,Ln=16711680,An=16;function In(e,t){var n=function(e){return(((e=Math.floor(e))&Ln)>>An)/255}(t);switch(t&Tn){case Cn:e.addTransform(nn,n);break;case Sn:e.addTransform(an,n);break;case En:e.addTransform(Zt,n),e.addTransform(Gt,n),e.addTransform(Dt,n);break;case Pn:e.addTransform(Zt,-1*n),e.addTransform(Gt,-1*n),e.addTransform(Dt,-1*n)}}var Rn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s()(this,e),this.colorScheme=t,this.colorMap=n,this.phColor=null==i?dn.defaultColor:i}return c()(e,[{key:"setColorScheme",value:function(e){this.colorScheme=e}},{key:"setColorMapping",value:function(e){this.colorMap=e}},{key:"setPalette",value:function(e){this.palette=e}},{key:"setPhColor",value:function(e){this.phColor=e?e.clone():dn.defaultColor}},{key:"setShape",value:function(e){this.shape=e}},{key:"setTheme",value:function(e){this.theme=e}},{key:"setStyle",value:function(e){this.style=e}},{key:"setColorUsedFor",value:function(e){var t=this.style;if(t){var n=null;"fill"==e?n=t.fillColor:"line"==e?n=t.lineColor:"font"==e?n=t.fontColor:"effects"==e&&(n=t.effectsColor),n?this.setPhColor(new dn(n)):this.setPhColor(null)}}},{key:"interpret",value:function(e){var t=e instanceof dn,n=e&&(t?e.data:e),i=null;switch(n&&n.type){case ht.Scheme:var a=n.scheme===Ct;i=this.interpretScheme(n.scheme),a&&i&&i.type===ht.Scheme&&i.data&&i.data.scheme===Ct&&(i=null);break;case ht.Palette:i=this.interpretPalette(n.palette);break;case ht.LegacyRef:i=this.interpretLegacyRef(t?e:new dn(e))}if(i){if(n.transOp)for(var o=0;o<n.transOp.length;++o){var r=n.transOp[o];i.setTransformValue(r.op,r.val,!0)}return i.type!=ht.Scheme&&i.type!=ht.Palette&&i.type!=ht.LegacyRef||(i=this.interpret(i)),t?i:i.data}return e}},{key:"interpretScheme",value:function(e){return e===Ct?this.phColor.clone():(this.colorMap&&(e=this.colorMap.mapColor(e)),this.colorScheme&&pt<=e&&e<=xt?new dn(m(this.colorScheme.getColor(e))):dn.blackColor)}},{key:"interpretPalette",value:function(e){if(32767===e){var t=un.fromInt(ln(hn));return dn.fromScRgb(t)}if(this.palette&&e<this.palette.length)return dn.fromScRgb(un.fromInt(this.palette[e]));var n=window.APP.presentation,i=n&&n.private.globalPalette;return i&&e<i.length?dn.fromScRgb(ln(e)):dn.defaultColor}},{key:"interpretLegacyRef",value:function(e){var t=e.legacyRef,n=65535&t;if(n<240){var i=ln(n+18);return dn.fromScRgb(un.fromSrgb(16777215&i))}if(!this.shape)return dn.defaultColor;var a=new dn(function(e,t){var n=t&bn;switch(n){case gn:var i=e.getFill();if(i)return i.color?i.color:dn.defaultFillColor;break;case vn:var a=e.getFill();if(a)return a.color?a.color:dn.defaultFillColor;var o=e.getOutline();if(o){var r=o.fill||{type:0};return r.color?r.color:dn.defaultFillColor}break;case yn:var s=e.getOutline();if(s){var l=s.fill||{type:0};return l.color?l.color:dn.defaultFillColor}break;case mn:var c=e.getEffects();if(c)return c.legacyShadow.primaryColor;break;case _n:case xn:case wn:case kn:case bn:break;default:var u=ln(n+18),d=un.fromSrgb(16777215&u);return dn.fromScRgb(d).data}return dn.defaultColor}(this.shape,t));a.addTransform(Bt),In(a,t),a.addTransform(Xt);var o=e.getTransform(At);return null!=o?a.setTransformValue(At,o)&&a.addTransform(At,o):a.removeTransform(At),a}}]),e}();function On(e,t){for(var n=[],i=0;i<t.length;i++){var a=m(e);a.transOp=a.transOp||[],a.transOp.push(m(t[i]));var o=new dn(a);a.toRGB=o.toRGB(),n.push(a)}return n}function Mn(e,t,n){for(var i=[],a=0;a<n.length;a++)i.push({op:t,val:n[a]});return On(e,i)}function Dn(e,t){if(null==e)return null;var n=m(e.primary?e.primary:e),i=new dn(n);t&&(i=t.interpret(i));var a=i.toScRgb(t),o=a.toString(),r=a.toString({hasAlpha:!1}),s=a.toRGB(),l=s.r,c=s.g,u=s.b,d=s.a,h="rgba("+l+","+c+","+u+","+(d/=255)+")",p=a.toInt();return{type:ht.SRgb,sRgb:p,toRGB:o,scheme:e.scheme,rgba:h,hex:r,alpha:d,primary:n}}var Nn=function(){function e(t){s()(this,e),this._tags=t}return c()(e,[{key:"setTags",value:function(e){e&&(this._tags=e)}},{key:"getTags",value:function(){return this._tags}},{key:"getTemplateCategory",value:function(){return this._getTag("KSO_WM_TEMPLATE_CATEGORY")}},{key:"getTemplateIndex",value:function(){return this._getTag("KSO_WM_TEMPLATE_INDEX")}},{key:"getDiagramGroupCode",value:function(){return this._getTag("KSO_WM_DIAGRAM_GROUP_CODE")}},{key:"getUnitTypeCode",value:function(){return this._getTag("KSO_WM_UNIT_TYPE")}},{key:"getUnitSerialNo",value:function(){var e=this._getTag("KSO_WM_UNIT_INDEX");return e||(e=this.getSimulateUnitSerialByUnitType()),e}},{key:"getSimulateUnitSerialByUnitType",value:function(){var e=this.getUnitTypeCode();if(e){for(var t="",n=e.split("_").length-1;n>-1;--n)t+="1_";return t.splice(t.length-1,1)}return"1"}},{key:"isDiagramShape",value:function(){var e=this.getUnitTypeCode(),t=e&&e.split("_")[0]||"";return"l"===t||"m"===t||"n"===t||"o"===t||"p"===t||"q"===t||"r"===t||"δ"===t||"ε"===t||"ζ"===t}},{key:"isSameDiagram",value:function(e){return this.getRootDiagramId()===e.getRootDiagramId()}},{key:"getDiagramId",value:function(){return(this.getTemplateCategory()||"diagram")+"*"+this.getTemplateIndex()+"*"+this.getDiagramGroupCode()+"*"+this.getUnitTypeCode()+"*"+this.getUnitSerialNo()}},{key:"getRootDiagramId",value:function(){var e=this.getTemplateCategory()||"diagram",t=this.getTemplateIndex(),n=this.getDiagramGroupCode(),i=this.getUnitTypeCode(),a=i&&i.split("_")[0]||"",o=this.getUnitSerialNo();return e+"*"+t+"*"+n+"*"+a+"*"+(o&&o.split("_")[0]||"")}},{key:"_getTag",value:function(e){if(this._tags)for(var t=0;t<this._tags.length;++t){var n=this._tags[t];if(n.name===e)return n.value}}}]),e}(),Bn=function(){function e(){s()(this,e)}return c()(e,null,[{key:"getDiagramGroup",value:function(e){if(null!=e){var t=e.getShapeTree();if(t){for(var n={},i=function(e){e.forEach((function(e){if(e.isDiagramShape()){var t=new Nn(e.getTags()).getRootDiagramId();n[t]=n[t]||[],n[t].push(e)}}))},a=t.private.childs,o=0;o<a.length;++o){var r=a[o];if(r.hasTags())if(r.isGroupShape())i(r.getChildShapesRecurse());else i([r]);else if(r.isGroupShape())for(var s=r.getChildShapesRecurse(),l=0;l<s.length;++l){var c=s[l];c.hasTags()&&i([c])}}var u=function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isChildShape()){var i=n.visual.getRootShape();e.includes(i)||e.push(i),e.splice(t--,1)}}};for(var d in n){u(n[d])}return n}}}},{key:"isDiagramShape",value:function(e){if(!e)return!1;var t=e.getTags();return new Nn(t).isDiagramShape()}},{key:"isDiagramSubShape",value:function(t,n){return null!=e.getRootDiagramId(t,n)}},{key:"getRootDiagramId",value:function(t,n){if(!t||!n)return null;if(!n.hasTags()){if(!n.isGroupShape())return;var i=n.getChildShapesRecurse((function(e){var t=e.getTags();return!!t&&"diagram"===new Nn(t).getTemplateCategory()}));if(null==i||0===i.length)return}var a=function e(t,n){if(!n.isGroupShape())return t.getId()===n.getId();for(var i=n.childShapes,a=0;a<i.length;++a)if(e(t,i[a]))return!0},o=e.getDiagramGroup(t);for(var r in o)for(var s=o[r],l=0;l<s.length;++l){if(n.getId()===s[l].getId())return r;if(s[l].isGroupShape()&&a(n,s[l]))return r}}}]),e}(),jn=function(e){function t(e){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),c()(t,[{key:"getBackgroundVisual",value:function(){var e=this.getSlideVisual();return e&&e.getBackgroundVisual()}},{key:"isRootShape",value:function(){var e=this._coredata.parent;return e&&e.isShapeTree}},{key:"getRootShape",value:function(){for(var e=this._coredata;e;){var t=e.parent;if(t&&t.isShapeTree)break;e=t}return e}},{key:"getCompleteProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this._coredata,a=function(n){return null!=t?t(n):n.private[e]};if(i.isPlaceHolder()){var o=a(i),r=[o],s=i.getSlideFollowing();if(s)for(var l=s.getPhShapes(i),c=0;c<l.length;c++){var u=a(l[c].shape);r.splice(0,0,u)}var d=Object.assign({bClone:!0},n);return st(r,d)}return a(i)}},{key:"getAllProperties",value:function(){var e=this.coredata.getProperty();return e.transform2D=this.getTransform2D(),e.geometry2D=this.getGeometry2D(),e.fill=this.getFill(),e.outline=this.getOutline(),e.effects=this.getEffects(),e.scene3D=this.getScene3D(),e.shape3D=this.getShape3D(),e.picture=this.getPicture(),e}},{key:"isBackgroundFillUsed",value:function(){var e=this.coredata.getFill();return(!e||e.type===$e.a.FillTypeBackground)&&this.coredata.private.backgroundFillUsed}},{key:"getFillProp",value:function(){var e=this._coredata,t=e.getFill(),n=null,i=e.getStyle();if(i&&null!=i.fillIndex){var a=this.getTheme();a&&(n=m(a.getFormatScheme().getFillAt(i.fillIndex)))}return n&&t&&n.type===t.type?st([n,t],lt):m(t||n)}},{key:"getFill",value:function(){var e=this;if(this.isBackgroundFillUsed()){if(this.isBackground())return this.getFillProp();var t=this.getBackgroundVisual();return t&&t.getFill()}var n=this.getCompleteProperty("fill",(function(t){var n=t.visual,i=n.getFillProp();if(i)if(i.type===$e.a.FillTypeGroup){var a=n.getParent();i=a?a.getFill():null}else if(i.type===$e.a.FillTypeBackground)if(e.isBackground())i=null;else{var o=e.getBackgroundVisual();i=o&&o.getFillProp()}return i}),lt);return n||(n={type:$e.a.FillTypeNone}),n}},{key:"setFill",value:function(e){var t=this._coredata;return t.getShapeGroup()!==E.LineGroup?t.setFill(e):{newval:{}}}},{key:"setOpacity",value:function(e){var t=this.getFillProp();if(t&&(t.type===$e.a.FillTypeSolidColor||t.type===$e.a.FillTypeBlip||t.type===$e.a.FillTypeGradient||t.type===$e.a.FillTypePattern)){var n=m(t),i=window.CoreUtils.createModifier("Color",n.color);return i.setOpacity(e),n.color=i.modifiedData(),n._isFullValue=!0,this.setFill(n)}return{newval:{}}}},{key:"getOutlineProp",value:function(){var e=this._coredata,t=e.getOutline(),n=null,i=e.getStyle();if(i&&null!=i.lineIndex){var a=this.getTheme();a&&(n=m(a.getFormatScheme().getLineAt(i.lineIndex)))}return st([n,t],ut)}},{key:"getOutline",value:function(){return this.getCompleteProperty("outline",(function(e){return e.visual.getOutlineProp()}),ut)}},{key:"setOutline",value:function(e){return this._coredata.setOutline(e)}},{key:"setPicture",value:function(e){return this._coredata.setPicture(e)}},{key:"getTransform2D",value:function(){var e=m(this.getCompleteProperty("transform2D"));return e||{x:0,y:0,width:1440,height:1440,horizontalFlipped:!1,rotation:0,verticalFlipped:!1}}},{key:"geometryTransform",value:function(){var e=this.getTransform2D();if(this.coredata.isChildShape()){if(e.width<0||e.height<0)return Object.assign(e,{x:0,y:0,width:0,height:0});var t=this.getParent(),n=t.geometryTransform(),i=t.coredata.private,a=i.childOffset,o=i.childExtents,r=o.width,s=o.height,l={x:e.x-a.x,y:e.y-a.y,width:e.width,height:e.height};if(r>0||s>0){var c=1,u=1;Object(H.k)(r)||(c=n.width/r),Object(H.k)(s)||(u=n.height/s);var d=this.calcShapePosData(l,c,u,e.rotation);return Object.assign(e,d)}return Object.assign(e,l)}return e.x=e.x*(1/635),e.y=e.y*(1/635),e.width=(e.width||1)*(1/635),e.height=(e.height||1)*(1/635),e}},{key:"getRotationProp",value:function(){return this.getTransform2D().rotation}},{key:"getRotation",value:function(){for(var e=this.getRotationProp(),t=this.getParent();t;){var n=t.coredata;if(!n||!n.isGroupShape()||n.isShapeTree)break;var i=t.getTransform2D(),a=i.horizontalFlipped,o=i.verticalFlipped;e=i.rotation+e*(a?-1:1)*(o?-1:1),t=t.getParent()}return Ke(e)}},{key:"getAnchorRect",value:function(){var e=this._rect(),t={x:e.x+e.width/2,y:e.y+e.height/2},n=this.calcTransFromCurrent2Layer().Map(t);return new window.Rect(n.x-e.width/2,n.y-e.height/2,e.width,e.height)}},{key:"getRealTransform2D",value:function(){for(var e=this._coredata,t=this.getAnchorRect().getRect(),n=this.getTransform2D(),i=n.horizontalFlipped,a=n.verticalFlipped,o=e.parent;o&&o.isGroupShape()&&!o.isShapeTree;){var r=o.visual.getTransform2D();i=i!==r.horizontalFlipped,a=a!==r.verticalFlipped,o=o.parent}var s=this.getRotation();return{x:635*t.x,y:635*t.y,width:635*t.width,height:635*t.height,rotation:s,horizontalFlipped:i,verticalFlipped:a}}},{key:"getConnectionSiteCount",value:function(){if(this.connectionSites)return this.connectionSites.length;var e=this.getGeometry2D(),t=e&&e.getGeometry();return t&&t.getConnectionCount()}},{key:"setConnectionSites",value:function(e){this.connectionSites=e}},{key:"getConnectionSites",value:function(){if(!this.connectionSites){var e=this.getGeometry2D().geometry;this.connectionSites=e&&e.getConnectionSites()}return this.connectionSites}},{key:"transform2DScale",value:function(){var e=this._coredata,t={width:1,height:1};if(!e.parent)return t;for(var n=e.parent;n&&n.isGroupShape()&&!n.isShapeTree;){var i=n.private.childExtents,a=n.visual.getTransform2D();i.width&&(t.width=t.width*(a.width/i.width)),i.height&&(t.height=t.height*(a.height/i.height)),n=n.parent}return t.width=0===t.width?1:t.width,t.height=0===t.height?1:t.height,t}},{key:"transform2DRelativeToParent",value:function(e){var t={};if(this.coredata.isChildShape()){var n={x:e.x*(1/635),y:e.y*(1/635),width:e.width*(1/635),height:e.height*(1/635)},i=this.layerRectToCurrentRect(n),a=this.getParent(),o=a.calcChildPosData(i,a.getRotationProp());t=Object.assign({},e,o);var r=a.getRealTransform2D(),s=r.horizontalFlipped!==r.verticalFlipped,l=Ke(e.rotation);l=(l-r.rotation)*(s?-1:1),t.rotation=Ke(l),t.horizontalFlipped=e.horizontalFlipped!==r.verticalFlipped,t.verticalFlipped=e.verticalFlipped!==r.verticalFlipped}else t=Object.assign({},e);return t}},{key:"calcShapeRect",value:function(){var e=this.getTransform2D(),t=e.x+e.width/2,n=e.y+e.height/2,i=e.x,a=e.y,o=e.width,r=e.height;return this.isSwapWidthAndHeight(e.rotation)&&(i=t-r/2,a=n-o/2,o=e.height,r=e.width),{left:Qe(i),top:Qe(a),right:Qe(i+o),bottom:Qe(a+r)}}},{key:"updatePosInfo",value:function(){var e=this._coredata,t=e.parent,n=e.isChildShape();if(e.isGroupShape()){for(var i=e.private.childs,a=[],o=0;o<i.length;o++){var r=i[o].visual.calcShapeRect();a.push({shape:i[o],rect:r})}if(a.length>0){for(var s=a[0].rect,l=1;l<a.length;l++)s=this.caleMaxBound(s,a[l].rect);s.x=s.left,s.y=s.top,s.width=s.right-s.left,s.height=s.bottom-s.top;var c=e.private.childOffset,u=e.private.childExtents,d=Object.assign({},c,u),h=0===d.width?0:(s.x-d.x)/d.width,p=0===d.height?0:(s.y-d.y)/d.height,f=this.getTransform2D(),g={x:f.x,y:f.y},v={width:f.width,height:f.height},y={x:g.x+v.width/2,y:g.y+v.height/2},m={x:g.x+h*v.width,y:g.y+p*v.height},_={width:0===d.width?0:v.width*s.width/d.width,height:0===d.height?0:v.height*s.height/d.height},x={x:m.x+_.width/2,y:m.y+_.height/2},w=this.calcFlipRotatedTransform(y,Ke(f.rotation),f.horizontalFlipped,f.verticalFlipped).Map(x);f.x=w.x-_.width/2,f.y=w.y-_.height/2,f.width=_.width,f.height=_.height,e.setPropertyValue("childOffset",{x:s.x,y:s.y}),e.setPropertyValue("childExtents",{width:s.width,height:s.height}),e.setPropertyValue("transform2D",f),n&&t.visual.updatePosInfo()}}else n&&t.visual.updatePosInfo()}},{key:"modifyShapeTransform2D",value:function(e){}},{key:"_dealInkShapeFlip",value:function(e,t,n){var i=this;e.isGroupShape()&&e.getChilds().forEach((function(e){(e.isInk()||e.isGroupShape())&&i._dealInkShapeFlip(e,t,n)}));if(e.isInk()){var a=m(e.getInkData()),o=a.vecTrace;if(o.length&&o[0].vecPoints.length){for(var r=o[0].vecPoints[0].px,s=o[0].vecPoints[0].py,l=r,c=s,u=0,d=o.length;u<d;u++)for(var h=o[u].vecPoints,p=0,f=h.length;p<f;p++){var g=h[p],v=g.px,y=g.py;v>l?l=v:v<r&&(r=v),y>c?c=y:y<s&&(s=y)}for(var _={x:r+(l-r)/2,y:s+(c-s)/2},x=this.calcFlipRotatedTransform(_,0,t,n),w=0,k=o.length;w<k;w++){for(var b=o[w].vecPoints,T=x.Map({x:b[0].px,y:b[0].py}),C=T.x+" "+T.y,S=0,E=b.length;S<E;S++){var P=b[S],L=x.Map({x:P.px,y:P.py});if(b[S]={px:L.x,py:L.y},S>0)C+=","+(L.x-T.x)+" "+(L.y-T.y),T=L}o[w].strPoints=C}}e.setInkData(a)}}},{key:"_calcFlipRotation",value:function(e,t,n,i){var a=this.getTransform2D(),o=this.coredata,r={};if(o.canRotate()&&null!=t&&e.horizontalFlipped!==t&&(a.horizontalFlipped=!a.horizontalFlipped,r.horizontalFlipped=t,this.coredata.isInk()||(i=Ke(null==i?-e.rotation:i))),o.canRotate()&&null!=n&&e.verticalFlipped!==n&&(a.verticalFlipped=!a.verticalFlipped,r.verticalFlipped=n,this.coredata.isInk()||(i=Ke(null==i?-e.rotation:i))),null!=i&&e.rotation!==i){if(this.coredata.isChildShape()){var s=this.getParent().getRealTransform2D(),l=s.horizontalFlipped!==s.verticalFlipped;a.rotation=Ke((i-s.rotation)*(l?-1:1))}else a.rotation=Ke(a.rotation+(i-e.rotation));r.rotation=i}return{transform2d:a,changed:r}}},{key:"setRotation",value:function(e){var t=this._calcFlipRotation(this.getRealTransform2D(),null,null,e),n=t.transform2d,i=t.changed;return this.coredata.setTransform2D(n),{newval:{transform2DInfo:{flipRotation:i}}}}},{key:"setAnchorRect",value:function(e){var t=X.create(e),n=t.getRect(),i=this.getTransform2D(),a=void 0;if(this.coredata.isChildShape()){var o=this.layerRectToCurrentRect(n),r=this.getParent().calcChildPosData(o,this.getRotation());a=Object.assign({},i,r)}else a=Object.assign({},i,{x:635*n.x,y:635*n.y,width:635*n.width,height:635*n.height});var s=this.coredata,l=s.setTransform2D(a);if(l&&!s.isGroupShape()&&(i.width!==a.width||i.height!==a.height))for(var c=s.private.childs,u=a.width/i.width,d=a.height/i.height,h=0;h<c.length;h++){var p=c[h];if(p.modifySize){if(!p.modifySize(u,d))return}else if(p.visual&&p.visual.modifySize&&!p.visual.modifySize(u,d))return}if(this.coredata.isChildShape()){var f=this.getParent();f&&f.updatePosInfo()}if(l)return{newval:{rect:t.getAlignedBounds()}}}},{key:"setAnchorOffset",value:function(e){var t=this.getAnchorRect();t.moveTopLeft(e),this.setAnchorRect(t.getRect())}},{key:"setAnchorSize",value:function(e){var t=this.getAnchorRect();t.setSize(e),this.setAnchorRect(t.getRect())}},{key:"modifySize",value:function(e,t){var n=this.getAnchorRect();return this.setAnchorRect({x:n.x(),y:n.y(),width:n.width()*e,height:n.height()*t})}},{key:"setGeometry2D",value:function(e){return this.coredata.setGeometry2D(e)}},{key:"getGeometry2D",value:function(){var e=this._coredata;return e.hasTable()?e.private.geometry2D:this.getCompleteProperty("geometry2D",(function(e){return e.getGeometry2D()}),{deeps:0,clone:function(e){return e}})}},{key:"getEffectsProp",value:function(){var e=this.coredata,t=e.getEffects();if(!t){var n=e.getStyle();if(n&&null!=n.effectsIndex){var i=this.getTheme();i&&(t=i.getFormatScheme().getEffectsAt(n.effectsIndex))}}return m(t)}},{key:"getEffects",value:function(){return this.getCompleteProperty("effects",(function(e){return e.visual.getEffectsProp()}))}},{key:"getScene3DProp",value:function(){var e=this.coredata,t=e.getScene3D();if(!t){var n=e.getStyle();if(n&&null!=n.effectsIndex){var i=this.getTheme();i&&(t=i.getFormatScheme().getScene3dAt(n.effectsIndex))}}return m(t)}},{key:"getScene3D",value:function(){return this.getCompleteProperty("scene3D",(function(e){return e.visual.getScene3DProp()}))}},{key:"getShape3DProp",value:function(){var e=this.coredata,t=e.getShape3D();if(!t){var n=e.getStyle();if(n&&null!=n.effectsIndex){var i=this.getTheme();i&&(t=i.getFormatScheme().getShape3dAt(n.effectsIndex))}}return m(t)}},{key:"getShape3D",value:function(){return this.getCompleteProperty("shape3D",(function(e){return e.visual.getShape3DProp()}))}},{key:"getPicture",value:function(){return m(this.coredata.private.picture)}},{key:"getColorScheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){var t=e.colorScheme,n=this.coredata.getStyle();return n&&n.fillColor&&t.setPhColor(new dn(n.fillColor)),t.setShape(this.coredata),t}return this.coredata.colorScheme}},{key:"setSimpleProperties",value:function(e){var t={};for(var n in e){var i=e[n];this.coredata.setPropertyValue(n,m(i)),null!=i?t[n]=m(i):(t.undefineds||(t.undefineds=[]),t.undefineds.push(n))}return{newval:t}}},{key:"getShapeTextStyle",value:function(){var e=this.getShapeTextStyleSheets();if(e&&!e.bMerged){var t=st(e.styles,{deeps:2,bClone:!0}),n=(t||{}).fontColor,i={chpStyles:[],paraStyles:[]};if(n)for(var a=0;a<9;a++)i.chpStyles.push({prop:{textColor:{type:2,color:n}}});e.style=t,e.textStyle=i,e.bMerged=!0}return e.style}},{key:"getShapeTextStyleSheets",value:function(){var e=this.coredata,t=[{shape:e}],n=null;if(e.isPlaceHolder()){var i=e.getSlide(),a=i&&i.getFollowing();if(a)for(var o=a.getPhShapes(e),r=0;r<o.length;r++)t.splice(0,0,o[r]);n=t}for(var s="",l=[],c=0;c<t.length;c++){var u=t[c].shape;s+=u.data_token;var d=u.getStyle();d&&l.push(d)}if(s=function(e){for(var t=5381,n=e.length-1;n>-1;n--)t+=(t<<5)+e.charCodeAt(n);var i=2147483647&t,a="";do{a+=dt[63&i],i>>=6}while(i);return a}(s),this._shapeStyle&&s===this._shapeStyle.styleToken)return this._shapeStyle;for(var h=[],p=0;p<l.length;p++){var f=(l[p]||{}).fontColor,g={chpStyles:[],paraStyles:[]};if(f)for(var v=0;v<9;v++)g.chpStyles.push({prop:{textColor:{type:2,color:f}}});h.push(g)}return this._shapeStyle={styleToken:s,shapes:n,style:null,textStyle:null,styles:l,textStyles:h,bMerged:!1},this._shapeStyle}},{key:"getTextStyle",value:function(e,t){var n=this.getTextStyleSheets(e,t);return n&&!n.bMerged&&(n.style=st(n.styles,ct),n.bMerged=!0),n}},{key:"getTextStyleSheets",value:function(e){return null}},{key:"useMasterTextStyle",value:function(){return!1}},{key:"getTagsWrapper",value:function(){if(!this.coredata.hasTags())return null;var e=this.coredata.getTags();return new Nn(e)}},{key:"interpretTextBoxRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.coredata;return n.hasTxGeometry2D()?n.getTxGeometry2D().interpretTextBoxRect(e,t):n.getGeometry2D().interpretTextBoxRect(e,t)}},{key:"updateShapeAnchorRect",value:function(e){}},{key:"calCurShapeRect2LayerRect",value:function(e){if(e){var t=e.center(),n=this.calcTransFromCurrent2Layer(),i={},a=this.transform().inverted(i).multiply(n);if(i.invertible){var o=a.mapPoint(t);return new X(o.x()-e.width()/2,o.y()-e.height()/2,e.width(),e.height())}}}}]),t}(Ze),Fn=function(e){function t(e){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),c()(t,[{key:"setFill",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=B()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setFill",this).call(this,e);if(i&&n){for(var a=!0,o=this._coredata.childShapes,r=0;r<o.length&&(o[r].isInk()||(a=!!o[r].visual.setFill({type:6,_isFullValue:!0},n)));r++);if(!a)return null}return i}},{key:"setOpacity",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=B()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setOpacity",this).call(this,e);if(i&&n){for(var a=!0,o=this._coredata.childShapes,r=0;r<o.length&&(a=!!o[r].visual.setOpacity(e,n));r++);if(!a)return null}return i}},{key:"calcChildPosData",value:function(e,t){var n=this.coredata.private,i=n.childOffset,a=n.childExtents;if(a.width>0&&a.height>0){var o=this.geometryTransform(),r=o.width/a.width,s=o.height/a.height,l=this.calcShapePosData(e,1/r,1/s,t);return l.x=l.x+i.x,l.y=l.y+i.y,l}return{x:0,y:0,width:0,height:0}}}]),t}(jn),Hn=function(e){function t(e){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),c()(t,[{key:"isBackground",value:function(){return!0}},{key:"geometryTransform",value:function(){var e=this.getSlideVisual();return e?e.geometryTransform():{x:0,y:0,width:1,height:1,horizontalFlipped:!1,verticalFlipped:!1,rotation:0}}}]),t}(jn);var Gn=n(1092),Un=function(){function e(t){s()(this,e),this.private=t?t.data:{}}return c()(e,[{key:"clone",value:function(){return new e(m(this.type))}},{key:"shadowClone",value:function(){var t=this.private,n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return new e({data:n})}},{key:"getPaths",value:function(){return this.private.paths}},{key:"setPaths",value:function(e){this.private.paths=e}},{key:"isCustomGeometry",value:function(){return null!=this.private.paths}},{key:"hasGeometry2DData",value:function(){return null!=this.getGeometrySvrObj()}},{key:"isClosedCurve",value:function(){if(!this.isCustomGeometry())return!1;var e=this.getPaths(),t=e&&e[0];return!!t&&(t.commands&&t.commands.slice(-1)[0]===G.d.Close)}},{key:"setEnv",value:function(e,t){this.geometry=e,this.sink=t}},{key:"interpretPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.sink&&this.geometry){var i=this.sink;return this.geometry.interpretPathList(i,e,t,n),i.pathList}console.warn("this Geomerty is not set environment！！！")}},{key:"setDataToken",value:function(e){this.dataToken=e}},{key:"getDataToken",value:function(){return this.dataToken}},{key:"setAdjustValues",value:function(e){this.type&&(this.type.data.hasOwnProperty("adjustValues")||(this.type.data.adjustValues={}),this.type.data.adjustValues=e)}},{key:"getGeometry",value:function(){if(this.geometry)return this.geometry;console.error("geomerty is not interpret!!")}},{key:"getGeometryType",value:function(){var e=this.type.data;return e&&e.presetType?e.presetType:null}},{key:"setProp",value:function(e,t){e&&t&&(this.type.data[e]=t)}},{key:"getGeometrySvrObj",value:function(){return this.type}},{key:"isPathsAttributesHasWH",value:function(){for(var e=this.geometry.geometry.definition.paths,t=0;t<e.length;t++){var n=e[t];return n.attributes&&n.attributes.w&&n.attributes.h}}},{key:"getDefinition",value:function(){return this.geometry&&this.geometry.getDefinition()}},{key:"calcRefXAdjMax",value:function(e,t,n,i){var a=void 0,o=void 0;e.isPolar?(o=e.maxR,a="gdRefR"):(o=e.maxX,a="gdRefX");var r={};return r[e[a]]=o,this.updateAdjXY(n,i,t,r)}},{key:"calcRefXAdjMin",value:function(e,t,n,i){var a=void 0,o=void 0;e.isPolar?(o=e.minR,a="gdRefR"):(o=e.minX,a="gdRefX");var r={};return r[e[a]]=o,this.updateAdjXY(n,i,t,r)}},{key:"calcRefYAdjMax",value:function(e,t,n,i){var a=void 0,o=void 0;e.isPolar?(o=e.maxAng,a="gdRefAng"):(o=e.maxY,a="gdRefY");var r={};return r[e[a]]=o,this.updateAdjXY(n,i,t,r)}},{key:"calcRefYAdjMin",value:function(e,t,n,i){var a=void 0,o=void 0;e.isPolar?(o=e.minAng,a="gdRefAng"):(o=e.minY,a="gdRefY");var r={};return r[e[a]]=o,this.updateAdjXY(n,i,t,r)}},{key:"updateAdjXY",value:function(e,t,n,i){var a=this.getDefinition(),o=this.geometry.getNameTable(),r=void 0;r=o.w==e&&o.h==t?o:new a.Guides,Object.assign(r,{w:e,h:t},this.adjustValues,i);var s=a.adjustHandles[n],l=s.x,c=s.y;return"string"==typeof l&&(l=r[l]),"string"==typeof c&&(c=r[c]),{x:l,y:c}}},{key:"calcAdjustValue",value:function(e,t,n,i){if(!this.geometry)return[];var a=!1,o=!1,r=t.isPolar;switch(this.getAdjType(t)){case G.a.gdRefR:r=!0;case G.a.gdRefX:a=!0;break;case G.a.gdRefAng:r=!0;case G.a.gdRefY:o=!0;break;case G.a.gdRefPolar:r=!0;case G.a.gdRefXY:a=o=!0}var s=[];return a&&s.push(this.updateAdjustValueForRefX(e,t,n,i,r)),o&&s.push(this.updateAdjustValueForRefY(e,t,n,i,r)),s}},{key:"getAdjType",value:function(e){return e.gdRefX&&e.gdRefY?G.a.gdRefXY:e.gdRefX?G.a.gdRefX:e.gdRefY?G.a.gdRefY:e.gdRefR&&e.gdRefAng?G.a.gdRefPolar:e.gdRefR?G.a.gdRefR:e.gdRefAng?G.a.gdRefAng:void console.warn("may adj type has a error")}},{key:"updateAdjustValueForRefX",value:function(e,t,n,i,a){var o=null!=t.maxX?t.maxX:t.maxR,r=null!=t.minX?t.minX:t.minR,s=this.calcRefXAdjMin(t,n,i.width,i.height),l=this.calcRefXAdjMax(t,n,i.width,i.height),c=s.x,u=l.x,d=e.x,h=t.gdRefX;return a&&(c=this.cartToPolar(s,i).x,u=this.cartToPolar(l,i).x,d=this.cartToPolar(e,i).x,h=t.gdRefR),{name:h,value:this.calcAjustValue(d,c,u,r,o)}}},{key:"updateAdjustValueForRefY",value:function(e,t,n,i,a){var o=null!=t.maxY?t.maxY:t.maxAng,r=null!=t.minY?t.minY:t.minAng,s=this.calcRefYAdjMin(t,n,i.width,i.height),l=this.calcRefYAdjMax(t,n,i.width,i.height),c=s.y,u=l.y,d=e.y,h=t.gdRefY,p=void 0;return a?(c=this.cartToPolar(s,i).y,u=this.cartToPolar(l,i).y,d=this.cartToPolar(e,i).y,h=t.gdRefAng,"circularArrow"===this.getGeometryType()&&(u=this.recalcForCircularArrow(h,c,u)),p=this.calcAngelAdjustValue(d,c,u,r,o)):p=this.calcAjustValue(d,c,u,r,o),{name:h,value:p}}},{key:"cartToPolar",value:function(e,t){var n=e.x-t.width/2,i=e.y-t.height/2,a=Math.sqrt(n*n+i*i),o=Math.atan2(i,n);return o<0&&(o+=2*Math.PI),{x:a,y:o}}},{key:"calcAjustValue",value:function(e,t,n,i,a){if(o=t-n,Math.abs(o)<=1e-12)return i;var o,r=Math.min(t,n),s=Math.max(t,n);return e<r?e=r:e>s&&(e=s),i+(e-t)*(a-i)/(n-t)}},{key:"calcAngelAdjustValue",value:function(e,t,n,i,a){var o,r,s;return s=n,(o=e)>=(r=t)&&o<=s||r>s&&(o<=2*Math.PI&&o>=r||o>=0&&o<=s)||(e=n),t>n&&(e>=t&&(e-=2*Math.PI),t-=2*Math.PI),i+(e-t)*(a-i)/(n-t)}},{key:"recalcForCircularArrow",value:function(e,t,n){return"adj3"===e&&Math.abs(t-n)<.001&&(n+=2*Math.PI),n}},{key:"interpretShapeSize",value:function(e,t){if(e&&t)return this.geometry.interpretShapeSize(e,t,i)}},{key:"interpretTextBoxRect",value:function(e,t){return this.geometry.interpretTextBoxRect(e,t)}},{key:"isGeometry2D",get:function(){return!0}},{key:"type",get:function(){return{data:this.private}}},{key:"adjustValues",get:function(){return this.geometry?this.geometry.adjustValues:this.type&&this.type.data&&this.type.data.adjustValues?this.type.data.adjustValues:(console.warn("geomerty is not interpret!!"),{})}}]),e}();Math.sqrtFix=function(e){return e<0?0:this.sqrt(e)};var Wn=n(3282),Yn=function(){function e(t,n){s()(this,e),this.private=t.data||{},this.formatPrivate(t.data),this.data_token=f(),this.tree_token=this.data_token,this._visual=function(e,t){switch(e){case"GroupShape":return new Fn(t);case"BackgroundShape":return new Hn(t)}return new jn(t)}(n,this),this._backendHelper=null}return c()(e,[{key:"getBackendShapeHelper",value:function(){return this._backendHelper}},{key:"setBackendShapeHelper",value:function(e){this._backendHelper=e}},{key:"_createFakeData",value:function(e,t){switch(e){case"transform2D":case"fill":case"outline":case"shape3D":case"scene3D":case"effects":return m(t)}}},{key:"createFakeShape",value:function(){var e=this.cloneFake(),t=null!=this.private.orgShapeId?this.private.orgShapeId:this.private.shapeId;return e.private.shapeId=window.APP.presentation.allocateLocalId(),e.private.orgShapeId=t,e}},{key:"formatPrivate",value:function(e){e&&e.inkData&&this._formatPrivate("inkData",e.inkData),e&&e.extData&&this._formatPrivate("extData",e.extData)}},{key:"__onForward",value:function(e){this.childsBuildTree()}},{key:"__onBackward",value:function(e){this.childsBuildTree()}},{key:"childsBuildTree",value:function(){for(var e=this.getChilds(),t=0;t<e.length;t++){var n=e[t];n.parent||(n.buildTree?n.buildTree(this):n.parent=this)}}},{key:"_onPropertyChanged",value:function(e,t,n){switch(e){case"inkData":case"extData":return this._formatPrivate(e,n);case"childs":return this.childsBuildTree()}}},{key:"getShapeTree",value:function(){var e=this.getSlide();return e&&e.getSpTree()}},{key:"getId",value:function(){return this.private.shapeId}},{key:"getType",value:function(){return this.private.type}},{key:"getDataToken",value:function(){return this.data_token}},{key:"getTreeToken",value:function(){return this.tree_token}},{key:"getParent",value:function(){return this.parent}},{key:"getSlide",value:function(){for(var e=this.getParent();e&&!e.isSlideType;)e=e.getParent();return e}},{key:"getSlideId",value:function(){var e=this.getSlide();return e&&e.getId()}},{key:"getSlideFollowing",value:function(){var e=this.getSlide();return e&&e.getFollowing()}},{key:"getTransform2D",value:function(){return this.private.transform2D}},{key:"getChildExtents",value:function(){return this.private.childExtents}},{key:"getChildOffset",value:function(){return this.private.childOffset}},{key:"getAngle",value:function(){return this.private.angle}},{key:"getFill",value:function(){return this.private.fill}},{key:"getPicture",value:function(){return this.private.picture}},{key:"getOutline",value:function(){return this.private.outline}},{key:"getEffects",value:function(){return this.private.effects}},{key:"getScene3D",value:function(){return this.private.scene3D}},{key:"getShape3D",value:function(){return this.private.shape3D}},{key:"getRect",value:function(){return this._rectToken===this.data_token||(this.private.rect=this.visual.getAnchorRect().getAlignedBounds(),this._rectToken=this.data_token),this.private.rect}},{key:"isGroupShape",value:function(){return this.private.group}},{key:"isPlaceHolder",value:function(){return this.private.placeholder}},{key:"isBackground",value:function(){return!!this.private.background}},{key:"isMedia",value:function(){return!!this.private.media||!(!this.private.flags||!this.private.flags.hasMedia)}},{key:"isVideo",value:function(){return!1}},{key:"isAudio",value:function(){return!1}},{key:"isMath",value:function(){return!(!this.private.flags||!this.private.flags.isMath)}},{key:"isLatexMath",value:function(){var e=this.getExtData();return e&&e.isLatexMath}},{key:"isRawMath",value:function(){var e=this.private.controlObj;if(e){var t=e.progId;if(t&&(-1!==t.indexOf("Word")||-1!==t.indexOf("WPS"))){var n=this.getPicture();if(!n||!n.blipAtom)return!0}}if(!this.isMath())return!1;var i=this.private.fill;if(!i||!i.blip)return!0;var a=i.blip.blipAtom;return!a||a.size<=0}},{key:"isOle",value:function(){return!(!this.private.flags||!this.private.flags.isOle)}},{key:"isControlShape",value:function(){return!(!this.private.flags||!this.private.flags.isControlShape)}},{key:"isOleControlShape",value:function(){return!(!this.private.flags||!this.private.flags.isOleControlShape)}},{key:"isBackgroundFillUsed",value:function(){return!!this.private.backgroundFillUsed}},{key:"isTextBox",value:function(){return this.getShapeType()===Gn.g.TextBox}},{key:"isQRCode",value:function(){var e=this.getExtData();return e&&e.isQrcode}},{key:"hasChartTemp",value:function(){var e=this.getChilds();return 1===e.length&&e[0].private.modelType===Gn.f.MODEL_CHART}},{key:"hasChart",value:function(){return this.hasChartTemp()}},{key:"hasTable",value:function(){var e=this.getChilds();return 1===e.length&&e[0].private.modelType===Gn.f.MODEL_OBJTABLE}},{key:"hasSmartArt",value:function(){var e=this.getChilds();if(!this.isGroupShape())return 1===e.length&&e[0].private.modelType===Gn.f.MODEL_SMARTART;for(var t=0;t<e.length;t++)if(e[t].hasSmartArt())return!0;return!1}},{key:"isInk",value:function(){return this.private.isInk}},{key:"getInkData",value:function(){return this.private.inkData}},{key:"isNiteInk",value:function(){var e=this.getInkData();if(e&&Array.isArray(e.vecTrace)&&e.vecTrace.length>0){var t=e.vecTrace[0].brushRef,n=e.brushMap,i=n&&n[t];if(i&&1===i.tip)return!0}return!1}},{key:"isConnector",value:function(){return null!=this.private.connector}},{key:"getConnector",value:function(){if(!this.isConnector())return null;var e={},t=this.private.connector||{},n=t.startConnector,i=t.endConnector;return n&&n.site>=0&&(e.startConnector=n),i&&i.site>=0&&(e.endConnector=i),e}},{key:"isConnected",value:function(){var e=this,t=this.getSlide(),n=t&&t.getShapeTree(),i=n&&n.getChildShapesRecurse((function(t){if(!t.isConnector())return!1;for(var n=[t.startConnection(),t.endConnection()],i=0;i<n.length;++i){var a=n[i];if((a&&a.shapeId)===e.getId())return!0}return!1}));return i&&i.length>0}},{key:"startConnection",value:function(){return this.isConnector()?this.private.connector.startConnector:null}},{key:"endConnection",value:function(){return this.isConnector()?this.private.connector.endConnector:null}},{key:"isBackgroundMusic",value:function(){var e=this.getSlide();if(!e)return!1;var t=e.getTiming().getTimeLine(),n=t&&t.getMainSequence();if(!t||!n)return!1;var i=t.getMediaNode(this);return!!i&&(1===i.private.hideWhenStopped&&999===i.private.endAfterSlide&&-1===i.private.repeateCount)}},{key:"isTriggerShape",value:function(){var e=this.getSlide();if(!e)return!1;var t=e.getTiming(),n=t&&t.getTimeLine(),i=n&&n.allInterSeq;if(!i)return!1;for(var a=0;a<i.length;++a){var o=i[a].getEffects();if(o)for(var r=0;r<o.length;++r){var s=o[r];if(s.isTriggerEffect&&s.getTriggerObj()===this.getId())return!0}}return!1}},{key:"isCustomCurve",value:function(){var e=this.getGeometry2D();return e&&e.isCustomGeometry()}},{key:"setParent",value:function(e){this.parent=e}},{key:"buildTree",value:function(e){this.parent=e;var t=this.private.childs;if(t)for(var n=0,i=t.length;n<i;++n){var a=t[n];a&&a.buildTree&&a.buildTree(this)}}},{key:"getChilds",value:function(){return[]}},{key:"getTextFrame",value:function(){return null}},{key:"ensureTextFrame",value:function(){return null}},{key:"getPlaceHolder",value:function(){return this.private.placeholder}},{key:"getPlaceHolderType",value:function(){return 0}},{key:"getGeometry2D",value:function(){return this.private.geometry2D&&new Un({data:this.private.geometry2D})}},{key:"hasTxGeometry2D",value:function(){return null!=this.private.txGeometry2D}},{key:"getTxGeometry2D",value:function(){return this.private.txGeometry2D}},{key:"getExtData",value:function(){return this.private.extData}},{key:"getProperty",value:function(){var e=this.private.geometry2D,t=this.private.transform2D,n=this.private.fill,i=this.private.picture,a=this.private.outline,o=this.private.effects,r=this.private.scene3D,s=this.private.shape3D,l=this.private.hyperlink;return{transform2D:t,geometry2D:e,fill:n,picture:i,outline:a,effects:o,scene3d:r,shape3d:s,inkData:m(this.private.inkData),hyperlink:l}}},{key:"getStyle",value:function(){return this.private.style}},{key:"isHidden",value:function(){var e=this.getSlide(),t=e&&e.isHideAllInk,n=this.isInk()&&t;return this.private.hide||n||!1}},{key:"isViablePhShape",value:function(){var e=this.getShapeType(),t=this.getTextFrame(),n=this.isMedia(),i=t&&t.getTextStream(),a=i&&i.getCharCount()>1;return a=a||this.private.picture||this.private.fill||this.private.outline||this.private.effects||this.private.shape3D||this.private.scene3D||e===Gn.g.Table||e===Gn.g.Diagram||e===Gn.g.Chart||e===Gn.g.SmartArt||n}},{key:"hasContent",value:function(){if(this.isPlaceHolder()){var e=this.getShapeType(),t=this.getTextFrame(),n=this.isMedia(),i=t&&t.getTextStream();return i&&i.getCharCount()>1||this.private.picture||e===Gn.g.Table||e===Gn.g.Diagram||e===Gn.g.Chart||e===Gn.g.SmartArt||e===Gn.g.Slicer||this.private.isOle||n}return!0}},{key:"isEmptyTextStream",value:function(){var e=this.getTextFrame(),t=e&&e.getTextStream();return t&&t.getCharCount()<=1}},{key:"_getShapeTypeCoreData",value:function(e){var t=void 0,n=e.private,i=n.modelType;if(this.isMedia())t=Gn.g.Media;else if(this.isInk())t=Gn.g.Ink;else if(n.isOle)t=Gn.g.OleShape;else if(i===Gn.f.MODEL_OBJTABLE)t=Gn.g.Table;else if(i===Gn.f.MODEL_DIAGRAM)t=Gn.g.Diagram;else if(i===Gn.f.MODEL_CHART)t=Gn.g.Chart;else if(i===Gn.f.MODEL_SMARTART)t=Gn.g.SmartArt;else if(i===Gn.f.MODEL_SLICER)t=Gn.g.Slicer;else if(n.picture)t=n.extData&&n.extData.isProcessOn?Gn.g.Processon:Gn.g.Picture;else{t=Gn.g.NormalShape,(e.getTextFrame?e.getTextFrame():null)&&n.flags&&n.flags.isTextBox&&(t=Gn.g.TextBox)}return t}},{key:"getShapeType",value:function(){if(this.isGroupShape())return Gn.g.GroupShape;var e=void 0,t=this.private.childs[0],n=this.private.modelType;return(e=this._getShapeTypeCoreData(this))===Gn.g.NormalShape&&t&&n===Gn.f.MODEL_SHAPE&&(e=this._getShapeTypeCoreData(t)),e}},{key:"getTags",value:function(){return this.private.tags}},{key:"hasTags",value:function(){return null!=this.private.tags}},{key:"isDiagramShape",value:function(){return Bn.isDiagramShape(this)}},{key:"isDiagramSubShape",value:function(){return Bn.isDiagramSubShape(this.getSlide(),this)}},{key:"getRootDiagramId",value:function(){return Bn.getRootDiagramId(this.getSlide(),this)}},{key:"canRotate",value:function(){return!(this.hasGraphicData()||this.isOle()||this.isMedia()||this.isMath())}},{key:"hasGraphicData",value:function(){return this.childModelType===Gn.f.MODEL_DIAGRAM||this.childModelType===Gn.f.MODEL_OBJTABLE||this.childModelType===Gn.f.MODEL_CHART||this.childModelType===Gn.f.MODEL_SMARTART||this.childModelType===Gn.f.MODEL_SLICER}},{key:"canMoveHierarchy",value:function(e){var t=this.getParent(),n=t&&t.getChilds();if(n){var i=n.indexOf(this);return i===n.length-1&&(e===Wn.c||e===Wn.a)||0===i&&(e===Wn.f||Wn.d),!1}return!0}},{key:"getShapeGroup",value:function(){var e=L,t=this.getPresetShapeType();for(var n in e)if(-1!==e[n].subTypes.indexOf(parseInt(t)))return parseInt(n);return-1}},{key:"getShapeGroupIndexInfo",value:function(){var e=L,t=this.getPresetShapeType();for(var n in e){var i=e[n].subTypes.indexOf(parseInt(t));if(-1!==i)return{group:parseInt(n),index:i}}return{group:-1,index:-1}}},{key:"getPresetShapeType",value:function(){var e=null,t=T,n=b.ShapeInvalid;if(this.isPlaceHolder())for(var i=this.getSlideFollowing(),a=i?i.getPhShapes(this):[],o=0;o<a.length;o++){var r=a[o].shape;if(r&&(e=r.getGeometry2D()))break}else e=this.getGeometry2D();if(!e)return n;var s=e.getGeometryType();for(var l in t)if(s===t[l].text){n=l;break}return n}},{key:"isTowControlPointShapeType",value:function(){var e=this.getGeometry2D();if(!e)return!1;var t=e.getGeometryType();return!!["line","straightConnector1","bentConnector2","bentConnector3","bentConnector4","bentConnector5","curvedConnector2","curvedConnector3","curvedConnector4","curvedConnector5"].includes(t)}},{key:"getHyperlink",value:function(){return this.private.hyperlink}},{key:"getActions",value:function(){return this.private.actions}},{key:"getMedia",value:function(){if(this.isMedia())return this.private.media}},{key:"getDescription",value:function(){return this.private.description}},{key:"getWhiteboard",value:function(){return this.private.whiteboard}},{key:"isChildShape",value:function(){var e=this.parent;return!(!e||!e.isGroupShape()||e.isShapeTree)}},{key:"_modifyPrivate",value:function(e,t,n){this.setPropertyValue(e,n?m(t):t);var i={};return t?i[e]=n?m(t):t:i.undefineds=[e],{newval:i}}},{key:"_formatPrivate",value:function(e,t){switch(e){case"inkData":if(t&&t.vecTrace)for(var n=t.vecTrace,i=0;i<n.length;++i){n[i].vecPoints=[];for(var a=n[i].strPoints.split(","),o=0,r=0,s=0;s<a.length;++s)o+=parseInt(a[s].split(" ")[0]),r+=parseInt(a[s].split(" ")[1]),n[i].vecPoints.push({px:o,py:r})}break;case"extData":if(t&&t.whiteboard)try{this.private.whiteboard=JSON.parse(t.whiteboard)}catch(e){this.private.whiteboard=null}else this.private.whiteboard=null}}},{key:"modifySize",value:function(e,t){return this.visual.modifySize(e,t)}},{key:"modifyShapeHyperlink",value:function(e){var t={hyperlink:e};e._EMPTY&&(t={undefineds:["hyperlink"]}),this.delegate._modifyPrivatePropertys(t)}},{key:"setTransform2D",value:function(e){return this._modifyPrivate("transform2D",e,!0)}},{key:"setFill",value:function(e){return this._modifyPrivate("fill",e,!0)}},{key:"setOutline",value:function(e){return this._modifyPrivate("outline",e,!0)}},{key:"setPicture",value:function(e){return this._modifyPrivate("picture",e,!0)}},{key:"setGeometry2D",value:function(e){return this._modifyPrivate("geometry2D",e,!1)}},{key:"setActions",value:function(e){return this._modifyPrivate("actions",e,!0)}},{key:"setPlaceholder",value:function(e){return this._modifyPrivate("placeholder",e,!0)}},{key:"setInkData",value:function(e){return this._modifyPrivate("inkData",e,!1)}},{key:"setScene3D",value:function(e){return this._modifyPrivate("scene3D",e,!0)}},{key:"setShape3D",value:function(e){return this._modifyPrivate("shape3D",e,!0)}},{key:"setEffects",value:function(e){return this._modifyPrivate("effects",e,!0)}},{key:"setMedia",value:function(e){return this._modifyPrivate("media",e,!0)}},{key:"setChilds",value:function(e){return this._modifyPrivate("childs",e,!1)}},{key:"setWhiteboard",value:function(e){var t=Object.assign(this.private.extData||{},{whiteboard:JSON.stringify(e)});return this._modifyPrivate("extData",t,!0)}},{key:"setExtData",value:function(e){return this._modifyPrivate("extData",e,!0)}},{key:"setShapeStyle",value:function(e){return this._modifyPrivate("style",e,!0)}},{key:"setConnector",value:function(e){return this._modifyPrivate("connector",e,!0)}},{key:"setTags",value:function(e){return this._modifyPrivate("tags",e,!0)}},{key:"broadcastToOthers",value:function(){if(this.__isNew){var e=this.getSlide(),t=e&&e.getPresentation();e&&t&&t.drawingNotifyer.notify("SHAPE_CREATED",e,this)}}},{key:"getBackendShapePictureToken",value:function(){return this._backendHelper?this._backendHelper.getToken():""}},{key:"isTextShape",value:function(){return!1}},{key:"isShape",get:function(){return!0}},{key:"modelType",get:function(){return this.private.modelType}},{key:"visual",get:function(){return this._visual}},{key:"childModelType",get:function(){var e=this.private.childs[0];if(e)return e.private.modelType}},{key:"colorScheme",get:function(){this._colorScheme||(this._colorScheme=new Rn);var e=this.getSlide(),t=null;if(e){var n=(t=e.visual.getTheme()).getColorScheme(),i=e.getThemeOverride();i&&i.colorScheme&&n.init(i.colorScheme),this._colorScheme.setColorScheme(n),this._colorScheme.setColorMapping(t.getColorMapping())}var a=this.getStyle();return a&&(this._colorScheme.setStyle(a),this._colorScheme.setColorUsedFor("fill")),this._colorScheme.setShape(this),this._colorScheme.setTheme(t),this._colorScheme}}]),e}(),zn=n(8839),Xn=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"GroupShape"));return n.childsBuildTree(),n}return p()(t,e),c()(t,[{key:"createFakeShape",value:function(){for(var e=B()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createFakeShape",this).call(this),n=[],i=this.private.childs,a=0;a<i.length;++a){var o=i[a].createFakeShape();n.push(o)}return e.private.childs=n,e}},{key:"getChilds",value:function(){var e=this;return this._childs||(this._childs=[],this.private.childs.forEach((function(n){switch(n.getModelType()){case zn.WPS_MVC_MODEL_TYPE.WPS_MODEL_LOCKEDCANVAS_SHAPETREE:return void e._childs.push(new Kn({data:n.private}));default:n.getGroup()?e._childs.push(new t({data:n.private})):Qn(n.private)?e._childs.push(new Vn({data:n.private})):e._childs.push(new Yn({data:n.private}))}}))),this._childs}},{key:"getChildCount",value:function(){return this.private.childs.length}},{key:"getChildAt",value:function(e){return this._childs[e]}},{key:"getChildById",value:function(e){var t=this.getChildIdxById(e);return this.getChildAt(t)}},{key:"getChildIdxById",value:function(e){for(var t=this.private.childs,n=0,i=t.length;n<i;++n)if(t[n].getId()===e)return n;return-1}},{key:"findShapeById",value:function(e){for(var t=this.private.childs,n=0,i=t.length;n<i;++n){if(!t[n])throw new Error("{shapeId: "+this.getId()+", shapeType: "+this.getShapeType()+", pos: "+n+", length: "+t.length);if(t[n].getId()===e)return t[n]}for(var a=0,o=t.length;a<o;++a)if(t[a].isGroupShape()){var r=t[a].findShapeById(e);if(r)return r}return null}},{key:"matchCommentShape",value:function(e){for(var t=e.getAnchor(),n=t.x,i=t.y,a=this.private.childs,o=0,r=a.length;o<r;++o){var s=a[o].visual.getAnchorRect();if(Math.abs(s.x()-n)<=1&&Math.abs(s.y()-i)<=1)return a[o]}for(var l=0,c=a.length;l<c;++l)if(a[l].isGroupShape()){var u=a[l].matchCommentShape(e);if(u)return u}return null}},{key:"matchText",value:function(e){if(!e)return null;for(var t=[],n=0;n<this.getChildCount();++n){var i=this.getChildAt(n);if(i.matchText){var a=i.matchText(e);a&&(t=t.concat(a))}}return t}},{key:"deleteShape",value:function(e){if(e)if(this.isShapeTree)this.remove(e);else{var t=this.getChildCount();if(t>2)this.remove(e),this.visual.updatePosInfo();else if(2===t){var n=0===this.getShapeIndex(e)?1:0,i=this.getChildAt(n),a=i.visual.getRealTransform2D(),o=this.parent;if(this.remove(i),o){var r=o.indexOf(this);o.remove(this),r>=0?o.insert(r,i):o.push(i);var s=i.visual.transform2DRelativeToParent(a);i.setTransform2D(s),o.isGroupShape()&&!o.isShapeTree&&o.visual.updatePosInfo()}}else if(1===t){var l=this.parent;l&&l.remove(this)}}}},{key:"childrenTree",value:function(){for(var e=[],n=this.private.childs,i=0;i<n.length;i++){var a=n[i];a instanceof t?e.push(a.childrenTree()):e.push({id:a.getId()})}return{id:this.getId(),childs:e}}},{key:"getChildShapesRecurse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[],n=this.private.childs.length,i=0;i<n;i++){var a=this.private.childs[i];if(a.isGroupShape()){var o=a.getChildShapesRecurse(e);t=t.concat(o)}else(null==e||e(a))&&t.push(a)}return t}},{key:"afterForward",value:function(){this.childsBuildTree()}},{key:"afterBackward",value:function(){this.childsBuildTree()}},{key:"childShapes",get:function(){return this.getChilds()}}]),t}(Yn);Xn.createGroupShape=function(e){for(var t=window.APP.presentation,n=[],i=0;i<e.length;i++){var a=e[i].visual.getRealTransform2D();n.push(a),e[i].setPropertyValue("transform2D",a)}var o=function(e){if(!e||0===e.length)return{left:0,right:0,top:0,bottom:0};for(var t=X.create(e[0]),n=1;n<e.length;n++)t.unite(X.create(e[n]));return t.getAlignedBounds()}(n),r={x:o.left,y:o.top,width:o.right-o.left+1,height:o.bottom-o.top+1,rotation:0,horizontalFlipped:!1,verticalFlipped:!1},s={group:!0,isOle:!1,shape:!0,name:"",shapeId:t.allocateLocalId(),childs:e,transform2D:r,childExtents:{width:r.width/635,height:r.height/635},childOffset:{x:r.x/635,y:r.y/635}},l=new Xn({id:s.shapeId,data:s});l.buildTree(null);for(var c=0;c<s.childs.length;c++){var u=s.childs[c],d=u.getTransform2D();d.x=d.x-r.x,d.y=d.y-r.y;var h=u.visual.transform2DRelativeToParent(d);u.setPropertyValue("transform2D",h)}return l};var Vn=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"getChilds",value:function(){return this._childs||(this._childs=[new qn({data:this.private.childs[0].private})]),this._childs}},{key:"getTableFrame",value:function(){return null}},{key:"isCanvasShape",get:function(){return!0}}]),t}(Xn),qn=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"isCanvasLayers",get:function(){return!0}}]),t}(Xn),Kn=function(e){function t(e){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return p()(t,e),c()(t,[{key:"isShapeTree",get:function(){return!0}}]),t}(qn);function Qn(e){var t=e.isChart,n=e.isSmartArt;return!t&&!n&&(e.childs&&e.childs.length>=1&&e.childs[0].private.layer&&!e.childs[0].private.group&&1===e.childs[0].private.childs.length&&e.childs[0].private.childs[0].private.group)}var Jn=n(13),Zn=n.n(Jn),$n=n(4743),ei={LineCapFlat:0,LineCapRound:1,LineCapSquare:2},ti=0,ni=1,ii=2,ai=3,oi=4,ri=0,si=1,li=2,ci={LineJoinTypeMiter:0,LineJoinTypeBevel:1,LineJoinTypeRound:2},ui=11,di=0,hi=1,pi=2,fi=3,gi=4,vi=5,yi=0,mi=1,_i=2,xi=1,wi=2,ki={width:9525,endingCap:ei.LineCapFlat,dashType:0,alignment:ri,compoundLine:ti,joinType:ci.LineJoinTypeRound,headEndType:di,headEndWidth:mi,headEndLength:xi,tailEndType:di,tailEndWidth:mi,tailEndLength:xi},bi=n(1573);function Ti(e,t){if(e){switch((e=m(e)).type){case $e.a.FillTypeGradient:for(var n=e.stops,i=0;i<n.length;i++){var a=n[i];a.color=Dn(a.color,t)}break;case $e.a.FillTypePattern:e.color=Dn(e.color,t),e.backgroundColor=Dn(e.backgroundColor,t);break;case $e.a.FillTypeSolidColor:e.color=Dn(e.color,t);break;case $e.a.FillTypeGroup:var o=t&&t.shape,r={type:0};if(o){var s=o.visual.getParent();s&&(r=s.getFill(),o=s.coredata)}e=Ti(r,t);break;case $e.a.FillTypeBlip:e.blip&&e.blip.effects&&(e.blip.effects=Ci(e.blip.effects,t))}return e}}function Ci(e,t){if(!e)return e;for(var n=Object.keys(e),i=0;i<n.length;i++){var a=e[n[i]];if(a instanceof Object){for(var o in a)if("fill"==o)a.fill=a.fill=Ti(a.fill,t);else if("color"==o||"replacement"==o||"color1"==o||"color2"==o||"primaryColor"==o||"secondaryColor"==o)a[o]=Dn(a[o],t);else if("colors"==o)for(var r=0;r<a.colors.length;r++)a.colors[r]=Dn(a.colors[r],t);else"cont"==o&&a.cont.effects&&(a.cont.effects=Ci(a.cont.effects,t));a.from&&a.to&&(a.from=Dn(a.from,t),a.to=Dn(a.to,t))}}return e}var Si={createModifier:function(){var e;return window.CoreDataEditor?(e=window.CoreDataEditor).createModifierByName.apply(e,arguments):null},ColorSchemeData:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;for(var n=[wt,kt,bt,Tt,ft,gt,vt,yt,mt,_t],i=e.colorMap,a=[],o=0;o<n.length;o++){var r=n[o],s=i?i.mapColor(r):r,l=e.interpret({type:ht.Scheme,scheme:s});if(t){var c=[];switch(c.push(l),r){case wt:c=c.concat(Mn(l,nn,[.05,.15,.25,.35,.5]));break;case kt:c=c.concat(Mn(l,an,[.5,.35,.25,.15,.05]));break;case bt:c=c.concat(Mn(l,nn,[.1,.25,.5,.75,.9]));break;default:c=c.concat(On(l,[{op:an,val:.8},{op:an,val:.6},{op:an,val:.4},{op:nn,val:.25},{op:nn,val:.5}]))}a.push(c)}else a.push(l)}return a},getColorDelegation:function(e,t,n){var i=null;return t&&(i=t.isBackground()?t.visual.getColorScheme(n):t.colorScheme).setColorUsedFor(e),i},interpretColor:function(e,t){return null==e?null:Dn(e,t)},interpretFill:function(e,t){return e?Ti(e,t):e},interpretOutline:function(e,t){return e?(e.fill&&(e.fill=Ti(e.fill,t)),e):e},interpretEffects:function(e,t){return e?Ci(e,t):e},getFakeTransaction:function(e){return 0}},Ei=n(2849),Pi={fillColor:{toRGB:"#ffffffff",type:3},lineColor:{toRGB:"#ff000000",type:3},fillIndex:0,lineIndex:0},Li={fillColor:{toRGB:"#ff5b9bd5",type:3},fillIndex:1,lineColor:{toRGB:"#ff41719c",type:3},lineIndex:2},Ai={fillIndex:0,lineColor:{toRGB:"#ff41719c",type:3},lineIndex:1},Ii={1:{tailEnd:{type:5}},2:{headEnd:{type:5},tailEnd:{type:5}},4:{tailEnd:{type:5}},5:{headEnd:{type:5},tailEnd:{type:5}},7:{tailEnd:{type:5}},8:{headEnd:{type:5},tailEnd:{type:5}}};var Ri=0,Oi=1,Mi=2,Di=3,Ni=4,Bi=5,ji=6;var Fi=function(){function e(t,n){s()(this,e),this._shape=t,this._originShapeData=n||t,this._init()}return c()(e,[{key:"_init",value:function(){}},{key:"getNotesPage",value:function(){return this._notesPage}},{key:"showNotesBody",value:function(){return!1}},{key:"getBackgroundSize",value:function(){return null}},{key:"getLayout",value:function(){return this._layout}},{key:"getMaster",value:function(){return this._master}},{key:"getSlideIndex",value:function(){return 0}},{key:"getSelection",value:function(){}},{key:"getSelRange",value:function(){}},{key:"getThemeAgent",value:function(){var e=this.slide;return e&&e.visual.getThemeAgent()}},{key:"getTransform2D",value:function(){return this._transform2D=this._transform2D||this._shape.visual.getRealTransform2D(),this._transform2D}},{key:"getParent",value:function(){return this._shape.getParent()}},{key:"getMachPhShape",value:function(){if(!this.matchShapeObj){var e=this._shape,t=e&&!e.hasTable()&&e.getPlaceHolder(),n={},i=this.getLayout();if(t&&i){var a=i.matchPhShapeCommon(e),o=this.getMaster();if(n.l_phShape=a,o){var r=o.matchPhShapeCommon(e);n.m_phShape=r}}this.matchShapeObj=n}return this.matchShapeObj}},{key:"getProperty",value:function(){var e={},t=this._shape;e=t.visual.getAllProperties();var n=t.getShapeGroupIndexInfo(),i=this.getStyle();if(i){var a=window.APP.data.doc.theme.baseStyle.formatScheme,o=i.lineIndex,r=i.lineColor,s=i.fillIndex,l=i.fillColor,c=i.effectsIndex,u=a.getLineAt(o),d=a.getFillAt(s),h=a.getEffectsAt(c);if(u&&Object.keys(u).length>0){var p=Object($n.a)(u);p.fill.color&&(p.fill.color=Object($n.a)(r)),e.outline=t.private.outline?Object($n.b)(p,t.private.outline):p}if(d&&Object.keys(d).length>0&&function(e,t){return e!==E.LineGroup&&!(e===E.NormalGroup&&t>=35&&t<=42)}(n.group,n.index)&&!function(e){var t=e.private.geometry2D,n=t&&t.paths;if(n&&n.length){var i=n[0].arguments;if(i[0]!==i[i.length-2]||i[1]!==i[i.length-1])return!0}return!1}(t)){var f=Object($n.a)(d);f.color=Object($n.a)(l),f.type===Ri&&(f.type=Mi),e.fill=t.private.fill?Object($n.b)(f,t.private.fill):f}h&&Object.keys(h).length>0&&(e.effects=Object($n.b)(Object($n.a)(h),e.effects))}if(e.fill&&0!==e.fill.type){if(t.visual.isBackgroundFillUsed()){t.visual.getBackgroundVisual();e.fill=this.getFillColorTransform(e.fill)}else e.fill=e.fill.type===ji?this.getVaildGroupFill():this.getFillColorTransform(e.fill);e.fill=this.mergeDefaultFill(e.fill)}if(e.outline&&e.outline.fill){var g=e.outline.fill.type;e.outline.fill=g===ji?this.getVaildGroupOutlineFill():this.getFillColorTransform(e.outline.fill),g===ji&&this._addGroupRectToFill(e.outline.fill)}if(e.outline&&(e.outline.fill&&0===e.outline.fill.type?delete e.outline:e.outline=Object($n.b)(Object($n.a)(ki),e.outline)),e.effects&&(e.effects=Si.interpretEffects(e.effects,this._colorDelegation)),e.shape3d){var v=e.shape3d;v.contourColor&&(v.contourColor=this.getOverMapColor(v.contourColor)),v.extrusionColor&&(v.extrusionColor=this.getOverMapColor(v.extrusionColor))}if(e.inkData){var y=e.inkData;if(y.brushMap){var m=y.brushMap;for(var _ in m)if(m.hasOwnProperty(_)){var x=m[_];x.color&&(x.color=this.getOverMapColor(x.color))}}}return this._spProperty=e,e}},{key:"getVaildGroupFill",value:function(){for(var e=this.getParent();e.getFill()&&e.getFill().type===ji;)e=e.getParent();var t=e.getFill();return t&&this.getFillColorTransform(t)}},{key:"getVaildGroupOutlineFill",value:function(){for(var e=this.getParent();e.private.outline&&e.private.outline.fill&&e.private.outline.fill.type===ji;)e=e.getParent();var t=e.private.outline&&e.private.outline.fill;return t&&this.getFillColorTransform(t)}},{key:"getGroupFill",value:function(e){if(!e||!e.isGroupShape())return null;for(;e.getFill()&&e.getFill().type===ji;)e=e.getParent();return{groupFill:e.getFill(),groupRect:e.getRect(),groupAngel:e.getAngle()}}},{key:"_addGroupRectToFill",value:function(e){var t=this.getParent();if(!t||!t.isGroupShape())return e;for(;t.getFill()&&t.getFill().type===ji;)t=t.getParent();var n=t.getRect(),i=t.getAngle();return n&&(e.rect=Object($n.a)(n),e.rect.groupAngel=i),e}},{key:"getFillColorTransform",value:function(e){if(e||(void 0===e?"undefined":v()(e))===Object){var t=e.type;if(t!==Bi||e.stops||((e=Zn()({},e)).stops=[]),e.color&&e.color.type===ht.Scheme){var n=e.color,i=Object(Ei.a)(n.toRGB),a=Object(Ei.c)(n.toRGB),o=e.color.transOp,r=void 0;o&&o.forEach((function(e){0===e.op&&(r=e.val,a.trans=100-Math.round(100*r))})),e.color={type:ht.SRgb,sRgb:un.fromString(n.toRGB).toInt(),toRGB:n.toRGB,alpha:void 0!==r?r:i.a/255,rgba:"rgba("+i.r+", "+i.g+", "+i.b+", "+(void 0!==r?r:i.a/255)+")",hex:a},void 0!==r&&(e.color.transOp=[{op:0,val:r}])}else e=Si.interpretFill(e,this._colorDelegation),t===ji&&this._addGroupRectToFill(e);return e}console.warn("FillColor ERROR")}},{key:"getObjectValue",value:function(e,t,n){for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];"object"===(void 0===a?"undefined":v()(a))?this.getObjectValue(a,t,n):i===t&&n.push(a)}}},{key:"getStyle",value:function(){if(this._spStyle)return this._spStyle;var e=this._shape,t=this.getMachPhShape(),n=t.l_phShape,i=t.m_phShape,a={};if(i){var o=i.getStyle();Object($n.b)(a,o)}if(n){var r=n.getStyle();Object($n.b)(a,r)}return Object($n.b)(a,e.getStyle()),this.updateStyle(a),this._spStyle=a,a}},{key:"updateColor",value:function(e,t){var n=this;if(e[t]){var i=this.getOverMapColor(e[t+"Color"]);e[t+"Color"]=i;var a=e[t],o=a.color,r=a.stops,s=a.fill,l=a.outerShadow,c=e[t];if(s&&!o&&(o=s.color,c=s),l&&!o&&(o=l.color,c=l),o)16===o.scheme&&i&&(o.toRGB=i.toRGB,o.sRgb=i.sRgb,i.transOp&&(o.transOp=i.transOp)),c.color=this.getOverMapColor(o);r&&r.forEach((function(e){var t=e.color;t&&(16===t.scheme&&i&&(t.toRGB=i.toRGB,t.sRgb=i.sRgb,i.transOp&&(t.transOp=i.transOp)),e.color=n.getOverMapColor(t))}))}}},{key:"updateStyle",value:function(e){var t=this,n=this._shape,i=this.getThemeAgent();if(i){var a=e.lineIndex,o=e.fontIndex,r=e.effectsIndex,s=e.fillIndex;null!=a&&(e.line=Object($n.b)({},i.getFormatScheme().getLineAt(a))),null!=o&&(e.font=this.getOverMapColor({type:3,scheme:o})),null!=r&&(e.effects=Object($n.b)({},i.getFormatScheme().getEffectsAt(r))),null!=s&&(n.isBackground()?e.fill=Object($n.b)({},i.getFormatScheme().getBackgroundFillAt(s)):e.fill=Object($n.b)({},i.getFormatScheme().getFillAt(s)))}["line","fill","effects","font"].forEach((function(n){t.updateColor(e,n)}))}},{key:"isColorPlaceHolder",value:function(e){return e&&e.type&&e.type===Mi}},{key:"getTextFrame",value:function(e){return null}},{key:"getGeometry2D",value:function(){return this._shape.private.geometry2D?this._shape.private.geometry2D:null}},{key:"getTextBody",value:function(){return null}},{key:"getShapeTextStyle",value:function(e){var t=this.getTextFrame(e)||this._cellTextFrame;return t?t.visual.getTextStyle():null}},{key:"getDefaultStyle",value:function(){var e=this.presentation;if(e)return e.getDefaultTextStyle()}},{key:"getParaTextProps",value:function(e,t){var n=this.getTextFrame(e)||this._cellTextFrame;if(n)for(var i=n.visual.getCompleteTextProps(),a=0;a<i.length;++a){var o=i[a],r=o.begin,s=o.end,l=o.chpProps,c=o.paraProps;if(t>=r&&t<s){if(!c||!l)return;for(var u=0;u<l.length;++u)l[u]=l[u].props;return{paraProp:c.props,chpProp:l}}}return null}},{key:"getOutlineStyle",value:function(e,t){if(e){var n=e.chpStyles,i=e.paraStyles;if(n&&i)return{chpStyle:n[t],paraStyle:i[t]}}return{}}},{key:"_getAutoNum",value:function(e,t,n,i,a){var o=i.at(e);!o&&a&&((o=a["lvl"+n])||(o=a.def));return o||2!==t||(o={getStart:function(){return 1},getType:function(){return 3}}),o}},{key:"updateTextBodyStyle",value:function(e,t){}},{key:"updateParagraphChilds",value:function(e){e.childs,e.outlineStyle,e.placeholder,e.presetStyle}},{key:"getOverMapColor",value:function(e){return e}},{key:"getTableFrame",value:function(e){for(var t=e.getChilds(),n=0;n<t.length;n++){var i=t[n];if(i.isTableFrame)return i}return null}},{key:"getTableBody",value:function(){return null}},{key:"getCellDefaultStyle",value:function(e,t,n){var i=t.r,a=t.c,o=n.row,r=n.col,s=e.style,l=e.usefirstcol,c=e.usefirstrow,u=e.uselastcol,d=e.uselastrow,h=s&&s.private||{},p=h.firstColumn,f=h.firstRow,g=h.lastColumn,v=h.lastRow,y=h.wholeTable;return 0===i&&c&&(y=f),0===a&&l&&(y=p),i===o-1&&d&&(y=v),a===r-1&&u&&(y=g),y&&y.private}},{key:"getCellTextStyle",value:function(e){if(e){var t=(e=Object($n.b)({},e)).textStyleSheet;e.textStyleSheet=null,t&&(t=t.prop,Object($n.b)(t,e),e=t)}return e}},{key:"deepGetOverMapColor",value:function(e){if(e instanceof Object){var t=this;!function e(n){for(var i in n)"textBody"!==i&&("color"===i?n[i]=t.getOverMapColor(n[i]):"fill"===i&&n[i]?n[i]=t.getFillColorTransform(n[i]):"object"===v()(n[i])&&e(n[i]))}(e)}}},{key:"isCJKLang",value:function(e){return"zh-CN"===e||"zh-TW"===e||"ko-KR"===e||"ja-JP"===e}},{key:"getFontBySymbol",value:function(e,t,n,i){return null}},{key:"getFontFamily",value:function(e,t){var n=e.fontNameAscii,i=e.fontNameAsiaEast,a=e.fontNameComplex,o=i;return t&&(0===t.type?o=n:1===t.type&&(o=a),(o=o||{}).type=t.type,o.script=t.script),o&&o.name?o.name:this.getFontBySymbol(o,t)}},{key:"getFontByStyle",value:function(e,t){var n=e.fontNameAscii,i=e.fontNameAsiaEast,a=e.fontNameComplex,o=i||a;return t&&(0===t.type?o=n:1===t.type&&(o=a)),o&&(o.type=t.type,o.script=t.script),o}},{key:"mergeDefaultFill",value:function(e){if(e){switch(e.type){case Bi:e=Object($n.b)(Object($n.a)(bi.a),e);break;case Ri:case Di:case Ni:case Mi:case Oi:default:e=Object($n.b)(Object($n.a)(bi.b),e)}return e}}},{key:"objID",get:function(){return this._shape&&this._shape.objID}},{key:"isMasterView",get:function(){return!1}}]),e}(),Hi=["x","y","width","height"],Gi=function(){function e(t){var n=t.shapeData,i=t.parentLayout,a=void 0===i?null:i,o=t.extendList,r=void 0===o?{}:o,l=t.scale,c=t.slideEnvLayout,u=t.isLocalShape,d=t.currentSlideData;s()(this,e),this.shapeData=n,this.parentLayout=a,this.extendList=r,this.scale=l,this.isLocalShape=u,this.slideEnvLayout=c||{},this.dataToken=n.getDataToken(),this.treeToken=n.getTreeToken(),this.ratio=1,this.currentSlideData=d,this._init()}return c()(e,[{key:"destroy",value:function(){delete this.shapeData,delete this.parentLayout,delete this.currentSlideData}},{key:"getDataToken",value:function(){return this.dataToken}},{key:"getTreeToken",value:function(){return this.treeToken}},{key:"_init",value:function(){var e=new Fi(this.shapeData,this._originShapeData||this.shapeData),t=void 0;if(this._shapeAgent=e,e.showNotesBody()){var n=this.slideEnvLayout;(t=Object.assign({},n.svgLayout)).width/=n.scale,t.height/=n.scale}else if(this.shapeData.isBackground())t=Object.assign({x:0,y:0,rotation:0},e.getBackgroundSize());else{var i=e.getTransform2D();t=Object.assign({},i),Hi.forEach((function(e){t[e]=(t[e]||0)/635}))}this.transform2D=t,this.layoutRect=this._rect2Px(t,this.scale),this.exactRect=Zn()({},this.layoutRect),this.viewRect=this.layoutRect,this._updateRealRect()}},{key:"_updateRealRect",value:function(){var e=this.extendList||{},t=e.measureShapeBody,n=e.inkBody,i=this.exactRect,a=this.realRect;if(t&&t.layout){var o=t.layout,r=o.shapeRealyRect;r&&i.width<r.width()&&(i.width=r.width()),r&&i.height<r.height()&&(i.height=r.height()),i.x+=r.x(),i.y+=r.y(),t.overflowLeft=0,t.overflowTop=0,t.relativeX=o.relativeX,t.relativeY=o.relativeY,i.overflowLeft=o.offX,i.overflowTop=o.offY}if(n){var s=n.getMaxBrushWidth();s*=window.ti2pxRatio;var l=Object.assign({},this.viewRect);l.x-=s/2,l.y-=s/2,l.width+=s,l.height+=s,this.viewRect=l}this.layoutRect=a}},{key:"_mapExactRect",value:function(){var e=this.exactRect,t=this.viewRect||this.realRect,n=t.x,i=t.y,a=this.getHitTestMatrix().clone();a.translate(-n,-i);var o=new window.Rect(e.x,e.y,e.width,e.height),r=a.Map(o);this.exactRect.x=r.x(),this.exactRect.y=r.y(),this.exactRect.width=r.width(),this.exactRect.height=r.height()}},{key:"_getNormalAngel",value:function(e){var t=e;return t<0&&(t+=360),Math.round(t)%360}},{key:"_transform2Rect",value:function(e){return{x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation}}},{key:"_radian",value:function(e){return Math.PI*e/180}},{key:"_rect2Px",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,i=Object.assign({},e);return Hi.forEach((function(e){i[e]=window.Ti2Px(i[e],n)||0})),["overflowLeft","overflowTop"].forEach((function(e){i[e]&&(i[e]=Math.round(window.Ti2Px(i[e],t.scale))||0)})),i}},{key:"getLayoutRect",value:function(){return this.layoutRect}},{key:"getLayoutRectAfterRotation",value:function(){var e=window.Rect.create(this.layoutRect);return(e=e.rotationAtCenter(this.getRotation())).getRect()}},{key:"getLayoutRectPx",value:function(e){this.updateRatio(e);var t=Zn()({},this.layoutRect);return Hi.forEach((function(n){t[n]*=e})),t}},{key:"getRealRect",value:function(){return this.realRect}},{key:"getRealRectBeforeRotation",value:function(){return this.realRectBeforeRotation?this.realRectBeforeRotation:this.layoutRect}},{key:"getRealRectPxBeforeRotation",value:function(){return this.getRealRectBeforeRotation()}},{key:"getRealRectPx",value:function(e){if(!e)return this.getRealRect();this.updateRatio(e);var t=Zn()({},this.realRect);return Hi.forEach((function(n){t[n]*=e})),t}},{key:"getExactRect",value:function(){return this.exactRect}},{key:"getExactRectPx",value:function(e){if(!e)return this.getExactRect();this.updateRatio(e);var t=Zn()({},this.exactRect);return Hi.forEach((function(n){t[n]*=e})),t}},{key:"getViewRectPx",value:function(e){if(!e)return Zn()({},this.viewRect);this.updateRatio(e);var t=Zn()({},this.viewRect);return Hi.forEach((function(n){t[n]*=e})),t}},{key:"getViewRectAfterRotate",value:function(){var e=window.Rect.create(this.viewRect);return(e=e.rotationAtCenter(this.getRotation())).getRect()}},{key:"getTableMixHeight",value:function(e){if(this.extendList.typoTableBody){var t=this.extendList.typoTableBody.mixTableHieght;return e?t*e:t}return 0}},{key:"getBackendRectPx",value:function(e){if(!e)return Zn()({},this.getBackendRect());this.updateRatio(e);var t=Zn()({},this.getBackendRect());return Hi.forEach((function(n){t[n]*=e})),t}},{key:"getBackendRect",value:function(){var e=this.getRotation(),t=this.getFlipped(),n=t.horizontalFlipped,i=t.verticalFlipped,a=this.layoutRect,o=a.width,r=a.height,s=a.x,l=a.y,c=new window.QMatrix(1,0,0,1,0,0),u=new window.Rect(0,0,o,r);c.translate(o/2,r/2),c.rotate(e),c.scale(n?-1:1,i?-1:1),c.translate(-o/2,-r/2);var d=c.mapRect(u);return{x:s+d.x(),y:l+d.y(),width:d.width(),height:d.height()}}},{key:"setRealRect",value:function(e){this.realRect=e}},{key:"getTiCoefficient",value:function(e){var t=0,n=this.shapeData.getParent();if(this.parentLayout&&!n.isShapeTree){var i=this.shapeData.getParent(),a=this.shapeData.getAngle();a=a<0?a+360:a;var o=this.parentLayout.getLayoutRect().height/(i.getChildExtents().height||1),r=this.parentLayout.getLayoutRect().width/(i.getChildExtents().width||1);switch(t=r,e){case"height":t=a>=45&&a<135||a>=225&&a<315?r:o;break;case"width":t=a>=45&&a<135||a>=225&&a<315?o:r;break;case"x":t=r;break;case"y":t=o}}return t||(t=1/635),t}},{key:"getExtendList",value:function(){return this.extendList}},{key:"getRotation",value:function(){var e=this.transform2D,t=e.rotation;return e.verticalFlipped&&(t+=180),t||0}},{key:"getFrameRotation",value:function(){if(void 0===this._frame_rotate){var e=this.extendList.typoTextBody;this._frame_rotate=this.getRotation()+(e?e.frameRotation:0)}return this._frame_rotate}},{key:"getFlipped",value:function(){var e=this.transform2D;return{horizontalFlipped:e.horizontalFlipped,verticalFlipped:e.verticalFlipped}}},{key:"getShapeFill",value:function(){return this.shapeProperty&&this.shapeProperty.fill}},{key:"realRect",get:function(){return this.layoutRect}}]),e}(),Ui=n(3426),Wi=function(){function e(){s()(this,e),this.m_dashOffset=0,this.m_dashPattern=[],this.m_width=1}return c()(e,[{key:"getWidth",value:function(){return this.m_width}},{key:"getDashOffset",value:function(){return this.m_dashOffset}},{key:"getDashPatternCount",value:function(){return this.m_dashPattern.length}},{key:"getDashPattern",value:function(e,t){if(Object.isEmpty(e))return!1;if(e instanceof Array||(e=[]),t>this.m_dashPattern.length)throw new Error("this count "+t+" is Over DashPatterb Length");for(var n=0;n<t;++n)e[n]=this.m_dashPattern[n];return!0}},{key:"setDashPattern",value:function(e,t){if(Object.isEmpty(e)||t<=1||1==(1&t))return!1;for(var n=0;n<t;){if(e[n]<=0)return!1;++n}for(this.m_dashPattern.length=t;t-- >0;)this.m_dashPattern[t]=e[t];return!0}},{key:"setDashOffset",value:function(e){this.m_dashOffset=e}},{key:"setWidth",value:function(e){this.m_width=e<=0?1:e}},{key:"getClipRect",value:function(){return this.m_clipRect}},{key:"setClipRect",value:function(e){this.m_clipRect=e||new window.Rect}},{key:"getDashedPath",value:function(e,t,n){var i=e.toSubpathPolygons(null,n);if(i)for(var a=0;a<i.length;++a)this.getDashedPath_2(i[a],t);else console.log("DashedPath is Empty!")}},{key:"getDashedPath_5",value:function(e,t,n,i,a){var o=e.toSubpathPolygons(null,a);if(o)for(var r=window,s=r.Point,l=r.QPainterPath,c=0;c<o.length;++c){var u=o[c],d=u[0],h=u[u.length-1],p=new l;this.getDashedPath_2(u,p);for(var f=p.toSubpathPolygons(null,a),g=f.length,v=0;v<g;++v)0===v?s["=="](f[v][0],d)?t.addPolygon(f[v]):n.addPolygon(f[v]):g-1===v&&s["=="](f[v][f[v].length-1],h)?i.addPolygon(f[v]):n.addPolygon(f[v])}else console.log("DashedPath is Empty!")}},{key:"getDashedPath_2",value:function(e,t){if(0===this.m_dashPattern.length)t.addPolygon(e);else{var n=new qi(e);this.generateDash(n,t)}}},{key:"generateDash",value:function(e,t){Object(Ui.b)(this.m_dashPattern.length>0,"",""),Object(Ui.b)(0==(1&this.m_dashPattern.length),"","need evenNumber"),Object(Ui.b)(this.m_width>0,"","");var n=0,i=0,a=0,o=0,r=1;for(e.isclosed()&&(o=e.getSize()-1,r=0);r<e.getSize();){var s=e.getVertices(),l=new window.Line(s[o].pt,s[r].pt);if(this.m_clipRect.isEmpty()||Yi(l,this.m_clipRect)){var c=this.calcDashStart(n,i,a+new window.Line(s[o].pt,l.p1()).length()),u=F()(c,2);n=u[0],i=u[1];for(var d=0,h=l.length();h>0;){(1|i)!==i&&(this.addStart(new Ki(l.p1(),l.p2()),new Ki(l.p2(),l.p1()),d,t),this.addPoint(new Ki(l.p1(),l.p2()),new Ki(l.p2(),l.p1()),d+Math.min(n,h),t)),d+=n,h-=n;var p=this.incCurrentDash(i,n,this.m_dashPattern,this.m_width),f=F()(p,2);i=f[0],n=f[1]}a+=s[o].dist,o=r++}else a+=s[o].dist,o=r++}}},{key:"calcDashStart",value:function(e,t,n){for(var i=0,a=this.m_dashPattern.length,o=0;o<a;++o)i+=this.m_dashPattern[o]*this.m_width;Object(Ui.a)(!zi(i)&&!zi(this.m_width));var r=n-Math.floor(n/i)*i;r+=this.m_dashOffset*this.m_width,r-=Math.floor(r/i)*i,r/=this.m_width;for(var s=0;s<a;++s){if(r<this.m_dashPattern[s])return[(this.m_dashPattern[s]-r)*this.m_width,s];r-=this.m_dashPattern[s]}Object(Ui.b)(0,"","Should never run here")}},{key:"addStart",value:function(e,t,n,i){if(i.isQPainterPath){var a=new window.Point(e.pt.x()+n/e.dist*(t.pt.x()-e.pt.x()),e.pt.y()+n/e.dist*(t.pt.y()-e.pt.y())),o=i.length,r=i.getPathElementAt(o-1);o>0&&r&&zi(a.x()-r.x)&&zi(a.y()-r.y)||i.moveTo(a)}else console.error("qPathDasher add start error!!")}},{key:"addPoint",value:function(e,t,n,i){if(i.isQPainterPath){var a=new window.Point(e.pt.x()+n/e.dist*(t.pt.x()-e.pt.x()),e.pt.y()+n/e.dist*(t.pt.y()-e.pt.y()));i.lineTo(a)}else console.error("qPathDasher add addPoint error!!")}},{key:"incCurrentDash",value:function(e,t,n,i){return++e>=n.length&&(e=0),[e,n[e]*i]}}]),e}();function Yi(e,t){for(var n=0,i=1,a=e.p1().x(),o=e.p1().y(),r=e.p2().x(),s=e.p2().y(),l=[a-r,r-a,o-s,s-o],c=[a-t.left(),t.right()-a,o-t.top(),t.bottom()-o],u=0;u<4;++u)if(zi(l[u])){if(c[u]<0)return!1}else{var d=c[u]/l[u];if(l[u]<0){if((n=Math.max(n,d))>i)return!1}else if(n>(i=Math.min(i,d)))return!1}var h=a+n*l[1],p=a+i*l[1],f=o+n*l[3],g=o+i*l[3];return e.setP1(new window.Point(h,f)),e.setP2(new window.Point(p,g)),!0}function zi(e){return Math.abs(e)<=1e-12}var Xi=function(){function e(){s()(this,e),this.width=1,this.dashPattern=[],this.joinStyle=ci.LineJoinTypeMiter,this.dashOffset=0,this.miterLimit=4,this.compoundArray=[],this.startAnchorStyle=di,this.startAnchor=null,this.endAnchorStyle=di,this.endAnchor=null,this.alignment=0,this.startCap=ei.LineCapFlat,this.endCap=ei.LineCapFlat,this.dashCap=ei.LineCapFlat,this.clipRect=new window.Rect,this.ref=1,this.penScale=1}return c()(e,[{key:"prepareMathStroker",value:function(){var e=new Vi;return e.setWidth(this.width),e.setLineJoin(this.joinStyle),e.setMiterLimit(this.miterLimit),this.isSolid()?(e.setStartCap(this.startCap),e.setEndCap(this.endCap)):(e.setStartCap(this.dashCap),e.setEndCap(this.dashCap)),0!==this.compoundArray.length&&e.setCompoundArray(this.compoundArray,this.compoundArray.length),e.setAlignment(this.alignment),e.setPenScale(this.penScale),e}},{key:"prepareDasher",value:function(){var e=new Wi;e.setDashOffset(this.dashOffset);var t=this.dashPattern;if(this.dashCap===ei.LineCapRound||this.dashCap===ei.LineTriangleCap)for(var n=t.length,i=0;i!==n;)1&i?t[i]+=.99:t[i]-=.99,++i;return e.setDashPattern(t,t.length),e.setWidth(this.width),e}},{key:"isSolid",value:function(){return 0===this.dashPattern.length}},{key:"alignmentOffset",value:function(){if(void 0===this.alignment)return 0;switch(this.alignment){case ri:return 0;case li:return this.width/2;case si:return-this.width/2;default:return 0}}}]),e}(),Vi=function(){function e(){s()(this,e),this.m_width=1,this.m_lineJoin=ci.LineJoinTypeMiter,this.m_miterLimit=10,this.m_startCap=ei.LineCapFlat,this.m_endCap=ei.LineCapFlat,this.m_compoundArray=[],this.m_penAlignment=ri,this.m_scaleX=1,this.m_scaleY=1}return c()(e,[{key:"strokePath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.25;if(e){var i=e.toSubpathPolygons(null,n);if(i instanceof Array)for(var a=0;a<i.length;a++)this.strokeSubPath(i[a],t)}else console.error("path2stroke is not Array ")}},{key:"strokeSubPath",value:function(e,t){0!==e.length?e.isClosed?this.strokeCloseSubPath(e,t):this.strokeOpenSubPath(e,t):console.log("subPath is Empty")}},{key:"strokeCloseSubPath",value:function(e,t){var n=new qi(e),i=n.getSize();if(!(i<2)){n=n.getVertices();for(var a=[],o=[],r=[],s=0;s<this.m_compoundArray.length;s++)r.push([]);for(var l=0;l<i-2;++l)this.calcPoints(n,l,l+1,l+2,a,o,r);if(this.calcPoints(n,i-2,i-1,0,a,o,r),this.calcPoints(n,i-1,0,1,a,o,r),0===this.m_compoundArray.length)t.addPolygon(a),t.closeSubpath(),o.reverse(),t.addPolygon(o),t.closeSubpath();else for(var c=0;c<this.m_compoundArray.length;c+=2)t.addPolygon(r[c]),t.closeSubpath(),r[c+1].reverse(),t.addPolygon(r[c+1]),t.closeSubpath()}}},{key:"strokeOpenSubPath",value:function(e,t){var n=new qi(e),i=n.getSize();if(!(i<2)){n=n.getVertices();for(var a=[],o=[],r=[],s=0;s<this.m_compoundArray.length;s++)r.push([]);var l=[],c=[];this.calcStartPoints([n,a,o,r,l]);for(var u=0;u<i-2;++u)this.calcPoints(n,u,u+1,u+2,a,o,r);if(this.calcEndPoints([n,a,o,r,c]),0===this.m_compoundArray.length)t.addPolygon(a),t.connectPolygon(c),o.reverse(),t.connectPolygon(o),t.connectPolygon(l);else{for(var d=0;d<this.m_compoundArray.length;d+=2)t.addPolygon(r[d]),r[d+1].reverse(),t.connectPolygon(r[d+1]),t.closeSubpath();t.addPolygon(l),t.closeSubpath(),t.addPolygon(c),t.closeSubpath()}}}},{key:"calcPoints",value:function(e,t,n,i,a,o,r){var s=[],l=[];if(this.calcJoin(s,l,e[t].pt,e[n].pt,e[i].pt,e[t].dist,e[n].dist),this.scalePoints(s,s.length,e[n].pt),this.scalePoints(l,l.length,e[n].pt),a.push.apply(a,s),o.push.apply(o,l),0!==r.length){for(var c=[],u=0;u<this.m_compoundArray.length;u++)c.push([]);this.calcCompoundPoints(s,l,c);for(var d=0;d<this.m_compoundArray.length;++d){var h;(h=r[d]).push.apply(h,q()(c[d]))}}}},{key:"calcJoin",value:function(e,t,n,i,a,o,r){var s=Ji(n,i,a),l=this.m_width/2,c=l/o,u=l/r,d=c*(i.y()-n.y()),h=c*(i.x()-n.x()),p=u*(a.y()-i.y()),f=u*(a.x()-i.x());s>0?(this.calcInnerJoin([e,n,i,a,d,h,p,f,o,r]),this.calcOuterJoin([t,a,i,n,-p,-f,-d,-h])):s<0?(this.m_penAlignment===si?this.calcLineJoinMiter(e,n,i,a,d,h,p,f):this.calcOuterJoin([e,n,i,a,d,h,p,f]),this.calcInnerJoin([t,a,i,n,-p,-f,-d,-h,r,o])):this.calcStraightJoin([e,t,n,i,a,d,h,p,f]),t.reverse()}},{key:"calcInnerJoin",value:function(e){var t,n=F()(e,10),i=n[0],a=n[1],o=n[2],r=n[3],s=n[4],l=n[5],c=n[6],u=n[7],d=n[8],h=n[9],p=window.Point;if(void 0!==d&&void 0!==h||console.error(d+","+h+" was undefined!"),0===this.m_compoundArray.length)i.push(new window.Point(o.x()+s,o.y()-l)),i.push(new window.Point(o.x()+c,o.y()-u));else{var f=new window.Line(a,o),g=new window.Line(o,r);f.translate(s,-l),g.translate(c,-u);var v=f.angleTo(g);if((t=v)>=170&&t<=190){var y=p["*"](.5,p["+"](f.p2(),g.p1()));return void i.push(y)}var m=new window.Point;if(!Zi(f.p1(),f.p2(),g.p1(),g.p2(),m))return void console.error(o+","+r+" has no intersection!");i.push(m)}}},{key:"calcOuterJoin",value:function(e){var t=F()(e,8),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=t[5],l=t[6],c=t[7];switch(this.m_lineJoin){case ci.LineJoinTypeMiter:this.calcLineJoinMiter([n,i,a,o,r,s,l,c]);break;case ci.LineJoinTypeBevel:this.calcLineJoinBevel([n,i,a,o,r,s,l,c]);break;case ci.LineJoinTypeRound:this.calcLineJoinRound([n,i,a,o,r,s,l,c]);break;default:console.warn("Errpr LineJoinType:"+ci+"!!")}}},{key:"calcLineJoinMiter",value:function(e){var t=F()(e,8),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=t[5],l=t[6],c=t[7],u=new window.Point(i.x()+r,i.y()-s),d=new window.Point(a.x()+r,a.y()-s),h=new window.Point(a.x()+l,a.y()-c),p=new window.Point(o.x()+l,o.y()-c),f=new window.Point;Zi(u,d,h,p,f);var g=Qi(a,f),v=this.m_width/2*this.m_miterLimit;if(g>v){var y=new window.Point;if(Zi(d,h,a,f,y),Qi(a,y)>v)n.push(d),n.push(h);else{var m=(g-v)/Qi(f,y)*Qi(d,y),_=v/g,x=new window.Point(a.x()+(f.x()-a.x())*_,a.y()+(f.y()-a.y())*_),w=m/Qi(a,x),k=w*(x.y()-a.y()),b=w*(x.x()-a.x());n.push(new window.Point(x.x()+k,x.y()-b)),n.push(new window.Point(x.x()-k,x.y()+b))}}else n.push(f)}},{key:"calcLineJoinBevel",value:function(e){var t=F()(e,8),n=t[0],i=t[2],a=t[4],o=t[5],r=t[6],s=t[7],l=new window.Point(i.x()+a,i.y()-o),c=new window.Point(i.x()+r,i.y()-s);n.push(l),n.push(c)}},{key:"calcLineJoinRound",value:function(e){var t=F()(e,8),n=t[0],i=t[2],a=t[4],o=t[5],r=t[6],s=t[7];n.push(new window.Point(i.x()+a,i.y()-o));var l=Math.atan2(-o,a),c=Math.atan2(-s,r),u=this.m_width/2,d=2*Math.acos(u/(u+.125));l>c&&(c+=2*Math.PI);var h=Math.floor((c-l)/d);l+=d=(c-l)/(h+1);for(var p=0;p<h;++p){var f=new window.Point;f.setX(i.x()+Math.cos(l)*u),f.setY(i.y()+Math.sin(l)*u),n.push(f),l+=d}n.push(new window.Point(i.x()+r,i.y()-s))}},{key:"scalePoints",value:function(e,t,n){if(1!==this.m_scaleX&&1!==this.m_scaleY)for(var i=0;i<t;++i)e[i].setX(n.x()+(e[i].x()-n.x())*this.m_scaleX),e[i].setY(n.y()+(e[i].y()-n.y())*this.m_scaleY)}},{key:"calcCompoundPoints",value:function(e,t,n){if(0!==this.m_compoundArray.length){var i=e.length,a=t.length;if(i>1&&a>1);else if(i>1&&1===a)for(var o=0;o<i;++o)for(var r=e[o],s=t[0],l=s.x()-r.x(),c=s.y()-r.y(),u=this.m_compoundArray.length,d=0;d<u;++d){var h=this.m_compoundArray[d];n[d].push(new window.Point(r.x()+h*l,r.y()+h*c))}else if(a>1&&1===i)for(var p=0;p<a;++p)for(var f=e[0],g=t[p],v=g.x()-f.x(),y=g.y()-f.y(),m=this.m_compoundArray.length,_=0;_<m;++_){var x=this.m_compoundArray[_];n[_].push(new window.Point(f.x()+x*v,f.y()+x*y))}else if(1===i&&1===a)for(var w=e[0],k=t[0],b=k.x()-w.x(),T=k.y()-w.y(),C=this.m_compoundArray.length,S=0;S<C;++S){var E=this.m_compoundArray[S];n[S].push(new window.Point(w.x()+E*b,w.y()+E*T))}else console.error("ERROR!")}}},{key:"calcStraightJoin",value:function(e){var t=F()(e,9),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=new window.Point(o.x()+s,o.y()-l);if(Ji(a,d,o)>0===Ji(r,d,o)>0){var h=new window.Point(o.x()+c,o.y()-u);n.push(d),n.push(h),i.push(d),i.push(h)}else n.push(d),i.push(new window.Point(o.x()-s,o.y()+l))}},{key:"calcStartPoints",value:function(e){var t=F()(e,5),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=n;!(n instanceof Array)&&n instanceof qi&&(s=n.getVertices());var l=new window.Point,c=new window.Point;if(n instanceof qi&&n.getSize()>2||n instanceof Array&&n.length>2?this.calcStartPoints_p([l,c,s[0].pt,s[1].pt,s[2].pt,s[0].dist,s[1].dist]):this.calcStartPoints_p1([s[0].pt,s[1].pt,s[0].dist,l,c]),i.push(Object(Ui.c)(l)),a.push(Object(Ui.c)(c)),this.scalePoints(i,i.length,s[0].pt),this.scalePoints(a,a.length,s[0].pt),0!==o.length){for(var u=[],d=0;d<this.m_compoundArray.length;d++)u.push([]);this.calcCompoundPoints(i,a,u);for(var h=0;h<this.m_compoundArray.length;++h){var p;(p=o[h]).push.apply(p,q()(u[h]))}}var f=[];this.calcCap(s[1].pt,s[0].pt,s[0].dist,this.m_startCap,f),this.scalePoints(f,f.length,s[0].pt),r.push.apply(r,f)}},{key:"calcEndPoints",value:function(e){var t=F()(e,5),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=[],l=[];s.push(new window.Point),l.push(new window.Point);var c=n.length,u=n;if(!(n instanceof Array)&&n instanceof qi&&(u=n.getVertices(),c=n.getSize()),n instanceof qi&&n.getSize()>2||n instanceof Array&&n.length>2?this.calcEndPoints_p([s[0],l[0],u[c-3].pt,u[c-2].pt,u[c-1].pt,u[c-3].dist,u[c-2].dist]):this.calcEndPoints_p1([u[c-2].pt,u[c-1].pt,u[c-2].dist,s[0],l[0]]),this.scalePoints(s,s.length,u[c-1].pt),this.scalePoints(l,l.length,u[c-1].pt),i.push.apply(i,s),a.push.apply(a,l),0!==o.length){for(var d=[],h=0;h<this.m_compoundArray.length;h++)d.push([]);this.calcCompoundPoints(s,l,d);for(var p=0;p<this.m_compoundArray.length;++p){var f;(f=o[p]).push.apply(f,q()(d[p]))}}var g=[];this.calcCap(u[c-2].pt,u[c-1].pt,u[c-2].dist,this.m_endCap,g),this.scalePoints(g,g.length,u[c-1].pt),r.push.apply(r,g)}},{key:"calcStartPoints_p1",value:function(e){var t=F()(e,5),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=this.m_width/2/a,l=(i.y()-n.y())*s,c=(i.x()-n.x())*s;o.setX(n.x()+l),o.setY(n.y()-c),r.setX(n.x()-l),r.setY(n.y()+c)}},{key:"calcStartPoints_p",value:function(e){var t=F()(e,7),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=t[5],l=t[6],c=this.m_width/2,u=c/s,d=u*(o.y()-a.y()),h=u*(o.x()-a.x()),p=Ji(a,o,r);if($i(p))return n.setX(a.x()+d),n.setY(a.y()-h),i.setX(a.x()-d),void i.setY(a.y()+h);var f=c/l,g=window.Point,v=new window.Line(a,o),y=new window.Line(o,r),m=f*(r.y()-o.y()),_=f*(r.x()-o.x()),x=new window.Point;if(p>0?(v.translate(d,-h),y.translate(m,-_)):(v.translate(-d,h),y.translate(-m,_)),Zi(v.p1(),v.p2(),y.p1(),y.p2(),x)||console.error("has no intersection!"),p>0&&Ji(v.p1(),x,y.p2())<0||p<0&&Ji(v.p1(),x,y.p2())>0){var w=g["-"](v.p2(),v.p1()),k=g["-"](x,v.p1()),b=!1;$i(w.x())||$i(k.x())?$i(w.y())||$i(k.y())||(b=w.y()*k.y()<0):b=w.x()*k.x()<0,b?p>0?(n.setX(x.x()),n.setY(x.y()),i.setX(a.x()-d),i.setY(a.y()+h)):(n.setX(a.x()+d),n.setY(a.y()-h),i.setX(x.x()),i.setY(x.y())):(n.setX(a.x()+d),n.setY(a.y()-h),i.setX(a.x()-d),i.setY(a.y()+h))}else n.setX(a.x()+d),n.setY(a.y()-h),i.setX(a.x()-d),i.setY(a.y()+h)}},{key:"calcEndPoints_p1",value:function(e){var t=F()(e,5),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=this.m_width/2/a,l=(i.y()-n.y())*s,c=(i.x()-n.x())*s;o.setX(i.x()+l),o.setY(i.y()-c),r.setX(i.x()-l),r.setY(i.y()+c)}},{key:"calcEndPoints_p",value:function(e){var t=F()(e,7),n=t[0],i=t[1],a=t[2],o=t[3],r=t[4],s=t[5],l=t[6],c=this.m_width/2,u=c/l,d=u*(r.y()-o.y()),h=u*(r.x()-o.x()),p=Ji(a,o,r);if($i(p))return n.setX(r.x()+d),n.setY(r.y()-h),i.setX(r.x()-d),void i.setY(r.y()+h);var f=c/s,g=window.Point,v=f*(o.y()-a.y()),y=f*(o.x()-a.x()),m=new window.Line(a,o),_=new window.Line(o,r),x=new window.Point;if(p>0?(m.translate(v,-y),_.translate(d,-h)):(m.translate(-v,y),_.translate(-d,h)),Zi(m.p1(),m.p2(),_.p1(),_.p2(),x)||console.error("has no intersection!"),p>0&&Ji(m.p1(),x,_.p2())<0||p<0&&Ji(m.p1(),x,_.p2())>0){var w=g["-"](_.p2(),_.p1()),k=g["-"](_.p2(),x),b=!1;$i(w.x())||$i(k.x())?$i(w.y())||$i(k.y())||(b=w.y()*k.y()<0):b=w.x()*k.x()<0,b?p>0?(n.setX(x.x()),n.setY(x.y()),i.setX(r.x()-d),i.setY(r.y()+h)):(n.setX(r.x()+d),n.setY(r.y()-h),i.setX(x.x()),i.setY(x.y())):(n.setX(r.x()+d),n.setY(r.y()-h),i.setX(r.x()-d),i.setY(r.y()+h))}else n.setX(r.x()+d),n.setY(r.y()-h),i.setX(r.x()-d),i.setY(r.y()+h)}},{key:"calcCap",value:function(e,t,n,i,a){var o=this.m_width/2/n,r=o*(t.y()-e.y()),s=o*(t.x()-e.x());switch(i){case ei.LineCapFlat:this.calcCapFlat(e,t,r,s,a);break;case ei.LineCapSquare:this.calcCapSquare(e,t,r,s,a);break;case ei.LineCapRound:this.calcCapRound(e,t,r,s,a);break;default:console.log("wrong lineCap Type "+i+"!Is this a simple stroke?")}}},{key:"calcCapFlat",value:function(e,t,n,i,a){for(var o=a.length,r=0;r<o+2;r++)a.push(new window.Point);a[o].setX(t.x()+n),a[o++].setY(t.y()-i),a[o].setX(t.x()-n),a[o].setY(t.y()+i)}},{key:"calcCapSquare",value:function(e,t,n,i,a){for(var o=a.length,r=0;r<o+4;r++)a.push(new window.Point);a[o].setX(t.x()+n),a[o++].setY(t.y()-i),a[o].setX(t.x()+n+i),a[o++].setY(t.y()-i+n),a[o].setX(t.x()-n+i),a[o++].setY(t.y()+i+n),a[o].setX(t.x()-n),a[o].setY(t.y()+i)}},{key:"calcCapRound",value:function(e,t,n,i,a){var o=this.m_width/2,r=2*Math.acos(o/(o+.125)),s=Math.floor(Math.PI/r);r=Math.PI/(s+1);var l=Math.PI+Math.atan2(i,n);l-=r;for(var c=a.length,u=0;u<c+s+2;u++)a.push(new window.Point);a[c].setX(t.x()+n),a[c++].setY(t.y()-i);for(var d=0;d<s;++d){var h=Math.cos(l)*o,p=Math.sin(l)*o;a[c].setX(t.x()-h),a[c++].setY(t.y()+p),l-=r}a[c].setX(t.x()-n),a[c].setY(t.y()+i)}},{key:"getWidth",value:function(){return this.m_width}},{key:"setWidth",value:function(e){this.m_width=e<=0?1:e}},{key:"getLineJoin",value:function(){return this.m_lineJoin}},{key:"setLineJoin",value:function(e){this.m_lineJoin=e}},{key:"getMiterLimit",value:function(){return this.m_miterLimit}},{key:"setMiterLimit",value:function(e){this.m_miterLimit=e}},{key:"getStartCap",value:function(){return this.m_startCap}},{key:"setStartCap",value:function(e){this.m_startCap=e}},{key:"getEndCap",value:function(){return this.m_endCap}},{key:"setEndCap",value:function(e){this.m_endCap=e}},{key:"setLineCap",value:function(e,t){this.setEndCap(t),this.setStartCap(e)}},{key:"getCompoundArrayCount",value:function(){return this.m_compoundArray.length}},{key:"getCompoundArray",value:function(e,t){if(!(e instanceof Array&&e))return!1;for(var n=0;n<t;++n)e[n]=this.m_compoundArray[n];return!0}},{key:"setCompoundArray",value:function(e,t){if(!(e instanceof Array&&e))return!1;if(1&t)return!1;for(var n=0;n<t-1;){if(e[n]<0||e[n]>1||e[n]>=e[n+1])return!1;++n}if(e[n]<0||e[n]>1)return!1;this.m_compoundArray.length=0;for(var i=0;i<t;++i)this.m_compoundArray.push(e[i]);return!0}},{key:"getAlignment",value:function(){return this.m_penAlignment}},{key:"setAlignment",value:function(e){this.m_penAlignment=e}},{key:"getPenScale",value:function(){return this.m_penScale}},{key:"setPenScale",value:function(e){this.m_penScale=e}},{key:"setScale",value:function(e,t){this.m_scaleX=e,this.m_scaleY=t}},{key:"getScale",value:function(){return{scaleX:this.m_scaleX,scaleY:this.m_scaleY}}}]),e}(),qi=function(){function e(t){s()(this,e),this.reset(t)}return c()(e,[{key:"reset",value:function(e){this.m_pVertices=[];for(var t=0;t<e.length-1;++t){var n=new Ki(e[t],e[t+1]);1e-6<n.dist&&this.m_pVertices.push(n)}var i=new Ki(e[e.length-1],e[0]);this.m_bClosed=e.isClosed,this.m_bClosed?1e-6<i.dist&&this.m_pVertices.push(i):this.m_pVertices.push(i)}},{key:"getSize",value:function(){return this.m_pVertices.length}},{key:"getVertices",value:function(){return this.m_pVertices}},{key:"isclosed",value:function(){return this.m_bClosed}}]),e}(),Ki=function e(t,n){s()(this,e),this.pt=t,this.dist=Qi(t,n)};function Qi(e,t){if(e&&e.isQPoint&&t&&t.isQPoint){var n=e.x(),i=e.y(),a=t.x()-n,o=t.y()-i;return Math.sqrt(a*a+o*o)}console.error("this is not instanceof Point!")}function Ji(e,t,n){var i=e.x(),a=e.y(),o=t.x(),r=t.y();return(n.x()-o)*(r-a)-(n.y()-r)*(o-i)}function Zi(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new window.Point,o=e.x(),r=e.y(),s=t.x(),l=t.y(),c=n.x(),u=n.y(),d=i.x(),h=i.y(),p=(r-u)*(d-c)-(o-c)*(h-u),f=(s-o)*(h-u)-(l-r)*(d-c);if(Math.abs(f)<1e-20)return!1;var g=p/f;return a.setX(o+g*(s-o)),a.setY(r+g*(l-r)),!0}function $i(e){return Math.abs(e)<=1e-12}var ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;s()(this,e),this.m_cap=this.createLineCapState(t,n),this.isValid()&&(this.m_cap.setBaseCap(i),this.m_cap.setBaseInset(a))}return c()(e,[{key:"createLineCapState",value:function(t,n){return n===e.AnchorPathUsage.PathFill?new na(t):n===e.AnchorPathUsage.PathStroke?new ia(t):null}},{key:"reset",value:function(e){this.m_cap&&delete this.m_cap,this.m_cap=e}},{key:"isValid",value:function(){return!Object.isEmpty(this.m_cap)}},{key:"strokeStartCap",value:function(){return this.m_cap.strokeStartCap()}},{key:"setStrokeStartCap",value:function(e){return this.m_cap.setStrokeStartCap(e)}},{key:"strokeEndCap",value:function(){return this.m_cap.strokeEndCap()}},{key:"setStrokeEndCap",value:function(e){return this.m_cap.setStrokeEndCap(e)}},{key:"baseCap",value:function(){return this.isValid()?this.m_cap.baseCap():ei.LineCapFlat}},{key:"baseInset",value:function(){return this.isValid()?this.m_cap.baseInset():0}},{key:"strokeJoin",value:function(){return this.isValid()?this.m_cap.strokeJoin():ci.LineJoinTypeMiter}},{key:"widthScale",value:function(){return this.isValid()?this.m_cap.widthScale():1}},{key:"setBaseCap",value:function(e){this.isValid()&&this.m_cap.setBaseCap(e)}},{key:"setBaseInset",value:function(e){this.isValid()&&this.m_cap.setBaseInset(e)}},{key:"setStrokeJoin",value:function(e){this.isValid()&&this.m_cap.setStrokeJoin(e)}},{key:"setWidthScale",value:function(e){this.isValid()&&this.m_cap.setWidthScale(e)}},{key:"setFlatness",value:function(e){this.isValid()&&this.m_cap.setFlatness(e)}},{key:"capPath",value:function(){return this.isValid()?this.m_cap.GetCapPath():[]}}]),e}();ea.AnchorPathUsage={PathFill:0,PathStroke:1};var ta=function(){function e(t){s()(this,e),this.m_capPath=t,this.m_baseInset=0,this.m_widthScale=1,this.m_strokeStartCap=ei.LineCapFlat,this.m_strokeEndCap=ei.LineCapFlat,this.m_strokeLineJoin=ci.LineJoinTypeMiter,this.m_baseCap=ei.LineCapFlat,this.m_flatness=.25}return c()(e,[{key:"getDevidePoint",value:function(e,t,n,i,a){for(var o=this.getDevideDistance(e),r=0,s=1;s<n;++s){var l=sa(t[0],t[s]);if(l>=o)return a[0]=s-1,oa(t[0],o,t[a[0]],t[s],r,l,i),!0;r=l}return!1}},{key:"getDevideDistance",value:function(e){var t=[];return this.calcCrossYPts(this.m_capPath,t,e)?t[0]>=0?0:-t[0]:0}},{key:"calcCrossYPts",value:function(e,t,n){var i=new window.QMatrix,a=n*this.widthScale();i=new window.QMatrix(a,0,0,a,0,0)["*"](i);for(var o=e.toSubpathPolygons(i,this.m_flatness),r=0;r<o.length;++r){for(var s=o[r],l=s.length,c=s,u=[],d=0;d<l;++d){var h=c[d].x();u[d]=h>0?1:h<0?-1:0}for(var p=0;p<l-1;++p)this.calcCrossYPt(c[p],c[p+1],u[p],u[p+1],t)}return t.sort((function(e,t){return e-t})),0!==t.length}},{key:"calcCrossYPt",value:function(e,t,n,i,a){var o=n*i;if(o<0){var r=(t.x()*e.y()-e.x()*t.y())/(t.x()-e.x());a.push(r)}else if(0===o)return 0===n&&a.push(e.y()),void(0===i&&a.push(t.y()))}},{key:"calcTransform",value:function(e,t,n,i,a){var o=sa(t,n),r=(n.y()-t.y())/o,s=-(n.x()-t.x())/o;a.setMatrix(r,s,-s,r,0,0);var l=new window.QMatrix(e*this.m_widthScale,0,0,e*this.m_widthScale,0,0);a=a["*"](l);var c=new window.QMatrix(1,0,0,1,i.x(),i.y());a=a["*"](c)}},{key:"calcInsetScale",value:function(e){return e*this.m_baseInset*this.m_widthScale/this.getDevideDistance(e)}},{key:"baseInset",value:function(){return this.m_baseInset}},{key:"widthScale",value:function(){return this.m_widthScale}},{key:"strokeStartCap",value:function(){return this.m_strokeStartCap}},{key:"setStrokeStartCap",value:function(e){this.m_strokeStartCap=e}},{key:"strokeEndCap",value:function(){return this.m_strokeEndCap}},{key:"setStrokeEndCap",value:function(e){this.m_strokeEndCap=e}},{key:"strokeJoin",value:function(){return this.m_strokeLineJoin}},{key:"baseCap",value:function(){return this.m_baseCap}},{key:"setBaseInset",value:function(e){this.m_baseInset=e}},{key:"setWidthScale",value:function(e){this.m_widthScale=e}},{key:"setStrokeJoin",value:function(e){this.m_strokeLineJoin=e}},{key:"setBaseCap",value:function(e){this.m_baseCap=e}},{key:"setFlatness",value:function(e){this.m_flatness=e}}]),e}();ta.AnchorType={AnchorTypeFill:0,AnchorTypeStroke:1};var na=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.m_capPath=e,n}return p()(t,e),c()(t,[{key:"generateCap",value:function(e,t,n,i,a){var o=new window.QMatrix;this.calcTransform(e,t,n,i,o);var r=o.Map(this.m_capPath);a.addPath(r)}},{key:"getDevideDistance",value:function(e){var t=[];return this.calcCrossYPts(this.m_capPath,t,e)?t[0]>=0?0:-t[0]:0}},{key:"getMaxDistance",value:function(e){throw new Error("getMaxDistance Function not implemented")}},{key:"getCapPath",value:function(){return this.m_capPath}},{key:"getAnchorType",value:function(){return ta.AnchorType.AnchorTypeFill}}]),t}(ta),ia=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.m_capPath=e,n}return p()(t,e),c()(t,[{key:"generateCap",value:function(e,t,n,i,a){var o=window,r=o.QPainterPath,s=o.Point,l=new Vi;l.setWidth(this.widthScale()*e),l.setLineCap(this.strokeStartCap(),this.strokeEndCap()),l.setLineJoin(this.strokeJoin());var c=this.m_capPath,u=new window.QMatrix;this.calcTransform(e,t,n,i,u),c=u.Map(c);var d=new r;l.strokePath(c,d),Object(Ui.a)(3===this.m_capPath.elementCount());var h=this.m_capPath.elementAt(1).toPoint();h=u.map_point(new window.Point(h.x(),h.y()+2)),d.isEmpty()||(h=this.findNestestPoint(h,d)),d.translate(s["-"](i,h)),a.addPath(d)}},{key:"findNestestPoint",value:function(e,t){var n=window.Point;Object(Ui.a)(0!==t.elementCount());for(var i=n["-"](e,t.elementAt(0).toPoint()).manhattanLength(),a=0,o=1;o<t.elementCount();++o){var r=n["-"](e,t.elementAt(o).toPoint()).manhattanLength();i>r&&(i=r,a=o)}return t.elementAt(a).toPoint()}},{key:"getDevideDistance",value:function(e){Object(Ui.a)(3===this.m_capPath.elementCount());var t=e*this.widthScale(),n=window.Line,i=.5*t,a=new window.QMatrix(t,0,0,t,0,0).Map(this.m_capPath),o=a.elementAt(1).toPoint(),r=new window.Line(o,a.elementAt(0).toPoint()),s=new window.Line(o,a.elementAt(2).toPoint()),l=r.normalVector(),c=s.normalVector();l.setLength(i),c.setLength(-i),r.translate(l.dx(),l.dy()),s.translate(c.dx(),c.dy());var u=new window.Point;return n.IntersectType.NoIntersection!==r.intersect(s,u)?new window.Line(o,u).length():(Object(Ui.a)(!1),t)}},{key:"getMaxDistance",value:function(e){throw new Error("getMaxDistance Function not implemented")}},{key:"getCapPath",value:function(){return this.m_capPath}},{key:"getAnchorType",value:function(){return ta.AnchorType.AnchorTypeStroke}}]),t}(ta),aa=function(){function e(t,n,i){s()(this,e),this.m_width=i<1?1:i,this.m_pCustomStartCap=t.m_cap,this.m_pCustomEndCap=n.m_cap}return c()(e,[{key:"generate",value:function(e,t,n,i){for(var a=e.toSubpathPolygons(new window.QMatrix,i),o=0;o<a.length;++o)a[o].isClosed?t.addPolygon(a[o]):this.m_pCustomStartCap||this.m_pCustomEndCap?this.generateCap(a[o],a[o].length,t,n):t.addPolygon(a[o])}},{key:"generateCap",value:function(e,t,n,i){Object(Ui.a)(t>1);var a=window.QPainterPath,o=new a,r=[];if(r=Object(Ui.c)(e),this.m_pCustomStartCap){var s=new window.Point,l=[];if(this.m_pCustomStartCap.getDevidePoint(this.m_width,e,t,s,l)){var c=e[0];if(this.m_pCustomStartCap.generateCap(this.m_width,s,c,c,o),this.m_pCustomStartCap.getAnchorType()===ta.AnchorType.AnchorTypeStroke)r.splice(0,0+l[0]+1,s);else{var u=new window.Point;ra(c,s,this.m_pCustomStartCap.calcInsetScale(this.m_width),u),r.splice(0,0+l[0]+1,u)}}else{var d=e[0],h=e[t-1];this.m_pCustomStartCap.generateCap(this.m_width,h,d,d,o),r.length=0}}if(this.m_pCustomEndCap)if(0!==r.length){var p=Object(Ui.c)(r);p.reverse();var f=new window.Point,g=[];if(this.m_pCustomEndCap.getDevidePoint(this.m_width,p,p.length,f,g)){var v=p[0];if(this.m_pCustomEndCap.generateCap(this.m_width,f,v,v,o),this.m_pCustomEndCap.getAnchorType()===ta.AnchorType.AnchorTypeStroke)p.splice(0,0+g[0]+1,f);else{var y=new window.Point;ra(v,f,this.m_pCustomEndCap.calcInsetScale(this.m_width),y),p.splice(0,0+g[0]+1,y)}p.reverse(),r=p}else this.m_pCustomStartCap&&t>2?o=new a:this.m_pCustomEndCap.generateCap(this.m_width,r[0],r[r.length-1],r[r.length-1],o),r.length=0}else{for(var m=[],_=1;_<t-1;++_)m.push(e[_]);var x=new window.Point,w=this.m_pCustomStartCap.baseInset()*this.m_pCustomStartCap.widthScale();ra(e[0],e[t-1],w,x),m.push(x);var k=new window.Point;this.m_pCustomEndCap.getDevidePoint(this.m_width,m,m.length,k,[0])?this.m_pCustomEndCap.generateCap(this.m_width,k,x,e[t-1],o):this.m_pCustomStartCap.baseInset()>0&&this.m_pCustomEndCap.generateCap(this.m_width,e[0],e[t-1],e[t-1],o),r.length=0}n.addPolygon(r),o.isEmpty()||i.addPath(o)}}]),e}();function oa(e,t,n,i,a,o,r){if(Object(Ui.b)(a<=t&&o>=t,"",""),0!==a)if(s=o,l=t,Math.abs(s-l)<=1e-12*Math.min(Math.abs(s),Math.abs(l)))r=i;else{var s,l,c=function(e,t,n){var i=e.x(),a=e.y(),o=t.x(),r=t.y(),s=n.x(),l=n.y(),c=o-i,u=r-a,d=Math.sqrt(c*c+u*u);if(d<1e-13)return sa(new window.Point(i,a),new window.Point(s,l));return((s-o)*u-(l-r)*c)/d}(n,i,e);if(u=c,Math.abs(u)<=1e-12)ra(e,i,t/o,r);else{var u,d=sa(n,i);ra(i,n,(Math.sqrt(o*o-c*c)-Math.sqrt(t*t-c*c))/d,r)}}else ra(n,i,t/o,r)}function ra(e,t,n,i){var a=t.x()-e.x(),o=t.y()-e.y();i.setX(e.x()+a*n),i.setY(e.y()+o*n)}function sa(e,t){return e.isQPoint&&t.isQPoint?new window.Line(e,t).length():(console.log("calc_distance error",e,t),0)}var la=function(){function e(){s()(this,e),this.d_ptr=new Xi}return c()(e,[{key:"createStroke",value:function(e,t){var n=window.QPainterPath,i=new n,a=new n;this.d_ptr.startAnchor.setFlatness(t),this.d_ptr.endAnchor.setFlatness(t),new aa(this.d_ptr.startAnchor,this.d_ptr.endAnchor,this.d_ptr.width).generate(e,a,i,t);var o=new n,r=new ca(this.d_ptr.alignmentOffset());0===r.getOffSet()?o=a:r.zoomPath(a,o,t);var s=this.d_ptr.prepareMathStroker();if(this.d_ptr.isSolid())s.strokePath(o,i,t);else{var l=this.d_ptr.prepareDasher();l.setClipRect(this.d_ptr.clipRect);var c=this.dashCapStyle(),u=this.startCapStyle(),d=this.endCapStyle();if(c===u&&u===d){var h=new n;l.getDashedPath(o,h,t),s.strokePath(h,i,t)}else{var p=new n,f=new n,g=new n;l.getDashedPath_5(o,p,f,g,t),s.setStartCap(u),s.strokePath(p,i,t),s.setStartCap(c),s.strokePath(f,i,t),s.setEndCap(d),s.strokePath(g,i,t)}}return this.outBound=i.boundingRect(),i}},{key:"createStrokerFromPen",value:function(e){this.setDashPattern(e.dashPattern||[]),this.setDashOffset(e.dashOffset||0),this.setMiterLimit(e.miterLimit),this.setWidth(e.width),this.setJoinStyle(e.joinStyle),this.setCompoundArray(e.compoundArray||[]),this.setStartAnchorStyle(e.startAnchorStyle),this.setStartAnchor(e.startAnchor),this.setEndAnchorStyle(e.endAnchorStyle),this.setEndAnchor(e.endAnchor),this.setAlignment(e.alignment),this.setStartCapStyle(e.startCapStyle),this.setEndCapStyle(e.endCapStyle),this.setDashCapStyle(e.dashCapStyle),this.setPenScale(e.scale)}},{key:"dashPattern",value:function(){return this.d_ptr.dashPattern}},{key:"setDashPattern",value:function(e){this.d_ptr.dashPattern!==e&&(this.detach(),this.d_ptr.dashPattern=e)}},{key:"dashOffset",value:function(){return this.d_ptr.dashOffset}},{key:"setPenScale",value:function(e){var t;(t=e,Math.abs(t)<=1e-12)||(this.d_ptr.penScale=e)}},{key:"penScale",value:function(){return this.d_ptr.penScale}},{key:"setDashOffset",value:function(e){da(this.d_ptr.dashOffset,e)||(this.detach(),this.d_ptr.dashOffset=e)}},{key:"miterLimit",value:function(){return this.d_ptr.miterLimit}},{key:"setMiterLimit",value:function(e){da(this.d_ptr.miterLimit,e)||(this.detach(),this.d_ptr.miterLimit=e)}},{key:"width",value:function(){return this.d_ptr.width}},{key:"setWidth",value:function(e){da(this.d_ptr.width,e)||(this.detach(),this.d_ptr.width=e,this.d_ptr.width<=0&&(this.d_ptr.width=1))}},{key:"joinStyle",value:function(){return this.d_ptr.joinStyle}},{key:"setJoinStyle",value:function(e){this.d_ptr.joinStyle!==e&&(this.detach(),this.d_ptr.joinStyle=e)}},{key:"compoundArray",value:function(){return this.d_ptr.compoundArray}},{key:"setCompoundArray",value:function(e){(e instanceof Array||this.d_ptr.compoundArray!==e)&&(this.detach(),this.d_ptr.compoundArray=e)}},{key:"startAnchorStyle",value:function(){return this.d_ptr.startAnchorStyle}},{key:"setStartAnchorStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ea;this.d_ptr.startAnchorStyle!==e&&(this.detach(),this.d_ptr.startAnchorStyle=e,this.d_ptr.startAnchor=e)}},{key:"startAnchor",value:function(){return this.d_ptr.startAnchor}},{key:"setStartAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ea;this.detach(),this.d_ptr.startAnchor=e}},{key:"endAnchorStyle",value:function(){return this.d_ptr.endAnchorStyle}},{key:"setEndAnchorStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ea;this.d_ptr.endAnchorStyle!==e&&(this.detach(),this.d_ptr.endAnchorStyle=e,this.d_ptr.endAnchor=e)}},{key:"endAnchor",value:function(){return this.d_ptr.endAnchor}},{key:"setEndAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ea;this.detach(),this.d_ptr.endAnchor=e}},{key:"alignment",value:function(){return this.d_ptr.alignment}},{key:"setAlignment",value:function(e){this.d_ptr.alignment!==e&&(this.detach(),this.d_ptr.alignment=e)}},{key:"startCapStyle",value:function(){return this.d_ptr.startCap}},{key:"setStartCapStyle",value:function(e){this.d_ptr.startCap!==e&&(this.detach(),this.d_ptr.startCap=e)}},{key:"endCapStyle",value:function(){return this.d_ptr.endCap}},{key:"setEndCapStyle",value:function(e){this.d_ptr.endCap!==e&&(this.detach(),this.d_ptr.endCap=e)}},{key:"dashCapStyle",value:function(){return this.d_ptr.dashCap}},{key:"setDashCapStyle",value:function(e){this.d_ptr.dashCap!==e&&(this.detach(),this.d_ptr.dashCap=e)}},{key:"getClipRect",value:function(){return this.d_ptr.clipRect}},{key:"setClipRect",value:function(e){this.d_ptr.clipRect!==e&&(this.detach(),this.d_ptr.clipRect=e)}},{key:"detach",value:function(){if(1!==this.d_ptr.ref)throw new Error("this.d_ptr.ref error!")}}]),e}(),ca=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;s()(this,e),this.m_offset=t}return c()(e,[{key:"setOffset",value:function(e){this.m_offset=e}},{key:"getOffSet",value:function(){return this.m_offset}},{key:"zoomPath",value:function(e,t,n){if(0!==this.m_offset)if(this.m_offset>0)for(var i=e.toSubpathPolygons(null,n),a=this.m_offset,o=0;o<i.length;++o){var r=new ua(i[o]);if(r.isValid()){0===o&&(r.isClockWise()||(a=-this.m_offset));var s=[];r.getZoomPoints(s,a),t.moveTo(s[0]),t.connectPolygon(s),r.isClosed()&&t.closeSubpath()}else{var l=i[o];t.connectPolygon(l),l.isClosed&&t.closeSubpath()}}else for(var c=e.toSubpathPolygons(null,n),u=this.m_offset,d=0,h=c.length;d<h;++d){var p=new ua(c[d]);if(p.isValid()){var f=[];p.getZoomPoints(f,u),t.moveTo(f[0]),t.connectPolygon(f),p.isClosed()&&t.closeSubpath()}else{var g=c[d],v=new window.Line(new window.Point,new window.Point);this.getEdgeOffsetPts(g[0],g[1],u,v),t.moveTo(v.p1()),t.lineTo(v.p2()),g.isClosed&&(t.closeSubpath(),t.closeSubpath())}}else t=e}}]),e}(),ua=function(){function e(t){s()(this,e),this.m_bClosed=!1,this.m_bClockWise=!1,this.m_pts=t,this.eraseStraightPointsOnPolygon(this.m_pts)?(this.m_bClosed=t.isClosed,this.m_bClockWise=function(e,t){for(var n=e[0].x(),i=0,a=1;a<t;++a)e[a].x()<n&&(n=e[a].x(),i=a);var o=void 0,r=void 0,s=i;o=i-1,r=i+1,0===s&&(o=t-1);s===t-1&&(r=0);return ha(e[o],e[s],e[r])<0}(this.m_pts,this.m_pts.length)):(console.log("polygon is Clear!!!"),this.m_pts.length=0)}return c()(e,[{key:"eraseStraightPointsOnPolygon",value:function(e){var t=e.length;if(t<3)return!1;if(3===t)return 3!==ha(e[0],e[1],e[2]);for(var n=0;n<t-2;++n)0===ha(e[n],e[n+1],e[n+2])&&(e.splice(0+n+1,1),--t,--n);return!(t<3)&&(0===ha(e[t-2],e[t-1],e[0])&&(e.splice(e.length-1,1),--t),!(t<3)&&(0===ha(e[t-1],e[0],e[1])&&(e.splice(0,1),--t),!(t<3)))}},{key:"getZoomPoints",value:function(e,t){e.length=0;var n=new window.Line(new window.Point,new window.Point),i=new window.Line(new window.Point,new window.Point),a=0,o=new window.Point(this.m_pts[0].x(),this.m_pts[0].y());this.m_bClosed?(this.getEdgeOffsetPts(this.m_pts[this.m_pts.length-1],this.m_pts[0],t,n),this.getEdgeOffsetPts(this.m_pts[0],this.m_pts[1],t,i),n.intersect(i,o),fa(a=n.angleTo(i))?e.push(n.p2()):pa(a)?(e.push(n.p2()),e.push(i.p1())):e.push(new window.Point(o.x(),o.y()))):(this.getEdgeOffsetPts(this.m_pts[0],this.m_pts[1],t,n),i=n,e.push(n.p1()));for(var r=this.m_pts.length,s=1;s<r-1;++s)if(!(new window.Line(this.m_pts[s],this.m_pts[s+1]).length()<.01)){var l=new window.Line(i.p1(),i.p2());this.getEdgeOffsetPts(this.m_pts[s],this.m_pts[s+1],t,i),l.intersect(i,o),fa(a=l.angleTo(i))?e.push(l.p2()):pa(a)?(e.push(l.p2()),e.push(i.p1())):e.push(new window.Point(o.x(),o.y()))}if(this.m_bClosed){var c=new window.Line(i.p1(),i.p2());this.getEdgeOffsetPts(this.m_pts[r-1],this.m_pts[0],t,i),c.intersect(i,o),fa(a=c.angleTo(i))?e.push(c.p2()):pa(a)?(e.push(c.p2()),e.push(i.p1())):e.push(new window.Point(o.x(),o.y()))}else this.getEdgeOffsetPts(this.m_pts[r-2],this.m_pts[r-1],t,i),e.push(i.p2());return!0}},{key:"getEdgeOffsetPts",value:function(e,t,n,i){var a=new window.Line(e,t),o=a.normalVector();if(!(Math.abs(o.dx())<.01&&Math.abs(o.dy())<.01)){var r=o.unitVector();r.setLength(n),a.translate(r.dx(),r.dy()),i.setNewLine(a)}}},{key:"isValid",value:function(){return 0!==this.m_pts.length}},{key:"isClosed",value:function(){return this.m_bClosed}},{key:"isClockWise",value:function(){return this.m_bClockWise}},{key:"getPointsCount",value:function(){return this.m_pts.length}},{key:"getPoints",value:function(){return this.m_pts}}]),e}();function da(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function ha(e,t,n){var i=e.x(),a=e.y(),o=t.x(),r=t.y();return(n.x()-o)*(r-a)-(n.y()-r)*(o-i)}function pa(e){return e>=170&&e<=190}function fa(e){return e<.1||e>359.9}var ga=n(4744);function va(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(ga.b)(e,t,"canvas","geomerty"),i=n.getElem();return i.width=e<1?1:e,i.height=t<1?1:t,n}var ya,ma,_a,xa,wa=void 0,ka="http://www.w3.org/2000/svg";function ba(e){var t,n=void 0,i=void 0;if(!e)throw new Error("cannot create a random attribute name for an undefined object");t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="";do{for(n="",i=0;i<12;i++)n+=t[Math.floor(Math.random()*t.length)]}while(e[n]);return n}function Ta(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}xa=function(e,t){var n=void 0,i=void 0,a={},o=void 0;for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)i="&"+e[n+1]+";",o=parseInt(e[n],t),a[i]="&#"+o+";";return a["\\xa0"]="&#160;",a}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),ya={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},Object.freeze(ya);var Ca=Object.keys(ya);(ma=function(e,t){this.__root=e,this.__ctx=t}).prototype.addColorStop=function(e,t){var n=this.__ctx.__createElement("stop"),i=void 0;n.setAttribute("offset",e),-1!==t.indexOf("rgba")?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t))?(n.setAttribute("stop-color","rgb("+i[1]+","+i[2]+","+i[3]+")"),n.setAttribute("stop-opacity",i[4])):console.error("error rgba param!",t):n.setAttribute("stop-color",t),this.__root.appendChild(n)},(_a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wa;this.__root=e,this.__ctx=t}).prototype.getPattern=function(){return this.__root},_a.prototype.setTransform=function(e){e=e.isQMatrix?e.toString():e;var t=this.__root.getAttribute("patternTransform");e=t?t+e:e,this.__root.setAttribute("patternTransform",e)},(wa=function(e){var t=this,n={width:500,height:500,enableMirroring:!1},i=void 0;if(arguments.length>1?((i=n).width=arguments[0],i.height=arguments[1]):i=e||n,!(this instanceof wa))return new wa(i);this.__width=i.width||n.width,this.__height=i.height||n.height,this.enableMirroring=void 0!==i.enableMirroring?i.enableMirroring:n.enableMirroring,this.canvas=this,this.__document=i.document||document,i.ctx?this.__ctx=i.ctx:this.__ctx=this,this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS(ka,"svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns",ka),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.__width),this.__root.setAttribute("height",this.__height),this.__root.setAttribute("overflow","visible"),this.__ids={},this.__defs=this.__document.createElementNS(ka,"defs"),this.__defs.appendNode=function(e){t.curId&&(t.__curDefs[t.curId]=t.__curDefs[t.curId]||[],t.__curDefs[t.curId].includes(e)||t.__curDefs[t.curId].push(e)),t.__defs.appendChild(e)},this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS(ka,"g"),this.__root.appendChild(this.__currentElement),this.__curDefs={}}).prototype.setViewBox=function(e){var t=e.x,n=e.y,i=e.width,a=e.height;this.setAttribute("viewBox",(t||0)+" "+(n||0)+" "+i+" "+a)},wa.prototype.setAttribute=function(e,t){e&&this.__root.setAttribute(e,t)},Object.defineProperty(wa.prototype,"width",{get:function(){return this.__width},set:function(e){this.__width=e,this.__root.setAttribute("width",this.__width)}}),Object.defineProperty(wa.prototype,"height",{get:function(){return this.__height},set:function(e){this.__height=e,this.__root.setAttribute("height",this.__height)}}),wa.prototype.__createElement=function(e,t,n){var i=this.__document.createElementNS(ka,e);for(var a in n&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),t)i.setAttribute(a,t[a]);return i},wa.prototype.getElem=function(){return this},wa.prototype.getContext=function(){return this},wa.prototype.__setDefaultStyles=function(){var e=Ca,t=void 0,n=void 0;for(t=0;t<e.length;t++)this[n=e[t]]=ya[n].canvas},wa.prototype.__applyStyleState=function(e){var t=Object.keys(e),n=void 0,i=void 0;for(n=0;n<t.length;n++)this[i=t[n]]=e[i]},wa.prototype.__getStyleState=function(){var e=void 0,t={},n=Ca,i=void 0;for(e=0;e<n.length;e++)t[i=n[e]]=this[i];return t},wa.prototype.__applyStyleToCurrentElement=function(e){var t=this.__currentElement,n=this.__currentElementsToStyle;n&&(t.setAttribute(e,""),t=n.element,n.children.forEach((function(t){t.setAttribute(e,"")})));var i=Ca,a=void 0,o=void 0,r=void 0,s=void 0,l=void 0;for(a=0;a<i.length;a++)if(o=ya[i[a]],r=this[i[a]],o.apply&&!Object.isEmpty(r))if(r instanceof _a&&o.apply===e){if(r.__ctx&&r.__ctx!==this)for(var c=0;c<r.__ctx.__defs.childNodes.length;c++)s=r.__ctx.__defs.childNodes[c].getAttribute("id"),this.__ids[s]=s,this.__defs.appendNode(r.__ctx.__defs.childNodes[c]);t.setAttribute(o.apply,"url(#"+r.__root.getAttribute("id")+")"),t.setAttribute("class","_used_url")}else if(r instanceof ma&&o.apply===e)t.setAttribute(o.apply,"url(#"+r.__root.getAttribute("id")+")"),t.setAttribute("class","_used_url");else if(-1!==o.apply.indexOf(e)&&o.svg!==r)if("stroke"!==o.svgAttr&&"fill"!==o.svgAttr||-1===r.indexOf("rgba")){var u=o.svgAttr;if("globalAlpha"===i[a]&&(u=e+"-"+o.svgAttr,t.getAttribute(u)))continue;t.setAttribute(u,r)}else if(l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(r)){t.setAttribute(o.svgAttr,"rgb("+l[1]+","+l[2]+","+l[3]+")");var d=l[4],h=this.globalAlpha;Object.isEmpty(h)||(d*=h),t.setAttribute(o.svgAttr+"-opacity",d)}else console.error("error rgba param!",r)},wa.prototype.__closestGroupOrSvg=function(e){return"g"===(e=e||this.__currentElement).nodeName||"svg"===e.nodeName?e:this.__closestGroupOrSvg(e.parentNode)},wa.prototype.getSerializedSvg=function(e){var t=(new XMLSerializer).serializeToString(this.__root),n=void 0,i=void 0,a=void 0,o=void 0,r=void 0;if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(n=Object.keys(xa),i=0;i<n.length;i++)a=n[i],o=xa[a],(r=new RegExp(a,"gi")).test(t)&&(t=t.replace(r,o));return t},wa.prototype.getSvg=function(){return this.__root},wa.prototype.save=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.__createElement("g");e&&(e.toString&&0===e.toString().indexOf("s_")&&n&&(this.curId=e),i.setAttribute("id",e)),t&&(i.style["mix-blend-mode"]=t);var a=this.__closestGroupOrSvg();return this.__groupStack.push(a),a.appendChild(i),this.__currentElement=i,this.__stack.push(this.__getStyleState()),i},wa.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]),this.drawImageAlpha=null;var e=this.__stack.pop();this.__applyStyleState(e)},wa.prototype.__addTransform=function(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var n=this.__createElement("g");t.appendChild(n),this.__currentElement=n}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=e,this.__currentElement.setAttribute("transform",i)},wa.prototype.scale=function(e,t){void 0===t&&(t=e),1===Number(e)&&1===Number(t)||this.__addTransform("scale("+e+","+t+")")},wa.prototype.rotate=function(e){if(e){var t=180*e/Math.PI;this.__addTransform("rotate("+t+", 0, 0)")}},wa.prototype.translate=function(e,t){0===Number(e)&&0===Number(t)||this.__addTransform("translate("+e+", "+t+")")},wa.prototype.transform=function(e,t,n,i,a,o){this.__addTransform("matrix("+e+", "+t+", "+n+", "+i+", "+a+", "+o+")")},wa.prototype.beginPath=function(e){var t=void 0;this.__currentDefaultPath="",this.__currentDefaultPath_hasM=!1,this.__currentPosition={},t=this.__createElement("path",void 0,!0),e&&(t.style["mix-blend-mode"]=e),this.__closestGroupOrSvg().appendChild(t),this.__currentElement=t},wa.prototype.__applyCurrentDefaultPath=function(){var e=this.__currentElement;"path"===e.nodeName?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName)},wa.prototype.__addPathCommand=function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e},wa.prototype.moveTo=function(e,t){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand("M "+e+" "+t),this.__currentDefaultPath_hasM=!0},wa.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},wa.prototype.lineTo=function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath_hasM?this.__addPathCommand("L "+e+" "+t):(this.__addPathCommand("M "+e+" "+t),this.__currentDefaultPath_hasM=!0)},wa.prototype.bezierCurveTo=function(e,t,n,i,a,o){this.__currentPosition={x:a,y:o},this.__addPathCommand("C "+e+" "+t+" "+n+" "+i+" "+a+" "+o)},wa.prototype.quadraticCurveTo=function(e,t,n,i){this.__currentPosition={x:n,y:i},this.__addPathCommand("Q "+e+" "+t+" "+n+" "+i)};var Sa=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]};wa.prototype.arcTo=function(e,t,n,i,a){var o=this.__currentPosition&&this.__currentPosition.x,r=this.__currentPosition&&this.__currentPosition.y;if(void 0!==o&&void 0!==r){if(a<0)throw new Error("IndexSizeError: The radius provided ("+a+") is negative.");if(o===e&&r===t||e===n&&t===i||0===a)this.lineTo(e,t);else{var s=Sa([o-e,r-t]),l=Sa([n-e,i-t]);if(s[0]*l[1]!=s[1]*l[0]){var c=s[0]*l[0]+s[1]*l[1],u=Math.acos(Math.abs(c)),d=Sa([s[0]+l[0],s[1]+l[1]]),h=a/Math.sin(u/2),p=e+h*d[0],f=t+h*d[1],g=[-s[1],s[0]],v=[l[1],-l[0]],y=function(e){var t=e[0];return e[1]>=0?Math.acos(t):-Math.acos(t)},m=y(g),_=y(v);this.lineTo(p+g[0]*a,f+g[1]*a),this.arc(p,f,a,m,_)}else this.lineTo(e,t)}}},wa.prototype.stroke=function(e){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),e&&(this.__currentElement.id=e),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},wa.prototype.fill=function(e,t){"path"===this.__currentElement.nodeName&&(this.__currentElement.setAttribute("paint-order","stroke fill markers"),"evenodd"===e&&this.__currentElement.setAttribute("fill-rule","evenodd")),t&&(this.__currentElement.id=t),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},wa.prototype.rect=function(e,t,n,i){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.lineTo(e,t),this.closePath()},wa.prototype.fillRect=function(e,t,n,i){var a;a=this.__createElement("rect",{x:e,y:t,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(a),this.__currentElement=a,this.__applyStyleToCurrentElement("fill")},wa.prototype.strokeRect=function(e,t,n,i){var a;a=this.__createElement("rect",{x:e,y:t,width:n,height:i},!0),this.__closestGroupOrSvg().appendChild(a),this.__currentElement=a,this.__applyStyleToCurrentElement("stroke")},wa.prototype.__clearCanvas=function(){for(var e=this.__closestGroupOrSvg().getAttribute("transform"),t=this.__root.childNodes[0],n=t.childNodes,i=n.length-1;i>=0;i--)n[i]&&t.removeChild(n[i]);for(var a=(n=(t=this.__root.childNodes[1]).childNodes).length-1;a>=0;a--)n[a]&&t.removeChild(n[a]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)},wa.prototype.clearRect=function(e,t,n,i){this.__clearCanvas()},wa.prototype.createLinearGradient=function(e,t,n,i){var a=this.__createElement("linearGradient",{id:ba(this.__ids),x1:e+"px",x2:n+"px",y1:t+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendNode(a),new ma(a,this)},wa.prototype.createRadialGradient=function(e,t,n,i,a,o){try{var r=Gn.h.agent.match(/cpu iphone os (.*?) like mac os/);r&&"13_1_3"===r[1]&&(i=e,a=t);var s=Math.sqrt((e-i)*(e-i)+(t-a)*(t-a));o=s>o?s:o}catch(e){console.error("createRadialGradient error")}var l=this.__createElement("radialGradient",{id:ba(this.__ids),cx:i+"px",cy:a+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendNode(l),new ma(l,this)},wa.prototype.__parseFont=function(){var e=this.__root.style,t=e.font;e.font=this.font;var n={style:e.fontStyle||"normal",size:e.fontSize||"10px",family:e.fontFamily||"sans-serif",weight:e.fontWeight||"normal",decoration:e.textDecoration||"normal",href:null};return e.font=t,"underline"===this.__fontUnderline&&(n.decoration="underline"),this.__fontHref&&(n.href=this.__fontHref),n},wa.prototype.__wrapTextLink=function(e,t){if(e.href){var n=this.__createElement("a");return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),n.appendChild(t),n}return t},wa.prototype.__applyText=function(e,t,n,i){var a,o,r=this.__parseFont(),s=this.__closestGroupOrSvg(),l=this.__createElement("text",{"font-family":r.family,"font-size":r.size,"font-style":r.style,"font-weight":r.weight,"text-decoration":r.decoration,x:t,y:n,"text-anchor":(a=this.textAlign,o={left:"start",right:"end",center:"middle",start:"start",end:"end"},o[a]||o.start),"dominant-baseline":Ta(this.textBaseline)},!0);l.appendChild(this.__document.createTextNode(e)),this.__currentElement=l,this.__applyStyleToCurrentElement(i),s.appendChild(this.__wrapTextLink(r,l))},wa.prototype.fillText=function(e,t,n){this.__applyText(e,t,n,"fill")},wa.prototype.strokeText=function(e,t,n){this.__applyText(e,t,n,"stroke")},wa.prototype.measureText=function(e){},wa.prototype.arc=function(e,t,n,i,a,o){if(i!==a){(i%=2*Math.PI)===(a%=2*Math.PI)&&(a=(a+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var r=e+n*Math.cos(a),s=t+n*Math.sin(a),l=e+n*Math.cos(i),c=t+n*Math.sin(i),u=o?0:1,d=0,h=a-i;h<0&&(h+=2*Math.PI),d=o?h>Math.PI?0:1:h>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand("A "+n+" "+n+" 0 "+d+" "+u+" "+r+" "+s),this.__currentPosition={x:r,y:s}}},wa.prototype.clip=function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),n=ba(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",n),t.appendChild(this.__currentElement),this.__defs.appendNode(t),e.setAttribute("clip-path","url(#"+n+")"),e.setAttribute("class","_used_url"),e.appendChild(i),this.__currentElement=i},wa.prototype.drawImage=function(){var e=Array.prototype.slice.call(arguments),t=e[0],n=void 0,i=void 0,a=void 0,o=void 0,r=0,s=0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0,v=void 0,y=void 0;if(3===e.length)n=e[1],i=e[2],a=l=t.width,o=c=t.height;else if(5===e.length||6===e.length)n=e[1],i=e[2],a=Math.ceil(e[3]),o=Math.ceil(e[4]),y=e[5],l=t.width,c=t.height;else{if(9!==e.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);r=e[1],s=e[2],l=Math.ceil(e[3]),c=Math.ceil(e[4]),n=e[5],i=e[6],a=Math.ceil(e[7]),o=Math.ceil(e[8])}u=this.__closestGroupOrSvg();var m="translate("+n+", "+i+")";if(t instanceof wa){if((d=t.getSvg().cloneNode(!0)).childNodes&&d.childNodes.length>1){if(h=d.childNodes[0],!y)for(;h.childNodes.length;)if(v=h.childNodes[0].id,h.children||(this.__defs.children={}),this.__ids[v]=v,this.__defs.children||(this.__defs.children={}),this.__defs.children[v]){var _=h.children[v]||h.querySelector("#"+v);_.remove()}else this.__defs.appendNode(h.childNodes[0]),this.__defs.children[v]||(this.__defs.children[v]=!0);if(p=d.childNodes[1]){var x=p.getAttribute("transform"),w=void 0;w=x?x+" "+m:m,p.setAttribute("transform",w),u.appendChild(p)}}}else if("CANVAS"===t.nodeName||"IMG"===t.nodeName){f=this.__createElement("image"),!Object.isEmpty(a)&&f.setAttribute("width",a),!Object.isEmpty(o)&&f.setAttribute("height",o),f.setAttribute("crossOrigin","anonymous"),f.setAttribute("preserveAspectRatio","none"),t.setAttribute("crossOrigin","anonymous"),t.height&&t.width&&(r||s||l!==t.width||c!==t.height)&&((g=this.__document.createElement("canvas")).width=a,g.height=o,g.getContext("2d").drawImage(t,r,s,l,c,0,0,a,o),t=g),t.crossOrigin="anonymous",f.setAttribute("transform",m);var k=t.src?t.src:t.data_url;t.data_url&&t.isLoading&&(t.startTime=Date.now(),f._tokenKey=t._tokenKey,f.setAttribute("tokenKey",""+t._tokenKey),f.onload=function(e){window.svgImageLoad(e.target||e.srcElement)},f.onerror=function(e){window.svgImageError(e.target||e.srcElement)},Gn.h.isIE?(t.onload=function(){window.svgImageLoad(f)},t.onerror=function(){window.svgImageError(f)},t.src=k):Gn.h.isIos&&setTimeout((function(){window.svgImageLoad(f)}),1e3*(.5*Math.random()+.5)),window.__isSupportSVGImageLoad||window.svgImageLoad(f,!0)),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():k),isNaN(this.drawImageAlpha)||f.setAttribute("opacity",this.drawImageAlpha),u.appendChild(f)}},wa.prototype.createPattern=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this,o=arguments[4],r=arguments[5],s=this.__document.createElementNS(ka,"pattern"),l=ba(this.__ids),c=void 0;if(s.setAttribute("id",l),s.setAttribute("x",n),s.setAttribute("y",i),s.setAttribute("width",o||e.width),s.setAttribute("height",r||e.height),s.setAttribute("patternUnits","userSpaceOnUse"),"CANVAS"===e.nodeName||"IMG"===e.nodeName?((c=this.__document.createElementNS(ka,"image")).setAttribute("width",e.width),c.setAttribute("height",e.height),e.setAttribute("crossOrigin","anonymous"),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===e.nodeName?e.toDataURL():e.getAttribute("src")),s.appendChild(c),this.__defs.appendNode(s)):e instanceof wa&&(s.appendChild(e.__root.childNodes[1].cloneNode(!0)),this.__defs.appendNode(s),e.__defs.children.forEach((function(e){a.__defs.appendNode(e.cloneNode(!0))}))),Gn.h.chromeVS<96&&Gn.h.chromeVS>70){s.setAttribute("patternTransform","scale(0.25)"),s.setAttribute("width",4*+s.getAttribute("width")),s.setAttribute("height",4*+s.getAttribute("height"));for(var u=s.firstElementChild;u;){var d=u.getAttribute("transform");d&&u.setAttribute("transform","scale(4, 4)"+d+"scale(0.25, 0.25)");var h=u.getAttribute("width"),p=u.getAttribute("height");h&&u.setAttribute("width",4*+h),p&&u.setAttribute("height",4*+p),u=u.firstElementChild}}return new _a(s)},wa.prototype.setLineDash=function(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null},wa.prototype.drawFocusRing=function(){},wa.prototype.createImageData=function(){},wa.prototype.getImageData=function(){},wa.prototype.putImageData=function(){},wa.prototype.globalCompositeOperation=function(){},wa.prototype.setTransform=function(){},wa.prototype.isSvg=!0,wa.prototype.getLastGroup=function(){return this.__groupStack[this.__groupStack.length-1]},wa.prototype.clearDefById=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.__curDefs[e];i&&i instanceof Array&&(i.forEach((function(e){if(n){e.remove();var i=window.domTools.getCommonSvg().querySelector("#"+e.id);i&&i.remove()}else t.__defs.removeNodeIds=t.__defs.removeNodeIds||[],t.__defs.removeNodeIds.push(e.id)})),this.__curDefs[e]=[])},wa.prototype.getCurrentElement=function(){return this.__currentElement},wa.prototype.destroy=function(){this.__root&&(this.__root.remove(),this.__root.innerHTML="",this.__root=null)};var Ea=wa,Pa=function(){function e(){s()(this,e),this.shadowRange=[[102,255],[50,255],[0,153],[0,205]]}return c()(e,[{key:"fillShadowTransform",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=this.shadowRange;if(t>=0&&t<a.length){var o=a[t][1],r=a[t][0],s=o-r;e.map((function(e){var t=r*e[3]*255;e[0]=t+s*e[0]>>8,e[1]=t+s*e[1]>>8,e[2]=t+s*e[2]>>8}))}var l=e.map((function(e){return"rgba("+(e=n.colorLightControl(e,i))[0]+","+e[1]+","+e[2]+","+e[3]+")"}));return l}},{key:"colorLightControl",value:function(e,t){var n=F()(e,3),i=n[0],a=n[1],o=n[2];return t>=0?(i+=(255-i)*t,a+=(255-a)*t,o+=(255-o)*t):t<0&&(i+=i*t,a+=a*t,o+=o*t),[i=i<255?i:255,a=a<255?a:255,o=o<255?o:255,e[3]]}},{key:"transformFillData",value:function(){}},{key:"setFillColorRgba",value:function(e){this.rgba=e}},{key:"getFillColorRgba",value:function(){return this.rgba}},{key:"setShadowRangeIndex",value:function(e){this.shadowRangeIndex=e}},{key:"getShadowRangeIndex",value:function(){return this.shadowRangeIndex}},{key:"solidFill",value:function(e,t,n){var i=t.slice(5,t.length-1).split(",").map(Number);if(n>=0&&n<this.shadowRange.length){var a=this.fillShadowTransform([i],n);e.fillStyle=a}else e.fillStyle=this.fillShadowTransform([i])}},{key:"backGroundColorFill",value:function(e,t){var n=void 0,i=void 0,a=void 0;t>=0&&t<this.shadowRange.length?(i=(n="rgba(0,0,0,0.2)").slice(5,n.length-1).split(",").map(Number),a=this.fillShadowTransform([i],t),e.fillStyle=a):(i=(n="rgba(255,255,255,0)").slice(5,n.length-1).split(",").map(Number),e.fillStyle=this.fillShadowTransform([i]))}},{key:"render",value:function(e){return this.getFillColorRgba()?this.solidFill(e,this.getFillColorRgba(),this.getShadowRangeIndex()):this.backGroundColorFill(this.getShadowRangeIndex()),!0}}]),e}(),La=function(){function e(t,n,i,a,o,r,l,c,u,d,h,p,f,g,v,y){s()(this,e),this.m=[[],[],[],[]],0===arguments.length?this.setToIdentity():(this.m[0][0]=t,this.m[0][1]=o,this.m[0][2]=u,this.m[0][3]=f,this.m[1][0]=n,this.m[1][1]=r,this.m[1][2]=d,this.m[1][3]=g,this.m[2][0]=i,this.m[2][1]=l,this.m[2][2]=h,this.m[2][3]=v,this.m[3][0]=a,this.m[3][1]=c,this.m[3][2]=p,this.m[3][3]=y),this.flagBits=2}return c()(e,[{key:"data",value:function(){return this.flagBits=2,this.m}},{key:"constData",value:function(){return this.flagBits=2,this.m}},{key:"setToIdentity",value:function(){var e=this.m;e[0][0]=1,e[0][1]=0,e[0][2]=0,e[0][3]=0,e[1][0]=0,e[1][1]=1,e[1][2]=0,e[1][3]=0,e[2][0]=0,e[2][1]=0,e[2][2]=1,e[2][3]=0,e[3][0]=0,e[3][1]=0,e[3][2]=0,e[3][3]=1,this.flagBits=1}},{key:"isIdentity",value:function(){if(1===this.flagBits)return!0;var e=this.m;return 1===e[0][0]&&0===e[0][1]&&0===e[0][2]&&(0===e[0][3]&&0===e[1][0]&&1===e[1][1]&&(0===e[1][2]&&0===e[1][3]&&0===e[2][0]&&(0===e[2][1]&&1===e[2][2]&&0===e[2][3]&&(0===e[3][0]&&0===e[3][1]&&0===e[3][2]&&1===e[3][3]))))}},{key:"isMatrix4x4",get:function(){return!0}}],[{key:"multiply",value:function(e,t){return e.isMatrix4x4&&"number"==typeof t?this.m1Multiplyn(e,t):e.isMatrix4x4&&t.isMatrix4x4?this.m1Multiplym2(e,t):void 0}},{key:"m1Multiplym2",value:function(t,n){if(1===t.flagBits)return n;if(1===n.flagBits)return t;var i=new e;return i.m[0][0]=t.m[0][0]*n.m[0][0]+t.m[1][0]*n.m[0][1]+t.m[2][0]*n.m[0][2]+t.m[3][0]*n.m[0][3],i.m[0][1]=t.m[0][1]*n.m[0][0]+t.m[1][1]*n.m[0][1]+t.m[2][1]*n.m[0][2]+t.m[3][1]*n.m[0][3],i.m[0][2]=t.m[0][2]*n.m[0][0]+t.m[1][2]*n.m[0][1]+t.m[2][2]*n.m[0][2]+t.m[3][2]*n.m[0][3],i.m[0][3]=t.m[0][3]*n.m[0][0]+t.m[1][3]*n.m[0][1]+t.m[2][3]*n.m[0][2]+t.m[3][3]*n.m[0][3],i.m[1][0]=t.m[0][0]*n.m[1][0]+t.m[1][0]*n.m[1][1]+t.m[2][0]*n.m[1][2]+t.m[3][0]*n.m[1][3],i.m[1][1]=t.m[0][1]*n.m[1][0]+t.m[1][1]*n.m[1][1]+t.m[2][1]*n.m[1][2]+t.m[3][1]*n.m[1][3],i.m[1][2]=t.m[0][2]*n.m[1][0]+t.m[1][2]*n.m[1][1]+t.m[2][2]*n.m[1][2]+t.m[3][2]*n.m[1][3],i.m[1][3]=t.m[0][3]*n.m[1][0]+t.m[1][3]*n.m[1][1]+t.m[2][3]*n.m[1][2]+t.m[3][3]*n.m[1][3],i.m[2][0]=t.m[0][0]*n.m[2][0]+t.m[1][0]*n.m[2][1]+t.m[2][0]*n.m[2][2]+t.m[3][0]*n.m[2][3],i.m[2][1]=t.m[0][1]*n.m[2][0]+t.m[1][1]*n.m[2][1]+t.m[2][1]*n.m[2][2]+t.m[3][1]*n.m[2][3],i.m[2][2]=t.m[0][2]*n.m[2][0]+t.m[1][2]*n.m[2][1]+t.m[2][2]*n.m[2][2]+t.m[3][2]*n.m[2][3],i.m[2][3]=t.m[0][3]*n.m[2][0]+t.m[1][3]*n.m[2][1]+t.m[2][3]*n.m[2][2]+t.m[3][3]*n.m[2][3],i.m[3][0]=t.m[0][0]*n.m[3][0]+t.m[1][0]*n.m[3][1]+t.m[2][0]*n.m[3][2]+t.m[3][0]*n.m[3][3],i.m[3][1]=t.m[0][1]*n.m[3][0]+t.m[1][1]*n.m[3][1]+t.m[2][1]*n.m[3][2]+t.m[3][1]*n.m[3][3],i.m[3][2]=t.m[0][2]*n.m[3][0]+t.m[1][2]*n.m[3][1]+t.m[2][2]*n.m[3][2]+t.m[3][2]*n.m[3][3],i.m[3][3]=t.m[0][3]*n.m[3][0]+t.m[1][3]*n.m[3][1]+t.m[2][3]*n.m[3][2]+t.m[3][3]*n.m[3][3],i}},{key:"m1Multiplyn",value:function(t,n){var i=new e;return i.m[0][0]=t.m[0][0]*n,i.m[0][1]=t.m[0][1]*n,i.m[0][2]=t.m[0][2]*n,i.m[0][3]=t.m[0][3]*n,i.m[1][0]=t.m[1][0]*n,i.m[1][1]=t.m[1][1]*n,i.m[1][2]=t.m[1][2]*n,i.m[1][3]=t.m[1][3]*n,i.m[2][0]=t.m[2][0]*n,i.m[2][1]=t.m[2][1]*n,i.m[2][2]=t.m[2][2]*n,i.m[2][3]=t.m[2][3]*n,i.m[3][0]=t.m[3][0]*n,i.m[3][1]=t.m[3][1]*n,i.m[3][2]=t.m[3][2]*n,i.m[3][3]=t.m[3][3]*n,i}}]),e}(),Aa=n(5907),Ia=window.imageEffectsPool=window.imageEffectsPool||new Aa.a(50),Ra=function(e){function t(e){var n=e.rect,i=e.fill,a=e.shadowRangeIndex,o=e.preloadSource,r=e.scale,l=e.clip;s()(this,t);var c=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),u=n.width,h=n.height,p=n.x,f=n.y;return c.rect=n||{},c.nRect=new window.Rect(p,f,u,h),c.fill=i||{},c.clip=l||!1,c.scale=15*r,c.shadowRangeIndex=void 0===a?-1:a,c.preloadSource=o||{},c._init(),c}return p()(t,e),c()(t,[{key:"transformFillData",value:function(e){if(e.isStretched)return e.stretchRectangle?e.stretchRectangle:{left:0,right:0,top:0,bottom:0};var t=e.tileHorizontalOffset,n=e.tileVerticalOffset,i=e.tileFlip,a=e.tileVerticalRatio,o=e.tileHorizontalRatio;return{tx:t?t*(1/635)*(1/15):0,ty:n?n*(1/635)*(1/15):0,sy:a||1,sx:o||1,tileAlignment:e.tileAlignment,tileFlip:i,imageHeight:e.blip.blipAtom.imageHeight,imageWidth:e.blip.blipAtom.imageWidth}}},{key:"_init",value:function(){var e=this,t=this.fill;this.rotateAngle=0,t.hasOwnProperty("rotateWithShape")&&!t.rotateWithShape&&(this.rotateAngle=-this.rect.rotation,this.rect.horizontalFlipped&&(this.horizontalFlipped=!0),this.rect.verticalFlipped&&(this.verticalFlipped=!0));var n=1;if(t.blip&&t.blip.effects){var i=[];t.blip.effects.forEach((function(t){t.type===bi.c.AlphaModulateFixed?n="number"==typeof t.amount?t.amount:1:e.supportImageEffect(t)&&e.isLegalImageEffect(t)&&i.push(new Oa(t))})),this.imageEffects=i}this.alpha=n}},{key:"supportImageEffect",value:function(e){return e&&(e.type===bi.c.Duotone||e.type===bi.c.Luminance)}},{key:"isLegalImageEffect",value:function(e){var t=e.brightness,n=e.contrast;return e.type!==bi.c.Luminance||!(0===t&&0===n)}},{key:"render",value:function(e){var t=this.fill,n=this.preloadSource,i=t.blip&&t.blip.blipAtom&&t.blip.blipAtom.imageId;if(!n[i])return!1;var a=n[i];if(!(a.width>0&&a.height>0||a.data_url))return!1;if(this.imageEffects&&this.imageEffects.length>0){var o=Ia.get(i);if(o&&this.isEqualImageEffects(o.imageEffects)&&(o.image.width||e.isSvg))this.image=o.image;else{var r=this.makeImageEffects(a),s=r.img,l=r.canvas;this.image=e.isSvg?s:l,e.isSvg&&Ia.set(i,{image:s,imageEffects:this.imageEffects})}}else this.image=a;this.ctx=e;var c=void 0;if(t.isStretched){var u=this.transformFillData(t);c=this.createStretchTexture(u)}else{if(0===t.tileHorizontalRatio||0===t.tileVerticalRatio)return!1;var d=this.transformFillData(t);c=this.createTileTexture(d)}return e.fillStyle=c,!0}},{key:"isEqualImageEffects",value:function(e){return e&&this.imageEffects&&this.imageEffects.every((function(t,n){return t.isEqual(e[n])}))}},{key:"makeImageEffects",value:function(e){if(!this.imageEffects||0===this.imageEffects.length||!e.width||!e.height||e.src.includes("data:image/gif;"))return{img:e,canvas:e};if(e.width*e.height>3686400)return{img:e,canvas:e};var t=va(e.width,e.height).getElem(),n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);var i=n.getImageData(0,0,e.width,e.height);this.imageEffects.forEach((function(e){e.makeEffects(i.data)})),n.putImageData(i,0,0);var a=new Image;return a._logicWidth=e._logicWidth||e.width,a._logicHeight=e._logicHeight||e.height,a.data_url=a.src=t.toDataURL(),{img:a,canvas:t}}},{key:"createStretchTexture",value:function(e){var t=this.nRect,n=this.ctx,i=this.rotateAngle,a=this.shadowRangeIndex,o=this.alpha,r=this.image,s=!1;n.__defs||(s=!0);var l=t.width()+Math.abs(t.x()),c=t.height()+Math.abs(t.y()),u=s?va(l,c).getElem():new Ea(l,c),d=u.getContext("2d");n.globalAlpha=o;var h=0+e.left*u.width,p=0+e.top*u.height,f=u.width*(1-e.left-e.right),g=u.height*(1-e.top-e.bottom);(i||this.horizontalFlipped||this.verticalFlipped)&&(d.translate(l/2,c/2),this.horizontalFlipped&&d.scale(-1,1),this.rect.verticalFlipped&&d.scale(1,-1),d.rotate(i*Math.PI/180),d.translate(-l/2,-c/2)),e.left+e.right>1&&(d.translate(h+f/2,p+g/2),d.scale(-1,1),d.translate(-h-f/2,-p-g/2),h+=f,f=Math.abs(f)),e.top+e.bottom>1&&(d.translate(h+f/2,p+g/2),d.scale(1,-1),d.translate(-h-f/2,-p-g/2),p+=g,g=Math.abs(g));var v=this.getBlipAtom(),y=v?v.imageWidth:r._logicWidth||r.width,m=v?v.imageHeight:r._logicHeight||r.height;if(this.clip?d.drawImage(r,t.x(),t.y(),t.width(),t.height()):d.drawImage(r,0,0,y,m,h,p,f,g),s&&a>=0&a<=3){var _=d.getImageData(h,p,f,g);this.fillImageTransform(_.data),d.clearRect(h,p,f,g);var x=h,w=p;f<0&&(x=h+f),g<0&&(w=p+g),d.putImageData(_,x,w)}return n.createPattern(u,"no-repeat")}},{key:"createTileTexture",value:function(e){var t=this.nRect,n=this.ctx,i=this.alpha,a=this.image,o=!1;n.__defs||(o=!0);var r=this.getBlipAtom(),s=r?r.imageWidth:a._logicWidth||a.width,l=r?r.imageHeight:a._logicHeight||a.height,c=this.scale,u=s*c*e.sx,d=l*c*e.sy;if(r){var h=r.dpiX,p=r.dpiY;u*=Object.isEmpty(h)?1:96/h,d*=Object.isEmpty(p)?1:96/p}var f=new window.Rect(0,0,u,d),g=this.alignSrcPosition(f,t,e.tileAlignment),v=g.moveLeft,y=g.moveTop,m=o?va(u,d).getElem():new Ea(u,d),_=m.getContext("2d");n.globalAlpha=i,_.drawImage(a,0,0,m.width,m.height),m=this.createImageTexture(m,u,d,e);var x=n.createPattern(m,"repeat"),w=Gn.h.chromeVS<96&&Gn.h.chromeVS>70?4:1,k=new window.QMatrix;if(k.scale(w,w),this.rotateAngle){var b=new(0,window.QMatrix);b.rotate(this.rect.rotation);var T=b.mapRect(t);k.rotate(-this.rect.rotation),k.scale(this.horizontalFlipped?-1:1,this.verticalFlipped?-1:1),k.translate(T.x(),T.y())}else k.translate(e.tx*c-v+t.x(),e.ty*c-y+t.y());if(k.scale(1/w,1/w),o){if(window.DOMMatrix){var C=new DOMMatrix;C.setMatrixValue(k.toString()),x.setTransform&&x.setTransform(C)}}else x.setTransform&&x.setTransform(k.toString());return x}},{key:"alignSrcPosition",value:function(e,t,n){var i=0,a=0;if(e.size()===t.size())return{moveLeft:i,moveTop:a};switch(n){case bi.g.RectangleAlignmentTop:i=.5*(e.left()+e.right()-t.width());break;case bi.g.RectangleAlignmentTopRight:i=e.right()-t.width();break;case bi.g.RectangleAlignmentLeft:a=.5*(e.top()+e.bottom()-t.height());break;case bi.g.RectangleAlignmentCenter:i=.5*(e.left()+e.right()-t.width()),a=.5*(e.top()+e.bottom()-t.height());break;case bi.g.RectangleAlignmentRight:i=e.right()-t.width(),a=.5*(e.top()+e.bottom()-t.height());break;case bi.g.RectangleAlignmentBottomLeft:a=e.bottom()-t.height();break;case bi.g.RectangleAlignmentBottom:i=.5*(e.left()+e.right()-t.width()),a=e.bottom()-t.height();break;case bi.g.RectangleAlignmentBottomRight:i=e.right()-t.width(),a=e.bottom()-t.height()}return{moveLeft:i,moveTop:a}}},{key:"createImageTexture",value:function(e,t,n,i){var a=this.image,o=this.shadowRangeIndex,r=e;if(o>=0&&o<=3||i.tileFlip&&0!==i.tileFlip){var s=!1;e.__defs||(s=!0);var l=(r=s?va(2*t,2*n).getElem():new Ea(2*t,2*n)).getContext("2d");if(l.fillStyle=l.createPattern(e,"repeat"),s&&o>=0&&o<=3){var c=[0,0,r.width,r.height],u=c[0],d=c[1],h=c[2],p=c[3],f=l.getImageData(u,d,h,p);this.fillImageTransform(f.data),l.clearRect(u,d,h,p);var g=u,v=d;h<0&&(g=u+h),p<0&&(v=d+p),l.putImageData(f,g,v)}switch(l.fillRect(0,0,r.width,r.height),i.tileFlip){case bi.h.TileFlipVertical:l.translate(t,2*n),l.scale(1,-1),l.fillRect(-t,0,r.width,n);break;case bi.h.TileFlipHorizontal:l.translate(2*t,n),l.scale(-1,1),l.fillRect(0,-n,t,r.height);break;case bi.h.TileFlipBoth:l.drawImage(a,0,0,t,n),l.save(),l.translate(t,n/2),l.scale(-1,1),l.translate(-t,-n/2),l.drawImage(a,0,0,t,n),l.restore(),l.save(),l.translate(t/2,n),l.scale(1,-1),l.translate(-t/2,-n),l.drawImage(a,0,0,t,n),l.restore(),l.translate(t,n),l.scale(-1,-1),l.translate(-t,-n),l.drawImage(a,0,0,t,n)}}return r}},{key:"fillImageTransform",value:function(e){var t=this.shadowRange,n=this.shadowRangeIndex;if(n>=0&&n<t.length)for(var i=t[n][1],a=t[n][0],o=i-a,r=0;r<e.length;r+=4){var s=e[r+3],l=e[r],c=e[r+1],u=e[r+2],d=a*s;e[r]=(d+o*l)/256,e[r+1]=(d+o*c)/256,e[r+2]=(d+o*u)/256}}},{key:"getBlipAtom",value:function(){return this.fill.blip&&this.fill.blip.blipAtom}}]),t}(Pa),Oa=function(){function e(t){s()(this,e),this.effectMode=e.DmlModel,this._init(t)}return c()(e,[{key:"_init",value:function(e){var t=e.color1,n=e.color2,i=e.shadowLow,a=e.shadowHight,o=e.type,r=e.brightness,s=e.contrast,l=e.colorKey;if(this.type=o,t&&t.rgba){var c=t.rgba;this.duotoneColor1=c.slice(5,-1).split(",").map(Number)}if(n&&n.rgba){var u=n.rgba;this.duotoneColor2=u.slice(5,-1).split(",").map(Number)}this.shadowLow=i,this.shadowHight=a,this.colorKey=l,this.contrast=s?1+s:1,this.brightness=r||0,this.brightContrastParas=[],this.hasColorMatrix=!1,this.colorMatrix=new La,this._pTransformMatrixAndBilevel=this.transformMatrixAndBilevel,this._pTransformFunc=this.transform_cpp,this._pInToleranceFunc=this.painter_inTolerance_noAlpha}},{key:"isEqual",value:function(e){return!!(e&&e.type===this.type&&this.type===bi.c.Duotone&&this.duotoneColor1&&e.duotoneColor1&&this.duotoneColor1.toString()===e.duotoneColor1.toString()&&this.duotoneColor2&&e.duotoneColor2&&this.duotoneColor2.toString()===e.duotoneColor2.toString())}},{key:"makeEffects",value:function(e){if(e)return this.prepare(),this.transformEffects(e)}},{key:"transformEffects",value:function(e){var t=e.length;this.ignoreColorKey||this.handleColorKey(e,t),this.handleColorMap(e,t),this._pTransformMatrixAndBilevel(e,t),this.handleShadowTransform(e,t)}},{key:"transformMatrixAndBilevel",value:function(e,t){this.transformMatrixAndBilevel_vml(e,t),this.handleBrightContrastTransfrom(e,t)}},{key:"transform",value:function(e,t){this._pTransformFunc(e,t)}},{key:"prepare",value:function(){if(this.effectMode!==e.VmlModel){var t=this.brightness;(t<-1||t>1)&&(console.warn("the brightness's value is out of range!"),t=this.qBound(-1,t,1));var n=this.contrast;n<0&&(console.warn("The contrast should not be less than 0!"),n=0),0!==t||1!==n?this.updateBrightContrastParas():this.brightContrastParas[0]=this.brightContrastParas[1]=256,this.hasColorMatrix||this.updateColorMatrix()}else this.prepare_vml()}},{key:"prepare_vml",value:function(){if(this.effectMode===e.VmlModel){var t=this.colorMatrix;if((this.brightness<-1||this.brightness>1)&&(console.warn("the brightness's value is out of range!"),this.brightness=this.qBound(-1,this.brightness,1)),this.contrast<0&&(console.warn("The contrast should not be less than 0!"),this.contrast=0),this.hasColorMatrix){var n=t.constData();this.colorMatrixInt=[[],[],[],[]];for(var i=0;i<4;i++)for(var a=0;a<4;a++)this.colorMatrixInt[i][a]=this.qRound(256*n[4*i+a])}else this.updateColorMatrix_vml();this.checkBound=this.hasDuotone||this.hasColorMatrix||0!==this.brightness||1!==this.contrast}}},{key:"updateColorMatrix_vml",value:function(){var e=this.colorMatrix;e.setToIdentity();var t=e.data(),n=new La;if(this.hasDuotone&&(n=this.createDuotoneMatrix(this.duotoneColor1,this.duotoneColor2,.299,.587,.114)),0!==this.brightness||1!==this.contrast){var i=this.contrast,a=this.brightness/2,o=0;o=i<1&&a>0?.15*(i-1):.5*(i-1)-a*(i-1);var r=this.brightness-o;this.hasBilevel?(t[0]=t[1]=t[2]=.299*i,t[4]=t[5]=t[6]=.587*i,t[8]=t[9]=t[10]=.114*i,t[12]=t[13]=t[14]=r):(t[0]=t[5]=t[10]=i,t[12]=t[13]=t[14]=r,this.hasDuotone&&(e=La.multiply(e,n)))}else this.hasBilevel?(t[0]=t[1]=t[2]=.299,t[4]=t[5]=t[6]=.587,t[8]=t[9]=t[10]=.114):this.hasDuotone&&(e=n);this.updateColorMatrixInt()}},{key:"updateBrightContrastParas",value:function(){var e=this.contrast,t=this.brightness/2,n=0;n=e<1&&t>0?.15*(e-1):.5*(e-1)-t*(e-1);var i=this.brightness-n;this.brightContrastParas[0]=Math.round(256*e),this.brightContrastParas[1]=Math.round(256*i)}},{key:"updateColorMatrix",value:function(){var e=this.colorMatrix;if(e.setToIdentity(),this.hasBilevel){var t=e.data();t[0]=t[1]=t[2]=.2157,t[4]=t[5]=t[6]=.7137,t[8]=t[9]=t[10]=.0706}else this.hasDuotone&&(this.colorMatrix=this.createDuotoneMatrix(this.duotoneColor1,this.duotoneColor2,.2157,.7137,.0706));this.updateColorMatrixInt()}},{key:"updateColorMatrixInt",value:function(){var e=La.multiply(this.colorMatrix,256).data();this.colorMatrixInt=[[],[],[],[]];for(var t=this.colorMatrixInt,n=0;n<4;n++)for(var i=0;i<e.length;i++)t[n][i]=Math.round(e[n][i])}},{key:"createDuotoneMatrix",value:function(e,t,n,i,a){var o=new La(n,i,a,0,n,i,a,0,n,i,a,0,0,0,0,1),r=e[0]/255,s=e[1]/255,l=e[2]/255,c=t[0]/255,u=t[1]/255,d=t[2]/255,h=new La(c-r,0,0,r,0,u-s,0,s,0,0,d-l,l,0,0,0,1);return La.multiply(h,o)}},{key:"handleShadowTransform",value:function(e,t){}},{key:"painter_shadowTransform",value:function(e,t,n,i){}},{key:"handleColorMap",value:function(e,t){}},{key:"handleColorKey",value:function(t,n){if(t&&this.hasColorKey)if(0===this.tolerance)if(this.effectMode===e.VmlModel)for(var i=0;i<n;i++)this.colorKey===t[i]&&(t[i]=0);else for(var a=0;a<n;a++)(16777215&this.colorKey)==(16777215&t[a])&&(t[a]=0);else for(var o=0;o<n;o++)this._pInToleranceFunc(t[o],this.colorKeyLow,this.colorKeyHight)&&(t[o]=0)}},{key:"painter_inTolerance_noAlpha",value:function(e,t,n){}},{key:"painter_setbilevel",value:function(e,t){}},{key:"transformMatrixAndBilevel_vml",value:function(e,t){this.colorMatrix.isIdentity()||this.transform(e,t),this.hasBilevel&&this.painter_setbilevel(e,t,this.bilevelThreshold)}},{key:"handleBrightContrastTransfrom",value:function(e,t){if(e){var n=this.brightness,i=this.contrast,a=this.brightContrastParas;if(0!==n||1!==i)if(n<-.99)for(var o=0;o<t;o+=4)e[o+2]=e[o+1]=e[o]=0;else if(n>.99)for(var r=0;r<t;r+=4)e[r+2]=e[r+1]=e[r]=e[r+3];else for(var s=0;s<t;s+=4){var l=e[s+2]*a[0]+e[s+3]*a[1]>>8,c=e[s+1]*a[0]+e[s+3]*a[1]>>8,u=e[s]*a[0]+e[s+3]*a[1]>>8;e[s+2]=this.qBound(0,l,e[s+3]),e[s+1]=this.qBound(0,c,e[s+3]),e[s]=this.qBound(0,u,e[s+3])}}}},{key:"transform_cpp",value:function(e,t){for(var n=0;n<t;)this._transform_cpp(e,n),n+=4}},{key:"_transform_cpp",value:function(e,t){var n=e,i=void 0,a=void 0,o=void 0,r=this.colorMatrixInt;if(this.hasColorMatrix||this.hasDuotone)i=n[t+2]*r[0][0]+n[t+1]*r[1][0]+n[t+0]*r[2][0]+n[t+3]*r[3][0]>>8,a=n[t+2]*r[0][1]+n[t+1]*r[1][1]+n[t+0]*r[2][1]+n[t+3]*r[3][1]>>8,o=n[t+2]*r[0][2]+n[t+1]*r[1][2]+n[t+0]*r[2][2]+n[t+3]*r[3][2]>>8;else{if(this.hasBilevel)return i=n[t+2]*r[0][0]+n[t+1]*r[1][0]+n[t+0]*r[2][0]+n[t+3]*r[3][0]>>8,void(n[t+2]=n[t+1]=n[t+0]=this.qBound(0,i,n[t+3]));i=n[t+2]*r[0][0]+n[t+3]*r[3][0]>>8,a=n[t+1]*r[1][1]+n[t+3]*r[3][1]>>8,o=n[t+0]*r[2][2]+n[t+3]*r[3][2]>>8}n[t+2]=this.qBound(0,o,n[t+3]),n[t+1]=this.qBound(0,a,n[t+3]),n[t+0]=this.qBound(0,i,n[t+3])}},{key:"qBound",value:function(e,t,n){return Math.max(e,Math.min(t,n))}},{key:"hasDuotone",get:function(){return this.type===bi.c.Duotone}}]),e}();Oa.DmlModel=0,Oa.VmlModel=1;var Ma=function(){function e(t){s()(this,e),this.pts=[];for(var n=0,i=t.length;n<i;n++)for(var a=t[n],o=0,r=a.length;o<r;o++)this.pts.push(a[o].x(),a[o].y());var l=this.pts,c=l.slice(l.length-2);l[0]===c[0]&&l[1]===c[1]||this.pts.push(l[0],l[1])}return c()(e,[{key:"boundsRect",value:function(){if(!this.bounds){for(var e=this.pts,t=[e[0],e[1],e[0],e[1]],n=t[0],i=t[1],a=t[2],o=t[3],r=0;r<e.length;r+=2){var s=e[r],l=e[r+1];s<n&&(n=s),s>a&&(a=s),l<i&&(i=l),l>o&&(o=l)}this.bounds={l:n,t:i,r:a,b:o}}return this.bounds}},{key:"center",value:function(){var e=this.boundsRect();return{x:.5*(e.r+e.l),y:.5*(e.b+e.t)}}},{key:"toPath2D",value:function(){var e=this.pts,t=new Path2D;t.moveTo(e[0],e[1]);for(var n=2;n<this.pts.length;n+=2)t.lineTo(e[n],e[n+1]);return t.closePath(),t}}]),e}();function Da(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),e.deleteShader(i),null)}function Na(e){return Math.abs(e)<.001}var Ba=function(){function e(){s()(this,e),this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}return c()(e,[{key:"scale",value:function(e,t,n,i){this.m11=e,this.m12=0,this.m21=0,this.m22=t,this.dx=n-e*n,this.dy=i-t*i}},{key:"map",value:function(e,t){return[this.m11*e+this.dx,this.m22*t+this.dy]}}]),e}(),ja=function(){function e(t,n,i,a){s()(this,e),this.path=t,this.focus=n,this.focusScale=i,this.gradientStops=a}return c()(e,[{key:"generateOutput",value:function(){var e=function(e){var t=Math.round(e.l),n=Math.round(e.r),i=Math.round(e.t);return{x:t,y:i,w:n-t,h:Math.round(e.b)-i}}(this.path.boundsRect()),t=ga.b(e.w+2,e.h+2,ga.a.WEBGL,"geomerty"),n=t.getElem();return n.width=e.w+2,n.height=e.h+2,{image:n,bounds:e,gl:this.drawGradient(n,e,t)}}},{key:"drawGradient",value:function(e,t,n){var i=n.getContext();if(!Object.isEmpty(i)){i.viewport(0,0,e.width,e.height);var a=this.prepareProgram(i),o=this.prepareVertices(i,a);this.prepareGradient(i);var r=this.prepareMatrix(t);return this.draw(i,r,a,o),i}console.error("Unable to initialize WebGL. Your browser or machine may not support it.")}},{key:"prepareProgram",value:function(e){var t=function(e,t,n){var i=Da(e,e.VERTEX_SHADER,t),a=Da(e,e.FRAGMENT_SHADER,n),o=e.createProgram();return e.attachShader(o,i),e.attachShader(o,a),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)?o:(console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(o)),null)}(e,"\n            attribute vec4 aVertexPosition;\n            attribute float aVertexGradient;\n\n            uniform mat4 uModelViewMatrix;\n\n            varying lowp float vGradient;\n            \n            void main() {\n              gl_Position =  uModelViewMatrix * aVertexPosition;\n              vGradient = aVertexGradient;\n            }\n        ","\n            precision mediump float;\n            \n            varying lowp float vGradient;\n            \n            uniform sampler2D uGradientSampler;\n            \n            // const float a = -0.9041;\n            // const float b = 1.914;\n            // const float c = -0.003862;\n            //\n            // float interpolate(float v) {\n            //   return clamp(a*v*v + b*v + c, 0.0, 1.0);\n            // }\n            \n            void main() {\n              // float grad = interpolate(vGradient);\n              // gl_FragColor = vec4(grad, grad, grad, 1.0);\n              gl_FragColor = texture2D(uGradientSampler, vec2(vGradient, 0.5));\n            }\n        ");return{program:t,attribLocations:{vertexPosition:e.getAttribLocation(t,"aVertexPosition"),vertexGradient:e.getAttribLocation(t,"aVertexGradient")},uniformLocations:{modelViewMatrix:e.getUniformLocation(t,"uModelViewMatrix"),gradientSampler:e.getUniformLocation(t,"uGradientSampler")}}}},{key:"prepareVertices",value:function(e,t){for(var n=this.path.pts,i=this.path.boundsRect(),a=i.l+(i.r-i.l)*this.focus.x,o=i.t+(i.b-i.t)*this.focus.y,r=this.isFocusScaled()?0:1,s=[a,o,0],l=0;l<n.length;l+=2)s.push(n[l],n[l+1],r);var c=s.length/3,u=[{mode:e.TRIANGLE_FAN,first:0,count:c}];if(this.isFocusScaled()){var d=new Ba;d.scale(this.focusScale.width,this.focusScale.height,a,o);for(var h=0;h<n.length;h+=2){var p=n[h],f=n[h+1];s.push(p,f,1),s.push.apply(s,q()(d.map(p,f)).concat([0]))}u.push({mode:e.TRIANGLE_STRIP,first:c,count:s.length/3-c})}return this.setupVertexBuffer(e,s,t),u}},{key:"prepareGradient",value:function(e){var t,n,i,a=(t=512,n=1,(i=document.createElement("canvas")).width=t,i.height=n,i),o=a.getContext("2d"),r=o.createLinearGradient(0,0,a.width,0);this.gradientStops.forEach((function(e){r.addColorStop(e.pos,e.color)})),o.fillStyle=r,o.fillRect(0,0,a.width,a.height);var s=e.createTexture();return e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.activeTexture(e.TEXTURE0),s}},{key:"prepareMatrix",value:function(e){var t=-1/e.w,n=1/e.h,i=new Float32Array(16);return i[0]=-2*t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*n,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=(e.x+e.x+e.w)*t,i[13]=(e.y+e.y+e.h)*n,i[14]=0,i[15]=1,i}},{key:"setupVertexBuffer",value:function(e,t,n){var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.vertexAttribPointer(n.attribLocations.vertexPosition,2,e.FLOAT,!1,12,0),e.enableVertexAttribArray(n.attribLocations.vertexPosition),e.vertexAttribPointer(n.attribLocations.vertexGradient,1,e.FLOAT,!1,12,8),e.enableVertexAttribArray(n.attribLocations.vertexGradient)}},{key:"isFocusScaled",value:function(){return this.focusScale&&(!Na(this.focusScale.width)||!Na(this.focusScale.height))}},{key:"draw",value:function(e,t,n,i){e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(n.program),e.uniformMatrix4fv(n.uniformLocations.modelViewMatrix,!1,t),i.forEach((function(t){e.drawArrays(t.mode,t.first,t.count)}))}}]),e}();var Fa=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return p()(t,e),c()(t,[{key:"calNewRectBoundFromTileRect",value:function(e,t){if(!t||!e||!e.isQRect)return console.log("gradFill calNewRectBoundFromTileRect error!!",e,t),e;var n=e.width(),i=e.height(),a=e.topLeft(),o=e.bottomRight(),r=a.x()+n*t.left,s=a.y()+i*t.top,l=o.x()+n*-t.right,c=o.y()+i*-t.bottom,u=Math.abs(l-r),d=Math.abs(c-s);return u=u<1?1:u,d=d<1?1:d,new window.Rect(r,s,u,d)}},{key:"getIntersectPoint_m",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.isQRect)return console.log("gradFill getIntersectPoint_m error!!",e),e;n&&(t=180*(t=Math.atan(e.width()/e.height()*Math.tan(t*Math.PI/180)))/Math.PI);var i=Math.tan(t*Math.PI/180),a=e.topLeft().y()-i*e.topLeft().x(),o=-Math.tan((90-t)*Math.PI/180),r=e.bottomRight().y()-o*e.bottomRight().x(),s=(r-a)/(i-o),l=i*s+a;return new window.Point(s,l)}},{key:"getPointTransform",value:function(e,t,n,i){var a=t.center();if(n&&!i){var o=Math.abs(a.x()-e.x()),r=this.getFlipTransform(e.x(),a.x(),o);return new window.Point(r,e.y())}if(n&&i){var s=Math.abs(a.x()-e.x()),l=Math.abs(a.y()-e.y()),c=this.getFlipTransform(e.x(),a.x(),s),u=this.getFlipTransform(e.y(),a.y(),l);return new window.Point(c,u)}if(!n&&i){var d=Math.abs(a.y()-e.y()),h=this.getFlipTransform(e.y(),a.y(),d);return new window.Point(e.x(),h)}return e}},{key:"getFlipTransform",value:function(e,t,n){return e<t?t+n:t-n}},{key:"calcFocusInfo",value:function(e,t){var n=new window.Rect(t.left,t.top,Math.max(0,1-t.right-t.left),Math.max(0,1-t.bottom-t.top)),i=n.width(),a=n.height(),o=i,r=a,s=n.topLeft(),l=isNaN(1-i)?s.x()+.5*i:s.x()/(1-i),c=e.topLeft(),u=isNaN(1-a)?c.y()+.5*a:s.y()/(1-a),d=c.x()+l*e.width(),h=c.y()+u*e.height();return{focusCenter:new window.Point(d,h),scaleX:o,scaleY:r}}},{key:"convertColorStops",value:function(e){if(e instanceof Array||console.error("Wrong colorStops!"),!(e.length<2)){if(e.sort((function(e,t){var n=e.pos,i=t.pos;return n>i?1:n<i?-1:0})),Object(H.j)(e[0].pos)&&this.gradientStopEqual(e[0],e[1]))for(var t=1;t<e.length;t++)this.gradientStopEqual(e[t],e[0])&&e.shift();var n=e.length;if(1!==n){!Object(H.j)(e[n-1].pos,1)&&this.gradientStopEqual(e[n-1],e[n-2])&&(e[n-1].pos=1);for(var i=0;i<e.length;i++)for(var a=e[i],o=i+1;o<e.length;o++){var r=e[o];this.gradientStopEqual(a,r)&&e.splice(o,1)}this.headtailGradientManage(e),this.headmiddletailGradientManage(e)}}}},{key:"calcHeadtailGrandientColor",value:function(e,t,n){var i=-.9041*n*n+1.914*n-.003862,a=1-n,o=1-(-.9041*a*a+1.914*a-.003862);e=e.toString(),t=t.toString();var r=e.length,s=e.slice(5,r-1).split(","),l=Number(s[0],10)||0,c=Number(s[1],10)||0,u=Number(s[2],10)||0,d=Number(s[3],10)||0;d=Math.ceil(255*d)||0;var h=t.length,p=t.slice(5,h-1).split(","),f=Number(p[0],10)||0,g=Number(p[1],10)||0,v=Number(p[2],10)||0,y=Number(p[3],10)||0;y=Math.ceil(255*y);for(var m=[l,c,u],_=[f,g,v],x=0;x<3;++x){var w=m[x],k=_[x]-m[x],b=k>0?i:o;_[x]=Math.max(0,Math.min(w+k*b,255))||0}return"rgba("+Math.round(_[0])+","+Math.round(_[1])+","+Math.round(_[2])+","+Math.round(d+(y-d)*n)/255+")"}},{key:"headtailGradientManage",value:function(e){if(2===e.length&&0===e[0].pos&&1===e[e.length-1].pos){var t=e.shift(),n=e.pop();e.length=0,e.push(t),e.push({pos:.25,color:this.calcHeadtailGrandientColor(t.color,n.color,.25)}),e.push({pos:.5,color:this.calcHeadtailGrandientColor(t.color,n.color,.5)}),e.push({pos:.75,color:this.calcHeadtailGrandientColor(t.color,n.color,.75)}),e.push(n)}}},{key:"headmiddletailGradientManage",value:function(e){if(3===e.length&&0===e[0].pos&&1===e[e.length-1].pos&&e[0].color.toString()===e[e.length-1].color.toString()){var t=e[0],n=e[1],i=e[e.length-1],a=1-n.pos;e.length=0,e.push(t),e.push({pos:.334*n.pos,color:this.calcHeadtailGrandientColor(t.color,n.color,.334)}),e.push({pos:.667*n.pos,color:this.calcHeadtailGrandientColor(t.color,n.color,.667)}),e.push(n),e.push({pos:n.pos+.334*a,color:this.calcHeadtailGrandientColor(n.color,t.color,.334)}),e.push({pos:n.pos+.667*a,color:this.calcHeadtailGrandientColor(n.color,t.color,.667)}),e.push(i)}}},{key:"transformFillData",value:function(e,t){var n=this,i=e.stops;return e.linearAngle&&(e.linearAngle/=6e4),e.stops=i&&i.map((function(e){var i=e.color.hex,a=e.color.alpha,o=e.position;(!i||7!==i.length&&"#"!==i[0])&&console.error("fill Error Color！！！"+i);var r=parseInt(i.slice(1,3),16),s=parseInt(i.slice(3,5),16),l=parseInt(i.slice(5,7),16),c=a||0;return{color:i=n.fillShadowTransform([[r,s,l,c]],t)||"#000000",pos:o,alpha:a}})),e.cache=!0,e}},{key:"getAngle",value:function(e){return e<=90?e:e<=180?180-e:e<=270?e-180:360-e}},{key:"needConvertToPathGradient",value:function(e,t,n,i,a){var o=Math.abs(n.x-i.x),r=Math.abs(n.y-i.y),s=Math.sqrt(o*o+r*r);return 0!==e||0!==t||s>a}},{key:"normalizeAngle",value:function(e){var t=Math.round(e)%360;return t<0&&(t+=360),t}},{key:"gradientStopEqual",value:function(e,t){return Object(H.k)(e.pos-t.pos)}}]),t}(Pa);var Ha=function e(t,n,i,a,o){s()(this,e),this.shapeType=t,this.bDmlCircle=n,this.bDmlRectangle=i,this.bVmlCircle=a,this.bVmlRectangle=o},Ga={Line:new Ha("Line",!1,!1,!1,!1),LineInv:new Ha("LineInv",!1,!1,!1,!1),Triangle:new Ha("Triangle",!1,!1,!1,!1),RtTriangle:new Ha("RtTriangle",!1,!1,!1,!1),Rect:new Ha("Rect",!1,!1,!1,!1),Diamond:new Ha("Diamond",!1,!1,!1,!1),Parallelogram:new Ha("Parallelogram",!1,!1,!1,!1),Trapezoid:new Ha("Trapezoid",!1,!1,!1,!1),NonIsoscelesTrapezoid:new Ha("NonIsoscelesTrapezoid",!1,!1,!1,!1),Pentagon:new Ha("Pentagon",!1,!1,!1,!1),Hexagon:new Ha("Hexagon",!1,!1,!1,!1),Heptagon:new Ha("Heptagon",!1,!1,!1,!1),Octagon:new Ha("Octagon",!1,!1,!1,!1),Decagon:new Ha("Decagon",!1,!1,!1,!1),Dodecagon:new Ha("Dodecagon",!1,!1,!1,!1),Star4:new Ha("Star4",!1,!1,!1,!1),Star5:new Ha("Star5",!1,!1,!1,!1),Star6:new Ha("Star6",!1,!1,!1,!1),Star7:new Ha("Star7",!1,!1,!1,!1),Star8:new Ha("Star8",!1,!1,!1,!1),Star10:new Ha("Star10",!1,!1,!1,!1),Star12:new Ha("Star12",!1,!1,!1,!1),Star16:new Ha("Star16",!1,!1,!1,!1),Star24:new Ha("Star24",!1,!1,!1,!1),Star32:new Ha("Star32",!1,!1,!1,!1),RoundRect:new Ha("RoundRect",!1,!1,!1,!1),Round1Rect:new Ha("Round1Rect",!1,!1,!1,!1),Round2SameRect:new Ha("Round2SameRect",!1,!1,!1,!1),Round2DiagRect:new Ha("Round2DiagRect",!1,!1,!1,!1),SnipRoundRect:new Ha("SnipRoundRect",!1,!1,!1,!1),Snip1Rect:new Ha("Snip1Rect",!1,!1,!1,!1),Snip2SameRect:new Ha("Snip2SameRect",!1,!1,!1,!1),Snip2DiagRect:new Ha("Snip2DiagRect",!1,!1,!1,!1),Plaque:new Ha("Plaque",!1,!1,!1,!1),Ellipse:new Ha("Ellipse",!1,!1,!1,!1),Teardrop:new Ha("Teardrop",!1,!1,!1,!1),HomePlate:new Ha("HomePlate",!1,!1,!1,!1),Chevron:new Ha("Chevron",!0,!1,!1,!0),PieWedge:new Ha("PieWedge",!1,!1,!1,!1),Pie:new Ha("Pie",!1,!1,!1,!1),BlockArc:new Ha("BlockArc",!0,!1,!1,!0),Donut:new Ha("Donut",!0,!1,!1,!0),NoSmoking:new Ha("NoSmoking",!0,!1,!1,!0),RightArrow:new Ha("RightArrow",!0,!1,!1,!0),LeftArrow:new Ha("LeftArrow",!0,!1,!1,!0),UpArrow:new Ha("UpArrow",!0,!1,!1,!0),DownArrow:new Ha("DownArrow",!0,!1,!1,!0),StripedRightArrow:new Ha("StripedRightArrow",!0,!1,!1,!0),NotchedRightArrow:new Ha("NotchedRightArrow",!0,!1,!1,!0),BentUpArrow:new Ha("BentUpArrow",!0,!1,!1,!0),LeftRightArrow:new Ha("LeftRightArrow",!0,!1,!1,!0),UpDownArrow:new Ha("UpDownArrow",!0,!1,!1,!0),LeftUpArrow:new Ha("LeftUpArrow",!0,!1,!1,!0),LeftRightUpArrow:new Ha("LeftRightUpArrow",!0,!1,!1,!0),QuadArrow:new Ha("QuadArrow",!0,!1,!1,!0),LeftArrowCallout:new Ha("LeftArrowCallout",!0,!1,!1,!0),RightArrowCallout:new Ha("RightArrowCallout",!0,!1,!1,!0),UpArrowCallout:new Ha("UpArrowCallout",!0,!1,!1,!0),DownArrowCallout:new Ha("DownArrowCallout",!0,!1,!1,!0),LeftRightArrowCallout:new Ha("LeftRightArrowCallout",!0,!1,!1,!0),UpDownArrowCallout:new Ha("UpDownArrowCallout",!0,!1,!1,!0),QuadArrowCallout:new Ha("QuadArrowCallout",!0,!1,!1,!0),BentArrow:new Ha("BentArrow",!0,!1,!1,!0),UTurnArrow:new Ha("UTurnArrow",!0,!1,!1,!0),CircularArrow:new Ha("CircularArrow",!0,!1,!1,!0),LeftCircularArrow:new Ha("LeftCircularArrow",!1,!1,!1,!1),LeftRightCircularArrow:new Ha("LeftRightCircularArrow",!1,!1,!1,!1),CurvedRightArrow:new Ha("CurvedRightArrow",!0,!1,!1,!0),CurvedLeftArrow:new Ha("CurvedLeftArrow",!0,!1,!1,!0),CurvedUpArrow:new Ha("CurvedUpArrow",!0,!1,!1,!0),CurvedDownArrow:new Ha("CurvedDownArrow",!0,!1,!1,!0),SwooshArrow:new Ha("SwooshArrow",!1,!1,!1,!0),Cube:new Ha("Cube",!1,!0,!1,!0),Can:new Ha("Can",!1,!1,!1,!1),LightningBolt:new Ha("LightningBolt",!0,!1,!1,!0),Heart:new Ha("Heart",!1,!1,!1,!1),Sun:new Ha("Sun",!0,!1,!1,!0),Moon:new Ha("Moon",!0,!1,!1,!0),SmileyFace:new Ha("SmileyFace",!0,!1,!0,!1),IrregularSeal1:new Ha("IrregularSeal1",!1,!1,!1,!1),IrregularSeal2:new Ha("IrregularSeal2",!1,!1,!1,!1),FoldedCorner:new Ha("FoldedCorner",!1,!1,!1,!1),Bevel:new Ha("Bevel",!1,!0,!1,!0),Frame:new Ha("Frame",!1,!1,!1,!1),HalfFrame:new Ha("HalfFrame",!1,!1,!1,!1),Corner:new Ha("Corner",!1,!1,!1,!1),DiagStripe:new Ha("DiagStripe",!1,!1,!1,!1),Chord:new Ha("Chord",!1,!1,!1,!1),Arc:new Ha("Arc",!1,!1,!1,!1),LeftBracket:new Ha("LeftBracket",!1,!1,!1,!1),RightBracket:new Ha("RightBracket",!1,!1,!1,!1),LeftBrace:new Ha("LeftBrace",!0,!1,!1,!0),RightBrace:new Ha("RightBrace",!0,!1,!1,!0),BracketPair:new Ha("BracketPair",!1,!1,!1,!1),BracePair:new Ha("BracePair",!0,!1,!1,!0),StraightConnector1:new Ha("StraightConnector1",!1,!1,!1,!1),BentConnector2:new Ha("BentConnector2",!1,!1,!1,!1),BentConnector3:new Ha("BentConnector3",!1,!1,!1,!1),BentConnector4:new Ha("BentConnector4",!1,!1,!1,!1),BentConnector5:new Ha("BentConnector5",!1,!1,!1,!1),CurvedConnector2:new Ha("CurvedConnector2",!1,!1,!1,!1),CurvedConnector3:new Ha("CurvedConnector3",!1,!1,!1,!1),CurvedConnector4:new Ha("CurvedConnector4",!1,!1,!1,!1),CurvedConnector5:new Ha("CurvedConnector5",!1,!1,!1,!1),Callout1:new Ha("Callout1",!1,!1,!1,!1),Callout2:new Ha("Callout2",!1,!1,!1,!1),Callout3:new Ha("Callout3",!1,!1,!1,!1),AccentCallout1:new Ha("AccentCallout1",!1,!1,!1,!1),AccentCallout2:new Ha("AccentCallout2",!1,!1,!1,!1),AccentCallout3:new Ha("AccentCallout3",!1,!1,!1,!1),BorderCallout1:new Ha("BorderCallout1",!1,!1,!1,!1),BorderCallout2:new Ha("BorderCallout2",!1,!1,!1,!1),BorderCallout3:new Ha("BorderCallout3",!1,!1,!1,!1),AccentBorderCallout1:new Ha("AccentBorderCallout1",!1,!1,!1,!1),AccentBorderCallout2:new Ha("AccentBorderCallout2",!1,!1,!1,!1),AccentBorderCallout3:new Ha("AccentBorderCallout3",!1,!1,!1,!1),WedgeRectCallout:new Ha("WedgeRectCallout",!0,!1,!1,!0),WedgeRoundRectCallout:new Ha("WedgeRoundRectCallout",!0,!1,!1,!0),WedgeEllipseCallout:new Ha("WedgeEllipseCallout",!0,!1,!1,!0),CloudCallout:new Ha("CloudCallout",!0,!1,!1,!0),Cloud:new Ha("Cloud",!1,!1,!1,!1),Ribbon:new Ha("Ribbon",!0,!1,!1,!0),Ribbon2:new Ha("Ribbon2",!0,!1,!1,!0),EllipseRibbon:new Ha("EllipseRibbon",!0,!1,!1,!0),EllipseRibbon2:new Ha("EllipseRibbon2",!0,!1,!1,!0),LeftRightRibbon:new Ha("LeftRightRibbon",!1,!1,!1,!1),VerticalScroll:new Ha("VerticalScroll",!0,!1,!1,!0),HorizontalScroll:new Ha("HorizontalScroll",!0,!1,!1,!0),Wave:new Ha("Wave",!0,!1,!1,!0),DoubleWave:new Ha("DoubleWave",!0,!1,!1,!0),Plus:new Ha("Plus",!1,!1,!1,!1),FlowChartProcess:new Ha("FlowChartProcess",!1,!1,!1,!1),FlowChartDecision:new Ha("FlowChartDecision",!1,!1,!1,!1),FlowChartInputOutput:new Ha("FlowChartInputOutput",!1,!1,!1,!1),FlowChartPredefinedProcess:new Ha("FlowChartPredefinedProcess",!1,!1,!1,!1),FlowChartInternalStorage:new Ha("FlowChartInternalStorage",!1,!1,!1,!1),FlowChartDocument:new Ha("FlowChartDocument",!0,!1,!1,!0),FlowChartMultidocument:new Ha("FlowChartMultidocument",!0,!1,!1,!0),FlowChartTerminator:new Ha("FlowChartTerminator",!1,!1,!1,!1),FlowChartPreparation:new Ha("FlowChartPreparation",!1,!1,!1,!1),FlowChartManualInput:new Ha("FlowChartManualInput",!1,!1,!1,!1),FlowChartManualOperation:new Ha("FlowChartManualOperation",!1,!1,!1,!1),FlowChartConnector:new Ha("FlowChartConnector",!1,!1,!1,!1),FlowChartPunchedCard:new Ha("FlowChartPunchedCard",!1,!1,!1,!1),FlowChartPunchedTape:new Ha("FlowChartPunchedTape",!0,!1,!1,!0),FlowChartSummingJunction:new Ha("FlowChartSummingJunction",!1,!1,!1,!1),FlowChartOr:new Ha("FlowChartOr",!1,!1,!1,!1),FlowChartCollate:new Ha("FlowChartCollate",!1,!1,!1,!1),FlowChartSort:new Ha("FlowChartSort",!1,!1,!1,!1),FlowChartExtract:new Ha("FlowChartExtract",!1,!1,!1,!1),FlowChartMerge:new Ha("FlowChartMerge",!1,!1,!1,!1),FlowChartOfflineStorage:new Ha("FlowChartOfflineStorage",!1,!1,!1,!1),FlowChartOnlineStorage:new Ha("FlowChartOnlineStorage",!1,!1,!1,!1),FlowChartMagneticTape:new Ha("FlowChartMagneticTape",!1,!1,!1,!0),FlowChartMagneticDisk:new Ha("FlowChartMagneticDisk",!0,!1,!1,!1),FlowChartMagneticDrum:new Ha("FlowChartMagneticDrum",!1,!1,!1,!0),FlowChartDisplay:new Ha("FlowChartDisplay",!0,!1,!1,!0),FlowChartDelay:new Ha("FlowChartDelay",!1,!1,!1,!1),FlowChartAlternateProcess:new Ha("FlowChartAlternateProcess",!1,!1,!1,!1),FlowChartOffpageConnector:new Ha("FlowChartOffpageConnector",!1,!1,!1,!1),ActionButtonBlank:new Ha("ActionButtonBlank",!1,!1,!1,!1),ActionButtonHome:new Ha("ActionButtonHome",!1,!0,!1,!0),ActionButtonHelp:new Ha("ActionButtonHelp",!1,!0,!1,!0),ActionButtonInformation:new Ha("ActionButtonInformation",!1,!0,!1,!0),ActionButtonForwardNext:new Ha("ActionButtonForwardNext",!1,!0,!1,!0),ActionButtonBackPrevious:new Ha("ActionButtonBackPrevious",!1,!0,!1,!0),ActionButtonEnd:new Ha("ActionButtonEnd",!1,!0,!1,!0),ActionButtonBeginning:new Ha("ActionButtonBeginning",!1,!0,!1,!0),ActionButtonReturn:new Ha("ActionButtonReturn",!1,!0,!1,!0),ActionButtonDocument:new Ha("ActionButtonDocument",!1,!0,!1,!0),ActionButtonSound:new Ha("ActionButtonSound",!1,!0,!1,!0),ActionButtonMovie:new Ha("ActionButtonMovie",!1,!0,!1,!0),Gear6:new Ha("Gear6",!1,!1,!1,!1),Gear9:new Ha("Gear9",!1,!1,!1,!1),Funnel:new Ha("Funnel",!1,!1,!1,!1),MathPlus:new Ha("MathPlus",!1,!1,!1,!1),MathMinus:new Ha("MathMinus",!1,!1,!1,!1),MathMultiply:new Ha("MathMultiply",!1,!1,!1,!1),MathDivide:new Ha("MathDivide",!0,!1,!1,!0),MathEqual:new Ha("MathEqual",!1,!1,!1,!1),MathNotEqual:new Ha("MathNotEqual",!0,!1,!1,!0),CornerTabs:new Ha("CornerTabs",!1,!1,!1,!1),SquareTabs:new Ha("SquareTabs",!1,!1,!1,!1),PlaqueTabs:new Ha("PlaqueTabs",!1,!1,!1,!1),ChartX:new Ha("ChartX",!1,!1,!1,!1),ChartStar:new Ha("ChartStar",!1,!1,!1,!1),ChartPlus:new Ha("ChartPlus",!1,!1,!1,!1)},Ua=function(e){function t(e){var n=e.rect,i=e.fill,a=e.shadowRangeIndex,o=e.path,r=e.shapeType;e.isAngleScalable;s()(this,t);var l=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return l.rect=n,l.fill=l.transformFillData(Object(Ui.c)(i),l.shadowRangeIndex),l.path=o,l.shadowRangeIndex=a,l.shapeType=r,l}return p()(t,e),c()(t,[{key:"render",value:function(e){if(!this.fill.stops)return!1;var t=this.rect,n=this.fill;this.ctx=e;var i=t.width,a=t.height,o=t.x,r=t.y,s=window.Rect,l=new s(0,0,i,a),c=void 0,u=void 0;e.isSvg?c=(u=new Ea(l.width()+3,l.height()+3)).canvas:u=(c=va(l.width()+3,l.height()+3).getElem()).getContext("2d");n.focusRectangle=n.focusRectangle||{left:.5,right:.5,top:.5,bottom:.5},this.convertColorStops(n.stops);var d=t.rotation||0,h=n.rotateWithShape?0:-d,p=new window.QMatrix;p.translate(t.width/2,t.height/2),p.rotate(h),p.translate(-t.width/2,-t.height/2);var f=p.mapRect(new s(o,r,i,a));l=new s(-f.x(),-f.y(),f.width(),f.height());var g=this._renderGradient(l);return!!g&&(n.hasOwnProperty("rotateWithShape")&&!n.rotateWithShape?(c.width=Math.ceil(f.width())||1,c.height=Math.ceil(f.height())||1,u.fillStyle=g,u.fillRect(0,0,2*c.width,2*c.height),e.fillGradinet=c):e.fillStyle=g,!0)}},{key:"_renderGradient",value:function(e){var t=this.fill,n=this.path,i=t.shadeType,a=n.painterPath||n.path,o=void 0,r=void 0,s=void 0,l=window.QPainterPath;switch(i){case bi.d.LinearShade:s=this.createLinearGradient(e,!1);break;case bi.d.CircleShade:s=this.createRadialGradient(e);break;case bi.d.ShapeShade:var c=function(e){if(!e)return new Ha("default",!0,!1,!1,!1);var t=e.slice(0,1).toLocaleUpperCase()+e.slice(1);return Ga[t]}(this.shapeType);c.bDmlCircle?s=this.createRadialGradient(e):c.bDmlRectangle?((o=new l).addRect(e),r=o.toSubpathPolygons()||[],s=this.createShapeGradient(e,r)):(r=a&&a.toSubpathPolygons()||[],s=this.createShapeGradient(e,r));break;case bi.d.RectangleShade:(o=new l).addRect(e),r=o.toSubpathPolygons()||[],s=this.createShapeGradient(e,r);break;default:s=this.createLinearGradient(e,!1)}return s}},{key:"createLinearGradient",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.fill,i=n.stops,a=n.tileRectangle,o=this.fill.linearAngle?this.fill.linearAngle:0,r=this.ctx;a&&(e=this.calNewRectBoundFromTileRect(e,a));var s=this.normalizeAngle(o),l=Math.floor(s/90),c=void 0;if((l<0||l>3)&&console.error("Angle Error!"),s%90==0){var u=[e.topLeft(),e.topRight(),e.bottomRight(),e.bottomLeft()];c=r.createLinearGradient(u[l].x(),u[l].y(),u[(l+1)%4].x(),u[(l+1)%4].y())}else{var d=this.getAngle(s),h=this.getIntersectPoint_m(e,d,t),p=1===l||2===l,f=2===l||3===l,g=this.getPointTransform(e.topLeft(),e,p,f),v=this.getPointTransform(h,e,p,f);c=r.createLinearGradient(g.x(),g.y(),v.x(),v.y())}return i.forEach((function(e){var t=e.color,n=e.pos;c.addColorStop(n,t)})),c}},{key:"createRadialGradient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.fill,i=n.tileRectangle,a=n.stops,o=n.focusRectangle,r=this.ctx,s=i,l=o;o=o||{left:.5,right:.5,top:.5,bottom:.5};var c=e;s&&(c=this.calNewRectBoundFromTileRect(e,s));var u=this.calcFocusInfo(e,l),d=u.focusCenter,h=u.scaleX,p=u.scaleY,f=c.center(),g=c.width(),v=c.height(),y=Math.sqrt(g*g+v*v)/2,m=h,_=void 0;if(this.needConvertToPathGradient(h,p,d,f,y)){var x=new window.QPainterPath;x.ellipse(f.x()*(1+h),f.y()*(1+p),y*(1+h),y*(1+p));var w=x.toSubpathPolygons();_=this.createShapeGradient(e,w)}else{if(t){var k=(d.x()-f.x())*Math.cos(t*Math.PI/180)-(d.y()-f.y())*Math.sin(t*Math.PI/180)+f.x(),b=(d.x()-f.x())*Math.sin(t*Math.PI/180)+(d.y()-f.y())*Math.cos(t*Math.PI/180)+f.y();d=new window.Point(k,b)}_=r.createRadialGradient(d.x(),d.y(),m,f.x(),f.y(),y),a.forEach((function(e){var t=e.color,n=e.pos;t=t||"#000000",_.addColorStop(n,t.toString())}))}return _}},{key:"createShapeGradient",value:function(e,t){var n=this.fill,i=(n.tileRectangle,n.stops),a=n.focusRectangle,o=this.ctx,r=function(e,t,n,i){var a=new Ma(n),o=e.left,r=e.right,s=e.bottom,l=e.top;return new ja(a,{x:o+0*r,y:l+0*s},{width:0,height:0},i).generateOutput()}(a,0,t,i),s=document.createElement("canvas");return s.width=e.width()+3,s.height=e.height()+3,s.getContext("2d").drawImage(r.image,r.bounds.x,r.bounds.y,r.image.width+2,r.image.height+2),r.image&&r.image._canvasPoolItem.release(),o.createPattern(s,"no-repeat")}}]),t}(Fa),Wa=window.imageEffectsPool=window.imageEffectsPool||new Aa.a(50),Ya=function(e){function t(e){var n=e.rect,i=e.fill,a=e.shadowRangeIndex;s()(this,t);var o=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i=i||{};var r=n.width,l=n.height;return o.nRect=new window.Rect(0,0,r,l),o.frontColor=i.color&&i.color.rgba||"rgba(91,155,213,1)",o.backgroundColor=i.backgroundColor&&i.backgroundColor.rgba||"rgba(255,255,255,1)",o.patternType=i.pattern||55,o.shadowRangeIndex=a,o._init(),o}return p()(t,e),c()(t,[{key:"_init",value:function(){this.transformFillData()}},{key:"transformFillData",value:function(){var e=this.shadowRangeIndex,t=this.shadowRange;if(e>=0&&e<t.length){var n=this.frontColor.slice(5,this.frontColor.length-1).split(",").map(Number);this.frontColor=this.fillShadowTransform([n],e);var i=this.backgroundColor.slice(5,this.backgroundColor.length-1).split(",").map(Number);this.backgroundColor=this.fillShadowTransform([i],e)}}},{key:"render",value:function(e){var t=this.createImageData(),n=e.createPattern(t,"repeat");return e.fillStyle=n,!0}},{key:"createImageData",value:function(){var e=this.frontColor,t=this.backgroundColor,n=this.patternType;(!n||n<0||n>=za.length)&&(n=55,console.warn("Unkonwn PatternType "+n)),t||(t="red",console.warn("Unkonwn backgroundColor. use red"));var i=n+e+t,a=va(8,8).getElem();a.width=8,a.height=8;var o=a.getContext("2d");Wa.get(i);for(var r=za[n].slice(0),s=o.createImageData(8,8),l=s.data,c="",u=r.length-4;u>=0;u-=4){var d=r[u].toString(2);if(d.length<8)d=Array.apply(null,Array(8-d.length)).map((function(){return 0})).toString().replace(/,/g,"")+d;c+=d}for(var h=(e=e.toString()).slice(5,e.length-1).split(",").map(Number),p=(t=t.toString()).slice(5,t.length-1).split(",").map(Number),f=0;f<l.length;f+=4){"0"===c[Math.floor(f/4)]?(l[f]=h[0],l[f+1]=h[1],l[f+2]=h[2],l[f+3]=255*h[3]):(l[f]=p[0],l[f+1]=p[1],l[f+2]=p[2],l[f+3]=255*p[3])}return o.putImageData(s,0,0),a}}]),t}(Pa),za=[[255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0],[254,0,0,0,253,0,0,0,251,0,0,0,247,0,0,0,239,0,0,0,223,0,0,0,191,0,0,0,127,0,0,0],[127,0,0,0,191,0,0,0,223,0,0,0,239,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0],[126,0,0,0,189,0,0,0,219,0,0,0,231,0,0,0,231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,127,0,0,0],[255,0,0,0,247,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,127,0,0,0],[255,0,0,0,221,0,0,0,255,0,0,0,119,0,0,0,255,0,0,0,221,0,0,0,255,0,0,0,119,0,0,0],[221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0],[238,0,0,0,85,0,0,0,187,0,0,0,85,0,0,0,238,0,0,0,85,0,0,0,187,0,0,0,85,0,0,0],[234,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,174,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[170,0,0,0,68,0,0,0,170,0,0,0,17,0,0,0,170,0,0,0,68,0,0,0,170,0,0,0,17,0,0,0],[34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0],[0,0,0,0,34,0,0,0,0,0,0,0,136,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,136,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,16,0,0,0],[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0,238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0],[119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0,119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0],[102,0,0,0,204,0,0,0,153,0,0,0,51,0,0,0,102,0,0,0,204,0,0,0,153,0,0,0,51,0,0,0],[102,0,0,0,51,0,0,0,153,0,0,0,204,0,0,0,102,0,0,0,51,0,0,0,153,0,0,0,204,0,0,0],[124,0,0,0,248,0,0,0,241,0,0,0,227,0,0,0,199,0,0,0,143,0,0,0,31,0,0,0,62,0,0,0],[62,0,0,0,31,0,0,0,143,0,0,0,199,0,0,0,227,0,0,0,241,0,0,0,248,0,0,0,124,0,0,0],[119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0],[170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0],[255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0],[51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0],[255,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0],[255,0,0,0,255,0,0,0,238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0,255,0,0,0,255,0,0,0],[255,0,0,0,255,0,0,0,119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0,255,0,0,0,255,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,240,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,15,0,0,0],[247,0,0,0,247,0,0,0,247,0,0,0,247,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0],[251,0,0,0,223,0,0,0,254,0,0,0,239,0,0,0,253,0,0,0,191,0,0,0,247,0,0,0,127,0,0,0],[114,0,0,0,243,0,0,0,63,0,0,0,39,0,0,0,228,0,0,0,252,0,0,0,207,0,0,0,78,0,0,0],[231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0,231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0],[63,0,0,0,218,0,0,0,231,0,0,0,255,0,0,0,63,0,0,0,218,0,0,0,231,0,0,0,255,0,0,0],[126,0,0,0,189,0,0,0,219,0,0,0,231,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[247,0,0,0,247,0,0,0,247,0,0,0,0,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0],[174,0,0,0,221,0,0,0,235,0,0,0,119,0,0,0,186,0,0,0,221,0,0,0,171,0,0,0,119,0,0,0],[15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[127,0,0,0,254,0,0,0,127,0,0,0,255,0,0,0,239,0,0,0,247,0,0,0,239,0,0,0,255,0,0,0],[255,0,0,0,127,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,85,0,0,0],[255,0,0,0,221,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,221,0,0,0,255,0,0,0,127,0,0,0],[254,0,0,0,254,0,0,0,253,0,0,0,243,0,0,0,207,0,0,0,183,0,0,0,123,0,0,0,252,0,0,0],[102,0,0,0,0,0,0,0,153,0,0,0,0,0,0,0,102,0,0,0,0,0,0,0,153,0,0,0,0,0,0,0],[7,0,0,0,7,0,0,0,103,0,0,0,136,0,0,0,112,0,0,0,112,0,0,0,118,0,0,0,136,0,0,0],[119,0,0,0,119,0,0,0,119,0,0,0,0,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,0,0,0,0],[102,0,0,0,153,0,0,0,153,0,0,0,102,0,0,0,102,0,0,0,153,0,0,0,153,0,0,0,102,0,0,0],[240,0,0,0,240,0,0,0,240,0,0,0,240,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0],[254,0,0,0,125,0,0,0,187,0,0,0,215,0,0,0,239,0,0,0,215,0,0,0,187,0,0,0,125,0,0,0],[255,0,0,0,239,0,0,0,199,0,0,0,131,0,0,0,1,0,0,0,131,0,0,0,199,0,0,0,239,0,0,0],[254,0,0,0,253,0,0,0,251,0,0,0,247,0,0,0,239,0,0,0,223,0,0,0,191,0,0,0,127,0,0,0],[127,0,0,0,191,0,0,0,223,0,0,0,239,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0]],Xa=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.ctx=t.ctx,this.fill=t.fill,this.path=t.pa||t.path,this.layout=t.layout||{},this.preloadSource=t.preloadSource||{},this.parentLayout=t.parentLayout||{},this.matrix=t.matrix}return c()(e,[{key:"render",value:function(e){var t=e||this.ctx,n=this.fill,i=this.path||this.pa,a=this.layout,o=this.matrix;if(!n)return!1;var r=i.attributes,s=i.pathCache,l={};n.rect?l=n.rect:a.drawRect&&(l=Object($n.a)(a.drawRect),a.fillOff||(l.x=0,l.y=0));var c=new window.Rect(l.x,l.y,l.width,l.height);if(a.paths&&(c=a.paths.srcBoundRect),n.originRect=c,n.matrix=o,r.hasOwnProperty("fill"))if(r.hasOwnProperty("fill")&&r.fill>bi.f.Normal){var u=r.fill-bi.f.Lighten;if(this.fillStyleSwitch(t,l,u,s))return!0}else r.hasOwnProperty("fill")&&(r.fill,bi.f.None);else if(this.fillStyleSwitch(t,l,-1,s))return!0;return!1}},{key:"fillStyleSwitch",value:function(e,t,n,i){var a=this.fill,o=this.preloadSource,r=this.layout,s=void 0;switch(a.type){case bi.e.FillTypeNone:return!1;case bi.e.FillTypeGradient:s=new Ua({rect:t,fill:a,shadowRangeIndex:n,path:this.path,shapeType:r.shapeType});break;case bi.e.FillTypePattern:s=new Ya({rect:t,fill:a,shadowRangeIndex:n});break;case bi.e.FillTypeBlip:s=new Ra({rect:t,fill:a,shadowRangeIndex:n,preloadSource:o,scale:r.scale});break;case bi.e.FillTypeSolidColor:s=new Pa;var l=a.color&&a.color.rgba||"rgba(255,255,255,1)";s.setFillColorRgba(l),s.setShadowRangeIndex(n);break;case bi.e.FillTypeBackground:(s=new Pa).setShadowRangeIndex(n)}return!!s&&s.render(e)}}]),e}(),Va=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.ctx=t.ctx,this.outline=t.outline,this.path=t.path,this.layout=t.layout,this.scale=t.scale}return c()(e,[{key:"render",value:function(e){var t=e||this.ctx,n=this.outline,i=this.path,a=this.layout,o=this.scale,r=n.fill||{},s={path:i.outLinePath,attributes:{}},l=n.width?window.Ti2Px(window.Emu2Ti(n.width),o):1;l=l<1?1:Math.round(l);var c=a.shapeRealyRect,u={drawRect:{width:c.width(),height:c.height(),x:-a.scale*a.offX,y:-a.scale*a.offY,fillOff:!0},offX:a.offX,offY:a.offY,scale:a.scale,fillOff:!0},d=r.shadeType;if(r.type===bi.e.FillTypeGradient&&d===bi.d.RectangleShade){var h=c.width()+l/2,p=c.height()+l/2;u.drawRect.width=h,u.drawRect.height=p}new Xa({fill:r,path:s,layout:u}).render(t);var f=qa(n,o);t.strokeStyle=t.fillStyle,t.lineWidth=l;var g=f.dashCapStyle;!function(e,t){switch(t){case ei.LineCapFlat:e.lineCap="butt";break;case ei.LineCapRound:e.lineCap="round";break;case ei.LineCapSquare:e.lineCap="square";break;default:e.lineJoin="butt"}}(t,g),t.miterLimit=f.miterLimit,function(e,t){switch(t){case ci.LineJoinTypeMiter:e.lineJoin="miter";break;case ci.LineJoinTypeBevel:e.lineJoin="bevel";break;case ci.LineJoinTypeRound:e.lineJoin="round";break;default:e.lineJoin="miter"}}(t,f.joinStyle);var v=this.prepareDasher(f).map((function(e){return e*t.lineWidth}));return t.setLineDash(v),!0}},{key:"prepareDasher",value:function(e){var t=Ka(e.dashType);if(e.dashType===ui&&e.dashPattern&&(t=[].concat(q()(e.dashPattern))),e.dashCapStyle===ei.LineCapRound||e.dashCapStyle===ei.LineTriangleCap)for(var n=t.length,i=0;i!==n;)1&i?t[i]+=.99:t[i]-=.99,++i;return t}},{key:"measureOutLine",value:function(e,t,n,i,a){var o=e||this.path,r=t||this.outline,s=n||this.scale;return this.useComplexStroker(o,r,s,i,a)?this.complexStrokePath(o,r,s,a):this.simpleStrokePath(o)}},{key:"useComplexStroker",value:function(e,t,n,i,a){if(i)return!0;var o=qa(t,n);return 0!==o.compoundArray.length&&o.width>=2||(!(!o.startAnchor.isValid()&&!o.endAnchor.isValid())||(!!a||o.width>450))}},{key:"complexStrokePath",value:function(e,t,n,i){var a=e.attributes,o=qa(t,n),r=a.isClosePath||!1;if(r&&o.capStyle===ei.LineCapSquare&&(o.capStyle=ei.LineCapFlat,o.startCapStyle=ei.LineCapFlat,o.endCapStyle=ei.LineCapFlat,o.dashCapStyle=ei.LineCapFlat,o.startAnchor=new ea,o.endAnchor=new ea),!i||a.hasOwnProperty("stroke")&&!a.stroke||a.fill===bi.f.None||(o.alignment=li),!(e=e.painterPath)||e.elementCount()<2)return console.log(e+" is to Short cannot draw!"),{};e.isClosed=r;var s=new la;return s.createStrokerFromPen(o),s.createStroke(e,1/4)}},{key:"simpleStrokePath",value:function(e){return e.painterPath}}]),e}();function qa(e,t){var n=e.width?window.Ti2Px(window.Emu2Ti(e.width),t):1;n=Math.round(n);var i=e.miterLimit||8,a=void 0!==e.joinType?e.joinType:ci.LineJoinTypeRound;if(e.joinType===ci.LineJoinTypeMiter){i*=.432432}var o=function(e){var t=[];switch(e){case ti:break;case oi:t.push.apply(t,[0,.1666666716337204,.3333333432674408,.6666666865348816,.8333333134651184,1]);break;case ni:t.push.apply(t,[0,.3333333432674408,.6666666865348816,1]);break;case ii:t.push.apply(t,[0,.6000000238418579,.800000011920929,1]);break;case ai:t.push.apply(t,[0,.20000000298023224,.4000000059604645,1])}return t}(e.compoundLine),r=void 0!==e.endingCap?e.endingCap:ei.LineCapSquare,s=void 0!==e.endingCap?e.endingCap:ei.LineCapSquare,l=void 0!==e.endingCap?e.endingCap:ei.LineCapSquare,c=void 0!==e.endingCap?e.endingCap:ei.LineCapSquare,u=Ka(e.dashType);u||(u=e.dashPattern),0!==u.length&&r===ei.LineCapSquare&&(r=ei.LineCapFlat,s=ei.LineCapFlat,l=ei.LineCapFlat,c=ei.LineCapFlat);var d=void 0===e.alignment?e.alignment:ri,h=Qa(e.headEnd,n,t),p=Qa(e.tailEnd,n,t);return h.isValid()&&(s=ei.LineCapFlat),p.isValid()&&(l=ei.LineCapFlat),{width:n,miterLimit:i,compoundArray:o,joinStyle:a,capStyle:r,startCapStyle:s,endCapStyle:l,dashCapStyle:c,scale:t,dashPattern:u,alignment:d,startAnchor:h,endAnchor:p,dashType:e.dashType}}function Ka(e){var t=[[],[1,3],[4,3],[8,3],[4,3,1,3],[8,3,1,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];return e<ui?t[e]:t[0]}function Qa(e,t,n){if(!e)return new ea;var i=function(e){var t=[new window.Point(-.5,-1),new window.Point(0,-1),new window.Point(.5,-1),new window.Point(0,0),new window.Point(-.5,-1)],n=[new window.Point(-.5,-1),new window.Point(0,-.5),new window.Point(.5,-1),new window.Point(0,0),new window.Point(-.5,-1)],i=[new window.Point(-.5,0),new window.Point(0,-.5),new window.Point(.5,0),new window.Point(0,.5),new window.Point(-.5,0)],a=[new window.Point(-.5,-1),new window.Point(0,0),new window.Point(.5,-1)];if(e){var o=new window.QPainterPath;switch(e){case di:break;case hi:o=Ja(t);break;case pi:o=Ja(n);break;case fi:o=Ja(i);break;case gi:o=function(e,t,n,i){var a=new window.QPainterPath;return a.ellipse(e,t,n/2,i/2),a}(0,0,1,1);break;case vi:o=Ja(a)}return o}}(e.type);if(!i||!i.isQPainterPath||i.isEmpty())return new ea;var a=e.type,o=Object.isEmpty(e.width)?mi:e.width,r=Object.isEmpty(e.length)?xi:e.length,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[2,3,4.5],i=[2,3,5];return e===vi?n[t]:i[t]}(a,r),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[2.5,3.5,5],i=[2,3,5];return e===vi?n[t]:i[t]}(a,o),c=l,u=s,d=40*n,h=t>1?t:1;if(h<d){var p=h/d;c/=p,u/=p}var f=new ea;a===vi?(i=new window.QMatrix(c,0,0,u,0,0).Map(i),f=new ea(i,ea.AnchorPathUsage.PathStroke,ei.LineCapRound)):(i=new window.QMatrix(1,0,0,u/c,0,0).Map(i),(f=new ea(i,ea.AnchorPathUsage.PathFill,ei.LineCapRound)).setWidthScale(c),a===hi?s>=l?o===_i&&r===wi?f.setBaseInset(.125*s):f.setBaseInset(.25*s):f.setBaseInset(.125*s):a===pi&&(o===yi?f.setBaseInset(.25*s):o===mi?f.setBaseInset(.125*s):f.setBaseInset(.075*s)));return f.isValid()&&(f.setStrokeStartCap(ei.LineCapRound),f.setStrokeEndCap(ei.LineCapRound)),f}function Ja(e){var t=new window.QPainterPath;t.moveTo(e[0]);for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n]);return t}var Za=0,$a=1,eo=2,to=3,no=4,io=5,ao=6,oo=7,ro=8,so=0,lo=1,co=2,uo=3,ho=4,po=5,fo=6,go=7,vo=8,yo=9,mo=10,_o=11,xo=12,wo=13,ko=14,bo=15,To=16,Co=17,So=18,Eo=19,Po=function(){function e(){s()(this,e),this.m_dist=0,this.m_dir=0,this.m_sx=1,this.m_sy=1,this.m_kx=0,this.m_ky=0,this.m_alignment=oo}return c()(e,[{key:"setEffectPathList",value:function(e){this.effectPathList=e}},{key:"getEffectPathList",value:function(){return this.effectPathList}},{key:"calcTransform",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0,r=0;switch(this.m_alignment){case Za:break;case $a:o=.5;break;case eo:o=1;break;case to:r=.5;break;case no:o=r=.5;break;case io:o=1,r=.5;break;case ao:r=1;break;case oo:o=.5,r=1;break;case ro:o=r=1}var s=e(this.m_dist),l=t.width()*o+i,c=t.height()*r+a,u=s*Math.cos(Lo(this.m_dir)),d=s*Math.sin(Lo(this.m_dir)),h=Math.tan(Lo(this.m_kx));Ao(this.m_sx)||(h/=this.m_sx);var p=Math.tan(Lo(this.m_ky));Ao(this.m_sy)||(p/=this.m_sy);var f=l+u,g=c+d,v=-l,y=-c;if(f+=v*this.m_sx+y*h*this.m_sx,g+=y*this.m_sy+v*p*this.m_sy,!n){var m=new window.QMatrix(this.m_sx,p*this.m_sy,h*this.m_sx,this.m_sy,f,g),_=m.mapRect(t),x=this.getEffectPathList();return x instanceof Array&&0!==x.length&&(_=this.calcTransfromPath(x,m)),_}n.transform(this.m_sx,p*this.m_sy,h*this.m_sx,this.m_sy,f,g)}},{key:"calcTransfromPath",value:function(e,t){for(var n={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},i=0,a=e.length;i<a;i++){var o=e[i];if(o){for(var r=new window.Point,s={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},l=0,c=o.length;l<c;l++){var u=o[l];switch(u.type){case G.d.MoveTo:case G.d.LineTo:r=t.map_point(new window.Point(u.x,u.y)),this.updateBoundsFromPt(s,r);break;case G.d.ArcTo:console.error(u+" can ArcTo FIXME");break;case G.d.Close:}}s.l<n.l&&(n.l=s.l),s.r>n.r&&(n.r=s.r),s.t<n.t&&(n.t=s.t),s.b>n.b&&(n.b=s.b)}}return n.width=n.r-n.l,n.height=n.b-n.t,new window.Rect(n.l,n.t,n.width,n.height)}},{key:"updateBoundsFromPt",value:function(e,t){e.l>t.x()&&(e.l=t.x()),e.r<t.x()&&(e.r=t.x()),e.t>t.y()&&(e.t=t.y()),e.b<t.y()&&(e.b=t.y()),e.width=e.r-e.l,e.height=e.b-e.t}},{key:"calcAabb",value:function(){}}]),e}();function Lo(e){return e*Math.PI/180}function Ao(e){return Math.abs(e)<=1e-12}var Io=function(){function e(t,n){s()(this,e),this._init(),this.imageData=t,this.width=t.width,this.height=t.height,this.radius=n}return c()(e,[{key:"_init",value:function(){this.defaults={radius:1,mul_table:[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table:[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]}}},{key:"render",value:function(){var e=this.radius||this.defaults.radius,t=this.width||this.defaults.width,n=this.height||this.defaults.height,i=this.imageData;if(isNaN(e)||e<1)return this.imageData;e|=0;var a=i.data,o=void 0,r=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,g=void 0,v=void 0,y=void 0,m=void 0,_=void 0,x=void 0,w=void 0,k=void 0,b=void 0,T=void 0,C=void 0,S=void 0,E=void 0,P=void 0,L=e+e+1,A=t-1,I=n-1,R=e+1,O=R*(R+1)/2,M=this.BlurStack(),D=M,N=void 0;for(s=1;s<L;s++)D=D.next=this.BlurStack(),s===R&&(N=D);D.next=M;var B=null,j=null;d=u=0;var F=this.defaults.mul_table[e],H=this.defaults.shg_table[e];for(r=0;r<n;r++){for(x=w=k=b=h=p=f=g=0,v=R*(T=a[u]),y=R*(C=a[u+1]),m=R*(S=a[u+2]),_=R*(E=a[u+3]),h+=O*T,p+=O*C,f+=O*S,g+=O*E,D=M,s=0;s<R;s++)D.r=T,D.g=C,D.b=S,D.a=E,D=D.next;for(s=1;s<R;s++)l=u+((A<s?A:s)<<2),h+=(D.r=T=a[l])*(P=R-s),p+=(D.g=C=a[l+1])*P,f+=(D.b=S=a[l+2])*P,g+=(D.a=E=a[l+3])*P,x+=T,w+=C,k+=S,b+=E,D=D.next;for(B=M,j=N,o=0;o<t;o++)a[u+3]=E=g*F>>H,0!==E?(E=255/E,a[u]=(h*F>>H)*E,a[u+1]=(p*F>>H)*E,a[u+2]=(f*F>>H)*E):a[u]=a[u+1]=a[u+2]=0,h-=v,p-=y,f-=m,g-=_,v-=B.r,y-=B.g,m-=B.b,_-=B.a,l=d+((l=o+e+1)<A?l:A)<<2,h+=x+=B.r=a[l],p+=w+=B.g=a[l+1],f+=k+=B.b=a[l+2],g+=b+=B.a=a[l+3],B=B.next,v+=T=j.r,y+=C=j.g,m+=S=j.b,_+=E=j.a,x-=T,w-=C,k-=S,b-=E,j=j.next,u+=4;d+=t}for(o=0;o<t;o++){for(w=k=b=x=p=f=g=h=0,v=R*(T=a[u=o<<2]),y=R*(C=a[u+1]),m=R*(S=a[u+2]),_=R*(E=a[u+3]),h+=O*T,p+=O*C,f+=O*S,g+=O*E,D=M,s=0;s<R;s++)D.r=T,D.g=C,D.b=S,D.a=E,D=D.next;for(c=t,s=1;s<=e;s++)u=c+o<<2,h+=(D.r=T=a[u])*(P=R-s),p+=(D.g=C=a[u+1])*P,f+=(D.b=S=a[u+2])*P,g+=(D.a=E=a[u+3])*P,x+=T,w+=C,k+=S,b+=E,D=D.next,s<I&&(c+=t);for(u=o,B=M,j=N,r=0;r<n;r++)a[(l=u<<2)+3]=E=g*F>>H,E>0?(E=255/E,a[l]=(h*F>>H)*E,a[l+1]=(p*F>>H)*E,a[l+2]=(f*F>>H)*E):a[l]=a[l+1]=a[l+2]=0,h-=v,p-=y,f-=m,g-=_,v-=B.r,y-=B.g,m-=B.b,_-=B.a,l=o+((l=r+R)<I?l:I)*t<<2,h+=x+=B.r=a[l],p+=w+=B.g=a[l+1],f+=k+=B.b=a[l+2],g+=b+=B.a=a[l+3],B=B.next,v+=T=j.r,y+=C=j.g,m+=S=j.b,_+=E=j.a,x-=T,w-=C,k-=S,b-=E,j=j.next,u+=t}return i}},{key:"BlurStack",value:function(){return{r:0,g:0,b:0,a:0,next:null}}}]),e}(),Ro=n(654),Oo=new function e(){s()(this,e),this.isFrontendMode="frontend"===localStorage.getItem("mode"),this.debug_Axis_Linewidth="true"===Object(Ro.default)("showAxis")?1:0,this.isLogOn="false"!==Object(Ro.default)("showLog")};Oo.isLogOn||(console.log=function(){});var Mo=Oo,Do=function(){function e(t,n,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];s()(this,e),this.ltd=a,this._init(t),this.transform=this.createEffectTransform(),this.lineWidth=0,this.pathList=i,this.boundRect=n,this.horizontalFlipped=o,this.verticalFlipped=r,this.shadowRect=new window.Rect(n.x(),n.y(),n.width(),n.height()),this.offX=n.x(),this.offY=n.y()}return c()(e,[{key:"_init",value:function(e){this.shadow=e,e.type===bi.c.PresetShadow?this._initPresetShadow(e):this._initOuterShadow(e)}},{key:"_initPresetShadow",value:function(e){this.blurRadius=0,this.distance=window.Emu2Ti(e.distance)||0,this.skewX=0,this.skewY=0,this.scaleY=1,this.scaleX=1,this.direction=e.direction*(1/6e4)||0,this.color=e.color,this.rotateWithShape=!1,this._initPresetType(e)}},{key:"_initOuterShadow",value:function(e){this.blurRadius=window.Emu2Ti(e.blurRadius)*this.ltd*.5||0,this.distance=window.Emu2Ti(e.distance)||0,this.skewX=e.skewX*(1/6e4)||0,this.skewY=e.skewY*(1/6e4)||0,this.scaleY=void 0!==e.scaleY?e.scaleY:1,this.scaleX=void 0!==e.scaleX?e.scaleX:1,this.direction=e.direction*(1/6e4)||0,this.alignment=e.alignment,this.color=e.color,this.rotateWithShape=void 0===e.rotateWithShape||e.rotateWithShape}},{key:"createEffectTransform",value:function(){var e=new Po;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e.m_sx=this.getScaleX(),e.m_sy=this.getScaleY(),e.m_kx=this.getSkewX(),e.m_ky=this.getSkewY(),e.m_alignment=this.getAlignment(),e}},{key:"measure",value:function(){var e=this;this.transform.setEffectPathList(this.pathList);var t=this.transform.calcTransform((function(t){return t*e.ltd}),this.shadowRect,null,this.offX,this.offY),n=1.5*this.blurRadius;if(this.blurRadius<=10&&this.blurRadius>3?n*=2:this.blurRadius<=3&&(n*=5),t=t.adjust(-n,-n,n,n),this._hasOuterShadow2()){this._setupShadow2();var i=this.transform.calcTransform((function(t){return t*e.ltd}),this.shadowRect,null,this.offX,this.offY);i=i.adjust(-n,-n,n,n);var a=t.left()<i.left()?t.left():i.left(),o=t.right()>i.right()?t.right():i.right(),r=t.top()<i.top()?t.top():i.top(),s=t.bottom()>i.bottom()?t.bottom():i.bottom();t=new window.Rect(a,r,o-a,s-r)}return this.destShadowBoundRect=new window.Rect(t.x(),t.y(),t.width(),t.height()),t}},{key:"render",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=va(t,n),r=o.getElem();this.measure();var s=r.getContext("2d");return Mo.debug_Axis_Linewidth>0&&s.strokeRect(0,0,r.width,r.height),this._renderShadow(s,e,t,n,i,a),this._hasOuterShadow2()&&(this._setupShadow2(),this._renderShadow(s,e,t,n,i,a)),r}},{key:"_renderShadow",value:function(e,t,n,i,a,o){var r=this;e.save(),e.shadowColor=this.color.rgba,e.shadowBlur=this.blurRadius,e.shadowOffsetX=2*n+2*this.blurRadius,e.shadowOffsetY=2*i+2*this.blurRadius,e.translate(-e.shadowOffsetX,-e.shadowOffsetY);var s=this.destShadowBoundRect.x()-this.boundRect.x(),l=this.destShadowBoundRect.y()-this.boundRect.y();s=s<0?-s:0,l=l<0?-l:0,this.transform.calcTransform((function(e){return e*r.ltd}),this.shadowRect,e,s,l),e.drawImage(t,0,0),e.restore()}},{key:"getColor",value:function(){return this.color}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"setDistance",value:function(e){this.distance=e}},{key:"getDirection",value:function(){return this.direction}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"getSkewX",value:function(){return this.skewX}},{key:"getSkewY",value:function(){return this.skewY}},{key:"getAlignment",value:function(){return this.alignment}},{key:"rotateWithShape",value:function(){return this.rotateWithShape}},{key:"_initPresetType",value:function(e){switch(e.presetType){case so:case lo:this.alignment=bi.g.RectangleAlignmentCenter;break;case co:this.alignment=bi.g.RectangleAlignmentBottom,this.skewY=40.89,this.scaleY=.5;break;case uo:this.alignment=bi.g.RectangleAlignmentBottom,this.skewY=-40.89,this.scaleY=.5;break;case ho:case po:this.alignment=bi.g.RectangleAlignmentCenter;break;case fo:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=-.5;break;case go:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=-.5;break;case vo:this.alignment=bi.g.RectangleAlignmentTopLeft,this.scaleX=.75,this.scaleY=.75;break;case yo:this.alignment=bi.g.RectangleAlignmentBottomRight,this.scaleX=1.25,this.scaleY=1.25;break;case mo:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=.5;break;case _o:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=.5;break;case xo:this.alignment=bi.g.RectangleAlignmentBottom;break;case wo:this.alignment=bi.g.RectangleAlignmentCenter;break;case ko:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=-.5;break;case bo:this.alignment=bi.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=-.5;break;case To:case Co:this.alignment=bi.g.RectangleAlignmentBottom;break;case So:this.alignment=bi.g.RectangleAlignmentBottom,this.scaleY=.5;break;case Eo:this.alignment=bi.g.RectangleAlignmentBottom,this.scaleY=-1}}},{key:"_hasOuterShadow2",value:function(){return xo===this.shadow.presetType||To===this.shadow.presetType||Co===this.shadow.presetType}},{key:"_setupShadow2",value:function(){switch(this._calcShadow2Color(this.color),this.shadow.presetType){case xo:this.distance*=2;break;case To:case Co:this.direction=(this.direction+180)%360;break;default:return}}},{key:"_calcShadow2Color",value:function(){var e=this.color.rgba;if(e&&!(e.indexOf("rgba")<0)){var t=Number(e.slice(5,-1).split(",")[0]),n=Number(e.slice(5,-1).split(",")[1]),i=Number(e.slice(5,-1).split(",")[2]),a=Number(e.slice(5,-1).split(",")[3]);t=t+102<255?t+102:255,n=n+102<255?n+102:255,i=i+102<255?i+102:255,this.color.rgba="rgba("+t+", "+n+", "+i+", "+a+")"}}}]),e}(),No=function(){function e(t,n,i,a,o){s()(this,e),this._init(t,a),this.transform=this.createEffectTransform(),this.paths=n,this.boundRect=i,this.ltd=a,this.fill=o.fill,this.layout=o.layout,this.preloadSource=o.preloadSource,this.parentLayout=o.parentLayout,this.picture=o.picture}return c()(e,[{key:"_init",value:function(e,t){this.blurRadius=window.Emu2Ti(e.blurRadius)*t*this.blurScale(t)||0,this.distance=window.Emu2Ti(e.distance)*this.distanceScale(t)||0,this.direction=e.direction*(1/6e4)||0,this.color=e.color||"rgab(0,0,0,0.2)"}},{key:"distanceScale",value:function(e){return e<.03?1.1789:1}},{key:"blurScale",value:function(e){return e<.03?1.4:1}},{key:"createEffectTransform",value:function(){var e=new Po;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e}},{key:"render",value:function(e){var t=this,n=this.boundRect.x(),i=this.boundRect.y(),a=va(this.boundRect.width(),this.boundRect.height()).getElem(),o=this.transform.calcTransform((function(e){return e*t.ltd}),this.boundRect,null),r=a.getContext("2d"),s=va(a.width,a.height).getElem(),l=s.getContext("2d");if(l.fillStyle=this.color.rgba||"rgba(0,0,0,0.5)",this.ltd<.03){var c=this.color.rgba.split(",");if("0)"!==c[3]){var u=isNaN(Number(c[3].split(")")[0]))?.5:Number(c[3].split(")")[0]);l.fillStyle=c[0]+","+c[1]+","+c[2]+","+(u+.2)+")"}}var d=1;this.picture?(this.picture.blip&&this.picture.blip.effects&&this.picture.blip.effects.forEach((function(e){e.type===bi.c.AlphaModulateFixed&&(d="number"==typeof e.amount?e.amount:1)})),this.paths.resetMatrix.mapContext(r),this.paths.resetMatrix.mapContext(l),r.save(),r.globalAlpha=d,r.drawImage(e,this.boundRect.x(),this.boundRect.y()),r.restore(),l.shadowColor=l.fillStyle,l.drawImage(e,this.boundRect.x(),this.boundRect.y()),l.globalCompositeOperation="source-in",l.save(),l.globalAlpha=d,l.fillRect(this.boundRect.x(),this.boundRect.y(),s.width,s.height),l.restore(),l.globalCompositeOperation="source-over"):(this.fill&&(this.fill.type===bi.e.FillTypeBlip?this.fill&&this.fill.blip&&this.fill.blip.effects&&this.fill.blip.effects.forEach((function(e){e.type===bi.c.AlphaModulateFixed&&(d="number"==typeof e.amount?e.amount:1)})):this.fill.color&&(d=this.fill.color.alpha)),l.save(),l.globalAlpha=d,this.paths.forEach((function(e){t.fill&&t.fill.type&&(new Xa({fill:t.fill,path:e,layout:t.layout,preloadSource:t.preloadSource,parentLayout:t.parentLayout}).render(r)&&(r.beginPath(),e.painterPath.toContextPath(r),r.fill(),l.beginPath(),e.painterPath.toContextPath(l),l.fill()))})),l.restore());var h=this.createInnerShadowImage(a,s,-o.x()+n,-o.y()+i);return s._canvasPoolItem.release(),this.picture&&this.paths.matrix.mapContext(r),h}},{key:"createInnerShadowImage",value:function(e,t,n,i){n=Math.round(n),i=Math.round(i);var a=va(this.boundRect.width(),this.boundRect.height()).getElem(),o=a.getContext("2d");o.drawImage(t,0,0),o.translate(n,i),o.globalCompositeOperation="destination-out";var r=va(e.width,e.height),s=r.getElem();if(s.getContext("2d").drawImage(e,0,0),this.blurRadius>0){var l=this.createShadowBlur(s,t);o.drawImage(l,-this.blurRadius,-this.blurRadius),l._canvasPoolItem.release()}else o.drawImage(s,0,0);return r.release(),a}},{key:"createShadowBlur",value:function(e){var t=va(this.boundRect.width()+2*this.blurRadius,this.boundRect.height()+2*this.blurRadius).getElem(),n=t.getContext("2d");n.translate(this.blurRadius,this.blurRadius),n.drawImage(e,0,0),e._canvasPoolItem.release();var i=n.getImageData(0,0,t.width,t.height),a=new Io(i,this.blurRadius).render();return n.putImageData(a,0,0),t}},{key:"_innerShadowBlend",value:function(e,t,n){for(var i=e.getContext("2d"),a=i.getImageData(0,0,e.width,e.height),o=e.width,r=e.height,s=i.createImageData(e.width,e.height),l=va(o,r).getElem(),c=l.getContext("2d"),u=0;u<s.data.length;u+=4){var d=4*(Math.floor(Math.floor(u/4)/o)+t)*o+4*(Math.floor(u/4)%o+n),h=a.data[u],p=a.data[u+1],f=a.data[u+2],g=a.data[u+3];h&p&f&g&&(h=a.data[d],p=a.data[d+1],f=a.data[d+2],g=a.data[d+3]),s.data[u]=h,s.data[u+1]=p,s.data[u+2]=f,s.data[u+3]=g}return c.putImageData(s,0,0),l}},{key:"getColor",value:function(){return this.color}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"getDirection",value:function(){return this.direction}},{key:"setDistance",value:function(e){this.distance=e}}]),e}(),Bo=function(){function e(t,n,i,a){s()(this,e),this.color=t.color||"#000000",this.radius=window.Emu2Ti(t.radius)*i,this.scale=i,this.boundRect=n,this.lineWidth=a}return c()(e,[{key:"measure",value:function(){var e=.843*this.radius+this.lineWidth-this.lineWidth,t=this.boundRect.adjusted(-e,-e,e,e);return this.destBoundRect=new window.Rect(t.x(),t.y(),t.width(),t.height()),t}},{key:"render",value:function(e,t,n,i,a,o){var r=.843*this.radius+this.lineWidth;this.measure();var s=va(o.width(),o.height()).getElem(),l=s.getContext("2d");l.lineWidth=r,l.shadowBlur=r-this.lineWidth,l.shadowColor=this.color.rgba,l.shadowOffsetX=o.width()+Math.abs(o.x()),l.shadowOffsetY=o.height()+Math.abs(o.y()),l.translate(-l.shadowOffsetX,-l.shadowOffsetY),l.translate(-o.x(),-o.y()),a.mapContext(l);for(var c=0;c<e.length;c++){var u=e[c].attributes,d=u.fill;n&&n.fill&&n.fill.type&&(!u.hasOwnProperty("stroke")||u.stroke)&&((n.headEnd||n.tailEnd)&&e[c].strokerPath?(e[c].strokerPath.toContextPath(l),l.lineWidth=r/2,l.stroke()):e[c].painterPath&&(l.lineWidth=r/2,l.shadowBlur=r/2,e[c].painterPath.toContextPath(l),l.stroke())),(t&&t.type&&d!==G.e.None||i)&&e[c].painterPath&&(e[c].painterPath.toContextPath(l),l.stroke())}return s}}]),e}(),jo=function(){function e(t,n,i,a){s()(this,e),this.ltd=i,this._init(t),this.transform=this.createEffectTransform(),this.boundRect=n,this.reflectionRect=a||n}return c()(e,[{key:"_init",value:function(e){this.blurRadius=window.Emu2Ti(e.blurRadius)*this.ltd*.85||0,this.distance=window.Emu2Ti(e.distance)*this.ltd||0,this.skewX=e.skewX*(1/6e4)||0,this.skewY=e.skewY*(1/6e4)||0,this.scaleY=void 0!==e.scaleY?e.scaleY:1,this.scaleX=void 0!==e.scaleX?e.scaleX:1,this.direction=e.direction*(1/6e4)||0,this.alignment=e.alignment,this.rotateWithShape=void 0===e.rotateWithShape||e.rotateWithShape,this.startAlpha=void 0!==e.startAlpha?e.startAlpha:1,this.startPosition=void 0!==e.startPosition?e.startPosition:0,this.endAlpha=void 0!==e.endAlpha?e.endAlpha:.1,this.endPosition=void 0!==e.endPosition?e.endPosition:.7,this.fadeDirection=e.fadeDirection*(1/6e4)||0}},{key:"measure",value:function(){var e=this.getDistance()+this.getEndPosition()*this.reflectionRect.height();if(this.reflectionRect.bottom()>this.boundRect.bottom()){var t=this.reflectionRect.bottom()-this.boundRect.bottom();this.reflectionOff=this.getDistance()+this.boundRect.height()-t}else this.reflectionOff=this.getDistance()+this.reflectionRect.height();return new window.Rect(this.boundRect.x()-this.blurRadius,this.boundRect.y()-this.blurRadius,this.boundRect.width()+2*this.blurRadius,this.boundRect.height()+e+2*this.blurRadius)}},{key:"render",value:function(e,t,n){this.measure();var i=va(this.reflectionRect.width()+2*this.getBlurRadius(),this.reflectionRect.height()+2*this.getBlurRadius()).getElem(),a=i.getContext("2d");return Mo.debug_Axis_Linewidth>0&&a.strokeRect(0,0,i.width,i.height),a.translate(0,this.reflectionRect.height()),a.scale(1,-1),this.createImage(a,e.canvas,i.width,i.height),i}},{key:"createImage",value:function(e,t,n,i){var a=n,o=i;e.translate(0,2*-this.getBlurRadius()),e.drawImage(t,0,0);var r=new window.Point,s=new window.Point;!function(e,t,n,i,a){for(;t<0;)t+=360;var o=Math.PI,r=parseInt(t,10)%360,s=t/180*o;if(n){var l=Math.atan(Math.abs(Math.tan(s)*(0===e.height()?1:e.width()/e.height())));r>0&&r<90?(t=l/o*180,s=l):r>90&&r<180?(t=180-l/o*180,s=o-l):r>180&&r<270?(t=180+l/o*180,s=o+l):r>270&&r<360&&(t=360-l/o*180,s=2*o-l)}var c=void 0;t>=0&&t<90?(i.setX(e.x()),i.setY(e.y()),c=Math.cos(s)*e.width()+Math.sin(s)*e.height()):t>=90&&t<180?(i.setX(e.x()+e.width()),i.setY(e.y()),c=Math.cos(o-s)*e.width()+Math.sin(o-s)*e.height()):t>=180&&t<270?(i.setX(e.x()+e.width()),i.setY(e.y()+e.height()),c=Math.cos(s-o)*e.width()+Math.sin(s-o)*e.height()):t>=270&&t<360&&(i.setX(e.x()),i.setY(e.y()+e.height()),c=Math.cos(2*o-s)*e.width()+Math.sin(2*o-s)*e.height());a.setX(i.x()+c*Math.cos(s)),a.setY(i.y()+c*Math.sin(s))}(new window.Rect(0,0,a,o),this.getDirection(),!0,r,s);var l=e.createLinearGradient(r.x(),r.y(),s.x(),s.y()),c="rgba(255,255,255,"+this.getStartAlpha()+")",u="rgba(255,255,255,"+this.getEndAlpha()+")";l.addColorStop(this.getStartPosition(),c),l.addColorStop(this.getEndPosition(),u);var d=e.getImageData(0,0,a,o);this.getBlurRadius()>0&&new Io(d,this.getBlurRadius()).render();!function(e,t,n){for(var i=function(e,t){var n=va(t.width(),t.height()).getElem(),i=n.getContext("2d");return i.fillStyle=e,i.fillRect(0,0,t.width(),t.height()),n}(t,n),a=i.getContext("2d").getImageData(0,0,i.width,i.height).data,o=e.data,r=0;r<a.length;r+=4){var s=a[r+3];o[r+3]=o[r+3]*s>>8}i._canvasPoolItem.release()}(d,l,new window.Rect(0,0,a,o)),e.putImageData(d,0,0)}},{key:"createEffectTransform",value:function(){var e=new Po;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e.m_sx=this.getScaleX(),e.m_sy=this.getScaleY(),e.m_kx=this.getSkewX(),e.m_ky=this.getSkewY(),e.m_alignment=this.getAlignment(),e}},{key:"getBoundRect",value:function(){return new window.Rect(this.boundRect.x(),this.boundRect.y(),this.boundRect.width(),this.boundRect.height())}},{key:"getEndPosition",value:function(){return this.endPosition}},{key:"getEndAlpha",value:function(){return this.endAlpha}},{key:"getStartPosition",value:function(){return this.startPosition}},{key:"getStartAlpha",value:function(){return this.startAlpha}},{key:"getfadeDirection",value:function(){return this.fadeDirection}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"setDistance",value:function(e){this.distance=e}},{key:"getDirection",value:function(){return this.direction}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"getSkewX",value:function(){return this.skewX}},{key:"getSkewY",value:function(){return this.skewY}},{key:"getAlignment",value:function(){return this.alignment}},{key:"rotateWithShape",value:function(){return this.rotateWithShape}}]),e}();var Fo=function(){function e(t){var n=t.drawRect,i=t.geometry2D,a=t.extParam,o=t.lineWidth,r=t.shapeData;s()(this,e),this._drawRect=Object.assign({},n),this._geometry2D=i,this._scale=a.scale,this._lineWidth=void 0!==o?o:0,this._outLine=a.outline||{},this._shapeData=r,this._effects=a.effects,this._shape3d=a.shape3d,this._scene3d=a.scene3d,this._fill=a.fill,this.isComplexEffect=!(!this.hasEffect()&&!this.has3D())}return c()(e,[{key:"measure",value:function(){var e=this.getScale();this.setDrawRectScale(e);var t=this.getDrawRect(),n=t.width,i=t.height;if(!(0===n&&0===i||n<0||i<0)){var a=this.getGeometry2D().interpretPath(n,i),o=this.getGeometryType(),r=!!this.getShapeData().getProperty().picture&&this.getShapeData().getProperty().picture,s=this.measureLine(a,r);this.calcMatrix(a,s);var l=new window.Rect(s.l,s.t,s.width,s.height);a.srcBoundRect=l.clone();var c=this.measureShadow(a,l);c&&(a.shadowRect=c,Go(c,s));var u=this.measureReflection(a,l,c);u&&Go(u,s);var d=new window.Rect(s.l,s.t,s.width,s.height),h=this.getDrawRect(),p=h.x,f=h.y;p=this.getDrawRect().x+s.l,f=this.getDrawRect().y+s.t,p/=e,f/=e;var g=s.l<0?g=Math.abs(s.l)/e:0,v=s.t<0?v=Math.abs(s.t)/e:0;this._lineWidth<0&&(g=0,v=0);var y=a.originBoundRect,m=G.b/e,_=new window.Rect(y.x()/e,y.y()/e,y.width()/e,y.height()/e);return _.adjust(-m,-m,m,m),{paths:a,geomertyBoundRect:_,x:p,y:f,drawRect:this.getDrawRect(),scale:e,shapeType:o,offX:g,offY:v,shapeRealyRect:d}}}},{key:"measureLine",value:function(e,t){if(e){var n=this._initBounds();this.isComplexStroke=!1,this.needStroke=!1;for(var i=0;i<e.length;i++){var a=this.getOutLine(),o=e[i].attributes,r=a&&a.fill&&a.fill.type;if((!o.hasOwnProperty("stroke")||o.stroke)&&(r||this.has3D())||t){this.needStroke=!0;var s=new Va,l=this.isComplexEffect,c=s.measureOutLine(e[i],a,this.getScale(),l,t);if(!c||!c.isQPainterPath)continue;Go(c.boundingRect(),e[i].bounds),c!==e[i].painterPath&&(this.isComplexStroke=!0),c.isEmpty()||(e[i].strokerPath=c),Ho(n,e[i].bounds)}else Ho(n,e[i].bounds)}if(n.r!==n.l&&n.b!==n.t||(n.l=0,n.r=this.getDrawRect().width,n.t=0,n.b=this.getDrawRect().height),!this.isComplexStroke||this.isComplexEffect){var u=this.getLineWidth();Ho(n,{l:-u,t:-u,r:this.getDrawRect().width+u,b:this.getDrawRect().height+u})}return e.originBoundRect=new window.Rect(n.l,n.t,n.width,n.height),n}}},{key:"measureShadow",value:function(e,t){if(Math.abs(t.width())!==1/0&&Math.abs(t.height())!==1/0&&this.hasEffect()&&e){var n=this.getEffects(),i=n.outerShadow,a=n.presetShadow,o=n.glow,r=i||a,s=t;if(o){var l=new Bo(o,t,this.getScale(),this.getLineWidth());s=l.measure(),e.glowEffect=l}var c=void 0;if(r){c=new Do(r,t,[],this.getScale()).measure()}return s=function(e){for(var t={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},n=e.length,i=0;i<n;i++){var a=e[i];a&&a.isQRect&&(a.left()<t.l&&(t.l=a.left()),a.right()>t.r&&(t.r=a.right()),a.top()<t.t&&(t.t=a.top()),a.bottom()>t.b&&(t.b=a.bottom()))}return t.width=t.r-t.l,t.height=t.b-t.t,new window.Rect(t.l,t.t,t.width,t.height)}([s,c])}}},{key:"measureReflection",value:function(e,t,n){if(Math.abs(t.width())!==1/0&&Math.abs(t.height())!==1/0&&this.hasEffect()&&e){var i=this.getEffects().reflection;if(i)return e.reflectionRect=function(e,t){var n=e.left(),i=e.right(),a=e.top(),o=e.bottom();n>t.left()&&(n=t.left());i<t.right()&&(i=t.right());a>t.top()&&(a=t.top());o<t.bottom()&&(o=t.bottom());var r=i-n,s=o-a;return new window.Rect(n,a,r,s)}(n,t),new jo(i,t,this.getScale(),e.reflectionRect).measure()}}},{key:"getNormalAngel",value:function(e){var t=e;return t<0&&(t+=360),Math.round(t)%360}},{key:"calcMatrix",value:function(e){var t=new window.Point(0+this.getDrawRect().width/2,0+this.getDrawRect().height/2),n=void 0,i=this.getNormalAngel(this.getRotation());n=new window.QMatrix(1,0,0,1,0,0);var a=this.getDrawRect(),o=a.overflowLeft,r=a.overflowTop;n.translate(isNaN(o)?0:o,isNaN(r)?0:r);var s=new window.QMatrix(1,0,0,1,0,0),l=this.getHorizontalFlipped(),c=this.getVerticalFlipped();n.translate(t.x(),t.y()),n.rotate(i),n.scale(l?-1:1,c?-1:1),n.translate(-t.x(),-t.y()),e.matrix=n,s.translate(t.x(),t.y()),s.rotate(-i),s.scale(l?-1:1,c?-1:1),s.translate(-t.x(),-t.y()),e.resetMatrix=s,e.isComplexStroke=this.isComplexStroke}},{key:"getScale",value:function(){return this._scale}},{key:"getEffects",value:function(){return this._effects}},{key:"hasEffect",value:function(){var e=this.getEffects();return e&&Object.keys(e).length>0}},{key:"has3D",value:function(){return this._scene3d&&Object.keys(this._scene3d).length>0||this._shape3d&&Object.keys(this._shape3d).length>0}},{key:"getFill",value:function(){return this._fill}},{key:"getShapeData",value:function(){return this._shapeData}},{key:"getRotation",value:function(){return this._drawRect.rotation||0}},{key:"getHorizontalFlipped",value:function(){return this._drawRect.horizontalFlipped}},{key:"getVerticalFlipped",value:function(){return this._drawRect.verticalFlipped}},{key:"getLineWidth",value:function(){return this._lineWidth>0&&this._lineWidth<1?1:Math.round(this._lineWidth)}},{key:"getDrawRect",value:function(){return this._drawRect}},{key:"setDrawRect",value:function(e,t,n,i){this._drawRect.x=e,this._drawRect.y=t,this._drawRect.width=n,this._drawRect.height=i}},{key:"setDrawRectScale",value:function(e){}},{key:"getGeometry2D",value:function(){return this._geometry2D}},{key:"getGeometryType",value:function(){return this._geometry2D?this._geometry2D.geometry.geometryType:null}},{key:"getOutLine",value:function(){return this._outLine}},{key:"_initBounds",value:function(){return{l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY}}}]),e}();function Ho(e,t){e.l>=t.l&&(e.l=t.l),e.r<=t.r&&(e.r=t.r),e.t>=t.t&&(e.t=t.t),e.b<=t.b&&(e.b=t.b),e.width=e.r-e.l,e.height=e.b-e.t}function Go(e,t){e.isQRect&&e.left()<t.l&&(t.l=e.left()),e.isQRect&&e.right()>t.r&&(t.r=e.right()),e.isQRect&&e.top()<t.t&&(t.t=e.top()),e.isQRect&&e.bottom()>t.b&&(t.b=e.bottom()),t.width=t.r-t.l,t.height=t.b-t.t}var Uo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,i=void 0===n?0:n,a=t.y,o=void 0===a?0:a,r=t.width,l=void 0===r?0:r,c=t.height,u=void 0===c?0:c;s()(this,e),this.x=i,this.y=o,this.width=l,this.height=u}return c()(e,[{key:"setRect",value:function(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getRect",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"setY",value:function(e){this.y=e}},{key:"pointInRect",value:function(e,t){return e>=this.x+4&&e<=this.x+this.width-4&&t>=this.y+4&&t<=this.y+this.height-4}},{key:"getCross",value:function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}},{key:"getRotatePoint",value:function(e,t,n){var i=t.x,a=t.y,o=n*Math.PI/180,r=e.x,s=e.y;return{x:(i-r)*Math.cos(o)-(a-s)*Math.sin(o)+r,y:(i-r)*Math.sin(o)+(a-s)*Math.cos(o)+s}}},{key:"pointInRotateRect",value:function(e,t,n){return n=n||{x:this.x+this.width/2,y:this.y+this.height/2},0!==t&&(e=this.getRotatePoint(n,e,-t)),this.pointInRect(e.x,e.y)?e:null}},{key:"pointOnBorder",value:function(e,t){var n=e,i=t,a=this.x,o=this.y,r=this.x+this.width,s=this.y+this.height;if(n<a+4&&n>a-4&&n>0){if(i<s+4&&i>o-4)return"left"}else if(n<r+4&&n>r-4){if(i<s+4&&i>o-4)return"right"}else if(i<o+4&&i>o-4&&i>0){if(n<r+4&&n>a-4)return"top"}else if(i<s+4&&i>s-4&&n<r+4&&n>a-4)return"bottom";return!1}},{key:"pointOnTop",value:function(e,t,n){var i=this.x,a=this.x+this.width;return t<-5&&e>i&&e<a?"arrowtop":t>-5&&t<0&&e>i&&e<a||e>i&&e<a&&t>n&&t<n+5?"selectShape":t>n+5&&e>i&&e<a&&"arrowbottom"}},{key:"pointOnLeft",value:function(e,t,n){var i=this.y,a=this.y+this.height;return t>i&&t<a&&e<-5?"arrowLeft":t>i&&t<a&&e>n+5?"arrowRight":(t>i&&t<a&&e>n&&e<n+5||t>i&&t<a&&e>-5&&e<0)&&"selectShape"}},{key:"setScaleXY",value:function(e,t){this.scale={x:e,y:t}}},{key:"getScaleXY",value:function(){return this.scale||{x:1,y:1}}},{key:"inRect",value:function(e){return this.x>=e.x&&this.y>=e.y&&this.width+this.x<=e.width+e.x&&this.height+this.y<=e.height+e.y}},{key:"pointInRectHorizontal",value:function(e,t){var n=e.x,i=e.y,a=this.height,o=n-this.x,r=i-this.y,s=this.lineHeight||0;if(s&&(r+=s-a,a=s),o>=0&&r>=0&&o<=this.width&&r<=a)return!0;if(t){if(r>=0&&r<=a)return this.isPlaceholder&&this.isPlaceholder(),!0}else if(o>=0&&o<=this.width)return this.isPlaceholder&&this.isPlaceholder(),!0;return!1}},{key:"destroy",value:function(){}}]),e}(),Wo=function(){function e(){s()(this,e),this.pathList=[],this.maxWidth=Number.POSITIVE_INFINITY,this.maxHeight=Number.POSITIVE_INFINITY}return c()(e,[{key:"beginNewPath",value:function(e){this.attributes=e,this.previous={x:0,y:0},this.painterPath=new window.QPainterPath}},{key:"endPath",value:function(){var e=this.painterPath.boundingRect();this.bounds={l:e.left(),t:e.top(),r:e.right(),b:e.bottom()},this.pathList.push({attributes:this.attributes,bounds:this.bounds,painterPath:this.painterPath})}},{key:"moveTo",value:function(e,t){this.previous.x=e,this.previous.y=t,this.painterPath.moveTo(new window.Point(e,t))}},{key:"lineTo",value:function(e,t){Yo(this.previous.x-e)&&Yo(this.previous.y-t)||(this.previous.x=e,this.previous.y=t,this.painterPath.lineTo(new window.Point(e,t)))}},{key:"arcTo",value:function(e,t,n,i,a,o){this.previous=function(e){e.result;var t=e.previous,n=e.widthRadius,i=e.heightRadius,a=e.startAngle,o=e.swingAngle,r=e.scaleW,s=e.scaleH,l=(e.pathCache,e.bounds,e.painterPath),c=function(e,t,n,i){var a=e,o=t;(a-=360*Math.floor(a/360))<0&&(a+=360);e=zo(a,n,i);var r=a+o,s=Math.floor(r/360),l=1;(r-=360*s)<0&&(r=-r,l=-1);return r=l*zo(r,n,i),[e,t=(r+=360*s)-e]}(a=360-a,o=-o,n/r,i/s),u=F()(c,2);a=u[0],o=(o=u[1])<.5&&o>=0?.5:o;var d=function(e,t,n){for(var i=[],a=0;a<15;a++)i[a]=new window.Point;var o=$(e,t,n,i,0),r=F()(o,2),s=r[0],l=r[1],c=[],u={type:G.d.LineTo,parameter:[s.x(),s.y()]};c.push(u);for(var d=0;d<l;d+=3){var h={type:G.d.CubicBezierTo,parameter:[i[d].x(),i[d].y(),i[d+1].x(),i[d+1].y(),i[d+2].x(),i[d+2].y()]};c.push(h)}return c}(new window.Rect(0,0,2*n,2*i),a,o),h=window.Point;if(0===d.length)return;for(var p=new window.Point(d[0].parameter[0],d[0].parameter[1]),f=h["-"](t,p),g={},v=1;v<d.length;v++){var y=d[v],m=y.parameter;if(y.type===G.d.CubicBezierTo){var _=new window.Point(m[0],m[1]),x=new window.Point(m[2],m[3]),w=new window.Point(m[4],m[5]),k=h["+"](f,_),b=h["+"](f,x),T=h["+"](f,w);g.x=T.x(),g.y=T.y(),l&&l.cubicTo(k,b,T)}}return g}({previous:new window.Point(this.previous.x,this.previous.y),widthRadius:e,heightRadius:t,startAngle:n,swingAngle:i,scaleW:a,scaleH:o,painterPath:this.painterPath})}},{key:"quadraticBezierTo",value:function(e,t,n,i){this.painterPath.quadTo(new window.Point(e,t),new window.Point(n,i)),this.previous.x=n,this.previous.y=i}},{key:"cubicBezierTo",value:function(e,t,n,i,a,o){this.painterPath.cubicTo(new window.Point(e,t),new window.Point(n,i),new window.Point(a,o)),this.previous.x=a,this.previous.y=o}},{key:"closeCurrentpath",value:function(){this.painterPath.closeSubpath(),this.attributes.isClosePath=!0}},{key:"calcPathBounds",value:function(e,t){e<this.bounds.l&&(this.bounds.l=e),e>this.bounds.r&&(this.bounds.r=e),t<this.bounds.t&&(this.bounds.t=t),t>this.bounds.b&&(this.bounds.b=t)}}]),e}();function Yo(e){return Math.abs(e)<=1e-12}function zo(e,t,n){if(Yo(e-90)||Yo(e-270)||Yo(n))return e;var i=Math.PI,a=void 0;return a=Math.atan(Math.tan(e/180*i)*t/n),a*=180/i,e>90&&e<270?a+=180:e>270&&(a+=360),a}Math.atan2;var Xo=Math.sin,Vo=Math.cos;Math.PI;function qo(e,t,n){var i=e.x,a=e.y,o=e.width,r=e.height,s=Math.PI/180*n,l=(i-t.x)*Vo(s)-(a-t.y)*Xo(s)+t.x,c=(i-t.x)*Xo(s)+(a-t.y)*Vo(s)+t.y,u=((i+=o)-t.x)*Vo(s)-(a-t.y)*Xo(s)+t.x,d=(i-t.x)*Xo(s)+(a-t.y)*Vo(s)+t.y;a+=r;var h=(i-t.x)*Vo(s)-(a-t.y)*Xo(s)+t.x,p=(i-t.x)*Xo(s)+(a-t.y)*Vo(s)+t.y,f=((i-=o)-t.x)*Vo(s)-(a-t.y)*Xo(s)+t.x,g=(i-t.x)*Xo(s)+(a-t.y)*Vo(s)+t.y,v=Math.min(l,u,h,f),y=Math.min(c,d,p,g),m=Math.max(c,d,p,g);return{x:v,y:y,width:Math.max(l,u,h,f)-v,height:m-y}}function Ko(e,t){var n=Zn()({},e);return["x","y","width","height","top","left","bottom","right"].forEach((function(i){Object.isEmpty(e[i])||(n[i]=e[i]*t)})),n}window.zoomRect=Ko;var Qo=0,Jo=1,Zo=2,$o=3,er=4,tr=5,nr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.m_width=t.width,this.m_height=t.height,this.m_widthUnit=t.widthUnit,this.m_heightUnit=t.heightUnit,this.m_color=t.color,this.m_tip=t.tip,this.m_rasterOp=t.rasterOp,this.m_antiAliased=t.antiAliase,this.m_fitToCurve=t.fitToCurve,this.m_ignorePressure=this.ignorePressure}return c()(e,[{key:"getTip",value:function(){return this.m_tip}},{key:"fitToCurve",value:function(){return this.m_fitToCurve}},{key:"antiAliased",value:function(){return this.m_antiAliased}},{key:"getWidthBy",value:function(e){return hr(this.m_widthUnit,e)*this.m_width}},{key:"getHeightBy",value:function(e){return hr(this.m_heightUnit,e)*this.m_height}},{key:"getColor",value:function(){return this.m_color&&this.m_color.rgba?this.m_color:{rgba:"rgba(255,0,0,1)"}}}]),e}(),ir=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.m_traceFormat=new ar(t.traceFormat),this.m_timeStamp=t.timeStamp}return c()(e,[{key:"getTraceFormat",value:function(){return this.m_traceFormat}},{key:"getTimeStamp",value:function(){return this.m_timeStamp}}]),e}(),ar=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.m_channelX=t.channelX,this.m_channelY=t.channelY}return c()(e,[{key:"getChannelX",value:function(){return this.m_channelX}},{key:"getChannelY",value:function(){return this.m_channelY}}]),e}(),or=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.m_brushRef=t.brushRef,this.m_vecPoints=t.vecPoints,this.m_vecTime=t.vecTime,this.timeStamp=t.timestamp,this.m_vecForce=t.vecForce}return c()(e,[{key:"getPtVec",value:function(){return this.m_vecPoints}},{key:"getBrushRef",value:function(){return this.m_brushRef}},{key:"getTimeVec",value:function(){return this.m_vecTime}},{key:"getForceVec",value:function(){return this.m_vecForce}},{key:"getTimeStamp",value:function(){return this.timeStamp}},{key:"flipPtVec",value:function(e){}}]),e}(),rr=0,sr=1,lr=2,cr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,e),this.m_context=new ir(t.context),this.m_brushMap=t.brushMap||{},this.m_vecTrace=t.vecTrace||[],this.m_coordCache,this._init()}return c()(e,[{key:"_init",value:function(){if(this.m_brushMap){var e=this.m_brushMap;for(var t in e)e.hasOwnProperty(t)&&(e[t]=new nr(e[t]))}Array.isArray(this.m_vecTrace)&&(this.m_vecTrace=this.m_vecTrace.map((function(e){return new or(e)})))}},{key:"getContext",value:function(){return this.m_context}},{key:"getBrushMap",value:function(){return this.m_brushMap||{}}},{key:"getTraceVec",value:function(){return this.m_vecTrace||[]}},{key:"getCoord",value:function(){return this.m_coordCache||(this.m_coordCache=this.calcTraceCoord()),this.m_coordCache}},{key:"calcTraceCoord",value:function(){var e=this.m_vecTrace;if(!e.length||!e[0].getPtVec().length)return new window.Rect;for(var t=e[0].getPtVec()[0].px,n=e[0].getPtVec()[0].py,i=t,a=n,o=0,r=e.length;o<r;o++)for(var s=e[o].getPtVec(),l=0,c=s.length;l<c;l++){var u=s[l],d=u.px,h=u.py;d>i?i=d:d<t&&(t=d),h>a?a=h:h<n&&(n=h)}return new window.Rect(t,n,i-t,a-n)}},{key:"mapTraceBy",value:function(e,t){if(e.width&&e.height){var n=[],i=window.QMatrix,a=new window.QMatrix;a.translate(e.x,e.y);var o=e.width,r=e.height,s=e.rotation;if(a.translate(o/2,r/2),a.rotate(s||0),a.translate(-o/2,-r/2),1===t.getPtVec().length)return n.push(a.map_point(new window.Point(.5*e.width,.5*e.height))),n;var l=this.getCoord();if(0===l.width()&&0===l.height())return n.push(a.map_point(new window.Point(.5*e.width,.5*e.height))),n;a=i.multiply(a,this.calcMapTrans(e));for(var c=t.getPtVec(),u=0,d=c.length;u<d;u++){var h=a.map_point(new window.Point(c[u].px,c[u].py));n.push(h)}return n}console.warn("this extent is error",e)}},{key:"calcMapTrans",value:function(e){if(e.width&&e.height){var t=window.QMatrix,n=new window.QMatrix,i=this.getCoord();if(0===i.width()&&0===i.height())return n;n.translate(i.left(),i.top());var a=dr(i.width())?1:i.width()/e.width,o=dr(i.height())?1:i.height()/e.height;return n.scale(a,o),t.inverted(n)}}},{key:"getBrushFrom",value:function(e){return this.m_brushMap[e.getBrushRef()]}},{key:"getMaxBrushWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tr,t=this.m_brushMap;if(!this.maxBrushWidth){var n=0;for(var i in t)if(t.hasOwnProperty(i)){var a=t[i].getWidthBy(e);a>n&&(n=a)}this.maxBrushWidth=n}return this.maxBrushWidth}}]),e}(),ur=function(){function e(){s()(this,e),this.m_formulaMap=new Map,this._init()}return c()(e,[{key:"_init",value:function(){this.addUnitConvertFormula(Qo,Jo,100),this.addUnitConvertFormula(Qo,Zo,1e3),this.addUnitConvertFormula(Qo,$o,100/2.54),this.addUnitConvertFormula(Qo,er,7200/2.54),this.addUnitConvertFormula(Qo,tr,144e3/2.54),this.addUnitConvertFormula(Jo,Zo,10),this.addUnitConvertFormula(Jo,$o,1/2.54),this.addUnitConvertFormula(Jo,er,72/2.54),this.addUnitConvertFormula(Jo,tr,1440/2.54),this.addUnitConvertFormula(Zo,$o,.1/2.54),this.addUnitConvertFormula(Zo,er,7.2/2.54),this.addUnitConvertFormula(Zo,tr,144/2.54),this.addUnitConvertFormula($o,er,72),this.addUnitConvertFormula($o,tr,1440),this.addUnitConvertFormula(er,tr,20)}},{key:"convert",value:function(e,t){if(e===t)return 1;var n=this.m_formulaMap.get(this.getKey(e,t));return n||(console.warn("has no formula",e,t),1)}},{key:"getKey",value:function(e,t){return[e,t].join("_")}},{key:"addUnitConvertFormula",value:function(e,t,n){this.m_formulaMap.set(this.getKey(e,t),n),this.m_formulaMap.set(this.getKey(t,e),1/n)}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}();function dr(e){return Math.abs(e)<=1e-12}function hr(e,t){return ur.getInstance().convert(e,t)}var pr=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.props=e,n}return p()(t,e),c()(t,[{key:"update",value:function(e){var t=e.shapeData,n=e.parentLayout,i=void 0===n?null:n,a=e.scale;this.shapeData=t,this.parentLayout=i,this.scale=a,this.props=e,this._init()}},{key:"getShapeAgent",value:function(){return this._shapeAgent}},{key:"measure",value:function(){var e=this.props,t=e.shapeData,n=e.isLocalShape,i=e.customTextbody,a=void 0,o=void 0,r=this._shapeAgent;if(n&&r&&!t.isGroupShape())if(r.showNotesBody());else{var s=null;if(!t.isBackground()&&r.getProperty().geometry2D)s=r.getProperty().geometry2D;else{var l=void 0;if(r.getProperty().geometry2D){var c=r.getProperty().geometry2D;l=c.type||c._type}else l={data:{presetType:"rect"}};this.shapeData.getTableFrame&&this.shapeData.getTableFrame()||(s=new Un(l))}if(s){var u=window.CustomGeometry.createGeometryFromPreset(s.type,this.transform2D),d=new Wo;u.setEnv(this.scale),s.setEnv(u,d),this.geometry2D=s}var h=r.getProperty();if(this.advancedAutoFit=!1,this.advancedAutoFit);else if(i){var p=Object($n.a)(this.getRealRectBeforeRotation());i.needAdjustWidth&&(this.layoutRect.width=p.width=i.contextWidth),i.needAdjustHeight&&(this.layoutRect.height=p.height=i.contextHeight),a=s&&this.geometryMeasure(s,{fill:h.fill,picture:h.picture,outline:h.outline,scale:this.scale,effects:h.effects,shape3d:h.shape3d,scene3d:h.scene3d,drawRect:p,isBackground:t.isBackground()}),h.shape3d&&a&&(a.shape3d=h.shape3d),h.scene3d&&a&&(a.scene3d=h.scene3d)}else a=s&&this.geometryMeasure(s,{fill:h.fill,picture:h.picture,outline:h.outline,scale:this.scale,effects:h.effects,shape3d:h.shape3d,scene3d:h.scene3d,drawRect:Object($n.a)(this.getRealRectBeforeRotation()),isBackground:t.isBackground()}),h.shape3d&&a&&(a.shape3d=h.shape3d),h.scene3d&&a&&(a.scene3d=h.scene3d);this.getConnectionSites();var f=r.getTableBody();o=this.tableMeasure(f),this.shapeProperty=h;var g=void 0;h.inkData&&(g=this.inkMeasure(h.inkData)),this.extendList={typoTextBody:void 0,measureShapeBody:a,typoTableBody:o,inkBody:g};var v=this.getFindTextResults();f&&v&&(f.findResults=v),this._updateRealRect(),this._mapExactRect()}else if(t.isGroupShape()){this.groupMeasure();var y=r.getProperty();this.shapeProperty=y,this._updateRealRect()}else n||this.calcShapeMatrix();var m=(this.props.prevLayoutResult||{}).shapeVisual;if(m){var _=m.layout,x=_&&_.getExtendList();x&&m.updateMeasureShapeBody(x.measureShapeBody),m.layout.destroy(),m.updateLayout(this)}return this.shapeVisual=m,this}},{key:"textBodyMeasure",value:function(e){return null}},{key:"notesPageTextBodyMeasure",value:function(e){return null}},{key:"tableMeasure",value:function(e){return null}},{key:"geometryMeasure",value:function(e,t){var n=t.drawRect;if(t.scale){var i=0,a=this.props.shapeData;if(a.isBackground()?i=-1:t.outline&&(i=t.outline.width?window.Ti2Px(window.Emu2Ti(t.outline.width),t.scale):1),!(0===n.width&&0===n.height||n.width<0||n.height<0)){var o,r,s,l=new Fo({drawRect:n,geometry2D:e,extParam:t,lineWidth:i,shapeData:a}).measure(),c=void 0;c=Object($n.a)(t.fill),o=Object($n.a)(t.picture),r=Object($n.a)(t.outline),s=Object($n.a)(t.effects);var u=this.shapeData.getFill();if(u&&this.parentLayout&&u.type===bi.e.FillTypeGroup){c=c||{};var d=this.parentLayout.getRealRect();c.rect={x:this.realRect.x-d.x,y:this.realRect.y-d.y,width:d.width,height:d.height}}var h={layout:l,fill:c,picture:o,outline:r,effects:s};return l.paths&&(this.geomertyBoundRect=l.geomertyBoundRect),this.shapeRealyRect=l.shapeRealyRect,this.shapeData.textBoxRect=e.getGeometry().textBoxRect,this.shapeData.adjustHandles=e.getGeometry().adjustHandles,h}}}},{key:"prepUpdatePartOfText",value:function(e,t){var n=this.props&&this.props.prevLayoutResult&&this.props.prevLayoutResult.shapeVisual,i=n&&n.measureShapeBody,a=i&&i.layout;a&&(a.geomertyBoundRect&&(this.geomertyBoundRect=a.geomertyBoundRect),a.shapeRealyRect&&(this.shapeRealyRect=a.shapeRealyRect));var o=e.getGeometry();if(e&&o){var r=t.width,s=t.height;o.updateNameTable(r,s)}}},{key:"inkMeasure",value:function(e){return new cr(e)}},{key:"groupMeasure",value:function(){var e=0;this.shapeData.childShapes.forEach((function(t){var n=t.getOutline();if(n&&n.width&&n.fill&&0!==n.fill.type){var i=n.width/635;i>e&&(e=i)}})),this.exactRect&&(this.exactRect.overflowLeft=2*e,this.exactRect.overflowTop=2*e,this.exactRect.width+=4*e,this.exactRect.height+=4*e)}},{key:"calcShapeMatrix",value:function(){var e=new window.QMatrix,t=this.transform2D,n=t.rotation,i=t.horizontalFlipped,a=t.verticalFlipped,o=t.width,r=t.height;return e.translate(o/2,r/2),e.rotate(n),e.scale(i?-1:1,a?-1:1),e.translate(-o/2,-r/2),this.shapeMatrix=e,e}},{key:"calcHitTestMatrix",value:function(){var e=this.viewRect||this.realRect,t=e.x,n=e.y,i=e.width,a=e.height,o=this.transform2D,r=o.rotation,s=o.horizontalFlipped,l=o.verticalFlipped,c=new window.QMatrix;return c.translate(t,n),c.translate(i/2,a/2),c.rotate(r),c.scale(s?-1:1,l?-1:1),c.translate(-i/2,-a/2),c}},{key:"getHitTestMatrix",value:function(){return this.hitTestMatrix=this.hitTestMatrix||this.calcHitTestMatrix(),this.hitTestMatrix}},{key:"calcBackendTransform",value:function(e){var t=new window.QMatrix;if(!e||Object.isEmpty(e.width))return t.translate(this.realRect.x,this.realRect.y),Zn()({matrix:t},this.realRect);var n=e.width,i=e.height,a=e.x,o=e.y,r=n*this.scale,s=i*this.scale;a*=this.scale,o*=this.scale;var l=gr.get(e,this.realRect);if(l){var c=l.rotation,u=l.horizontalFlipped,d=l.verticalFlipped,h=this.transform2D,p=h.rotation,f=h.horizontalFlipped,g=h.verticalFlipped;a+=this.realRect.x-l.x,o+=this.realRect.y-l.y,r*=this.realRect.width/l.width,s*=this.realRect.height/l.height,t.translate(a,o),t.translate(r/2,s/2),t.rotate(p-c),t.scale(f===u?1:-1,g===d?1:-1),t.translate(-r/2,-s/2)}else t.translate(a,o);return{matrix:t,width:r,height:s}}},{key:"getGroupShapeTransform",value:function(){if(this._groupShapeTransform)return this._groupShapeTransform;for(var e=this.shapeData.parent,t=[],n=void 0;e&&e.isGroupShape&&e.isGroupShape()&&!e.isShapeTree;){var i=e.getTransform2D(),a=i||{},o=a.horizontalFlipped,r=a.verticalFlipped,s=a.rotation;n=this.getShapeLayout(e),(s||o||r)&&t.unshift(n),e=e.parent}return this._groupShapeTransform=t,t}},{key:"getShapeLayout",value:function(e){if(e.isShapeTree)return null;var n=this.props.scale;return new t({shapeData:e,parentLayout:this.getShapeLayout(e.parent),scale:n,slideEnvLayout:this.slideEnvLayout,isLocalShape:!0}).measure()}},{key:"hitTest",value:function(e){}},{key:"isHidden",value:function(){return this.shapeData&&this.shapeData.isHidden()}},{key:"_mokeDrawRect",value:function(e,t){if(this.shapeVisual&&this.shapeVisual.hitTestPath){var n=document.querySelector("#mock_draw_canvas");if(!n){var i=document.querySelector("#uil-content .slide-editor");(n=document.createElement("canvas")).setAttribute("id","mock_draw_canvas"),n.setAttribute("width",i.offsetWidth+"px"),n.setAttribute("height",i.offsetHeight+"px"),i.appendChild(n)}var a=window.APP.shell.doc.coreView.getZoom(),o=n.getContext("2d");o.clearRect(0,0,n.width,n.height);var r=this.getUilGeometryRect(1)||this.viewRect||this.realRect,s=r.x,l=r.y,c=r.width,u=r.height;o.clearRect(0,0,n.width,n.height),o.save(),o.scale(a,a),o.fillRect(s,l,c,u),o.restore()}}},{key:"hitSelectObjectsByRect",value:function(e){this.typoRect||(this.typoRect=new Uo);var t=this.getLayoutRectAfterRotation(),n=t.x,i=t.y,a=t.width,o=t.height;if(this.typoRect.setRect(n,i,a,o),this.typoRect.inRect(e))return{type:"shapeSelect",isHit:!0}}},{key:"getSelectRectByGcp",value:function(e){var t=e.begin,n=e.end,i=e.cellIndex,a=e.isHitRight,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getExtendList(),s=r.typoTextBody,l=r.typoTableBody,c=[];if(s){var u=this._textBodyLayouter;u&&u.update(s),c=u.getSelectRectByGcp(t,n,a)}else if(l){var d=this._TableLayouter;d&&d.update(l),c=d.getSelectRectByGcp(t,n,i,a)}var h=this.viewRect||this.realRect,p=h.x,f=h.y,g=this.ratio;return o&&(p=0,f=0,g=1),c&&c.forEach((function(e){e.forEach((function(e){e.x+=p,e.y+=f,e.x*=g,e.y*=g,e.width=e.width*g,e.height=e.height*g,e.beginPos.x+=p,e.beginPos.y+=f,e.endPos.x+=p,e.endPos.y+=f,e.beginPos.x*=g,e.beginPos.y*=g,e.endPos.x*=g,e.endPos.y*=g,e.cursorX+=p,e.cursorX*=g}))})),c}},{key:"getNextGcpByDirectionKeys",value:function(e){var t=e.gcp,n=e.keyCode,i=this.getExtendList(),a=i.typoTextBody,o=i.typoTableBody;if(a){var r=this._textBodyLayouter;return r&&r.update(a),r.getNextGcpByDirectionKeys(t,n)}if(o){var s=this._TableLayouter;return s&&s.update(o),s.getNextGcpByDirectionKeys(t,n,o.selectIndex)}}},{key:"isChangeCellIndex",value:function(e,t){var n=this.getExtendList().typoTableBody;if(n){var i=this._TableLayouter;return i&&i.update(n),i.isChangeCellIndex(e,t,n.selectIndex)}}},{key:"getSelectStyleByRange",value:function(e){var t=e.begin,n=e.end,i=e.cellIndex,a=this.getExtendList(),o=a.typoTextBody,r=a.typoTableBody,s=Zn()({},this.shapeProperty);if(o){var l=this._textBodyLayouter;l&&l.update(o);var c=l.getSelectStyleByRange(t,n);s.textBodyStyle=c}else if(r){var u=this._TableLayouter;if(u&&(u.update(r),!Object.isEmpty(i))){var d=u.getSelectStyleByRange(t,n,i);s.textBodyStyle=d}}return s}},{key:"getVerticalType",value:function(){var e=this.typoTextBody;return e&&e.getVerticalType()}},{key:"updateRatio",value:function(e){this.ratio=e}},{key:"getUilLayoutRect",value:function(e){this.updateRatio(e);var t=this._rect2Px(Zn()({},this.getLayoutRect()),this.ratio);return t.rotate=this.getFrameRotation(),t}},{key:"getUilGeometryRect",value:function(e){this.updateRatio(e);var t=this.getShapeRealyRect();if(t){var n=this._rect2Px(Zn()({},t),this.ratio),i=this.getUilLayoutRect(e);return Object.assign(i,n)}return this.getUilLayoutRect(e)}},{key:"getShapeRealyRect",value:function(){if(this.shapeRealyRect){var e=this.shapeRealyRect,t=this.getHitTestMatrix(),n=G.b;return t.Map(e).adjust(n,n,-n,-n).getRect()}}},{key:"getUilRotatedLayoutRect",value:function(e){var t=Zn()({},this.realRect);return Ko(qo(t,{x:t.x+t.width/2,y:t.y+t.height/2},this.realRect.rotation),e)}},{key:"getRotatedRect",value:function(e){var t=Ko(this.realRect,this.ratio);return qo(e,{x:t.x+t.width/2,y:t.y+t.height/2},this.getFrameRotation())}},{key:"getShapeMvpMatrix",value:function(e){var t=this.getUilLayoutRect(e),n=new window.QMatrix;return n.translate(t.x,t.y),n.translate(t.width/2,t.height/2),n.rotate(t.rotation),n.scale(t.horizontalFlipped?-1:1,t.verticalFlipped?-1:1),n.translate(-t.width/2,-t.height/2),n}},{key:"calcBackendRotatePosPx",value:function(e){this.typoRect||(this.typoRect=new Uo);var t=this.getBackendRectPx(),n=t.x,i=t.y,a=t.width,o=t.height;this.typoRect.setRect(n,i,a,o);var r={x:n+a/2,y:i+o/2};return this.typoRect.getRotatePoint(r,e,this.getFrameRotation())}},{key:"getCellRectByIndex",value:function(e){var t=this._TableLayouter;return t&&t.getCellRectByIndex(e)}},{key:"getCellRectByIdx",value:function(e){var t=this._TableLayouter;return t&&t.getCellRectByIdx(e)}},{key:"getCellRangeByIdx",value:function(e){var t=this._TableLayouter;return t&&t.getCellRangeByIdx(e)}},{key:"setBackendShapeRect",value:function(e){this.backendShapeRect=e}},{key:"isOnlyUpdateText",value:function(){return!1}},{key:"isOnlyUpdatePicture",value:function(){var e=this.extendList&&this.extendList.measureShapeBody;return e&&e.picture}},{key:"isOnlyUpdatePicFill",value:function(){var e=this.extendList&&this.extendList.measureShapeBody,t=e&&e.fill;return(t&&t.type)===bi.e.FillTypeBlip}},{key:"getFindTextResults",value:function(){var e=this;if(this.shapeData){var t=window.APP&&window.APP.presentation,n=t&&t.searcherMgr.getSearcher("text");if(n&&n.count>0){var i=this.shapeData.getId(),a=this.shapeData.getSlideId(),o=n.getResultByParams({slideId:a,shapeId:i});if(o&&o.length){var r=[],s=this._TableLayouter;return o.forEach((function(t){var n=t.getState(),i=e.shapeData.getTableFrame(),a=i&&i.collectCellsIdx(n.cellRange),o=a&&a[0],l=e.getSelectRectByGcp({begin:n.begin,end:n.end,cellIndex:o},!0),c=s&&!Object.isEmpty(o)&&s.getSelectCell(o);if(c&&l){var u=c.cellVisual.getRect();l.forEach((function(e){e.forEach((function(e){e.x+=u.x,e.y+=u.y}))}))}r.push({lightRect:l,cellIndex:o})})),r}}}}},{key:"destroy",value:function(){if(B()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),delete this.props,delete this._textBodyLayouter,delete this._shapeAgent,this.extendList){var e=this.extendList.typoTextBody;e&&e.destroy()}delete this._TableLayouter,delete this.extendList,delete this.shapeVisual}},{key:"calcTransFromCurrent2Layer",value:function(e){if(this.shapeData&&this.dataToken===this.shapeData.getDataToken()){var t=new window.QTransform,n=this.scale*e;t.scale(n,n);var i=this.shapeData.visual.calcTransFromCurrent2Layer().multiply(t);return i.scale(1/n,1/n),i}}},{key:"getConnectionSites",value:function(){var e=this.geometry2D;if(!this.connectionSites&&e){var t=e.getGeometry(),n=t&&t.getConnectionSites();if(n&&n.length)this.connectionSites=Object($n.a)(n),(this._originShapeData||this.shapeData).visual.setConnectionSites(Object($n.a)(n))}return this.connectionSites}},{key:"getTi2PxConnectionSites",value:function(e){var t=this.getConnectionSites();if(t){var n=this.getUilLayoutRect(e),i=n.x,a=n.y,o=n.width,r=n.height,s=n.rotation,l=n.horizontalFlipped,c=n.verticalFlipped,u=new window.QMatrix;u.translate(i+o/2,a+r/2),u.rotate(s),u.scale(l?-1:1,c?-1:1),u.translate(-o/2,-r/2);var d=window.Ti2Px;return t.map((function(t){var n=t.x,i=t.y,a=new window.Point(d(n/635)*e,d(i/635)*e),o=u.Map(a);return Zn()({},t,{x:o.x(),y:o.y()})}))}}},{key:"getAnimationRect",value:function(e){var t=this.extendList&&this.extendList.measureShapeBody,n=t&&t.layout,i=n&&n.shapeRealyRect;if(!i){var a=window.Rect.create(this.viewRect);return a.adjust(-3,-3,3,3),a.getRect()}i=i.translated(new window.Point(this.layoutRect.x,this.layoutRect.y));var o=window.Rect.create(this.viewRect),r=i.left()<o.left()?i.left()-3:o.left()-3,s=i.right()>o.right()?i.right()+3:o.right()+3,l=i.top()<o.top()?i.top()-3:o.top()-3,c=i.bottom()>o.bottom()?i.bottom()+3:o.bottom()+3,u=window.Rect.create({left:r,right:s,top:l,bottom:c}),d=this.transform2D.rotation;return u=u.getRect(),e?((u=this._rect2Px(u,e)).rotation=d,u):(u.rotation=d,u)}},{key:"getOriginDataToken",value:function(){return this._originShapeData&&this._originShapeData.getDataToken()}},{key:"typoTextBody",get:function(){return null}},{key:"isFieldPlaceholderShapes",get:function(){var e=this.getShapeAgent();return e&&e.isFieldPlaceholderShapes}}]),t}(Gi),fr=function(e){return new pr(e).measure()},gr=function(){function e(){s()(this,e)}return c()(e,null,[{key:"set",value:function(e,t){(e.token||e.sha1)&&(this._dataMap[e.token||e.sha1]=t)}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=this._dataMap[e.token||e.sha1];if(n)return n;this.set(e,Object.assign({},t))}}]),e}();gr._dataMap={};var vr=function(){function e(t,n,i){s()(this,e),this.ltd=i,this.boundRect=n&&n.isQRect?(new window.Rect).assign(n):null,this.radius=window.Emu2Ti(t.radius)*this.ltd*2||0}return c()(e,[{key:"render",value:function(e,t,n){var i=Math.floor(.843*this.getRadius());if(!(i<=0)){var a=e.getImageData(0,0,t,n);!function(e,t){var n=[0,0,0,0],i=e.width,a=e.height,o=[],r=[];(function(e,t){for(var n=e.width,i=e.height,a=4*e.width,o=e.data,r=0;r<n;++r)for(var s=0;s<i;++s){var l=xr(e,r,s);yr(o,l)&&(0===r||r===n-1||0===s||s===i-1?t.push(new window.Point(r,s)):l+4!==0&&l-4!=0&&l-a!=0&&l+a!==0||t.push(new window.Point(r,s)))}})(e,r),function(e,t){if(t<=0)return;var n=function(e){return e-1}(t);e.push(new mr(-n,0,2*t-1));for(var i=n*n,a=1;a<=n;++a){var o=Math.round(Math.sqrt(i-a*a)),r=2*_r(o)-1;e.push(new mr(-o,-a,r)),e.push(new mr(-o,a,r))}}(o,t);for(var s=0;s<r.length;++s)for(var l=0;l<o.length;++l){var c=r[s].x()+o[l].xoff,u=r[s].y()+o[l].yoff,d=o[l].ilen;u<0||u>=a||(c<0&&(d+=c,c=0),c+d>i&&(d=i-c),wr(e,c,u,d,n))}}(a,i),new Io(a,i/2).render(),e.putImageData(a,0,0)}}},{key:"getRadius",value:function(){return this.radius}},{key:"getBoundRect",value:function(){return this.boundRect}}]),e}();function yr(e,t){return e[t+0]&&e[t+1]&&e[t+2]&&e[t+3]}var mr=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;s()(this,e),this.xoff=t,this.yoff=n,this.ilen=i},_r=function(e){return e+1};function xr(e,t,n){var i=e.width,a=e.height;return(t>i||n>a)&&console.error("Over width or height , cannot get imageData pix from x y!"),n*i*4+4*t}function wr(e,t,n,i,a){for(var o=e.data,r=e.width,s=n*r*4+4*t;i--&&n<r;)o[s+0]=a[0],o[s+1]=a[1],o[s+2]=a[2],o[s+3]=a[3],n++,s+=4}var kr=function(){function e(t){s()(this,e),this.props=t}return c()(e,[{key:"render",value:function(e){var t=this.props,n=t.orginlCanvasImage,i=t.effects,a=t.layout,o=t.fill,r=t.outline,s=t.preloadSource,l=t.parentLayout,c=t.picture;if(!i)return!1;var u=a.scale,d=a.paths,h=a.shapeRealyRect,p=h.height(),f=h.width(),g=i.outerShadow,v=i.presetShadow,y=i.innerShadow,m=i.reflection,_=i.glow,x=i.softEdges,w=g||v,k=r&&r.width?r.width:0,b=isNaN(window.Emu2Ti(k)*u)?0:window.Emu2Ti(k)*u;e.save();var T=d.matrix,C=!!c,S=n.getContext("2d");if(T&&T.mapContext(S),y){var E=a.scale,P=new No(y,d,h,E,{fill:o,layout:a,preloadSource:s,parentLayout:l,picture:c}).render(n);e.save(),S.save(),e.drawImage(P,0,0),S.drawImage(P,0,0),e.restore(),S.restore()}if(S.globalCompositeOperation="destination-over",w){var L=d.srcBoundRect,A=new Do(w,L,[],u).render(n,f,p,h);e.drawImage(A,h.x(),h.y()),S.drawImage(A,h.x(),h.y())}if(_){var I=d.srcBoundRect,R=new Bo(_,I,u,b).render(d,o,r,C,T,h);e.drawImage(R,h.x(),h.y()),S.drawImage(R,h.x(),h.y())}if(x){var O=i.softEdges;new vr(O,null,u).render(S,f,p)}if(m){var M=d.reflectionRect,D=d.srcBoundRect,N=d.reflectionRect,B=new jo(m,D,u,N),j=B.render(S,Math.round(M.width()),Math.round(M.height())),F=B.reflectionOff;if(_)F-=4*(window.Emu2Ti(_.radius)*u/2);var H=d.originBoundRect;e.drawImage(j,h.x(),F+H.y())}e.restore()}}]),e}(),br=n(8840),Tr=n.n(br),Cr=function(){function e(t){var n=t.layout,i=t.outline,a=t.picture,o=t.preloadSource,r=t.shape;s()(this,e),this.outline=i,this.paths=n.paths,this.scale=n.scale,this.preloadSource=o,this.shape=r,this.layout=n,this._init(a,o)}return c()(e,[{key:"_init",value:function(e,t){var n=e&&e.blip&&e.blip.blipAtom&&e.blip.blipAtom.imageId;this.imageId=n,this.picture=e,this.image=t[n]}},{key:"render",value:function(e,t,n,i){if(!this.paths||!this.image||!this.picture)return!1;this.imgRect=this.calcImgRect(),this.clipImage(e),this.renderOutline(e,t,n,i)}},{key:"_renderBackgroundImage",value:function(e){if(this.imageId>0){this.backgroundImageGroup=e.save("clip_image_background");var t=this.imgRect.clone();t.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y));var n=new window.QPainterPath;n.addRect(t),n.toContextPath(e),e.clip(),this._clipImage(e),n.toContextPath(e),this.paths.forEach((function(t){var n=t.attributes,i=n&&n.fill,a=t.strokerPath?t.strokerPath.data:t.painterPath.data;a&&a.isClosed()&&i!==bi.f.None&&t.painterPath.toContextPath(e)})),e.fillStyle="rgba(0, 0, 0, "+.4*this.pictureFull.alpha+")",e.fill("evenodd"),e.restore()}}},{key:"clipImage",value:function(e){var t=this;if(window.APP.isClipMode){var n=window.APP.isClipMode,i=n.shapeId,a=n.slideId;i===this.shape.getId()&&a===this.shape.getSlideId()&&this._renderBackgroundImage(e)}this.paths.forEach((function(n,i){var a=n.attributes,o=a&&a.fill,r=n.strokerPath?n.strokerPath.data:n.painterPath.data;r&&r.isClosed()&&o!==bi.f.None&&(e.save("clip_image_"+t.imageId+"_"+(i+1)),t._clipImage(e,n),t._addShadowLayer(e,n),e.restore())}))}},{key:"_addShadowLayer",value:function(e,t){var n=t.attributes,i=n&&n.fill;if(i&&0!==i){var a=this.imgRect.clone();a.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y));var o=new window.QPainterPath;o.addRect(a),o.toContextPath(e),e.clip(),e.beginPath(),t.painterPath.toContextPath(e),this._setAlpha(e,i),e.fill()}}},{key:"calcImgRect",value:function(){var e=this.picture,t=e.sourceRectangle,n=e.blip,i=this.image._logicWidth||this.image.width,a=this.image._logicHeight||this.image.height;if(!i||!a)return new window.Rect(this.layout.drawRect.x,this.layout.drawRect.y,this.layout.drawRect.width,this.layout.drawRect.height);var o=new window.Rect(0,0,i,a),r=this.layout.drawRect,s=this.calcClosePathBound();s.translate({x:r.x,y:r.y});var l=s.x(),c=s.y(),u=s.width(),d=s.height(),h=n&&n.blipAtom&&n.blipAtom.size,p=this.imageId>0&&h>0;if(t&&p){var f=t.left,g=t.right,v=t.top,y=t.bottom,m=o.adjusted(i*f,a*v,i*-g,a*-y);if(isNaN(f)||isNaN(v)||isNaN(g)||isNaN(y)||m.width()<0||m.height()<0)return console.error("Error SourceRectangle"),new window.Rect(l,c,u,d);var _=m.width()/s.width(),x=m.height()/s.height();if(0===_||0===x)return window.Rect.setFromPoint(s.center(),s.center());var w=i/_,k=a/x;l=s.left()-w*f,c=s.top()-k*v,u=w,d=k}return new window.Rect(l,c,u,d)}},{key:"renderOutline",value:function(e,t,n,i){if(t&&t.fill&&t.fill.type){var a=e.save("clip_image_outline");if(window.APP.isClipMode&&this.backgroundImageGroup){var o=window.APP.isClipMode,r=o.shapeId,s=o.slideId;r===this.shape.getId()&&s===this.shape.getSlideId()&&this.backgroundImageGroup.parentElement.insertBefore(a,this.backgroundImageGroup)}this.paths.forEach((function(a){var o=a.attributes;o.hasOwnProperty("stroke")&&!o.stroke||new Va({outline:t,path:a,layout:n,scale:i}).render(e)&&(a.strokerPath&&a.strokerPath!==a.painterPath?(e.beginPath(),a.strokerPath.toContextPath(e),e.isSvg?e.fill("nonzero",$e.b.ShapeOutlinePath()):e.fill("nonzero")):(e.beginPath(),a.painterPath.toContextPath(e),e.stroke($e.b.ShapeOutlinePath())))})),e.restore()}if(window.APP.isClipMode){var l=window.APP.isClipMode,c=l.shapeId,u=l.slideId;c===this.shape.getId()&&u===this.shape.getSlideId()&&(e.save("clip_image_shape_outline"),this.paths.forEach((function(t){e.strokeStyle="rgba(255, 255, 255, 1)",e.lineWidth=1,e.setLineDash([3,3]),e.beginPath(),t.painterPath.toContextPath(e),e.stroke()})),e.restore())}}},{key:"calcClosePathBound",value:function(){var e=this,t=void 0;return this.paths.forEach((function(n){var i=n.painterPath.boundingRect();t||(t=new window.Rect.create(i)),n.painterPath.data&&n.painterPath.data.isClosed()&&(t=e._calcRect(t,new window.Rect.create(i)))})),t}},{key:"_clipImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.imgRect.clone();n.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y)),e.save("image_clip"),t&&(t.painterPath.toContextPath(e),e.clip());var i=Object.assign({},this.picture),a=n.getRect();i.originRect=n,i.isStretched=!0,i.sourceRectangle={};var o=new Ra({rect:a,clip:!0,fill:i,shadowRangeIndex:-1,preloadSource:this.preloadSource,scale:this.scale});this.pictureFull=o;var r=o.makeImageEffects(this.image),s=r.img,l=r.canvas;if(this.image=e.isSvg?s:l,e.drawImageAlpha=o.alpha,e.isSvg&&this.preloadSource&&Object.keys(this.preloadSource).includes(""+window.wppDefaultImageId)){var c=e.getCurrentElement();c&&c.setAttribute("class","content-placeholder-default-image")}this.image&&("IMG"===this.image.tagName||"CANVAS"===this.image.tagName)&&a.width>0&&a.height>0&&e.drawImage(this.image,a.x,a.y,a.width,a.height),e.restore()}},{key:"_setAlpha",value:function(e,t){var n=0;switch(t){case bi.f.Lighten:n=.4;break;case bi.f.LightenLess:n=.2;break;case bi.f.Darken:n=.4;break;case bi.f.DarkenLess:n=.2}t===bi.f.Lighten||t===bi.f.LightenLess?(e.fillStyle="rgba(255,255,255,"+n+")",e.strokeStyle="rgba(255,255,255,"+(1-n)+")"):t!==bi.f.Darken&&t!==bi.f.DarkenLess||(e.fillStyle="rgba(0,0,0,"+n+")",e.strokeStyle="rgba(255,255,255,"+(1-n)+")")}},{key:"_calcRect",value:function(e,t){if(!e.isQRect||!t.isQRect)return console.error("not rect"),!1;var n=e.left()<t.left()?e.left():t.left(),i=e.right()>t.right()?e.right():t.right(),a=e.top()<t.top()?e.top():t.top(),o=e.bottom()>t.bottom()?e.bottom():t.bottom();return new window.Rect(n,a,i-n,o-a)}}]),e}(),Sr=function(e){return e&&e.innerShadow},Er=function(e){return e&&(e.outerShadow||e.presetShadow)},Pr=function(e){return e&&e.reflection},Lr=function(e){return e&&e.softEdges},Ar=function(e){return e&&e.glow},Ir=function(){function e(t){if(s()(this,e),this.layout=t,t){var n=this.layout.getExtendList().measureShapeBody;this.measureShapeBody=n}}return c()(e,[{key:"updateLayout",value:function(e){return!!e&&(this.layout=e,!0)}},{key:"updateMeasureShapeBody",value:function(e){return!!e&&(this.measureShapeBody=e,!0)}},{key:"render",value:function(e,t,n){var i=this;if(this.context=e,this.preloadSource=n,this.scale=t,this.layout.shapeVisual=this,this.has3DRender()&&!this.unSuportShape3d()){var a=this.measureShapeBody,o=a.shape3d,r=a.scene3d,s=a.layout,l=a.fill,c=a.outline,u=a.effects;this.shape3d=o,this.scene3d=r,this.rootSvg=this.context.getLastGroup&&this.context.getLastGroup(),Tr()((function(e){i.Visual3DRender=e.default;var t=new Ea,n=new i.Visual3DRender(t,r,o,s,{fill:Object(Ui.c)(l),outline:Object(Ui.c)(c),effects:Object(Ui.c)(u)},i.shapeData),a=n.get3DCache();if(a)n.draw3DCache(a);else{console.log("3dRender start",Date.now());var d=i.parpareFor3D(n);i.isFlatText(),n.setFrontTexture(d),n.render(),console.log("3dRender end",Date.now())}var h=t.getSvg();i.rootSvg.appendChild(h.lastElementChild)}))}else this.draw2DShape(this.context);ga.c("geomerty")}},{key:"parpareFor3D",value:function(e){var t=e.get3DBound(),n=va(t,t).getElem(),i=n.getContext("2d"),a=t/2-e.getRect().width()*this.scale/2+e.getRect().x()*this.scale,o=t/2-e.getRect().height()*this.scale/2+e.getRect().y()*this.scale;return i.translate(a,o),i.save(),this.draw2DShape(i,!0),i.restore(),n}},{key:"isMedia",value:function(){return!!(this.shapeData&&this.shapeData.private.name).includes(".")}},{key:"draw2DContour",value:function(e,t,n,i){var a={};a.width=n,a.joinType=ci.LineJoinTypeRound,a.endingCap=ei.LineCapRound;for(var o=0;o<i.length;o++){var r=i[o],s=r.attributes;s.hasOwnProperty("stroke")&&!s.stroke||(r.strokerPath.toContextPath(e),e.fillStyle=t.getRgbString(),e.fill("nonzero"))}}},{key:"isFlatText",value:function(){var e=this.layout.shapeData;if(e&&e.private&&e.private.childs){var t=e.private.childs[0];if(t&&t.private&&t.private.prop)return!!t.private.prop.flatText}return!1}},{key:"has3DRender",value:function(){var e=this.measureShapeBody,t=e.shape3d,n=e.scene3d;return n&&Object.keys(n).length>0||t&&Object.keys(t).length>0}},{key:"unSuportShape3d",value:function(){var e=this.measureShapeBody,t=(e.shape3d,e.scene3d);if(this.shapeData.isPlaceHolder())return!0;if(t){var n=t&&t.camera,i=n&&n.type;if(i&&i>=29&&i<=37||i>=47&&i<=61)return!0}}},{key:"converterScene3d",value:function(e){e.converter()}},{key:"draw2DText",value:function(e){var t=this.layout,n=t.getExtendList().typoTextBody,i=t.getRotation(),a=0,o=0;if(0!==i){var r=t.getRealRect();a=r.width/2,o=r.height/2,e.translate(a,o),e.rotate(i*Math.PI/180)}var s=n.getScaleXY(),l=n.overflowLeft,c=n.overflowTop;l<0&&(a-=l*s.x),c<0&&(o-=c*s.y),e.translate(-a,-o)}},{key:"hitTest",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=new window.QMatrix,i=n.Map(e),a=this.hitTestPath||this.calcHitTestPath(t),o=0;o<a.length;o++){var r=a[o];if(a[o].painterPath){var s=r.painterPath;if(s.containsPoint(i))return!0}if(a[o].strokerPath){var l=a[o].strokerPath;if(l.containsPointNearly(i))return!0}}return!1}},{key:"calcHitTestPath",value:function(e){for(var t=this.measureShapeBody,n=t.fill,i=t.layout,a=t.picture,o=t.outline,r=i.paths,s=this.scale,l=[],c=0;c<r.length;c++){var u=r[c],d=u.attributes,h=u.painterPath,p=u.strokerPath,f=d.fill,g={};if((a||n&&n.type&&f!==bi.f.None&&h||this.shapeData.isPlaceHolder()||this.shapeData.getShapeType()===Gn.g.TextBox)&&(g.painterPath=h,h.setFillRule(1)),p&&o&&o.fill&&o.fill.type&&(!d.hasOwnProperty("stroke")||d.stroke)){var v=Object(Ui.c)(o);v.width+=635*e/this.scale;var y=(new Va).complexStrokePath(u,v,s,a);if(!y.isQPainterPath)continue;y.data?(y.setFillRule(1),g.strokerPath=y):h&&(g.strokerPath=h,h.setFillRule(1))}else{var m=new Va,_=635*e/this.scale,x=m.complexStrokePath(u,{width:_},s,a);x.isQPainterPath&&(x.setFillRule(1),g.strokerPath=x)}l.push(g)}return this.hitTestPath=l,l}},{key:"draw2DShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.preloadSource,i=this.parentLayout,a=this.measureShapeBody,o=a.fill,r=a.layout,s=a.picture,l=a.outline,c=a.effects,u=r.paths,d=r.drawRect,h=r.shapeRealyRect,p=r.shapeRealyRect.height(),f=r.shapeRealyRect.width();if(d.height=u.outScaleY?d.height/u.outScaleY:d.height,0!==p||0!==f){var g=u.matrix||new window.QMatrix,v=void 0,y=void 0,m=h.width()>2e4||h.height()>2e4;if(!m&&Er(c)||Pr(c)||Lr()||Sr(c)||Ar(c)){var _=va(h.width(),h.height());if((y=(v=_.getElem()).getContext("2d")).translate(-h.x(),-h.y()),this.shapeRender(y,t),!Sr(c)){var x=new kr({orginlCanvasImage:v,effects:c,layout:r,fill:o,outline:l,preloadSource:n,parentLayout:i,matrix:g,picture:s});x.render(e)}}if(e.save(),this.shapeRender(e,t),e.restore(),Sr(c)){var w=new kr({orginlCanvasImage:v,effects:c,layout:r,fill:o,outline:l,preloadSource:n,parentLayout:i,matrix:g,picture:s});w.render(e)}}}},{key:"shapeRender",value:function(e,t){var n=this,i=this.measureShapeBody,a=this.scale,o=this.preloadSource,r=this.parentLayout,s=i.fill,l=i.layout,c=i.picture,u=i.outline,d=l.paths,h=d.matrix||new window.QMatrix,p=d.resetMatrix||new window.QMatrix;if(t||h.mapContext(e),d.forEach((function(t){var i=t.attributes,d=t.painterPath,h=t.strokerPath,f=i.fill,g=!1;s&&s.type&&f!==bi.f.None&&(new Xa({fill:s,path:t,layout:l,preloadSource:o,parentLayout:r,matrix:p}).render(e)&&(n.clipFillShape(e,s,l,t,p)||(e.beginPath(),d.toContextPath(e),e.isSvg?e.fill("evenodd",$e.b.ShapeFillPath()):e.fill("evenodd"),g=!0)));u&&u.fill&&u.fill.type&&(!i.hasOwnProperty("stroke")||i.stroke)&&!c&&(new Va({outline:u,path:t,layout:l,scale:a}).render(e)&&(h&&h!==d?(e.beginPath(),h.toContextPath(e),e.isSvg?e.fill("nonzero",$e.b.ShapeOutlinePath()):e.fill("nonzero")):g&&h===d?e.stroke():(e.beginPath(),d.toContextPath(e),e.stroke($e.b.ShapeOutlinePath()))))})),c&&o){var f=c&&c.blip&&c.blip.blipAtom&&c.blip.blipAtom.imageId;e.save($e.b.ShapeImage(this.shapeData.getId(),f)),new Cr({layout:l,outline:u,picture:c,preloadSource:o,shape:this.shapeData}).render(e,u,l,a),e.restore()}}},{key:"clipFillShape",value:function(e,t,n,i,a){if(t.hasOwnProperty("rotateWithShape")&&!t.rotateWithShape&&e.fillGradinet&&n&&n.drawRect){var o=new window.QMatrix,r=new window.Rect(0,0,n.drawRect.width,n.drawRect.height),s=n.drawRect.rotation?n.drawRect.rotation:0;o.translate(r.center().x(),r.center().y()),o.rotate(s),o.translate(-r.center().x(),-r.center().y());var l=o.mapRect(r);return e.save(),i.painterPath.toContextPath(e),e.clip(),a.mapContext(e),e.drawImage(e.fillGradinet,l.x(),l.y()),e.restore(),delete e.fillGradinet,!0}return delete e.fillGradinet,!1}},{key:"parentLayout",get:function(){return this.layout.parentLayout}},{key:"shapeData",get:function(){return this.layout.shapeData}}]),e}(),Rr=function(){function e(t){s()(this,e),this._inkData=t,this.inkPath=[],this.inkMapTrace=[]}return c()(e,[{key:"render",value:function(e,t,n){if(t){this.layout=t;var i=t.getRealRectPx();if(i.width&&i.height){t.inkVisual=this;var a=e;a.translate(-i.x,-i.y);var o=!!n,r=this.layout.shapeData&&this.layout.shapeData.getId();if(o&&r<0)this.useInkPrevRender(e,n);else{var s=this.layout.shapeData&&this.layout.shapeData.isNiteInk();a.save("ink_"+r,s?"multiply":null);var l=Date.now();this._ctx=a;for(var c=this.getTraceVec(),u=0,d=c.length;u<d;u++){var h=this.mapTraceBy(i,c[u],u);if(h.length){var p=c[u].getTimeStamp();p&&a.save(p),this.drawInk(a,h,this.getBrushFrom(c[u])),p&&a.restore()}}a.restore(),console.log("inkRenderTimer 1",Date.now()-l)}}else console.warn("this extent is error",i)}}},{key:"mapInkContxtMatrix",value:function(e,t){var n=new window.QMatrix;if(t){var i=t.width,a=t.height,o=t.rotation;n.translate(i/2,a/2),n.rotate(o||0),n.translate(-i/2,-a/2)}n.mapContext(e)}},{key:"useInkPrevRender",value:function(e,t){var n=this.layout,i=n.shapeData&&n.shapeData.getId(),a=i&&t.querySelector("#ink_"+i);if(a){for(var o=n.getRealRectPx(),r=this.getTraceVec(),s=a.childNodes,l=0,c=r.length-1;c>=0;c--){var u=s[c],d=r[c]&&r[c].getTimeStamp();if(u&&Number(u.id)===Number(d)){l=c+1;break}}for(var h=new Ea,p=l;p<r.length;p++){var f=s[p],g=r[p].getTimeStamp();f&&f.remove();var v=this.mapTraceBy(o,r[p],p);v.length&&(g&&h.save(g),this.drawInk(h,v,this.getBrushFrom(r[p])),g&&h.restore())}for(var y=h.getSvg().lastElementChild||{};y.childNodes&&y.childNodes[0];)a.appendChild(y.childNodes[0]);e.__currentElement.appendChild(a)}}},{key:"drawInk",value:function(e,t,n){0!==t.length&&(n.getTip()===sr?this.drawNiteInk(e,t,n):n.getTip()===rr?this.drawEllipseInk(e,t,n):console.warn("Brush::drop类型目前不支持"))}},{key:"drawNiteInk",value:function(e,t,n){var i=n.getWidthBy(tr),a=n.getHeightBy(tr);i<5&&(i=5),a<10&&(a=10);var o=n.getColor(),r=this.layout.scale;e.save(),e.fillStyle=o.rgba,e.beginPath(),this.generateFillPathFrom(e,t,i*r,a*r,n),e.fill(),e.restore()}},{key:"drawEllipseInk",value:function(e,t,n){var i=n.getWidthBy(tr),a=n.getColor(),o=this.layout.scale;e.save(),e.lineWidth=i<10?10*o:i*o,e.strokeStyle=a.rgba,e.lineJoin="round",e.lineCap="round",1===t.length?this.drawPoint(e,t[0]):(e.beginPath(),n.fitToCurve()?this.fitToCuve(t,e):this.fitToLine(t,e),e.stroke()),e.restore()}},{key:"generateFillPathFrom",value:function(e,t,n,i,a){var o=a.getTip();if(o===sr)if(1===t.length){var r=new window.Rect(t[0].x()-.5*n,t[0].y()-.5*i,n,i);e.addRect?e.addRect(r):function(e,t){e.moveTo(t.x(),t.y()),e.lineTo(t.x()+t.width(),t.y()),e.lineTo(t.x()+t.width(),t.y()+t.height()),e.lineTo(t.x(),t.y()+t.height()),e.lineTo(t.x(),t.y())}(e,r)}else{var s=new window.QPainterPath;a.fitToCurve()?this.fitToCuve(t,s):this.fitToLine(t,s);var l=[];this.appendNiteInkPolygons(s,n,i,l);for(var c=0,u=l.length;c<u;c++)e.addPolygon?e.addPolygon(l[c]):Mr(e,l[c])}else o===rr?console.warn("not implement,use drawpolygon parint"):o===lr&&console.warn("not implement");return e}},{key:"fitToCuve",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(e.length<=2&&e.length>0){t.moveTo(e[0].x(),e[0].y());for(var n=0;n<e.length;n++){var i=e[n];t.lineTo(i.x(),i.y())}return t}var a=function(e,t){if(!e||t<=2)return console.warn("convert2Beziers fail!! ",e,t),[];var n=[],i=window.Point;if(2===t)return n[0]=e[0],n[1]=i["/"](i["+"](i["*"](2,e[0]),e[1]),3),n[2]=i["/"](i["+"](i["*"](2,e[1]),e[0]),3),n[3]=e[1],n;var a=t,o=3*a-2;n[0]=e[0];var r=i["/"](i["-"](i["-"](e[1],e[0]),i["*"](i["-"](e[2],e[1]),.1)),5);n[1]=i["+"](n[0],r);for(var s=1,l=0;s<a-1;)n[l=3*s]=e[s],r=i["/"](i["-"](e[s+1],e[s-1]),5),n[l-1]=i["-"](e[s],r),n[l+1]=i["+"](e[s],r),s++;return n[o-1]=e[a-1],r=i["/"](i["-"](i["-"](e[a-2],e[a-1]),i["*"](i["-"](e[a-3],e[a-2]),.1)),5),n[o-2]=i["+"](n[o-1],r),n}(e,e.length);if(!a||!a.length||a.length%3!=1)return console.warn("convert2Beziers curve is fail",a),null;if(t.moveTo(e[0].x(),e[0].y()),1===e.length)return t.lineTo(e[0].x()+1e-4,e[0].y()),t;for(var o=window.Point,r=1,s=a.length;r<s-2;){var l=a[r++],c=a[r++],u=a[r++];o["=="](l,c)&&o["=="](u,c)&&u.x()===u.y()&&0===u.x()||t.bezierCurveTo(l.x(),l.y(),c.x(),c.y(),u.x(),u.y())}return t}},{key:"fitToLine",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(t.moveTo(e[0].x(),e[0].y()),1===e.length)return t.lineTo(e[0].x()+1e-4,e[0].y()),t;for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n].x(),e[n].y());return t}},{key:"appendNiteInkPolygons",value:function(e,t,n,i){var a=e.toSubpathPolygons();if(Array.isArray(a))for(var o=0,r=a.length;o<r;o++)for(var s=a[o],l=0,c=s.length;l<c-1;l++)this.appendNiteInkPolygon(s[l],s[l+1],t,n,i)}},{key:"appendNiteInkPolygon",value:function(e,t,n,i,a){if(e&&t){var o=new window.Rect(e.x()-n/2,e.y()-i/2,n,i),r=new window.Rect(t.x()-n/2,t.y()-i/2,n,i);if(e.x()===r.x()&&e.y()===r.y())a.push(Or(o));else if(e.x()===t.x()){var s=void 0,l=void 0;e.y()<t.y()?(s=r.bottomRight().x()-o.x(),l=r.bottomRight().y()-o.y(),a.push(Or(new window.Rect(o.x(),o.y(),s,l)))):(s=o.bottomRight().x()-r.x(),l=o.bottomRight().y()-r.y(),a.push(Or(new window.Rect(r.x(),r.y(),s,l))))}else if(e.y()===t.y()){var c=void 0,u=void 0;e.x()<t.x()?(c=r.bottomRight().x()-o.x(),u=r.bottomRight().y()-o.y(),a.push(Or(new window.Rect(o.x(),o.y(),c,u)))):(c=o.bottomRight().x()-r.x(),u=o.bottomRight().y()-r.y(),a.push(Or(new window.Rect(r.x(),r.y(),c,u))))}else{var d=void 0,h=void 0;e.y()<t.y()?(d=o,h=r):(d=r,h=o);var p;p=[d.topLeft(),d.topRight(),h.topRight(),h.topLeft(),d.topLeft()];var f;f=[d.bottomLeft(),d.bottomRight(),h.bottomRight(),h.bottomLeft(),d.bottomLeft()];var g=void 0,v=void 0;e.x()<t.x()?(g=o,v=r):(g=r,v=o);var y;y=[g.topLeft(),v.topLeft(),v.bottomLeft(),g.bottomLeft(),g.topLeft()];var m;m=[g.topRight(),v.topRight(),v.bottomRight(),g.bottomRight(),g.topRight()],a.push(y),a.push(m),a.push(p),a.push(f)}}}},{key:"drawPoint",value:function(e,t){e.beginPath(),e.moveTo(t.x(),t.y()),e.lineTo(t.x()+1e-4,t.y()),e.stroke()}},{key:"getTraceVec",value:function(){return this._inkData.getTraceVec()}},{key:"mapTraceBy",value:function(e,t,n){return this.inkMapTrace[n]||(this.inkMapTrace[n]=this._inkData.mapTraceBy(e,t)),this.inkMapTrace[n]}},{key:"getBrushFrom",value:function(e){return this._inkData.getBrushFrom(e)}},{key:"hitTest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(!e||!this.layout)return!1;var n=this.layout,i=n.getRealRectPx();this.expandHitTestDisTance=t/n.scale;for(var a=this.getTraceVec(),o=0,r=a.length;o<r;o++){var s=this.mapTraceBy(i,a[o],o);if(s.length&&this.hitTestInk(s,this.getBrushFrom(a[o]),e,o))return!0}return!1}},{key:"hitTestInk",value:function(e,t,n,i){return t.getTip()===sr?this.hitTestNiteInk(e,t,n,i):t.getTip()===rr?this.hitTestEllipseInk(e,t,n,i):(console.error(!1),!1)}},{key:"hitTestEllipseInk",value:function(e,t,n,i){var a=this.inkPath[i];return a||(this.inkPath[i]=a=this.createEllipseInkPath(e,t)),a.contains(n)}},{key:"hitTestNiteInk",value:function(e,t,n,i){var a=window.QPainterPath,o=this.inkPath[i];if(!o){(o=new a).setFillRule(1);var r=this.expandHitTestDisTance,s=t.getWidthBy(tr)+r,l=t.getHeightBy(tr)+r;s<5&&(s=5),l<10&&(l=10);var c=this.layout.scale;this.generateFillPathFrom(o,e,s*c,l*c,t),this.inkPath[i]=o}return o.contains(n)}},{key:"createEllipseInkPath",value:function(e,t){var n=new window.QPainterPath;1===e.length?(n.moveTo(e[0]),n.lineTo(new window.Point(e[0].x()+1,e[0].y()+1))):t.fitToCurve()?this.fitToCuve(e,n):this.fitToLine(e,n);var i=this.layout.scale,a=this.expandHitTestDisTance,o={width:(t.getWidthBy(tr)+a)*i,capStyle:ei.LineCapRound,joinStyle:ci.LineJoinTypeRound};o.endCapStyle=o.capStyle,o.startCapStyle=o.capStyle;var r=new la;r.createStrokerFromPen(o);var s=r.createStroke(n,.25)||[];return s.setFillRule(1),s}}]),e}();function Or(e){var t=[];return t.push(new window.Point(e.x(),e.y())),t.push(new window.Point(e.x()+e.width(),e.y())),t.push(new window.Point(e.x()+e.width(),e.y()+e.height())),t.push(new window.Point(e.x(),e.y()+e.height())),t.push(new window.Point(e.x(),e.y())),t}function Mr(e,t){e.moveTo(t[0].x(),t[0].y());for(var n=0,i=t.length;n<i;n++){var a=t[n];e.lineTo(a.x(),a.y())}}function Dr(e,t,n,i,a){if(n){if(Mo.debug_Axis_Linewidth>0){e.save();var o=n.getRealRect();e.strokeStyle="blue",e.lineWidth=Mo.debug_Axis_Linewidth,e.strokeRect(o.x,o.y,o.width,o.height),e.restore()}var r=n.getExtendList(),s=r.measureShapeBody,l=r.inkBody,c=t.getId();if(s){var u=$e.b.Geomerty(c);i&&(i.isHD?u+="_HD":i.isLD&&(u+="_LD")),e.save(u,null,!0);var d=n.scale,h=Date.now(),p=s.fill,f=p&&p.type;e.save($e.b.ShapeFill(c,f)),a&&a.mapContext(e);var g=new Ir(n);window.shapeTime+=Date.now()-h,g.render(e,d,i),e.restore(),e.restore()}if(l)e.save(),a&&a.mapContext(e),new Rr(l).render(e,n,i.inkPrevNode),e.restore()}}Dr.getUploadId=function(e,t){var n=function(e){for(;e&&!e.getPresentation;)e=e.getParent();return e&&e.getPresentation&&e.getPresentation()}(e);return n&&n.getUploadId(t)};var Nr=function(e){if(!e)return[];for(var t=e.getChilds(),n=[],i=0;i<t.length;i++){var a=t[i],o=a.getTextFrame();o&&n.push.apply(n,q()(Br(o)));var r=a.visual.getFill();if(r&&r.blip&&r.blip.hasOwnProperty("blipAtom")){var s=r.blip.blipAtom.imageId?r.blip.blipAtom.imageId:null,l=!r.isStretched;n.push({imageId:s,isNoCompressor:l})}}var c=e.visual.getStyle(),u=c&&c.getWholeTable(),d=u&&u.getCellStyle(),h=d&&d.fill;if(h&&h.blip&&h.blip.hasOwnProperty("blipAtom")){var p=h.blip.blipAtom.imageId?h.blip.blipAtom.imageId:null,f=!h.isStretched;n.push({imageId:p,isNoCompressor:f})}var g=e.visual.getFill();if(g&&g.blip&&g.blip.hasOwnProperty("blipAtom")){var v=g.blip.blipAtom.imageId?g.blip.blipAtom.imageId:null,y=!g.isStretched;n.push({imageId:v,isNoCompressor:y})}return n},Br=function(e){if(!e)return[];var t=[];if(e.getProperty().textWarp)return t;for(var n=e.visual,i=n&&n.getCompleteTextProps(),a=0,o=i?i.length:0;a<o;++a){var r=i[a]&&i[a].chpProps;if(r)for(var s=0,l=r.length;s<l;s++){var c=r[s];if(c){var u=c.props,d=u&&u.textColor;if(d&&d.blip&&d.blip.hasOwnProperty("blipAtom"))if("continue"===function(){var e=d.blip.blipAtom.imageId?d.blip.blipAtom.imageId:null,n=!d.isStretched;if(t.find((function(t){return t.imageId===e})))return"continue";t.push({imageId:e,isNoCompressor:n})}())continue}}}return t},jr=function(e){return e&&e.blip&&e.blip.hasOwnProperty("blipAtom")?[{imageId:e.blip.blipAtom.imageId?e.blip.blipAtom.imageId:null,isNoCompressor:!e.isStretched,size:e.blip.blipAtom.size?e.blip.blipAtom.size:0,imageWidth:e.blip.blipAtom.imageWidth||0,imageHeight:e.blip.blipAtom.imageHeight||0}]:[]};function Fr(e,t,n,i,a){if(e.isTextFrame){if(e.getProperty().textWarp)return!1;var o=e.getTextStream();if(o){var r=o.getAllText();if(!r||!r[0]||r[0]===String.fromCharCode(13)&&r.length<2)return!0;if(Hr(n))return!1;if(i||a)return!1}return!0}return!1}function Hr(e){return e&&Object.keys(e)>0}Dr.getImageIdArr=function(e,t){var n=e,i=[];if(!n||!n.private)return i;var a=n.private.fill||t;if(a)if(a.type===bi.e.FillTypeGroup){var o=n.parent,r=o&&o.private.fill;r&&i.push.apply(i,q()(jr(r)))}else i.push.apply(i,q()(jr(a)));var s=n.private.picture;s&&i.push.apply(i,q()(jr(s)));for(var l=n.private.childs,c=0;c<l.length;c++){var u=l[c];u&&u.isTableFrame?i.push.apply(i,q()(Nr(u))):u&&u.isTextFrame&&i.push.apply(i,q()(Br(u)))}return i},Dr.isSupportRenderShape=function(e,t,n){if(e.isRawMath())return!1;var i=e.private.scene3D?e.private.scene3D:e.parent&&e.parent.private.scene3D,a=e.private.shape3D?e.private.shape3D:e.parent&&e.parent.private.shape3D,o=e.private.effects,r=e.parent&&e.parent.private.effects,s=e.private.geometry2D;for(var l in o){if(!s)return!1;if("softEdges"===l)return!1;if(i||a)return!1}if(Hr(r))return!1;var c=e.private.childs;if(window.ShapeUtil.showNotesBody(e))return!0;if(c instanceof Array)for(var u=0;u<c.length;u++){var d=c[u];if(d){var h=d.private.scene3D;if(Hr(h))return!1;if(d.isTableFrame)for(var p=d.getChilds(),f=0,g=p.length;f<g;f++){var v=p[f].getTextFrame();if(v&&v.isTextFrame&&!Fr(v,t,a,h))return!1}else{if(!d.isTextFrame)return!1;if(!Fr(d,t,o))return!1}}}for(var y=Dr.getImageIdArr(e,n),m=0;m<y.length;m++){if("string"==typeof y[m].imageId)return!0;if(Dr.getUploadId(e,y[m].imageId))return!0}var _=e.private.picture;return!_||!function(e){var t=e.blip;if(!t)return!1;var n=t.colorMap,i=t.effects,a=t.fillMap,o=t.imageLayer;if(n&&n.length>0||a&&a.length>0)return!0;if(i&&i.length>0&&(1!==i.length||6!==i[0].type))return!0;if(o&&o.effects.length>0)return!0;return!1}(_)},window.shapeTime=0,window.textTime=0;var Gr=n(4107),Ur=function(){function e(){s()(this,e),this.w=0,this.h=0,this.runTimeNameTable={}}return c()(e,[{key:"pinTo",value:function(e,t,n){return t<e?e:t>n?n:t}},{key:"modulo",value:function(e,t,n){return Math.sqrt(e*e+t*t+n*n)}},{key:"radianToAngle",value:function(e){return 6e4*e*(180/Math.PI)}},{key:"angleToRadian",value:function(e){return e/6e4*(Math.PI/180)}},{key:"eval",value:function(e){if(this.runTimeNameTable[e])return this.runTimeNameTable[e];var t=this[e];return this.runTimeNameTable[e]=t,t}},{key:"clear",value:function(){this.runTimeNameTable={}}},{key:"3cd4",get:function(){return 162e5}},{key:"3cd8",get:function(){return 81e5}},{key:"5cd8",get:function(){return 135e5}},{key:"7cd8",get:function(){return 189e5}},{key:"b",get:function(){return this.eval("h")}},{key:"cd2",get:function(){return 108e5}},{key:"cd4",get:function(){return 54e5}},{key:"cd8",get:function(){return 27e5}},{key:"hc",get:function(){return this.eval("w")/2}},{key:"hd2",get:function(){return this.eval("h")/2}},{key:"hd3",get:function(){return this.eval("h")/3}},{key:"hd4",get:function(){return this.eval("h")/4}},{key:"hd5",get:function(){return this.eval("h")/5}},{key:"hd6",get:function(){return this.eval("h")/6}},{key:"hd8",get:function(){return this.eval("h")/8}},{key:"hd10",get:function(){return this.eval("h")/10}},{key:"l",get:function(){return 0}},{key:"ls",get:function(){return Math.max(this.eval("w"),this.eval("h"))}},{key:"r",get:function(){return this.eval("w")}},{key:"ss",get:function(){return Math.min(this.eval("w"),this.eval("h"))}},{key:"ssd2",get:function(){return this.eval("ss")/2}},{key:"ssd4",get:function(){return this.eval("ss")/4}},{key:"ssd6",get:function(){return this.eval("ss")/6}},{key:"ssd8",get:function(){return this.eval("ss")/8}},{key:"ssd16",get:function(){return this.eval("ss")/16}},{key:"ssd32",get:function(){return this.eval("ss")/32}},{key:"t",get:function(){return 0}},{key:"vc",get:function(){return this.eval("h")/2}},{key:"wd2",get:function(){return this.eval("w")/2}},{key:"wd3",get:function(){return this.eval("w")/3}},{key:"wd4",get:function(){return this.eval("w")/4}},{key:"wd5",get:function(){return this.eval("w")/5}},{key:"wd6",get:function(){return this.eval("w")/6}},{key:"wd8",get:function(){return this.eval("w")/8}},{key:"wd10",get:function(){return this.eval("w")/10}},{key:"wd12",get:function(){return this.eval("w")/12}},{key:"wd32",get:function(){return this.eval("w")/32}}]),e}(),Wr={accentBorderCallout1:{adjustValues:{adj1:18750,adj2:-8333,adj3:112500,adj4:-38333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["x1","y1","x2","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},accentBorderCallout2:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:112500,adj6:-46667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4],arguments:["x1","y1","x2","y2","x3","y3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},accentBorderCallout3:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:1e5,adj6:-16667,adj7:112963,adj8:-8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj7")/1e5}},{key:"x4",get:function(){return this.eval("w")*this.eval("adj8")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x4",y:"y4",gdRefX:"adj8",minX:-2147483647,maxX:2147483647,gdRefY:"adj7",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["x1","y1","x2","y2","x3","y3","x4","y4"],attributes:{fill:G.e.None,extrusionOk:!1}}]},accentCallout1:{adjustValues:{adj1:18750,adj2:-8333,adj3:112500,adj4:-38333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["x1","y1","x2","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},accentCallout2:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:112500,adj6:-46667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4],arguments:["x1","y1","x2","y2","x3","y3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},accentCallout3:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:1e5,adj6:-16667,adj7:112963,adj8:-8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj7")/1e5}},{key:"x4",get:function(){return this.eval("w")*this.eval("adj8")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x4",y:"y4",gdRefX:"adj8",minX:-2147483647,maxX:2147483647,gdRefY:"adj7",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.Close,G.d.LineTo],argumentIndices:[0,2,2],arguments:["x1","t","x1","b"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["x1","y1","x2","y2","x3","y3","x4","y4"],attributes:{fill:G.e.None,extrusionOk:!1}}]},actionButtonBackPrevious:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14],arguments:["l","t","r","t","r","b","l","b","g11","vc","g12","g9","g12","g10"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["g11","vc","g12","g9","g12","g10"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["g11","vc","g12","g9","g12","g10"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonBeginning:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1*this.eval("g13")/8}},{key:"g15",get:function(){return 1*this.eval("g13")/4}},{key:"g16",get:function(){return this.eval("g11")+this.eval("g14")-0}},{key:"g17",get:function(){return this.eval("g11")+this.eval("g15")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,14,16,18,20,22],arguments:["l","t","r","t","r","b","l","b","g17","vc","g12","g9","g12","g10","g16","g9","g11","g9","g11","g10","g16","g10"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,14],arguments:["g17","vc","g12","g9","g12","g10","g16","g9","g11","g9","g11","g10","g16","g10"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,14],arguments:["g17","vc","g12","g9","g12","g10","g16","g9","g16","g10","g11","g10","g11","g9"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonBlank:{connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{}}]},actionButtonDocument:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"dx1",get:function(){return 9*this.eval("ss")/32}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/16}},{key:"g14",get:function(){return this.eval("g12")+0-this.eval("g13")}},{key:"g15",get:function(){return this.eval("g9")+this.eval("g13")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18],arguments:["l","t","r","t","r","b","l","b","g11","g9","g14","g9","g12","g15","g12","g10","g11","g10"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["g11","g9","g14","g9","g14","g15","g12","g15","g12","g10","g11","g10"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["g14","g9","g14","g15","g12","g15"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,10,12,14],arguments:["g11","g9","g14","g9","g12","g15","g12","g10","g11","g10","g12","g15","g14","g15","g14","g9"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonEnd:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 3*this.eval("g13")/4}},{key:"g15",get:function(){return 7*this.eval("g13")/8}},{key:"g16",get:function(){return this.eval("g11")+this.eval("g14")-0}},{key:"g17",get:function(){return this.eval("g11")+this.eval("g15")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,14,16,18,20,22],arguments:["l","t","r","t","r","b","l","b","g16","vc","g11","g9","g11","g10","g17","g9","g12","g9","g12","g10","g17","g10"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,14],arguments:["g16","vc","g11","g9","g11","g10","g17","g9","g12","g9","g12","g10","g17","g10"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,14],arguments:["g16","vc","g11","g10","g11","g9","g17","g9","g12","g9","g12","g10","g17","g10"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonForwardNext:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14],arguments:["l","t","r","t","r","b","l","b","g12","vc","g11","g9","g11","g10"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["g12","vc","g11","g9","g11","g10"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["g12","vc","g11","g10","g11","g9"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonHelp:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1*this.eval("g13")/7}},{key:"g15",get:function(){return 3*this.eval("g13")/14}},{key:"g16",get:function(){return 2*this.eval("g13")/7}},{key:"g19",get:function(){return 3*this.eval("g13")/7}},{key:"g20",get:function(){return 4*this.eval("g13")/7}},{key:"g21",get:function(){return 17*this.eval("g13")/28}},{key:"g23",get:function(){return 21*this.eval("g13")/28}},{key:"g24",get:function(){return 11*this.eval("g13")/14}},{key:"g27",get:function(){return this.eval("g9")+this.eval("g16")-0}},{key:"g29",get:function(){return this.eval("g9")+this.eval("g21")-0}},{key:"g30",get:function(){return this.eval("g9")+this.eval("g23")-0}},{key:"g31",get:function(){return this.eval("g9")+this.eval("g24")-0}},{key:"g33",get:function(){return this.eval("g11")+this.eval("g15")-0}},{key:"g36",get:function(){return this.eval("g11")+this.eval("g19")-0}},{key:"g37",get:function(){return this.eval("g11")+this.eval("g20")-0}},{key:"g41",get:function(){return 1*this.eval("g13")/14}},{key:"g42",get:function(){return 3*this.eval("g13")/28}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,14,18,22,24,26,28,32,36,40,40,42,46],arguments:["l","t","r","t","r","b","l","b","g33","g27","g16","g16","cd2","cd2","g14","g15",0,"cd4","g41","g42","3cd4",-54e5,"g37","g30","g36","g30","g36","g29","g14","g15","cd2","cd4","g41","g42","cd4",-54e5,"g14","g14",0,-108e5,"hc","g31","g42","g42","3cd4",216e5],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,16,18,20,24,28,32,32,34,38],arguments:["g33","g27","g16","g16","cd2","cd2","g14","g15",0,"cd4","g41","g42","3cd4",-54e5,"g37","g30","g36","g30","g36","g29","g14","g15","cd2","cd4","g41","g42","cd4",-54e5,"g14","g14",0,-108e5,"hc","g31","g42","g42","3cd4",216e5],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,16,18,20,24,28,32,32,34,38],arguments:["g33","g27","g16","g16","cd2","cd2","g14","g15",0,"cd4","g41","g42","3cd4",-54e5,"g37","g30","g36","g30","g36","g29","g14","g15","cd2","cd4","g41","g42","cd4",-54e5,"g14","g14",0,-108e5,"hc","g31","g42","g42","3cd4",216e5],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonHome:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1*this.eval("g13")/16}},{key:"g15",get:function(){return 1*this.eval("g13")/8}},{key:"g16",get:function(){return 3*this.eval("g13")/16}},{key:"g17",get:function(){return 5*this.eval("g13")/16}},{key:"g18",get:function(){return 7*this.eval("g13")/16}},{key:"g19",get:function(){return 9*this.eval("g13")/16}},{key:"g20",get:function(){return 11*this.eval("g13")/16}},{key:"g21",get:function(){return 3*this.eval("g13")/4}},{key:"g22",get:function(){return 13*this.eval("g13")/16}},{key:"g23",get:function(){return 7*this.eval("g13")/8}},{key:"g24",get:function(){return this.eval("g9")+this.eval("g14")-0}},{key:"g25",get:function(){return this.eval("g9")+this.eval("g16")-0}},{key:"g26",get:function(){return this.eval("g9")+this.eval("g17")-0}},{key:"g27",get:function(){return this.eval("g9")+this.eval("g21")-0}},{key:"g28",get:function(){return this.eval("g11")+this.eval("g15")-0}},{key:"g29",get:function(){return this.eval("g11")+this.eval("g18")-0}},{key:"g30",get:function(){return this.eval("g11")+this.eval("g19")-0}},{key:"g31",get:function(){return this.eval("g11")+this.eval("g20")-0}},{key:"g32",get:function(){return this.eval("g11")+this.eval("g22")-0}},{key:"g33",get:function(){return this.eval("g11")+this.eval("g23")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18,20,22,24,26,28,30],arguments:["l","t","r","t","r","b","l","b","hc","g9","g11","vc","g28","vc","g28","g10","g33","g10","g33","vc","g12","vc","g32","g26","g32","g24","g31","g24","g31","g25"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18,20,22,24],arguments:["g32","g26","g32","g24","g31","g24","g31","g25","g28","vc","g28","g10","g29","g10","g29","g27","g30","g27","g30","g10","g33","g10","g33","vc"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,14],arguments:["hc","g9","g11","vc","g12","vc","g29","g27","g30","g27","g30","g10","g29","g10"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,22,24,26,28,30,32,34,36],arguments:["hc","g9","g31","g25","g31","g24","g32","g24","g32","g26","g12","vc","g33","vc","g33","g10","g28","g10","g28","vc","g11","vc","g31","g25","g32","g26","g33","vc","g28","vc","g29","g10","g29","g27","g30","g27","g30","g10"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonInformation:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1*this.eval("g13")/32}},{key:"g17",get:function(){return 5*this.eval("g13")/16}},{key:"g18",get:function(){return 3*this.eval("g13")/8}},{key:"g19",get:function(){return 13*this.eval("g13")/32}},{key:"g20",get:function(){return 19*this.eval("g13")/32}},{key:"g22",get:function(){return 11*this.eval("g13")/16}},{key:"g23",get:function(){return 13*this.eval("g13")/16}},{key:"g24",get:function(){return 7*this.eval("g13")/8}},{key:"g25",get:function(){return this.eval("g9")+this.eval("g14")-0}},{key:"g28",get:function(){return this.eval("g9")+this.eval("g17")-0}},{key:"g29",get:function(){return this.eval("g9")+this.eval("g18")-0}},{key:"g30",get:function(){return this.eval("g9")+this.eval("g23")-0}},{key:"g31",get:function(){return this.eval("g9")+this.eval("g24")-0}},{key:"g32",get:function(){return this.eval("g11")+this.eval("g17")-0}},{key:"g34",get:function(){return this.eval("g11")+this.eval("g19")-0}},{key:"g35",get:function(){return this.eval("g11")+this.eval("g20")-0}},{key:"g37",get:function(){return this.eval("g11")+this.eval("g22")-0}},{key:"g38",get:function(){return 3*this.eval("g13")/32}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,14],arguments:["l","t","r","t","r","b","l","b","hc","g9","dx2","dx2","3cd4",216e5],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,6,8,12,14,16,18,20,22,24,26,28,30,32],arguments:["hc","g9","dx2","dx2","3cd4",216e5,"hc","g25","g38","g38","3cd4",216e5,"g32","g28","g32","g29","g34","g29","g34","g30","g32","g30","g32","g31","g37","g31","g37","g30","g35","g30","g35","g28"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,10,12,14,16,18,20,22,24,26],arguments:["hc","g25","g38","g38","3cd4",216e5,"g32","g28","g35","g28","g35","g30","g37","g30","g37","g31","g32","g31","g32","g30","g34","g30","g34","g29","g32","g29"],attributes:{stroke:!1,fill:G.e.Lighten,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,6,8,12,14,16,18,20,22,24,26,28,30,32],arguments:["hc","g9","dx2","dx2","3cd4",216e5,"hc","g25","g38","g38","3cd4",216e5,"g32","g28","g35","g28","g35","g30","g37","g30","g37","g31","g32","g31","g32","g30","g34","g30","g34","g29","g32","g29"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonMovie:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1455*this.eval("g13")/21600}},{key:"g15",get:function(){return 1905*this.eval("g13")/21600}},{key:"g16",get:function(){return 2325*this.eval("g13")/21600}},{key:"g17",get:function(){return 16155*this.eval("g13")/21600}},{key:"g18",get:function(){return 17010*this.eval("g13")/21600}},{key:"g19",get:function(){return 19335*this.eval("g13")/21600}},{key:"g20",get:function(){return 19725*this.eval("g13")/21600}},{key:"g21",get:function(){return 20595*this.eval("g13")/21600}},{key:"g22",get:function(){return 5280*this.eval("g13")/21600}},{key:"g23",get:function(){return 5730*this.eval("g13")/21600}},{key:"g24",get:function(){return 6630*this.eval("g13")/21600}},{key:"g25",get:function(){return 7492*this.eval("g13")/21600}},{key:"g26",get:function(){return 9067*this.eval("g13")/21600}},{key:"g27",get:function(){return 9555*this.eval("g13")/21600}},{key:"g28",get:function(){return 13342*this.eval("g13")/21600}},{key:"g29",get:function(){return 14580*this.eval("g13")/21600}},{key:"g30",get:function(){return 15592*this.eval("g13")/21600}},{key:"g31",get:function(){return this.eval("g11")+this.eval("g14")-0}},{key:"g32",get:function(){return this.eval("g11")+this.eval("g15")-0}},{key:"g33",get:function(){return this.eval("g11")+this.eval("g16")-0}},{key:"g34",get:function(){return this.eval("g11")+this.eval("g17")-0}},{key:"g35",get:function(){return this.eval("g11")+this.eval("g18")-0}},{key:"g36",get:function(){return this.eval("g11")+this.eval("g19")-0}},{key:"g37",get:function(){return this.eval("g11")+this.eval("g20")-0}},{key:"g38",get:function(){return this.eval("g11")+this.eval("g21")-0}},{key:"g39",get:function(){return this.eval("g9")+this.eval("g22")-0}},{key:"g40",get:function(){return this.eval("g9")+this.eval("g23")-0}},{key:"g41",get:function(){return this.eval("g9")+this.eval("g24")-0}},{key:"g42",get:function(){return this.eval("g9")+this.eval("g25")-0}},{key:"g43",get:function(){return this.eval("g9")+this.eval("g26")-0}},{key:"g44",get:function(){return this.eval("g9")+this.eval("g27")-0}},{key:"g45",get:function(){return this.eval("g9")+this.eval("g28")-0}},{key:"g46",get:function(){return this.eval("g9")+this.eval("g29")-0}},{key:"g47",get:function(){return this.eval("g9")+this.eval("g30")-0}},{key:"g48",get:function(){return this.eval("g9")+this.eval("g31")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46],arguments:["l","t","r","t","r","b","l","b","g11","g39","g11","g44","g31","g44","g32","g43","g33","g43","g33","g47","g35","g47","g35","g45","g36","g45","g38","g46","g12","g46","g12","g41","g38","g41","g37","g42","g35","g42","g35","g41","g34","g40","g32","g40","g31","g39"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38],arguments:["g11","g39","g11","g44","g31","g44","g32","g43","g33","g43","g33","g47","g35","g47","g35","g45","g36","g45","g38","g46","g12","g46","g12","g41","g38","g41","g37","g42","g35","g42","g35","g41","g34","g40","g32","g40","g31","g39"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38],arguments:["g11","g39","g31","g39","g32","g40","g34","g40","g35","g41","g35","g42","g37","g42","g38","g41","g12","g41","g12","g46","g38","g46","g36","g45","g35","g45","g35","g47","g33","g47","g33","g43","g32","g43","g31","g44","g11","g44"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonReturn:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 7*this.eval("g13")/8}},{key:"g15",get:function(){return 3*this.eval("g13")/4}},{key:"g16",get:function(){return 5*this.eval("g13")/8}},{key:"g17",get:function(){return 3*this.eval("g13")/8}},{key:"g18",get:function(){return 1*this.eval("g13")/4}},{key:"g19",get:function(){return this.eval("g9")+this.eval("g15")-0}},{key:"g20",get:function(){return this.eval("g9")+this.eval("g16")-0}},{key:"g21",get:function(){return this.eval("g9")+this.eval("g18")-0}},{key:"g22",get:function(){return this.eval("g11")+this.eval("g14")-0}},{key:"g23",get:function(){return this.eval("g11")+this.eval("g15")-0}},{key:"g24",get:function(){return this.eval("g11")+this.eval("g16")-0}},{key:"g25",get:function(){return this.eval("g11")+this.eval("g17")-0}},{key:"g26",get:function(){return this.eval("g11")+this.eval("g18")-0}},{key:"g27",get:function(){return 1*this.eval("g13")/8}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18,22,24,28,30,32,34,38,40,44,46],arguments:["l","t","r","t","r","b","l","b","g12","g21","g23","g9","hc","g21","g24","g21","g24","g20","g27","g27",0,"cd4","g25","g19","g27","g27","cd4","cd4","g26","g21","g11","g21","g11","g20","g17","g17","cd2",-54e5,"hc","g10","g17","g17","cd4",-54e5,"g22","g21"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,14,16,20,22,24,26,30,32,36,38],arguments:["g12","g21","g23","g9","hc","g21","g24","g21","g24","g20","g27","g27",0,"cd4","g25","g19","g27","g27","cd4","cd4","g26","g21","g11","g21","g11","g20","g17","g17","cd2",-54e5,"hc","g10","g17","g17","cd4",-54e5,"g22","g21"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,12,16,18,20,22,26,28,32,34,36,38],arguments:["g12","g21","g22","g21","g22","g20","g17","g17",0,"cd4","g25","g10","g17","g17","cd4","cd4","g11","g21","g26","g21","g26","g20","g27","g27","cd2",-54e5,"hc","g19","g27","g27","cd4",-54e5,"g24","g21","hc","g21","g23","g9"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},actionButtonSound:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx2",get:function(){return 3*this.eval("ss")/8}},{key:"g9",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"g10",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"g11",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"g12",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"g13",get:function(){return 3*this.eval("ss")/4}},{key:"g14",get:function(){return 1*this.eval("g13")/8}},{key:"g15",get:function(){return 5*this.eval("g13")/16}},{key:"g16",get:function(){return 5*this.eval("g13")/8}},{key:"g17",get:function(){return 11*this.eval("g13")/16}},{key:"g18",get:function(){return 3*this.eval("g13")/4}},{key:"g19",get:function(){return 7*this.eval("g13")/8}},{key:"g20",get:function(){return this.eval("g9")+this.eval("g14")-0}},{key:"g21",get:function(){return this.eval("g9")+this.eval("g15")-0}},{key:"g22",get:function(){return this.eval("g9")+this.eval("g17")-0}},{key:"g23",get:function(){return this.eval("g9")+this.eval("g19")-0}},{key:"g24",get:function(){return this.eval("g11")+this.eval("g15")-0}},{key:"g25",get:function(){return this.eval("g11")+this.eval("g16")-0}},{key:"g26",get:function(){return this.eval("g11")+this.eval("g18")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,18,20],arguments:["l","t","r","t","r","b","l","b","g11","g21","g11","g22","g24","g22","g25","g10","g25","g9","g24","g21"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["g11","g21","g11","g22","g24","g22","g25","g10","g25","g9","g24","g21"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,12,12,14,16,18,20,22],arguments:["g11","g21","g24","g21","g25","g9","g25","g10","g24","g22","g11","g22","g26","g21","g12","g20","g26","vc","g12","vc","g26","g22","g12","g23"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{fill:G.e.None}}]},arc:{adjustValues:{adj1:162e5,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj1"),21599999)}},{key:"enAng",get:function(){return this.pinTo(0,this.eval("adj2"),21599999)}},{key:"sw11",get:function(){return this.eval("enAng")+0-this.eval("stAng")}},{key:"sw12",get:function(){return this.eval("sw11")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw11")>0?this.eval("sw11"):this.eval("sw12")}},{key:"wt1",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"ht1",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"wt2",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"ht2",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"dy2",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"sw0",get:function(){return 216e5-this.eval("stAng")}},{key:"da1",get:function(){return this.eval("swAng")+0-this.eval("sw0")}},{key:"g1",get:function(){return Math.max(this.eval("x1"),this.eval("x2"))}},{key:"ir",get:function(){return this.eval("da1")>0?this.eval("r"):this.eval("g1")}},{key:"sw1",get:function(){return this.eval("cd4")+0-this.eval("stAng")}},{key:"sw2",get:function(){return 27e6-this.eval("stAng")}},{key:"sw3",get:function(){return this.eval("sw1")>0?this.eval("sw1"):this.eval("sw2")}},{key:"da2",get:function(){return this.eval("swAng")+0-this.eval("sw3")}},{key:"g5",get:function(){return Math.max(this.eval("y1"),this.eval("y2"))}},{key:"ib",get:function(){return this.eval("da2")>0?this.eval("b"):this.eval("g5")}},{key:"sw4",get:function(){return this.eval("cd2")+0-this.eval("stAng")}},{key:"sw5",get:function(){return 324e5-this.eval("stAng")}},{key:"sw6",get:function(){return this.eval("sw4")>0?this.eval("sw4"):this.eval("sw5")}},{key:"da3",get:function(){return this.eval("swAng")+0-this.eval("sw6")}},{key:"g9",get:function(){return Math.min(this.eval("x1"),this.eval("x2"))}},{key:"il",get:function(){return this.eval("da3")>0?this.eval("l"):this.eval("g9")}},{key:"sw7",get:function(){return this.eval("3cd4")+0-this.eval("stAng")}},{key:"sw8",get:function(){return 378e5-this.eval("stAng")}},{key:"sw9",get:function(){return this.eval("sw7")>0?this.eval("sw7"):this.eval("sw8")}},{key:"da4",get:function(){return this.eval("swAng")+0-this.eval("sw9")}},{key:"g13",get:function(){return Math.min(this.eval("y1"),this.eval("y2"))}},{key:"it",get:function(){return this.eval("da4")>0?this.eval("t"):this.eval("g13")}},{key:"cang1",get:function(){return this.eval("stAng")+0-this.eval("cd4")}},{key:"cang2",get:function(){return this.eval("enAng")+this.eval("cd4")-0}},{key:"cang3",get:function(){return(this.eval("cang1")+this.eval("cang2"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"x1",y:"y1",gdRefAng:"adj1",minAng:0,maxAng:21599999},{isPolar:!0,x:"x2",y:"y2",gdRefAng:"adj2",minAng:0,maxAng:21599999}],connectionSites:[{angle:"cang1",x:"x1",y:"y1"},{angle:"cang3",x:"hc",y:"vc"},{angle:"cang2",x:"x2",y:"y2"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8],arguments:["x1","y1","wd2","hd2","stAng","swAng","hc","vc"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2],arguments:["x1","y1","wd2","hd2","stAng","swAng"],attributes:{fill:G.e.None}}]},bentArrow:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:43750},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),5e4)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"dh2",get:function(){return this.eval("aw2")+0-this.eval("th2")}},{key:"ah",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"bw",get:function(){return this.eval("r")+0-this.eval("ah")}},{key:"bh",get:function(){return this.eval("b")+0-this.eval("dh2")}},{key:"bs",get:function(){return Math.min(this.eval("bw"),this.eval("bh"))}},{key:"maxAdj4",get:function(){return 1e5*this.eval("bs")/this.eval("ss")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"bd",get:function(){return this.eval("ss")*this.eval("a4")/1e5}},{key:"bd3",get:function(){return this.eval("bd")+0-this.eval("th")}},{key:"bd2",get:function(){return Math.max(this.eval("bd3"),0)}},{key:"x3",get:function(){return this.eval("th")+this.eval("bd2")-0}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("ah")}},{key:"y3",get:function(){return this.eval("dh2")+this.eval("th")-0}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dh2")-0}},{key:"y5",get:function(){return this.eval("dh2")+this.eval("bd")-0}},{key:"y6",get:function(){return this.eval("y3")+this.eval("bd2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"th",y:"b",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"r",y:"y4",gdRefY:"adj2",minY:0,maxY:5e4},{isPolar:!1,x:"x4",y:"t",gdRefX:"adj3",minX:0,maxX:5e4},{isPolar:!1,x:"bd",y:"t",gdRefX:"adj4",minX:0,maxX:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"x4",y:"t"},{angle:"cd4",x:"x4",y:"y4"},{angle:"cd4",x:"th2",y:"b"},{angle:0,x:"r",y:"aw2"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10,12,14,16,18,20,24,26],arguments:["l","b","l","y5","bd","bd","cd2","cd4","x4","dh2","x4","t","r","aw2","x4","y4","x4","y3","x3","y3","bd2","bd2","3cd4",-54e5,"th","b"],attributes:{}}]},bentConnector2:{textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4],arguments:["l","t","r","t","r","b"],attributes:{fill:G.e.None}}]},bentConnector3:{adjustValues:{adj1:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x1",get:function(){return this.eval("w")*this.eval("adj1")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"vc",gdRefX:"adj1",minX:-2147483647,maxX:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["l","t","x1","t","x1","b","r","b"],attributes:{fill:G.e.None}}]},bentConnector4:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x1",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"x2",get:function(){return(this.eval("x1")+this.eval("r"))/2}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"y1",get:function(){return(this.eval("t")+this.eval("y2"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj1",minX:-2147483647,maxX:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6,8],arguments:["l","t","x1","t","x1","y2","r","y2","r","b"],attributes:{fill:G.e.None}}]},bentConnector5:{adjustValues:{adj1:5e4,adj2:5e4,adj3:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x1",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return(this.eval("x1")+this.eval("x3"))/2}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"y1",get:function(){return(this.eval("t")+this.eval("y2"))/2}},{key:"y3",get:function(){return(this.eval("b")+this.eval("y2"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj1",minX:-2147483647,maxX:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefY:"adj2",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj3",minX:-2147483647,maxX:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10],arguments:["l","t","x1","t","x1","y2","x3","y2","x3","b","r","b"],attributes:{fill:G.e.None}}]},bentUpArrow:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),5e4)}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a2")/5e4}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("dx3")}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x2",get:function(){return this.eval("x3")+0-this.eval("dx2")}},{key:"x4",get:function(){return this.eval("x3")+this.eval("dx2")-0}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"x0",get:function(){return 1*this.eval("x4")/2}},{key:"y3",get:function(){return(this.eval("y2")+this.eval("b"))/2}},{key:"y15",get:function(){return(this.eval("y1")+this.eval("b"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y2",gdRefY:"adj1",minY:0,maxY:5e4},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:5e4},{isPolar:!1,x:"x2",y:"y1",gdRefY:"adj3",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"cd2",x:"x1",y:"y1"},{angle:"cd2",x:"l",y:"y3"},{angle:"cd4",x:"x0",y:"b"},{angle:0,x:"x4",y:"y15"},{angle:0,x:"r",y:"y1"}],textBoxRect:{left:"l",top:"y2",right:"x4",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18],arguments:["l","y2","x2","y2","x2","y1","x1","y1","x3","t","r","y1","x4","y1","x4","b","l","b"],attributes:{}}]},bevel:{adjustValues:{adj:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:0,x:"x2",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"hc",y:"y2"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"hc",y:"x1"}],textBoxRect:{left:"x1",top:"x1",right:"x2",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["x1","x1","x2","x1","x2","y2","x1","y2"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","x2","x1","x1","x1"],attributes:{stroke:!1,fill:G.e.LightenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","b","x1","y2","x2","y2","r","b"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","x1","x1","x1","y2","l","b"],attributes:{stroke:!1,fill:G.e.Lighten,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["r","t","r","b","x2","y2","x2","x1"],attributes:{stroke:!1,fill:G.e.Darken,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,8,10,12,14,16,16,18,20,22,24,26,28,30],arguments:["l","t","r","t","r","b","l","b","x1","x1","x2","x1","x2","y2","x1","y2","l","t","x1","x1","l","b","x1","y2","r","t","x2","x1","r","b","x2","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},blockArc:{adjustValues:{adj1:108e5,adj2:0,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj1"),21599999)}},{key:"istAng",get:function(){return this.pinTo(0,this.eval("adj2"),21599999)}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),5e4)}},{key:"sw11",get:function(){return this.eval("istAng")+0-this.eval("stAng")}},{key:"sw12",get:function(){return this.eval("sw11")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw11")>0?this.eval("sw11"):this.eval("sw12")}},{key:"iswAng",get:function(){return 0-this.eval("swAng")}},{key:"wt1",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"ht1",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"wt3",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("istAng")))}},{key:"ht3",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("istAng")))}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"dx3",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt3"),this.eval("ht3")))}},{key:"dy3",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt3"),this.eval("ht3")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy3")-0}},{key:"dr",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"iwd2",get:function(){return this.eval("wd2")+0-this.eval("dr")}},{key:"ihd2",get:function(){return this.eval("hd2")+0-this.eval("dr")}},{key:"wt2",get:function(){return this.eval("iwd2")*Math.sin(this.angleToRadian(this.eval("istAng")))}},{key:"ht2",get:function(){return this.eval("ihd2")*Math.cos(this.angleToRadian(this.eval("istAng")))}},{key:"wt4",get:function(){return this.eval("iwd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"ht4",get:function(){return this.eval("ihd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dx2",get:function(){return this.eval("iwd2")*Math.cos(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"dy2",get:function(){return this.eval("ihd2")*Math.sin(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"dx4",get:function(){return this.eval("iwd2")*Math.cos(Math.atan2(this.eval("wt4"),this.eval("ht4")))}},{key:"dy4",get:function(){return this.eval("ihd2")*Math.sin(Math.atan2(this.eval("wt4"),this.eval("ht4")))}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx4")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy4")-0}},{key:"sw0",get:function(){return 216e5-this.eval("stAng")}},{key:"da1",get:function(){return this.eval("swAng")+0-this.eval("sw0")}},{key:"g1",get:function(){return Math.max(this.eval("x1"),this.eval("x2"))}},{key:"g2",get:function(){return Math.max(this.eval("x3"),this.eval("x4"))}},{key:"g3",get:function(){return Math.max(this.eval("g1"),this.eval("g2"))}},{key:"ir",get:function(){return this.eval("da1")>0?this.eval("r"):this.eval("g3")}},{key:"sw1",get:function(){return this.eval("cd4")+0-this.eval("stAng")}},{key:"sw2",get:function(){return 27e6-this.eval("stAng")}},{key:"sw3",get:function(){return this.eval("sw1")>0?this.eval("sw1"):this.eval("sw2")}},{key:"da2",get:function(){return this.eval("swAng")+0-this.eval("sw3")}},{key:"g5",get:function(){return Math.max(this.eval("y1"),this.eval("y2"))}},{key:"g6",get:function(){return Math.max(this.eval("y3"),this.eval("y4"))}},{key:"g7",get:function(){return Math.max(this.eval("g5"),this.eval("g6"))}},{key:"ib",get:function(){return this.eval("da2")>0?this.eval("b"):this.eval("g7")}},{key:"sw4",get:function(){return this.eval("cd2")+0-this.eval("stAng")}},{key:"sw5",get:function(){return 324e5-this.eval("stAng")}},{key:"sw6",get:function(){return this.eval("sw4")>0?this.eval("sw4"):this.eval("sw5")}},{key:"da3",get:function(){return this.eval("swAng")+0-this.eval("sw6")}},{key:"g9",get:function(){return Math.min(this.eval("x1"),this.eval("x2"))}},{key:"g10",get:function(){return Math.min(this.eval("x3"),this.eval("x4"))}},{key:"g11",get:function(){return Math.min(this.eval("g9"),this.eval("g10"))}},{key:"il",get:function(){return this.eval("da3")>0?this.eval("l"):this.eval("g11")}},{key:"sw7",get:function(){return this.eval("3cd4")+0-this.eval("stAng")}},{key:"sw8",get:function(){return 378e5-this.eval("stAng")}},{key:"sw9",get:function(){return this.eval("sw7")>0?this.eval("sw7"):this.eval("sw8")}},{key:"da4",get:function(){return this.eval("swAng")+0-this.eval("sw9")}},{key:"g13",get:function(){return Math.min(this.eval("y1"),this.eval("y2"))}},{key:"g14",get:function(){return Math.min(this.eval("y3"),this.eval("y4"))}},{key:"g15",get:function(){return Math.min(this.eval("g13"),this.eval("g14"))}},{key:"it",get:function(){return this.eval("da4")>0?this.eval("t"):this.eval("g15")}},{key:"x5",get:function(){return(this.eval("x1")+this.eval("x4"))/2}},{key:"y5",get:function(){return(this.eval("y1")+this.eval("y4"))/2}},{key:"x6",get:function(){return(this.eval("x3")+this.eval("x2"))/2}},{key:"y6",get:function(){return(this.eval("y3")+this.eval("y2"))/2}},{key:"cang1",get:function(){return this.eval("stAng")+0-this.eval("cd4")}},{key:"cang2",get:function(){return this.eval("istAng")+this.eval("cd4")-0}},{key:"cang3",get:function(){return(this.eval("cang1")+this.eval("cang2"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"x1",y:"y1",gdRefAng:"adj1",minAng:0,maxAng:21599999},{isPolar:!0,x:"x2",y:"y2",gdRefR:"adj3",minR:0,maxR:5e4,gdRefAng:"adj2",minAng:0,maxAng:21599999}],connectionSites:[{angle:"cang1",x:"x5",y:"y5"},{angle:"cang2",x:"x6",y:"y6"},{angle:"cang3",x:"hc",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["x1","y1","wd2","hd2","stAng","swAng","x2","y2","iwd2","ihd2","istAng","iswAng"],attributes:{}}]},borderCallout1:{adjustValues:{adj1:18750,adj2:-8333,adj3:112500,adj4:-38333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["x1","y1","x2","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},borderCallout2:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:112500,adj6:-46667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4],arguments:["x1","y1","x2","y2","x3","y3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},borderCallout3:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:1e5,adj6:-16667,adj7:112963,adj8:-8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj7")/1e5}},{key:"x4",get:function(){return this.eval("w")*this.eval("adj8")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x4",y:"y4",gdRefX:"adj8",minX:-2147483647,maxX:2147483647,gdRefY:"adj7",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["x1","y1","x2","y2","x3","y3","x4","y4"],attributes:{fill:G.e.None,extrusionOk:!1}}]},bracePair:{adjustValues:{adj:8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),25e3)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("ss")*this.eval("a")/5e4}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("x1")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("x1")-0}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"it",get:function(){return 29289*this.eval("x1")/1e5}},{key:"il",get:function(){return this.eval("x1")+this.eval("it")-0}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("it")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"x1",gdRefY:"adj",minY:0,maxY:25e3}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,16,18,22,24,28,30,34,38,40,44],arguments:["x2","b","x1","x1","cd4","cd4","x1","y3","x1","x1",0,-54e5,"x1","x1","cd4",-54e5,"x1","x1","x1","x1","cd2","cd4","x3","t","x1","x1","3cd4","cd4","x4","y2","x1","x1","cd2",-54e5,"x1","x1","3cd4",-54e5,"x4","y4","x1","x1",0,"cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,16,18,22,24,28,30,34,38,40],arguments:["x2","b","x1","x1","cd4","cd4","x1","y3","x1","x1",0,-54e5,"x1","x1","cd4",-54e5,"x1","x1","x1","x1","cd2","cd4","x3","t","x1","x1","3cd4","cd4","x4","y2","x1","x1","cd2",-54e5,"x1","x1","3cd4",-54e5,"x4","y4","x1","x1",0,"cd4"],attributes:{fill:G.e.None}}]},bracketPair:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"il",get:function(){return 29289*this.eval("x1")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"x1",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,24],arguments:["l","x1","x1","x1","cd2","cd4","x2","t","x1","x1","3cd4","cd4","r","y2","x1","x1",0,"cd4","x1","b","x1","x1","cd4","cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,14,18,20],arguments:["x1","b","x1","x1","cd4","cd4","l","x1","x1","x1","cd2","cd4","x2","t","x1","x1","3cd4","cd4","r","y2","x1","x1",0,"cd4"],attributes:{fill:G.e.None}}]},callout1:{adjustValues:{adj1:18750,adj2:-8333,adj3:112500,adj4:-38333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["x1","y1","x2","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},callout2:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:112500,adj6:-46667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4],arguments:["x1","y1","x2","y2","x3","y3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},callout3:{adjustValues:{adj1:18750,adj2:-8333,adj3:18750,adj4:-16667,adj5:1e5,adj6:-16667,adj7:112963,adj8:-8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return this.eval("h")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return this.eval("w")*this.eval("adj2")/1e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("adj3")/1e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("adj4")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("adj5")/1e5}},{key:"x3",get:function(){return this.eval("w")*this.eval("adj6")/1e5}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj7")/1e5}},{key:"x4",get:function(){return this.eval("w")*this.eval("adj8")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y1",gdRefX:"adj2",minX:-2147483647,maxX:2147483647,gdRefY:"adj1",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x2",y:"y2",gdRefX:"adj4",minX:-2147483647,maxX:2147483647,gdRefY:"adj3",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x3",y:"y3",gdRefX:"adj6",minX:-2147483647,maxX:2147483647,gdRefY:"adj5",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x4",y:"y4",gdRefX:"adj8",minX:-2147483647,maxX:2147483647,gdRefY:"adj7",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["x1","y1","x2","y2","x3","y3","x4","y4"],attributes:{fill:G.e.None,extrusionOk:!1}}]},can:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a")/2e5}},{key:"y2",get:function(){return this.eval("y1")+this.eval("y1")-0}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y2",gdRefY:"adj",minY:0,maxY:"maxAdj"}],connectionSites:[{angle:"3cd4",x:"hc",y:"y2"},{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"y2",right:"r",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["l","y1","wd2","y1","cd2",-108e5,"r","y3","wd2","y1",0,"cd2"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10],arguments:["l","y1","wd2","y1","cd2","cd2","wd2","y1",0,"cd2"],attributes:{stroke:!1,fill:G.e.Lighten,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo],argumentIndices:[0,2,6,10,12,16],arguments:["r","y1","wd2","y1",0,"cd2","wd2","y1","cd2","cd2","r","y3","wd2","y1",0,"cd2","l","y1"],attributes:{fill:G.e.None,extrusionOk:!1}}]},chartPlus:{paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:[5,0,5,10,0,5,10,5],attributes:{w:10,h:10,fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,0,10,10,10,10,0],attributes:{w:10,h:10,stroke:!1}}]},chartStar:{paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10],arguments:[0,0,10,10,0,10,10,0,5,0,5,10],attributes:{w:10,h:10,fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,0,10,10,10,10,0],attributes:{w:10,h:10,stroke:!1}}]},chartX:{paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:[0,0,10,10,0,10,10,0],attributes:{w:10,h:10,fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,0,10,10,10,10,0],attributes:{w:10,h:10,stroke:!1}}]},chevron:{adjustValues:{adj:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"x3",get:function(){return 1*this.eval("x2")/2}},{key:"dx",get:function(){return this.eval("x2")+0-this.eval("x1")}},{key:"il",get:function(){return this.eval("dx")>0?this.eval("x1"):this.eval("l")}},{key:"ir",get:function(){return this.eval("dx")>0?this.eval("x2"):this.eval("r")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"t",gdRefX:"adj",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"cd2",x:"x1",y:"vc"},{angle:"cd4",x:"x3",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"t",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["l","t","x2","t","r","vc","x2","b","l","b","x1","vc"],attributes:{}}]},chord:{adjustValues:{adj1:27e5,adj2:162e5},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj1"),21599999)}},{key:"enAng",get:function(){return this.pinTo(0,this.eval("adj2"),21599999)}},{key:"sw1",get:function(){return this.eval("enAng")+0-this.eval("stAng")}},{key:"sw2",get:function(){return this.eval("sw1")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw1")>0?this.eval("sw1"):this.eval("sw2")}},{key:"wt1",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"ht1",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"wt2",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"ht2",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"dy2",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"x3",get:function(){return(this.eval("x1")+this.eval("x2"))/2}},{key:"y3",get:function(){return(this.eval("y1")+this.eval("y2"))/2}},{key:"midAng0",get:function(){return 1*this.eval("swAng")/2}},{key:"midAng",get:function(){return this.eval("stAng")+this.eval("midAng0")-this.eval("cd2")}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"x1",y:"y1",gdRefAng:"adj1",minAng:0,maxAng:21599999},{isPolar:!0,x:"x2",y:"y2",gdRefAng:"adj2",minAng:0,maxAng:21599999}],connectionSites:[{angle:"stAng",x:"x1",y:"y1"},{angle:"enAng",x:"x2",y:"y2"},{angle:"midAng",x:"x3",y:"y3"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["x1","y1","wd2","hd2","stAng","swAng"],attributes:{}}]},circularArrow:{adjustValues:{adj1:12500,adj2:1142319,adj3:20457681,adj4:108e5,adj5:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a5",get:function(){return this.pinTo(0,this.eval("adj5"),25e3)}},{key:"maxAdj1",get:function(){return 2*this.eval("a5")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"enAng",get:function(){return this.pinTo(1,this.eval("adj3"),21599999)}},{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj4"),21599999)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"thh",get:function(){return this.eval("ss")*this.eval("a5")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"rw1",get:function(){return this.eval("wd2")+this.eval("th2")-this.eval("thh")}},{key:"rh1",get:function(){return this.eval("hd2")+this.eval("th2")-this.eval("thh")}},{key:"rw2",get:function(){return this.eval("rw1")+0-this.eval("th")}},{key:"rh2",get:function(){return this.eval("rh1")+0-this.eval("th")}},{key:"rw3",get:function(){return this.eval("rw2")+this.eval("th2")-0}},{key:"rh3",get:function(){return this.eval("rh2")+this.eval("th2")-0}},{key:"wtH",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"htH",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dxH",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"dyH",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"xH",get:function(){return this.eval("hc")+this.eval("dxH")-0}},{key:"yH",get:function(){return this.eval("vc")+this.eval("dyH")-0}},{key:"rI",get:function(){return Math.min(this.eval("rw2"),this.eval("rh2"))}},{key:"u1",get:function(){return this.eval("dxH")*this.eval("dxH")/1}},{key:"u2",get:function(){return this.eval("dyH")*this.eval("dyH")/1}},{key:"u3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"u4",get:function(){return this.eval("u1")+0-this.eval("u3")}},{key:"u5",get:function(){return this.eval("u2")+0-this.eval("u3")}},{key:"u6",get:function(){return this.eval("u4")*this.eval("u5")/this.eval("u1")}},{key:"u7",get:function(){return 1*this.eval("u6")/this.eval("u2")}},{key:"u8",get:function(){return 1-this.eval("u7")}},{key:"u9",get:function(){return Math.sqrtFix(this.eval("u8"))}},{key:"u10",get:function(){return 1*this.eval("u4")/this.eval("dxH")}},{key:"u11",get:function(){return 1*this.eval("u10")/this.eval("dyH")}},{key:"u12",get:function(){return(1+this.eval("u9"))/this.eval("u11")}},{key:"u13",get:function(){return this.radianToAngle(Math.atan2(this.eval("u12"),1))}},{key:"u14",get:function(){return this.eval("u13")+216e5-0}},{key:"u15",get:function(){return this.eval("u13")>0?this.eval("u13"):this.eval("u14")}},{key:"u16",get:function(){return this.eval("u15")+0-this.eval("enAng")}},{key:"u17",get:function(){return this.eval("u16")+216e5-0}},{key:"u18",get:function(){return this.eval("u16")>0?this.eval("u16"):this.eval("u17")}},{key:"u19",get:function(){return this.eval("u18")+0-this.eval("cd2")}},{key:"u20",get:function(){return this.eval("u18")+0-216e5}},{key:"u21",get:function(){return this.eval("u19")>0?this.eval("u20"):this.eval("u18")}},{key:"maxAng",get:function(){return Math.abs(this.eval("u21"))}},{key:"aAng",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAng"))}},{key:"ptAng",get:function(){return this.eval("enAng")+this.eval("aAng")-0}},{key:"wtA",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"htA",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dxA",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"dyA",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"xA",get:function(){return this.eval("hc")+this.eval("dxA")-0}},{key:"yA",get:function(){return this.eval("vc")+this.eval("dyA")-0}},{key:"wtE",get:function(){return this.eval("rw1")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htE",get:function(){return this.eval("rh1")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxE",get:function(){return this.eval("rw1")*Math.cos(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"dyE",get:function(){return this.eval("rh1")*Math.sin(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"xE",get:function(){return this.eval("hc")+this.eval("dxE")-0}},{key:"yE",get:function(){return this.eval("vc")+this.eval("dyE")-0}},{key:"dxG",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyG",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xG",get:function(){return this.eval("xH")+this.eval("dxG")-0}},{key:"yG",get:function(){return this.eval("yH")+this.eval("dyG")-0}},{key:"dxB",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyB",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xB",get:function(){return this.eval("xH")+0-this.eval("dxB")}},{key:"yB",get:function(){return this.eval("yH")+0-this.eval("dyB")}},{key:"sx1",get:function(){return this.eval("xB")+0-this.eval("hc")}},{key:"sy1",get:function(){return this.eval("yB")+0-this.eval("vc")}},{key:"sx2",get:function(){return this.eval("xG")+0-this.eval("hc")}},{key:"sy2",get:function(){return this.eval("yG")+0-this.eval("vc")}},{key:"rO",get:function(){return Math.min(this.eval("rw1"),this.eval("rh1"))}},{key:"x1O",get:function(){return this.eval("sx1")*this.eval("rO")/this.eval("rw1")}},{key:"y1O",get:function(){return this.eval("sy1")*this.eval("rO")/this.eval("rh1")}},{key:"x2O",get:function(){return this.eval("sx2")*this.eval("rO")/this.eval("rw1")}},{key:"y2O",get:function(){return this.eval("sy2")*this.eval("rO")/this.eval("rh1")}},{key:"dxO",get:function(){return this.eval("x2O")+0-this.eval("x1O")}},{key:"dyO",get:function(){return this.eval("y2O")+0-this.eval("y1O")}},{key:"dO",get:function(){return this.modulo(this.eval("dxO"),this.eval("dyO"),0)}},{key:"q1",get:function(){return this.eval("x1O")*this.eval("y2O")/1}},{key:"q2",get:function(){return this.eval("x2O")*this.eval("y1O")/1}},{key:"DO",get:function(){return this.eval("q1")+0-this.eval("q2")}},{key:"q3",get:function(){return this.eval("rO")*this.eval("rO")/1}},{key:"q4",get:function(){return this.eval("dO")*this.eval("dO")/1}},{key:"q5",get:function(){return this.eval("q3")*this.eval("q4")/1}},{key:"q6",get:function(){return this.eval("DO")*this.eval("DO")/1}},{key:"q7",get:function(){return this.eval("q5")+0-this.eval("q6")}},{key:"q8",get:function(){return Math.max(this.eval("q7"),0)}},{key:"sdelO",get:function(){return Math.sqrtFix(this.eval("q8"))}},{key:"ndyO",get:function(){return-1*this.eval("dyO")/1}},{key:"sdyO",get:function(){return this.eval("ndyO")>0?-1:1}},{key:"q9",get:function(){return this.eval("sdyO")*this.eval("dxO")/1}},{key:"q10",get:function(){return this.eval("q9")*this.eval("sdelO")/1}},{key:"q11",get:function(){return this.eval("DO")*this.eval("dyO")/1}},{key:"dxF1",get:function(){return(this.eval("q11")+this.eval("q10"))/this.eval("q4")}},{key:"q12",get:function(){return this.eval("q11")+0-this.eval("q10")}},{key:"dxF2",get:function(){return 1*this.eval("q12")/this.eval("q4")}},{key:"adyO",get:function(){return Math.abs(this.eval("dyO"))}},{key:"q13",get:function(){return this.eval("adyO")*this.eval("sdelO")/1}},{key:"q14",get:function(){return this.eval("DO")*this.eval("dxO")/-1}},{key:"dyF1",get:function(){return(this.eval("q14")+this.eval("q13"))/this.eval("q4")}},{key:"q15",get:function(){return this.eval("q14")+0-this.eval("q13")}},{key:"dyF2",get:function(){return 1*this.eval("q15")/this.eval("q4")}},{key:"q16",get:function(){return this.eval("x2O")+0-this.eval("dxF1")}},{key:"q17",get:function(){return this.eval("x2O")+0-this.eval("dxF2")}},{key:"q18",get:function(){return this.eval("y2O")+0-this.eval("dyF1")}},{key:"q19",get:function(){return this.eval("y2O")+0-this.eval("dyF2")}},{key:"q20",get:function(){return this.modulo(this.eval("q16"),this.eval("q18"),0)}},{key:"q21",get:function(){return this.modulo(this.eval("q17"),this.eval("q19"),0)}},{key:"q22",get:function(){return this.eval("q21")+0-this.eval("q20")}},{key:"dxF",get:function(){return this.eval("q22")>0?this.eval("dxF1"):this.eval("dxF2")}},{key:"dyF",get:function(){return this.eval("q22")>0?this.eval("dyF1"):this.eval("dyF2")}},{key:"sdxF",get:function(){return this.eval("dxF")*this.eval("rw1")/this.eval("rO")}},{key:"sdyF",get:function(){return this.eval("dyF")*this.eval("rh1")/this.eval("rO")}},{key:"xF",get:function(){return this.eval("hc")+this.eval("sdxF")-0}},{key:"yF",get:function(){return this.eval("vc")+this.eval("sdyF")-0}},{key:"x1I",get:function(){return this.eval("sx1")*this.eval("rI")/this.eval("rw2")}},{key:"y1I",get:function(){return this.eval("sy1")*this.eval("rI")/this.eval("rh2")}},{key:"x2I",get:function(){return this.eval("sx2")*this.eval("rI")/this.eval("rw2")}},{key:"y2I",get:function(){return this.eval("sy2")*this.eval("rI")/this.eval("rh2")}},{key:"dxI",get:function(){return this.eval("x2I")+0-this.eval("x1I")}},{key:"dyI",get:function(){return this.eval("y2I")+0-this.eval("y1I")}},{key:"dI",get:function(){return this.modulo(this.eval("dxI"),this.eval("dyI"),0)}},{key:"v1",get:function(){return this.eval("x1I")*this.eval("y2I")/1}},{key:"v2",get:function(){return this.eval("x2I")*this.eval("y1I")/1}},{key:"DI",get:function(){return this.eval("v1")+0-this.eval("v2")}},{key:"v3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"v4",get:function(){return this.eval("dI")*this.eval("dI")/1}},{key:"v5",get:function(){return this.eval("v3")*this.eval("v4")/1}},{key:"v6",get:function(){return this.eval("DI")*this.eval("DI")/1}},{key:"v7",get:function(){return this.eval("v5")+0-this.eval("v6")}},{key:"v8",get:function(){return Math.max(this.eval("v7"),0)}},{key:"sdelI",get:function(){return Math.sqrtFix(this.eval("v8"))}},{key:"v9",get:function(){return this.eval("sdyO")*this.eval("dxI")/1}},{key:"v10",get:function(){return this.eval("v9")*this.eval("sdelI")/1}},{key:"v11",get:function(){return this.eval("DI")*this.eval("dyI")/1}},{key:"dxC1",get:function(){return(this.eval("v11")+this.eval("v10"))/this.eval("v4")}},{key:"v12",get:function(){return this.eval("v11")+0-this.eval("v10")}},{key:"dxC2",get:function(){return 1*this.eval("v12")/this.eval("v4")}},{key:"adyI",get:function(){return Math.abs(this.eval("dyI"))}},{key:"v13",get:function(){return this.eval("adyI")*this.eval("sdelI")/1}},{key:"v14",get:function(){return this.eval("DI")*this.eval("dxI")/-1}},{key:"dyC1",get:function(){return(this.eval("v14")+this.eval("v13"))/this.eval("v4")}},{key:"v15",get:function(){return this.eval("v14")+0-this.eval("v13")}},{key:"dyC2",get:function(){return 1*this.eval("v15")/this.eval("v4")}},{key:"v16",get:function(){return this.eval("x1I")+0-this.eval("dxC1")}},{key:"v17",get:function(){return this.eval("x1I")+0-this.eval("dxC2")}},{key:"v18",get:function(){return this.eval("y1I")+0-this.eval("dyC1")}},{key:"v19",get:function(){return this.eval("y1I")+0-this.eval("dyC2")}},{key:"v20",get:function(){return this.modulo(this.eval("v16"),this.eval("v18"),0)}},{key:"v21",get:function(){return this.modulo(this.eval("v17"),this.eval("v19"),0)}},{key:"v22",get:function(){return this.eval("v21")+0-this.eval("v20")}},{key:"dxC",get:function(){return this.eval("v22")>0?this.eval("dxC1"):this.eval("dxC2")}},{key:"dyC",get:function(){return this.eval("v22")>0?this.eval("dyC1"):this.eval("dyC2")}},{key:"sdxC",get:function(){return this.eval("dxC")*this.eval("rw2")/this.eval("rI")}},{key:"sdyC",get:function(){return this.eval("dyC")*this.eval("rh2")/this.eval("rI")}},{key:"xC",get:function(){return this.eval("hc")+this.eval("sdxC")-0}},{key:"yC",get:function(){return this.eval("vc")+this.eval("sdyC")-0}},{key:"ist0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyC"),this.eval("sdxC")))}},{key:"ist1",get:function(){return this.eval("ist0")+216e5-0}},{key:"istAng",get:function(){return this.eval("ist0")>0?this.eval("ist0"):this.eval("ist1")}},{key:"isw1",get:function(){return this.eval("stAng")+0-this.eval("istAng")}},{key:"isw2",get:function(){return this.eval("isw1")+0-216e5}},{key:"iswAng",get:function(){return this.eval("isw1")>0?this.eval("isw2"):this.eval("isw1")}},{key:"p1",get:function(){return this.eval("xF")+0-this.eval("xC")}},{key:"p2",get:function(){return this.eval("yF")+0-this.eval("yC")}},{key:"p3",get:function(){return this.modulo(this.eval("p1"),this.eval("p2"),0)}},{key:"p4",get:function(){return 1*this.eval("p3")/2}},{key:"p5",get:function(){return this.eval("p4")+0-this.eval("thh")}},{key:"xGp",get:function(){return this.eval("p5")>0?this.eval("xF"):this.eval("xG")}},{key:"yGp",get:function(){return this.eval("p5")>0?this.eval("yF"):this.eval("yG")}},{key:"xBp",get:function(){return this.eval("p5")>0?this.eval("xC"):this.eval("xB")}},{key:"yBp",get:function(){return this.eval("p5")>0?this.eval("yC"):this.eval("yB")}},{key:"en0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyF"),this.eval("sdxF")))}},{key:"en1",get:function(){return this.eval("en0")+216e5-0}},{key:"en2",get:function(){return this.eval("en0")>0?this.eval("en0"):this.eval("en1")}},{key:"sw0",get:function(){return this.eval("en2")+0-this.eval("stAng")}},{key:"sw1",get:function(){return this.eval("sw0")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw0")>0?this.eval("sw0"):this.eval("sw1")}},{key:"wtI",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htI",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxI2",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"dyI2",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"xI",get:function(){return this.eval("hc")+this.eval("dxI2")-0}},{key:"yI",get:function(){return this.eval("vc")+this.eval("dyI2")-0}},{key:"aI",get:function(){return this.eval("stAng")+0-this.eval("cd4")}},{key:"aA",get:function(){return this.eval("ptAng")+this.eval("cd4")-0}},{key:"aB",get:function(){return this.eval("ptAng")+this.eval("cd2")-0}},{key:"idx",get:function(){return this.eval("rw1")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("rh1")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"xA",y:"yA",gdRefAng:"adj2",minAng:0,maxAng:"maxAng"},{isPolar:!0,x:"xE",y:"yE",gdRefAng:"adj4",minAng:0,maxAng:21599999},{isPolar:!0,x:"xF",y:"yF",gdRefR:"adj1",minR:0,maxR:"maxAdj1",gdRefAng:"adj3",minAng:0,maxAng:21599999},{isPolar:!0,x:"xB",y:"yB",gdRefR:"adj5",minR:1,maxR:25e3}],connectionSites:[{angle:"aI",x:"xI",y:"yI"},{angle:"ptAng",x:"xGp",y:"yGp"},{angle:"aA",x:"xA",y:"yA"},{angle:"aB",x:"xBp",y:"yBp"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,10,12,14,18],arguments:["xE","yE","rw1","rh1","stAng","swAng","xGp","yGp","xA","yA","xBp","yBp","xC","yC","rw2","rh2","istAng","iswAng"],attributes:{}}]},cloud:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"il",get:function(){return 2977*this.eval("w")/21600}},{key:"it",get:function(){return 3262*this.eval("h")/21600}},{key:"ir",get:function(){return 17087*this.eval("w")/21600}},{key:"ib",get:function(){return 17337*this.eval("h")/21600}},{key:"g27",get:function(){return 67*this.eval("w")/21600}},{key:"g28",get:function(){return 21577*this.eval("h")/21600}},{key:"g29",get:function(){return 21582*this.eval("w")/21600}},{key:"g30",get:function(){return 1235*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:0,x:"g29",y:"vc"},{angle:"cd4",x:"hc",y:"g28"},{angle:"cd2",x:"g27",y:"vc"},{angle:"3cd4",x:"hc",y:"g30"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,22,26,30,34,38,42,46],arguments:[3900,14370,6753,9190,-11429249,7426832,5333,7267,-8646143,5396714,4365,5945,-8748475,5983381,4857,6595,-7859164,7034504,5333,7273,-4722533,6541615,6775,9220,-2776035,7816140,5785,7867,37501,6842e3,6752,9215,1347096,6910353,7720,10543,3974558,4542661,4360,5918,-16496525,8804134,4345,5945,-14809710,9151131],attributes:{w:43200,h:43200}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,14,18,20,24,26,30,32,36,38,42,44,48,50,54,56,60,62],arguments:[4693,26177,4345,5945,5204520,1585770,6928,34899,4360,5918,4416628,686848,16478,39090,6752,9215,8257449,844866,28827,34751,6752,9215,387196,959901,34129,22954,5785,7867,-4217541,4255042,41798,15354,5333,7273,1819082,1665090,38324,5426,4857,6595,-824660,891534,29078,3952,4857,6595,-8950887,1091722,22141,4720,4365,5945,-9809656,1061181,14e3,5192,6753,9190,-4002417,739161,4127,15789,6753,9190,9459261,711490],attributes:{w:43200,h:43200,fill:G.e.None,extrusionOk:!1}}]},cloudCallout:{adjustValues:{adj1:-20833,adj2:62500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dxPos",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"dyPos",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"xPos",get:function(){return this.eval("hc")+this.eval("dxPos")-0}},{key:"yPos",get:function(){return this.eval("vc")+this.eval("dyPos")-0}},{key:"ht",get:function(){return this.eval("hd2")*Math.cos(Math.atan2(this.eval("dyPos"),this.eval("dxPos")))}},{key:"wt",get:function(){return this.eval("wd2")*Math.sin(Math.atan2(this.eval("dyPos"),this.eval("dxPos")))}},{key:"g2",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt"),this.eval("ht")))}},{key:"g3",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt"),this.eval("ht")))}},{key:"g4",get:function(){return this.eval("hc")+this.eval("g2")-0}},{key:"g5",get:function(){return this.eval("vc")+this.eval("g3")-0}},{key:"g6",get:function(){return this.eval("g4")+0-this.eval("xPos")}},{key:"g7",get:function(){return this.eval("g5")+0-this.eval("yPos")}},{key:"g8",get:function(){return this.modulo(this.eval("g6"),this.eval("g7"),0)}},{key:"g9",get:function(){return 6600*this.eval("ss")/21600}},{key:"g10",get:function(){return this.eval("g8")+0-this.eval("g9")}},{key:"g11",get:function(){return 1*this.eval("g10")/3}},{key:"g12",get:function(){return 1800*this.eval("ss")/21600}},{key:"g13",get:function(){return this.eval("g11")+this.eval("g12")-0}},{key:"g14",get:function(){return this.eval("g13")*this.eval("g6")/this.eval("g8")}},{key:"g15",get:function(){return this.eval("g13")*this.eval("g7")/this.eval("g8")}},{key:"g16",get:function(){return this.eval("g14")+this.eval("xPos")-0}},{key:"g17",get:function(){return this.eval("g15")+this.eval("yPos")-0}},{key:"g18",get:function(){return 4800*this.eval("ss")/21600}},{key:"g19",get:function(){return 2*this.eval("g11")/1}},{key:"g20",get:function(){return this.eval("g18")+this.eval("g19")-0}},{key:"g21",get:function(){return this.eval("g20")*this.eval("g6")/this.eval("g8")}},{key:"g22",get:function(){return this.eval("g20")*this.eval("g7")/this.eval("g8")}},{key:"g23",get:function(){return this.eval("g21")+this.eval("xPos")-0}},{key:"g24",get:function(){return this.eval("g22")+this.eval("yPos")-0}},{key:"g25",get:function(){return 1200*this.eval("ss")/21600}},{key:"g26",get:function(){return 600*this.eval("ss")/21600}},{key:"x23",get:function(){return this.eval("xPos")+this.eval("g26")-0}},{key:"x24",get:function(){return this.eval("g16")+this.eval("g25")-0}},{key:"x25",get:function(){return this.eval("g23")+this.eval("g12")-0}},{key:"il",get:function(){return 2977*this.eval("w")/21600}},{key:"it",get:function(){return 3262*this.eval("h")/21600}},{key:"ir",get:function(){return 17087*this.eval("w")/21600}},{key:"ib",get:function(){return 17337*this.eval("h")/21600}},{key:"g27",get:function(){return 67*this.eval("w")/21600}},{key:"g28",get:function(){return 21577*this.eval("h")/21600}},{key:"g29",get:function(){return 21582*this.eval("w")/21600}},{key:"g30",get:function(){return 1235*this.eval("h")/21600}},{key:"pang",get:function(){return this.radianToAngle(Math.atan2(this.eval("dyPos"),this.eval("dxPos")))}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xPos",y:"yPos",gdRefX:"adj1",minX:-2147483647,maxX:2147483647,gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:"cd2",x:"g27",y:"vc"},{angle:"cd4",x:"hc",y:"g28"},{angle:0,x:"g29",y:"vc"},{angle:"3cd4",x:"hc",y:"g30"},{angle:"pang",x:"xPos",y:"yPos"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,22,26,30,34,38,42,46],arguments:[3900,14370,6753,9190,-11429249,7426832,5333,7267,-8646143,5396714,4365,5945,-8748475,5983381,4857,6595,-7859164,7034504,5333,7273,-4722533,6541615,6775,9220,-2776035,7816140,5785,7867,37501,6842e3,6752,9215,1347096,6910353,7720,10543,3974558,4542661,4360,5918,-16496525,8804134,4345,5945,-14809710,9151131],attributes:{w:43200,h:43200}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["x23","yPos","g26","g26",0,216e5],attributes:{}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["x24","g17","g25","g25",0,216e5],attributes:{}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["x25","g24","g12","g12",0,216e5],attributes:{}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,14,18,20,24,26,30,32,36,38,42,44,48,50,54,56,60,62],arguments:[4693,26177,4345,5945,5204520,1585770,6928,34899,4360,5918,4416628,686848,16478,39090,6752,9215,8257449,844866,28827,34751,6752,9215,387196,959901,34129,22954,5785,7867,-4217541,4255042,41798,15354,5333,7273,1819082,1665090,38324,5426,4857,6595,-824660,891534,29078,3952,4857,6595,-8950887,1091722,22141,4720,4365,5945,-9809656,1061181,14e3,5192,6753,9190,-4002417,739161,4127,15789,6753,9190,9459261,711490],attributes:{w:43200,h:43200,fill:G.e.None,extrusionOk:!1}}]},corner:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj1",get:function(){return 1e5*this.eval("h")/this.eval("ss")}},{key:"maxAdj2",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dy1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("dy1")}},{key:"cx1",get:function(){return 1*this.eval("x1")/2}},{key:"cy1",get:function(){return(this.eval("y1")+this.eval("b"))/2}},{key:"d",get:function(){return this.eval("w")+0-this.eval("h")}},{key:"it",get:function(){return this.eval("d")>0?this.eval("y1"):this.eval("t")}},{key:"ir",get:function(){return this.eval("d")>0?this.eval("r"):this.eval("x1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:0,x:"r",y:"cy1"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"cx1",y:"t"}],textBoxRect:{left:"l",top:"it",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["l","t","x1","t","x1","y1","r","y1","r","b","l","b"],attributes:{}}]},cornerTabs:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"md",get:function(){return this.modulo(this.eval("w"),this.eval("h"),0)}},{key:"dx",get:function(){return 1*this.eval("md")/20}},{key:"y1",get:function(){return 0+this.eval("b")-this.eval("dx")}},{key:"x1",get:function(){return 0+this.eval("r")-this.eval("dx")}}]),t}(Ur),connectionSites:[{angle:"cd2",x:"l",y:"t"},{angle:"cd2",x:"l",y:"dx"},{angle:"cd2",x:"l",y:"y1"},{angle:"cd2",x:"l",y:"b"},{angle:"3cd4",x:"dx",y:"t"},{angle:"3cd4",x:"x1",y:"t"},{angle:"cd4",x:"dx",y:"b"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"t"},{angle:0,x:"r",y:"dx"},{angle:0,x:"r",y:"y1"},{angle:0,x:"r",y:"b"}],textBoxRect:{left:"dx",top:"dx",right:"x1",bottom:"y1"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["l","t","dx","t","l","dx"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["l","y1","dx","b","l","b"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["x1","t","r","t","r","dx"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["r","y1","r","b","x1","b"],attributes:{}}]},cube:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),1e5)}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"y2",get:function(){return 1*this.eval("y4")/2}},{key:"y3",get:function(){return(this.eval("y1")+this.eval("b"))/2}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("y1")}},{key:"x2",get:function(){return 1*this.eval("x4")/2}},{key:"x3",get:function(){return(this.eval("y1")+this.eval("r"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj",minY:0,maxY:1e5}],connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"3cd4",x:"x2",y:"y1"},{angle:"cd2",x:"l",y:"y3"},{angle:"cd4",x:"x2",y:"b"},{angle:0,x:"x4",y:"y3"},{angle:0,x:"r",y:"y2"}],textBoxRect:{left:"l",top:"y1",right:"x4",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","y1","x4","y1","x4","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["x4","y1","r","t","r","y4","x4","b"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","y1","y1","t","r","t","x4","y1"],attributes:{stroke:!1,fill:G.e.LightenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,12,12,14,16,18,20],arguments:["l","y1","y1","t","r","t","r","y4","x4","b","l","b","l","y1","x4","y1","r","t","x4","y1","x4","b"],attributes:{fill:G.e.None,extrusionOk:!1}}]},curvedConnector2:{textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo],argumentIndices:[0,2],arguments:["l","t","wd2","t","r","hd2","r","b"],attributes:{fill:G.e.None}}]},curvedConnector3:{adjustValues:{adj1:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return(this.eval("l")+this.eval("x2"))/2}},{key:"x3",get:function(){return(this.eval("r")+this.eval("x2"))/2}},{key:"y3",get:function(){return 3*this.eval("h")/4}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"vc",gdRefX:"adj1",minX:-2147483647,maxX:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.CubicBezierTo],argumentIndices:[0,2,8],arguments:["l","t","x1","t","x2","hd4","x2","vc","x2","y3","x3","b","r","b"],attributes:{fill:G.e.None}}]},curvedConnector4:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"x1",get:function(){return(this.eval("l")+this.eval("x2"))/2}},{key:"x3",get:function(){return(this.eval("r")+this.eval("x2"))/2}},{key:"x4",get:function(){return(this.eval("x2")+this.eval("x3"))/2}},{key:"x5",get:function(){return(this.eval("x3")+this.eval("r"))/2}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"y1",get:function(){return(this.eval("t")+this.eval("y4"))/2}},{key:"y2",get:function(){return(this.eval("t")+this.eval("y1"))/2}},{key:"y3",get:function(){return(this.eval("y1")+this.eval("y4"))/2}},{key:"y5",get:function(){return(this.eval("b")+this.eval("y4"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"y1",gdRefX:"adj1",minX:-2147483647,maxX:2147483647},{isPolar:!1,x:"x3",y:"y4",gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.CubicBezierTo],argumentIndices:[0,2,8,14],arguments:["l","t","x1","t","x2","y2","x2","y1","x2","y3","x4","y4","x3","y4","x5","y4","r","y5","r","b"],attributes:{fill:G.e.None}}]},curvedConnector5:{adjustValues:{adj1:5e4,adj2:5e4,adj3:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x3",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"x6",get:function(){return this.eval("w")*this.eval("adj3")/1e5}},{key:"x1",get:function(){return(this.eval("x3")+this.eval("x6"))/2}},{key:"x2",get:function(){return(this.eval("l")+this.eval("x3"))/2}},{key:"x4",get:function(){return(this.eval("x3")+this.eval("x1"))/2}},{key:"x5",get:function(){return(this.eval("x6")+this.eval("x1"))/2}},{key:"x7",get:function(){return(this.eval("x6")+this.eval("r"))/2}},{key:"y4",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"y1",get:function(){return(this.eval("t")+this.eval("y4"))/2}},{key:"y2",get:function(){return(this.eval("t")+this.eval("y1"))/2}},{key:"y3",get:function(){return(this.eval("y1")+this.eval("y4"))/2}},{key:"y5",get:function(){return(this.eval("b")+this.eval("y4"))/2}},{key:"y6",get:function(){return(this.eval("y5")+this.eval("y4"))/2}},{key:"y7",get:function(){return(this.eval("y5")+this.eval("b"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"y1",gdRefX:"adj1",minX:-2147483647,maxX:2147483647},{isPolar:!1,x:"x1",y:"y4",gdRefY:"adj2",minY:-2147483647,maxY:2147483647},{isPolar:!1,x:"x6",y:"y5",gdRefX:"adj3",minX:-2147483647,maxX:2147483647}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.CubicBezierTo],argumentIndices:[0,2,8,14,20],arguments:["l","t","x2","t","x3","y2","x3","y1","x3","y3","x4","y4","x1","y4","x5","y4","x6","y6","x6","y5","x6","y7","x7","b","r","b"],attributes:{fill:G.e.None}}]},curvedDownArrow:{adjustValues:{adj1:25e3,adj2:5e4,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"q1",get:function(){return(this.eval("th")+this.eval("aw"))/4}},{key:"wR",get:function(){return this.eval("wd2")+0-this.eval("q1")}},{key:"q7",get:function(){return 2*this.eval("wR")/1}},{key:"q8",get:function(){return this.eval("q7")*this.eval("q7")/1}},{key:"q9",get:function(){return this.eval("th")*this.eval("th")/1}},{key:"q10",get:function(){return this.eval("q8")+0-this.eval("q9")}},{key:"q11",get:function(){return Math.sqrtFix(this.eval("q10"))}},{key:"idy",get:function(){return this.eval("q11")*this.eval("h")/this.eval("q7")}},{key:"maxAdj3",get:function(){return 1e5*this.eval("idy")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"ah",get:function(){return this.eval("ss")*this.eval("adj3")/1e5}},{key:"x3",get:function(){return this.eval("wR")+this.eval("th")-0}},{key:"q2",get:function(){return this.eval("h")*this.eval("h")/1}},{key:"q3",get:function(){return this.eval("ah")*this.eval("ah")/1}},{key:"q4",get:function(){return this.eval("q2")+0-this.eval("q3")}},{key:"q5",get:function(){return Math.sqrtFix(this.eval("q4"))}},{key:"dx",get:function(){return this.eval("q5")*this.eval("wR")/this.eval("h")}},{key:"x5",get:function(){return this.eval("wR")+this.eval("dx")-0}},{key:"x7",get:function(){return this.eval("x3")+this.eval("dx")-0}},{key:"q6",get:function(){return this.eval("aw")+0-this.eval("th")}},{key:"dh",get:function(){return 1*this.eval("q6")/2}},{key:"x4",get:function(){return this.eval("x5")+0-this.eval("dh")}},{key:"x8",get:function(){return this.eval("x7")+this.eval("dh")-0}},{key:"aw2",get:function(){return 1*this.eval("aw")/2}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("aw2")}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("ah")}},{key:"swAng",get:function(){return this.radianToAngle(Math.atan2(this.eval("dx"),this.eval("ah")))}},{key:"mswAng",get:function(){return 0-this.eval("swAng")}},{key:"iy",get:function(){return this.eval("b")+0-this.eval("idy")}},{key:"ix",get:function(){return(this.eval("wR")+this.eval("x3"))/2}},{key:"q12",get:function(){return 1*this.eval("th")/2}},{key:"dang2",get:function(){return this.radianToAngle(Math.atan2(this.eval("q12"),this.eval("idy")))}},{key:"stAng",get:function(){return this.eval("3cd4")+this.eval("swAng")-0}},{key:"stAng2",get:function(){return this.eval("3cd4")+0-this.eval("dang2")}},{key:"swAng2",get:function(){return this.eval("dang2")+0-this.eval("cd4")}},{key:"swAng3",get:function(){return this.eval("cd4")+this.eval("dang2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x7",y:"y1",gdRefX:"adj1",minX:0,maxX:"adj2"},{isPolar:!1,x:"x4",y:"b",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"r",y:"y1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:"3cd4",x:"ix",y:"t"},{angle:"cd4",x:"q12",y:"b"},{angle:"cd4",x:"x4",y:"y1"},{angle:"cd4",x:"x6",y:"b"},{angle:0,x:"x8",y:"y1"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,12,16,18],arguments:["x6","b","x4","y1","x5","y1","wR","h","stAng","mswAng","x3","t","wR","h","3cd4","swAng","x8","y1"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["ix","iy","wR","h","stAng2","swAng2","l","b","wR","h","cd2","swAng3"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,14,18,20,22,24,26],arguments:["ix","iy","wR","h","stAng2","swAng2","l","b","wR","h","cd2","cd4","x3","t","wR","h","3cd4","swAng","x8","y1","x6","b","x4","y1","x5","y1","wR","h","stAng","mswAng"],attributes:{fill:G.e.None,extrusionOk:!1}}]},curvedLeftArrow:{adjustValues:{adj1:25e3,adj2:5e4,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("a2"))}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"q1",get:function(){return(this.eval("th")+this.eval("aw"))/4}},{key:"hR",get:function(){return this.eval("hd2")+0-this.eval("q1")}},{key:"q7",get:function(){return 2*this.eval("hR")/1}},{key:"q8",get:function(){return this.eval("q7")*this.eval("q7")/1}},{key:"q9",get:function(){return this.eval("th")*this.eval("th")/1}},{key:"q10",get:function(){return this.eval("q8")+0-this.eval("q9")}},{key:"q11",get:function(){return Math.sqrtFix(this.eval("q10"))}},{key:"idx",get:function(){return this.eval("q11")*this.eval("w")/this.eval("q7")}},{key:"maxAdj3",get:function(){return 1e5*this.eval("idx")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"ah",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"y3",get:function(){return this.eval("hR")+this.eval("th")-0}},{key:"q2",get:function(){return this.eval("w")*this.eval("w")/1}},{key:"q3",get:function(){return this.eval("ah")*this.eval("ah")/1}},{key:"q4",get:function(){return this.eval("q2")+0-this.eval("q3")}},{key:"q5",get:function(){return Math.sqrtFix(this.eval("q4"))}},{key:"dy",get:function(){return this.eval("q5")*this.eval("hR")/this.eval("w")}},{key:"y5",get:function(){return this.eval("hR")+this.eval("dy")-0}},{key:"y7",get:function(){return this.eval("y3")+this.eval("dy")-0}},{key:"q6",get:function(){return this.eval("aw")+0-this.eval("th")}},{key:"dh",get:function(){return 1*this.eval("q6")/2}},{key:"y4",get:function(){return this.eval("y5")+0-this.eval("dh")}},{key:"y8",get:function(){return this.eval("y7")+this.eval("dh")-0}},{key:"aw2",get:function(){return 1*this.eval("aw")/2}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("aw2")}},{key:"x1",get:function(){return this.eval("l")+this.eval("ah")-0}},{key:"swAng",get:function(){return this.radianToAngle(Math.atan2(this.eval("dy"),this.eval("ah")))}},{key:"mswAng",get:function(){return 0-this.eval("swAng")}},{key:"ix",get:function(){return this.eval("l")+this.eval("idx")-0}},{key:"iy",get:function(){return(this.eval("hR")+this.eval("y3"))/2}},{key:"q12",get:function(){return 1*this.eval("th")/2}},{key:"dang2",get:function(){return this.radianToAngle(Math.atan2(this.eval("q12"),this.eval("idx")))}},{key:"swAng2",get:function(){return this.eval("dang2")+0-this.eval("swAng")}},{key:"swAng3",get:function(){return this.eval("swAng")+this.eval("dang2")-0}},{key:"stAng3",get:function(){return 0-this.eval("dang2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y5",gdRefY:"adj1",minY:0,maxY:"a2"},{isPolar:!1,x:"r",y:"y4",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x1",y:"b",gdRefX:"adj3",minX:0,maxX:"maxAdj3"}],connectionSites:[{angle:"cd2",x:"l",y:"q12"},{angle:"cd2",x:"x1",y:"y4"},{angle:"cd3",x:"l",y:"y6"},{angle:"cd4",x:"x1",y:"y8"},{angle:0,x:"r",y:"iy"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,14,16],arguments:["l","y6","x1","y4","x1","y5","w","hR","swAng","swAng2","w","hR","stAng3","swAng3","x1","y8"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["r","y3","w","hR",0,-54e5,"l","t","w","hR","3cd4","cd4"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,14,18,20,22,24,26],arguments:["r","y3","w","hR",0,-54e5,"l","t","w","hR","3cd4","cd4","r","y3","w","hR",0,"swAng","x1","y8","l","y6","x1","y4","x1","y5","w","hR","swAng","swAng2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},curvedRightArrow:{adjustValues:{adj1:25e3,adj2:5e4,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("a2"))}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"q1",get:function(){return(this.eval("th")+this.eval("aw"))/4}},{key:"hR",get:function(){return this.eval("hd2")+0-this.eval("q1")}},{key:"q7",get:function(){return 2*this.eval("hR")/1}},{key:"q8",get:function(){return this.eval("q7")*this.eval("q7")/1}},{key:"q9",get:function(){return this.eval("th")*this.eval("th")/1}},{key:"q10",get:function(){return this.eval("q8")+0-this.eval("q9")}},{key:"q11",get:function(){return Math.sqrtFix(this.eval("q10"))}},{key:"idx",get:function(){return this.eval("q11")*this.eval("w")/this.eval("q7")}},{key:"maxAdj3",get:function(){return 1e5*this.eval("idx")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"ah",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"y3",get:function(){return this.eval("hR")+this.eval("th")-0}},{key:"q2",get:function(){return this.eval("w")*this.eval("w")/1}},{key:"q3",get:function(){return this.eval("ah")*this.eval("ah")/1}},{key:"q4",get:function(){return this.eval("q2")+0-this.eval("q3")}},{key:"q5",get:function(){return Math.sqrtFix(this.eval("q4"))}},{key:"dy",get:function(){return this.eval("q5")*this.eval("hR")/this.eval("w")}},{key:"y5",get:function(){return this.eval("hR")+this.eval("dy")-0}},{key:"y7",get:function(){return this.eval("y3")+this.eval("dy")-0}},{key:"q6",get:function(){return this.eval("aw")+0-this.eval("th")}},{key:"dh",get:function(){return 1*this.eval("q6")/2}},{key:"y4",get:function(){return this.eval("y5")+0-this.eval("dh")}},{key:"y8",get:function(){return this.eval("y7")+this.eval("dh")-0}},{key:"aw2",get:function(){return 1*this.eval("aw")/2}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("aw2")}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("ah")}},{key:"swAng",get:function(){return this.radianToAngle(Math.atan2(this.eval("dy"),this.eval("ah")))}},{key:"stAng",get:function(){return this.eval("cd2")+0-this.eval("swAng")}},{key:"mswAng",get:function(){return 0-this.eval("swAng")}},{key:"ix",get:function(){return this.eval("r")+0-this.eval("idx")}},{key:"iy",get:function(){return(this.eval("hR")+this.eval("y3"))/2}},{key:"q12",get:function(){return 1*this.eval("th")/2}},{key:"dang2",get:function(){return this.radianToAngle(Math.atan2(this.eval("q12"),this.eval("idx")))}},{key:"swAng2",get:function(){return this.eval("dang2")+0-this.eval("cd4")}},{key:"swAng3",get:function(){return this.eval("cd4")+this.eval("dang2")-0}},{key:"stAng3",get:function(){return this.eval("cd2")+0-this.eval("dang2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y5",gdRefY:"adj1",minY:0,maxY:"a2"},{isPolar:!1,x:"r",y:"y4",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x1",y:"b",gdRefX:"adj3",minX:0,maxX:"maxAdj3"}],connectionSites:[{angle:"cd2",x:"l",y:"iy"},{angle:"cd4",x:"x1",y:"y8"},{angle:0,x:"r",y:"y6"},{angle:0,x:"x1",y:"y4"},{angle:0,x:"r",y:"q12"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,10,12,14,18],arguments:["l","hR","w","hR","cd2","mswAng","x1","y4","r","y6","x1","y8","x1","y7","w","hR","stAng","swAng"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10],arguments:["r","th","w","hR","3cd4","swAng2","w","hR","stAng3","swAng3"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,10,12,14,18,20,24,26],arguments:["l","hR","w","hR","cd2","mswAng","x1","y4","r","y6","x1","y8","x1","y7","w","hR","stAng","swAng","l","hR","w","hR","cd2","cd4","r","th","w","hR","3cd4","swAng2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},curvedUpArrow:{adjustValues:{adj1:25e3,adj2:5e4,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"q1",get:function(){return(this.eval("th")+this.eval("aw"))/4}},{key:"wR",get:function(){return this.eval("wd2")+0-this.eval("q1")}},{key:"q7",get:function(){return 2*this.eval("wR")/1}},{key:"q8",get:function(){return this.eval("q7")*this.eval("q7")/1}},{key:"q9",get:function(){return this.eval("th")*this.eval("th")/1}},{key:"q10",get:function(){return this.eval("q8")+0-this.eval("q9")}},{key:"q11",get:function(){return Math.sqrtFix(this.eval("q10"))}},{key:"idy",get:function(){return this.eval("q11")*this.eval("h")/this.eval("q7")}},{key:"maxAdj3",get:function(){return 1e5*this.eval("idy")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"ah",get:function(){return this.eval("ss")*this.eval("adj3")/1e5}},{key:"x3",get:function(){return this.eval("wR")+this.eval("th")-0}},{key:"q2",get:function(){return this.eval("h")*this.eval("h")/1}},{key:"q3",get:function(){return this.eval("ah")*this.eval("ah")/1}},{key:"q4",get:function(){return this.eval("q2")+0-this.eval("q3")}},{key:"q5",get:function(){return Math.sqrtFix(this.eval("q4"))}},{key:"dx",get:function(){return this.eval("q5")*this.eval("wR")/this.eval("h")}},{key:"x5",get:function(){return this.eval("wR")+this.eval("dx")-0}},{key:"x7",get:function(){return this.eval("x3")+this.eval("dx")-0}},{key:"q6",get:function(){return this.eval("aw")+0-this.eval("th")}},{key:"dh",get:function(){return 1*this.eval("q6")/2}},{key:"x4",get:function(){return this.eval("x5")+0-this.eval("dh")}},{key:"x8",get:function(){return this.eval("x7")+this.eval("dh")-0}},{key:"aw2",get:function(){return 1*this.eval("aw")/2}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("aw2")}},{key:"y1",get:function(){return this.eval("t")+this.eval("ah")-0}},{key:"swAng",get:function(){return this.radianToAngle(Math.atan2(this.eval("dx"),this.eval("ah")))}},{key:"mswAng",get:function(){return 0-this.eval("swAng")}},{key:"iy",get:function(){return this.eval("t")+this.eval("idy")-0}},{key:"ix",get:function(){return(this.eval("wR")+this.eval("x3"))/2}},{key:"q12",get:function(){return 1*this.eval("th")/2}},{key:"dang2",get:function(){return this.radianToAngle(Math.atan2(this.eval("q12"),this.eval("idy")))}},{key:"swAng2",get:function(){return this.eval("dang2")+0-this.eval("swAng")}},{key:"mswAng2",get:function(){return 0-this.eval("swAng2")}},{key:"stAng3",get:function(){return this.eval("cd4")+0-this.eval("swAng")}},{key:"swAng3",get:function(){return this.eval("swAng")+this.eval("dang2")-0}},{key:"stAng2",get:function(){return this.eval("cd4")+0-this.eval("dang2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x7",y:"y1",gdRefX:"adj1",minX:0,maxX:"a2"},{isPolar:!1,x:"x4",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"r",y:"y1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:"3cd4",x:"x6",y:"t"},{angle:"3cd4",x:"x4",y:"y1"},{angle:"3cd4",x:"q12",y:"t"},{angle:"cd4",x:"ix",y:"b"},{angle:0,x:"x8",y:"y1"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,14,16],arguments:["x6","t","x8","y1","x7","y1","wR","h","stAng3","swAng3","wR","h","stAng2","swAng2","x4","y1"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["wR","b","wR","h","cd4","cd4","th","t","wR","h","cd2",-54e5],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,10,12,14,18,20,24,26],arguments:["ix","iy","wR","h","stAng2","swAng2","x4","y1","x6","t","x8","y1","x7","y1","wR","h","stAng3","swAng","wR","b","wR","h","cd4","cd4","th","t","wR","h","cd2",-54e5],attributes:{fill:G.e.None,extrusionOk:!1}}]},decagon:{adjustValues:{vf:105146},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(216e4))}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(432e4))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy1",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(432e4))}},{key:"dy2",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(216e4))}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"x4",y:"y2"},{angle:0,x:"r",y:"vc"},{angle:0,x:"x4",y:"y3"},{angle:"cd4",x:"x3",y:"y4"},{angle:"cd4",x:"x2",y:"y4"},{angle:"cd2",x:"x1",y:"y3"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd2",x:"x1",y:"y2"},{angle:"3cd4",x:"x2",y:"y1"},{angle:"3cd4",x:"x3",y:"y1"}],textBoxRect:{left:"x1",top:"y2",right:"x4",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20],arguments:["l","vc","x1","y2","x2","y1","x3","y1","x4","y2","r","vc","x4","y3","x3","y4","x2","y4","x1","y3"],attributes:{}}]},diagStripe:{adjustValues:{adj:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),1e5)}},{key:"x2",get:function(){return this.eval("w")*this.eval("a")/1e5}},{key:"x1",get:function(){return 1*this.eval("x2")/2}},{key:"x3",get:function(){return(this.eval("x2")+this.eval("r"))/2}},{key:"y2",get:function(){return this.eval("h")*this.eval("a")/1e5}},{key:"y1",get:function(){return 1*this.eval("y2")/2}},{key:"y3",get:function(){return(this.eval("y2")+this.eval("b"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y2",gdRefY:"adj",minY:0,maxY:1e5}],connectionSites:[{angle:0,x:"hc",y:"vc"},{angle:"cd2",x:"l",y:"y3"},{angle:"cd2",x:"x1",y:"y1"},{angle:"3cd4",x:"x3",y:"t"}],textBoxRect:{left:"l",top:"t",right:"x3",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","y2","x2","t","r","t","l","b"],attributes:{}}]},diamond:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"ir",get:function(){return 3*this.eval("w")/4}},{key:"ib",get:function(){return 3*this.eval("h")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd4",top:"hd4",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","vc","hc","t","r","vc","hc","b"],attributes:{}}]},dodecagon:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x1",get:function(){return 2894*this.eval("w")/21600}},{key:"x2",get:function(){return 7906*this.eval("w")/21600}},{key:"x3",get:function(){return 13694*this.eval("w")/21600}},{key:"x4",get:function(){return 18706*this.eval("w")/21600}},{key:"y1",get:function(){return 2894*this.eval("h")/21600}},{key:"y2",get:function(){return 7906*this.eval("h")/21600}},{key:"y3",get:function(){return 13694*this.eval("h")/21600}},{key:"y4",get:function(){return 18706*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:0,x:"x4",y:"y1"},{angle:0,x:"r",y:"y2"},{angle:0,x:"r",y:"y3"},{angle:0,x:"x4",y:"y4"},{angle:"cd4",x:"x3",y:"b"},{angle:"cd4",x:"x2",y:"b"},{angle:"cd2",x:"x1",y:"y4"},{angle:"cd2",x:"l",y:"y3"},{angle:"cd2",x:"l",y:"y2"},{angle:"cd2",x:"x1",y:"y1"},{angle:"3cd4",x:"x2",y:"t"},{angle:"3cd4",x:"x3",y:"t"}],textBoxRect:{left:"x1",top:"y1",right:"x4",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["l","y2","x1","y1","x2","t","x3","t","x4","y1","r","y2","r","y3","x4","y4","x3","b","x2","b","x1","y4","l","y3"],attributes:{}}]},donut:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dr",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"iwd2",get:function(){return this.eval("wd2")+0-this.eval("dr")}},{key:"ihd2",get:function(){return this.eval("hd2")+0-this.eval("dr")}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"dr",y:"vc",gdRefR:"adj",minR:0,maxR:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,18,20,24,28,32,36],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4","dr","vc","iwd2","ihd2","cd2",-54e5,"iwd2","ihd2","cd4",-54e5,"iwd2","ihd2",0,-54e5,"iwd2","ihd2","3cd4",-54e5],attributes:{}}]},doubleWave:{adjustValues:{adj1:6250,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),12500)}},{key:"a2",get:function(){return this.pinTo(-1e4,this.eval("adj2"),1e4)}},{key:"y1",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy2",get:function(){return 10*this.eval("y1")/3}},{key:"y2",get:function(){return this.eval("y1")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("y1")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"y5",get:function(){return this.eval("y4")+0-this.eval("dy2")}},{key:"y6",get:function(){return this.eval("y4")+this.eval("dy2")-0}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a2")/1e5}},{key:"of2",get:function(){return this.eval("w")*this.eval("a2")/5e4}},{key:"x1",get:function(){return Math.abs(this.eval("dx1"))}},{key:"dx2",get:function(){return this.eval("of2")>0?0:this.eval("of2")}},{key:"x2",get:function(){return this.eval("l")+0-this.eval("dx2")}},{key:"dx8",get:function(){return this.eval("of2")>0?this.eval("of2"):0}},{key:"x8",get:function(){return this.eval("r")+0-this.eval("dx8")}},{key:"dx3",get:function(){return(this.eval("dx2")+this.eval("x8"))/6}},{key:"x3",get:function(){return this.eval("x2")+this.eval("dx3")-0}},{key:"dx4",get:function(){return(this.eval("dx2")+this.eval("x8"))/3}},{key:"x4",get:function(){return this.eval("x2")+this.eval("dx4")-0}},{key:"x5",get:function(){return(this.eval("x2")+this.eval("x8"))/2}},{key:"x6",get:function(){return this.eval("x5")+this.eval("dx3")-0}},{key:"x7",get:function(){return(this.eval("x6")+this.eval("x8"))/2}},{key:"x9",get:function(){return this.eval("l")+this.eval("dx8")-0}},{key:"x15",get:function(){return this.eval("r")+this.eval("dx2")-0}},{key:"x10",get:function(){return this.eval("x9")+this.eval("dx3")-0}},{key:"x11",get:function(){return this.eval("x9")+this.eval("dx4")-0}},{key:"x12",get:function(){return(this.eval("x9")+this.eval("x15"))/2}},{key:"x13",get:function(){return this.eval("x12")+this.eval("dx3")-0}},{key:"x14",get:function(){return(this.eval("x13")+this.eval("x15"))/2}},{key:"x16",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"xAdj",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"il",get:function(){return Math.max(this.eval("x2"),this.eval("x9"))}},{key:"ir",get:function(){return Math.min(this.eval("x8"),this.eval("x15"))}},{key:"it",get:function(){return this.eval("h")*this.eval("a1")/5e4}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("it")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:12500},{isPolar:!1,x:"xAdj",y:"b",gdRefX:"adj2",minX:-1e4,maxX:1e4}],connectionSites:[{angle:"cd4",x:"x12",y:"y1"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"x5",y:"y4"},{angle:0,x:"x16",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.LineTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.Close],argumentIndices:[0,2,8,14,16,22,28],arguments:["x2","y1","x3","y2","x4","y3","x5","y1","x6","y2","x7","y3","x8","y1","x15","y4","x14","y6","x13","y5","x12","y4","x11","y6","x10","y5","x9","y4"],attributes:{}}]},downArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("h")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"dy1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("dy1")}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy2",get:function(){return this.eval("x1")*this.eval("dy1")/this.eval("wd2")}},{key:"y2",get:function(){return this.eval("y1")+this.eval("dy2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj1",minX:0,maxX:1e5},{isPolar:!1,x:"l",y:"y1",gdRefY:"adj2",minY:0,maxY:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y1"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"y1"}],textBoxRect:{left:"x1",top:"t",right:"x2",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["l","y1","x1","y1","x1","t","x2","t","x2","y1","r","y1","hc","b"],attributes:{}}]},downArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:64977},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 1e5*this.eval("h")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("h")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy3",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("dy3")}},{key:"y2",get:function(){return this.eval("h")*this.eval("a4")/1e5}},{key:"y1",get:function(){return 1*this.eval("y2")/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"y3",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x1",y:"b",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"r",y:"y3",gdRefY:"adj3",minY:0,maxY:"maxAdj3"},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj4",minY:0,maxY:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y1"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"y1"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22],arguments:["l","t","r","t","r","y2","x3","y2","x3","y3","x4","y3","hc","b","x1","y3","x2","y3","x2","y2","l","y2"],attributes:{}}]},ellipse:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{}}]},ellipseRibbon:{adjustValues:{adj1:25e3,adj2:5e4,adj3:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(25e3,this.eval("adj2"),75e3)}},{key:"q10",get:function(){return 1e5-this.eval("a1")}},{key:"q11",get:function(){return 1*this.eval("q10")/2}},{key:"q12",get:function(){return this.eval("a1")+0-this.eval("q11")}},{key:"minAdj3",get:function(){return Math.max(0,this.eval("q12"))}},{key:"a3",get:function(){return this.pinTo(this.eval("minAdj3"),this.eval("adj3"),this.eval("a1"))}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a2")/2e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("x2")+this.eval("wd8")-0}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x3")}},{key:"x5",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("wd8")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a3")/1e5}},{key:"f1",get:function(){return 4*this.eval("dy1")/this.eval("w")}},{key:"q1",get:function(){return this.eval("x3")*this.eval("x3")/this.eval("w")}},{key:"q2",get:function(){return this.eval("x3")+0-this.eval("q1")}},{key:"y1",get:function(){return this.eval("f1")*this.eval("q2")/1}},{key:"cx1",get:function(){return 1*this.eval("x3")/2}},{key:"cy1",get:function(){return this.eval("f1")*this.eval("cx1")/1}},{key:"cx2",get:function(){return this.eval("r")+0-this.eval("cx1")}},{key:"q14",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy3",get:function(){return this.eval("q14")+0-this.eval("dy1")}},{key:"q3",get:function(){return this.eval("x2")*this.eval("x2")/this.eval("w")}},{key:"q4",get:function(){return this.eval("x2")+0-this.eval("q3")}},{key:"q5",get:function(){return this.eval("f1")*this.eval("q4")/1}},{key:"y3",get:function(){return this.eval("q5")+this.eval("dy3")-0}},{key:"q6",get:function(){return this.eval("dy1")+this.eval("dy3")-this.eval("y3")}},{key:"q7",get:function(){return this.eval("q6")+this.eval("dy1")-0}},{key:"cy3",get:function(){return this.eval("q7")+this.eval("dy3")-0}},{key:"rh",get:function(){return this.eval("b")+0-this.eval("q14")}},{key:"q8",get:function(){return 14*this.eval("dy1")/16}},{key:"y2",get:function(){return(this.eval("q8")+this.eval("rh"))/2}},{key:"y5",get:function(){return this.eval("q5")+this.eval("rh")-0}},{key:"y6",get:function(){return this.eval("y3")+this.eval("rh")-0}},{key:"cx4",get:function(){return 1*this.eval("x2")/2}},{key:"q9",get:function(){return this.eval("f1")*this.eval("cx4")/1}},{key:"cy4",get:function(){return this.eval("q9")+this.eval("rh")-0}},{key:"cx5",get:function(){return this.eval("r")+0-this.eval("cx4")}},{key:"cy6",get:function(){return this.eval("cy3")+this.eval("rh")-0}},{key:"y7",get:function(){return this.eval("y1")+this.eval("dy3")-0}},{key:"cy7",get:function(){return this.eval("q14")+this.eval("q14")-this.eval("y7")}},{key:"y8",get:function(){return this.eval("b")+0-this.eval("dy1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"q14",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x2",y:"b",gdRefX:"adj2",minX:25e3,maxX:75e3},{isPolar:!1,x:"l",y:"y8",gdRefY:"adj3",minY:"minAdj3",maxY:"a1"}],connectionSites:[{angle:"3cd4",x:"hc",y:"q14"},{angle:"cd2",x:"wd8",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x6",y:"y2"}],textBoxRect:{left:"x2",top:"q14",right:"x5",bottom:"y6"},paths:[{commands:[G.d.MoveTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,22,26,28,32,34,38,40],arguments:["l","t","cx1","cy1","x3","y1","x2","y3","hc","cy3","x5","y3","x4","y1","cx2","cy1","r","t","x6","y2","r","rh","cx5","cy4","x5","y5","x5","y6","hc","cy6","x2","y6","x2","y5","cx4","cy4","l","rh","wd8","y2"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.Close],argumentIndices:[0,2,4,6,10,12,14,18],arguments:["x3","y7","x3","y1","x2","y3","hc","cy3","x5","y3","x4","y1","x4","y7","hc","cy7","x3","y7"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,6,8,12,14,18,20,22,26,28,32,34,38,40,40,42,44,46,48,50,52,54],arguments:["l","t","cx1","cy1","x3","y1","x2","y3","hc","cy3","x5","y3","x4","y1","cx2","cy1","r","t","x6","y2","r","rh","cx5","cy4","x5","y5","x5","y6","hc","cy6","x2","y6","x2","y5","cx4","cy4","l","rh","wd8","y2","x2","y5","x2","y3","x5","y3","x5","y5","x3","y1","x3","y7","x4","y7","x4","y1"],attributes:{fill:G.e.None,extrusionOk:!1}}]},ellipseRibbon2:{adjustValues:{adj1:25e3,adj2:5e4,adj3:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(25e3,this.eval("adj2"),75e3)}},{key:"q10",get:function(){return 1e5-this.eval("a1")}},{key:"q11",get:function(){return 1*this.eval("q10")/2}},{key:"q12",get:function(){return this.eval("a1")+0-this.eval("q11")}},{key:"minAdj3",get:function(){return Math.max(0,this.eval("q12"))}},{key:"a3",get:function(){return this.pinTo(this.eval("minAdj3"),this.eval("adj3"),this.eval("a1"))}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a2")/2e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("x2")+this.eval("wd8")-0}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x3")}},{key:"x5",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("wd8")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a3")/1e5}},{key:"f1",get:function(){return 4*this.eval("dy1")/this.eval("w")}},{key:"q1",get:function(){return this.eval("x3")*this.eval("x3")/this.eval("w")}},{key:"q2",get:function(){return this.eval("x3")+0-this.eval("q1")}},{key:"u1",get:function(){return this.eval("f1")*this.eval("q2")/1}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("u1")}},{key:"cx1",get:function(){return 1*this.eval("x3")/2}},{key:"cu1",get:function(){return this.eval("f1")*this.eval("cx1")/1}},{key:"cy1",get:function(){return this.eval("b")+0-this.eval("cu1")}},{key:"cx2",get:function(){return this.eval("r")+0-this.eval("cx1")}},{key:"q14",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy3",get:function(){return this.eval("q14")+0-this.eval("dy1")}},{key:"q3",get:function(){return this.eval("x2")*this.eval("x2")/this.eval("w")}},{key:"q4",get:function(){return this.eval("x2")+0-this.eval("q3")}},{key:"q5",get:function(){return this.eval("f1")*this.eval("q4")/1}},{key:"u3",get:function(){return this.eval("q5")+this.eval("dy3")-0}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("u3")}},{key:"q6",get:function(){return this.eval("dy1")+this.eval("dy3")-this.eval("u3")}},{key:"q7",get:function(){return this.eval("q6")+this.eval("dy1")-0}},{key:"cu3",get:function(){return this.eval("q7")+this.eval("dy3")-0}},{key:"cy3",get:function(){return this.eval("b")+0-this.eval("cu3")}},{key:"rh",get:function(){return this.eval("b")+0-this.eval("q14")}},{key:"q8",get:function(){return 14*this.eval("dy1")/16}},{key:"u2",get:function(){return(this.eval("q8")+this.eval("rh"))/2}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("u2")}},{key:"u5",get:function(){return this.eval("q5")+this.eval("rh")-0}},{key:"y5",get:function(){return this.eval("b")+0-this.eval("u5")}},{key:"u6",get:function(){return this.eval("u3")+this.eval("rh")-0}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("u6")}},{key:"cx4",get:function(){return 1*this.eval("x2")/2}},{key:"q9",get:function(){return this.eval("f1")*this.eval("cx4")/1}},{key:"cu4",get:function(){return this.eval("q9")+this.eval("rh")-0}},{key:"cy4",get:function(){return this.eval("b")+0-this.eval("cu4")}},{key:"cx5",get:function(){return this.eval("r")+0-this.eval("cx4")}},{key:"cu6",get:function(){return this.eval("cu3")+this.eval("rh")-0}},{key:"cy6",get:function(){return this.eval("b")+0-this.eval("cu6")}},{key:"u7",get:function(){return this.eval("u1")+this.eval("dy3")-0}},{key:"y7",get:function(){return this.eval("b")+0-this.eval("u7")}},{key:"cu7",get:function(){return this.eval("q14")+this.eval("q14")-this.eval("u7")}},{key:"cy7",get:function(){return this.eval("b")+0-this.eval("cu7")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"rh",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:25e3,maxX:1e5},{isPolar:!1,x:"l",y:"dy1",gdRefY:"adj3",minY:"minAdj3",maxY:"a1"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd8",y:"y2"},{angle:"cd4",x:"hc",y:"rh"},{angle:0,x:"x6",y:"y2"}],textBoxRect:{left:"x2",top:"y6",right:"x5",bottom:"rh"},paths:[{commands:[G.d.MoveTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,22,26,28,32,34,38,40],arguments:["l","b","cx1","cy1","x3","y1","x2","y3","hc","cy3","x5","y3","x4","y1","cx2","cy1","r","b","x6","y2","r","q14","cx5","cy4","x5","y5","x5","y6","hc","cy6","x2","y6","x2","y5","cx4","cy4","l","q14","wd8","y2"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.Close],argumentIndices:[0,2,4,6,10,12,14,18],arguments:["x3","y7","x3","y1","x2","y3","hc","cy3","x5","y3","x4","y1","x4","y7","hc","cy7","x3","y7"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,10,12,16,18,22,24,26,30,32,36,38,42,42,44,46,48,50,52,54,56],arguments:["l","b","wd8","y2","l","q14","cx4","cy4","x2","y5","x2","y6","hc","cy6","x5","y6","x5","y5","cx5","cy4","r","q14","x6","y2","r","b","cx2","cy1","x4","y1","x5","y3","hc","cy3","x2","y3","x3","y1","cx1","cy1","l","b","x2","y3","x2","y5","x5","y5","x5","y3","x3","y7","x3","y1","x4","y1","x4","y7"],attributes:{fill:G.e.None,extrusionOk:!1}}]},flowChartAlternateProcess:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return this.eval("r")+0-this.eval("ssd6")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("ssd6")}},{key:"il",get:function(){return 29289*this.eval("ssd6")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,24],arguments:["l","ssd6","ssd6","ssd6","cd2","cd4","x2","t","ssd6","ssd6","3cd4","cd4","r","y2","ssd6","ssd6",0,"cd4","ssd6","b","ssd6","ssd6","cd4","cd4"],attributes:{}}]},flowChartCollate:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"ir",get:function(){return 3*this.eval("w")/4}},{key:"ib",get:function(){return 3*this.eval("h")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"hc",y:"vc"},{angle:"cd4",x:"hc",y:"b"}],textBoxRect:{left:"wd4",top:"hd4",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:[0,0,2,0,1,1,2,2,0,2,1,1],attributes:{w:2,h:2}}]},flowChartConnector:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{}}]},flowChartDecision:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"ir",get:function(){return 3*this.eval("w")/4}},{key:"ib",get:function(){return 3*this.eval("h")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd4",top:"hd4",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,1,1,0,2,1,1,2],attributes:{w:2,h:2}}]},flowChartDelay:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10],arguments:["l","t","hc","t","wd2","hd2","3cd4","cd2","l","b"],attributes:{}}]},flowChartDisplay:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 5*this.eval("w")/6}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd6",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,12],arguments:[0,3,1,0,5,0,1,3,"3cd4","cd2",1,6],attributes:{w:6,h:6}}]},flowChartDocument:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return 17322*this.eval("h")/21600}},{key:"y2",get:function(){return 20172*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"y2"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"y1"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo,G.d.Close],argumentIndices:[0,2,4,6,12],arguments:[0,0,21600,0,21600,17322,10800,17322,10800,23922,0,20172],attributes:{w:21600,h:21600}}]},flowChartExtract:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 3*this.eval("w")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd4",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x2",y:"vc"}],textBoxRect:{left:"wd4",top:"vc",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:[0,2,1,0,2,2],attributes:{w:2,h:2}}]},flowChartInputOutput:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x3",get:function(){return 2*this.eval("w")/5}},{key:"x4",get:function(){return 3*this.eval("w")/5}},{key:"x5",get:function(){return 4*this.eval("w")/5}},{key:"x6",get:function(){return 9*this.eval("w")/10}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"x4",y:"t"},{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd10",y:"vc"},{angle:"cd4",x:"x3",y:"b"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x6",y:"vc"}],textBoxRect:{left:"wd5",top:"t",right:"x5",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,5,1,0,5,0,4,5],attributes:{w:5,h:5}}]},flowChartInternalStorage:{connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd8",top:"hd8",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,1,0,1,1,0,1],attributes:{stroke:!1,extrusionOk:!1,w:1,h:1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:[1,0,1,8,0,1,8,1],attributes:{fill:G.e.None,extrusionOk:!1,w:8,h:8}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,1,0,1,1,0,1],attributes:{fill:G.e.None,w:1,h:1}}]},flowChartMagneticDisk:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y3",get:function(){return 5*this.eval("h")/6}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"hd3"},{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"hd3",right:"r",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:[0,1,3,1,"cd2","cd2",6,5,3,1,0,"cd2"],attributes:{stroke:!1,extrusionOk:!1,w:6,h:6}},{commands:[G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2],arguments:[6,1,3,1,0,"cd2"],attributes:{fill:G.e.None,extrusionOk:!1,w:6,h:6}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:[0,1,3,1,"cd2","cd2",6,5,3,1,0,"cd2"],attributes:{fill:G.e.None,w:6,h:6}}]},flowChartMagneticDrum:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 2*this.eval("w")/3}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x2",y:"vc"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd6",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14],arguments:[1,0,5,0,1,3,"3cd4","cd2",1,6,1,3,"cd4","cd2"],attributes:{stroke:!1,extrusionOk:!1,w:6,h:6}},{commands:[G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2],arguments:[5,6,1,3,"cd4","cd2"],attributes:{fill:G.e.None,extrusionOk:!1,w:6,h:6}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14],arguments:[1,0,5,0,1,3,"3cd4","cd2",1,6,1,3,"cd4","cd2"],attributes:{fill:G.e.None,w:6,h:6}}]},flowChartMagneticTape:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}},{key:"ang1",get:function(){return this.radianToAngle(Math.atan2(this.eval("h"),this.eval("w")))}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,20,22],arguments:["hc","b","wd2","hd2","cd4","cd4","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"ang1","r","ib","r","b"],attributes:{}}]},flowChartManualInput:{connectionSites:[{angle:"3cd4",x:"hc",y:"hd10"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"hd5",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,1,5,0,5,5,0,5],attributes:{w:5,h:5}}]},flowChartManualOperation:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x3",get:function(){return 4*this.eval("w")/5}},{key:"x4",get:function(){return 9*this.eval("w")/10}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd10",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x4",y:"vc"}],textBoxRect:{left:"wd5",top:"t",right:"x3",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,5,0,4,5,1,5],attributes:{w:5,h:5}}]},flowChartMerge:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 3*this.eval("w")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd4",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x2",y:"vc"}],textBoxRect:{left:"wd4",top:"t",right:"x2",bottom:"vc"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:[0,0,2,0,1,2],attributes:{w:2,h:2}}]},flowChartMultidocument:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y2",get:function(){return 3675*this.eval("h")/21600}},{key:"y8",get:function(){return 20782*this.eval("h")/21600}},{key:"x3",get:function(){return 9298*this.eval("w")/21600}},{key:"x4",get:function(){return 12286*this.eval("w")/21600}},{key:"x5",get:function(){return 18595*this.eval("w")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"x4",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x3",y:"y8"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"y2",right:"x5",bottom:"y8"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,8,10,12,12,14,16,18,20,26,28,28,30,32,34,36,42,44],arguments:[0,20782,9298,23542,9298,18022,18595,18022,18595,3675,0,3675,1532,3675,1532,1815,2e4,1815,2e4,16252,19298,16252,18595,16352,18595,16352,18595,3675,2972,1815,2972,0,21600,0,21600,14392,20800,14392,2e4,14467,2e4,14467,2e4,1815],attributes:{stroke:!1,extrusionOk:!1,w:21600,h:21600}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.CubicBezierTo],argumentIndices:[0,2,4,6,12,12,14,16,18,20,26,28,30,32,34],arguments:[0,3675,18595,3675,18595,18022,9298,18022,9298,23542,0,20782,1532,3675,1532,1815,2e4,1815,2e4,16252,19298,16252,18595,16352,18595,16352,2972,1815,2972,0,21600,0,21600,14392,20800,14392,2e4,14467,2e4,14467],attributes:{fill:G.e.None,extrusionOk:!1,w:21600,h:21600}},{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.LineTo,G.d.CubicBezierTo,G.d.LineTo,G.d.CubicBezierTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,8,10,16,18,24,26,28,30,32,34,36],arguments:[0,20782,9298,23542,9298,18022,18595,18022,18595,16352,18595,16352,19298,16252,2e4,16252,2e4,14467,2e4,14467,20800,14392,21600,14392,21600,0,2972,0,2972,1815,1532,1815,1532,3675,0,3675],attributes:{stroke:!1,fill:G.e.None,w:21600,h:21600}}]},flowChartOfflineStorage:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x4",get:function(){return 3*this.eval("w")/4}}]),t}(Ur),connectionSites:[{angle:0,x:"x4",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"wd4",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"wd4",top:"t",right:"x4",bottom:"vc"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:[0,0,2,0,1,2],attributes:{stroke:!1,extrusionOk:!1,w:2,h:2}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:[2,4,3,4],attributes:{fill:G.e.None,extrusionOk:!1,w:5,h:5}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:[0,0,2,0,1,2],attributes:{fill:G.e.None,extrusionOk:!0,w:2,h:2}}]},flowChartOffpageConnector:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y1",get:function(){return 4*this.eval("h")/5}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"y1"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:[0,0,10,0,10,8,5,10,0,8],attributes:{w:10,h:10}}]},flowChartOnlineStorage:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 5*this.eval("w")/6}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x2",y:"vc"}],textBoxRect:{left:"wd6",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14],arguments:[1,0,6,0,1,3,"3cd4",-108e5,1,6,1,3,"cd4","cd2"],attributes:{w:6,h:6}}]},flowChartOr:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["hc","t","hc","b","l","vc","r","vc"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{fill:G.e.None}}]},flowChartPredefinedProcess:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 7*this.eval("w")/8}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd8",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,1,0,1,1,0,1],attributes:{stroke:!1,extrusionOk:!1,w:1,h:1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:[1,0,1,8,7,0,7,8],attributes:{fill:G.e.None,extrusionOk:!1,w:8,h:8}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,1,0,1,1,0,1],attributes:{fill:G.e.None,w:1,h:1}}]},flowChartPreparation:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 4*this.eval("w")/5}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd5",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:[0,5,2,0,8,0,10,5,8,10,2,10],attributes:{w:10,h:10}}]},flowChartProcess:{connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,0,1,0,1,1,0,1],attributes:{w:1,h:1}}]},flowChartPunchedCard:{connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"hd5",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:[0,1,1,0,5,0,5,5,0,5],attributes:{w:5,h:5}}]},flowChartPunchedTape:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"y2",get:function(){return 9*this.eval("h")/10}},{key:"ib",get:function(){return 4*this.eval("h")/5}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"hd10"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"y2"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"hd5",right:"r",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,12,16,20],arguments:[0,2,5,2,"cd2",-108e5,5,2,"cd2","cd2",20,18,5,2,0,-108e5,5,2,0,"cd2"],attributes:{w:20,h:20}}]},flowChartSort:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"ir",get:function(){return 3*this.eval("w")/4}},{key:"ib",get:function(){return 3*this.eval("h")/4}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"wd4",top:"hd4",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,1,1,0,2,1,1,2],attributes:{stroke:!1,extrusionOk:!1,w:2,h:2}},{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:[0,1,2,1],attributes:{fill:G.e.None,extrusionOk:!1,w:2,h:2}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:[0,1,1,0,2,1,1,2],attributes:{fill:G.e.None,w:2,h:2}}]},flowChartSummingJunction:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6],arguments:["il","it","ir","ib","ir","it","il","ib"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{fill:G.e.None}}]},flowChartTerminator:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"il",get:function(){return 1018*this.eval("w")/21600}},{key:"ir",get:function(){return 20582*this.eval("w")/21600}},{key:"it",get:function(){return 3163*this.eval("h")/21600}},{key:"ib",get:function(){return 18437*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14],arguments:[3475,0,18125,0,3475,10800,"3cd4","cd2",3475,21600,3475,10800,"cd4","cd2"],attributes:{w:21600,h:21600}}]},foldedCorner:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"dy1",get:function(){return 1*this.eval("dy2")/5}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dy2")}},{key:"x2",get:function(){return this.eval("x1")+this.eval("dy1")-0}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"y1",get:function(){return this.eval("y2")+this.eval("dy1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"b",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:["l","t","r","t","r","y2","x1","b","l","b"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["x1","b","x2","y1","r","y2"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["x1","b","x2","y1","r","y2","x1","b","l","b","l","t","r","t","r","y2"],attributes:{fill:G.e.None,extrusionOk:!1}}]},frame:{adjustValues:{adj1:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("x1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj1",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x1",top:"x1",right:"x4",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16],arguments:["l","t","r","t","r","b","l","b","x1","x1","x1","y4","x4","y4","x4","x1"],attributes:{}}]},funnel:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"d",get:function(){return 1*this.eval("ss")/20}},{key:"rw2",get:function(){return this.eval("wd2")+0-this.eval("d")}},{key:"rh2",get:function(){return this.eval("hd4")+0-this.eval("d")}},{key:"t1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(48e4))}},{key:"t2",get:function(){return this.eval("hd4")*Math.sin(this.angleToRadian(48e4))}},{key:"da",get:function(){return this.radianToAngle(Math.atan2(this.eval("t2"),this.eval("t1")))}},{key:"2da",get:function(){return 2*this.eval("da")/1}},{key:"stAng1",get:function(){return this.eval("cd2")+0-this.eval("da")}},{key:"swAng1",get:function(){return this.eval("cd2")+this.eval("2da")-0}},{key:"swAng3",get:function(){return this.eval("cd2")+0-this.eval("2da")}},{key:"rw3",get:function(){return 1*this.eval("wd2")/4}},{key:"rh3",get:function(){return 1*this.eval("hd4")/4}},{key:"ct1",get:function(){return this.eval("hd4")*Math.cos(this.angleToRadian(this.eval("stAng1")))}},{key:"st1",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("stAng1")))}},{key:"m1",get:function(){return this.modulo(this.eval("ct1"),this.eval("st1"),0)}},{key:"n1",get:function(){return this.eval("wd2")*this.eval("hd4")/this.eval("m1")}},{key:"dx1",get:function(){return this.eval("n1")*Math.cos(this.angleToRadian(this.eval("stAng1")))}},{key:"dy1",get:function(){return this.eval("n1")*Math.sin(this.angleToRadian(this.eval("stAng1")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("hd4")+this.eval("dy1")-0}},{key:"ct3",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("da")))}},{key:"st3",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("da")))}},{key:"m3",get:function(){return this.modulo(this.eval("ct3"),this.eval("st3"),0)}},{key:"n3",get:function(){return this.eval("rw3")*this.eval("rh3")/this.eval("m3")}},{key:"dx3",get:function(){return this.eval("n3")*Math.cos(this.angleToRadian(this.eval("da")))}},{key:"dy3",get:function(){return this.eval("n3")*Math.sin(this.angleToRadian(this.eval("da")))}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"vc3",get:function(){return this.eval("b")+0-this.eval("rh3")}},{key:"y2",get:function(){return this.eval("vc3")+this.eval("dy3")-0}},{key:"x2",get:function(){return this.eval("wd2")+0-this.eval("rw2")}},{key:"cd",get:function(){return 2*this.eval("cd2")/1}}]),t}(Ur),textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,12,14,18],arguments:["x1","y1","wd2","hd4","stAng1","swAng1","x3","y2","rw3","rh3","da","swAng3","x2","hd4","rw2","rh2","cd2",-216e5],attributes:{}}]},gear6:{adjustValues:{adj1:15e3,adj2:3526},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),2e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5358)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"lFD",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"l2",get:function(){return 1*this.eval("lFD")/2}},{key:"l3",get:function(){return this.eval("th2")+this.eval("l2")-0}},{key:"rh",get:function(){return this.eval("hd2")+0-this.eval("th")}},{key:"rw",get:function(){return this.eval("wd2")+0-this.eval("th")}},{key:"dr",get:function(){return this.eval("rw")+0-this.eval("rh")}},{key:"maxr",get:function(){return this.eval("dr")>0?this.eval("rh"):this.eval("rw")}},{key:"ha",get:function(){return this.radianToAngle(Math.atan2(this.eval("l3"),this.eval("maxr")))}},{key:"aA1",get:function(){return 198e5-this.eval("ha")}},{key:"aD1",get:function(){return 198e5+this.eval("ha")-0}},{key:"ta11",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA1")))}},{key:"ta12",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA1")))}},{key:"bA1",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta12"),this.eval("ta11")))}},{key:"cta1",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bA1")))}},{key:"sta1",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bA1")))}},{key:"ma1",get:function(){return this.modulo(this.eval("cta1"),this.eval("sta1"),0)}},{key:"na1",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("ma1")}},{key:"dxa1",get:function(){return this.eval("na1")*Math.cos(this.angleToRadian(this.eval("bA1")))}},{key:"dya1",get:function(){return this.eval("na1")*Math.sin(this.angleToRadian(this.eval("bA1")))}},{key:"xA1",get:function(){return this.eval("hc")+this.eval("dxa1")-0}},{key:"yA1",get:function(){return this.eval("vc")+this.eval("dya1")-0}},{key:"td11",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD1")))}},{key:"td12",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD1")))}},{key:"bD1",get:function(){return this.radianToAngle(Math.atan2(this.eval("td12"),this.eval("td11")))}},{key:"ctd1",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD1")))}},{key:"std1",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD1")))}},{key:"md1",get:function(){return this.modulo(this.eval("ctd1"),this.eval("std1"),0)}},{key:"nd1",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md1")}},{key:"dxd1",get:function(){return this.eval("nd1")*Math.cos(this.angleToRadian(this.eval("bD1")))}},{key:"dyd1",get:function(){return this.eval("nd1")*Math.sin(this.angleToRadian(this.eval("bD1")))}},{key:"xD1",get:function(){return this.eval("hc")+this.eval("dxd1")-0}},{key:"yD1",get:function(){return this.eval("vc")+this.eval("dyd1")-0}},{key:"xAD1",get:function(){return this.eval("xA1")+0-this.eval("xD1")}},{key:"yAD1",get:function(){return this.eval("yA1")+0-this.eval("yD1")}},{key:"lAD1",get:function(){return this.modulo(this.eval("xAD1"),this.eval("yAD1"),0)}},{key:"a3",get:function(){return this.radianToAngle(Math.atan2(this.eval("xAD1"),this.eval("yAD1")))}},{key:"dxF1",get:function(){return this.eval("lFD")*Math.sin(this.angleToRadian(this.eval("a3")))}},{key:"dyF1",get:function(){return this.eval("lFD")*Math.cos(this.angleToRadian(this.eval("a3")))}},{key:"xF1",get:function(){return this.eval("xD1")+this.eval("dxF1")-0}},{key:"yF1",get:function(){return this.eval("yD1")+this.eval("dyF1")-0}},{key:"xE1",get:function(){return this.eval("xA1")+0-this.eval("dxF1")}},{key:"yE1",get:function(){return this.eval("yA1")+0-this.eval("dyF1")}},{key:"yC1t",get:function(){return this.eval("th")*Math.sin(this.angleToRadian(this.eval("a3")))}},{key:"xC1t",get:function(){return this.eval("th")*Math.cos(this.angleToRadian(this.eval("a3")))}},{key:"yC1",get:function(){return this.eval("yF1")+this.eval("yC1t")-0}},{key:"xC1",get:function(){return this.eval("xF1")+0-this.eval("xC1t")}},{key:"yB1",get:function(){return this.eval("yE1")+this.eval("yC1t")-0}},{key:"xB1",get:function(){return this.eval("xE1")+0-this.eval("xC1t")}},{key:"aD6",get:function(){return this.eval("3cd4")+this.eval("ha")-0}},{key:"td61",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD6")))}},{key:"td62",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD6")))}},{key:"bD6",get:function(){return this.radianToAngle(Math.atan2(this.eval("td62"),this.eval("td61")))}},{key:"ctd6",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD6")))}},{key:"std6",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD6")))}},{key:"md6",get:function(){return this.modulo(this.eval("ctd6"),this.eval("std6"),0)}},{key:"nd6",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md6")}},{key:"dxd6",get:function(){return this.eval("nd6")*Math.cos(this.angleToRadian(this.eval("bD6")))}},{key:"dyd6",get:function(){return this.eval("nd6")*Math.sin(this.angleToRadian(this.eval("bD6")))}},{key:"xD6",get:function(){return this.eval("hc")+this.eval("dxd6")-0}},{key:"yD6",get:function(){return this.eval("vc")+this.eval("dyd6")-0}},{key:"xA6",get:function(){return this.eval("hc")+0-this.eval("dxd6")}},{key:"xF6",get:function(){return this.eval("xD6")+0-this.eval("lFD")}},{key:"xE6",get:function(){return this.eval("xA6")+this.eval("lFD")-0}},{key:"yC6",get:function(){return this.eval("yD6")+0-this.eval("th")}},{key:"swAng1",get:function(){return this.eval("bA1")+0-this.eval("bD6")}},{key:"aA2",get:function(){return 18e5-this.eval("ha")}},{key:"aD2",get:function(){return 18e5+this.eval("ha")-0}},{key:"ta21",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA2")))}},{key:"ta22",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA2")))}},{key:"bA2",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta22"),this.eval("ta21")))}},{key:"yA2",get:function(){return this.eval("h")+0-this.eval("yD1")}},{key:"td21",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD2")))}},{key:"td22",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD2")))}},{key:"bD2",get:function(){return this.radianToAngle(Math.atan2(this.eval("td22"),this.eval("td21")))}},{key:"yD2",get:function(){return this.eval("h")+0-this.eval("yA1")}},{key:"yC2",get:function(){return this.eval("h")+0-this.eval("yB1")}},{key:"yB2",get:function(){return this.eval("h")+0-this.eval("yC1")}},{key:"xB2",get:function(){return this.eval("xC1")}},{key:"swAng2",get:function(){return this.eval("bA2")+0-this.eval("bD1")}},{key:"aD3",get:function(){return this.eval("cd4")+this.eval("ha")-0}},{key:"td31",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD3")))}},{key:"td32",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD3")))}},{key:"bD3",get:function(){return this.radianToAngle(Math.atan2(this.eval("td32"),this.eval("td31")))}},{key:"yD3",get:function(){return this.eval("h")+0-this.eval("yD6")}},{key:"yB3",get:function(){return this.eval("h")+0-this.eval("yC6")}},{key:"aD4",get:function(){return 9e6+this.eval("ha")-0}},{key:"td41",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD4")))}},{key:"td42",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD4")))}},{key:"bD4",get:function(){return this.radianToAngle(Math.atan2(this.eval("td42"),this.eval("td41")))}},{key:"xD4",get:function(){return this.eval("w")+0-this.eval("xD1")}},{key:"xC4",get:function(){return this.eval("w")+0-this.eval("xC1")}},{key:"xB4",get:function(){return this.eval("w")+0-this.eval("xB1")}},{key:"aD5",get:function(){return 126e5+this.eval("ha")-0}},{key:"td51",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD5")))}},{key:"td52",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD5")))}},{key:"bD5",get:function(){return this.radianToAngle(Math.atan2(this.eval("td52"),this.eval("td51")))}},{key:"xD5",get:function(){return this.eval("w")+0-this.eval("xA1")}},{key:"xC5",get:function(){return this.eval("w")+0-this.eval("xB1")}},{key:"xB5",get:function(){return this.eval("w")+0-this.eval("xC1")}},{key:"xCxn1",get:function(){return(this.eval("xB1")+this.eval("xC1"))/2}},{key:"yCxn1",get:function(){return(this.eval("yB1")+this.eval("yC1"))/2}},{key:"yCxn2",get:function(){return this.eval("b")+0-this.eval("yCxn1")}},{key:"xCxn4",get:function(){return(this.eval("r")+0)/this.eval("xCxn1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xD6",y:"yD6",gdRefY:"adj1",minY:0,maxY:2e4},{isPolar:!1,x:"xA6",y:"yD6",gdRefX:"adj2",minX:0,maxX:5358}],connectionSites:[{angle:198e5,x:"xCxn1",y:"yCxn1"},{angle:18e5,x:"xCxn1",y:"yCxn2"},{angle:"cd4",x:"hc",y:"yB3"},{angle:9e6,x:"xCxn4",y:"yCxn2"},{angle:126e5,x:"xCxn4",y:"yCxn1"},{angle:"3cd4",x:"hc",y:"yC6"}],textBoxRect:{left:"xD5",top:"yA1",right:"xA1",bottom:"yD2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,8,12,14,16,18,22,24,26,28,32,34,36,38,42,44,46,48,52,54,56,58,62],arguments:["xA1","yA1","xB1","yB1","xC1","yC1","xD1","yD1","rw","rh","bD1","swAng2","xC1","yB2","xB1","yC2","xA1","yD2","rw","rh","bD2","swAng1","xF6","yB3","xE6","yB3","xA6","yD3","rw","rh","bD3","swAng1","xB4","yC2","xC4","yB2","xD4","yA2","rw","rh","bD4","swAng2","xB5","yC1","xC5","yB1","xD5","yA1","rw","rh","bD5","swAng1","xE6","yC6","xF6","yC6","xD6","yD6","rw","rh","bD6","swAng1"],attributes:{}}]},gear9:{adjustValues:{adj1:1e4,adj2:1763},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),2e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),2679)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"lFD",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"l2",get:function(){return 1*this.eval("lFD")/2}},{key:"l3",get:function(){return this.eval("th2")+this.eval("l2")-0}},{key:"rh",get:function(){return this.eval("hd2")+0-this.eval("th")}},{key:"rw",get:function(){return this.eval("wd2")+0-this.eval("th")}},{key:"dr",get:function(){return this.eval("rw")+0-this.eval("rh")}},{key:"maxr",get:function(){return this.eval("dr")>0?this.eval("rh"):this.eval("rw")}},{key:"ha",get:function(){return this.radianToAngle(Math.atan2(this.eval("l3"),this.eval("maxr")))}},{key:"aA1",get:function(){return 186e5-this.eval("ha")}},{key:"aD1",get:function(){return 186e5+this.eval("ha")-0}},{key:"ta11",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA1")))}},{key:"ta12",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA1")))}},{key:"bA1",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta12"),this.eval("ta11")))}},{key:"cta1",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bA1")))}},{key:"sta1",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bA1")))}},{key:"ma1",get:function(){return this.modulo(this.eval("cta1"),this.eval("sta1"),0)}},{key:"na1",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("ma1")}},{key:"dxa1",get:function(){return this.eval("na1")*Math.cos(this.angleToRadian(this.eval("bA1")))}},{key:"dya1",get:function(){return this.eval("na1")*Math.sin(this.angleToRadian(this.eval("bA1")))}},{key:"xA1",get:function(){return this.eval("hc")+this.eval("dxa1")-0}},{key:"yA1",get:function(){return this.eval("vc")+this.eval("dya1")-0}},{key:"td11",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD1")))}},{key:"td12",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD1")))}},{key:"bD1",get:function(){return this.radianToAngle(Math.atan2(this.eval("td12"),this.eval("td11")))}},{key:"ctd1",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD1")))}},{key:"std1",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD1")))}},{key:"md1",get:function(){return this.modulo(this.eval("ctd1"),this.eval("std1"),0)}},{key:"nd1",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md1")}},{key:"dxd1",get:function(){return this.eval("nd1")*Math.cos(this.angleToRadian(this.eval("bD1")))}},{key:"dyd1",get:function(){return this.eval("nd1")*Math.sin(this.angleToRadian(this.eval("bD1")))}},{key:"xD1",get:function(){return this.eval("hc")+this.eval("dxd1")-0}},{key:"yD1",get:function(){return this.eval("vc")+this.eval("dyd1")-0}},{key:"xAD1",get:function(){return this.eval("xA1")+0-this.eval("xD1")}},{key:"yAD1",get:function(){return this.eval("yA1")+0-this.eval("yD1")}},{key:"lAD1",get:function(){return this.modulo(this.eval("xAD1"),this.eval("yAD1"),0)}},{key:"a5",get:function(){return this.radianToAngle(Math.atan2(this.eval("xAD1"),this.eval("yAD1")))}},{key:"dxF1",get:function(){return this.eval("lFD")*Math.sin(this.angleToRadian(this.eval("a5")))}},{key:"dyF1",get:function(){return this.eval("lFD")*Math.cos(this.angleToRadian(this.eval("a5")))}},{key:"xF1",get:function(){return this.eval("xD1")+this.eval("dxF1")-0}},{key:"yF1",get:function(){return this.eval("yD1")+this.eval("dyF1")-0}},{key:"xE1",get:function(){return this.eval("xA1")+0-this.eval("dxF1")}},{key:"yE1",get:function(){return this.eval("yA1")+0-this.eval("dyF1")}},{key:"yC1t",get:function(){return this.eval("th")*Math.sin(this.angleToRadian(this.eval("a5")))}},{key:"xC1t",get:function(){return this.eval("th")*Math.cos(this.angleToRadian(this.eval("a5")))}},{key:"yC1",get:function(){return this.eval("yF1")+this.eval("yC1t")-0}},{key:"xC1",get:function(){return this.eval("xF1")+0-this.eval("xC1t")}},{key:"yB1",get:function(){return this.eval("yE1")+this.eval("yC1t")-0}},{key:"xB1",get:function(){return this.eval("xE1")+0-this.eval("xC1t")}},{key:"aA2",get:function(){return 21e6-this.eval("ha")}},{key:"aD2",get:function(){return 21e6+this.eval("ha")-0}},{key:"ta21",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA2")))}},{key:"ta22",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA2")))}},{key:"bA2",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta22"),this.eval("ta21")))}},{key:"cta2",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bA2")))}},{key:"sta2",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bA2")))}},{key:"ma2",get:function(){return this.modulo(this.eval("cta2"),this.eval("sta2"),0)}},{key:"na2",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("ma2")}},{key:"dxa2",get:function(){return this.eval("na2")*Math.cos(this.angleToRadian(this.eval("bA2")))}},{key:"dya2",get:function(){return this.eval("na2")*Math.sin(this.angleToRadian(this.eval("bA2")))}},{key:"xA2",get:function(){return this.eval("hc")+this.eval("dxa2")-0}},{key:"yA2",get:function(){return this.eval("vc")+this.eval("dya2")-0}},{key:"td21",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD2")))}},{key:"td22",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD2")))}},{key:"bD2",get:function(){return this.radianToAngle(Math.atan2(this.eval("td22"),this.eval("td21")))}},{key:"ctd2",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD2")))}},{key:"std2",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD2")))}},{key:"md2",get:function(){return this.modulo(this.eval("ctd2"),this.eval("std2"),0)}},{key:"nd2",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md2")}},{key:"dxd2",get:function(){return this.eval("nd2")*Math.cos(this.angleToRadian(this.eval("bD2")))}},{key:"dyd2",get:function(){return this.eval("nd2")*Math.sin(this.angleToRadian(this.eval("bD2")))}},{key:"xD2",get:function(){return this.eval("hc")+this.eval("dxd2")-0}},{key:"yD2",get:function(){return this.eval("vc")+this.eval("dyd2")-0}},{key:"xAD2",get:function(){return this.eval("xA2")+0-this.eval("xD2")}},{key:"yAD2",get:function(){return this.eval("yA2")+0-this.eval("yD2")}},{key:"lAD2",get:function(){return this.modulo(this.eval("xAD2"),this.eval("yAD2"),0)}},{key:"a6",get:function(){return this.radianToAngle(Math.atan2(this.eval("xAD2"),this.eval("yAD2")))}},{key:"dxF2",get:function(){return this.eval("lFD")*Math.sin(this.angleToRadian(this.eval("a6")))}},{key:"dyF2",get:function(){return this.eval("lFD")*Math.cos(this.angleToRadian(this.eval("a6")))}},{key:"xF2",get:function(){return this.eval("xD2")+this.eval("dxF2")-0}},{key:"yF2",get:function(){return this.eval("yD2")+this.eval("dyF2")-0}},{key:"xE2",get:function(){return this.eval("xA2")+0-this.eval("dxF2")}},{key:"yE2",get:function(){return this.eval("yA2")+0-this.eval("dyF2")}},{key:"yC2t",get:function(){return this.eval("th")*Math.sin(this.angleToRadian(this.eval("a6")))}},{key:"xC2t",get:function(){return this.eval("th")*Math.cos(this.angleToRadian(this.eval("a6")))}},{key:"yC2",get:function(){return this.eval("yF2")+this.eval("yC2t")-0}},{key:"xC2",get:function(){return this.eval("xF2")+0-this.eval("xC2t")}},{key:"yB2",get:function(){return this.eval("yE2")+this.eval("yC2t")-0}},{key:"xB2",get:function(){return this.eval("xE2")+0-this.eval("xC2t")}},{key:"swAng1",get:function(){return this.eval("bA2")+0-this.eval("bD1")}},{key:"aA3",get:function(){return 18e5-this.eval("ha")}},{key:"aD3",get:function(){return 18e5+this.eval("ha")-0}},{key:"ta31",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA3")))}},{key:"ta32",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA3")))}},{key:"bA3",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta32"),this.eval("ta31")))}},{key:"cta3",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bA3")))}},{key:"sta3",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bA3")))}},{key:"ma3",get:function(){return this.modulo(this.eval("cta3"),this.eval("sta3"),0)}},{key:"na3",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("ma3")}},{key:"dxa3",get:function(){return this.eval("na3")*Math.cos(this.angleToRadian(this.eval("bA3")))}},{key:"dya3",get:function(){return this.eval("na3")*Math.sin(this.angleToRadian(this.eval("bA3")))}},{key:"xA3",get:function(){return this.eval("hc")+this.eval("dxa3")-0}},{key:"yA3",get:function(){return this.eval("vc")+this.eval("dya3")-0}},{key:"td31",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD3")))}},{key:"td32",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD3")))}},{key:"bD3",get:function(){return this.radianToAngle(Math.atan2(this.eval("td32"),this.eval("td31")))}},{key:"ctd3",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD3")))}},{key:"std3",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD3")))}},{key:"md3",get:function(){return this.modulo(this.eval("ctd3"),this.eval("std3"),0)}},{key:"nd3",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md3")}},{key:"dxd3",get:function(){return this.eval("nd3")*Math.cos(this.angleToRadian(this.eval("bD3")))}},{key:"dyd3",get:function(){return this.eval("nd3")*Math.sin(this.angleToRadian(this.eval("bD3")))}},{key:"xD3",get:function(){return this.eval("hc")+this.eval("dxd3")-0}},{key:"yD3",get:function(){return this.eval("vc")+this.eval("dyd3")-0}},{key:"xAD3",get:function(){return this.eval("xA3")+0-this.eval("xD3")}},{key:"yAD3",get:function(){return this.eval("yA3")+0-this.eval("yD3")}},{key:"lAD3",get:function(){return this.modulo(this.eval("xAD3"),this.eval("yAD3"),0)}},{key:"a3",get:function(){return this.radianToAngle(Math.atan2(this.eval("xAD3"),this.eval("yAD3")))}},{key:"dxF3",get:function(){return this.eval("lFD")*Math.sin(this.angleToRadian(this.eval("a3")))}},{key:"dyF3",get:function(){return this.eval("lFD")*Math.cos(this.angleToRadian(this.eval("a3")))}},{key:"xF3",get:function(){return this.eval("xD3")+this.eval("dxF3")-0}},{key:"yF3",get:function(){return this.eval("yD3")+this.eval("dyF3")-0}},{key:"xE3",get:function(){return this.eval("xA3")+0-this.eval("dxF3")}},{key:"yE3",get:function(){return this.eval("yA3")+0-this.eval("dyF3")}},{key:"yC3t",get:function(){return this.eval("th")*Math.sin(this.angleToRadian(this.eval("a3")))}},{key:"xC3t",get:function(){return this.eval("th")*Math.cos(this.angleToRadian(this.eval("a3")))}},{key:"yC3",get:function(){return this.eval("yF3")+this.eval("yC3t")-0}},{key:"xC3",get:function(){return this.eval("xF3")+0-this.eval("xC3t")}},{key:"yB3",get:function(){return this.eval("yE3")+this.eval("yC3t")-0}},{key:"xB3",get:function(){return this.eval("xE3")+0-this.eval("xC3t")}},{key:"swAng2",get:function(){return this.eval("bA3")+0-this.eval("bD2")}},{key:"aA4",get:function(){return 42e5-this.eval("ha")}},{key:"aD4",get:function(){return 42e5+this.eval("ha")-0}},{key:"ta41",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA4")))}},{key:"ta42",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA4")))}},{key:"bA4",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta42"),this.eval("ta41")))}},{key:"cta4",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bA4")))}},{key:"sta4",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bA4")))}},{key:"ma4",get:function(){return this.modulo(this.eval("cta4"),this.eval("sta4"),0)}},{key:"na4",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("ma4")}},{key:"dxa4",get:function(){return this.eval("na4")*Math.cos(this.angleToRadian(this.eval("bA4")))}},{key:"dya4",get:function(){return this.eval("na4")*Math.sin(this.angleToRadian(this.eval("bA4")))}},{key:"xA4",get:function(){return this.eval("hc")+this.eval("dxa4")-0}},{key:"yA4",get:function(){return this.eval("vc")+this.eval("dya4")-0}},{key:"td41",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD4")))}},{key:"td42",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD4")))}},{key:"bD4",get:function(){return this.radianToAngle(Math.atan2(this.eval("td42"),this.eval("td41")))}},{key:"ctd4",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD4")))}},{key:"std4",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD4")))}},{key:"md4",get:function(){return this.modulo(this.eval("ctd4"),this.eval("std4"),0)}},{key:"nd4",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md4")}},{key:"dxd4",get:function(){return this.eval("nd4")*Math.cos(this.angleToRadian(this.eval("bD4")))}},{key:"dyd4",get:function(){return this.eval("nd4")*Math.sin(this.angleToRadian(this.eval("bD4")))}},{key:"xD4",get:function(){return this.eval("hc")+this.eval("dxd4")-0}},{key:"yD4",get:function(){return this.eval("vc")+this.eval("dyd4")-0}},{key:"xAD4",get:function(){return this.eval("xA4")+0-this.eval("xD4")}},{key:"yAD4",get:function(){return this.eval("yA4")+0-this.eval("yD4")}},{key:"lAD4",get:function(){return this.modulo(this.eval("xAD4"),this.eval("yAD4"),0)}},{key:"a4",get:function(){return this.radianToAngle(Math.atan2(this.eval("xAD4"),this.eval("yAD4")))}},{key:"dxF4",get:function(){return this.eval("lFD")*Math.sin(this.angleToRadian(this.eval("a4")))}},{key:"dyF4",get:function(){return this.eval("lFD")*Math.cos(this.angleToRadian(this.eval("a4")))}},{key:"xF4",get:function(){return this.eval("xD4")+this.eval("dxF4")-0}},{key:"yF4",get:function(){return this.eval("yD4")+this.eval("dyF4")-0}},{key:"xE4",get:function(){return this.eval("xA4")+0-this.eval("dxF4")}},{key:"yE4",get:function(){return this.eval("yA4")+0-this.eval("dyF4")}},{key:"yC4t",get:function(){return this.eval("th")*Math.sin(this.angleToRadian(this.eval("a4")))}},{key:"xC4t",get:function(){return this.eval("th")*Math.cos(this.angleToRadian(this.eval("a4")))}},{key:"yC4",get:function(){return this.eval("yF4")+this.eval("yC4t")-0}},{key:"xC4",get:function(){return this.eval("xF4")+0-this.eval("xC4t")}},{key:"yB4",get:function(){return this.eval("yE4")+this.eval("yC4t")-0}},{key:"xB4",get:function(){return this.eval("xE4")+0-this.eval("xC4t")}},{key:"swAng3",get:function(){return this.eval("bA4")+0-this.eval("bD3")}},{key:"aA5",get:function(){return 66e5-this.eval("ha")}},{key:"aD5",get:function(){return 66e5+this.eval("ha")-0}},{key:"ta51",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA5")))}},{key:"ta52",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA5")))}},{key:"bA5",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta52"),this.eval("ta51")))}},{key:"td51",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD5")))}},{key:"td52",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD5")))}},{key:"bD5",get:function(){return this.radianToAngle(Math.atan2(this.eval("td52"),this.eval("td51")))}},{key:"xD5",get:function(){return this.eval("w")+0-this.eval("xA4")}},{key:"xC5",get:function(){return this.eval("w")+0-this.eval("xB4")}},{key:"xB5",get:function(){return this.eval("w")+0-this.eval("xC4")}},{key:"swAng4",get:function(){return this.eval("bA5")+0-this.eval("bD4")}},{key:"aD6",get:function(){return 9e6+this.eval("ha")-0}},{key:"td61",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD6")))}},{key:"td62",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD6")))}},{key:"bD6",get:function(){return this.radianToAngle(Math.atan2(this.eval("td62"),this.eval("td61")))}},{key:"xD6",get:function(){return this.eval("w")+0-this.eval("xA3")}},{key:"xC6",get:function(){return this.eval("w")+0-this.eval("xB3")}},{key:"xB6",get:function(){return this.eval("w")+0-this.eval("xC3")}},{key:"aD7",get:function(){return 114e5+this.eval("ha")-0}},{key:"td71",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD7")))}},{key:"td72",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD7")))}},{key:"bD7",get:function(){return this.radianToAngle(Math.atan2(this.eval("td72"),this.eval("td71")))}},{key:"xD7",get:function(){return this.eval("w")+0-this.eval("xA2")}},{key:"xC7",get:function(){return this.eval("w")+0-this.eval("xB2")}},{key:"xB7",get:function(){return this.eval("w")+0-this.eval("xC2")}},{key:"aD8",get:function(){return 138e5+this.eval("ha")-0}},{key:"td81",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD8")))}},{key:"td82",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD8")))}},{key:"bD8",get:function(){return this.radianToAngle(Math.atan2(this.eval("td82"),this.eval("td81")))}},{key:"xA8",get:function(){return this.eval("w")+0-this.eval("xD1")}},{key:"xD8",get:function(){return this.eval("w")+0-this.eval("xA1")}},{key:"xC8",get:function(){return this.eval("w")+0-this.eval("xB1")}},{key:"xB8",get:function(){return this.eval("w")+0-this.eval("xC1")}},{key:"aA9",get:function(){return this.eval("3cd4")+0-this.eval("ha")}},{key:"aD9",get:function(){return this.eval("3cd4")+this.eval("ha")-0}},{key:"td91",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aD9")))}},{key:"td92",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aD9")))}},{key:"bD9",get:function(){return this.radianToAngle(Math.atan2(this.eval("td92"),this.eval("td91")))}},{key:"ctd9",get:function(){return this.eval("rh")*Math.cos(this.angleToRadian(this.eval("bD9")))}},{key:"std9",get:function(){return this.eval("rw")*Math.sin(this.angleToRadian(this.eval("bD9")))}},{key:"md9",get:function(){return this.modulo(this.eval("ctd9"),this.eval("std9"),0)}},{key:"nd9",get:function(){return this.eval("rw")*this.eval("rh")/this.eval("md9")}},{key:"dxd9",get:function(){return this.eval("nd9")*Math.cos(this.angleToRadian(this.eval("bD9")))}},{key:"dyd9",get:function(){return this.eval("nd9")*Math.sin(this.angleToRadian(this.eval("bD9")))}},{key:"xD9",get:function(){return this.eval("hc")+this.eval("dxd9")-0}},{key:"yD9",get:function(){return this.eval("vc")+this.eval("dyd9")-0}},{key:"ta91",get:function(){return this.eval("rw")*Math.cos(this.angleToRadian(this.eval("aA9")))}},{key:"ta92",get:function(){return this.eval("rh")*Math.sin(this.angleToRadian(this.eval("aA9")))}},{key:"bA9",get:function(){return this.radianToAngle(Math.atan2(this.eval("ta92"),this.eval("ta91")))}},{key:"xA9",get:function(){return this.eval("hc")+0-this.eval("dxd9")}},{key:"xF9",get:function(){return this.eval("xD9")+0-this.eval("lFD")}},{key:"xE9",get:function(){return this.eval("xA9")+this.eval("lFD")-0}},{key:"yC9",get:function(){return this.eval("yD9")+0-this.eval("th")}},{key:"swAng5",get:function(){return this.eval("bA9")+0-this.eval("bD8")}},{key:"xCxn1",get:function(){return(this.eval("xB1")+this.eval("xC1"))/2}},{key:"yCxn1",get:function(){return(this.eval("yB1")+this.eval("yC1"))/2}},{key:"xCxn2",get:function(){return(this.eval("xB2")+this.eval("xC2"))/2}},{key:"yCxn2",get:function(){return(this.eval("yB2")+this.eval("yC2"))/2}},{key:"xCxn3",get:function(){return(this.eval("xB3")+this.eval("xC3"))/2}},{key:"yCxn3",get:function(){return(this.eval("yB3")+this.eval("yC3"))/2}},{key:"xCxn4",get:function(){return(this.eval("xB4")+this.eval("xC4"))/2}},{key:"yCxn4",get:function(){return(this.eval("yB4")+this.eval("yC4"))/2}},{key:"xCxn5",get:function(){return(this.eval("r")+0)/this.eval("xCxn4")}},{key:"xCxn6",get:function(){return(this.eval("r")+0)/this.eval("xCxn3")}},{key:"xCxn7",get:function(){return(this.eval("r")+0)/this.eval("xCxn2")}},{key:"xCxn8",get:function(){return(this.eval("r")+0)/this.eval("xCxn1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xD9",y:"yD9",gdRefY:"adj1",minY:0,maxY:2e4},{isPolar:!1,x:"xA9",y:"yD9",gdRefX:"adj2",minX:0,maxX:2679}],connectionSites:[{angle:186e5,x:"xCxn1",y:"yCxn1"},{angle:21e6,x:"xCxn2",y:"yCxn2"},{angle:18e5,x:"xCxn3",y:"yCxn3"},{angle:42e5,x:"xCxn4",y:"yCxn4"},{angle:66e5,x:"xCxn5",y:"yCxn4"},{angle:9e6,x:"xCxn6",y:"yCxn3"},{angle:114e5,x:"xCxn7",y:"yCxn2"},{angle:138e5,x:"xCxn8",y:"yCxn1"},{angle:"3cd4",x:"hc",y:"yC9"}],textBoxRect:{left:"xA8",top:"yD1",right:"xD1",bottom:"yD3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,8,12,14,16,18,22,24,26,28,32,34,36,38,42,44,46,48,52,54,56,58,62,64,66,68,72,74,76,78,82,84,86,88,92],arguments:["xA1","yA1","xB1","yB1","xC1","yC1","xD1","yD1","rw","rh","bD1","swAng1","xB2","yB2","xC2","yC2","xD2","yD2","rw","rh","bD2","swAng2","xB3","yB3","xC3","yC3","xD3","yD3","rw","rh","bD3","swAng3","xB4","yB4","xC4","yC4","xD4","yD4","rw","rh","bD4","swAng4","xB5","yC4","xC5","yB4","xD5","yA4","rw","rh","bD5","swAng3","xB6","yC3","xC6","yB3","xD6","yA3","rw","rh","bD6","swAng2","xB7","yC2","xC7","yB2","xD7","yA2","rw","rh","bD7","swAng1","xB8","yC1","xC8","yB1","xD8","yA1","rw","rh","bD8","swAng5","xE9","yC9","xF9","yC9","xD9","yD9","rw","rh","bD9","swAng5"],attributes:{}}]},halfFrame:{adjustValues:{adj1:33333,adj2:33333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"g1",get:function(){return this.eval("h")*this.eval("x1")/this.eval("w")}},{key:"g2",get:function(){return this.eval("h")+0-this.eval("g1")}},{key:"maxAdj1",get:function(){return 1e5*this.eval("g2")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"dx2",get:function(){return this.eval("y1")*this.eval("w")/this.eval("h")}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("dx2")}},{key:"dy2",get:function(){return this.eval("x1")*this.eval("h")/this.eval("w")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"cx1",get:function(){return 1*this.eval("x1")/2}},{key:"cy1",get:function(){return(this.eval("y2")+this.eval("b"))/2}},{key:"cx2",get:function(){return(this.eval("x2")+this.eval("r"))/2}},{key:"cy2",get:function(){return 1*this.eval("y1")/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:0,x:"cx2",y:"cy2"},{angle:"cd4",x:"cx1",y:"cy1"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["l","t","r","t","x2","y1","x1","y1","x1","y2","l","b"],attributes:{}}]},heart:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dx1",get:function(){return 49*this.eval("w")/48}},{key:"dx2",get:function(){return 10*this.eval("w")/48}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("t")+0-this.eval("hd3")}},{key:"il",get:function(){return 1*this.eval("w")/6}},{key:"ir",get:function(){return 5*this.eval("w")/6}},{key:"ib",get:function(){return 2*this.eval("h")/3}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"hd4"},{angle:"cd4",x:"hc",y:"b"}],textBoxRect:{left:"il",top:"hd4",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.CubicBezierTo,G.d.Close],argumentIndices:[0,2,8,14],arguments:["hc","hd4","x3","y1","x4","hd4","hc","b","x1","hd4","x2","y1","hc","hd4"],attributes:{}}]},heptagon:{adjustValues:{hf:102572,vf:105210},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"svc",get:function(){return this.eval("vc")*this.eval("vf")/1e5}},{key:"dx1",get:function(){return 97493*this.eval("swd2")/1e5}},{key:"dx2",get:function(){return 78183*this.eval("swd2")/1e5}},{key:"dx3",get:function(){return 43388*this.eval("swd2")/1e5}},{key:"dy1",get:function(){return 62349*this.eval("shd2")/1e5}},{key:"dy2",get:function(){return 22252*this.eval("shd2")/1e5}},{key:"dy3",get:function(){return 90097*this.eval("shd2")/1e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x6",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("svc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("svc")+this.eval("dy2")-0}},{key:"y3",get:function(){return this.eval("svc")+this.eval("dy3")-0}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("y1")}}]),t}(Ur),connectionSites:[{angle:0,x:"x5",y:"y1"},{angle:0,x:"x6",y:"y2"},{angle:"cd4",x:"x4",y:"y3"},{angle:"cd4",x:"x3",y:"y3"},{angle:"cd2",x:"x1",y:"y2"},{angle:"cd2",x:"x2",y:"y1"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"x2",top:"y1",right:"x5",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["x1","y2","x2","y1","hc","t","x5","y1","x6","y2","x4","y3","x3","y3"],attributes:{}}]},hexagon:{adjustValues:{adj:25e3,vf:115470},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"dy1",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(36e5))}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"q1",get:function(){return-1*this.eval("maxAdj")/2}},{key:"q2",get:function(){return this.eval("a")+this.eval("q1")-0}},{key:"q3",get:function(){return this.eval("q2")>0?4:2}},{key:"q4",get:function(){return this.eval("q2")>0?3:2}},{key:"q5",get:function(){return this.eval("q2")>0?this.eval("q1"):0}},{key:"q6",get:function(){return(this.eval("a")+this.eval("q5"))/this.eval("q1")}},{key:"q7",get:function(){return this.eval("q6")*this.eval("q4")/-1}},{key:"q8",get:function(){return this.eval("q3")+this.eval("q7")-0}},{key:"il",get:function(){return this.eval("w")*this.eval("q8")/24}},{key:"it",get:function(){return this.eval("h")*this.eval("q8")/24}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("it")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"x2",y:"y2"},{angle:"cd4",x:"x1",y:"y2"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"x1",y:"y1"},{angle:"3cd4",x:"x2",y:"y1"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12],arguments:["l","vc","x1","y1","x2","y1","r","vc","x2","y2","x1","y2"],attributes:{}}]},homePlate:{adjustValues:{adj:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"ir",get:function(){return(this.eval("x1")+this.eval("r"))/2}},{key:"x2",get:function(){return 1*this.eval("x1")/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:"3cd4",x:"x2",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:["l","t","x1","t","r","vc","x1","b","l","b"],attributes:{}}]},horizontalScroll:{adjustValues:{adj:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),25e3)}},{key:"ch",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"ch2",get:function(){return 1*this.eval("ch")/2}},{key:"ch4",get:function(){return 1*this.eval("ch")/4}},{key:"y3",get:function(){return this.eval("ch")+this.eval("ch2")-0}},{key:"y4",get:function(){return this.eval("ch")+this.eval("ch")-0}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("ch")}},{key:"y7",get:function(){return this.eval("b")+0-this.eval("ch2")}},{key:"y5",get:function(){return this.eval("y6")+0-this.eval("ch2")}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("ch")}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("ch2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"ch",y:"t",gdRefX:"adj",minX:0,maxX:25e3}],connectionSites:[{angle:"cd4",x:"hc",y:"ch"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"y6"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"ch",top:"ch",right:"x4",bottom:"y6"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,16,20,22,26,28,30,34,34,36,40,44],arguments:["r","ch2","ch2","ch2",0,"cd4","x4","ch2","ch4","ch4",0,"cd2","x3","ch","ch2","ch","ch2","ch2","3cd4",-54e5,"l","y7","ch2","ch2","cd2",-108e5,"ch","y6","x4","y6","ch2","ch2","cd4",-54e5,"ch2","y4","ch2","ch2","cd4",-54e5,"ch4","ch4",0,-108e5],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,10,12,16,20],arguments:["ch2","y4","ch2","ch2","cd4",-54e5,"ch4","ch4",0,-108e5,"x4","ch","ch2","ch2","cd4",-162e5,"ch4","ch4","cd2",-108e5],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,6,8,10,14,16,20,22,24,28,28,30,32,36,38,40,44,46,48,52,56,58],arguments:["l","y3","ch2","ch2","cd2","cd4","x3","ch","x3","ch2","ch2","ch2","cd2","cd2","r","y5","ch2","ch2",0,"cd4","ch","y6","ch","y7","ch2","ch2",0,"cd2","x3","ch","x4","ch","ch2","ch2","cd4",-54e5,"x4","ch","x4","ch2","ch4","ch4",0,"cd2","ch2","y4","ch2","y3","ch4","ch4","cd2","cd2","ch2","ch2",0,"cd2","ch","y3","ch","y6"],attributes:{fill:G.e.None,extrusionOk:!1}}]},irregularSeal1:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x5",get:function(){return 4627*this.eval("w")/21600}},{key:"x12",get:function(){return 8485*this.eval("w")/21600}},{key:"x21",get:function(){return 16702*this.eval("w")/21600}},{key:"x24",get:function(){return 14522*this.eval("w")/21600}},{key:"y3",get:function(){return 6320*this.eval("h")/21600}},{key:"y6",get:function(){return 8615*this.eval("h")/21600}},{key:"y9",get:function(){return 13937*this.eval("h")/21600}},{key:"y18",get:function(){return 13290*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"x24",y:"t"},{angle:"cd2",x:"l",y:"y6"},{angle:"cd4",x:"x12",y:"b"},{angle:0,x:"r",y:"y18"}],textBoxRect:{left:"x5",top:"y3",right:"x21",bottom:"y9"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48],arguments:[10800,5800,14522,0,14155,5325,18380,4457,16702,7315,21097,8137,17607,10475,21600,13290,16837,12942,18145,18095,14020,14457,13247,19737,10532,14935,8485,21600,7715,15627,4762,17617,5667,13937,135,14587,3722,11775,0,8615,4627,7617,370,2295,7312,6320,8352,2295],attributes:{w:21600,h:21600}}]},irregularSeal2:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x2",get:function(){return 9722*this.eval("w")/21600}},{key:"x5",get:function(){return 5372*this.eval("w")/21600}},{key:"x16",get:function(){return 11612*this.eval("w")/21600}},{key:"x19",get:function(){return 14640*this.eval("w")/21600}},{key:"y2",get:function(){return 1887*this.eval("h")/21600}},{key:"y3",get:function(){return 6382*this.eval("h")/21600}},{key:"y8",get:function(){return 12877*this.eval("h")/21600}},{key:"y14",get:function(){return 19712*this.eval("h")/21600}},{key:"y16",get:function(){return 18842*this.eval("h")/21600}},{key:"y17",get:function(){return 15935*this.eval("h")/21600}},{key:"y24",get:function(){return 6645*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"x2",y:"y2"},{angle:"cd2",x:"l",y:"y8"},{angle:"cd4",x:"x16",y:"y16"},{angle:0,x:"r",y:"y24"}],textBoxRect:{left:"x5",top:"y3",right:"x19",bottom:"y17"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56],arguments:[11462,4342,14790,0,14525,5777,18007,3172,16380,6532,21600,6645,16985,9402,18270,11290,16380,12310,18877,15632,14640,14350,14942,17370,12180,15935,11612,18842,9872,17370,8700,19712,7527,18125,4917,21600,4805,18240,1285,17825,3330,15370,0,12877,3935,11592,1172,8270,5372,7817,4502,3625,8550,6382,9722,1887],attributes:{w:21600,h:21600}}]},leftArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("l")+this.eval("dx2")-0}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"dx1",get:function(){return this.eval("y1")*this.eval("dx2")/this.eval("hd2")}},{key:"x1",get:function(){return this.eval("x2")+0-this.eval("dx1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"r",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"x2",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x2",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x1",top:"y1",right:"r",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["l","vc","x2","t","x2","y1","r","y1","r","y2","x2","y2","x2","b"],attributes:{}}]},leftArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:64977},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("w")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dy1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a4")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("dx2")}},{key:"x3",get:function(){return(this.eval("x2")+this.eval("r"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y2",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"l",y:"y1",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj3",minX:0,maxX:"maxAdj3"},{isPolar:!1,x:"x2",y:"b",gdRefX:"adj4",minX:0,maxX:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x3",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x2",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22],arguments:["l","vc","x1","y1","x1","y2","x2","y2","x2","t","r","t","r","b","x2","b","x2","y3","x1","y3","x1","y4"],attributes:{}}]},leftBrace:{adjustValues:{adj1:8333,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),1e5)}},{key:"q1",get:function(){return 1e5-this.eval("a2")}},{key:"q2",get:function(){return Math.min(this.eval("q1"),this.eval("a2"))}},{key:"q3",get:function(){return 1*this.eval("q2")/2}},{key:"maxAdj1",get:function(){return this.eval("q3")*this.eval("h")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("a2")/1e5}},{key:"y4",get:function(){return this.eval("y3")+this.eval("y1")-0}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"dy1",get:function(){return this.eval("y1")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"it",get:function(){return this.eval("y1")+0-this.eval("dy1")}},{key:"ib",get:function(){return this.eval("b")+this.eval("dy1")-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y1",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"l",y:"y3",gdRefY:"adj2",minY:0,maxY:1e5}],connectionSites:[{angle:"cd4",x:"r",y:"t"},{angle:"cd2",x:"l",y:"y3"},{angle:"3cd4",x:"r",y:"b"}],textBoxRect:{left:"il",top:"it",right:"r",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,16,18,22],arguments:["r","b","wd2","y1","cd4","cd4","hc","y4","wd2","y1",0,-54e5,"wd2","y1","cd4",-54e5,"hc","y1","wd2","y1","cd2","cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,16,18],arguments:["r","b","wd2","y1","cd4","cd4","hc","y4","wd2","y1",0,-54e5,"wd2","y1","cd4",-54e5,"hc","y1","wd2","y1","cd2","cd4"],attributes:{fill:G.e.None}}]},leftBracket:{adjustValues:{adj:8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"dx1",get:function(){return this.eval("w")*Math.cos(this.angleToRadian(27e5))}},{key:"dy1",get:function(){return this.eval("y1")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"it",get:function(){return this.eval("y1")+0-this.eval("dy1")}},{key:"ib",get:function(){return this.eval("b")+this.eval("dy1")-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj",minY:0,maxY:"maxAdj"}],connectionSites:[{angle:"cd4",x:"r",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"r",y:"b"}],textBoxRect:{left:"il",top:"it",right:"r",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["r","b","w","y1","cd4","cd4","l","y1","w","y1","cd2","cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8],arguments:["r","b","w","y1","cd4","cd4","l","y1","w","y1","cd2","cd4"],attributes:{fill:G.e.None}}]},leftCircularArrow:{adjustValues:{adj1:12500,adj2:-1142319,adj3:1142319,adj4:108e5,adj5:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a5",get:function(){return this.pinTo(0,this.eval("adj5"),25e3)}},{key:"maxAdj1",get:function(){return 2*this.eval("a5")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"enAng",get:function(){return this.pinTo(1,this.eval("adj3"),21599999)}},{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj4"),21599999)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"thh",get:function(){return this.eval("ss")*this.eval("a5")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"rw1",get:function(){return this.eval("wd2")+this.eval("th2")-this.eval("thh")}},{key:"rh1",get:function(){return this.eval("hd2")+this.eval("th2")-this.eval("thh")}},{key:"rw2",get:function(){return this.eval("rw1")+0-this.eval("th")}},{key:"rh2",get:function(){return this.eval("rh1")+0-this.eval("th")}},{key:"rw3",get:function(){return this.eval("rw2")+this.eval("th2")-0}},{key:"rh3",get:function(){return this.eval("rh2")+this.eval("th2")-0}},{key:"wtH",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"htH",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dxH",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"dyH",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"xH",get:function(){return this.eval("hc")+this.eval("dxH")-0}},{key:"yH",get:function(){return this.eval("vc")+this.eval("dyH")-0}},{key:"rI",get:function(){return Math.min(this.eval("rw2"),this.eval("rh2"))}},{key:"u1",get:function(){return this.eval("dxH")*this.eval("dxH")/1}},{key:"u2",get:function(){return this.eval("dyH")*this.eval("dyH")/1}},{key:"u3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"u4",get:function(){return this.eval("u1")+0-this.eval("u3")}},{key:"u5",get:function(){return this.eval("u2")+0-this.eval("u3")}},{key:"u6",get:function(){return this.eval("u4")*this.eval("u5")/this.eval("u1")}},{key:"u7",get:function(){return 1*this.eval("u6")/this.eval("u2")}},{key:"u8",get:function(){return 1-this.eval("u7")}},{key:"u9",get:function(){return Math.sqrtFix(this.eval("u8"))}},{key:"u10",get:function(){return 1*this.eval("u4")/this.eval("dxH")}},{key:"u11",get:function(){return 1*this.eval("u10")/this.eval("dyH")}},{key:"u12",get:function(){return(1+this.eval("u9"))/this.eval("u11")}},{key:"u13",get:function(){return this.radianToAngle(Math.atan2(this.eval("u12"),1))}},{key:"u14",get:function(){return this.eval("u13")+216e5-0}},{key:"u15",get:function(){return this.eval("u13")>0?this.eval("u13"):this.eval("u14")}},{key:"u16",get:function(){return this.eval("u15")+0-this.eval("enAng")}},{key:"u17",get:function(){return this.eval("u16")+216e5-0}},{key:"u18",get:function(){return this.eval("u16")>0?this.eval("u16"):this.eval("u17")}},{key:"u19",get:function(){return this.eval("u18")+0-this.eval("cd2")}},{key:"u20",get:function(){return this.eval("u18")+0-216e5}},{key:"u21",get:function(){return this.eval("u19")>0?this.eval("u20"):this.eval("u18")}},{key:"u22",get:function(){return Math.abs(this.eval("u21"))}},{key:"minAng",get:function(){return-1*this.eval("u22")/1}},{key:"u23",get:function(){return Math.abs(this.eval("adj2"))}},{key:"a2",get:function(){return-1*this.eval("u23")/1}},{key:"aAng",get:function(){return this.pinTo(this.eval("minAng"),this.eval("a2"),0)}},{key:"ptAng",get:function(){return this.eval("enAng")+this.eval("aAng")-0}},{key:"wtA",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"htA",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dxA",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"dyA",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"xA",get:function(){return this.eval("hc")+this.eval("dxA")-0}},{key:"yA",get:function(){return this.eval("vc")+this.eval("dyA")-0}},{key:"wtE",get:function(){return this.eval("rw1")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htE",get:function(){return this.eval("rh1")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxE",get:function(){return this.eval("rw1")*Math.cos(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"dyE",get:function(){return this.eval("rh1")*Math.sin(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"xE",get:function(){return this.eval("hc")+this.eval("dxE")-0}},{key:"yE",get:function(){return this.eval("vc")+this.eval("dyE")-0}},{key:"wtD",get:function(){return this.eval("rw2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htD",get:function(){return this.eval("rh2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxD",get:function(){return this.eval("rw2")*Math.cos(Math.atan2(this.eval("wtD"),this.eval("htD")))}},{key:"dyD",get:function(){return this.eval("rh2")*Math.sin(Math.atan2(this.eval("wtD"),this.eval("htD")))}},{key:"xD",get:function(){return this.eval("hc")+this.eval("dxD")-0}},{key:"yD",get:function(){return this.eval("vc")+this.eval("dyD")-0}},{key:"dxG",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyG",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xG",get:function(){return this.eval("xH")+this.eval("dxG")-0}},{key:"yG",get:function(){return this.eval("yH")+this.eval("dyG")-0}},{key:"dxB",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyB",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xB",get:function(){return this.eval("xH")+0-this.eval("dxB")}},{key:"yB",get:function(){return this.eval("yH")+0-this.eval("dyB")}},{key:"sx1",get:function(){return this.eval("xB")+0-this.eval("hc")}},{key:"sy1",get:function(){return this.eval("yB")+0-this.eval("vc")}},{key:"sx2",get:function(){return this.eval("xG")+0-this.eval("hc")}},{key:"sy2",get:function(){return this.eval("yG")+0-this.eval("vc")}},{key:"rO",get:function(){return Math.min(this.eval("rw1"),this.eval("rh1"))}},{key:"x1O",get:function(){return this.eval("sx1")*this.eval("rO")/this.eval("rw1")}},{key:"y1O",get:function(){return this.eval("sy1")*this.eval("rO")/this.eval("rh1")}},{key:"x2O",get:function(){return this.eval("sx2")*this.eval("rO")/this.eval("rw1")}},{key:"y2O",get:function(){return this.eval("sy2")*this.eval("rO")/this.eval("rh1")}},{key:"dxO",get:function(){return this.eval("x2O")+0-this.eval("x1O")}},{key:"dyO",get:function(){return this.eval("y2O")+0-this.eval("y1O")}},{key:"dO",get:function(){return this.modulo(this.eval("dxO"),this.eval("dyO"),0)}},{key:"q1",get:function(){return this.eval("x1O")*this.eval("y2O")/1}},{key:"q2",get:function(){return this.eval("x2O")*this.eval("y1O")/1}},{key:"DO",get:function(){return this.eval("q1")+0-this.eval("q2")}},{key:"q3",get:function(){return this.eval("rO")*this.eval("rO")/1}},{key:"q4",get:function(){return this.eval("dO")*this.eval("dO")/1}},{key:"q5",get:function(){return this.eval("q3")*this.eval("q4")/1}},{key:"q6",get:function(){return this.eval("DO")*this.eval("DO")/1}},{key:"q7",get:function(){return this.eval("q5")+0-this.eval("q6")}},{key:"q8",get:function(){return Math.max(this.eval("q7"),0)}},{key:"sdelO",get:function(){return Math.sqrtFix(this.eval("q8"))}},{key:"ndyO",get:function(){return-1*this.eval("dyO")/1}},{key:"sdyO",get:function(){return this.eval("ndyO")>0?-1:1}},{key:"q9",get:function(){return this.eval("sdyO")*this.eval("dxO")/1}},{key:"q10",get:function(){return this.eval("q9")*this.eval("sdelO")/1}},{key:"q11",get:function(){return this.eval("DO")*this.eval("dyO")/1}},{key:"dxF1",get:function(){return(this.eval("q11")+this.eval("q10"))/this.eval("q4")}},{key:"q12",get:function(){return this.eval("q11")+0-this.eval("q10")}},{key:"dxF2",get:function(){return 1*this.eval("q12")/this.eval("q4")}},{key:"adyO",get:function(){return Math.abs(this.eval("dyO"))}},{key:"q13",get:function(){return this.eval("adyO")*this.eval("sdelO")/1}},{key:"q14",get:function(){return this.eval("DO")*this.eval("dxO")/-1}},{key:"dyF1",get:function(){return(this.eval("q14")+this.eval("q13"))/this.eval("q4")}},{key:"q15",get:function(){return this.eval("q14")+0-this.eval("q13")}},{key:"dyF2",get:function(){return 1*this.eval("q15")/this.eval("q4")}},{key:"q16",get:function(){return this.eval("x2O")+0-this.eval("dxF1")}},{key:"q17",get:function(){return this.eval("x2O")+0-this.eval("dxF2")}},{key:"q18",get:function(){return this.eval("y2O")+0-this.eval("dyF1")}},{key:"q19",get:function(){return this.eval("y2O")+0-this.eval("dyF2")}},{key:"q20",get:function(){return this.modulo(this.eval("q16"),this.eval("q18"),0)}},{key:"q21",get:function(){return this.modulo(this.eval("q17"),this.eval("q19"),0)}},{key:"q22",get:function(){return this.eval("q21")+0-this.eval("q20")}},{key:"dxF",get:function(){return this.eval("q22")>0?this.eval("dxF1"):this.eval("dxF2")}},{key:"dyF",get:function(){return this.eval("q22")>0?this.eval("dyF1"):this.eval("dyF2")}},{key:"sdxF",get:function(){return this.eval("dxF")*this.eval("rw1")/this.eval("rO")}},{key:"sdyF",get:function(){return this.eval("dyF")*this.eval("rh1")/this.eval("rO")}},{key:"xF",get:function(){return this.eval("hc")+this.eval("sdxF")-0}},{key:"yF",get:function(){return this.eval("vc")+this.eval("sdyF")-0}},{key:"x1I",get:function(){return this.eval("sx1")*this.eval("rI")/this.eval("rw2")}},{key:"y1I",get:function(){return this.eval("sy1")*this.eval("rI")/this.eval("rh2")}},{key:"x2I",get:function(){return this.eval("sx2")*this.eval("rI")/this.eval("rw2")}},{key:"y2I",get:function(){return this.eval("sy2")*this.eval("rI")/this.eval("rh2")}},{key:"dxI",get:function(){return this.eval("x2I")+0-this.eval("x1I")}},{key:"dyI",get:function(){return this.eval("y2I")+0-this.eval("y1I")}},{key:"dI",get:function(){return this.modulo(this.eval("dxI"),this.eval("dyI"),0)}},{key:"v1",get:function(){return this.eval("x1I")*this.eval("y2I")/1}},{key:"v2",get:function(){return this.eval("x2I")*this.eval("y1I")/1}},{key:"DI",get:function(){return this.eval("v1")+0-this.eval("v2")}},{key:"v3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"v4",get:function(){return this.eval("dI")*this.eval("dI")/1}},{key:"v5",get:function(){return this.eval("v3")*this.eval("v4")/1}},{key:"v6",get:function(){return this.eval("DI")*this.eval("DI")/1}},{key:"v7",get:function(){return this.eval("v5")+0-this.eval("v6")}},{key:"v8",get:function(){return Math.max(this.eval("v7"),0)}},{key:"sdelI",get:function(){return Math.sqrtFix(this.eval("v8"))}},{key:"v9",get:function(){return this.eval("sdyO")*this.eval("dxI")/1}},{key:"v10",get:function(){return this.eval("v9")*this.eval("sdelI")/1}},{key:"v11",get:function(){return this.eval("DI")*this.eval("dyI")/1}},{key:"dxC1",get:function(){return(this.eval("v11")+this.eval("v10"))/this.eval("v4")}},{key:"v12",get:function(){return this.eval("v11")+0-this.eval("v10")}},{key:"dxC2",get:function(){return 1*this.eval("v12")/this.eval("v4")}},{key:"adyI",get:function(){return Math.abs(this.eval("dyI"))}},{key:"v13",get:function(){return this.eval("adyI")*this.eval("sdelI")/1}},{key:"v14",get:function(){return this.eval("DI")*this.eval("dxI")/-1}},{key:"dyC1",get:function(){return(this.eval("v14")+this.eval("v13"))/this.eval("v4")}},{key:"v15",get:function(){return this.eval("v14")+0-this.eval("v13")}},{key:"dyC2",get:function(){return 1*this.eval("v15")/this.eval("v4")}},{key:"v16",get:function(){return this.eval("x1I")+0-this.eval("dxC1")}},{key:"v17",get:function(){return this.eval("x1I")+0-this.eval("dxC2")}},{key:"v18",get:function(){return this.eval("y1I")+0-this.eval("dyC1")}},{key:"v19",get:function(){return this.eval("y1I")+0-this.eval("dyC2")}},{key:"v20",get:function(){return this.modulo(this.eval("v16"),this.eval("v18"),0)}},{key:"v21",get:function(){return this.modulo(this.eval("v17"),this.eval("v19"),0)}},{key:"v22",get:function(){return this.eval("v21")+0-this.eval("v20")}},{key:"dxC",get:function(){return this.eval("v22")>0?this.eval("dxC1"):this.eval("dxC2")}},{key:"dyC",get:function(){return this.eval("v22")>0?this.eval("dyC1"):this.eval("dyC2")}},{key:"sdxC",get:function(){return this.eval("dxC")*this.eval("rw2")/this.eval("rI")}},{key:"sdyC",get:function(){return this.eval("dyC")*this.eval("rh2")/this.eval("rI")}},{key:"xC",get:function(){return this.eval("hc")+this.eval("sdxC")-0}},{key:"yC",get:function(){return this.eval("vc")+this.eval("sdyC")-0}},{key:"ist0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyC"),this.eval("sdxC")))}},{key:"ist1",get:function(){return this.eval("ist0")+216e5-0}},{key:"istAng0",get:function(){return this.eval("ist0")>0?this.eval("ist0"):this.eval("ist1")}},{key:"isw1",get:function(){return this.eval("stAng")+0-this.eval("istAng0")}},{key:"isw2",get:function(){return this.eval("isw1")+216e5-0}},{key:"iswAng0",get:function(){return this.eval("isw1")>0?this.eval("isw1"):this.eval("isw2")}},{key:"istAng",get:function(){return this.eval("istAng0")+this.eval("iswAng0")-0}},{key:"iswAng",get:function(){return 0-this.eval("iswAng0")}},{key:"p1",get:function(){return this.eval("xF")+0-this.eval("xC")}},{key:"p2",get:function(){return this.eval("yF")+0-this.eval("yC")}},{key:"p3",get:function(){return this.modulo(this.eval("p1"),this.eval("p2"),0)}},{key:"p4",get:function(){return 1*this.eval("p3")/2}},{key:"p5",get:function(){return this.eval("p4")+0-this.eval("thh")}},{key:"xGp",get:function(){return this.eval("p5")>0?this.eval("xF"):this.eval("xG")}},{key:"yGp",get:function(){return this.eval("p5")>0?this.eval("yF"):this.eval("yG")}},{key:"xBp",get:function(){return this.eval("p5")>0?this.eval("xC"):this.eval("xB")}},{key:"yBp",get:function(){return this.eval("p5")>0?this.eval("yC"):this.eval("yB")}},{key:"en0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyF"),this.eval("sdxF")))}},{key:"en1",get:function(){return this.eval("en0")+216e5-0}},{key:"en2",get:function(){return this.eval("en0")>0?this.eval("en0"):this.eval("en1")}},{key:"sw0",get:function(){return this.eval("en2")+0-this.eval("stAng")}},{key:"sw1",get:function(){return this.eval("sw0")+0-216e5}},{key:"swAng",get:function(){return this.eval("sw0")>0?this.eval("sw1"):this.eval("sw0")}},{key:"stAng0",get:function(){return this.eval("stAng")+this.eval("swAng")-0}},{key:"swAng0",get:function(){return 0-this.eval("swAng")}},{key:"wtI",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htI",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxI2",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"dyI2",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"xI",get:function(){return this.eval("hc")+this.eval("dxI2")-0}},{key:"yI",get:function(){return this.eval("vc")+this.eval("dyI2")-0}},{key:"aI",get:function(){return this.eval("stAng")+this.eval("cd4")-0}},{key:"aA",get:function(){return this.eval("ptAng")+0-this.eval("cd4")}},{key:"aB",get:function(){return this.eval("ptAng")+this.eval("cd2")-0}},{key:"idx",get:function(){return this.eval("rw1")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("rh1")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"xA",y:"yA",gdRefAng:"adj2",minAng:"minAng",maxAng:0},{isPolar:!0,x:"xE",y:"yE",gdRefAng:"adj4",minAng:0,maxAng:21599999},{isPolar:!0,x:"xF",y:"yF",gdRefR:"adj1",minR:0,maxR:"maxAdj1",gdRefAng:"adj3",minAng:0,maxAng:21599999},{isPolar:!0,x:"xB",y:"yB",gdRefR:"adj5",minR:0,maxR:25e3}],connectionSites:[{angle:"aI",x:"xI",y:"yI"},{angle:"ptAng",x:"xGp",y:"yGp"},{angle:"aA",x:"xA",y:"yA"},{angle:"aB",x:"xBp",y:"yBp"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,12,14,16,20],arguments:["xE","yE","xD","yD","rw2","rh2","istAng","iswAng","xBp","yBp","xA","yA","xGp","yGp","xF","yF","rw1","rh1","stAng0","swAng0"],attributes:{}}]},leftRightArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"x2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"dy",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy")-0}},{key:"dx1",get:function(){return this.eval("y1")*this.eval("x2")/this.eval("hd2")}},{key:"x1",get:function(){return this.eval("x2")+0-this.eval("dx1")}},{key:"x4",get:function(){return this.eval("x3")+this.eval("dx1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"3cd4",x:"hc",y:"y1"},{angle:"3cd4",x:"x2",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x2",y:"b"},{angle:"cd4",x:"hc",y:"y2"},{angle:"cd4",x:"x3",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x1",top:"y1",right:"x4",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20],arguments:["l","vc","x2","t","x2","y1","x3","y1","x3","t","r","vc","x3","b","x3","y2","x2","y2","x2","b"],attributes:{}}]},leftRightArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:48123},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("wd2")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dy1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a4")/2e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y2",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"l",y:"y1",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj3",minX:0,maxX:"maxAdj3"},{isPolar:!1,x:"x2",y:"b",gdRefX:"adj4",minX:0,maxX:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x2",top:"t",right:"x3",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36],arguments:["l","vc","x1","y1","x1","y2","x2","y2","x2","t","x3","t","x3","y2","x4","y2","x4","y1","r","vc","x4","y4","x4","y3","x3","y3","x3","b","x2","b","x2","y3","x1","y3","x1","y4"],attributes:{}}]},leftRightCircularArrow:{adjustValues:{adj1:12500,adj2:1142319,adj3:20457681,adj4:11942319,adj5:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a5",get:function(){return this.pinTo(0,this.eval("adj5"),25e3)}},{key:"maxAdj1",get:function(){return 2*this.eval("a5")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"enAng",get:function(){return this.pinTo(1,this.eval("adj3"),21599999)}},{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj4"),21599999)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"thh",get:function(){return this.eval("ss")*this.eval("a5")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"rw1",get:function(){return this.eval("wd2")+this.eval("th2")-this.eval("thh")}},{key:"rh1",get:function(){return this.eval("hd2")+this.eval("th2")-this.eval("thh")}},{key:"rw2",get:function(){return this.eval("rw1")+0-this.eval("th")}},{key:"rh2",get:function(){return this.eval("rh1")+0-this.eval("th")}},{key:"rw3",get:function(){return this.eval("rw2")+this.eval("th2")-0}},{key:"rh3",get:function(){return this.eval("rh2")+this.eval("th2")-0}},{key:"wtH",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"htH",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dxH",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"dyH",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtH"),this.eval("htH")))}},{key:"xH",get:function(){return this.eval("hc")+this.eval("dxH")-0}},{key:"yH",get:function(){return this.eval("vc")+this.eval("dyH")-0}},{key:"rI",get:function(){return Math.min(this.eval("rw2"),this.eval("rh2"))}},{key:"u1",get:function(){return this.eval("dxH")*this.eval("dxH")/1}},{key:"u2",get:function(){return this.eval("dyH")*this.eval("dyH")/1}},{key:"u3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"u4",get:function(){return this.eval("u1")+0-this.eval("u3")}},{key:"u5",get:function(){return this.eval("u2")+0-this.eval("u3")}},{key:"u6",get:function(){return this.eval("u4")*this.eval("u5")/this.eval("u1")}},{key:"u7",get:function(){return 1*this.eval("u6")/this.eval("u2")}},{key:"u8",get:function(){return 1-this.eval("u7")}},{key:"u9",get:function(){return Math.sqrtFix(this.eval("u8"))}},{key:"u10",get:function(){return 1*this.eval("u4")/this.eval("dxH")}},{key:"u11",get:function(){return 1*this.eval("u10")/this.eval("dyH")}},{key:"u12",get:function(){return(1+this.eval("u9"))/this.eval("u11")}},{key:"u13",get:function(){return this.radianToAngle(Math.atan2(this.eval("u12"),1))}},{key:"u14",get:function(){return this.eval("u13")+216e5-0}},{key:"u15",get:function(){return this.eval("u13")>0?this.eval("u13"):this.eval("u14")}},{key:"u16",get:function(){return this.eval("u15")+0-this.eval("enAng")}},{key:"u17",get:function(){return this.eval("u16")+216e5-0}},{key:"u18",get:function(){return this.eval("u16")>0?this.eval("u16"):this.eval("u17")}},{key:"u19",get:function(){return this.eval("u18")+0-this.eval("cd2")}},{key:"u20",get:function(){return this.eval("u18")+0-216e5}},{key:"u21",get:function(){return this.eval("u19")>0?this.eval("u20"):this.eval("u18")}},{key:"maxAng",get:function(){return Math.abs(this.eval("u21"))}},{key:"aAng",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAng"))}},{key:"ptAng",get:function(){return this.eval("enAng")+this.eval("aAng")-0}},{key:"wtA",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"htA",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dxA",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"dyA",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtA"),this.eval("htA")))}},{key:"xA",get:function(){return this.eval("hc")+this.eval("dxA")-0}},{key:"yA",get:function(){return this.eval("vc")+this.eval("dyA")-0}},{key:"dxG",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyG",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xG",get:function(){return this.eval("xH")+this.eval("dxG")-0}},{key:"yG",get:function(){return this.eval("yH")+this.eval("dyG")-0}},{key:"dxB",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("ptAng")))}},{key:"dyB",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("ptAng")))}},{key:"xB",get:function(){return this.eval("xH")+0-this.eval("dxB")}},{key:"yB",get:function(){return this.eval("yH")+0-this.eval("dyB")}},{key:"sx1",get:function(){return this.eval("xB")+0-this.eval("hc")}},{key:"sy1",get:function(){return this.eval("yB")+0-this.eval("vc")}},{key:"sx2",get:function(){return this.eval("xG")+0-this.eval("hc")}},{key:"sy2",get:function(){return this.eval("yG")+0-this.eval("vc")}},{key:"rO",get:function(){return Math.min(this.eval("rw1"),this.eval("rh1"))}},{key:"x1O",get:function(){return this.eval("sx1")*this.eval("rO")/this.eval("rw1")}},{key:"y1O",get:function(){return this.eval("sy1")*this.eval("rO")/this.eval("rh1")}},{key:"x2O",get:function(){return this.eval("sx2")*this.eval("rO")/this.eval("rw1")}},{key:"y2O",get:function(){return this.eval("sy2")*this.eval("rO")/this.eval("rh1")}},{key:"dxO",get:function(){return this.eval("x2O")+0-this.eval("x1O")}},{key:"dyO",get:function(){return this.eval("y2O")+0-this.eval("y1O")}},{key:"dO",get:function(){return this.modulo(this.eval("dxO"),this.eval("dyO"),0)}},{key:"q1",get:function(){return this.eval("x1O")*this.eval("y2O")/1}},{key:"q2",get:function(){return this.eval("x2O")*this.eval("y1O")/1}},{key:"DO",get:function(){return this.eval("q1")+0-this.eval("q2")}},{key:"q3",get:function(){return this.eval("rO")*this.eval("rO")/1}},{key:"q4",get:function(){return this.eval("dO")*this.eval("dO")/1}},{key:"q5",get:function(){return this.eval("q3")*this.eval("q4")/1}},{key:"q6",get:function(){return this.eval("DO")*this.eval("DO")/1}},{key:"q7",get:function(){return this.eval("q5")+0-this.eval("q6")}},{key:"q8",get:function(){return Math.max(this.eval("q7"),0)}},{key:"sdelO",get:function(){return Math.sqrtFix(this.eval("q8"))}},{key:"ndyO",get:function(){return-1*this.eval("dyO")/1}},{key:"sdyO",get:function(){return this.eval("ndyO")>0?-1:1}},{key:"q9",get:function(){return this.eval("sdyO")*this.eval("dxO")/1}},{key:"q10",get:function(){return this.eval("q9")*this.eval("sdelO")/1}},{key:"q11",get:function(){return this.eval("DO")*this.eval("dyO")/1}},{key:"dxF1",get:function(){return(this.eval("q11")+this.eval("q10"))/this.eval("q4")}},{key:"q12",get:function(){return this.eval("q11")+0-this.eval("q10")}},{key:"dxF2",get:function(){return 1*this.eval("q12")/this.eval("q4")}},{key:"adyO",get:function(){return Math.abs(this.eval("dyO"))}},{key:"q13",get:function(){return this.eval("adyO")*this.eval("sdelO")/1}},{key:"q14",get:function(){return this.eval("DO")*this.eval("dxO")/-1}},{key:"dyF1",get:function(){return(this.eval("q14")+this.eval("q13"))/this.eval("q4")}},{key:"q15",get:function(){return this.eval("q14")+0-this.eval("q13")}},{key:"dyF2",get:function(){return 1*this.eval("q15")/this.eval("q4")}},{key:"q16",get:function(){return this.eval("x2O")+0-this.eval("dxF1")}},{key:"q17",get:function(){return this.eval("x2O")+0-this.eval("dxF2")}},{key:"q18",get:function(){return this.eval("y2O")+0-this.eval("dyF1")}},{key:"q19",get:function(){return this.eval("y2O")+0-this.eval("dyF2")}},{key:"q20",get:function(){return this.modulo(this.eval("q16"),this.eval("q18"),0)}},{key:"q21",get:function(){return this.modulo(this.eval("q17"),this.eval("q19"),0)}},{key:"q22",get:function(){return this.eval("q21")+0-this.eval("q20")}},{key:"dxF",get:function(){return this.eval("q22")>0?this.eval("dxF1"):this.eval("dxF2")}},{key:"dyF",get:function(){return this.eval("q22")>0?this.eval("dyF1"):this.eval("dyF2")}},{key:"sdxF",get:function(){return this.eval("dxF")*this.eval("rw1")/this.eval("rO")}},{key:"sdyF",get:function(){return this.eval("dyF")*this.eval("rh1")/this.eval("rO")}},{key:"xF",get:function(){return this.eval("hc")+this.eval("sdxF")-0}},{key:"yF",get:function(){return this.eval("vc")+this.eval("sdyF")-0}},{key:"x1I",get:function(){return this.eval("sx1")*this.eval("rI")/this.eval("rw2")}},{key:"y1I",get:function(){return this.eval("sy1")*this.eval("rI")/this.eval("rh2")}},{key:"x2I",get:function(){return this.eval("sx2")*this.eval("rI")/this.eval("rw2")}},{key:"y2I",get:function(){return this.eval("sy2")*this.eval("rI")/this.eval("rh2")}},{key:"dxI",get:function(){return this.eval("x2I")+0-this.eval("x1I")}},{key:"dyI",get:function(){return this.eval("y2I")+0-this.eval("y1I")}},{key:"dI",get:function(){return this.modulo(this.eval("dxI"),this.eval("dyI"),0)}},{key:"v1",get:function(){return this.eval("x1I")*this.eval("y2I")/1}},{key:"v2",get:function(){return this.eval("x2I")*this.eval("y1I")/1}},{key:"DI",get:function(){return this.eval("v1")+0-this.eval("v2")}},{key:"v3",get:function(){return this.eval("rI")*this.eval("rI")/1}},{key:"v4",get:function(){return this.eval("dI")*this.eval("dI")/1}},{key:"v5",get:function(){return this.eval("v3")*this.eval("v4")/1}},{key:"v6",get:function(){return this.eval("DI")*this.eval("DI")/1}},{key:"v7",get:function(){return this.eval("v5")+0-this.eval("v6")}},{key:"v8",get:function(){return Math.max(this.eval("v7"),0)}},{key:"sdelI",get:function(){return Math.sqrtFix(this.eval("v8"))}},{key:"v9",get:function(){return this.eval("sdyO")*this.eval("dxI")/1}},{key:"v10",get:function(){return this.eval("v9")*this.eval("sdelI")/1}},{key:"v11",get:function(){return this.eval("DI")*this.eval("dyI")/1}},{key:"dxC1",get:function(){return(this.eval("v11")+this.eval("v10"))/this.eval("v4")}},{key:"v12",get:function(){return this.eval("v11")+0-this.eval("v10")}},{key:"dxC2",get:function(){return 1*this.eval("v12")/this.eval("v4")}},{key:"adyI",get:function(){return Math.abs(this.eval("dyI"))}},{key:"v13",get:function(){return this.eval("adyI")*this.eval("sdelI")/1}},{key:"v14",get:function(){return this.eval("DI")*this.eval("dxI")/-1}},{key:"dyC1",get:function(){return(this.eval("v14")+this.eval("v13"))/this.eval("v4")}},{key:"v15",get:function(){return this.eval("v14")+0-this.eval("v13")}},{key:"dyC2",get:function(){return 1*this.eval("v15")/this.eval("v4")}},{key:"v16",get:function(){return this.eval("x1I")+0-this.eval("dxC1")}},{key:"v17",get:function(){return this.eval("x1I")+0-this.eval("dxC2")}},{key:"v18",get:function(){return this.eval("y1I")+0-this.eval("dyC1")}},{key:"v19",get:function(){return this.eval("y1I")+0-this.eval("dyC2")}},{key:"v20",get:function(){return this.modulo(this.eval("v16"),this.eval("v18"),0)}},{key:"v21",get:function(){return this.modulo(this.eval("v17"),this.eval("v19"),0)}},{key:"v22",get:function(){return this.eval("v21")+0-this.eval("v20")}},{key:"dxC",get:function(){return this.eval("v22")>0?this.eval("dxC1"):this.eval("dxC2")}},{key:"dyC",get:function(){return this.eval("v22")>0?this.eval("dyC1"):this.eval("dyC2")}},{key:"sdxC",get:function(){return this.eval("dxC")*this.eval("rw2")/this.eval("rI")}},{key:"sdyC",get:function(){return this.eval("dyC")*this.eval("rh2")/this.eval("rI")}},{key:"xC",get:function(){return this.eval("hc")+this.eval("sdxC")-0}},{key:"yC",get:function(){return this.eval("vc")+this.eval("sdyC")-0}},{key:"wtI",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"htI",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dxI2",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"dyI2",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtI"),this.eval("htI")))}},{key:"xI",get:function(){return this.eval("hc")+this.eval("dxI2")-0}},{key:"yI",get:function(){return this.eval("vc")+this.eval("dyI2")-0}},{key:"lptAng",get:function(){return this.eval("stAng")+0-this.eval("aAng")}},{key:"wtL",get:function(){return this.eval("rw3")*Math.sin(this.angleToRadian(this.eval("lptAng")))}},{key:"htL",get:function(){return this.eval("rh3")*Math.cos(this.angleToRadian(this.eval("lptAng")))}},{key:"dxL",get:function(){return this.eval("rw3")*Math.cos(Math.atan2(this.eval("wtL"),this.eval("htL")))}},{key:"dyL",get:function(){return this.eval("rh3")*Math.sin(Math.atan2(this.eval("wtL"),this.eval("htL")))}},{key:"xL",get:function(){return this.eval("hc")+this.eval("dxL")-0}},{key:"yL",get:function(){return this.eval("vc")+this.eval("dyL")-0}},{key:"dxK",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("lptAng")))}},{key:"dyK",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("lptAng")))}},{key:"xK",get:function(){return this.eval("xI")+this.eval("dxK")-0}},{key:"yK",get:function(){return this.eval("yI")+this.eval("dyK")-0}},{key:"dxJ",get:function(){return this.eval("thh")*Math.cos(this.angleToRadian(this.eval("lptAng")))}},{key:"dyJ",get:function(){return this.eval("thh")*Math.sin(this.angleToRadian(this.eval("lptAng")))}},{key:"xJ",get:function(){return this.eval("xI")+0-this.eval("dxJ")}},{key:"yJ",get:function(){return this.eval("yI")+0-this.eval("dyJ")}},{key:"p1",get:function(){return this.eval("xF")+0-this.eval("xC")}},{key:"p2",get:function(){return this.eval("yF")+0-this.eval("yC")}},{key:"p3",get:function(){return this.modulo(this.eval("p1"),this.eval("p2"),0)}},{key:"p4",get:function(){return 1*this.eval("p3")/2}},{key:"p5",get:function(){return this.eval("p4")+0-this.eval("thh")}},{key:"xGp",get:function(){return this.eval("p5")>0?this.eval("xF"):this.eval("xG")}},{key:"yGp",get:function(){return this.eval("p5")>0?this.eval("yF"):this.eval("yG")}},{key:"xBp",get:function(){return this.eval("p5")>0?this.eval("xC"):this.eval("xB")}},{key:"yBp",get:function(){return this.eval("p5")>0?this.eval("yC"):this.eval("yB")}},{key:"en0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyF"),this.eval("sdxF")))}},{key:"en1",get:function(){return this.eval("en0")+216e5-0}},{key:"en2",get:function(){return this.eval("en0")>0?this.eval("en0"):this.eval("en1")}},{key:"od0",get:function(){return this.eval("en2")+0-this.eval("enAng")}},{key:"od1",get:function(){return this.eval("od0")+216e5-0}},{key:"od2",get:function(){return this.eval("od0")>0?this.eval("od0"):this.eval("od1")}},{key:"st0",get:function(){return this.eval("stAng")+0-this.eval("od2")}},{key:"st1",get:function(){return this.eval("st0")+216e5-0}},{key:"st2",get:function(){return this.eval("st0")>0?this.eval("st0"):this.eval("st1")}},{key:"sw0",get:function(){return this.eval("en2")+0-this.eval("st2")}},{key:"sw1",get:function(){return this.eval("sw0")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw0")>0?this.eval("sw0"):this.eval("sw1")}},{key:"ist0",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdyC"),this.eval("sdxC")))}},{key:"ist1",get:function(){return this.eval("ist0")+216e5-0}},{key:"istAng",get:function(){return this.eval("ist0")>0?this.eval("ist0"):this.eval("ist1")}},{key:"id0",get:function(){return this.eval("istAng")+0-this.eval("enAng")}},{key:"id1",get:function(){return this.eval("id0")+0-216e5}},{key:"id2",get:function(){return this.eval("id0")>0?this.eval("id1"):this.eval("id0")}},{key:"ien0",get:function(){return this.eval("stAng")+0-this.eval("id2")}},{key:"ien1",get:function(){return this.eval("ien0")+0-216e5}},{key:"ien2",get:function(){return this.eval("ien1")>0?this.eval("ien1"):this.eval("ien0")}},{key:"isw1",get:function(){return this.eval("ien2")+0-this.eval("istAng")}},{key:"isw2",get:function(){return this.eval("isw1")+0-216e5}},{key:"iswAng",get:function(){return this.eval("isw1")>0?this.eval("isw2"):this.eval("isw1")}},{key:"wtE",get:function(){return this.eval("rw1")*Math.sin(this.angleToRadian(this.eval("st2")))}},{key:"htE",get:function(){return this.eval("rh1")*Math.cos(this.angleToRadian(this.eval("st2")))}},{key:"dxE",get:function(){return this.eval("rw1")*Math.cos(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"dyE",get:function(){return this.eval("rh1")*Math.sin(Math.atan2(this.eval("wtE"),this.eval("htE")))}},{key:"xE",get:function(){return this.eval("hc")+this.eval("dxE")-0}},{key:"yE",get:function(){return this.eval("vc")+this.eval("dyE")-0}},{key:"wtD",get:function(){return this.eval("rw2")*Math.sin(this.angleToRadian(this.eval("ien2")))}},{key:"htD",get:function(){return this.eval("rh2")*Math.cos(this.angleToRadian(this.eval("ien2")))}},{key:"dxD",get:function(){return this.eval("rw2")*Math.cos(Math.atan2(this.eval("wtD"),this.eval("htD")))}},{key:"dyD",get:function(){return this.eval("rh2")*Math.sin(Math.atan2(this.eval("wtD"),this.eval("htD")))}},{key:"xD",get:function(){return this.eval("hc")+this.eval("dxD")-0}},{key:"yD",get:function(){return this.eval("vc")+this.eval("dyD")-0}},{key:"xKp",get:function(){return this.eval("p5")>0?this.eval("xE"):this.eval("xK")}},{key:"yKp",get:function(){return this.eval("p5")>0?this.eval("yE"):this.eval("yK")}},{key:"xJp",get:function(){return this.eval("p5")>0?this.eval("xD"):this.eval("xJ")}},{key:"yJp",get:function(){return this.eval("p5")>0?this.eval("yD"):this.eval("yJ")}},{key:"aL",get:function(){return this.eval("lptAng")+0-this.eval("cd4")}},{key:"aA",get:function(){return this.eval("ptAng")+this.eval("cd4")-0}},{key:"aB",get:function(){return this.eval("ptAng")+this.eval("cd2")-0}},{key:"aJ",get:function(){return this.eval("lptAng")+this.eval("cd2")-0}},{key:"idx",get:function(){return this.eval("rw1")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("rh1")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"xA",y:"yA",gdRefAng:"adj2",minAng:0,maxAng:"maxAng"},{isPolar:!0,x:"xE",y:"yE",gdRefAng:"adj4",minAng:0,maxAng:21599999},{isPolar:!0,x:"xF",y:"yF",gdRefR:"adj1",minR:0,maxR:"maxAdj1",gdRefAng:"adj3",minAng:0,maxAng:21599999},{isPolar:!0,x:"xB",y:"yB",gdRefR:"adj5",minR:0,maxR:25e3}],connectionSites:[{angle:"aL",x:"xL",y:"yL"},{angle:"lptAng",x:"xKp",y:"yKp"},{angle:"ptAng",x:"xGp",y:"yGp"},{angle:"aA",x:"xA",y:"yA"},{angle:"aB",x:"xBp",y:"yBp"},{angle:"aJ",x:"xJp",y:"yJp"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,10,12,14,16,18,22,24],arguments:["xL","yL","xKp","yKp","xE","yE","rw1","rh1","st2","swAng","xGp","yGp","xA","yA","xBp","yBp","xC","yC","rw2","rh2","istAng","iswAng","xJp","yJp"],attributes:{}}]},leftRightRibbon:{adjustValues:{adj1:5e4,adj2:5e4,adj3:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),33333)}},{key:"maxAdj1",get:function(){return 1e5-this.eval("a3")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"w1",get:function(){return this.eval("wd2")+0-this.eval("wd32")}},{key:"maxAdj2",get:function(){return 1e5*this.eval("w1")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a3")/-2e5}},{key:"ly1",get:function(){return this.eval("vc")+this.eval("dy2")-this.eval("dy1")}},{key:"ry4",get:function(){return this.eval("vc")+this.eval("dy1")-this.eval("dy2")}},{key:"ly2",get:function(){return this.eval("ly1")+this.eval("dy1")-0}},{key:"ry3",get:function(){return this.eval("b")+0-this.eval("ly2")}},{key:"ly4",get:function(){return 2*this.eval("ly2")/1}},{key:"ry1",get:function(){return this.eval("b")+0-this.eval("ly4")}},{key:"ly3",get:function(){return this.eval("ly4")+0-this.eval("ly1")}},{key:"ry2",get:function(){return this.eval("b")+0-this.eval("ly3")}},{key:"hR",get:function(){return this.eval("a3")*this.eval("ss")/4e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("wd32")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("wd32")-0}},{key:"y1",get:function(){return this.eval("ly1")+this.eval("hR")-0}},{key:"y2",get:function(){return this.eval("ry2")+0-this.eval("hR")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x4",y:"ry2",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"x3",y:"ry2",gdRefY:"adj3",minY:0,maxY:33333}],connectionSites:[{angle:0,x:"r",y:"ry3"},{angle:"cd4",x:"x4",y:"b"},{angle:"cd4",x:"x1",y:"ly4"},{angle:"cd2",x:"l",y:"ly2"},{angle:"3cd4",x:"x1",y:"t"},{angle:"3cd4",x:"x4",y:"ry1"}],textBoxRect:{left:"x1",top:"ly1",right:"x4",bottom:"ry4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,12,16,18,20,22,24,26,28,32,34,36,38],arguments:["l","ly2","x1","t","x1","ly1","hc","ly1","wd32","hR","3cd4","cd2","wd32","hR","3cd4",-108e5,"x4","ry2","x4","ry1","r","ry3","x4","b","x4","ry4","hc","ry4","wd32","hR","cd4","cd4","x2","ly3","x1","ly3","x1","ly4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,10,12],arguments:["x3","y1","wd32","hR",0,"cd4","wd32","hR","3cd4",-108e5,"x3","ry2"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,12,16,18,20,22,24,26,28,32,34,36,38,38,40,42,44],arguments:["l","ly2","x1","t","x1","ly1","hc","ly1","wd32","hR","3cd4","cd2","wd32","hR","3cd4",-108e5,"x4","ry2","x4","ry1","r","ry3","x4","b","x4","ry4","hc","ry4","wd32","hR","cd4","cd4","x2","ly3","x1","ly3","x1","ly4","x3","y1","x3","ry2","x2","y2","x2","ly3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},leftRightUpArrow:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"q1",get:function(){return 1e5-this.eval("maxAdj1")}},{key:"maxAdj3",get:function(){return 1*this.eval("q1")/2}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a2")/5e4}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("dx2")}},{key:"y3",get:function(){return this.eval("y4")+0-this.eval("dx3")}},{key:"y5",get:function(){return this.eval("y4")+this.eval("dx3")-0}},{key:"il",get:function(){return this.eval("dx3")*this.eval("x1")/this.eval("dx2")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"x1",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4},{isPolar:!1,x:"r",y:"x1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y4"},{angle:"cd4",x:"hc",y:"y5"},{angle:0,x:"r",y:"y4"}],textBoxRect:{left:"il",top:"y3",right:"ir",bottom:"y5"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34],arguments:["l","y4","x1","y2","x1","y3","x3","y3","x3","x1","x2","x1","hc","t","x5","x1","x4","x1","x4","y3","x6","y3","x6","y2","r","y4","x6","b","x6","y5","x1","y5","x1","b"],attributes:{}}]},leftUpArrow:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 1e5-this.eval("maxAdj1")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/5e4}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("dx2")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dx2")}},{key:"dx4",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("dx4")}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("dx4")}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x3",get:function(){return this.eval("x4")+0-this.eval("dx3")}},{key:"x5",get:function(){return this.eval("x4")+this.eval("dx3")-0}},{key:"y3",get:function(){return this.eval("y4")+0-this.eval("dx3")}},{key:"y5",get:function(){return this.eval("y4")+this.eval("dx3")-0}},{key:"il",get:function(){return this.eval("dx3")*this.eval("x1")/this.eval("dx4")}},{key:"cx1",get:function(){return(this.eval("x1")+this.eval("x5"))/2}},{key:"cy1",get:function(){return(this.eval("x1")+this.eval("y5"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"y3",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4},{isPolar:!1,x:"x3",y:"x1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:"3cd4",x:"x4",y:"t"},{angle:"cd2",x:"x2",y:"x1"},{angle:"3cd4",x:"x1",y:"y2"},{angle:"cd2",x:"l",y:"y4"},{angle:"cd4",x:"x1",y:"b"},{angle:"cd4",x:"cx1",y:"y5"},{angle:0,x:"x5",y:"cy1"},{angle:0,x:"r",y:"x1"}],textBoxRect:{left:"il",top:"y3",right:"x4",bottom:"y5"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["l","y4","x1","y2","x1","y3","x3","y3","x3","x1","x2","x1","x4","t","r","x1","x5","x1","x5","y5","x1","y5","x1","b"],attributes:{}}]},lightningBolt:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"x1",get:function(){return 5022*this.eval("w")/21600}},{key:"x3",get:function(){return 8472*this.eval("w")/21600}},{key:"x4",get:function(){return 8757*this.eval("w")/21600}},{key:"x5",get:function(){return 10012*this.eval("w")/21600}},{key:"x8",get:function(){return 12860*this.eval("w")/21600}},{key:"x9",get:function(){return 13917*this.eval("w")/21600}},{key:"x11",get:function(){return 16577*this.eval("w")/21600}},{key:"y1",get:function(){return 3890*this.eval("h")/21600}},{key:"y2",get:function(){return 6080*this.eval("h")/21600}},{key:"y4",get:function(){return 7437*this.eval("h")/21600}},{key:"y6",get:function(){return 9705*this.eval("h")/21600}},{key:"y7",get:function(){return 12007*this.eval("h")/21600}},{key:"y10",get:function(){return 14277*this.eval("h")/21600}},{key:"y11",get:function(){return 14915*this.eval("h")/21600}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"x3",y:"t"},{angle:"3cd4",x:"l",y:"y1"},{angle:"cd2",x:"x1",y:"y6"},{angle:"cd2",x:"x5",y:"y11"},{angle:"cd4",x:"r",y:"b"},{angle:0,x:"x11",y:"y7"},{angle:0,x:"x8",y:"y2"}],textBoxRect:{left:"x4",top:"y4",right:"x9",bottom:"y10"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22],arguments:[8472,0,12860,6080,11050,6797,16577,12007,14767,12877,21600,21600,10012,14915,12222,13987,5022,9705,7602,8382,0,3890],attributes:{w:21600,h:21600}}]},line:{connectionSites:[{angle:"cd4",x:"l",y:"t"},{angle:"3cd4",x:"r",y:"b"}],paths:[{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["l","t","r","b"],attributes:{}}]},lineInv:{connectionSites:[{angle:"cd4",x:"l",y:"b"},{angle:"3cd4",x:"r",y:"t"}],paths:[{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["l","b","r","t"],attributes:{}}]},mathDivide:{adjustValues:{adj1:23520,adj2:5880,adj3:11760},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(1e3,this.eval("adj1"),36745)}},{key:"ma1",get:function(){return 0-this.eval("a1")}},{key:"ma3h",get:function(){return(73490+this.eval("ma1"))/4}},{key:"ma3w",get:function(){return 36745*this.eval("w")/this.eval("h")}},{key:"maxAdj3",get:function(){return Math.min(this.eval("ma3h"),this.eval("ma3w"))}},{key:"a3",get:function(){return this.pinTo(1e3,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"m4a3",get:function(){return-4*this.eval("a3")/1}},{key:"maxAdj2",get:function(){return 73490+this.eval("m4a3")-this.eval("a1")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"yg",get:function(){return this.eval("h")*this.eval("a2")/1e5}},{key:"rad",get:function(){return this.eval("h")*this.eval("a3")/1e5}},{key:"dx1",get:function(){return 73490*this.eval("w")/2e5}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"a",get:function(){return this.eval("yg")+this.eval("rad")-0}},{key:"y2",get:function(){return this.eval("y3")+0-this.eval("a")}},{key:"y1",get:function(){return this.eval("y2")+0-this.eval("rad")}},{key:"y5",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("rad")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y3",gdRefY:"adj1",minY:1e3,maxY:36745},{isPolar:!1,x:"r",y:"y2",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj3",minX:1e3,maxX:"maxAdj3"}],connectionSites:[{angle:0,x:"x3",y:"vc"},{angle:"cd4",x:"hc",y:"y5"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"hc",y:"y1"}],textBoxRect:{left:"x1",top:"y3",right:"x3",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,6,8,12,12,14,16,18,20],arguments:["hc","y1","rad","rad","3cd4",216e5,"hc","y5","rad","rad","cd4",216e5,"x1","y3","x3","y3","x3","y4","x1","y4"],attributes:{}}]},mathEqual:{adjustValues:{adj1:23520,adj2:11760},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),36745)}},{key:"2a1",get:function(){return 2*this.eval("a1")/1}},{key:"mAdj2",get:function(){return 1e5-this.eval("2a1")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("mAdj2"))}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a2")/2e5}},{key:"dx1",get:function(){return 73490*this.eval("w")/2e5}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y1",get:function(){return this.eval("y2")+0-this.eval("dy1")}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dy1")-0}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"yC1",get:function(){return(this.eval("y1")+this.eval("y2"))/2}},{key:"yC2",get:function(){return(this.eval("y3")+this.eval("y4"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:36745},{isPolar:!1,x:"r",y:"y2",gdRefY:"adj2",minY:0,maxY:"mAdj2"}],connectionSites:[{angle:0,x:"x2",y:"yC1"},{angle:0,x:"x2",y:"yC2"},{angle:"cd4",x:"hc",y:"y4"},{angle:"cd2",x:"x1",y:"yC1"},{angle:"cd2",x:"x1",y:"yC2"},{angle:"3cd4",x:"hc",y:"y1"}],textBoxRect:{left:"x1",top:"y1",right:"x2",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16],arguments:["x1","y1","x2","y1","x2","y2","x1","y2","x1","y3","x2","y3","x2","y4","x1","y4"],attributes:{}}]},mathMinus:{adjustValues:{adj1:23520},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"dx1",get:function(){return 73490*this.eval("w")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5}],connectionSites:[{angle:0,x:"x2",y:"vc"},{angle:"cd4",x:"hc",y:"y2"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"hc",y:"y1"}],textBoxRect:{left:"x1",top:"y1",right:"x2",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["x1","y1","x2","y1","x2","y2","x1","y2"],attributes:{}}]},mathMultiply:{adjustValues:{adj1:23520},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),51965)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"a",get:function(){return this.radianToAngle(Math.atan2(this.eval("h"),this.eval("w")))}},{key:"sa",get:function(){return 1*Math.sin(this.angleToRadian(this.eval("a")))}},{key:"ca",get:function(){return 1*Math.cos(this.angleToRadian(this.eval("a")))}},{key:"ta",get:function(){return 1*Math.tan(this.angleToRadian(this.eval("a")))}},{key:"dl",get:function(){return this.modulo(this.eval("w"),this.eval("h"),0)}},{key:"rw",get:function(){return 51965*this.eval("dl")/1e5}},{key:"lM",get:function(){return this.eval("dl")+0-this.eval("rw")}},{key:"xM",get:function(){return this.eval("ca")*this.eval("lM")/2}},{key:"yM",get:function(){return this.eval("sa")*this.eval("lM")/2}},{key:"dxAM",get:function(){return this.eval("sa")*this.eval("th")/2}},{key:"dyAM",get:function(){return this.eval("ca")*this.eval("th")/2}},{key:"xA",get:function(){return this.eval("xM")+0-this.eval("dxAM")}},{key:"yA",get:function(){return this.eval("yM")+this.eval("dyAM")-0}},{key:"xB",get:function(){return this.eval("xM")+this.eval("dxAM")-0}},{key:"yB",get:function(){return this.eval("yM")+0-this.eval("dyAM")}},{key:"xBC",get:function(){return this.eval("hc")+0-this.eval("xB")}},{key:"yBC",get:function(){return this.eval("xBC")*this.eval("ta")/1}},{key:"yC",get:function(){return this.eval("yBC")+this.eval("yB")-0}},{key:"xD",get:function(){return this.eval("r")+0-this.eval("xB")}},{key:"xE",get:function(){return this.eval("r")+0-this.eval("xA")}},{key:"yFE",get:function(){return this.eval("vc")+0-this.eval("yA")}},{key:"xFE",get:function(){return 1*this.eval("yFE")/this.eval("ta")}},{key:"xF",get:function(){return this.eval("xE")+0-this.eval("xFE")}},{key:"xL",get:function(){return this.eval("xA")+this.eval("xFE")-0}},{key:"yG",get:function(){return this.eval("b")+0-this.eval("yA")}},{key:"yH",get:function(){return this.eval("b")+0-this.eval("yB")}},{key:"yI",get:function(){return this.eval("b")+0-this.eval("yC")}},{key:"xC2",get:function(){return this.eval("r")+0-this.eval("xM")}},{key:"yC3",get:function(){return this.eval("b")+0-this.eval("yM")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"th",gdRefY:"adj1",minY:0,maxY:51965}],connectionSites:[{angle:"cd2",x:"xM",y:"yM"},{angle:"3cd4",x:"xC2",y:"yM"},{angle:0,x:"xC2",y:"yC3"},{angle:"cd4",x:"xM",y:"yC3"}],textBoxRect:{left:"xA",top:"yB",right:"xE",bottom:"yH"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["xA","yA","xB","yB","hc","yC","xD","yB","xE","yA","xF","vc","xE","yG","xD","yH","hc","yI","xB","yH","xA","yG","xL","vc"],attributes:{}}]},mathNotEqual:{adjustValues:{adj1:23520,adj2:66e5,adj3:11760},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"crAng",get:function(){return this.pinTo(42e5,this.eval("adj2"),66e5)}},{key:"2a1",get:function(){return 2*this.eval("a1")/1}},{key:"maxAdj3",get:function(){return 1e5-this.eval("2a1")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a3")/2e5}},{key:"dx1",get:function(){return 73490*this.eval("w")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x8",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y1",get:function(){return this.eval("y2")+0-this.eval("dy1")}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dy1")-0}},{key:"cadj2",get:function(){return this.eval("crAng")+0-this.eval("cd4")}},{key:"xadj2",get:function(){return this.eval("hd2")*Math.tan(this.angleToRadian(this.eval("cadj2")))}},{key:"len",get:function(){return this.modulo(this.eval("xadj2"),this.eval("hd2"),0)}},{key:"bhw",get:function(){return this.eval("len")*this.eval("dy1")/this.eval("hd2")}},{key:"bhw2",get:function(){return 1*this.eval("bhw")/2}},{key:"x7",get:function(){return this.eval("hc")+this.eval("xadj2")-this.eval("bhw2")}},{key:"dx67",get:function(){return this.eval("xadj2")*this.eval("y1")/this.eval("hd2")}},{key:"x6",get:function(){return this.eval("x7")+0-this.eval("dx67")}},{key:"dx57",get:function(){return this.eval("xadj2")*this.eval("y2")/this.eval("hd2")}},{key:"x5",get:function(){return this.eval("x7")+0-this.eval("dx57")}},{key:"dx47",get:function(){return this.eval("xadj2")*this.eval("y3")/this.eval("hd2")}},{key:"x4",get:function(){return this.eval("x7")+0-this.eval("dx47")}},{key:"dx37",get:function(){return this.eval("xadj2")*this.eval("y4")/this.eval("hd2")}},{key:"x3",get:function(){return this.eval("x7")+0-this.eval("dx37")}},{key:"dx27",get:function(){return 2*this.eval("xadj2")/1}},{key:"x2",get:function(){return this.eval("x7")+0-this.eval("dx27")}},{key:"rx7",get:function(){return this.eval("x7")+this.eval("bhw")-0}},{key:"rx6",get:function(){return this.eval("x6")+this.eval("bhw")-0}},{key:"rx5",get:function(){return this.eval("x5")+this.eval("bhw")-0}},{key:"rx4",get:function(){return this.eval("x4")+this.eval("bhw")-0}},{key:"rx3",get:function(){return this.eval("x3")+this.eval("bhw")-0}},{key:"rx2",get:function(){return this.eval("x2")+this.eval("bhw")-0}},{key:"dx7",get:function(){return this.eval("dy1")*this.eval("hd2")/this.eval("len")}},{key:"rxt",get:function(){return this.eval("x7")+this.eval("dx7")-0}},{key:"lxt",get:function(){return this.eval("rx7")+0-this.eval("dx7")}},{key:"rx",get:function(){return this.eval("cadj2")>0?this.eval("rxt"):this.eval("rx7")}},{key:"lx",get:function(){return this.eval("cadj2")>0?this.eval("x7"):this.eval("lxt")}},{key:"dy3",get:function(){return this.eval("dy1")*this.eval("xadj2")/this.eval("len")}},{key:"dy4",get:function(){return 0-this.eval("dy3")}},{key:"ry",get:function(){return this.eval("cadj2")>0?this.eval("dy3"):this.eval("t")}},{key:"ly",get:function(){return this.eval("cadj2")>0?this.eval("t"):this.eval("dy4")}},{key:"dlx",get:function(){return this.eval("w")+0-this.eval("rx")}},{key:"drx",get:function(){return this.eval("w")+0-this.eval("lx")}},{key:"dly",get:function(){return this.eval("h")+0-this.eval("ry")}},{key:"dry",get:function(){return this.eval("h")+0-this.eval("ly")}},{key:"xC1",get:function(){return(this.eval("rx")+this.eval("lx"))/2}},{key:"xC2",get:function(){return(this.eval("drx")+this.eval("dlx"))/2}},{key:"yC1",get:function(){return(this.eval("ry")+this.eval("ly"))/2}},{key:"yC2",get:function(){return(this.eval("y1")+this.eval("y2"))/2}},{key:"yC3",get:function(){return(this.eval("y3")+this.eval("y4"))/2}},{key:"yC4",get:function(){return(this.eval("dry")+this.eval("dly"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:5e4},{isPolar:!0,x:"lx",y:"t",gdRefAng:"adj2",minAng:42e5,maxAng:66e5},{isPolar:!1,x:"r",y:"y2",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:0,x:"x8",y:"yC2"},{angle:0,x:"x8",y:"yC3"},{angle:"cd4",x:"xC2",y:"yC4"},{angle:"cd2",x:"x1",y:"yC2"},{angle:"cd2",x:"x1",y:"yC3"},{angle:"3cd4",x:"xC1",y:"yC1"}],textBoxRect:{left:"x1",top:"y1",right:"x8",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],arguments:["x1","y1","x6","y1","lx","ly","rx","ry","rx6","y1","x8","y1","x8","y2","rx5","y2","rx4","y3","x8","y3","x8","y4","rx3","y4","drx","dry","dlx","dly","x3","y4","x1","y4","x1","y3","x4","y3","x5","y2","x1","y2"],attributes:{}}]},mathPlus:{adjustValues:{adj1:23520},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),73490)}},{key:"dx1",get:function(){return 73490*this.eval("w")/2e5}},{key:"dy1",get:function(){return 73490*this.eval("h")/2e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y2",gdRefY:"adj1",minY:0,maxY:73490}],connectionSites:[{angle:0,x:"x4",y:"vc"},{angle:"cd4",x:"hc",y:"y4"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"hc",y:"y1"}],textBoxRect:{left:"x1",top:"y2",right:"x4",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["x1","y2","x2","y2","x2","y1","x3","y1","x3","y2","x4","y2","x4","y3","x3","y3","x3","y4","x2","y4","x2","y3","x1","y3"],attributes:{}}]},moon:{adjustValues:{adj:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),87500)}},{key:"g0",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"g0w",get:function(){return this.eval("g0")*this.eval("w")/this.eval("ss")}},{key:"g1",get:function(){return this.eval("ss")+0-this.eval("g0")}},{key:"g2",get:function(){return this.eval("g0")*this.eval("g0")/this.eval("g1")}},{key:"g3",get:function(){return this.eval("ss")*this.eval("ss")/this.eval("g1")}},{key:"g4",get:function(){return 2*this.eval("g3")/1}},{key:"g5",get:function(){return this.eval("g4")+0-this.eval("g2")}},{key:"g6",get:function(){return this.eval("g5")+0-this.eval("g0")}},{key:"g6w",get:function(){return this.eval("g6")*this.eval("w")/this.eval("ss")}},{key:"g7",get:function(){return 1*this.eval("g5")/2}},{key:"g8",get:function(){return this.eval("g7")+0-this.eval("g0")}},{key:"dy1",get:function(){return this.eval("g8")*this.eval("hd2")/this.eval("ss")}},{key:"g10h",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"g11h",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"g12",get:function(){return 9598*this.eval("g0")/32768}},{key:"g12w",get:function(){return this.eval("g12")*this.eval("w")/this.eval("ss")}},{key:"g13",get:function(){return this.eval("ss")+0-this.eval("g12")}},{key:"q1",get:function(){return this.eval("ss")*this.eval("ss")/1}},{key:"q2",get:function(){return this.eval("g13")*this.eval("g13")/1}},{key:"q3",get:function(){return this.eval("q1")+0-this.eval("q2")}},{key:"q4",get:function(){return Math.sqrtFix(this.eval("q3"))}},{key:"dy4",get:function(){return this.eval("q4")*this.eval("hd2")/this.eval("ss")}},{key:"g15h",get:function(){return this.eval("vc")+0-this.eval("dy4")}},{key:"g16h",get:function(){return this.eval("vc")+this.eval("dy4")-0}},{key:"g17w",get:function(){return this.eval("g6w")+0-this.eval("g0w")}},{key:"g18w",get:function(){return 1*this.eval("g17w")/2}},{key:"dx2p",get:function(){return this.eval("g0w")+this.eval("g18w")-this.eval("w")}},{key:"dx2",get:function(){return-1*this.eval("dx2p")/1}},{key:"dy2",get:function(){return-1*this.eval("hd2")/1}},{key:"stAng1",get:function(){return this.radianToAngle(Math.atan2(this.eval("dy2"),this.eval("dx2")))}},{key:"enAngp1",get:function(){return this.radianToAngle(Math.atan2(this.eval("hd2"),this.eval("dx2")))}},{key:"enAng1",get:function(){return this.eval("enAngp1")+0-216e5}},{key:"swAng1",get:function(){return this.eval("enAng1")+0-this.eval("stAng1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"g0w",y:"vc",gdRefX:"adj",minX:0,maxX:87500}],connectionSites:[{angle:"3cd4",x:"r",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"r",y:"b"},{angle:0,x:"g0w",y:"vc"}],textBoxRect:{left:"g12w",top:"g15h",right:"g0w",bottom:"g16h"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo],argumentIndices:[0,2,6],arguments:["r","b","w","hd2","cd4","cd2","g18w","dy1","stAng1","swAng1"],attributes:{}}]},nonIsoscelesTrapezoid:{adjustValues:{adj1:25e3,adj2:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj"))}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x2",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("dx3")}},{key:"x4",get:function(){return(this.eval("r")+this.eval("x3"))/2}},{key:"il",get:function(){return this.eval("wd3")*this.eval("a1")/this.eval("maxAdj")}},{key:"adjm",get:function(){return Math.max(this.eval("a1"),this.eval("a2"))}},{key:"it",get:function(){return this.eval("hd3")*this.eval("adjm")/this.eval("maxAdj")}},{key:"irt",get:function(){return this.eval("wd3")*this.eval("a2")/this.eval("maxAdj")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("irt")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"t",gdRefX:"adj1",minX:0,maxX:"maxAdj"},{isPolar:!1,x:"x3",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:0,x:"x4",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","b","x2","t","x3","t","r","b"],attributes:{}}]},noSmoking:{adjustValues:{adj:18750},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dr",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"iwd2",get:function(){return this.eval("wd2")+0-this.eval("dr")}},{key:"ihd2",get:function(){return this.eval("hd2")+0-this.eval("dr")}},{key:"ang",get:function(){return this.radianToAngle(Math.atan2(this.eval("h"),this.eval("w")))}},{key:"ct",get:function(){return this.eval("ihd2")*Math.cos(this.angleToRadian(this.eval("ang")))}},{key:"st",get:function(){return this.eval("iwd2")*Math.sin(this.angleToRadian(this.eval("ang")))}},{key:"m",get:function(){return this.modulo(this.eval("ct"),this.eval("st"),0)}},{key:"n",get:function(){return this.eval("iwd2")*this.eval("ihd2")/this.eval("m")}},{key:"drd2",get:function(){return 1*this.eval("dr")/2}},{key:"dang",get:function(){return this.radianToAngle(Math.atan2(this.eval("drd2"),this.eval("n")))}},{key:"2dang",get:function(){return 2*this.eval("dang")/1}},{key:"swAng",get:function(){return-108e5+this.eval("2dang")-0}},{key:"t3",get:function(){return this.radianToAngle(Math.atan2(this.eval("h"),this.eval("w")))}},{key:"stAng1",get:function(){return this.eval("t3")+0-this.eval("dang")}},{key:"stAng2",get:function(){return this.eval("stAng1")+0-this.eval("cd2")}},{key:"ct1",get:function(){return this.eval("ihd2")*Math.cos(this.angleToRadian(this.eval("stAng1")))}},{key:"st1",get:function(){return this.eval("iwd2")*Math.sin(this.angleToRadian(this.eval("stAng1")))}},{key:"m1",get:function(){return this.modulo(this.eval("ct1"),this.eval("st1"),0)}},{key:"n1",get:function(){return this.eval("iwd2")*this.eval("ihd2")/this.eval("m1")}},{key:"dx1",get:function(){return this.eval("n1")*Math.cos(this.angleToRadian(this.eval("stAng1")))}},{key:"dy1",get:function(){return this.eval("n1")*Math.sin(this.angleToRadian(this.eval("stAng1")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"dr",y:"vc",gdRefR:"adj",minR:0,maxR:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,18,20,24,24,26,30],arguments:["l","vc","wd2","hd2","cd2","cd4","wd2","hd2","3cd4","cd4","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4","x1","y1","iwd2","ihd2","stAng1","swAng","x2","y2","iwd2","ihd2","stAng2","swAng"],attributes:{}}]},notchedRightArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("dx2")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"x1",get:function(){return this.eval("dy1")*this.eval("dx2")/this.eval("hd2")}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("x1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"r",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"x2",y:"t"},{angle:"cd2",x:"x1",y:"vc"},{angle:"cd4",x:"x2",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x1",top:"y1",right:"x3",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16],arguments:["l","y1","x2","y1","x2","t","r","vc","x2","b","x2","y2","l","y2","x1","vc"],attributes:{}}]},octagon:{adjustValues:{adj:29289},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"il",get:function(){return 1*this.eval("x1")/2}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"x1"},{angle:0,x:"r",y:"y2"},{angle:"cd4",x:"x2",y:"b"},{angle:"cd4",x:"x1",y:"b"},{angle:"cd2",x:"l",y:"y2"},{angle:"cd2",x:"l",y:"x1"},{angle:"3cd4",x:"x1",y:"t"},{angle:"3cd4",x:"x2",y:"t"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16],arguments:["l","x1","x1","t","x2","t","r","x1","r","y2","x2","b","x1","b","l","y2"],attributes:{}}]},parallelogram:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/2e5}},{key:"x2",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"x5",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"x3",get:function(){return 1*this.eval("x5")/2}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x3")}},{key:"il",get:function(){return this.eval("q2")*this.eval("w")/1}},{key:"q1",get:function(){return 5*this.eval("a")/this.eval("maxAdj")}},{key:"q2",get:function(){return(1+this.eval("q1"))/12}},{key:"it",get:function(){return this.eval("q2")*this.eval("h")/1}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("it")}},{key:"q3",get:function(){return this.eval("h")*this.eval("hc")/this.eval("x2")}},{key:"y1",get:function(){return this.pinTo(0,this.eval("q3"),this.eval("h"))}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"t",gdRefX:"adj",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:"3cd4",x:"hc",y:"y2"},{angle:"3cd4",x:"x4",y:"t"},{angle:0,x:"x6",y:"vc"},{angle:"cd4",x:"x3",y:"b"},{angle:"cd4",x:"hc",y:"y1"},{angle:"cd2",x:"x1",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","b","x2","t","r","t","x5","b"],attributes:{}}]},pentagon:{adjustValues:{hf:105146,vf:110557},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"svc",get:function(){return this.eval("vc")*this.eval("vf")/1e5}},{key:"dx1",get:function(){return this.eval("swd2")*Math.cos(this.angleToRadian(108e4))}},{key:"dx2",get:function(){return this.eval("swd2")*Math.cos(this.angleToRadian(1836e4))}},{key:"dy1",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(108e4))}},{key:"dy2",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(1836e4))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("svc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("svc")+0-this.eval("dy2")}},{key:"it",get:function(){return this.eval("y1")*this.eval("dx2")/this.eval("dx1")}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"x1",y:"y1"},{angle:"cd4",x:"x2",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"x3",y:"y2"},{angle:0,x:"x4",y:"y1"}],textBoxRect:{left:"x2",top:"it",right:"x3",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:["x1","y1","hc","t","x4","y1","x3","y2","x2","y2"],attributes:{}}]},pie:{adjustValues:{adj1:0,adj2:162e5},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"stAng",get:function(){return this.pinTo(0,this.eval("adj1"),21599999)}},{key:"enAng",get:function(){return this.pinTo(0,this.eval("adj2"),21599999)}},{key:"sw1",get:function(){return this.eval("enAng")+0-this.eval("stAng")}},{key:"sw2",get:function(){return this.eval("sw1")+216e5-0}},{key:"swAng",get:function(){return this.eval("sw1")>0?this.eval("sw1"):this.eval("sw2")}},{key:"wt1",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"ht1",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt1"),this.eval("ht1")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"wt2",get:function(){return this.eval("wd2")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"ht2",get:function(){return this.eval("hd2")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"dy2",get:function(){return this.eval("hd2")*Math.sin(Math.atan2(this.eval("wt2"),this.eval("ht2")))}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!0,x:"x1",y:"y1",gdRefAng:"adj1",minAng:0,maxAng:21599999},{isPolar:!0,x:"x2",y:"y2",gdRefAng:"adj2",minAng:0,maxAng:21599999}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8],arguments:["x1","y1","wd2","hd2","stAng","swAng","hc","vc"],attributes:{}}]},pieWedge:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"g1",get:function(){return this.eval("w")*Math.cos(this.angleToRadian(135e5))}},{key:"g2",get:function(){return this.eval("h")*Math.sin(this.angleToRadian(135e5))}},{key:"x1",get:function(){return this.eval("r")+this.eval("g1")-0}},{key:"y1",get:function(){return this.eval("b")+this.eval("g2")-0}}]),t}(Ur),connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"}],textBoxRect:{left:"x1",top:"y1",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8],arguments:["l","b","w","h","cd2","cd4","r","b"],attributes:{}}]},plaque:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"il",get:function(){return 70711*this.eval("x1")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,24],arguments:["l","x1","x1","x1","cd4",-54e5,"x2","t","x1","x1","cd2",-54e5,"r","y2","x1","x1","3cd4",-54e5,"x1","b","x1","x1",0,-54e5],attributes:{}}]},plaqueTabs:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"md",get:function(){return this.modulo(this.eval("w"),this.eval("h"),0)}},{key:"dx",get:function(){return 1*this.eval("md")/20}},{key:"y1",get:function(){return 0+this.eval("b")-this.eval("dx")}},{key:"x1",get:function(){return 0+this.eval("r")-this.eval("dx")}}]),t}(Ur),connectionSites:[{angle:"cd2",x:"l",y:"t"},{angle:"cd2",x:"l",y:"dx"},{angle:"cd2",x:"l",y:"y1"},{angle:"cd2",x:"l",y:"b"},{angle:"3cd4",x:"dx",y:"t"},{angle:"3cd4",x:"x1",y:"t"},{angle:"cd4",x:"dx",y:"b"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"t"},{angle:0,x:"r",y:"dx"},{angle:0,x:"r",y:"y1"},{angle:0,x:"r",y:"b"}],textBoxRect:{left:"dx",top:"dx",right:"x1",bottom:"y1"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8],arguments:["l","t","dx","t","dx","dx",0,"cd4"],attributes:{}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8],arguments:["l","y1","dx","dx","3cd4","cd4","l","b"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8],arguments:["r","t","r","dx","dx","dx","cd4","cd4"],attributes:{}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8],arguments:["x1","b","dx","dx","cd2","cd4","r","b"],attributes:{}}]},plus:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"d",get:function(){return this.eval("w")+0-this.eval("h")}},{key:"il",get:function(){return this.eval("d")>0?this.eval("l"):this.eval("x1")}},{key:"ir",get:function(){return this.eval("d")>0?this.eval("r"):this.eval("x2")}},{key:"it",get:function(){return this.eval("d")>0?this.eval("x1"):this.eval("t")}},{key:"ib",get:function(){return this.eval("d")>0?this.eval("y2"):this.eval("b")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["l","x1","x1","x1","x1","t","x2","t","x2","x1","r","x1","r","y2","x2","y2","x2","b","x1","b","x1","y2","l","y2"],attributes:{}}]},quadArrow:{adjustValues:{adj1:22500,adj2:22500,adj3:22500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"q1",get:function(){return 1e5-this.eval("maxAdj1")}},{key:"maxAdj3",get:function(){return 1*this.eval("q1")/2}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"y5",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dx3")}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dx3")-0}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"il",get:function(){return this.eval("dx3")*this.eval("x1")/this.eval("dx2")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"x1",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4},{isPolar:!1,x:"r",y:"x1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"y3",right:"ir",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48],arguments:["l","vc","x1","y2","x1","y3","x3","y3","x3","x1","x2","x1","hc","t","x5","x1","x4","x1","x4","y3","x6","y3","x6","y2","r","vc","x6","y5","x6","y4","x4","y4","x4","y6","x5","y6","hc","b","x2","y6","x3","y6","x3","y4","x1","y4","x1","y5"],attributes:{}}]},quadArrowCallout:{adjustValues:{adj1:18515,adj2:18515,adj3:18515,adj4:48123},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 5e4-this.eval("a2")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return 2*this.eval("a3")/1}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(this.eval("a1"),this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"ah",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a4")/2e5}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a4")/2e5}},{key:"x8",get:function(){return this.eval("r")+0-this.eval("ah")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x7",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x6",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"y8",get:function(){return this.eval("b")+0-this.eval("ah")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y7",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dx2")}},{key:"y6",get:function(){return this.eval("vc")+this.eval("dx2")-0}},{key:"y4",get:function(){return this.eval("vc")+0-this.eval("dx3")}},{key:"y5",get:function(){return this.eval("vc")+this.eval("dx3")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x4",y:"ah",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x3",y:"t",gdRefX:"adj2",minX:0,maxX:5e4},{isPolar:!1,x:"r",y:"ah",gdRefY:"adj3",minY:0,maxY:"maxAdj3"},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj4",minY:"a1",maxY:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x2",top:"y2",right:"x7",bottom:"y7"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64],arguments:["l","vc","ah","y3","ah","y4","x2","y4","x2","y2","x4","y2","x4","ah","x3","ah","hc","t","x6","ah","x5","ah","x5","y2","x7","y2","x7","y4","x8","y4","x8","y3","r","vc","x8","y6","x8","y5","x7","y5","x7","y7","x5","y7","x5","y8","x6","y8","hc","b","x3","y8","x4","y8","x4","y7","x2","y7","x2","y5","ah","y5","ah","y6"],attributes:{}}]},rect:{connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","r","t","r","b","l","b"],attributes:{}}]},ribbon:{adjustValues:{adj1:16667,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),33333)}},{key:"a2",get:function(){return this.pinTo(25e3,this.eval("adj2"),75e3)}},{key:"x10",get:function(){return this.eval("r")+0-this.eval("wd8")}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a2")/2e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x9",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x3",get:function(){return this.eval("x2")+this.eval("wd32")-0}},{key:"x8",get:function(){return this.eval("x9")+0-this.eval("wd32")}},{key:"x5",get:function(){return this.eval("x2")+this.eval("wd8")-0}},{key:"x6",get:function(){return this.eval("x9")+0-this.eval("wd8")}},{key:"x4",get:function(){return this.eval("x5")+0-this.eval("wd32")}},{key:"x7",get:function(){return this.eval("x6")+this.eval("wd32")-0}},{key:"y1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y2",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y2")}},{key:"y3",get:function(){return 1*this.eval("y4")/2}},{key:"hR",get:function(){return this.eval("h")*this.eval("a1")/4e5}},{key:"y5",get:function(){return this.eval("b")+0-this.eval("hR")}},{key:"y6",get:function(){return this.eval("y2")+0-this.eval("hR")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y2",gdRefY:"adj1",minY:0,maxY:33333},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:25e3,maxX:75e3}],connectionSites:[{angle:"3cd4",x:"hc",y:"y2"},{angle:"cd2",x:"wd8",y:"y3"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x10",y:"y3"}],textBoxRect:{left:"x2",top:"y2",right:"x9",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10,14,16,20,22,26,28,30,32,34,36,40,42,46,48,50,52],arguments:["l","t","x4","t","wd32","hR","3cd4","cd2","x3","y1","wd32","hR","3cd4",-108e5,"x8","y2","wd32","hR","cd4",-108e5,"x7","y1","wd32","hR","cd4","cd2","r","t","x10","y3","r","y4","x9","y4","x9","y5","wd32","hR",0,"cd4","x3","b","wd32","hR","cd4","cd4","x2","y4","l","y4","wd8","y3"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,14,16,20,22,26,28],arguments:["x5","hR","wd32","hR",0,"cd4","x3","y1","wd32","hR","3cd4",-108e5,"x5","y2","x6","hR","wd32","hR","cd2",-54e5,"x8","y1","wd32","hR","3cd4","cd2","x6","y2"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,8,10,14,16,20,22,26,28,30,32,34,36,40,42,46,48,50,52,52,54,56,58,60,62,64,66],arguments:["l","t","x4","t","wd32","hR","3cd4","cd2","x3","y1","wd32","hR","3cd4",-108e5,"x8","y2","wd32","hR","cd4",-108e5,"x7","y1","wd32","hR","cd4","cd2","r","t","x10","y3","r","y4","x9","y4","x9","y5","wd32","hR",0,"cd4","x3","b","wd32","hR","cd4","cd4","x2","y4","l","y4","wd8","y3","x5","hR","x5","y2","x6","y2","x6","hR","x2","y4","x2","y6","x9","y6","x9","y4"],attributes:{fill:G.e.None,extrusionOk:!1}}]},ribbon2:{adjustValues:{adj1:16667,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),33333)}},{key:"a2",get:function(){return this.pinTo(25e3,this.eval("adj2"),75e3)}},{key:"x10",get:function(){return this.eval("r")+0-this.eval("wd8")}},{key:"dx2",get:function(){return this.eval("w")*this.eval("a2")/2e5}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x9",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x3",get:function(){return this.eval("x2")+this.eval("wd32")-0}},{key:"x8",get:function(){return this.eval("x9")+0-this.eval("wd32")}},{key:"x5",get:function(){return this.eval("x2")+this.eval("wd8")-0}},{key:"x6",get:function(){return this.eval("x9")+0-this.eval("wd8")}},{key:"x4",get:function(){return this.eval("x5")+0-this.eval("wd32")}},{key:"x7",get:function(){return this.eval("x6")+this.eval("wd32")-0}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("dy1")}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"y4",get:function(){return this.eval("t")+this.eval("dy2")-0}},{key:"y3",get:function(){return(this.eval("y4")+this.eval("b"))/2}},{key:"hR",get:function(){return this.eval("h")*this.eval("a1")/4e5}},{key:"y6",get:function(){return this.eval("b")+0-this.eval("hR")}},{key:"y7",get:function(){return this.eval("y1")+0-this.eval("hR")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y2",gdRefY:"adj1",minY:0,maxY:33333},{isPolar:!1,x:"x2",y:"b",gdRefX:"adj2",minX:25e3,maxX:75e3}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"wd8",y:"y3"},{angle:"cd4",x:"hc",y:"y2"},{angle:0,x:"x10",y:"y3"}],textBoxRect:{left:"x2",top:"t",right:"x9",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10,14,16,20,22,26,28,30,32,34,36,40,42,46,48,50,52],arguments:["l","b","x4","b","wd32","hR","cd4",-108e5,"x3","y1","wd32","hR","cd4","cd2","x8","y2","wd32","hR","3cd4","cd2","x7","y1","wd32","hR","3cd4",-108e5,"r","b","x10","y3","r","y4","x9","y4","x9","hR","wd32","hR",0,-54e5,"x3","t","wd32","hR","3cd4",-54e5,"x2","y4","l","y4","wd8","y3"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,14,16,20,22,26,28],arguments:["x5","y6","wd32","hR",0,-54e5,"x3","y1","wd32","hR","cd4","cd2","x5","y2","x6","y6","wd32","hR","cd2","cd4","x8","y1","wd32","hR","cd4",-108e5,"x6","y2"],attributes:{stroke:!1,fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2,4,6,8,10,14,16,20,22,24,26,28,30,32,36,38,42,44,48,50,54,54,56,58,60,62,64,66,68],arguments:["l","b","wd8","y3","l","y4","x2","y4","x2","hR","wd32","hR","cd2","cd4","x8","t","wd32","hR","3cd4","cd4","x9","y4","x9","y4","r","y4","x10","y3","r","b","x7","b","wd32","hR","cd4","cd2","x8","y1","wd32","hR","cd4",-108e5,"x3","y2","wd32","hR","3cd4",-108e5,"x4","y1","wd32","hR","3cd4","cd2","x5","y2","x5","y6","x6","y6","x6","y2","x2","y7","x2","y4","x9","y4","x9","y7"],attributes:{fill:G.e.None,extrusionOk:!1}}]},rightArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"dx2",get:function(){return this.eval("y1")*this.eval("dx1")/this.eval("hd2")}},{key:"x2",get:function(){return this.eval("x1")+this.eval("dx2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"x1",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"y1",right:"x2",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["l","y1","x1","y1","x1","t","r","vc","x1","b","x1","y2","l","y2"],attributes:{}}]},rightArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:64977},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 1e5*this.eval("w")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("w")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dy1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dy2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"dx3",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("dx3")}},{key:"x2",get:function(){return this.eval("w")*this.eval("a4")/1e5}},{key:"x1",get:function(){return 1*this.eval("x2")/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x3",y:"y2",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"r",y:"y1",gdRefY:"adj2",minY:0,maxY:"maxAdj2"},{isPolar:!1,x:"x3",y:"t",gdRefX:"adj3",minX:0,maxX:"maxAdj3"},{isPolar:!1,x:"x2",y:"b",gdRefX:"adj4",minX:0,maxX:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"x1",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22],arguments:["l","t","x2","t","x2","y2","x3","y2","x3","y1","r","vc","x3","y4","x3","y3","x2","y3","x2","b","l","b"],attributes:{}}]},rightBrace:{adjustValues:{adj1:8333,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),1e5)}},{key:"q1",get:function(){return 1e5-this.eval("a2")}},{key:"q2",get:function(){return Math.min(this.eval("q1"),this.eval("a2"))}},{key:"q3",get:function(){return 1*this.eval("q2")/2}},{key:"maxAdj1",get:function(){return this.eval("q3")*this.eval("h")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"y3",get:function(){return this.eval("h")*this.eval("a2")/1e5}},{key:"y2",get:function(){return this.eval("y3")+0-this.eval("y1")}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"dy1",get:function(){return this.eval("y1")*Math.sin(this.angleToRadian(27e5))}},{key:"ir",get:function(){return this.eval("l")+this.eval("dx1")-0}},{key:"it",get:function(){return this.eval("y1")+0-this.eval("dy1")}},{key:"ib",get:function(){return this.eval("b")+this.eval("dy1")-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y1",gdRefY:"adj1",minY:0,maxY:"maxAdj1"},{isPolar:!1,x:"r",y:"y3",gdRefY:"adj2",minY:0,maxY:1e5}],connectionSites:[{angle:"cd4",x:"l",y:"t"},{angle:"cd2",x:"r",y:"y3"},{angle:"3cd4",x:"l",y:"b"}],textBoxRect:{left:"l",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,16,18,22],arguments:["l","t","wd2","y1","3cd4","cd4","hc","y2","wd2","y1","cd2",-54e5,"wd2","y1","3cd4",-54e5,"hc","y4","wd2","y1",0,"cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8,12,16,18],arguments:["l","t","wd2","y1","3cd4","cd4","hc","y2","wd2","y1","cd2",-54e5,"wd2","y1","3cd4",-54e5,"hc","y4","wd2","y1",0,"cd4"],attributes:{fill:G.e.None}}]},rightBracket:{adjustValues:{adj:8333},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"dx1",get:function(){return this.eval("w")*Math.cos(this.angleToRadian(27e5))}},{key:"dy1",get:function(){return this.eval("y1")*Math.sin(this.angleToRadian(27e5))}},{key:"ir",get:function(){return this.eval("l")+this.eval("dx1")-0}},{key:"it",get:function(){return this.eval("y1")+0-this.eval("dy1")}},{key:"ib",get:function(){return this.eval("b")+this.eval("dy1")-this.eval("y1")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"r",y:"y1",gdRefY:"adj",minY:0,maxY:"maxAdj"}],connectionSites:[{angle:"cd4",x:"l",y:"t"},{angle:"3cd4",x:"l",y:"b"},{angle:"cd2",x:"r",y:"vc"}],textBoxRect:{left:"l",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12],arguments:["l","t","w","y1","3cd4","cd4","r","y2","w","y1",0,"cd4"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo],argumentIndices:[0,2,6,8],arguments:["l","t","w","y1","3cd4","cd4","r","y2","w","y1",0,"cd4"],attributes:{fill:G.e.None}}]},round1Rect:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"idx",get:function(){return 29289*this.eval("dx1")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("idx")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"t",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10,12],arguments:["l","t","x1","t","dx1","dx1","3cd4","cd4","r","b","l","b"],attributes:{}}]},round2DiagRect:{adjustValues:{adj1:16667,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"y1",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"a",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("a")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("a")}},{key:"dx1",get:function(){return 29289*this.eval("x1")/1e5}},{key:"dx2",get:function(){return 29289*this.eval("a")/1e5}},{key:"d",get:function(){return this.eval("dx1")+0-this.eval("dx2")}},{key:"dx",get:function(){return this.eval("d")>0?this.eval("dx1"):this.eval("dx2")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("dx")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("dx")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj1",minX:0,maxX:5e4},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"dx",top:"dx",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14,16,20,22,26],arguments:["x1","t","x2","t","a","a","3cd4","cd4","r","y1","x1","x1",0,"cd4","a","b","a","a","cd4","cd4","l","x1","x1","x1","cd2","cd4"],attributes:{}}]},round2SameRect:{adjustValues:{adj1:16667,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"tx1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"tx2",get:function(){return this.eval("r")+0-this.eval("tx1")}},{key:"bx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"bx2",get:function(){return this.eval("r")+0-this.eval("bx1")}},{key:"by1",get:function(){return this.eval("b")+0-this.eval("bx1")}},{key:"d",get:function(){return this.eval("tx1")+0-this.eval("bx1")}},{key:"tdx",get:function(){return 29289*this.eval("tx1")/1e5}},{key:"bdx",get:function(){return 29289*this.eval("bx1")/1e5}},{key:"il",get:function(){return this.eval("d")>0?this.eval("tdx"):this.eval("bdx")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("bdx")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"tx2",y:"t",gdRefX:"adj1",minX:0,maxX:5e4},{isPolar:!1,x:"bx1",y:"b",gdRefX:"adj2",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"tdx",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8,10,14,16,20,22,26],arguments:["tx1","t","tx2","t","tx1","tx1","3cd4","cd4","r","by1","bx1","bx1",0,"cd4","bx1","b","bx1","bx1","cd4","cd4","l","tx1","tx1","tx1","cd2","cd4"],attributes:{}}]},roundRect:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("x1")}},{key:"il",get:function(){return 29289*this.eval("x1")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,18,20,24],arguments:["l","x1","x1","x1","cd2","cd4","x2","t","x1","x1","3cd4","cd4","r","y2","x1","x1",0,"cd4","x1","b","x1","x1","cd4","cd4"],attributes:{}}]},rtTriangle:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"it",get:function(){return 7*this.eval("h")/12}},{key:"ir",get:function(){return 7*this.eval("w")/12}},{key:"ib",get:function(){return 11*this.eval("h")/12}}]),t}(Ur),connectionSites:[{angle:"3cd4",x:"l",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"l",y:"b"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"r",y:"b"},{angle:0,x:"hc",y:"vc"}],textBoxRect:{left:"wd12",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["l","b","l","t","r","b"],attributes:{}}]},smileyFace:{adjustValues:{adj:4653},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(-4653,this.eval("adj"),4653)}},{key:"x1",get:function(){return 4969*this.eval("w")/21699}},{key:"x2",get:function(){return 6215*this.eval("w")/21600}},{key:"x3",get:function(){return 13135*this.eval("w")/21600}},{key:"x4",get:function(){return 16640*this.eval("w")/21600}},{key:"y1",get:function(){return 7570*this.eval("h")/21600}},{key:"y3",get:function(){return 16515*this.eval("h")/21600}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a")/1e5}},{key:"y2",get:function(){return this.eval("y3")+0-this.eval("dy2")}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dy2")-0}},{key:"dy3",get:function(){return this.eval("h")*this.eval("a")/5e4}},{key:"y5",get:function(){return this.eval("y4")+this.eval("dy3")-0}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}},{key:"wR",get:function(){return 1125*this.eval("w")/21600}},{key:"hR",get:function(){return 1125*this.eval("h")/21600}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"y4",gdRefY:"adj",minY:-4653,maxY:4653}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["l","vc","wd2","hd2","cd2",216e5],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.MoveTo,G.d.ArcTo],argumentIndices:[0,2,6,8],arguments:["x2","y1","wR","hR","cd2",216e5,"x3","y1","wR","hR","cd2",216e5],attributes:{fill:G.e.DarkenLess,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.QuadraticBezierTo],argumentIndices:[0,2],arguments:["x1","y2","hc","y5","x4","y2"],attributes:{fill:G.e.None,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6],arguments:["l","vc","wd2","hd2","cd2",216e5],attributes:{fill:G.e.None}}]},snip1Rect:{adjustValues:{adj:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x1",get:function(){return this.eval("r")+0-this.eval("dx1")}},{key:"it",get:function(){return 1*this.eval("dx1")/2}},{key:"ir",get:function(){return(this.eval("x1")+this.eval("r"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"l",top:"it",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10],arguments:["l","t","x1","t","r","dx1","r","b","l","b"],attributes:{}}]},snip2DiagRect:{adjustValues:{adj1:0,adj2:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"lx1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"lx2",get:function(){return this.eval("r")+0-this.eval("lx1")}},{key:"ly1",get:function(){return this.eval("b")+0-this.eval("lx1")}},{key:"rx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"rx2",get:function(){return this.eval("r")+0-this.eval("rx1")}},{key:"ry1",get:function(){return this.eval("b")+0-this.eval("rx1")}},{key:"d",get:function(){return this.eval("lx1")+0-this.eval("rx1")}},{key:"dx",get:function(){return this.eval("d")>0?this.eval("lx1"):this.eval("rx1")}},{key:"il",get:function(){return 1*this.eval("dx")/2}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"lx1",y:"t",gdRefX:"adj1",minX:0,maxX:5e4},{isPolar:!1,x:"rx2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16],arguments:["lx1","t","rx2","t","r","rx1","r","ly1","lx2","b","rx1","b","l","ry1","l","lx1"],attributes:{}}]},snip2SameRect:{adjustValues:{adj1:16667,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"tx1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"tx2",get:function(){return this.eval("r")+0-this.eval("tx1")}},{key:"bx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"bx2",get:function(){return this.eval("r")+0-this.eval("bx1")}},{key:"by1",get:function(){return this.eval("b")+0-this.eval("bx1")}},{key:"d",get:function(){return this.eval("tx1")+0-this.eval("bx1")}},{key:"dx",get:function(){return this.eval("d")>0?this.eval("tx1"):this.eval("bx1")}},{key:"il",get:function(){return 1*this.eval("dx")/2}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"it",get:function(){return 1*this.eval("tx1")/2}},{key:"ib",get:function(){return(this.eval("by1")+this.eval("b"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"tx2",y:"t",gdRefX:"adj1",minX:0,maxX:5e4},{isPolar:!1,x:"bx1",y:"b",gdRefX:"adj2",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16],arguments:["tx1","t","tx2","t","r","tx1","r","by1","bx2","b","bx1","b","l","by1","l","tx1"],attributes:{}}]},snipRoundRect:{adjustValues:{adj1:16667,adj2:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),5e4)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),5e4)}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x2",get:function(){return this.eval("r")+0-this.eval("dx2")}},{key:"il",get:function(){return 29289*this.eval("x1")/1e5}},{key:"ir",get:function(){return(this.eval("x2")+this.eval("r"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj1",minX:0,maxX:5e4},{isPolar:!1,x:"x2",y:"t",gdRefX:"adj2",minX:0,maxX:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,16],arguments:["x1","t","x2","t","r","dx2","r","b","l","b","l","x1","x1","x1","cd2","cd4"],attributes:{}}]},squareTabs:{Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"md",get:function(){return this.modulo(this.eval("w"),this.eval("h"),0)}},{key:"dx",get:function(){return 1*this.eval("md")/20}},{key:"y1",get:function(){return 0+this.eval("b")-this.eval("dx")}},{key:"x1",get:function(){return 0+this.eval("r")-this.eval("dx")}}]),t}(Ur),connectionSites:[{angle:"cd2",x:"l",y:"t"},{angle:"cd2",x:"l",y:"dx"},{angle:"cd2",x:"l",y:"y1"},{angle:"cd2",x:"l",y:"b"},{angle:"cd2",x:"dx",y:"dx"},{angle:"cd2",x:"dx",y:"x1"},{angle:"3cd4",x:"dx",y:"t"},{angle:"3cd4",x:"x1",y:"t"},{angle:"cd4",x:"dx",y:"b"},{angle:"cd4",x:"x1",y:"b"},{angle:0,x:"r",y:"t"},{angle:0,x:"r",y:"dx"},{angle:0,x:"r",y:"y1"},{angle:0,x:"r",y:"b"},{angle:0,x:"x1",y:"dx"},{angle:0,x:"x1",y:"y1"}],textBoxRect:{left:"dx",top:"dx",right:"x1",bottom:"y1"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","t","dx","t","dx","dx","l","dx"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","y1","dx","y1","dx","b","l","b"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["x1","t","r","t","r","dx","x1","dx"],attributes:{}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["x1","y1","r","y1","r","b","x1","b"],attributes:{}}]},star10:{adjustValues:{adj:42533,hf:105146},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"dx1",get:function(){return 95106*this.eval("swd2")/1e5}},{key:"dx2",get:function(){return 58779*this.eval("swd2")/1e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy1",get:function(){return 80902*this.eval("hd2")/1e5}},{key:"dy2",get:function(){return 30902*this.eval("hd2")/1e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("swd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 80902*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 30902*this.eval("iwd2")/1e5}},{key:"sdy1",get:function(){return 95106*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 58779*this.eval("ihd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("iwd2")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx5",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sx6",get:function(){return this.eval("hc")+this.eval("iwd2")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy4",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"x4",y:"y2"},{angle:0,x:"x4",y:"y3"},{angle:"cd4",x:"x3",y:"y4"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"x2",y:"y4"},{angle:"cd2",x:"x1",y:"y3"},{angle:"cd2",x:"x1",y:"y2"},{angle:"3cd4",x:"x2",y:"y1"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"x3",y:"y1"}],textBoxRect:{left:"sx2",top:"sy2",right:"sx5",bottom:"sy3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],arguments:["x1","y2","sx2","sy2","x2","y1","sx3","sy1","hc","t","sx4","sy1","x3","y1","sx5","sy2","x4","y2","sx6","vc","x4","y3","sx5","sy3","x3","y4","sx4","sy4","hc","b","sx3","sy4","x2","y4","sx2","sy3","x1","y3","sx1","vc"],attributes:{}}]},star12:{adjustValues:{adj:37500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(18e5))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(36e5))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x3",get:function(){return 3*this.eval("w")/4}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y3",get:function(){return 3*this.eval("h")/4}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(9e5))}},{key:"sdx2",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(27e5))}},{key:"sdx3",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(45e5))}},{key:"sdy1",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(45e5))}},{key:"sdy2",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(27e5))}},{key:"sdy3",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(9e5))}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx3")}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("sdx3")-0}},{key:"sx5",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx6",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+0-this.eval("sdy3")}},{key:"sy4",get:function(){return this.eval("vc")+this.eval("sdy3")-0}},{key:"sy5",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy6",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"x4",y:"hd4"},{angle:0,x:"r",y:"vc"},{angle:0,x:"x4",y:"y3"},{angle:"cd4",x:"x3",y:"y4"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"wd4",y:"y4"},{angle:"cd2",x:"x1",y:"y3"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd2",x:"x1",y:"hd4"},{angle:"3cd4",x:"wd4",y:"y1"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"x3",y:"y1"}],textBoxRect:{left:"sx2",top:"sy2",right:"sx5",bottom:"sy5"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48],arguments:["l","vc","sx1","sy3","x1","hd4","sx2","sy2","wd4","y1","sx3","sy1","hc","t","sx4","sy1","x3","y1","sx5","sy2","x4","hd4","sx6","sy3","r","vc","sx6","sy4","x4","y3","sx5","sy5","x3","y4","sx4","sy6","hc","b","sx3","sy6","wd4","y4","sx2","sy5","x1","y3","sx1","sy4"],attributes:{}}]},star16:{adjustValues:{adj:37500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return 92388*this.eval("wd2")/1e5}},{key:"dx2",get:function(){return 70711*this.eval("wd2")/1e5}},{key:"dx3",get:function(){return 38268*this.eval("wd2")/1e5}},{key:"dy1",get:function(){return 92388*this.eval("hd2")/1e5}},{key:"dy2",get:function(){return 70711*this.eval("hd2")/1e5}},{key:"dy3",get:function(){return 38268*this.eval("hd2")/1e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x6",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dy3")}},{key:"y4",get:function(){return this.eval("vc")+this.eval("dy3")-0}},{key:"y5",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y6",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 98079*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 83147*this.eval("iwd2")/1e5}},{key:"sdx3",get:function(){return 55557*this.eval("iwd2")/1e5}},{key:"sdx4",get:function(){return 19509*this.eval("iwd2")/1e5}},{key:"sdy1",get:function(){return 98079*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 83147*this.eval("ihd2")/1e5}},{key:"sdy3",get:function(){return 55557*this.eval("ihd2")/1e5}},{key:"sdy4",get:function(){return 19509*this.eval("ihd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx3")}},{key:"sx4",get:function(){return this.eval("hc")+0-this.eval("sdx4")}},{key:"sx5",get:function(){return this.eval("hc")+this.eval("sdx4")-0}},{key:"sx6",get:function(){return this.eval("hc")+this.eval("sdx3")-0}},{key:"sx7",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx8",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+0-this.eval("sdy3")}},{key:"sy4",get:function(){return this.eval("vc")+0-this.eval("sdy4")}},{key:"sy5",get:function(){return this.eval("vc")+this.eval("sdy4")-0}},{key:"sy6",get:function(){return this.eval("vc")+this.eval("sdy3")-0}},{key:"sy7",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy8",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"idx",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"x5",y:"y2"},{angle:0,x:"x6",y:"y3"},{angle:0,x:"r",y:"vc"},{angle:0,x:"x6",y:"y4"},{angle:0,x:"x5",y:"y5"},{angle:"cd4",x:"x4",y:"y6"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"x3",y:"y6"},{angle:"cd2",x:"x2",y:"y5"},{angle:"cd2",x:"x1",y:"y4"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd2",x:"x1",y:"y3"},{angle:"cd2",x:"x2",y:"y2"},{angle:"3cd4",x:"x3",y:"y1"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"x4",y:"y1"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64],arguments:["l","vc","sx1","sy4","x1","y3","sx2","sy3","x2","y2","sx3","sy2","x3","y1","sx4","sy1","hc","t","sx5","sy1","x4","y1","sx6","sy2","x5","y2","sx7","sy3","x6","y3","sx8","sy4","r","vc","sx8","sy5","x6","y4","sx7","sy6","x5","y5","sx6","sy7","x4","y6","sx5","sy8","hc","b","sx4","sy8","x3","y6","sx3","sy7","x2","y5","sx2","sy6","x1","y4","sx1","sy5"],attributes:{}}]},star24:{adjustValues:{adj:37500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(9e5))}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(18e5))}},{key:"dx3",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"dx4",get:function(){return this.eval("wd4")}},{key:"dx5",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(45e5))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(45e5))}},{key:"dy2",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(36e5))}},{key:"dy3",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"dy4",get:function(){return this.eval("hd4")}},{key:"dy5",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(9e5))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+0-this.eval("dx4")}},{key:"x5",get:function(){return this.eval("hc")+0-this.eval("dx5")}},{key:"x6",get:function(){return this.eval("hc")+this.eval("dx5")-0}},{key:"x7",get:function(){return this.eval("hc")+this.eval("dx4")-0}},{key:"x8",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x9",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x10",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dy3")}},{key:"y4",get:function(){return this.eval("vc")+0-this.eval("dy4")}},{key:"y5",get:function(){return this.eval("vc")+0-this.eval("dy5")}},{key:"y6",get:function(){return this.eval("vc")+this.eval("dy5")-0}},{key:"y7",get:function(){return this.eval("vc")+this.eval("dy4")-0}},{key:"y8",get:function(){return this.eval("vc")+this.eval("dy3")-0}},{key:"y9",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y10",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 99144*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 92388*this.eval("iwd2")/1e5}},{key:"sdx3",get:function(){return 79335*this.eval("iwd2")/1e5}},{key:"sdx4",get:function(){return 60876*this.eval("iwd2")/1e5}},{key:"sdx5",get:function(){return 38268*this.eval("iwd2")/1e5}},{key:"sdx6",get:function(){return 13053*this.eval("iwd2")/1e5}},{key:"sdy1",get:function(){return 99144*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 92388*this.eval("ihd2")/1e5}},{key:"sdy3",get:function(){return 79335*this.eval("ihd2")/1e5}},{key:"sdy4",get:function(){return 60876*this.eval("ihd2")/1e5}},{key:"sdy5",get:function(){return 38268*this.eval("ihd2")/1e5}},{key:"sdy6",get:function(){return 13053*this.eval("ihd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx3")}},{key:"sx4",get:function(){return this.eval("hc")+0-this.eval("sdx4")}},{key:"sx5",get:function(){return this.eval("hc")+0-this.eval("sdx5")}},{key:"sx6",get:function(){return this.eval("hc")+0-this.eval("sdx6")}},{key:"sx7",get:function(){return this.eval("hc")+this.eval("sdx6")-0}},{key:"sx8",get:function(){return this.eval("hc")+this.eval("sdx5")-0}},{key:"sx9",get:function(){return this.eval("hc")+this.eval("sdx4")-0}},{key:"sx10",get:function(){return this.eval("hc")+this.eval("sdx3")-0}},{key:"sx11",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx12",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+0-this.eval("sdy3")}},{key:"sy4",get:function(){return this.eval("vc")+0-this.eval("sdy4")}},{key:"sy5",get:function(){return this.eval("vc")+0-this.eval("sdy5")}},{key:"sy6",get:function(){return this.eval("vc")+0-this.eval("sdy6")}},{key:"sy7",get:function(){return this.eval("vc")+this.eval("sdy6")-0}},{key:"sy8",get:function(){return this.eval("vc")+this.eval("sdy5")-0}},{key:"sy9",get:function(){return this.eval("vc")+this.eval("sdy4")-0}},{key:"sy10",get:function(){return this.eval("vc")+this.eval("sdy3")-0}},{key:"sy11",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy12",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"idx",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96],arguments:["l","vc","sx1","sy6","x1","y5","sx2","sy5","x2","y4","sx3","sy4","x3","y3","sx4","sy3","x4","y2","sx5","sy2","x5","y1","sx6","sy1","hc","t","sx7","sy1","x6","y1","sx8","sy2","x7","y2","sx9","sy3","x8","y3","sx10","sy4","x9","y4","sx11","sy5","x10","y5","sx12","sy6","r","vc","sx12","sy7","x10","y6","sx11","sy8","x9","y7","sx10","sy9","x8","y8","sx9","sy10","x7","y9","sx8","sy11","x6","y10","sx7","sy12","hc","b","sx6","sy12","x5","y10","sx5","sy11","x4","y9","sx4","sy10","x3","y8","sx3","sy9","x2","y7","sx2","sy8","x1","y6","sx1","sy7"],attributes:{}}]},star32:{adjustValues:{adj:37500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return 98079*this.eval("wd2")/1e5}},{key:"dx2",get:function(){return 92388*this.eval("wd2")/1e5}},{key:"dx3",get:function(){return 83147*this.eval("wd2")/1e5}},{key:"dx4",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"dx5",get:function(){return 55557*this.eval("wd2")/1e5}},{key:"dx6",get:function(){return 38268*this.eval("wd2")/1e5}},{key:"dx7",get:function(){return 19509*this.eval("wd2")/1e5}},{key:"dy1",get:function(){return 98079*this.eval("hd2")/1e5}},{key:"dy2",get:function(){return 92388*this.eval("hd2")/1e5}},{key:"dy3",get:function(){return 83147*this.eval("hd2")/1e5}},{key:"dy4",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"dy5",get:function(){return 55557*this.eval("hd2")/1e5}},{key:"dy6",get:function(){return 38268*this.eval("hd2")/1e5}},{key:"dy7",get:function(){return 19509*this.eval("hd2")/1e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+0-this.eval("dx4")}},{key:"x5",get:function(){return this.eval("hc")+0-this.eval("dx5")}},{key:"x6",get:function(){return this.eval("hc")+0-this.eval("dx6")}},{key:"x7",get:function(){return this.eval("hc")+0-this.eval("dx7")}},{key:"x8",get:function(){return this.eval("hc")+this.eval("dx7")-0}},{key:"x9",get:function(){return this.eval("hc")+this.eval("dx6")-0}},{key:"x10",get:function(){return this.eval("hc")+this.eval("dx5")-0}},{key:"x11",get:function(){return this.eval("hc")+this.eval("dx4")-0}},{key:"x12",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x13",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x14",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+0-this.eval("dy3")}},{key:"y4",get:function(){return this.eval("vc")+0-this.eval("dy4")}},{key:"y5",get:function(){return this.eval("vc")+0-this.eval("dy5")}},{key:"y6",get:function(){return this.eval("vc")+0-this.eval("dy6")}},{key:"y7",get:function(){return this.eval("vc")+0-this.eval("dy7")}},{key:"y8",get:function(){return this.eval("vc")+this.eval("dy7")-0}},{key:"y9",get:function(){return this.eval("vc")+this.eval("dy6")-0}},{key:"y10",get:function(){return this.eval("vc")+this.eval("dy5")-0}},{key:"y11",get:function(){return this.eval("vc")+this.eval("dy4")-0}},{key:"y12",get:function(){return this.eval("vc")+this.eval("dy3")-0}},{key:"y13",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"y14",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 99518*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 95694*this.eval("iwd2")/1e5}},{key:"sdx3",get:function(){return 88192*this.eval("iwd2")/1e5}},{key:"sdx4",get:function(){return 77301*this.eval("iwd2")/1e5}},{key:"sdx5",get:function(){return 63439*this.eval("iwd2")/1e5}},{key:"sdx6",get:function(){return 47140*this.eval("iwd2")/1e5}},{key:"sdx7",get:function(){return 29028*this.eval("iwd2")/1e5}},{key:"sdx8",get:function(){return 9802*this.eval("iwd2")/1e5}},{key:"sdy1",get:function(){return 99518*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 95694*this.eval("ihd2")/1e5}},{key:"sdy3",get:function(){return 88192*this.eval("ihd2")/1e5}},{key:"sdy4",get:function(){return 77301*this.eval("ihd2")/1e5}},{key:"sdy5",get:function(){return 63439*this.eval("ihd2")/1e5}},{key:"sdy6",get:function(){return 47140*this.eval("ihd2")/1e5}},{key:"sdy7",get:function(){return 29028*this.eval("ihd2")/1e5}},{key:"sdy8",get:function(){return 9802*this.eval("ihd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx3")}},{key:"sx4",get:function(){return this.eval("hc")+0-this.eval("sdx4")}},{key:"sx5",get:function(){return this.eval("hc")+0-this.eval("sdx5")}},{key:"sx6",get:function(){return this.eval("hc")+0-this.eval("sdx6")}},{key:"sx7",get:function(){return this.eval("hc")+0-this.eval("sdx7")}},{key:"sx8",get:function(){return this.eval("hc")+0-this.eval("sdx8")}},{key:"sx9",get:function(){return this.eval("hc")+this.eval("sdx8")-0}},{key:"sx10",get:function(){return this.eval("hc")+this.eval("sdx7")-0}},{key:"sx11",get:function(){return this.eval("hc")+this.eval("sdx6")-0}},{key:"sx12",get:function(){return this.eval("hc")+this.eval("sdx5")-0}},{key:"sx13",get:function(){return this.eval("hc")+this.eval("sdx4")-0}},{key:"sx14",get:function(){return this.eval("hc")+this.eval("sdx3")-0}},{key:"sx15",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx16",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+0-this.eval("sdy3")}},{key:"sy4",get:function(){return this.eval("vc")+0-this.eval("sdy4")}},{key:"sy5",get:function(){return this.eval("vc")+0-this.eval("sdy5")}},{key:"sy6",get:function(){return this.eval("vc")+0-this.eval("sdy6")}},{key:"sy7",get:function(){return this.eval("vc")+0-this.eval("sdy7")}},{key:"sy8",get:function(){return this.eval("vc")+0-this.eval("sdy8")}},{key:"sy9",get:function(){return this.eval("vc")+this.eval("sdy8")-0}},{key:"sy10",get:function(){return this.eval("vc")+this.eval("sdy7")-0}},{key:"sy11",get:function(){return this.eval("vc")+this.eval("sdy6")-0}},{key:"sy12",get:function(){return this.eval("vc")+this.eval("sdy5")-0}},{key:"sy13",get:function(){return this.eval("vc")+this.eval("sdy4")-0}},{key:"sy14",get:function(){return this.eval("vc")+this.eval("sdy3")-0}},{key:"sy15",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy16",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"idx",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128],arguments:["l","vc","sx1","sy8","x1","y7","sx2","sy7","x2","y6","sx3","sy6","x3","y5","sx4","sy5","x4","y4","sx5","sy4","x5","y3","sx6","sy3","x6","y2","sx7","sy2","x7","y1","sx8","sy1","hc","t","sx9","sy1","x8","y1","sx10","sy2","x9","y2","sx11","sy3","x10","y3","sx12","sy4","x11","y4","sx13","sy5","x12","y5","sx14","sy6","x13","y6","sx15","sy7","x14","y7","sx16","sy8","r","vc","sx16","sy9","x14","y8","sx15","sy10","x13","y9","sx14","sy11","x12","y10","sx13","sy12","x11","y11","sx12","sy13","x10","y12","sx11","sy14","x9","y13","sx10","sy15","x8","y14","sx9","sy16","hc","b","sx8","sy16","x7","y14","sx7","sy15","x6","y13","sx6","sy14","x5","y12","sx5","sy13","x4","y11","sx4","sy12","x3","y10","sx3","sy11","x2","y9","sx2","sy10","x1","y8","sx1","sy9"],attributes:{}}]},star4:{adjustValues:{adj:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(27e5))}},{key:"sdy",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(27e5))}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx")}},{key:"sx2",get:function(){return this.eval("hc")+this.eval("sdx")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy")}},{key:"sy2",get:function(){return this.eval("vc")+this.eval("sdy")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"sx1",top:"sy1",right:"sx2",bottom:"sy2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16],arguments:["l","vc","sx1","sy1","hc","t","sx2","sy1","r","vc","sx2","sy2","hc","b","sx1","sy2"],attributes:{}}]},star5:{adjustValues:{adj:19098,hf:105146,vf:110557},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"svc",get:function(){return this.eval("vc")*this.eval("vf")/1e5}},{key:"dx1",get:function(){return this.eval("swd2")*Math.cos(this.angleToRadian(108e4))}},{key:"dx2",get:function(){return this.eval("swd2")*Math.cos(this.angleToRadian(1836e4))}},{key:"dy1",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(108e4))}},{key:"dy2",get:function(){return this.eval("shd2")*Math.sin(this.angleToRadian(1836e4))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("svc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("svc")+0-this.eval("dy2")}},{key:"iwd2",get:function(){return this.eval("swd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("shd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(2052e4))}},{key:"sdx2",get:function(){return this.eval("iwd2")*Math.cos(this.angleToRadian(324e4))}},{key:"sdy1",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(324e4))}},{key:"sdy2",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(2052e4))}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("svc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("svc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("svc")+this.eval("ihd2")-0}},{key:"yAdj",get:function(){return this.eval("svc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"x1",y:"y1"},{angle:"cd4",x:"x2",y:"y2"},{angle:"cd4",x:"x3",y:"y2"},{angle:0,x:"x4",y:"y1"}],textBoxRect:{left:"sx1",top:"sy1",right:"sx4",bottom:"sy3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20],arguments:["x1","y1","sx2","sy1","hc","t","sx3","sy1","x4","y1","sx4","sy2","x3","y2","hc","sy3","x2","y2","sx1","sy2"],attributes:{}}]},star6:{adjustValues:{adj:28868,hf:115470},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"dx1",get:function(){return this.eval("swd2")*Math.cos(this.angleToRadian(18e5))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("hd4")-0}},{key:"iwd2",get:function(){return this.eval("swd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx2",get:function(){return 1*this.eval("iwd2")/2}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("iwd2")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("iwd2")-0}},{key:"sdy1",get:function(){return this.eval("ihd2")*Math.sin(this.angleToRadian(36e5))}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"x2",y:"hd4"},{angle:0,x:"x2",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"x1",y:"y2"},{angle:"cd2",x:"x1",y:"hd4"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"sx1",top:"sy1",right:"sx4",bottom:"sy2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24],arguments:["x1","hd4","sx2","sy1","hc","t","sx3","sy1","x2","hd4","sx4","vc","x2","y2","sx3","sy2","hc","b","sx2","sy2","x1","y2","sx1","vc"],attributes:{}}]},star7:{adjustValues:{adj:34601,hf:102572,vf:105210},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"swd2",get:function(){return this.eval("wd2")*this.eval("hf")/1e5}},{key:"shd2",get:function(){return this.eval("hd2")*this.eval("vf")/1e5}},{key:"svc",get:function(){return this.eval("vc")*this.eval("vf")/1e5}},{key:"dx1",get:function(){return 97493*this.eval("swd2")/1e5}},{key:"dx2",get:function(){return 78183*this.eval("swd2")/1e5}},{key:"dx3",get:function(){return 43388*this.eval("swd2")/1e5}},{key:"dy1",get:function(){return 62349*this.eval("shd2")/1e5}},{key:"dy2",get:function(){return 22252*this.eval("shd2")/1e5}},{key:"dy3",get:function(){return 90097*this.eval("shd2")/1e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+0-this.eval("dx3")}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"x5",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x6",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("svc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("svc")+this.eval("dy2")-0}},{key:"y3",get:function(){return this.eval("svc")+this.eval("dy3")-0}},{key:"iwd2",get:function(){return this.eval("swd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("shd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 97493*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 78183*this.eval("iwd2")/1e5}},{key:"sdx3",get:function(){return 43388*this.eval("iwd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+0-this.eval("sdx3")}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("sdx3")-0}},{key:"sx5",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx6",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sdy1",get:function(){return 90097*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 22252*this.eval("ihd2")/1e5}},{key:"sdy3",get:function(){return 62349*this.eval("ihd2")/1e5}},{key:"sy1",get:function(){return this.eval("svc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("svc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("svc")+this.eval("sdy3")-0}},{key:"sy4",get:function(){return this.eval("svc")+this.eval("ihd2")-0}},{key:"yAdj",get:function(){return this.eval("svc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"x5",y:"y1"},{angle:0,x:"x6",y:"y2"},{angle:"cd4",x:"x4",y:"y3"},{angle:"cd4",x:"x3",y:"y3"},{angle:"cd2",x:"x1",y:"y2"},{angle:"cd2",x:"x2",y:"y1"},{angle:"3cd4",x:"hc",y:"t"}],textBoxRect:{left:"sx2",top:"sy1",right:"sx5",bottom:"sy3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28],arguments:["x1","y2","sx1","sy2","x2","y1","sx3","sy1","hc","t","sx4","sy1","x5","y1","sx6","sy2","x6","y2","sx5","sy3","x4","y3","hc","sy4","x3","y3","sx2","sy3"],attributes:{}}]},star8:{adjustValues:{adj:37500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),5e4)}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"iwd2",get:function(){return this.eval("wd2")*this.eval("a")/5e4}},{key:"ihd2",get:function(){return this.eval("hd2")*this.eval("a")/5e4}},{key:"sdx1",get:function(){return 92388*this.eval("iwd2")/1e5}},{key:"sdx2",get:function(){return 38268*this.eval("iwd2")/1e5}},{key:"sdy1",get:function(){return 92388*this.eval("ihd2")/1e5}},{key:"sdy2",get:function(){return 38268*this.eval("ihd2")/1e5}},{key:"sx1",get:function(){return this.eval("hc")+0-this.eval("sdx1")}},{key:"sx2",get:function(){return this.eval("hc")+0-this.eval("sdx2")}},{key:"sx3",get:function(){return this.eval("hc")+this.eval("sdx2")-0}},{key:"sx4",get:function(){return this.eval("hc")+this.eval("sdx1")-0}},{key:"sy1",get:function(){return this.eval("vc")+0-this.eval("sdy1")}},{key:"sy2",get:function(){return this.eval("vc")+0-this.eval("sdy2")}},{key:"sy3",get:function(){return this.eval("vc")+this.eval("sdy2")-0}},{key:"sy4",get:function(){return this.eval("vc")+this.eval("sdy1")-0}},{key:"yAdj",get:function(){return this.eval("vc")+0-this.eval("ihd2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"hc",y:"yAdj",gdRefY:"adj",minY:0,maxY:5e4}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"x2",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"x1",y:"y2"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"x1",y:"y1"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"x2",y:"y1"}],textBoxRect:{left:"sx1",top:"sy1",right:"sx4",bottom:"sy4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32],arguments:["l","vc","sx1","sy2","x1","y1","sx2","sy1","hc","t","sx3","sy1","x2","y1","sx4","sy2","r","vc","sx4","sy3","x2","y2","sx3","sy4","hc","b","sx2","sy4","x1","y2","sx1","sy3"],attributes:{}}]},straightConnector1:{textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo],argumentIndices:[0,2],arguments:["l","t","r","b"],attributes:{fill:G.e.None}}]},stripedRightArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 84375*this.eval("w")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"x4",get:function(){return 5*this.eval("ss")/32}},{key:"dx5",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"x5",get:function(){return this.eval("r")+0-this.eval("dx5")}},{key:"dy1",get:function(){return this.eval("h")*this.eval("a1")/2e5}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"dx6",get:function(){return this.eval("dy1")*this.eval("dx5")/this.eval("hd2")}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("dx6")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:1e5},{isPolar:!1,x:"x5",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"x5",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"x5",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x4",top:"y1",right:"x6",bottom:"y2"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,8,10,12,14,16,16,18,20,22,24,26,28,30],arguments:["l","y1","ssd32","y1","ssd32","y2","l","y2","ssd16","y1","ssd8","y1","ssd8","y2","ssd16","y2","x4","y1","x5","y1","x5","t","r","vc","x5","b","x5","y2","x4","y2"],attributes:{}}]},sun:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(12500,this.eval("adj"),46875)}},{key:"g0",get:function(){return 5e4-this.eval("a")}},{key:"g1",get:function(){return 30274*this.eval("g0")/32768}},{key:"g2",get:function(){return 12540*this.eval("g0")/32768}},{key:"g3",get:function(){return this.eval("g1")+5e4-0}},{key:"g4",get:function(){return this.eval("g2")+5e4-0}},{key:"g5",get:function(){return 5e4-this.eval("g1")}},{key:"g6",get:function(){return 5e4-this.eval("g2")}},{key:"g7",get:function(){return 23170*this.eval("g0")/32768}},{key:"g8",get:function(){return 5e4+this.eval("g7")-0}},{key:"g9",get:function(){return 5e4-this.eval("g7")}},{key:"g10",get:function(){return 3*this.eval("g5")/4}},{key:"g11",get:function(){return 3*this.eval("g6")/4}},{key:"g12",get:function(){return this.eval("g10")+3662-0}},{key:"g13",get:function(){return this.eval("g11")+3662-0}},{key:"g14",get:function(){return this.eval("g11")+12500-0}},{key:"g15",get:function(){return 1e5-this.eval("g10")}},{key:"g16",get:function(){return 1e5-this.eval("g12")}},{key:"g17",get:function(){return 1e5-this.eval("g13")}},{key:"g18",get:function(){return 1e5-this.eval("g14")}},{key:"ox1",get:function(){return 18436*this.eval("w")/21600}},{key:"oy1",get:function(){return 3163*this.eval("h")/21600}},{key:"ox2",get:function(){return 3163*this.eval("w")/21600}},{key:"oy2",get:function(){return 18436*this.eval("h")/21600}},{key:"x8",get:function(){return this.eval("w")*this.eval("g8")/1e5}},{key:"x9",get:function(){return this.eval("w")*this.eval("g9")/1e5}},{key:"x10",get:function(){return this.eval("w")*this.eval("g10")/1e5}},{key:"x12",get:function(){return this.eval("w")*this.eval("g12")/1e5}},{key:"x13",get:function(){return this.eval("w")*this.eval("g13")/1e5}},{key:"x14",get:function(){return this.eval("w")*this.eval("g14")/1e5}},{key:"x15",get:function(){return this.eval("w")*this.eval("g15")/1e5}},{key:"x16",get:function(){return this.eval("w")*this.eval("g16")/1e5}},{key:"x17",get:function(){return this.eval("w")*this.eval("g17")/1e5}},{key:"x18",get:function(){return this.eval("w")*this.eval("g18")/1e5}},{key:"x19",get:function(){return this.eval("w")*this.eval("a")/1e5}},{key:"wR",get:function(){return this.eval("w")*this.eval("g0")/1e5}},{key:"hR",get:function(){return this.eval("h")*this.eval("g0")/1e5}},{key:"y8",get:function(){return this.eval("h")*this.eval("g8")/1e5}},{key:"y9",get:function(){return this.eval("h")*this.eval("g9")/1e5}},{key:"y10",get:function(){return this.eval("h")*this.eval("g10")/1e5}},{key:"y12",get:function(){return this.eval("h")*this.eval("g12")/1e5}},{key:"y13",get:function(){return this.eval("h")*this.eval("g13")/1e5}},{key:"y14",get:function(){return this.eval("h")*this.eval("g14")/1e5}},{key:"y15",get:function(){return this.eval("h")*this.eval("g15")/1e5}},{key:"y16",get:function(){return this.eval("h")*this.eval("g16")/1e5}},{key:"y17",get:function(){return this.eval("h")*this.eval("g17")/1e5}},{key:"y18",get:function(){return this.eval("h")*this.eval("g18")/1e5}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x19",y:"vc",gdRefX:"adj",minX:12500,maxX:46875}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"x9",top:"y9",right:"x8",bottom:"y8"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,6,6,8,10,12,12,14,16,18,18,20,22,24,24,26,28,30,30,32,34,36,36,38,40,42,42,44,46,48,48,50,54],arguments:["r","vc","x15","y18","x15","y14","ox1","oy1","x16","y13","x17","y12","hc","t","x18","y10","x14","y10","ox2","oy1","x13","y12","x12","y13","l","vc","x10","y14","x10","y18","ox2","oy2","x12","y17","x13","y16","hc","b","x14","y15","x18","y15","ox1","oy2","x17","y16","x16","y17","x19","vc","wR","hR","cd2",216e5],attributes:{}}]},swooshArrow:{adjustValues:{adj1:25e3,adj2:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(1,this.eval("adj1"),75e3)}},{key:"maxAdj2",get:function(){return 7e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"ad1",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"ad2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"xB",get:function(){return this.eval("r")+0-this.eval("ad2")}},{key:"yB",get:function(){return this.eval("t")+this.eval("ssd8")-0}},{key:"alfa",get:function(){return 1*this.eval("cd4")/14}},{key:"dx0",get:function(){return this.eval("ssd8")*Math.tan(this.angleToRadian(this.eval("alfa")))}},{key:"xC",get:function(){return this.eval("xB")+0-this.eval("dx0")}},{key:"dx1",get:function(){return this.eval("ad1")*Math.tan(this.angleToRadian(this.eval("alfa")))}},{key:"yF",get:function(){return this.eval("yB")+this.eval("ad1")-0}},{key:"xF",get:function(){return this.eval("xB")+this.eval("dx1")-0}},{key:"xE",get:function(){return this.eval("xF")+this.eval("dx0")-0}},{key:"yE",get:function(){return this.eval("yF")+this.eval("ssd8")-0}},{key:"dy2",get:function(){return this.eval("yE")+0-this.eval("t")}},{key:"dy22",get:function(){return 1*this.eval("dy2")/2}},{key:"dy3",get:function(){return 1*this.eval("h")/20}},{key:"yD",get:function(){return this.eval("t")+this.eval("dy22")-this.eval("dy3")}},{key:"dy4",get:function(){return 1*this.eval("hd6")/1}},{key:"yP1",get:function(){return this.eval("hd6")+this.eval("dy4")-0}},{key:"xP1",get:function(){return this.eval("wd6")}},{key:"dy5",get:function(){return 1*this.eval("hd6")/2}},{key:"yP2",get:function(){return this.eval("yF")+this.eval("dy5")-0}},{key:"xP2",get:function(){return this.eval("wd4")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xF",y:"yF",gdRefY:"adj1",minY:1,maxY:75e3},{isPolar:!1,x:"xB",y:"yB",gdRefX:"adj2",minX:0,maxX:"maxAdj2"}],connectionSites:[{angle:"cd4",x:"l",y:"b"},{angle:"3cd4",x:"xC",y:"t"},{angle:0,x:"r",y:"yD"},{angle:"cd4",x:"xE",y:"yE"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.QuadraticBezierTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.QuadraticBezierTo,G.d.Close],argumentIndices:[0,2,6,8,10,12,14,18],arguments:["l","b","xP1","yP1","xB","yB","xC","t","r","yD","xE","yE","xF","yF","xP2","yP2","l","b"],attributes:{}}]},teardrop:{adjustValues:{adj:1e5},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),2e5)}},{key:"r2",get:function(){return Math.sqrtFix(2)}},{key:"tw",get:function(){return this.eval("wd2")*this.eval("r2")/1}},{key:"th",get:function(){return this.eval("hd2")*this.eval("r2")/1}},{key:"sw",get:function(){return this.eval("tw")*this.eval("a")/1e5}},{key:"sh",get:function(){return this.eval("th")*this.eval("a")/1e5}},{key:"dx1",get:function(){return this.eval("sw")*Math.cos(this.angleToRadian(27e5))}},{key:"dy1",get:function(){return this.eval("sh")*Math.sin(this.angleToRadian(27e5))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+0-this.eval("dy1")}},{key:"x2",get:function(){return(this.eval("hc")+this.eval("x1"))/2}},{key:"y2",get:function(){return(this.eval("vc")+this.eval("y1"))/2}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"t",gdRefX:"adj",minX:0,maxX:2e5}],connectionSites:[{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"ir",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd2",x:"l",y:"vc"},{angle:"3cd4",x:"il",y:"it"},{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"x1",y:"y1"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.QuadraticBezierTo,G.d.QuadraticBezierTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,14,18,22],arguments:["l","vc","wd2","hd2","cd2","cd4","x2","t","x1","y1","r","y2","r","vc","wd2","hd2",0,"cd4","wd2","hd2","cd4","cd4"],attributes:{}}]},trapezoid:{adjustValues:{adj:25e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),this.eval("maxAdj"))}},{key:"x1",get:function(){return this.eval("ss")*this.eval("a")/2e5}},{key:"x2",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"x3",get:function(){return this.eval("r")+0-this.eval("x2")}},{key:"x4",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"il",get:function(){return this.eval("wd3")*this.eval("a")/this.eval("maxAdj")}},{key:"it",get:function(){return this.eval("hd3")*this.eval("a")/this.eval("maxAdj")}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"t",gdRefX:"adj",minX:0,maxX:"maxAdj"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"x1",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"x4",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8],arguments:["l","b","x2","t","x3","t","r","b"],attributes:{}}]},triangle:{adjustValues:{adj:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),1e5)}},{key:"x1",get:function(){return this.eval("w")*this.eval("a")/2e5}},{key:"x2",get:function(){return this.eval("w")*this.eval("a")/1e5}},{key:"x3",get:function(){return this.eval("x1")+this.eval("wd2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"t",gdRefX:"adj",minX:0,maxX:1e5}],connectionSites:[{angle:"3cd4",x:"x2",y:"t"},{angle:"cd2",x:"x1",y:"vc"},{angle:"cd4",x:"l",y:"b"},{angle:"cd4",x:"x2",y:"b"},{angle:"cd4",x:"r",y:"b"},{angle:0,x:"x3",y:"vc"}],textBoxRect:{left:"x1",top:"vc",right:"x3",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6],arguments:["l","b","x2","t","r","b"],attributes:{}}]},upArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:64977},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 1e5*this.eval("h")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("h")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a4")/1e5}},{key:"y2",get:function(){return this.eval("b")+0-this.eval("dy2")}},{key:"y3",get:function(){return(this.eval("y2")+this.eval("b"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"y1",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"r",y:"y1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj4",minY:0,maxY:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"y2"}],textBoxRect:{left:"l",top:"y2",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22],arguments:["l","y2","x2","y2","x2","y1","x1","y1","hc","t","x4","y1","x3","y1","x3","y2","r","y2","r","b","l","b"],attributes:{}}]},upArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 1e5*this.eval("h")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"y2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("y2")}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy1",get:function(){return this.eval("x1")*this.eval("y2")/this.eval("wd2")}},{key:"y1",get:function(){return this.eval("y2")+0-this.eval("dy1")}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dy1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"b",gdRefX:"adj1",minX:0,maxX:1e5},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj2",minY:0,maxY:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y2"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"y2"}],textBoxRect:{left:"x1",top:"y1",right:"x2",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14],arguments:["l","y2","hc","t","r","y2","x2","y2","x2","b","x1","b","x1","y2"],attributes:{}}]},upDownArrow:{adjustValues:{adj1:5e4,adj2:5e4},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),1e5)}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"y2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("y2")}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"dy1",get:function(){return this.eval("x1")*this.eval("y2")/this.eval("wd2")}},{key:"y1",get:function(){return this.eval("y2")+0-this.eval("dy1")}},{key:"y4",get:function(){return this.eval("y3")+this.eval("dy1")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x1",y:"y3",gdRefX:"adj1",minX:0,maxX:1e5},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj2",minY:0,maxY:"maxAdj2"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"y2"},{angle:"cd2",x:"x1",y:"vc"},{angle:"cd2",x:"l",y:"y3"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"y3"},{angle:0,x:"x2",y:"vc"},{angle:0,x:"r",y:"y2"}],textBoxRect:{left:"x1",top:"y1",right:"x2",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20],arguments:["l","y2","hc","t","r","y2","x2","y2","x2","y3","r","y3","hc","b","l","y3","x1","y3","x1","y2"],attributes:{}}]},upDownArrowCallout:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:48123},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"maxAdj2",get:function(){return 5e4*this.eval("w")/this.eval("ss")}},{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),this.eval("maxAdj2"))}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"maxAdj3",get:function(){return 5e4*this.eval("h")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q2",get:function(){return this.eval("a3")*this.eval("ss")/this.eval("hd2")}},{key:"maxAdj4",get:function(){return 1e5-this.eval("q2")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"dx1",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"dx2",get:function(){return this.eval("ss")*this.eval("a1")/2e5}},{key:"x1",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"x2",get:function(){return this.eval("hc")+0-this.eval("dx2")}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"x4",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"dy2",get:function(){return this.eval("h")*this.eval("a4")/2e5}},{key:"y2",get:function(){return this.eval("vc")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy2")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"x2",y:"y1",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x1",y:"t",gdRefX:"adj2",minX:0,maxX:"maxAdj2"},{isPolar:!1,x:"r",y:"y1",gdRefY:"adj3",minY:0,maxY:"maxAdj3"},{isPolar:!1,x:"l",y:"y2",gdRefY:"adj4",minY:0,maxY:"maxAdj4"}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"}],textBoxRect:{left:"l",top:"y2",right:"r",bottom:"y3"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36],arguments:["l","y2","x2","y2","x2","y1","x1","y1","hc","t","x4","y1","x3","y1","x3","y2","r","y2","r","y3","x3","y3","x3","y4","x4","y4","hc","b","x1","y4","x2","y4","x2","y3","l","y3"],attributes:{}}]},uturnArrow:{adjustValues:{adj1:25e3,adj2:25e3,adj3:25e3,adj4:43750,adj5:75e3},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a2",get:function(){return this.pinTo(0,this.eval("adj2"),25e3)}},{key:"maxAdj1",get:function(){return 2*this.eval("a2")/1}},{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),this.eval("maxAdj1"))}},{key:"q2",get:function(){return this.eval("a1")*this.eval("ss")/this.eval("h")}},{key:"q3",get:function(){return 1e5-this.eval("q2")}},{key:"maxAdj3",get:function(){return this.eval("q3")*this.eval("h")/this.eval("ss")}},{key:"a3",get:function(){return this.pinTo(0,this.eval("adj3"),this.eval("maxAdj3"))}},{key:"q1",get:function(){return this.eval("a3")+this.eval("a1")-0}},{key:"minAdj5",get:function(){return this.eval("q1")*this.eval("ss")/this.eval("h")}},{key:"a5",get:function(){return this.pinTo(this.eval("minAdj5"),this.eval("adj5"),1e5)}},{key:"th",get:function(){return this.eval("ss")*this.eval("a1")/1e5}},{key:"aw2",get:function(){return this.eval("ss")*this.eval("a2")/1e5}},{key:"th2",get:function(){return 1*this.eval("th")/2}},{key:"dh2",get:function(){return this.eval("aw2")+0-this.eval("th2")}},{key:"y5",get:function(){return this.eval("h")*this.eval("a5")/1e5}},{key:"ah",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"y4",get:function(){return this.eval("y5")+0-this.eval("ah")}},{key:"x9",get:function(){return this.eval("r")+0-this.eval("dh2")}},{key:"bw",get:function(){return 1*this.eval("x9")/2}},{key:"bs",get:function(){return Math.min(this.eval("bw"),this.eval("y4"))}},{key:"maxAdj4",get:function(){return 1e5*this.eval("bs")/this.eval("ss")}},{key:"a4",get:function(){return this.pinTo(0,this.eval("adj4"),this.eval("maxAdj4"))}},{key:"bd",get:function(){return this.eval("ss")*this.eval("a4")/1e5}},{key:"bd3",get:function(){return this.eval("bd")+0-this.eval("th")}},{key:"bd2",get:function(){return Math.max(this.eval("bd3"),0)}},{key:"x3",get:function(){return this.eval("th")+this.eval("bd2")-0}},{key:"x8",get:function(){return this.eval("r")+0-this.eval("aw2")}},{key:"x6",get:function(){return this.eval("x8")+0-this.eval("aw2")}},{key:"x7",get:function(){return this.eval("x6")+this.eval("dh2")-0}},{key:"x4",get:function(){return this.eval("x9")+0-this.eval("bd")}},{key:"x5",get:function(){return this.eval("x7")+0-this.eval("bd2")}},{key:"cx",get:function(){return(this.eval("th")+this.eval("x7"))/2}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"th",y:"b",gdRefX:"adj1",minX:0,maxX:"maxAdj1"},{isPolar:!1,x:"x6",y:"b",gdRefX:"adj2",minX:0,maxX:25e3},{isPolar:!1,x:"x6",y:"y4",gdRefY:"adj3",minY:0,maxY:"maxAdj3"},{isPolar:!1,x:"bd",y:"t",gdRefX:"adj4",minX:0,maxX:"maxAdj4"},{isPolar:!1,x:"r",y:"y5",gdRefY:"adj5",minY:"minAdj5",maxY:1e5}],connectionSites:[{angle:"cd4",x:"x6",y:"y4"},{angle:"cd4",x:"x8",y:"y5"},{angle:0,x:"r",y:"y4"},{angle:"3cd4",x:"cx",y:"t"},{angle:"cd4",x:"th2",y:"b"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,8,10,14,16,18,20,22,24,26,30,32,36,38],arguments:["l","b","l","bd","bd","bd","cd2","cd4","x4","t","bd","bd","3cd4","cd4","x9","y4","r","y4","x8","y5","x6","y4","x7","y4","x7","x3","bd2","bd2",0,-54e5,"x3","th","bd2","bd2","3cd4",-54e5,"th","b"],attributes:{}}]},verticalScroll:{adjustValues:{adj:12500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a",get:function(){return this.pinTo(0,this.eval("adj"),25e3)}},{key:"ch",get:function(){return this.eval("ss")*this.eval("a")/1e5}},{key:"ch2",get:function(){return 1*this.eval("ch")/2}},{key:"ch4",get:function(){return 1*this.eval("ch")/4}},{key:"x3",get:function(){return this.eval("ch")+this.eval("ch2")-0}},{key:"x4",get:function(){return this.eval("ch")+this.eval("ch")-0}},{key:"x6",get:function(){return this.eval("r")+0-this.eval("ch")}},{key:"x7",get:function(){return this.eval("r")+0-this.eval("ch2")}},{key:"x5",get:function(){return this.eval("x6")+0-this.eval("ch2")}},{key:"y3",get:function(){return this.eval("b")+0-this.eval("ch")}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("ch2")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"ch",gdRefY:"adj",minY:0,maxY:25e3}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:0,x:"ch",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd2",x:"x6",y:"vc"}],textBoxRect:{left:"ch",top:"ch",right:"x6",bottom:"y4"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,8,12,14,16,20,22,26,28,30,34,34,36,40,44],arguments:["ch2","b","ch2","ch2","cd4",-54e5,"ch2","y4","ch4","ch4","cd4",-108e5,"ch","y3","ch","ch2","ch2","ch2","cd2","cd4","x7","t","ch2","ch2","3cd4","cd2","x6","ch","x6","y4","ch2","ch2",0,"cd4","x4","ch2","ch2","ch2",0,"cd4","ch4","ch4","cd4","cd2"],attributes:{stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,6,10,10,12,16,20],arguments:["x4","ch2","ch2","ch2",0,"cd4","ch4","ch4","cd4","cd2","ch","y4","ch2","ch2",0,"3cd4","ch4","ch4","3cd4","cd2"],attributes:{fill:G.e.DarkenLess,stroke:!1,extrusionOk:!1}},{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.ArcTo,G.d.Close,G.d.MoveTo,G.d.ArcTo,G.d.ArcTo,G.d.LineTo,G.d.MoveTo,G.d.LineTo,G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.MoveTo,G.d.ArcTo,G.d.LineTo],argumentIndices:[0,2,4,8,10,14,16,18,22,24,28,28,30,34,38,40,42,44,46,50,52,54,58],arguments:["ch","y3","ch","ch2","ch2","ch2","cd2","cd4","x7","t","ch2","ch2","3cd4","cd2","x6","ch","x6","y4","ch2","ch2",0,"cd4","ch2","b","ch2","ch2","cd4","cd2","x3","t","ch2","ch2","3cd4","cd2","ch4","ch4","cd4","cd2","x4","ch2","x6","ch","x3","ch","ch2","y3","ch4","ch4","3cd4","cd2","ch","y4","ch2","b","ch2","ch2","cd4",-54e5,"ch","y3"],attributes:{fill:G.e.None,extrusionOk:!1}}]},wave:{adjustValues:{adj1:12500,adj2:0},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"a1",get:function(){return this.pinTo(0,this.eval("adj1"),2e4)}},{key:"a2",get:function(){return this.pinTo(-1e4,this.eval("adj2"),1e4)}},{key:"y1",get:function(){return this.eval("h")*this.eval("a1")/1e5}},{key:"dy2",get:function(){return 10*this.eval("y1")/3}},{key:"y2",get:function(){return this.eval("y1")+0-this.eval("dy2")}},{key:"y3",get:function(){return this.eval("y1")+this.eval("dy2")-0}},{key:"y4",get:function(){return this.eval("b")+0-this.eval("y1")}},{key:"y5",get:function(){return this.eval("y4")+0-this.eval("dy2")}},{key:"y6",get:function(){return this.eval("y4")+this.eval("dy2")-0}},{key:"dx1",get:function(){return this.eval("w")*this.eval("a2")/1e5}},{key:"of2",get:function(){return this.eval("w")*this.eval("a2")/5e4}},{key:"x1",get:function(){return Math.abs(this.eval("dx1"))}},{key:"dx2",get:function(){return this.eval("of2")>0?0:this.eval("of2")}},{key:"x2",get:function(){return this.eval("l")+0-this.eval("dx2")}},{key:"dx5",get:function(){return this.eval("of2")>0?this.eval("of2"):0}},{key:"x5",get:function(){return this.eval("r")+0-this.eval("dx5")}},{key:"dx3",get:function(){return(this.eval("dx2")+this.eval("x5"))/3}},{key:"x3",get:function(){return this.eval("x2")+this.eval("dx3")-0}},{key:"x4",get:function(){return(this.eval("x3")+this.eval("x5"))/2}},{key:"x6",get:function(){return this.eval("l")+this.eval("dx5")-0}},{key:"x10",get:function(){return this.eval("r")+this.eval("dx2")-0}},{key:"x7",get:function(){return this.eval("x6")+this.eval("dx3")-0}},{key:"x8",get:function(){return(this.eval("x7")+this.eval("x10"))/2}},{key:"x9",get:function(){return this.eval("r")+0-this.eval("x1")}},{key:"xAdj",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"xAdj2",get:function(){return this.eval("hc")+0-this.eval("dx1")}},{key:"il",get:function(){return Math.max(this.eval("x2"),this.eval("x6"))}},{key:"ir",get:function(){return Math.min(this.eval("x5"),this.eval("x10"))}},{key:"it",get:function(){return this.eval("h")*this.eval("a1")/5e4}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("it")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"l",y:"y1",gdRefY:"adj1",minY:0,maxY:2e4},{isPolar:!1,x:"xAdj",y:"b",gdRefX:"adj2",minX:-1e4,maxX:1e4}],connectionSites:[{angle:"cd4",x:"xAdj2",y:"y1"},{angle:"cd2",x:"x1",y:"vc"},{angle:"3cd4",x:"xAdj",y:"y4"},{angle:0,x:"x9",y:"vc"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.CubicBezierTo,G.d.LineTo,G.d.CubicBezierTo,G.d.Close],argumentIndices:[0,2,8,10,16],arguments:["x2","y1","x3","y2","x4","y3","x5","y1","x10","y4","x8","y6","x7","y5","x6","y4"],attributes:{}}]},wedgeEllipseCallout:{adjustValues:{adj1:-20833,adj2:62500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dxPos",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"dyPos",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"ellipseX",get:function(){return 1*this.eval("dxPos")/this.eval("wd2")}},{key:"ellipseY",get:function(){return 1*this.eval("dyPos")/this.eval("hd2")}},{key:"ellipseMod",get:function(){return this.modulo(this.eval("ellipseX"),this.eval("ellipseY"),0)}},{key:"inEllipse",get:function(){return this.eval("ellipseMod")+0-1}},{key:"xPos",get:function(){return this.eval("hc")+this.eval("dxPos")-0}},{key:"yPos",get:function(){return this.eval("vc")+this.eval("dyPos")-0}},{key:"sdx",get:function(){return this.eval("dxPos")*this.eval("h")/1}},{key:"sdy",get:function(){return this.eval("dyPos")*this.eval("w")/1}},{key:"pang",get:function(){return this.radianToAngle(Math.atan2(this.eval("sdy"),this.eval("sdx")))}},{key:"stAng",get:function(){return this.eval("pang")+66e4-0}},{key:"enAng",get:function(){return this.eval("pang")+0-66e4}},{key:"dx1",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(this.eval("stAng")))}},{key:"dy1",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(this.eval("stAng")))}},{key:"x1",get:function(){return this.eval("hc")+this.eval("dx1")-0}},{key:"y1",get:function(){return this.eval("vc")+this.eval("dy1")-0}},{key:"dx2",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(this.eval("enAng")))}},{key:"dy2",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(this.eval("enAng")))}},{key:"x2",get:function(){return this.eval("hc")+this.eval("dx2")-0}},{key:"y2",get:function(){return this.eval("vc")+this.eval("dy2")-0}},{key:"dx3",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(this.eval("pang")))}},{key:"dy3",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(this.eval("pang")))}},{key:"x3",get:function(){return this.eval("hc")+this.eval("dx3")-0}},{key:"y3",get:function(){return this.eval("vc")+this.eval("dy3")-0}},{key:"xBegin",get:function(){return this.eval("inEllipse")>0?this.eval("xPos"):this.eval("x3")}},{key:"yBegin",get:function(){return this.eval("inEllipse")>0?this.eval("yPos"):this.eval("y3")}},{key:"stAng1",get:function(){return this.radianToAngle(Math.atan2(this.eval("dy1"),this.eval("dx1")))}},{key:"enAng1",get:function(){return this.radianToAngle(Math.atan2(this.eval("dy2"),this.eval("dx2")))}},{key:"swAng1",get:function(){return this.eval("enAng1")+0-this.eval("stAng1")}},{key:"swAng2",get:function(){return this.eval("swAng1")+216e5-0}},{key:"swAng",get:function(){return this.eval("swAng1")>0?this.eval("swAng1"):this.eval("swAng2")}},{key:"idx",get:function(){return this.eval("wd2")*Math.cos(this.angleToRadian(27e5))}},{key:"idy",get:function(){return this.eval("hd2")*Math.sin(this.angleToRadian(27e5))}},{key:"il",get:function(){return this.eval("hc")+0-this.eval("idx")}},{key:"ir",get:function(){return this.eval("hc")+this.eval("idx")-0}},{key:"it",get:function(){return this.eval("vc")+0-this.eval("idy")}},{key:"ib",get:function(){return this.eval("vc")+this.eval("idy")-0}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xPos",y:"yPos",gdRefX:"adj1",minX:-2147483647,maxX:2147483647,gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"3cd4",x:"il",y:"it"},{angle:"cd4",x:"il",y:"ib"},{angle:"cd4",x:"hc",y:"b"},{angle:"cd4",x:"ir",y:"ib"},{angle:0,x:"r",y:"vc"},{angle:"3cd4",x:"ir",y:"it"},{angle:"pang",x:"xPos",y:"yPos"}],textBoxRect:{left:"il",top:"it",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.ArcTo,G.d.Close],argumentIndices:[0,2,4,8],arguments:["xBegin","yBegin","x1","y1","wd2","hd2","stAng1","swAng"],attributes:{}}]},wedgeRectCallout:{adjustValues:{adj1:-20833,adj2:62500},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dxPos",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"dyPos",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"absadj1",get:function(){return Math.abs(this.eval("adj1"))}},{key:"absadj2",get:function(){return Math.abs(this.eval("adj2"))}},{key:"inXrange",get:function(){return 5e4-this.eval("absadj1")}},{key:"inYrange",get:function(){return 5e4-this.eval("absadj2")}},{key:"xPos",get:function(){return this.eval("hc")+this.eval("dxPos")-0}},{key:"yPos",get:function(){return this.eval("vc")+this.eval("dyPos")-0}},{key:"dx",get:function(){return this.eval("xPos")+0-this.eval("hc")}},{key:"dy",get:function(){return this.eval("yPos")+0-this.eval("vc")}},{key:"dq",get:function(){return this.eval("dxPos")*this.eval("h")/this.eval("w")}},{key:"ady",get:function(){return Math.abs(this.eval("dyPos"))}},{key:"adq",get:function(){return Math.abs(this.eval("dq"))}},{key:"dz",get:function(){return this.eval("ady")+0-this.eval("adq")}},{key:"xg1",get:function(){return this.eval("dxPos")>0?7:2}},{key:"xg2",get:function(){return this.eval("dxPos")>0?10:5}},{key:"x1",get:function(){return this.eval("w")*this.eval("xg1")/12}},{key:"x2",get:function(){return this.eval("w")*this.eval("xg2")/12}},{key:"yg1",get:function(){return this.eval("dyPos")>0?7:2}},{key:"yg2",get:function(){return this.eval("dyPos")>0?10:5}},{key:"y1",get:function(){return this.eval("h")*this.eval("yg1")/12}},{key:"y2",get:function(){return this.eval("h")*this.eval("yg2")/12}},{key:"t1",get:function(){return this.eval("dxPos")>0?this.eval("l"):this.eval("xPos")}},{key:"xl",get:function(){return this.eval("dz")>0?this.eval("l"):this.eval("t1")}},{key:"xl1",get:function(){return this.eval("inXrange")>0?this.eval("l"):this.eval("xl")}},{key:"t2",get:function(){return this.eval("dyPos")>0?this.eval("x1"):this.eval("xPos")}},{key:"xt",get:function(){return this.eval("dz")>0?this.eval("t2"):this.eval("x1")}},{key:"t3",get:function(){return this.eval("dxPos")>0?this.eval("xPos"):this.eval("r")}},{key:"xr",get:function(){return this.eval("dz")>0?this.eval("r"):this.eval("t3")}},{key:"xr1",get:function(){return this.eval("inXrange")>0?this.eval("r"):this.eval("xr")}},{key:"t4",get:function(){return this.eval("dyPos")>0?this.eval("xPos"):this.eval("x1")}},{key:"xb",get:function(){return this.eval("dz")>0?this.eval("t4"):this.eval("x1")}},{key:"t5",get:function(){return this.eval("dxPos")>0?this.eval("y1"):this.eval("yPos")}},{key:"yl",get:function(){return this.eval("dz")>0?this.eval("y1"):this.eval("t5")}},{key:"t6",get:function(){return this.eval("dyPos")>0?this.eval("t"):this.eval("yPos")}},{key:"yt",get:function(){return this.eval("dz")>0?this.eval("t6"):this.eval("t")}},{key:"yt1",get:function(){return this.eval("inYrange")>0?this.eval("t"):this.eval("yt")}},{key:"t7",get:function(){return this.eval("dxPos")>0?this.eval("yPos"):this.eval("y1")}},{key:"yr",get:function(){return this.eval("dz")>0?this.eval("y1"):this.eval("t7")}},{key:"t8",get:function(){return this.eval("dyPos")>0?this.eval("yPos"):this.eval("b")}},{key:"yb",get:function(){return this.eval("dz")>0?this.eval("t8"):this.eval("b")}},{key:"yb1",get:function(){return this.eval("inYrange")>0?this.eval("b"):this.eval("yb")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xPos",y:"yPos",gdRefX:"adj1",minX:-2147483647,maxX:2147483647,gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"xPos",y:"yPos"}],textBoxRect:{left:"l",top:"t",right:"r",bottom:"b"},paths:[{commands:[G.d.MoveTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32],arguments:["l","t","x1","t","xt","yt1","x2","t","r","t","r","y1","xr1","yr","r","y2","r","b","x2","b","xb","yb1","x1","b","l","b","l","y2","xl1","yl","l","y1"],attributes:{}}]},wedgeRoundRectCallout:{adjustValues:{adj1:-20833,adj2:62500,adj3:16667},Guides:function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"dxPos",get:function(){return this.eval("w")*this.eval("adj1")/1e5}},{key:"dyPos",get:function(){return this.eval("h")*this.eval("adj2")/1e5}},{key:"absadj1",get:function(){return Math.abs(this.eval("adj1"))}},{key:"absadj2",get:function(){return Math.abs(this.eval("adj2"))}},{key:"inXrange",get:function(){return 5e4-this.eval("absadj1")}},{key:"inYrange",get:function(){return 5e4-this.eval("absadj2")}},{key:"xPos",get:function(){return this.eval("hc")+this.eval("dxPos")-0}},{key:"yPos",get:function(){return this.eval("vc")+this.eval("dyPos")-0}},{key:"dq",get:function(){return this.eval("dxPos")*this.eval("h")/this.eval("w")}},{key:"ady",get:function(){return Math.abs(this.eval("dyPos"))}},{key:"adq",get:function(){return Math.abs(this.eval("dq"))}},{key:"dz",get:function(){return this.eval("ady")+0-this.eval("adq")}},{key:"xg1",get:function(){return this.eval("dxPos")>0?7:2}},{key:"xg2",get:function(){return this.eval("dxPos")>0?10:5}},{key:"x1",get:function(){return this.eval("w")*this.eval("xg1")/12}},{key:"x2",get:function(){return this.eval("w")*this.eval("xg2")/12}},{key:"yg1",get:function(){return this.eval("dyPos")>0?7:2}},{key:"yg2",get:function(){return this.eval("dyPos")>0?10:5}},{key:"y1",get:function(){return this.eval("h")*this.eval("yg1")/12}},{key:"y2",get:function(){return this.eval("h")*this.eval("yg2")/12}},{key:"t1",get:function(){return this.eval("dxPos")>0?this.eval("l"):this.eval("xPos")}},{key:"xl",get:function(){return this.eval("dz")>0?this.eval("l"):this.eval("t1")}},{key:"xl1",get:function(){return this.eval("inXrange")>0?this.eval("l"):this.eval("xl")}},{key:"t2",get:function(){return this.eval("dyPos")>0?this.eval("x1"):this.eval("xPos")}},{key:"xt",get:function(){return this.eval("dz")>0?this.eval("t2"):this.eval("x1")}},{key:"t3",get:function(){return this.eval("dxPos")>0?this.eval("xPos"):this.eval("r")}},{key:"xr",get:function(){return this.eval("dz")>0?this.eval("r"):this.eval("t3")}},{key:"xr1",get:function(){return this.eval("inXrange")>0?this.eval("r"):this.eval("xr")}},{key:"t4",get:function(){return this.eval("dyPos")>0?this.eval("xPos"):this.eval("x1")}},{key:"xb",get:function(){return this.eval("dz")>0?this.eval("t4"):this.eval("x1")}},{key:"t5",get:function(){return this.eval("dxPos")>0?this.eval("y1"):this.eval("yPos")}},{key:"yl",get:function(){return this.eval("dz")>0?this.eval("y1"):this.eval("t5")}},{key:"t6",get:function(){return this.eval("dyPos")>0?this.eval("t"):this.eval("yPos")}},{key:"yt",get:function(){return this.eval("dz")>0?this.eval("t6"):this.eval("t")}},{key:"yt1",get:function(){return this.eval("inYrange")>0?this.eval("t"):this.eval("yt")}},{key:"t7",get:function(){return this.eval("dxPos")>0?this.eval("yPos"):this.eval("y1")}},{key:"yr",get:function(){return this.eval("dz")>0?this.eval("y1"):this.eval("t7")}},{key:"t8",get:function(){return this.eval("dyPos")>0?this.eval("yPos"):this.eval("b")}},{key:"yb",get:function(){return this.eval("dz")>0?this.eval("t8"):this.eval("b")}},{key:"yb1",get:function(){return this.eval("inYrange")>0?this.eval("b"):this.eval("yb")}},{key:"a3",get:function(){return this.eval("adj3")+0-1}},{key:"u1",get:function(){return this.eval("ss")*this.eval("a3")/1e5}},{key:"u2",get:function(){return this.eval("r")+0-this.eval("u1")}},{key:"v2",get:function(){return this.eval("b")+0-this.eval("u1")}},{key:"il",get:function(){return 29289*this.eval("u1")/1e5}},{key:"ir",get:function(){return this.eval("r")+0-this.eval("il")}},{key:"ib",get:function(){return this.eval("b")+0-this.eval("il")}}]),t}(Ur),adjustHandles:[{isPolar:!1,x:"xPos",y:"yPos",gdRefX:"adj1",minX:-2147483647,maxX:2147483647,gdRefY:"adj2",minY:-2147483647,maxY:2147483647}],connectionSites:[{angle:"3cd4",x:"hc",y:"t"},{angle:"cd2",x:"l",y:"vc"},{angle:"cd4",x:"hc",y:"b"},{angle:0,x:"r",y:"vc"},{angle:"cd4",x:"xPos",y:"yPos"}],textBoxRect:{left:"il",top:"il",right:"ir",bottom:"ib"},paths:[{commands:[G.d.MoveTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.ArcTo,G.d.LineTo,G.d.LineTo,G.d.LineTo,G.d.Close],argumentIndices:[0,2,6,8,10,12,14,18,20,22,24,26,30,32,34,36,38,42,44,46,48],arguments:["l","u1","u1","u1","cd2","cd4","x1","t","xt","yt1","x2","t","u2","t","u1","u1","3cd4","cd4","r","y1","xr1","yr","r","y2","r","v2","u1","u1",0,"cd4","x2","b","xb","yb1","x1","b","u1","b","u1","u1","cd4","cd4","l","y2","xl1","yl","l","y1"],attributes:{}}]}},Yr=function(e){return Math.abs(e)<=1e-12},zr=function(){function e(t){s()(this,e),this.definition=t,this.nameTable="nameTable"in t?t.nameTable:"Guides"in t?new t.Guides:new Ur,"adjustValues"in t&&(this.adjustValues=Object.assign({},t.adjustValues)),this.runTimeTable={},this._turningPointList=[]}return c()(e,[{key:"setAdjustValues",value:function(e){this.adjustValues&&(this.adjustValues=Object.assign(this.adjustValues,e))}},{key:"interpretPathList",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.updateNameTable(t,n,i);for(var a=this.definition.paths,o=0,r=a.length;o<r;o++){var s=a[o],l=this.calcCoordScale(t,n,s),c=F()(l,4),u=c[0],d=c[1],h=c[2],p=c[3];this.interpretPath(e,u,d,h,p,s)}this.clear(),this.nameTable.clear()}},{key:"interpretPath",value:function(e,t,n,i,a,o){var r=o.argumentIndices,s=o.arguments;if(e.beginNewPath(Object.assign({},o.attributes)),o.commands&&0!==o.commands.length){"number"!=typeof o.commands[0]&&(o.commands=o.commands[0]);for(var l=o.commands.length,c=0;c<l;c++){var u=r[c];switch(o.commands[c]){case G.d.MoveTo:e.moveTo(this.evaluate(s[u])*t,this.evaluate(s[u+1])*n);break;case G.d.LineTo:e.lineTo(this.evaluate(s[u])*t,this.evaluate(s[u+1])*n);break;case G.d.ArcTo:e.arcTo(this.evaluate(s[u])*t,this.evaluate(s[u+1])*n,this.evaluate(s[u+2])*(1/6e4),this.evaluate(s[u+3])*(1/6e4),i,a);break;case G.d.QuadraticBezierTo:e.quadraticBezierTo(this.evaluate(s[u])*t,this.evaluate(s[u+1])*n,this.evaluate(s[u+2])*t,this.evaluate(s[u+3])*n);break;case G.d.CubicBezierTo:e.cubicBezierTo(this.evaluate(s[u])*t,this.evaluate(s[u+1])*n,this.evaluate(s[u+2])*t,this.evaluate(s[u+3])*n,this.evaluate(s[u+4])*t,this.evaluate(s[u+5])*n);break;case G.d.Close:e.closeCurrentpath()}e.previous&&this.appendTurningPoint({x:635*e.previous.x*15,y:635*e.previous.y*15})}e.endPath()}else e.endPath()}},{key:"appendTurningPoint",value:function(e){var t=e.x,n=e.y;this._turningPointList.find((function(e){var i=e.x,a=e.y;return Kr(i,t)&&Kr(a,n)}))||this._turningPointList.push({x:t,y:n,angle:0})}},{key:"interpretTextBoxRect",value:function(e,t){var n=e.width,i=e.height;if(this.definition&&this.definition.textBoxRect){var a=this.duplicateUpdateNameTable(n,i,t),o={};return o.x=a.t*(1/635),o.y=a.l*(1/635),o.width=a.w*(1/635),o.height=a.h*(1/635),o}return{x:0,y:0,width:n,height:i}}},{key:"clear",value:function(){this.runTimeTable={}}},{key:"evaluate",value:function(e){return"string"==typeof e?(this.runTimeTable[e]||(this.runTimeTable[e]=this.nameTable[e]),this.runTimeTable[e]):e}},{key:"updateNameTable",value:function(e,t,n){Object.assign(this.nameTable,{w:635*e||1,h:635*t||1},this.adjustValues,n)}},{key:"duplicateUpdateNameTable",value:function(e,t,n){Object.assign({},this.nameTable,{w:635*e||1,h:635*t||1},this.adjustValues,n)}},{key:"calcCoordScale",value:function(e,t,n){var i=1/635,a=1/635,o=1,r=1;if(n.attributes&&(n.attributes.w||n.attributes.h)){var s=n.attributes.w||0,l=n.attributes.h||0;i=Yr(s)?1:e/s,a=Yr(l)?1:t/l,n.attributes.w?n.attributes.h||(a=i):i=a,e/t>1?o=e/t:r=t/e}return[i,a,o,r]}},{key:"turningPointList",get:function(){return this._turningPointList}}]),e}();function Xr(e){return"number"==typeof e?e:"this['eval']('"+e+"')"}function Vr(e){var t=e.op,n=e.arg1,i=e.arg2,a=e.arg3;switch(t){case G.c.MultiplyDivide:return"return "+Xr(n)+" * "+Xr(i)+" / "+Xr(a)+";";case G.c.AddSubtract:return"return "+Xr(n)+" + "+Xr(i)+" - "+Xr(a)+";";case G.c.AddDivide:return"return ("+Xr(n)+" + "+Xr(i)+") / "+Xr(a)+";";case G.c.IfElse:return"return ("+Xr(n)+" > 0) ? "+Xr(i)+" : "+Xr(a)+";";case G.c.Absolute:return"return Math.abs("+Xr(n)+");";case G.c.ArcTan:return"return this.radianToAngle(Math.atan2("+Xr(i)+", "+Xr(n)+"));";case G.c.CosineArcTan:return"return "+Xr(n)+" * Math.cos(Math.atan2("+Xr(a)+", "+Xr(i)+"));";case G.c.Cosine:return"return "+Xr(n)+" * Math.cos(this.angleToRadian("+Xr(i)+"));";case G.c.Maximum:return"return Math.max("+Xr(n)+", "+Xr(i)+");";case G.c.Minimum:return"return Math.min("+Xr(n)+", "+Xr(i)+");";case G.c.Modulo:return"return this.modulo("+Xr(n)+", "+Xr(i)+", "+Xr(a)+");";case G.c.PinTo:return"return this.pinTo("+Xr(n)+", "+Xr(i)+", "+Xr(a)+");";case G.c.SineArcTan:return"return "+Xr(n)+" * Math.sin(Math.atan2("+Xr(a)+", "+Xr(i)+"));";case G.c.Sine:return"return "+Xr(n)+" * Math.sin(this.angleToRadian("+Xr(i)+"));";case G.c.SquareRoot:return"return Math.sqrt("+Xr(n)+");";case G.c.Tangent:return"return "+Xr(n)+" * Math.tan(Math.atan2("+Xr(a)+", "+Xr(i)+"));";case G.c.LiteralValue:default:return"return "+Xr(n)+";"}}function qr(e,t){var n=function(e,t){for(var n=e.paths,i=0,a=n.length;i<a;i++){var o=n[i];o.attributes&&(Object.isEmpty(o.attributes.w)&&t&&t.width&&(o.attributes.w=635*t.width),Object.isEmpty(o.attributes.h)&&t&&t.height&&(o.attributes.h=635*t.height));for(var r=0,s=o.arguments.length;r<s;r++){var l=1*o.arguments[r];o.arguments[r]=l}}e.nameTable=new Ur;var c=e.guides;if(c&&Object.keys(c)){var u=Object.keys(c).reduce((function(e,t){var n=c[t];return n.op===G.c.LiteralValue?e[t]={value:n.arg1,writable:!1}:e[t]={get:new Function(Vr(n))},e}),{});Object.defineProperties(e.nameTable,u)}return e}(e,t);return new zr(n)}function Kr(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}var Qr=function(){function e(t,n){s()(this,e);var i=t.data;this.svrObj=t,"paths"in i&&(this.geometry=qr(i,n),this.geometry)||(this.geometry=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rect",n=Wr[e];return n||(n=Wr[t]),new zr(n)}(i.presetType,"rect"),this.geometryType=i.presetType,"adjustValues"in i&&this.setAdjustValues(i.adjustValues))}return c()(e,[{key:"setEnv",value:function(e){this.scale=e}},{key:"setAdjustValues",value:function(e){this.geometry.setAdjustValues(e)}},{key:"getDefinition",value:function(){return this.geometry.definition}},{key:"interpretPathList",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.geometry.interpretPathList(e,t,n,i)}},{key:"updateNameTable",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.geometry.updateNameTable(e,t,n)}},{key:"interpretShapeSize",value:function(e,t,n){if(e&&t){var i={width:-1,height:-1},a=n.PresetShapeType,o=t.width>t.height;switch(n.shapeTypeStr2Enum(this.geometryType)){case a.ShapeTriangle:case a.ShapeRightTriangle:case a.ShapeDiamond:i.width=2*e.width,i.height=2*e.height;break;case a.ShapeCorner:o?(i.width=e.width,i.height=2*e.height):(i.width=2*e.width,i.height=e.height);break;case a.ShapeTrapezoid:case a.ShapeNonIsoscelesTrapezoid:break;case a.ShapePentagon:i.width=e.width/1.05146/Math.cos(Jr(1836e4)),i.height=e.height/.552785/(1-Math.sin(Jr(1836e4))-(1-Math.sin(Jr(108e4)))*Math.cos(Jr(1836e4))/Math.cos(Jr(108e4)));break;case a.ShapeHexagon:o?(i.width=1.2*e.width,i.height=1.2*e.height):(i.width=1.5*e.width,i.height=1.5*e.height);break;case a.ShapeHeptagon:i.width=e.width/.8019386676,i.height=e.height/.8019386676;break;case a.ShapeOctagon:o?(i.height=e.height/.70711,i.width=.29289*i.height()+e.width):(i.width=e.width/.70711,i.height=.29289*i.width()+e.height);break;case a.ShapeDecagon:i.width=e.width/Math.cos(Jr(216e4)),i.height=e.height/1.05146/Math.sin(Jr(216e4));break;case a.ShapeDodecagon:i.width=1.366051*e.width,i.height=1.166811*e.height;break;case a.ShapeStar4:i.width=4*e.width/Math.cos(Jr(27e5)),i.height=4*e.height/Math.sin(Jr(27e5));break;case a.ShapeStar5:i.width=e.width/.401616/Math.cos(Jr(2052e4)),i.height=e.height/.211142/(1+Math.sin(Jr(324e4)));break;case a.ShapeStar6:i.width=e.width/.666678,i.height=e.height/.57736/Math.sin(Jr(36e5));break;case a.ShapeStar7:case a.ShapeStar8:case a.ShapeStar10:case a.ShapeStar12:case a.ShapeStar16:case a.ShapeStar24:case a.ShapeStar32:case a.ShapeRoundRectangle:case a.ShapeRound1Rectangle:case a.ShapeRound2SameRectangle:case a.ShapeRound2DiagonalRectangle:case a.ShapeSnipRoundRectangle:case a.ShapeSnip1Rectangle:case a.ShapeSnip2SameRectangle:case a.ShapeSnip2DiagonalRectangle:case a.ShapePlaque:case a.ShapeEllipse:case a.ShapeTeardrop:case a.ShapeHomePlate:case a.ShapeChevron:case a.ShapePieWedge:case a.ShapePie:case a.ShapeBlockArc:case a.ShapeDonut:case a.ShapeNoSmoking:case a.ShapeRightArrow:case a.ShapeLeftArrow:case a.ShapeUpArrow:case a.ShapeDownArrow:case a.ShapeStripedRightArrow:case a.ShapeNotchedRightArrow:case a.ShapeBentUpArrow:case a.ShapeLeftRightArrow:case a.ShapeUpDownArrow:case a.ShapeLeftUpArrow:break;case a.ShapeLeftRightUpArrow:i.width=t.width,i.height=t.height,t.height<6*t.width&&(i.height=4*e.height),i.height()>6*t.width&&(i.height=6*t.width);break;case a.ShapeQuadArrow:case a.ShapeLeftArrowCallout:case a.ShapeRightArrowCallout:break;case a.ShapeUpArrowCallout:case a.ShapeDownArrowCallout:i.width=t.width,i.height=1e5*e.height/64977;break;case a.ShapeLeftRightArrowCallout:case a.ShapeUpDownArrowCallout:case a.ShapeQuadArrowCallout:case a.ShapeBentArrow:case a.ShapeUTurnArrow:case a.ShapeCircularArrow:case a.ShapeLeftCircularArrow:case a.ShapeLeftRightCircularArrow:case a.ShapeCurvedRightArrow:case a.ShapeCurvedLeftArrow:case a.ShapeCurvedUpArrow:case a.ShapeCurvedDownArrow:case a.ShapeSwooshArrow:case a.ShapeCube:case a.ShapeCan:case a.ShapeLightningBolt:case a.ShapeHeart:case a.ShapeSun:break;case a.ShapeMoon:i.width=2*e.width/.707092,i.height=e.height/.521017;break;case a.ShapeSmileyFace:case a.ShapeIrregularSeal1:case a.ShapeIrregularSeal2:case a.ShapeFoldedCorner:case a.ShapeBevel:case a.ShapeFrame:case a.ShapeHalfFrame:case a.ShapeDiagonalStripe:case a.ShapeChord:case a.ShapeArc:case a.ShapeLeftBracket:case a.ShapeRightBracket:case a.ShapeLeftBrace:case a.ShapeRightBrace:case a.ShapeBracketPair:case a.ShapeBracePair:case a.ShapeStraightConnector1:case a.ShapeBentConnector2:case a.ShapeBentConnector3:case a.ShapeBentConnector4:case a.ShapeBentConnector5:case a.ShapeCurvedConnector2:case a.ShapeCurvedConnector3:case a.ShapeCurvedConnector4:case a.ShapeCurvedConnector5:case a.ShapeCallout1:case a.ShapeCallout2:case a.ShapeCallout3:case a.ShapeAccentCallout1:case a.ShapeAccentCallout2:case a.ShapeAccentCallout3:case a.ShapeBorderCallout1:case a.ShapeBorderCallout2:case a.ShapeBorderCallout3:case a.ShapeAccentBorderCallout2:case a.ShapeAccentBorderCallout3:case a.ShapeWedgeRectangleCallout:case a.ShapeWedgeRoundRectangleCallout:case a.ShapeWedgeEllipseCallout:case a.ShapeCloudCallout:case a.ShapeCloud:case a.ShapeRibbon:case a.ShapeRibbon2:case a.ShapeEllipseRibbon:case a.ShapeEllipseRibbon2:case a.ShapeLeftRightRibbon:case a.ShapeVerticalScroll:case a.ShapeHorizontalScroll:case a.ShapeWave:case a.ShapeDoubleWave:case a.ShapePlus:case a.ShapeFlowChartProcess:case a.ShapeFlowChartDecision:case a.ShapeFlowChartInputOutput:case a.ShapeFlowChartPredefinedProcess:case a.ShapeFlowChartInternalStorage:case a.ShapeFlowChartDocument:case a.ShapeFlowChartMultidocument:case a.ShapeFlowChartTerminator:case a.ShapeFlowChartPreparation:case a.ShapeFlowChartManualInput:case a.ShapeFlowChartManualOperation:case a.ShapeFlowChartConnector:case a.ShapeFlowChartPunchedCard:case a.ShapeFlowChartPunchedTape:case a.ShapeFlowChartSummingJunction:case a.ShapeFlowChartOr:case a.ShapeFlowChartCollate:case a.ShapeFlowChartSort:case a.ShapeFlowChartExtract:case a.ShapeFlowChartMerge:case a.ShapeFlowChartOfflineStorage:case a.ShapeFlowChartOnlineStorage:case a.ShapeFlowChartMagneticTape:case a.ShapeFlowChartMagneticDisk:case a.ShapeFlowChartMagneticDrum:case a.ShapeFlowChartDisplay:case a.ShapeFlowChartDelay:case a.ShapeFlowChartAlternateProcess:case a.ShapeFlowChartOffpageConnector:case a.ShapeActionButtonBlank:case a.ShapeActionButtonHome:case a.ShapeActionButtonHelp:case a.ShapeActionButtonInformation:case a.ShapeActionButtonForwardNext:case a.ShapeActionButtonBackPrevious:case a.ShapeActionButtonEnd:case a.ShapeActionButtonBeginning:case a.ShapeActionButtonReturn:case a.ShapeActionButtonDocument:case a.ShapeActionButtonSound:case a.ShapeActionButtonMovie:case a.ShapeGear6:case a.ShapeGear9:case a.ShapeFunnel:break;case a.ShapeMathPlus:i.width=e.width/.7349,i.height=o?e.height/.2352:t.height;break;case a.ShapeMathMinus:case a.ShapeMathMultiply:case a.ShapeMathDivide:case a.ShapeMathEqual:case a.ShapeMathNotEqual:case a.ShapeCornerTabs:case a.ShapeSquareTabs:case a.ShapePlaqueTabs:case a.ShapeChartX:case a.ShapeChartStar:case a.ShapeChartPlus:case a.ShapeParallelogram:break;case a.ShapeAccentBorderCallout1:case a.ShapeRectangle:i.width=e.width,i.height=e.height;break;default:i.width=e.width,i.height=e.height}return i}}},{key:"interpretTextBoxRect",value:function(e,t){return this.geometry.interpretTextBoxRect(e,t)}},{key:"getNameTable",value:function(){return this.geometry.nameTable}},{key:"getConnectionSites",value:function(){var e=this,t=this.geometry.definition.connectionSites,n=this.geometry.nameTable,i=m(t);return i&&i.length>0&&n?(i.forEach((function(t){var i=t.angle,a=t.x,o=t.y;t.angle=i?n[i]/6e4:0,t.x=n[a]/e.scale,t.y=n[o]/e.scale})),i):this.turningPointList}},{key:"getConnectionCount",value:function(){var e=this.getConnectionSites();return e&&e.length||0}},{key:"getConnectionEndsPoint",value:function(e){e||console.error("need sink");var t=e.pathList,n=t&&t[0],i=n&&n.painterPath;if(i){var a=i.elementAt(0),o=i.elementAt(i.elementCount()-1);return{start:{x:15*a.x,y:15*a.y},end:{x:15*o.x,y:15*o.y}}}}},{key:"adjustValues",get:function(){return this.geometry.adjustValues}},{key:"turningPointList",get:function(){return this.geometry.turningPointList}},{key:"adjustHandles",get:function(){var e=this.geometry.definition.adjustHandles,t=this.geometry.nameTable,n=[];if(!e||!Array.isArray(e))return null;for(var i=0,a=e.length;i<a;i++){var o=e[i],r={};for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s.includes("gdRef")?(r[s]=l,"string"==typeof l&&(r[l]=t[l])):("string"==typeof l&&(l=t[l]),r[s]=l)}n.push(r)}return n}},{key:"textBoxRect",get:function(){var e=this.geometry.definition.textBoxRect,t=this.geometry.nameTable;if(e&&t){var n=e.bottom,i=e.left,a=e.right,o=e.top;return n=t[n]||0,i=t[i]||0,a=t[a]||0,{x:i,y:o=t[o]||0,width:a-i,height:n-o}}return null}}]),e}();function Jr(e){return e*(Math.PI/180/6e4)}window.CustomGeometry={Geometry:Qr,createGeometryFromPreset:function(e,t){return new Qr(e,t)}};var Zr=n(336);window.Emu2Ti=Gr.b,window.Ti2Px=Gr.d,window.Emu2Px=Gr.a,Object.isEmpty=function(e){return null==e};var $r=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),c()(t,[{key:"getTableFrame",value:function(){return null}}]),t}(Yn);function es(e){return e.group?new Xn({data:e}):e.isSmartArt?new $r({data:e}):Qn(e)?new Vn({data:e}):new Yn({data:e})}function ts(e){return fr(e)}function ns(e,t,n){return Dr(e,t,n)}function is(e,t,n){var i=t.left,a=t.top,o=t.width,r=t.height,s=t.path,l=t.horizontalFlipped,c=t.verticalFlipped,u=e.presetType,d=e.groupId,h=e.index,p=u;d!==E.NormalGroup||0!==h&&1!==h||(p=b.ShapeRectangle);var f={geometry2D:{presetType:p},transform2D:{width:Object(Gr.c)(o),height:Object(Gr.c)(r),rotation:0,x:0,y:0,horizontalFlipped:l,verticalFlipped:c}},g=function(e,t){var n={};if(e===E.LineGroup){n.style=Ai;var i=Ii[t];i&&(n.outline=i)}else e===E.NormalGroup?0===t||1===t?(n.style=Pi,n.outline={fill:{color:{toRGB:'"#ff000000"',type:4},type:2},width:6350},n.fill={type:2,color:{toRGB:"#ffffffff",type:3}}):n.style=t>=36&&t<=42?Ai:Li:n.style=Li;return n}(d,h);g.style&&(f.style=g.style),g.outline&&(f.outline=g.outline),s&&(f.geometry2D.paths=[s]);var v=new Yn({data:f}),y=fr({shapeData:v,scale:Object(Gr.d)(1),isLocalShape:!0});return n.save(),n.translate(i,a),Dr(n,v,y),n.restore(),{svgNode:n.getSvg()}}function as(e){return function(e,t){if(e===E.NormalGroup&&t>=36&&t<=42)return{type:0}}(e.groupId,e.index)}function os(e,t,n){for(var i=[],a=e.getExtendList().measureShapeBody,o=a.fill,r=a.layout,s=a.picture,l=a.outline,c=r.paths,u=0;u<c.length;u++){var d=c[u],h=d.attributes,p=d.painterPath,f=d.strokerPath,g=h.fill,v={};if((s||o&&o.type&&g!==G.e.None&&p||e.shapeData.isPlaceHolder()||e.shapeData.getShapeType()===Gn.g.TextBox)&&(v.painterPath=p,p.setFillRule(1)),f&&l&&l.fill&&l.fill.type&&(!h.hasOwnProperty("stroke")||h.stroke)){var y=Object(H.d)(l);y.width+=Object(Gr.c)(n);var m=(new Va).complexStrokePath(d,y,1/15,s);if(!m.isQPainterPath)continue;m.data?(m.setFillRule(1),v.strokerPath=m):p&&(v.strokerPath=p,p.setFillRule(1))}else{var _=new Va,x=Object(Gr.c)(n),w=_.complexStrokePath(d,{width:x},1/15,s);w.isQPainterPath&&(w.setFillRule(1),v.strokerPath=w)}i.push(v)}for(var k=0;k<i.length;k++){var b=i[k];if(b.painterPath)if(b.painterPath.containsPoint(t))return!0;if(b.strokerPath)if(b.strokerPath.containsPointNearly(t))return!0}return!1}function rs(e,t,n){var i=e.private,a=i.fill,o=i.outline,r=void 0,s=void 0;if(t){var l=t.layoutRect;r=Object(Zr.Px2Ti)(l.width),s=Object(Zr.Px2Ti)(l.height),n.translate(l.x,l.y)}else{var c=e.private.anchor;r=c.width,s=c.height}var u={geometry2D:{private:{presetType:b.ShapeRectangle}},transform2D:{width:635*r,height:635*s,rotation:0,x:0,y:0,horizontalFlipped:!1,verticalFlipped:!1},fill:a,outline:o},d=new Yn({data:u});Dr(n,d,fr({shapeData:d,scale:Object(Gr.d)(1),isLocalShape:!0}))}},793:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},794:function(e,t,n){},795:function(e,t,n){e.exports=function(e,t){n.e(223).then(n.t.bind(null,1481,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},796:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Data=void 0;var i=n(5),a=i.__importDefault(n(797)),o=i.__importDefault(n(798)),r=i.__importDefault(n(799)),s=i.__importDefault(n(800)),l=i.__importDefault(n(801)),c=i.__importDefault(n(802)),u=i.__importDefault(n(803)),d=function(e,t,n,i,a){void 0===i&&(i=!0),void 0===a&&(a=!0),this.loader=e,this.style={width:t,height:n},this.loop=i,this.autoplay=a};t.Data=d,t.default={db:{AddGridView:new d(a.default,240,180),AddKanbanVIew:new d(o.default,240,180),AddGalleryView:new d(r.default,240,180),AddFormView:new d(s.default,240,180),AddGanttView:new d(l.default,240,180),AddQueryView:new d(c.default,240,180)},wps:{SyncRevisionsStauts:new d(u.default,240,160)}}},797:function(e,t,n){e.exports=function(e,t){n.e(549).then(n.bind(null,1482)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},798:function(e,t,n){e.exports=function(e,t){n.e(550).then(n.bind(null,1483)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},799:function(e,t,n){e.exports=function(e,t){n.e(547).then(n.bind(null,1484)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},800:function(e,t,n){e.exports=function(e,t){n.e(546).then(n.bind(null,1485)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},801:function(e,t,n){e.exports=function(e,t){n.e(548).then(n.bind(null,1486)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},802:function(e,t,n){e.exports=function(e,t){n.e(551).then(n.bind(null,1487)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},803:function(e,t,n){e.exports=function(e,t){n.e(552).then(n.bind(null,1488)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},812:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return v}));var i=n(13),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},u=500,d={START:"START",MOVE:"MOVE",END:"END",CANCEL:"CANCEL",LEAVE:"LEAVE",LONG_TAP:"LONG_TAP",TAP:"TAP",DOUBLE_TAP:"DOUBLE_TAP",FAST_DOUBLE_TAP:"FAST_DOUBLE_TAP",PRE_DOUBLE_TAP:"PRE_DOUBLE_TAP",TRIPLE_TAP:"TRIPLE_TAP",PRE_TRIPLE_TAP:"PRE_TRIPLE_TAP",SLIDE:"SLIDE",SWIPE:"SWIPE",SWIPE_LEFT:"SWIPE_LEFT",SWIPE_RIGHT:"SWIPE_RIGHT",SWIPE_UP:"SWIPE_UP",SWIPE_DOWN:"SWIPE_DOWN",PINCH:"PINCH",ROTATE:"ROTATE",FINISH:"FINISH"},h=1,p=2,f=3,g=4,v={MOUSE:"MOUSE",TOUCH:"TOUCH"},y=function(){function e(t,n,i){r()(this,e),this.lastInteractType="",this.lastInteractEndEvent=null,this.isDoubleEnd=!1,t instanceof HTMLElement?this.element=t:"string"==typeof t&&(this.element=document.querySelector(t)),this.element&&(this.selector=n,this.relatedEventTypes=i,this._initEventParams(),this._initEventListeners())}return l()(e,[{key:"_initEventParams",value:function(){this.interactInfo={},this.prevInteractInfo={},this.moveInteractInfo={},this.params={element:this.element,context:{}},this.handlers={},this.tapTimeout=null,this.longTapTimeout=null,this.doubleTapTimeout=null,this.isDoubleTap=!1,this.isTripleTap=!1,this.prevVector={}}},{key:"_initEventListeners",value:function(){this._interactStart=this._interactStart.bind(this),this._interactContinue=this._interactContinue.bind(this),this._interactEnd=this._interactEnd.bind(this),this._interactLeave=this._interactLeave.bind(this),this._interactCancel=this._interactCancel.bind(this),this.relatedEventTypes.includes(v.MOUSE)&&(this.element.addEventListener("mousedown",this._interactStart),this.element.addEventListener("mousemove",this._interactContinue),this.element.addEventListener("mouseup",this._interactEnd),this.element.addEventListener("mouseleave",this._interactLeave)),this.relatedEventTypes.includes(v.TOUCH)&&(this.element.addEventListener("touchstart",this._interactStart),this.element.addEventListener("touchmove",this._interactContinue),this.element.addEventListener("touchend",this._interactEnd),this.element.addEventListener("touchcancel",this._interactCancel))}},{key:"_isTarget",value:function(e){for(var t=e;t instanceof HTMLElement&&"BODY"!==t.tagName.toUpperCase();){if(t.matches(this.selector))return!0;t=t.parentNode}return!1}},{key:"on",value:function(e,t){return this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t),this}},{key:"off",value:function(e){this.handler[e]=[]}},{key:"destroy",value:function(){this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.doubleTapTimeout&&clearTimeout(this.doubleTapTimeout),this.relatedEventTypes.includes(v.MOUSE)&&(this.element.removeEventListener("mousedown",this._interactStart),this.element.removeEventListener("mousemove",this._interactContinue),this.element.removeEventListener("mouseup",this._interactEnd),this.element.removeEventListener("mouseleave",this._interactLeave)),this.relatedEventTypes.includes(v.TOUCH)&&(this.element.removeEventListener("touchstart",this._interactStart),this.element.removeEventListener("touchmove",this._interactContinue),this.element.removeEventListener("touchend",this._interactEnd),this.element.removeEventListener("touchcancel",this._interactCancel)),this.interactInfo=this.prevInteractInfo=this.moveInteractInfo=this.params=null}},{key:"_emit",value:function(e,t){if(this.handlers[e]||(this.handlers[e]=[]),!this.selector||this._isTarget(this.target)){this.selector&&(this.params.selector=this.selector);var n=a()({},this.params,{type:e,event:t});this.handlers[e].forEach((function(e){"function"==typeof e&&e(n)}))}}},{key:"_reset",value:function(){this.interactInfo={},this.moveInteractInfo={},this.prevVector={},this.params={element:this.element,context:{}},this.lastInteractEndEvent=null}},{key:"_checkIfDoubleTap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=Math.abs,n=this.prevInteractInfo,i=this.interactInfo;return n&&n.time&&t(n.x-i.x)<15&&t(n.y-i.y)<15&&i.time-n.time<e}},{key:"_checkIfTripleTap",value:function(){return this.isDoubleTap&&this._checkIfDoubleTap(500)}},{key:"attachEventTarget",value:function(e){for(var t=this,n=function(n){t.element.contains(e)||t._interactContinue(n)},i=function(n){t.element.contains(e)||t._interactCancel(n)},a=!1,o=e.parentElement,r=void 0;!a&&o&&o!==document.body;)o.handleTouchEnd?(a=!0,r=o.handleTouchEnd):o=o.parentElement;e.addEventListener("touchcancel",i),e.addEventListener("touchmove",n),e.addEventListener("touchend",(function(a){t.element.contains(e)||("function"==typeof r&&r(a),console.warn("error, target node of touchEvent target has been removed!"),t._interactEnd(a)),r=null,e.removeEventListener("touchmove",n),e.removeEventListener("touchcancel",i)}),{once:!0})}},{key:"_interactStart",value:function(e){var t=this;this.lastInteractType=d.START,this.params.event=e,this.target=e.target,this.relatedEventTypes.includes(v.TOUCH)&&this.attachEventTarget(this.target);var n=e.touches,i=n&&n[0]||e,a=Date.now();this.interactInfo.x=i.pageX,this.interactInfo.y=i.pageY,this.interactInfo.time=a,this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout);var o=!0,r=n&&n.length>1;if(r&&(o=!1),e.isOneFingerTouch=o,this._emit(d.START,e),r){var s=n[1];this.prevVector={x:s.pageX-i.pageX,y:s.pageY-i.pageY},this.prevDistance=c(this.prevVector)}else this.longTapTimeout=setTimeout((function(){t._emit(d.LONG_TAP,e),t.isDoubleTap=!1,t.params.context.isLongTapped=!0,e.cancelable&&e.preventDefault()}),u),this.isTripleTap=this._checkIfTripleTap(),this.isDoubleTap=this._checkIfDoubleTap(),this.params.context.isDoubleTap=this.isDoubleTap,this.params.context.isTripleTap=this.isTripleTap,this.isTripleTap?this._emit(d.PRE_TRIPLE_TAP,e):this.isDoubleTap&&this._emit(d.PRE_DOUBLE_TAP,e),this.prevInteractInfo={x:this.interactInfo.x,y:this.interactInfo.y,time:this.interactInfo.time};this.isDoubleEnd&&this.lastInteractEndEvent&&this.lastInteractEndEvent.clientX===e.clientX&&this.lastInteractEndEvent.clientY===e.clientY&&e.timeStamp-this.lastInteractEndEvent.timeStamp<=100&&(console.error("点击出问题了，尝试重置！"),this._interactEnd(this.lastInteractEndEvent))}},{key:"_interactContinue",value:function(e){if(this.params&&this.params.event){var t=Math.abs,n=e.touches,i=n&&n[0]||e,a=!0;if(n&&n.length>1){a=!1;var o=n[1],r={x:o.pageX-i.pageX,y:o.pageY-i.pageY};if(void 0!==this.prevVector.x){if(this.prevDistance){var s=c(r);this.params.zoom=s/this.prevDistance,this.params.centrepoint={x:(o.pageX+i.pageX)/2,y:(o.pageY+i.pageY)/2},this._emit(d.PINCH,e)}this.params.angle=function(e,t){var n=c(e)*c(t);if(n){var i=(e.x*t.x+e.y*t.y)/n,a=Math.acos(Math.min(i,1));return 180*(a=e.x*t.y-t.x*e.y>0?-a:a)/Math.PI}return 0}(r,this.prevVector),this._emit(d.ROTATE,e)}this.prevVector.x=r.x,this.prevVector.y=r.y,this.params.context.isMultiTouch=!0}else{var l=i.pageX-this.interactInfo.x,u=i.pageY-this.interactInfo.y;this.params.diffX=l,this.params.diffY=u,isNaN(this.moveInteractInfo.x)?this.params.deltaX=this.params.deltaY=0:(this.params.deltaX=i.pageX-this.moveInteractInfo.x,this.params.deltaY=i.pageY-this.moveInteractInfo.y),(t(l)>15||t(u)>15)&&(this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.isDoubleTap=!1,this.isTripleTap=!1),this._emit(d.SLIDE,e),this.moveInteractInfo.x=i.pageX,this.moveInteractInfo.y=i.pageY}this.params.context.isMoved=Math.abs(this.params.diffX)>0||Math.abs(this.params.diffY)>0,e.isOneFingerTouch=a,this._emit(d.MOVE,e)}}},{key:"_interactEnd",value:function(e){var t=this;if(this.isDoubleEnd=!this.lastInteractType||this.lastInteractType===d.END,this.lastInteractType=d.END,this.lastInteractEndEvent=e,this.params&&this.params.event){this.longTapTimeout&&clearTimeout(this.longTapTimeout);var n=Math.abs,i=Date.now(),a=this.params,o=a.diffX,r=a.diffY;if(!isNaN(this.moveInteractInfo.x)&&n(o)>15||!isNaN(this.moveInteractInfo.y)&&n(r)>15)n(r)>n(o)?r<0?(this._emit(d.SWIPE_UP,e),this.params.direction=f):(this._emit(d.SWIPE_DOWN,e),this.params.direction=g):o<0?(this._emit(d.SWIPE_LEFT,e),this.params.direction=h):(this._emit(d.SWIPE_RIGHT,e),this.params.direction=p),this._emit(d.SWIPE,e),this._emit(d.FINISH,e),this.params.context.isSwiped=!0;else switch(this.params.context.isDoubleTap=this.isDoubleTap,this.params.context.isTripleTap=this.isTripleTap,!0){case this.isTripleTap:this.isDoubleTap=!1,this.isTripleTap=!1,this._emit(d.TRIPLE_TAP,e),this._emit(d.FINISH,e);break;case this.isDoubleTap:this.tapTimeout&&clearTimeout(this.tapTimeout),this._emit(d.FAST_DOUBLE_TAP,e),this.doubleTapTimeout=setTimeout((function(){t._emit(d.DOUBLE_TAP,e),t._emit(d.FINISH,e)}),0);break;default:i-this.interactInfo.time<500&&this.params.event.isOneFingerTouch&&(this.tapTimeout=setTimeout((function(){t.isDoubleTap=!1,t.isTripleTap=!1,t._emit(d.TAP,e),t._emit(d.FINISH,e)}),500))}this._emit(d.END,e),this._reset()}}},{key:"_interactCancel",value:function(e){this._emit(d.CANCEL,e),this._reset()}},{key:"_interactLeave",value:function(e){this._emit(d.LEAVE,e)}}]),e}();t.d=y},822:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var i={window:"window",document:"document",view:"view",input:"input",workspaceElement:"workspaceElement",waterdropElement:"waterdropElement",waterdropElements:"waterdropElements",visualViewport:"visualViewport"},a={native:"native",gesture:"gesture"}},874:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(677),l=n(2495),c=function(){function e(t,n,i){a()(this,e),this.layer=t,this.app=n,this.data=n.data,this.workspace=n.workspace,this.manager=i,this.selection=this.data.selection,this.input=this.workspace.input,this.appApi=n.appApi,this.initConfig(),this.initEvents(),this.initState(),this.initUtils()}return r()(e,[{key:"responseCommand",value:function(e){for(var t,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(t=this[e]).call.apply(t,[this].concat(i))}},{key:"checkIsInContentControl",value:function(e){return this.formatContentController.checkIsInContentControl(e)}},{key:"checkIsOutTextFormField",value:function(){var e=this.data.fieldManager;if(e&&this.selection.begin){var t=this.selection.begin,n=this.selection.end?this.selection.end:t,i=e.getField(t.position);if(null==i&&(i=e.getField(n.position-1)),i&&"FORMTEXT"===i.getType()){var a=i.getRange(),o=a.pos,r=a.len;return t.position<o||n.position>o+r}}return!0}},{key:"initConfig",value:function(){this.config={hasContextMenu:!1}}},{key:"initEvents",value:function(){this.events=[]}},{key:"initState",value:function(){this.state=Object.assign({},this.initialState)}},{key:"initUtils",value:function(){var e=this;this.utils={},this.utils.getHitResult=function(t){var n={},i=e.selection.selContext;return i.isInComment()&&(n.commentId=i.getCommentRcId()),l.a.hit(e.data,Object.assign({},t),e.data.typoinfo,n)},this.config.hasContextMenu&&(this.utils.adjustContextMenuPos=function(t,n,i,a){var o=e.workspace.config.zoom,r=e.workspace.getZoomDiff();return{x:t*o-e.workspace.element.scrollLeft+r+i+e.workspace.element.getBoundingClientRect().left,y:n*o+a}})}},{key:"resetUILState",value:function(){this.state.uilState=this.initialState.uilState||s.a.CONTINUE}},{key:"resetState",value:function(){this.state=this.initialState}},{key:"clearAll",value:function(){this.resetState()}},{key:"onMouseEvent",value:function(e,t){return this.state.uilState}},{key:"onTouchEvent",value:function(e,t){return this.state.uilState}},{key:"onGestureEvent",value:function(e,t){return this.state.uilState}},{key:"onKeyboardEvent",value:function(e){return this.state.uilState}},{key:"onWindowEvent",value:function(e){return this.state.uilState}},{key:"onDocumentEvent",value:function(e){return this.state.uilState}},{key:"onCustomEvent",value:function(e){return this.state.uilState}},{key:"execute",value:function(e,t){var n=e.type;switch(!0){case this.eventList.mouse.includes(n):return this.onMouseEvent(e,t);case this.eventList.gesture.includes(n):return this.onGestureEvent(e,t);case this.eventList.keyboard.includes(n):return this.onKeyboardEvent(e,t);case this.eventList.window.includes(n):return this.onWindowEvent(e);case this.eventList.document.includes(n):return this.onDocumentEvent(e);case this.eventList.custom(n):return this.onCustomEvent(e);default:return this.initialState.uilState}}},{key:"eventList",get:function(){return this.manager.context.classes.eventList}},{key:"formatContentController",get:function(){return this.app.formatContentController}},{key:"isRestrictEditMode",get:function(){return this.formatContentController.isRestrictEditMode}},{key:"isReadOnly",get:function(){return this.app.isReadOnly()}},{key:"isInCoreTypo",get:function(){return this.app.data.doc.useCoreTypo}},{key:"initialState",get:function(){return{uilState:s.a.CONTINUE,pos:0}}}]),e}();t.a=c},8838:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.last=void 0,t.last=function(e){return e[e.length-1]}},8839:function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.WPS_MVC_MODEL_TYPE=void 0,function(e){e[e.WPS_MODEL_CUSTOM=65536]="WPS_MODEL_CUSTOM",e[e.WPS_MODEL_DOCUMENT=65536]="WPS_MODEL_DOCUMENT",e[e.WPS_MODEL_SHAPETREE=65537]="WPS_MODEL_SHAPETREE",e[e.WPS_MODEL_GROUPSHAPE=65538]="WPS_MODEL_GROUPSHAPE",e[e.WPS_MODEL_SHAPE=65539]="WPS_MODEL_SHAPE",e[e.WPS_MODEL_BACKGROUND=65540]="WPS_MODEL_BACKGROUND",e[e.WPS_MODEL_SMARTART=65541]="WPS_MODEL_SMARTART",e[e.WPS_MODEL_TEXTBOX=65542]="WPS_MODEL_TEXTBOX",e[e.WPS_MODEL_RULER=65543]="WPS_MODEL_RULER",e[e.WPS_MODEL_CANVAS_CONTAINER=65544]="WPS_MODEL_CANVAS_CONTAINER",e[e.WPS_MODEL_CANVAS_LAYER=65545]="WPS_MODEL_CANVAS_LAYER",e[e.WPS_MODEL_CANVAS_SHAPETREE=65546]="WPS_MODEL_CANVAS_SHAPETREE",e[e.WPS_MODEL_LOCKEDCANVAS=65547]="WPS_MODEL_LOCKEDCANVAS",e[e.WPS_MODEL_LOCKEDCANVAS_SHAPETREE=65548]="WPS_MODEL_LOCKEDCANVAS_SHAPETREE",e[e.WPS_MODEL_LOCKEDCANVAS_GROUPSHAPE=65549]="WPS_MODEL_LOCKEDCANVAS_GROUPSHAPE",e[e.WPS_MODEL_LOCKEDCANVAS_SHAPE=65550]="WPS_MODEL_LOCKEDCANVAS_SHAPE",e[e.WPS_MODEL_MAX=65551]="WPS_MODEL_MAX"}(i||(i={})),t.WPS_MVC_MODEL_TYPE=i},8840:function(e,t,n){e.exports=function(e,t){n.e(882).then(n.bind(null,10887)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},8845:function(e,t,n){"use strict";t.a={Table:"table",HyperLink:"hyperLink",Text:"text",Shape:"shape",FormatContent:"formatContent",ParagraphSetting:"paragraphSetting"}},8846:function(e,t,n){"use strict";var i=n(1),a=n.n(i),o=n(2),r=n.n(o),s=n(22),l=n.n(s),c=n(23),u=n.n(c),d=n(4747),h=n(677),p=function(e){function t(e,n){a()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.type=h.b.SELECTION,i}return u()(t,e),r()(t,[{key:"isLeaveWhenDone",get:function(){return!1}}],[{key:"getPreferredEvents",value:function(e){if(!e.preferredEvents){var t=new Set;Object.values(e.modulesMap).forEach((function(e){e.preferredEvents&&e.preferredEvents.forEach((function(e){t.add(e.type)}))})),e.preferredEvents=t}return e.preferredEvents}}]),t}(d.a);t.a=p},8847:function(e,t,n){var i=n(5908),a=n(7377),o=n(7379),r=n(5909),s=n(8853),l=n(5323);e.exports=function(e,t,n){var c=-1,u=a,d=e.length,h=!0,p=[],f=p;if(n)h=!1,u=o;else if(d>=200){var g=t?null:s(e);if(g)return l(g);h=!1,u=r,f=new i}else f=t?[]:p;e:for(;++c<d;){var v=e[c],y=t?t(v):v;if(v=n||0!==v?v:0,h&&y==y){for(var m=f.length;m--;)if(f[m]===y)continue e;t&&f.push(y),p.push(v)}else u(f,y,n)||(f!==p&&f.push(y),p.push(v))}return p}},8848:function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},8849:function(e,t){e.exports=function(e){return this.__data__.has(e)}},8850:function(e,t,n){var i=n(7378),a=n(8851),o=n(8852);e.exports=function(e,t,n){return t==t?o(e,t,n):i(e,a,n)}},8851:function(e,t){e.exports=function(e){return e!=e}},8852:function(e,t){e.exports=function(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}},8853:function(e,t,n){var i=n(4421),a=n(8854),o=n(5323),r=i&&1/o(new i([,-0]))[1]==1/0?function(e){return new i(e)}:a;e.exports=r},8854:function(e,t){e.exports=function(){}},8855:function(e,t,n){var i=n(4748),a=n(6746),o=n(8857),r=n(8859),s=n(3693),l=n(1873),c=n(3690),u=n(4426),d="[object Object]",h=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,p,f,g){var v=l(e),y=l(t),m=v?"[object Array]":s(e),_=y?"[object Array]":s(t),x=(m="[object Arguments]"==m?d:m)==d,w=(_="[object Arguments]"==_?d:_)==d,k=m==_;if(k&&c(e)){if(!c(t))return!1;v=!0,x=!1}if(k&&!x)return g||(g=new i),v||u(e)?a(e,t,n,p,f,g):o(e,t,m,n,p,f,g);if(!(1&n)){var b=x&&h.call(e,"__wrapped__"),T=w&&h.call(t,"__wrapped__");if(b||T){var C=b?e.value():e,S=T?t.value():t;return g||(g=new i),f(C,S,n,p,g)}}return!!k&&(g||(g=new i),r(e,t,n,p,f,g))}},8856:function(e,t){e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}},8857:function(e,t,n){var i=n(637),a=n(5329),o=n(3688),r=n(6746),s=n(8858),l=n(5323),c=i?i.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,n,i,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new a(e),new a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var f=1&i;if(p||(p=l),e.size!=t.size&&!f)return!1;var g=h.get(e);if(g)return g==t;i|=2,h.set(e,t);var v=r(p(e),p(t),i,c,d,h);return h.delete(e),v;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},8858:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}},8859:function(e,t,n){var i=n(5330),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,r,s){var l=1&n,c=i(e),u=c.length;if(u!=i(t).length&&!l)return!1;for(var d=u;d--;){var h=c[d];if(!(l?h in t:a.call(t,h)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var g=!0;s.set(e,t),s.set(t,e);for(var v=l;++d<u;){var y=e[h=c[d]],m=t[h];if(o)var _=l?o(m,y,h,t,e,s):o(y,m,h,e,t,s);if(!(void 0===_?y===m||r(y,m,n,o,s):_)){g=!1;break}v||(v="constructor"==h)}if(g&&!v){var x=e.constructor,w=t.constructor;x==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w||(g=!1)}return s.delete(e),s.delete(t),g}},8860:function(e,t,n){"use strict";var i=n(24),a=n.n(i),o=n(1),r=n.n(o),s=n(2),l=n.n(s),c=n(22),u=n.n(c),d=n(145),h=n.n(d),p=n(23),f=n.n(p),g=n(167),v=n(6747),y=n(1917),m=n(4428),_=function(e){function t(){var e;r()(this,t);var n,i=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"object"===a()(t._instance_)?(n=t._instance_,u()(i,n)):(t._instance_=i,e=i,u()(i,e))}return f()(t,e),l()(t,[{key:"init",value:function(e,n,i,a){var o=this,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];h()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e,n,i,a,r),this.debounceCompositionEventHandler=window.utils.Lodash.debounce((function(){o.inputValue()}),16)}},{key:"clearAll",value:function(){h()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearAll",this).call(this),this.debounceCompositionEventHandler.cancel&&this.debounceCompositionEventHandler.cancel()}},{key:"_isIOSPairPuncInput",value:function(e){return!(!g.isIos||12!==g.iosVersion)&&/(\u201c\u201d)|(\u2018\u2019)|(\u300a\u300b)|(\u3008\u3009)|(\u300c\u300d)|(\u300e\u300f)|(\u3014\u3015)|(\u3010\u3011)|(\uff3b\uff3d)|(\u005b\u005d)|(\uff5b\uff5d)|(\u007b\u007d)|(\u0028\u0029)|(\uff08\uff09)|(\u003c\u003e)/.test(e)}},{key:"inputValue",value:function(){(this.needComposing||this.compositionState!=y.a.CompositionStart)&&(""===this.input.value&&this.compositionState!=y.a.CompositionEnd||(this.editor.insertText(this.input.value,{state:this.compositionState,replace:this.isInsertWithReplace}),this.compositionState!=y.a.CompositionEnd&&this.compositionState!=y.a.CompositionInit||(this.input.value="")),this.compositionState==y.a.CompositionStart&&this.updateCompositionState(y.a.CompositionUpdate),this.compositionState==y.a.CompositionEnd&&this.updateCompositionState(y.a.CompositionInit),this.isInputting=!1,this.collection.end())}},{key:"onCompositionStart",value:function(){this.needComposing&&this.compositionState==y.a.CompositionInit&&(this.collection.begin(m.b.INSERT_TEXT_WITH_COMPOSITION),this.handleStartInput()),this.updateCompositionState(y.a.CompositionStart)}},{key:"onCompositionUpdate",value:function(){}},{key:"onCompositionEnd",value:function(e){if(!(g.isInMiniProgram&&this.needComposing&&g.isIos&&g.iosVersion>=13&&this.compositionState!==y.a.CompositionUpdate)){this.updateCompositionState(this.needComposing?y.a.CompositionEnd:y.a.CompositionInit);var t=this._isIOSPairPuncInput(this.input.value);this.onInput(e),t&&this.input.blur()}}},{key:"onInput",value:function(e){if(this.needComposing||!(this.compositionState>y.a.CompositionInit)){var t=this.compositionState>y.a.CompositionInit;this.collection.begin(t?m.b.INSERT_TEXT_WITH_COMPOSITION:m.b.INSERT_TEXT_WITHOUT_COMPOSITION),this.isInputting=!0,this.compositionState<y.a.CompositionStart&&(this.isInsertWithReplace||this.handleStartInput()),this.compositionState<y.a.CompositionStart?this.debounceCompositionEventHandler():this.inputValue()}}}]),t}(v.a);t.a=_},8861:function(e,t,n){"use strict";var i=n(13),a=n.n(i),o=n(3490),r=n(4978);function s(e){var t=e.templateType,n=e.range,i=e.contentType,a=n?window.APP.data.doc.contentControls.collect(n.pos,n.len):window.APP.data.doc.getContentControlsInMainText(),o=window.utils.Lodash.groupBy(a,r.a.bind(null,t));return isNaN(i)?o:o[i]||[]}t.a={getCtrls:s,initBlock:function(e,t,n){return t.forEach((function(t){var i=t.title,a=t.lockControl,o=e.findIndex((function(e){return e.tag==n[i]}));~o&&(e[o].checked=!0,e[o].canCancel=!a)})),e},insertBlock:function(e,t,n){var i=s({templateType:t,contentType:o.a}),a=i.findIndex((function(t){return n[t.title]>e})),r=0;~a&&~(a-1)?r=i[a-1].end:i.length&&(r=i[i.length-1].end),window.APP.editor.insertContentControl(r+1,0,t,e),window.APP.workspace.focusWithoutScroll()},deleteBlock:function(e){var t=e.pos,n=e.len;window.APP.editor.deleteContentControl(t,n+1),window.APP.workspace.focusWithoutScroll()},updateBlock:function(e,t,n,i,o){var r=i&&n&&n.find((function(e){return e.title===i.title})),s=e.map((function(e){var i=a()({},e),o=n.find((function(e){return t[e.title]==i.tag}));return i.checked=!!o,i}));return o&&o(s,r),s}}},947:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={DEFAULT:"DEFAULT",SCROLLBAR:"SCROLLBAR",SELECTION:"SELECTION",TEXT:"TEXT",TEXT_FOOTENDNOTE_PLACEHOLDER:"TEXT_FOOTENDNOTE_PLACEHOLDER",COOPER_SELECTION:"COOPER_SELECTION",COOPER_SELECTION_SHAPE:"COOPER_SELECTION_SHAPE",PAGE_MARGIN_LEFT:"PAGE_MARGIN_LEFT",TASK_LIST:"TASK_LIST",TABLE_TEXT:"TABLE_TEXT",TABLE_CELL_SELECT:"TABLE_CELL_SELECT",TABLE_ROW_SELECT:"TABLE_ROW_SELECT",TABLE_COLUMN_SELECT:"TABLE_COLUMN_SELECT",TABLE_ROW_RESIZE:"TABLE_ROW_RESIZE",TABLE_COLUMN_RESIZE:"TABLE_COLUMN_RESIZE",TABLE_HYPERLINK:"TABLE_HYPERLINK",SHAPE:"SHAPE",SHAPE_RESIZE_TL:"SHAPE_RESIZE_TL",SHAPE_RESIZE_TM:"SHAPE_RESIZE_TM",SHAPE_RESIZE_TR:"SHAPE_RESIZE_TR",SHAPE_RESIZE_RM:"SHAPE_RESIZE_RM",SHAPE_RESIZE_BR:"SHAPE_RESIZE_BR",SHAPE_RESIZE_BM:"SHAPE_RESIZE_BM",SHAPE_RESIZE_BL:"SHAPE_RESIZE_BL",SHAPE_RESIZE_LM:"SHAPE_RESIZE_LM",SHAPE_ADJUSTHANDLER_1:"SHAPE_ADJUSTHANDLER_1",SHAPE_ADJUSTHANDLER_2:"SHAPE_ADJUSTHANDLER_2",SHAPE_ADJUSTHANDLER_3:"SHAPE_ADJUSTHANDLER_3",SHAPE_ADJUSTHANDLER_4:"SHAPE_ADJUSTHANDLER_4",SHAPE_ADJUSTHANDLER_5:"SHAPE_ADJUSTHANDLER_5",SHAPE_ADJUSTHANDLER_6:"SHAPE_ADJUSTHANDLER_6",SHAPE_ADJUSTHANDLER_7:"SHAPE_ADJUSTHANDLER_7",SHAPE_ADJUSTHANDLER_8:"SHAPE_ADJUSTHANDLER_8",SHAPE_ADJUSTHANDLER_9:"SHAPE_ADJUSTHANDLER_9",HYPERLINK:"HYPERLINK",TEXTFRAME:"TEXTFRAME",TEXTBOX_PAGE:"TEXTBOX_PAGE",TEXTBOX_PADDING:"TEXTBOX_PADDING",TICKCHAR:"TICKCHAR",TICKCHAR_TICK:"TICKCHAR_TICK",TICKCHAR_UNTICK:"TICKCHAR_UNTICK"}},964:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"n",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return m}));var i=n(24),a=n.n(i),o=1e-6;function r(e,t,n){if(!e)throw new Error(t+" is Assert Because "+n+"!!")}function s(e){if(!e)throw new Error("there is a assert!!")}function l(e){return function e(t){if(!t||"object"!==(void 0===t?"undefined":a()(t)))return t;var n=new t.constructor;for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];n[i]="object"===(void 0===o?"undefined":a()(o))?e(o):o}return n}(e)}function c(e){return Object.isEmpty(e)}function u(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function d(e){return Math.abs(e)<=1e-12}function h(e,t,n){return i=e,a=p(n,t),i>a?i:a;var i,a}function p(e,t){return e<t?e:t}function f(e){return Math.ceil(e)}function g(e,t){return Math.min(t.m13()*e.left(),t.m13()*e.right())+Math.min(t.m23()*e.top(),t.m23()*e.bottom())+t.m33()<1e-6}var v=isFinite;function y(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")}function m(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.hasOwnProperty("width")&&e.hasOwnProperty("height")}}}]);