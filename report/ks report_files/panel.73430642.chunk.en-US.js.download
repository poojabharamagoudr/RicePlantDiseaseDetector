(window.webpackJsonp=window.webpackJsonp||[]).push([[848],{16098:function(e,t,n){},16099:function(e,t,n){},16889:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),s=n(2),r=n.n(s),a=n(22),d=n.n(a),l=n(23),c=n.n(l),u=n(238),f=n.n(u),p=n(258),h=n.n(p),m=n(260),v=(n(16098),n(252)),w=n.n(v),E=n(167),_=n(473),k=function(e){function t(e){o()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.handleClickFolder=n.handleClickFolder.bind(n),n}return c()(t,e),r()(t,[{key:"handleClick",value:function(){this.props.onClickItem&&this.props.onClickItem(this.props.index,this.props.data)}},{key:"handleClickFolder",value:function(){this.props.data.end||this.props.onClickItemFolder&&this.props.onClickItemFolder(this.props.index)}},{key:"componentDidUpdate",value:function(e){if(this.props&&this.props.data&&this.props.data.selected){var t=e.data;JSON.stringify(t)!==JSON.stringify(this.props.data)&&this._itemRef&&e.onItemActived&&e.onItemActived(this._itemRef)}}},{key:"render",value:function(){var e=this,t=this.props.data.text,n=this.props.data,i=n.level,o=n.listString,s=n.fontName,r=n.folded,a=n.end,d=n.selected,l=!!t.length&&!/^\s+$/.test(t),c=l||o;t=c?t:_i18n("applications.writer.components.other.titleNoContext", "The title has no content");var u="w-doc-map-item"+(d?" dmi-item-selected":""),p="dmi-title"+(c?"":" dmi-default-title")+" dmi-level-"+i,h=r?"dmi-title-icon dmi-title-icon-folded ":"dmi-title-icon",m={};l&&(m.title=t);var v={};return s&&window.APP.data.fontServer.fontFamiliesInfo.isSymbolFontFamily(s)&&(v.fontFamily=s),f.a.createElement("div",{ref:function(t){return e._itemRef=t},className:u},f.a.createElement("div",{className:p+" "+(E.isPad?"visible":"")},a?f.a.createElement("span",{className:"empty-catalog-arrow"}):f.a.createElement("span",null,f.a.createElement(_.default,{size:16,className:h,onClick:this.handleClickFolder})),f.a.createElement(w.a,m,f.a.createElement("div",{className:"dmi-title-text",onClick:this.handleClick},f.a.createElement("div",{className:"dmi-title-text-pre",style:v},o),f.a.createElement("div",{className:"dmi-title-text-content"},t)))))}}]),t}(u.PureComponent),P=n(243),O=n.n(P),g=n(344),L=(n(16099),function(e){function t(e){o()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.data={items:[],selectedIndex:-1},n.state={items:[],selectedIndex:-1,isTipVisible:!1,isHover:!1},n._updateLeft=function(e){var t=n.props,i=t.isShow,o=t.updateLeft;if(i&&n.refPanel){var s=n._getLeftMost(),r=window.APP.workspace._workspace.scrollLeft;o(s-n.refPanel.offsetWidth-r+window.APP.workspace.horizontalCenterOffset)}},n._onInit=function(e){n.data.items=e.detail.items.map((function(e){return Object.assign({},e,{folded:!1})})),n.update()},n._onInserted=function(e){var t=e.detail,i=t.index,o=t.item;n.data.items.splice(i,0,Object.assign({},o)),n.update()},n._onDeleted=function(e){var t=e.detail.index;n.data.items.splice(t,1),n.update()},n._onModified=function(e){var t=e.detail,i=t.index,o=t.item,s=Object.assign({},o),r=n.data.items[i];r&&void 0!==r.folded&&(s.folded=r.folded),n.data.items.splice(i,1,s),n.update()},n._onAutoNumChanged=function(e){var t=e.detail,i=t.index,o=t.listString,s=t.fontName,r=Object.assign({},n.data.items[i]);r.listString=o,r.fontName=s,n.data.items.splice(i,1,r),n.update()},n._onSelected=function(e){var t=e.detail.index;n.data.selectedIndex!==t&&(n.data.selectedIndex=t,n.update())},n._handleClickItem=function(e,t){var i={index:e,level:t.level,name:t.text};window.APP.services.docmapManager.jump(e,n.data.items[e].textPos),m.default.dispatchEvent(m.default.docmap.ON_ITEM_CLICK,i)},n._handleClickItemFolder=function(e){var t=Object.assign({},n.data.items[e]);t.folded=!t.folded,n.data.items.splice(e,1,t),n.update()},n._handleClose=function(){window.collection("commandbar","click","page|panel_structure_close"),n.props.show(!1)},n.handleMouseEnter=function(){n.setState({isHover:!0})},n.handleMouseMove=function(){n.state.isHover||n.setState({isHover:!0})},n.handleMouseLeave=function(){n.setState({isHover:!1})},n._onItemActived=function(e){var t=n.refScrollBar.offsetHeight+n.refScrollBar.scrollTop;e.offsetTop+e.offsetHeight>t?n.refScrollBar.scrollTop=e.offsetTop-n.refScrollBar.offsetHeight+e.offsetHeight:e.offsetTop<n.refScrollBar.scrollTop&&(n.refScrollBar.scrollTop=e.offsetTop)},n._onDebounceItemActived=window.utils.Lodash.debounce(n._onItemActived,16),n._updateHandler=window.utils.Lodash.throttle((function(){n.setState({items:n.data.items.slice(0),selectedIndex:n.data.selectedIndex},(function(){n.setState({isTipVisible:!0})}))}),64),n}return c()(t,e),r()(t,[{key:"update",value:function(){var e=this;this._timeoutHandler&&clearTimeout(this._timeoutHandler),this._timeoutHandler=setTimeout((function(){e._updateHandler(),e._timeoutHandler=0}))}},{key:"componentDidMount",value:function(){this.throttleUpdateLeft=window.utils.Lodash.throttle(this._updateLeft,100),window.addEventListener(m.default.docmap.INIT,this._onInit),window.addEventListener(m.default.docmap.INSERTED,this._onInserted),window.addEventListener(m.default.docmap.DELETED,this._onDeleted),window.addEventListener(m.default.docmap.MODIFIED,this._onModified),window.addEventListener(m.default.docmap.AUTONUM_CHANGED,this._onAutoNumChanged),window.addEventListener(m.default.docmap.SELECTED,this._onSelected),window.addEventListener(m.default.names.DOC_WORKSPACE_AFTER_RESIZE,this.throttleUpdateLeft),window.addEventListener(m.default.names.DOC_WORKSPACE_SCROLL,this.throttleUpdateLeft),window.addEventListener(m.default.names.DOC_SECTION_CHANGE,this.throttleUpdateLeft),this.docPanelWidth=this.refPanel?this.refPanel.offsetWidth:0,this.WORKSPACE_PADDING={WITH_DOC_PANEL:this.refPanel?2*this.docPanelWidth+16:0,WITHOUT_DOC_PANEL:16},window.APP.services.docmapManager.open(!0),this._updateWorkspacePadding(this.WORKSPACE_PADDING.WITH_DOC_PANEL),this.throttleUpdateLeft(),window.APP.workspace.resize()}},{key:"componentDidUpdate",value:function(e){var t=this.props.isShow;e.isShow!==t&&(t?window.APP.services.docmapManager.open():window.APP.services.docmapManager.close(),window.APP.isAdaptMode()?window.APP.workspace.resize():!0===t?(0===this.docPanelWidth&&this.refPanel&&(this.docPanelWidth=this.refPanel.offsetWidth,this.WORKSPACE_PADDING.WITH_DOC_PANEL=2*this.docPanelWidth+16),this._updateWorkspacePadding(this.WORKSPACE_PADDING.WITH_DOC_PANEL),this._updateLeft()):this._updateWorkspacePadding(this.WORKSPACE_PADDING.WITHOUT_DOC_PANEL))}},{key:"componentWillUnmount",value:function(){m.default.dispatchEvent(m.default.docmap.HIDE),window.removeEventListener(m.default.docmap.INIT,this._onInit),window.removeEventListener(m.default.docmap.INSERTED,this._onInserted),window.removeEventListener(m.default.docmap.DELETED,this._onDeleted),window.removeEventListener(m.default.docmap.MODIFIED,this._onModified),window.removeEventListener(m.default.docmap.AUTONUM_CHANGED,this._onAutoNumChanged),window.removeEventListener(m.default.docmap.SELECTED,this._onSelected),window.removeEventListener(m.default.names.DOC_WORKSPACE_AFTER_RESIZE,this.throttleUpdateLeft),window.removeEventListener(m.default.names.DOC_WORKSPACE_SCROLL,this.throttleUpdateLeft),window.removeEventListener(m.default.names.DOC_SECTION_CHANGE,this.throttleUpdateLeft),window.APP.services.docmapManager.close(),this.removeObserver(),this._updateWorkspacePadding(this.WORKSPACE_PADDING.WITHOUT_DOC_PANEL)}},{key:"removeObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer.takeRecords(),this.observer=null)}},{key:"_updateWorkspacePadding",value:function(e){window.APP.isHistoryVersion||(window.APP.data.typoinfo.padding=e),!E.isPad&&window.APP.workspace.focusWithoutScroll(),window.APP.workspace.resize()}},{key:"_getLeftMost",value:function(){for(var e=1/0,t=document.querySelectorAll(".canvas-unit"),n=0;n<t.length;n++){var i=t[n].offsetLeft;i>0&&(e=e<i?e:i)}return isFinite(e)?e:0}},{key:"getItems",value:function(){for(var e=Number.MAX_SAFE_INTEGER,t=[],n=this.state.items,i=e,o=0;o<n.length;++o){var s=n[o];s.level>i||(s=Object.assign({index:o},s),o===n.length-1?s.end=!0:s.end=n[o+1].level<=s.level,s.selected=o===this.state.selectedIndex,t.push(s),i=s.folded?s.level:e)}return t}},{key:"render",value:function(){var e=this,t=this.props,n=t.isShow,i=t.readOnly,o=t.left,s=this.state,r=s.isTipVisible,a=s.isHover;if(!n)return null;var d=this.getItems(),l=d.map((function(t,n){return f.a.createElement(k,{key:n,data:t,index:t.index,onClickItem:e._handleClickItem,onClickItemFolder:e._handleClickItemFolder,onItemActived:e._onDebounceItemActived})})),c=d&&d.length>0,u=window.APP.isHistoryVersionCompare;return f.a.createElement("div",{className:h()("w-doc-map-panel",{"is-history-compare":u,"is-hover":a,"is-show":-1!==o}),ref:function(t){return e.refPanel=t},onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave},f.a.createElement("div",{className:"dm-header"},f.a.createElement("div",{className:"dm-title"},_i18n("applications.writer.components.other.documentDirectory", "Contents")),f.a.createElement(O.a,{className:"dm-close-btn",icon:f.a.createElement(g.default,{size:16}),onClick:this._handleClose})),f.a.createElement("div",{className:"dm-content",ref:function(t){return e.refScrollBar=t}},f.a.createElement("div",null,c&&l,!c&&r&&f.a.createElement("div",{className:"dm-empty-tips"},i?_i18n("applications.writer.components.other.DocMap.readOnlyEmptyTips", "No title has been set yet"):_i18n("applications.writer.components.other.DocMap.editorEmptyTips", "The title of the setting will be displayed here")))))}}]),t}(u.PureComponent));t.default=L},239:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(238),o=n.n(i),s=["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","className","spin"];function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(){return"icon-"+(4294967296*(1+Math.random())|0).toString(16).substring(1)}var u=Object(i.createContext)({size:"1em",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"miter",rtl:!1,theme:"outline",colors:{outline:{fill:"#333333",background:"transparent"}},prefix:"kd"});u.Provider;function f(e,t,n){return function(r){var d=r.size,f=r.strokeWidth,p=r.strokeLinecap,h=r.strokeLinejoin,m=r.theme,v=r.fill,w=r.className,E=r.spin,_=l(r,s),k=Object(i.useContext)(u),P=function(e,t,n){var i="";return t.fill&&(t.fill,i=t.fill),t.theme||n.theme,{size:t.size||n.size,strokeWidth:t.strokeWidth||n.strokeWidth,strokeLinecap:t.strokeLinecap||n.strokeLinecap,strokeLinejoin:t.strokeLinejoin||n.strokeLinejoin,colors:i,id:e}}(Object(i.useMemo)(c,[]),{size:d,strokeWidth:f,strokeLinecap:p,strokeLinejoin:h,theme:m,fill:v},k),O=["kd-icon"];return O.push("kd-icon-"+e),t&&k.rtl&&O.push("kd-icon-rtl"),E&&O.push("kd-icon-spin"),w&&O.push(w),o.a.createElement("i",a(a({},_),{},{className:O.join(" "),style:{lineHeight:0}}),n(P))}}},344:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),s=n(239);t.default=Object(s.a)("symbol_cross_two",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},o.a.createElement("path",{d:"M3 13L13 3M3 3L13 13",strokeLinecap:e.strokeLinecap,strokeLinejoin:e.strokeLinejoin,fill:"none",vectorEffect:"non-scaling-stroke"})))}))},473:function(e,t,n){"use strict";n.r(t);var i=n(238),o=n.n(i),s=n(239);t.default=Object(s.a)("arrow_triangle_down",!1,(function(e){return o.a.createElement("svg",{width:e.size,height:e.size,viewBox:"0 0 16 16",fill:"none",strokeWidth:e.strokeWidth},o.a.createElement("g",{id:"group-0",stroke:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575",fill:e.colors&&"string"!=typeof e.colors&&e.colors[0]||"string"==typeof e.colors&&e.colors||"#757575"},o.a.createElement("path",{d:"M4.60262 6.02388C4.32371 5.57757 4.64617 5 5.17425 5H10.8261C11.346 5 11.6694 5.5623 11.4068 6.00896C10.4089 7.70642 9.67075 8.96194 8.66766 10.6682C8.41176 11.1035 7.78244 11.1123 7.51481 10.684L4.60262 6.02388Z",stroke:"none"})))}))}}]);