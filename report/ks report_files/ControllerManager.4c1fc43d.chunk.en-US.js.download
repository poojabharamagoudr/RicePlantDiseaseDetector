(window.webpackJsonp=window.webpackJsonp||[]).push([[841],{10645:function(e,t,n){"use strict";var i=n(13),r=n.n(i),o=n(80),a=n.n(o),l=n(144),s=n.n(l),c=n(238),u=n.n(c);n(14123);t.a=function(e){var t,n=(t=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L((function(e){return r()({},e,{left:0,maxWidth:m.width-2*v,visibility:"hidden"})}));case 2:_();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)}),i=e.title,o=e.bottom,l=e.ctrl,d=e.left,f=e.width,p=e.squareWidth,h=e.isBidi,m=window.APP.formatContentController.getTextControlFirstLine(l).viewPage.outer_rect,v=window.APP.isMobileMode()?0:window.APP.isWebMode()?30-m.left:30,g=m.width-2*v,w={bottom:"calc(100% - "+o+"px + "+(o<30?0:10)+"px)",left:0,visibility:"hidden",maxWidth:g},b=Object(c.useRef)(null),P=Object(c.useState)(0),y=s()(P,2),x=y[0],E=y[1],C=Object(c.useState)(w),T=s()(C,2),D=T[0],L=T[1];Object(c.useEffect)((function(){n()}),[i,d,o,f]);var _=function(){var e=b.current;if(e){var t=e.offsetWidth,n=h?d+p-(f+p)/2:d+(f-p)/2,i=n,a=m.left+v,l=m.right-v,s=0;t>=g||i-t/2<a?s=n-(i=a):t/2+i>l?s=n-(i-=t+i-l):(i-=t/2,s=t/2),L((function(e){var t=r()({},e);return t.left=i,t.visibility="visible",t.bottom="calc(100% - "+o+"px + "+(o<30?0:10)+"px)",t.maxWidth=m.width-2*v,t})),E((function(){return Math.max(s,6)}))}};return u.a.createElement("div",{className:"doc-control-title-bubble-wrapper",style:D,ref:b},u.a.createElement("div",{className:"content"},i),u.a.createElement("div",{className:"triangle",style:{left:x}}))}},10894:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return K}));var i=n(13),r=n.n(i),o=n(144),a=n.n(o),l=n(238),s=n.n(l),c=n(9283),u=n(24),d=n.n(u),f=n(1),p=n.n(f),h=n(2),m=n.n(h),v=n(22),g=n.n(v),w=n(23),b=n.n(w),P=n(244),y=n.n(P),x=(n(14124),function(e){function t(e){p()(this,t);var n=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.refWrap=s.a.createRef();var i=n.getBubblePosition(0,0,e).elementVisible;return n.state={elementVisible:i,style:null},n}return b()(t,e),m()(t,[{key:"componentDidMount",value:function(){this.adjustUI()}},{key:"componentDidUpdate",value:function(e,t){this.props!==e&&this.adjustUI()}},{key:"adjustUI",value:function(){if(this.refWrap.current){var e=this.refWrap.current,t=e.clientWidth,n=e.clientHeight,i=parseInt(t),r=parseInt(n),o=this.getBubblePosition(i,r,this.props),a=o.elementVisible,l=o.style;this.setState({elementVisible:a,style:l})}}},{key:"getElementVisible",value:function(e){if(!(e instanceof Element))return!0;for(var t=e;t&&t!==document.body;){var n=getComputedStyle(t);if("none"===n.display||"hidden"===n.visibility)return!1;t=t.parentNode}return!0}},{key:"getBubblePosition",value:function(e,t,n){var i=n.element,r=n.mousePosition,o=this.getElementVisible(i);if(!i||!o)return{elementVisible:o,style:null};var a=i.getBoundingClientRect();r=r||{x:a.left,y:a.top};var l=document.body,s=l.clientWidth,c=l.clientHeight,u=void 0;u=a.width>100?r.x-10:a.left+a.width/2-e/2,u=Math.min(s-e-10,u),u=Math.max(10,u);var d=void 0;return c-10<(d=Math.max(r.y+25,a.bottom+10))+t&&(d=a.top-t-10),{elementVisible:o,style:{left:parseInt(u),top:parseInt(d)}}}},{key:"renderTitle",value:function(){var e=this.props.title;if(e.length>200&&(e=e.slice(0,200)+"..."),"string"==typeof e){var t="title-text";e.length>20&&(t+=" auto-wrap"),e=s.a.createElement("div",{className:t},e)}return e}},{key:"render",value:function(){var e=this.props,t=e.element,n=e.className,i=this.state,r=i.elementVisible,o=i.style;if(!r||!t)return!1;var a=this.renderTitle(),l="component-droplist-tooltip-content";return n&&(l+=" "+n),s.a.createElement("div",{ref:this.refWrap,className:l,style:o},a)}}]),t}(l.PureComponent)),E=function(e){function t(e){p()(this,t);var n=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=null,n.mousePosition=null,n.container=null,n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.getContainer=n.getContainer.bind(n),n}return b()(t,e),m()(t,[{key:"componentDidUpdate",value:function(e,t){var n=this.props.title;e.title!==n&&this.element&&(n?this._renderLayer(this.element,this.mousePosition):this._renderLayer(null))}},{key:"componentWillUnmount",value:function(){this.element&&L(this.getContainer)}},{key:"getContainer",value:function(){return null}},{key:"handleMouseEnter",value:function(e){if(this.props.title&&!this.element){var t=e.pageX,n=e.pageY,i=e.currentTarget;i.clientWidth<i.scrollWidth&&this._renderLayer(i,{x:t,y:n})}}},{key:"handleMouseLeave",value:function(e){this.props.title&&this._renderLayer(null)}},{key:"_renderLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.props,i=n.title,r=n.theme,o=n.width;this.element=e,this.mousePosition=t;var a=r?"theme-"+r:"",l={title:i,element:e,mousePosition:t,className:a,width:o};D(l,this.getContainer)}},{key:"render",value:function(){var e=this.props.children;"object"!==(void 0===e?"undefined":d()(e))&&(e=s.a.createElement("span",null,e));var t={onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return s.a.cloneElement(e,t)}}]),t}(l.PureComponent);E.themes={normal:"normal",gray:"gray"};var C=E,T=null,D=function(e,t){var n,i=t();i||(T||((n=document.createElement("div")).className="component-droplist-tooltip",document.body.appendChild(n),T=n),i=T),y.a.render(s.a.createElement(x,e),i)},L=function(e){var t=e();t?t.isRemoved=!0:(t=T,T=null),t&&(y.a.unmountComponentAtNode(t),document.body.removeChild(t))},_=n(167),O=n(258),I=n.n(O),q=(n(14125),n(260)),W=n(698),k={create:_i18n("applications.writer.components.other.DroplistControl.tips.create", "Please create an option"),unselected:_i18n("applications.writer.components.other.DroplistControl.tips.unselected", "Please select an option"),cancel:_i18n("applications.writer.components.other.DroplistControl.tips.cancel", "Cancel Option")},A={name:_i18n("applications.writer.components.other.DroplistControl.tips.create", "Please create an option"),value:""},N=function(e){return""===e.value&&-1!==Object.values(k).indexOf(e.name)},M=s.a.memo((function(e){var t=e.squareHeight,n=e.squareLeft,i=e.squareTop,o=e.panelWidth,u=e.btnLeft,d=e.btnHeight,f=e.firstLineWidth,p=e.btnTop,h=e.ctrl,m=e.options,v=void 0===m?[]:m,g=e.setDragItem,w=e.id,b=e.setThumbnailPosition,P=e.connected,y=e.isBidi,x=e.config,E=x.panelMaxWidth,T=x.panelMaxHeight,D=x.btnWidth,L=Object(l.useState)(!1),O=a()(L,2),M=O[0],R=O[1],S=Object(l.useState)(""),H=a()(S,2),B=H[0],j=H[1],z=Object(l.useState)("create"),F=a()(z,2),V=F[0],U=F[1],X=Object(l.useState)(0),Y=a()(X,2),G=Y[0],J=Y[1],K=Object(l.useRef)(null),Q=Object(l.useRef)(null),Z=function(e){ee()};Object(l.useEffect)((function(){v&&0!==v.length?h.showPlcHdr?U("unselected"):U("cancel"):U("create")}),[v,B]),Object(l.useEffect)((function(){if(M&&v.length>x.maxItem-1){var e=K.current,t=e.offsetWidth-e.clientWidth;_.isFirefox&&t>10&&(e.style.width=e.offsetWidth+t+"px"),J(t||0)}else J(0)}),[M]);var $=Object(l.useMemo)((function(){var e={};if(M&&Q.current){var t=Q.current.getBoundingClientRect(),n=t.top,r=t.bottom,o=window.APP.workspace.element.cacheDOMAttr.rect,a=o.top,l=o.height;if(n>a&&r<a+l+d)if((n-a)/l>.8){var s=Math.max(p-i,0)+d+8;Object.assign(e,{transform:"translateY(calc(-100% - "+s+"px))",animation:"none"})}}return e}),[M]),ee=function(e){R(!1),window.removeEventListener(q.default.names.DOC_SELECTION_CHANGED,Z),e||setTimeout((function(){window.APP.workspace.focusWithoutScroll()}),100)},te=function(e,t){var n=window.APP.restrictEditHandler,i=n.isRestrictProtectOn,r=n.isInReadonlyProtectMode,o=window.APP.restrictEditHandler.checkIsRangeNonEditable({pos:h.pos+1,len:h.len-2})||(i&&!r||!P)&&N(e)&&"create"===V,a=N(e)?k[V]:e.name;return s.a.createElement("div",{onClick:function(){return function(e,t){var n=e.value,i="unselected"===V;if(N(e)&&"create"===V)return window.APP.workspace.formatContentProperty.update({visible:!0,controller:{ctrl:h},onClick:function(){window.APP.workspace.formatContentProperty.update({visible:!1,controller:{ctrl:h},onClick:null}),window.APP.workspace.formatContentProperty.clearAll()}}),void ee(!0);var r=h.pos,o=i?t:t-1,a=-1===o?k[V]:v[o].name;window.APP.formatContentController.selectDroplistController(r,o,a).catch((function(){})),window.collection("commandbar","click","control_choose"),j(n),ee()}(e,t)},className:I()("panel-item",{disabled:o}),key:e.value+e.name},s.a.createElement(C,{title:a},s.a.createElement("div",{className:"panel-item-content"},a)))},ne={left:y?u+1:u-1,top:Math.ceil(p+1)},ie=r()({left:y?0:-o+D,top:d+4,maxHeight:T,minWidth:o,maxWidth:E+G},$),re={squareLeft:n,squareTop:i,squareHeight:t,firstLineWidth:f};return s.a.createElement(s.a.Fragment,null,s.a.createElement(c.default,r()({},re,{visible:!0,ctrl:h,setDragItem:g,id:w,setThumbnailPosition:b,title:h.title,isBidi:y,config:x})),s.a.createElement("div",{className:I()("component-droplist-wrapper",M&&"zIndexTop"),style:ne},s.a.createElement("div",{ref:Q,className:"component-droplist-btn",style:{height:d-2+"px",width:D+"px"},onClick:function(){var e=Object(W.getPureTextExcludeSpecialPlaceholder)(window.APP.data,[{pos:h.pos,len:h.len}]);j(e),M?(window.removeEventListener(q.default.names.DOC_SHOW_CONTEXT_MENU,ee),window.removeEventListener(q.default.names.DOC_SELECTION_CHANGED,Z)):(window.addEventListener(q.default.names.DOC_SHOW_CONTEXT_MENU,ee),window.addEventListener(q.default.names.DOC_SELECTION_CHANGED,Z)),R(!M)}}),M&&s.a.createElement("div",{ref:K,className:I()("component-droplist-panel animation-fade-scaleY-in origin-left-bottom"),style:ie},"unselected"===V?v.map(te):[A].concat(v).map(te))))})),R=(n(14126),function(e){var t=e.btnLeft,n=e.btnHeight,i=e.btnTop,r=e.ctrl,o=e.points.length>5,a={height:n-2},l={top:i+1,left:t,height:n,borderRadius:.1*n};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:I()("doc-droplist-control-mobile-wrapper",o&&"multiRow"),style:l},s.a.createElement("div",{className:"doc-droplist-control-mobile-btn",style:a,onClick:function(){var e=Object(W.getPureTextExcludeSpecialPlaceholder)(window.APP.data,[{pos:r.pos,len:r.len}]);q.default.dispatchEvent(q.default.mobile.ON_SHOW_DROPLIST_CONTROL_MODAL,{pos:r.pos,options:r.entries,showPlcHdr:r.showPlcHdr,activeValue:e})}},s.a.createElement("div",{className:"arrow"}))))}),S=n(14127),H=n.n(S),B=n(14129),j=n.n(B),z=n(560),F=n.n(z),V=n(1639),U=n(14131),X=n.n(U),Y=n(10645),G=(n(14133),{contentSquareWidth:14,contentSquareHeight:30,squareTopPlus:window.APP.isWebMode()?0:-1,squareHegihtPlus:1,panelMaxWidth:196,panelMaxHeight:130,panelTop:2,maxItem:4,btnWidth:17}),J=window.APP.isMobileMode();function K(e){var t=Object(l.useState)([]),n=a()(t,2),i=n[0],o=n[1],u=Object(l.useState)([]),d=a()(u,2),f=d[0],p=d[1],h=Object(l.useState)(null),m=a()(h,2),v=m[0],g=m[1],w=Object(l.useState)({top:0,left:0,visibility:"hidden"}),b=a()(w,2),P=b[0],y=b[1];var x=function(e){var t=e.detail;if(0!==t.length){var n=function(e){var t=window.APP.workspace.element.cacheDOMAttr,n=t.scrollTop,i=t.clientHeight,r=e.filter((function(e){if(!window.APP.isWebMode()&&!J)return!0;try{var t=window.APP.workspace.config.zoom,r=e.points[0].values().next().value,o=r[0][0].y*t,a=r[r.length-1].reduce((function(e,t){return Math.max(e,t.y)}),0)*t;return o<i+200+n&&o>n-200||a<i+200+n&&a>n-200}catch(e){return!1}}));return r.sort((function(e,t){return!e.controller||!t.controller||e.controller.pos-t.controller.pos})),r}(t).map(Z);o(n)}else 0!==i.length&&o([])},E=function(e){e.detail.length>=50?window.utils.Lodash.throttle((function(){x(e)}),100)():x(e)};Object(l.useEffect)((function(){E({detail:window.APP.workspace.controllerRenderData||[]}),p(window.APP.workspace.picControlsRenderData||[])}),[]),F()(z.DOCCustomEvents.contentControls.RENDER_CONTROLS,E),F()(z.DOCCustomEvents.contentControls.RENDER_PIC_CONTROLS_ENTRANCE,(function(e){p(e.detail)}));var C=function t(n,i){var o=e.connected;if(n.hasOwnProperty("type")){var a=Q(n.ctrl.pos);if(J)switch(n.type){case V.PureText:case V.CheckBox:case V.RepeatSec:case V.RichText:case V.Picture:return s.a.createElement(c.default,r()({},n.positionData,{isBidi:a,title:n.ctrl.title,ctrl:n.ctrl,visible:!0,id:n.id,key:n.id,setDragItem:g,setThumbnailPosition:y,config:G}));case V.DropdownList:case V.ComboBox:return s.a.createElement(R,r()({title:n.ctrl.title,isBidi:a,key:n.id},n.positionData,{ctrl:n.ctrl,points:n.points[0].values().next().value[0],config:G}))}else{if(n.positionDatas&&n.positionDatas.length&&(!n.ctrl||!n.ctrl.isRepeatItem))return n.positionDatas.map((function(e,i){var o=r()({},n,{positionDatas:null,positionData:e});return t(o,i)}));var l=n.id+"'"+i+"'";switch(n.type){case V.RichText:case V.PureText:case V.CheckBox:case V.RepeatSec:return s.a.createElement(c.default,r()({title:n.ctrl.title,isBidi:a},n.positionData,{ctrl:n.ctrl,visible:!0,id:n.id,key:l,setDragItem:g,setThumbnailPosition:y,config:G}));case V.DropdownList:case V.ComboBox:return s.a.createElement(M,r()({},n.positionData,{isBidi:a,ctrl:n.ctrl,options:n.ctrl.entries,key:l,id:n.id,setDragItem:g,setThumbnailPosition:y,connected:o,config:G}));case V.Picture:return s.a.createElement(H.a,r()({isBidi:a,key:l},n.positionData,{ctrl:n.ctrl,id:n.id,setDragItem:g,setThumbnailPosition:y,config:G}))}if(n.ctrl&&n.ctrl.isRepeatItem){var u=window.APP.data.selection.getNormalRange(),d=u.pos,f=u.len,p=n.ctrl,h=p.pos,m=p.len;if(d>=h&&d+f<=h+m)return s.a.createElement(j.a,r()({isBidi:a,key:n.id},n.positionData,{ctrl:n.ctrl}))}}}},T=i.filter((function(e){return e.ctrl&&e.ctrl.title}));return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"doc-control-wrapper"},v&&0===i.length?i.concat([v]).map(C):i.map(C),f&&!J&&f.map((function(e,t){return s.a.createElement(X.a,{key:e.ctrl.refId+"-"+t,rect:e.rect,ctrl:e.ctrl})})),s.a.createElement("div",{className:"doc-format-content-thumbnail",style:P})),T.length>0&&J&&s.a.createElement("div",{className:"doc-control-title-wrapper"},T.map((function(e){return e.ctrl.title&&(e.ctrl.isDropdownList||e.ctrl.isComboBox)?s.a.createElement(Y.a,{key:e.id,isBidi:Q(e.ctrl.pos),title:e.ctrl.title,bottom:e.positionData.squareTop,width:e.positionData.firstLineWidth,ctrl:e.ctrl,left:e.positionData.squareLeft,squareWidth:G.contentSquareWidth}):null}))))}function Q(e){return window.APP.data.doc.getDataLogic("final").getPap(e).getPropVal("bidi")}function Z(e){var t=Q(e.controller.pos),n=J?20:17,i=e.rects,o=e.points,a=e.options,l=e.controller,s=e.minLayoutIndex,c=e.minTextPage,u=e.maxLayoutIndex,d=e.maxTextPage,f={type:l.type,options:a,id:l.data.objID,ctrl:l,points:o};if(t)if(window.APP.isWebMode()||J){var p=e.points[0].values().next().value;if(!p||p.length<=0)return{};if(1===p.length){var h=p[0];h.length>5?f.positionData={squareHeight:h[1].y-h[0].y,squareLeft:h[0].x,squareTop:h[0].y,repeatItemRight:h[h.length-5].x,repeatItemBottom:h[h.length-5].y,firstLineWidth:h[0].x-h[h.length-2].x,panelWidth:h[3].x-h[4].x,btnLeft:h[4].x,btnHeight:h[4].y-h[5].y,btnTop:h[5].y}:f.positionData={squareHeight:h[1].y-h[0].y,squareLeft:h[0].x,squareTop:h[0].y,repeatItemRight:h[2].x,repeatItemBottom:h[2].y,firstLineWidth:h[0].x-h[3].x,panelWidth:h[1].x-h[2].x,btnLeft:h[2].x,btnHeight:h[2].y-h[3].y,btnTop:h[0].y}}else{var m=p[1],v=p[0],g=p[p.length-1];f.positionData={squareHeight:v[1].y-v[0].y,squareLeft:v[0].x,squareTop:v[0].y,repeatItemRight:g[2].x,repeatItemBottom:g[2].y,firstLineWidth:v[0].x-v[3].x,panelWidth:m[3].x-m[4].x,btnLeft:m[4].x,btnHeight:m[3].y-m[0].y,btnTop:m[0].y}}}else{var w=null,b=null,P=null;try{w=i[s].get(c),b=o[s].get(c),P=i[u].get(d)}catch(e){return{}}var y=b[0],x=y[2].y-y[1].y,E=(y.length+1)/2,C=E+1,T=y[E].y-y[C].y;if(f.positionData={squareHeight:x,squareLeft:w[0].right,squareTop:w[0].top,repeatItemRight:P[P.length-1].left,repeatItemBottom:P[P.length-1].bottom,firstLineWidth:w[0].size.width,panelWidth:P[P.length-1].size.width,btnLeft:P[P.length-1].left,btnHeight:T,btnTop:P[P.length-1].top+P[P.length-1].size.height-T},s<u){f.positionDatas=[f.positionData];for(var D=s+1;D<=u;D++)try{var L=i[D].entries().next().value[1];f.positionDatas.push(r()({},f.positionData,{squareLeft:L[0].right,squareTop:L[0].top,firstLineWidth:L[0].size.width}))}catch(e){}}}else if(window.APP.isWebMode()||J){var _=e.points[0].values().next().value;if(!_||_.length<=0)return{};if(1===_.length){var O=_[0];O.length>5?f.positionData={squareHeight:O[7].y-O[0].y,squareLeft:O[0].x,squareTop:O[0].y,repeatItemRight:O[4].x,repeatItemBottom:O[4].y,firstLineWidth:O[1].x-O[0].x,panelWidth:O[4].x-O[5].x,btnLeft:O[3].x-n,btnHeight:O[4].y-O[3].y,btnTop:O[3].y}:f.positionData={squareHeight:O[3].y-O[0].y,squareLeft:O[0].x,squareTop:O[0].y,repeatItemRight:O[2].x,repeatItemBottom:O[2].y,firstLineWidth:O[1].x-O[0].x,panelWidth:O[2].x-O[3].x,btnLeft:O[1].x-n,btnHeight:O[2].y-O[1].y,btnTop:O[0].y}}else{var I=_[1],q=_[0],W=_[_.length-1];f.positionData={squareHeight:q[3].y-q[0].y,squareLeft:q[0].x,squareTop:q[0].y,repeatItemRight:W[2].x,repeatItemBottom:W[2].y,firstLineWidth:q[1].x-q[0].x,panelWidth:I[1].x-I[0].x,btnLeft:I[1].x-n,btnHeight:I[2].y-I[1].y,btnTop:I[0].y}}}else{var k=null,A=null,N=null,M=null;try{k=i[s].get(c),A=o[s].get(c),N=i[u].get(d),M=o[u].get(d)}catch(e){return{}}if(!M)return{};var R=A[0],S=R[R.length-2].y-R[R.length-1].y,H=M[M.length-1],B=(H.length-1)/2,j=B-1,z=H[B].y-H[j].y;if(f.positionData={squareHeight:S,squareLeft:k[0].left,squareTop:k[0].top,repeatItemRight:N[N.length-1].right,repeatItemBottom:N[N.length-1].bottom,firstLineWidth:k[0].size.width,panelWidth:N[N.length-1].size.width,btnLeft:N[N.length-1].right-n,btnHeight:z,btnTop:N[N.length-1].top+N[N.length-1].size.height-z},s<u){f.positionDatas=[f.positionData];for(var F=s+1;F<=u;F++)try{var V=i[F].entries().next().value[1];f.positionDatas.push(r()({},f.positionData,{squareLeft:V[0].left,squareTop:V[0].top,firstLineWidth:V[0].size.width}))}catch(e){}}}return f}},14122:function(e,t,n){},14123:function(e,t,n){},14124:function(e,t,n){},14125:function(e,t,n){},14126:function(e,t,n){},14127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),r=i.__importDefault(n(238)),o=i.__importDefault(n(312)),a=i.__importDefault(n(260)),l=i.__importDefault(n(248)),s=i.__importDefault(n(9283));n(14128);t.default=r.default.memo((function(e){var t=e.squareLeft,n=e.squareTop,c=e.firstLineWidth,u=e.ctrl,d=e.setDragItem,f=e.id,p=e.setThumbnailPosition,h=e.isBidi,m=e.config,v=l.default.types.size16,g=u||{},w=g.begin,b=g.end,P=g.showPlcHdr,y=g.title,x={squareLeft:t,squareTop:n,squareHeight:20,firstLineWidth:c},E={top:n+x.squareHeight,left:h?t:t-16};return r.default.createElement(r.default.Fragment,null,r.default.createElement(s.default,i.__assign({},x,{visible:!0,ctrl:u,setDragItem:d,id:f,setThumbnailPosition:p,title:y,isBidi:h,config:m})),!P&&r.default.createElement("div",{className:"component-picture-replace-btn",style:E},r.default.createElement(o.default,{iconType:v.picture,onClick:function(){u.lockContent||(window.APP.data.selection.setPosition(w+1,b-1),a.default.dispatchEvent(a.default.shape.ON_IMAGE_INSERT,{type:"InsertPicture",visible:!1}))}})))}))},14128:function(e,t,n){},14129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),r=i.__importDefault(n(238)),o=i.__importDefault(n(312)),a=i.__importDefault(n(248));n(14130);t.default=r.default.memo((function(e){var t=e.ctrl,n=e.isBidi,i=e.repeatItemRight,l=e.repeatItemBottom,s=a.default.types.size16,c={top:l-16,left:n?i-16:i};return r.default.createElement("div",{className:"component-repeat-item-add-btn",style:c},r.default.createElement(o.default,{iconType:s.add_blue,onClick:function(){var e=window.APP.formatContentController.findControlById(t.id);if(e&&e.isRepeatItem){var n=e.pos,i=e.len,r=e&&e.parent||{},o={pos:r.pos,len:r.len,secItemPos:n,secItemLen:i};window.APP.formatContentController.insertRepeatSecItem(o)&&window.APP.focusInput()}}}))}))},14130:function(e,t,n){},14131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),r=i.__importDefault(n(238)),o=i.__importDefault(n(312)),a=i.__importDefault(n(260)),l=i.__importDefault(n(248));n(14132);t.default=r.default.memo((function(e){var t=e.rect,n=e.ctrl,i=l.default.types.size16,s=n||{},c=s.begin,u=s.end,d={left:t.left+t.width/2-20,top:t.top+t.height/2-20};return r.default.createElement("div",{className:"component-picture-btn-wrapper",style:d},r.default.createElement(o.default,{iconType:i.add_blue,onClick:function(){n.lockContent||(window.APP.data.selection.setPosition(c+1,u-1),a.default.dispatchEvent(a.default.shape.ON_IMAGE_INSERT,{type:"InsertPicture",visible:!1}))}}))}))},14132:function(e,t,n){},14133:function(e,t,n){},1639:function(e,t,n){"use strict";n.r(t),n.d(t,"RichText",(function(){return i})),n.d(t,"PureText",(function(){return r})),n.d(t,"Picture",(function(){return o})),n.d(t,"ComboBox",(function(){return a})),n.d(t,"DropdownList",(function(){return l})),n.d(t,"BuildingBlock",(function(){return s})),n.d(t,"Date",(function(){return c})),n.d(t,"Group",(function(){return u})),n.d(t,"CheckBox",(function(){return d})),n.d(t,"RepeatSec",(function(){return f})),n.d(t,"DocpartObj",(function(){return p})),n.d(t,"Unknown",(function(){return h}));var i=0,r=1,o=2,a=3,l=4,s=5,c=6,u=7,d=8,f=9,p=10,h=11},324:function(e,t,n){"use strict";n.d(t,"x",(function(){return i})),n.d(t,"z",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"m",(function(){return l})),n.d(t,"k",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"B",(function(){return h})),n.d(t,"A",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"p",(function(){return g})),n.d(t,"o",(function(){return w})),n.d(t,"C",(function(){return b})),n.d(t,"h",(function(){return P})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return x})),n.d(t,"t",(function(){return E})),n.d(t,"s",(function(){return C})),n.d(t,"r",(function(){return T})),n.d(t,"D",(function(){return D})),n.d(t,"w",(function(){return L})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return O})),n.d(t,"y",(function(){return I})),n.d(t,"v",(function(){return q})),n.d(t,"u",(function(){return W})),n.d(t,"E",(function(){return k}));var i=0,r=10,o=11,a=13,l=12,s=15,c=14,u=2,d=5,f=8,p=1,h=9,m=32,v=19,g=20,w=21,b=40,P=7,y=3,x=4,E=26,C=27,T=12288,D=0,L=160,_=60,O=62,I=31,q=8203,W=8205,k=42},691:function(e,t,n){"use strict";n.r(t),n.d(t,"isSpecialPlaceholder",(function(){return r})),n.d(t,"isInvalidPlaceholderInComment",(function(){return o})),n.d(t,"isFieldPlaceholder",(function(){return a}));var i=n(324),r=function(e){return new Set([i.g,i.f,i.j,i.l,i.m,i.k,i.i,i.q,i.a,i.d,i.e]).has(e)},o=function(e){return[i.g,i.f,i.m,i.k,i.i,i.q,i.a,i.d,i.e,i.n,i.p,i.o].includes(e)},a=function(e){return e===i.n||e===i.p||e===i.o}},698:function(e,t,n){"use strict";n.r(t),n.d(t,"getPureText",(function(){return a})),n.d(t,"getPureTextExcludeSpecialPlaceholder",(function(){return l})),n.d(t,"getDeletedTextFromString",(function(){return c})),n.d(t,"getDeletedTextFromRange",(function(){return u})),n.d(t,"getText",(function(){return d})),n.d(t,"filterSpecialPlaceholder",(function(){return f}));var i=n(691),r=n(760),o=n(324);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments[2],i=arguments[3],o=e.selection,a=e.doc,l="",s=n||o.getNormalRanges();s.length>1&&s.sort((function(e,t){return e.pos-t.pos}));for(var c=0;c<s.length;++c){var u=s[c];u.len<=0||(l+=Object(r.filterText)(a.getText(u.pos,u.len),t,i))}return l}function l(e,t){return a(e,i.isSpecialPlaceholder,t)}function s(e){return e!==o.q&&Object(i.isSpecialPlaceholder)(e)}function c(e){if(e&&1===e.length&&Object(i.isSpecialPlaceholder)(e.charCodeAt(0)))return e;var t=Object(r.filterTab)(Object(r.filterText)(e,s));return t.length>100?t.substr(0,50)+"..."+t.substr(t.length-50,50):t}function u(e,t,n){return c(a(e,void 0,[{pos:t,len:n}]))}function d(e){return a(window.APP.data,(function(e){return![13,10].includes(e)&&Object(i.isSpecialPlaceholder)(e)}),[e])}function f(e){return Object(r.filterText)(e,i.isSpecialPlaceholder)}},760:function(e,t,n){"use strict";n.r(t),n.d(t,"filterText",(function(){return r})),n.d(t,"filterTab",(function(){return o}));var i=n(324),r=function(e,t,n){var r="",o=[];if(e)for(var a=0;a<e.length;++a)e.charCodeAt(a)===i.n?o.push(!0):e.charCodeAt(a)===i.p?o[o.length-1]=!1:e.charCodeAt(a)===i.o?o.pop():0!==o.length&&(1!==o.length||o[0])||t&&t(e.charCodeAt(a))||(r+=n?n(e[a]):e[a]);return r},o=function(e){return e.replace(/\t/g," ")}},9283:function(e,t,n){"use strict";n.r(t);var i=n(238),r=n.n(i),o=(n(14122),n(258)),a=n.n(o),l=n(10645),s=n(167),c=n(260),u=r.a.memo((function(e){var t=e.squareTop,n=void 0===t?0:t,o=e.squareLeft,u=void 0===o?0:o,d=e.squareHeight,f=void 0===d?0:d,p=e.visible,h=void 0!==p&&p,m=e.ctrl,v=e.setDragItem,g=e.id,w=e.setThumbnailPosition,b=e.isBidi,P=e.config,y=e.firstLineWidth,x=e.title,E={width:P.contentSquareWidth,top:n+P.squareTopPlus,height:f?f+P.squareHegihtPlus:P.contentSquareHeight,left:b?u:u-P.contentSquareWidth},C=Object(i.useRef)(null),T=void 0,D=void 0;function L(e){if(e.preventDefault(),!window.APP.restrictEditHandler.isInRestrictEditMode&&!window.APP.data.selection.selContext.isParagraphSetting){var t=e.screenX,i=e.screenY;if(s.isPad&&"touchstart"===e.type){var r=e.changedTouches[0];t=r.screenX,i=r.screenY}T={screenX:t,screenY:i},v({type:"formatControl",ctrl:m,positionData:{top:n,left:u,height:f,ctrl:m},id:g}),window.addEventListener("mouseup",O),window.addEventListener("mousemove",_),s.isPad&&"touchstart"===e.type&&(window.addEventListener("touchend",O),window.addEventListener("touchmove",_,{passive:!1}))}}function _(e){s.isPad&&window.APP.workspace.disableScroll(),window.APP.workspace.getFormatContentManager().isMoving=!0,e.preventDefault();var t=e.screenX,n=e.screenY;if(s.isPad&&"touchmove"===e.type){var i=e.changedTouches[0];t=i.screenX,n=i.screenY}if(T&&(Math.abs(T.screenX-t)>5||Math.abs(T.screenY-n)>5)){var r=window.APP.uilManager.hit({event:e});if(!r)return;var o=r.position,a=r.line,l=r.pos;window.APP.data.selection.setPosition(o,void 0,{shouldBlur:s.isPad});var c=l.y,u=l.x;window.APP.isWebMode()&&(u-=a.viewPage.parent._viewOffset.x,c-=a.viewPage.parent._viewOffset.y),w({top:c+"px",left:u+"px",visibility:"visible"}),D=o}}function O(e){(s.isPad&&window.APP.workspace.enableScroll(),isNaN(D))||(window.APP.formatContentController.moveContentController2NewPosByController(m,D)||window.APP.data.selection.setPosition(m.pos,m.pos+m.len));s.isPad&&"touchend"===e.type&&(window.removeEventListener("touchmove",_,{passive:!1}),window.removeEventListener("touchend",O),setTimeout((function(){C.current&&C.current.click()}),100)),w({visibility:"hidden"}),window.removeEventListener("mouseup",O),window.removeEventListener("mousemove",_),window.APP.workspace.getFormatContentManager().isMoving=!1,T=null,D=NaN,v(null)}return h&&r.a.createElement("div",{className:"doc-format-content-square-wrapper"},r.a.createElement("div",{ref:C,className:a()("doc-format-content-square",b?"isBidi":"unBidi"),style:E,onMouseDown:L,onTouchStart:L,onClick:function(e){if(s.isPad&&O(e),window.APP.data.selection.setPosition(m.begin,m.end),0===m.type){var t=m.tag,n=m.placeholderText,i=window.APP.data.doc.getText(m.begin+1,m.end-m.begin-2);c.default.dispatchEvent(c.default.contentControls.ON_CONTROL_ITEM_CLICK,{title:x,tag:t,placeholderText:n,text:i})}}}),x&&r.a.createElement(l.a,{isBidi:b,title:x,bottom:E.top,width:y,ctrl:m,left:u,squareWidth:P.contentSquareWidth}))}));t.default=u}}]);